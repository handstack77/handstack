!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).tabler={})}(this,function(e){"use strict";var t=document.querySelectorAll('[data-bs-toggle="autosize"]'),t=(t.length&&t.forEach(function(e){window.autosize&&window.autosize(e)}),document.querySelectorAll("[data-countup]")),R=(t.length&&t.forEach(function(e){let t={};try{const r=e.getAttribute("data-countup")?JSON.parse(e.getAttribute("data-countup")):{};t=Object.assign({enableScrollSpy:!0},r)}catch(e){}const r=parseInt(e.innerHTML,10);var n;window.countUp&&window.countUp.CountUp&&((n=new window.countUp.CountUp(e,r,t)).error||n.start())}),[].slice.call(document.querySelectorAll("[data-mask]")).map(function(e){window.IMask&&new window.IMask(e,{mask:e.dataset.mask,lazy:"true"===e.dataset["mask-visible"]})}),"top"),A="bottom",N="right",O="left",L="auto",I=[R,A,N,O],M="start",b="end",F="clippingParents",H="viewport",U="popper",V="reference",W=I.reduce(function(e,t){return e.concat([t+"-"+M,t+"-"+b])},[]),$=[].concat(I,[L]).reduce(function(e,t){return e.concat([t,t+"-"+M,t+"-"+b])},[]),t="beforeRead",B="read",j="afterRead",z="beforeMain",Y="main",G="afterMain",q="beforeWrite",K="write",X="afterWrite",J=[t,B,j,z,Y,G,q,K,X];function m(e){return e?(e.nodeName||"").toLowerCase():null}function w(e){var t;return null==e?window:"[object Window]"!==e.toString()?(t=e.ownerDocument)&&t.defaultView||window:e}function y(e){return e instanceof w(e).Element||e instanceof Element}function v(e){return e instanceof w(e).HTMLElement||e instanceof HTMLElement}function Z(e){return"undefined"!=typeof ShadowRoot&&(e instanceof w(e).ShadowRoot||e instanceof ShadowRoot)}var Q={name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var i=e.state;Object.keys(i.elements).forEach(function(e){var t=i.styles[e]||{},r=i.attributes[e]||{},n=i.elements[e];v(n)&&m(n)&&(Object.assign(n.style,t),Object.keys(r).forEach(function(e){var t=r[e];!1===t?n.removeAttribute(e):n.setAttribute(e,!0===t?"":t)}))})},effect:function(e){var n=e.state,i={popper:{position:n.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(n.elements.popper.style,i.popper),n.styles=i,n.elements.arrow&&Object.assign(n.elements.arrow.style,i.arrow),function(){Object.keys(n.elements).forEach(function(e){var t=n.elements[e],r=n.attributes[e]||{},e=Object.keys((n.styles.hasOwnProperty(e)?n.styles:i)[e]).reduce(function(e,t){return e[t]="",e},{});v(t)&&m(t)&&(Object.assign(t.style,e),Object.keys(r).forEach(function(e){t.removeAttribute(e)}))})}},requires:["computeStyles"]};function k(e){return e.split("-")[0]}var x=Math.max,ee=Math.min,te=Math.round;function re(){var e=navigator.userAgentData;return null!=e&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function ne(){return!/^((?!chrome|android).)*safari/i.test(re())}function ie(e,t,r){void 0===t&&(t=!1),void 0===r&&(r=!1);var n=e.getBoundingClientRect(),i=1,o=1,t=(t&&v(e)&&(i=0<e.offsetWidth&&te(n.width)/e.offsetWidth||1,o=0<e.offsetHeight&&te(n.height)/e.offsetHeight||1),(y(e)?w(e):window).visualViewport),e=!ne()&&r,r=(n.left+(e&&t?t.offsetLeft:0))/i,e=(n.top+(e&&t?t.offsetTop:0))/o,t=n.width/i,i=n.height/o;return{width:t,height:i,top:e,right:r+t,bottom:e+i,left:r,x:r,y:e}}function oe(e){var t=ie(e),r=e.offsetWidth,n=e.offsetHeight;return Math.abs(t.width-r)<=1&&(r=t.width),Math.abs(t.height-n)<=1&&(n=t.height),{x:e.offsetLeft,y:e.offsetTop,width:r,height:n}}function se(e,t){var r=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(r&&Z(r)){var n=t;do{if(n&&e.isSameNode(n))return!0}while(n=n.parentNode||n.host)}return!1}function C(e){return w(e).getComputedStyle(e)}function E(e){return((y(e)?e.ownerDocument:e.document)||window.document).documentElement}function ae(e){return"html"===m(e)?e:e.assignedSlot||e.parentNode||(Z(e)?e.host:null)||E(e)}function le(e){return v(e)&&"fixed"!==C(e).position?e.offsetParent:null}function ce(e){for(var t,r=w(e),n=le(e);n&&(t=n,0<=["table","td","th"].indexOf(m(t)))&&"static"===C(n).position;)n=le(n);return(!n||"html"!==m(n)&&("body"!==m(n)||"static"!==C(n).position))&&(n||function(e){var t=/firefox/i.test(re());if(!/Trident/i.test(re())||!v(e)||"fixed"!==C(e).position){var r=ae(e);for(Z(r)&&(r=r.host);v(r)&&["html","body"].indexOf(m(r))<0;){var n=C(r);if("none"!==n.transform||"none"!==n.perspective||"paint"===n.contain||-1!==["transform","perspective"].indexOf(n.willChange)||t&&"filter"===n.willChange||t&&n.filter&&"none"!==n.filter)return r;r=r.parentNode}}return null}(e))||r}function ue(e){return 0<=["top","bottom"].indexOf(e)?"x":"y"}function de(e,t,r){return x(e,ee(t,r))}function he(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function pe(r,e){return e.reduce(function(e,t){return e[t]=r,e},{})}var fe={name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,r,n,i,o=e.state,s=e.name,e=e.options,a=o.elements.arrow,l=o.modifiersData.popperOffsets,c=k(o.placement),u=ue(c),c=0<=[O,N].indexOf(c)?"height":"width";a&&l&&(e=he("number"!=typeof(e="function"==typeof(e=e.padding)?e(Object.assign({},o.rects,{placement:o.placement})):e)?e:pe(e,I)),t=oe(a),i="y"===u?R:O,n="y"===u?A:N,r=o.rects.reference[c]+o.rects.reference[u]-l[u]-o.rects.popper[c],l=l[u]-o.rects.reference[u],a=(a=ce(a))?"y"===u?a.clientHeight||0:a.clientWidth||0:0,i=e[i],e=a-t[c]-e[n],i=de(i,n=a/2-t[c]/2+(r/2-l/2),e),o.modifiersData[s]=((a={})[u]=i,a.centerOffset=i-n,a))},effect:function(e){var t=e.state,e=e.options.element,e=void 0===e?"[data-popper-arrow]":e;null!=e&&("string"!=typeof e||(e=t.elements.popper.querySelector(e)))&&se(t.elements.popper,e)&&(t.elements.arrow=e)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function ge(e){return e.split("-")[1]}var me={top:"auto",right:"auto",bottom:"auto",left:"auto"};function ye(e){var t=e.popper,r=e.popperRect,n=e.placement,i=e.variation,o=e.offsets,s=e.position,a=e.gpuAcceleration,l=e.adaptive,c=e.roundOffsets,e=e.isFixed,u=o.x,u=void 0===u?0:u,d=o.y,d=void 0===d?0:d,h="function"==typeof c?c({x:u,y:d}):{x:u,y:d},u=h.x,d=h.y,h=o.hasOwnProperty("x"),o=o.hasOwnProperty("y"),p=O,f=R,g=window;l&&(y="clientHeight",m="clientWidth",(v=ce(t))===w(t)&&"static"!==C(v=E(t)).position&&"absolute"===s&&(y="scrollHeight",m="scrollWidth"),n!==R&&(n!==O&&n!==N||i!==b)||(f=A,d=(d-((e&&v===g&&g.visualViewport?g.visualViewport.height:v[y])-r.height))*(a?1:-1)),n!==O&&(n!==R&&n!==A||i!==b)||(p=N,u=(u-((e&&v===g&&g.visualViewport?g.visualViewport.width:v[m])-r.width))*(a?1:-1)));var m,y=Object.assign({position:s},l&&me),v=!0===c?(n={x:u,y:d},i=w(t),e=n.y,i=i.devicePixelRatio||1,{x:te(n.x*i)/i||0,y:te(e*i)/i||0}):{x:u,y:d};return u=v.x,d=v.y,a?Object.assign({},y,((m={})[f]=o?"0":"",m[p]=h?"0":"",m.transform=(g.devicePixelRatio||1)<=1?"translate("+u+"px, "+d+"px)":"translate3d("+u+"px, "+d+"px, 0)",m)):Object.assign({},y,((r={})[f]=o?d+"px":"",r[p]=h?u+"px":"",r.transform="",r))}var ve={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,e=e.options,r=e.gpuAcceleration,r=void 0===r||r,n=e.adaptive,n=void 0===n||n,e=e.roundOffsets,e=void 0===e||e,r={placement:k(t.placement),variation:ge(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:r,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,ye(Object.assign({},r,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:n,roundOffsets:e})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,ye(Object.assign({},r,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:e})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}},be={passive:!0},we={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,r=e.instance,e=e.options,n=e.scroll,i=void 0===n||n,n=e.resize,o=void 0===n||n,s=w(t.elements.popper),a=[].concat(t.scrollParents.reference,t.scrollParents.popper);return i&&a.forEach(function(e){e.addEventListener("scroll",r.update,be)}),o&&s.addEventListener("resize",r.update,be),function(){i&&a.forEach(function(e){e.removeEventListener("scroll",r.update,be)}),o&&s.removeEventListener("resize",r.update,be)}},data:{}},Ce={left:"right",right:"left",bottom:"top",top:"bottom"};function Ee(e){return e.replace(/left|right|bottom|top/g,function(e){return Ce[e]})}var Te={start:"end",end:"start"};function Se(e){return e.replace(/start|end/g,function(e){return Te[e]})}function _e(e){e=w(e);return{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function xe(e){return ie(E(e)).left+_e(e).scrollLeft}function Re(e){var e=C(e),t=e.overflow,r=e.overflowX,e=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+e+r)}function Ae(e,t){void 0===t&&(t=[]);var r=function e(t){return 0<=["html","body","#document"].indexOf(m(t))?t.ownerDocument.body:v(t)&&Re(t)?t:e(ae(t))}(e),e=r===(null==(e=e.ownerDocument)?void 0:e.body),n=w(r),n=e?[n].concat(n.visualViewport||[],Re(r)?r:[]):r,r=t.concat(n);return e?r:r.concat(Ae(ae(n)))}function Ne(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function Oe(e,t,r){return t===H?Ne((i=r,s=w(n=e),a=E(n),s=s.visualViewport,l=a.clientWidth,a=a.clientHeight,u=c=0,s&&(l=s.width,a=s.height,(o=ne())||!o&&"fixed"===i)&&(c=s.offsetLeft,u=s.offsetTop),{width:l,height:a,x:c+xe(n),y:u})):y(t)?((i=ie(o=t,!1,"fixed"===r)).top=i.top+o.clientTop,i.left=i.left+o.clientLeft,i.bottom=i.top+o.clientHeight,i.right=i.left+o.clientWidth,i.width=o.clientWidth,i.height=o.clientHeight,i.x=i.left,i.y=i.top,i):Ne((s=E(e),l=E(s),a=_e(s),c=null==(c=s.ownerDocument)?void 0:c.body,n=x(l.scrollWidth,l.clientWidth,c?c.scrollWidth:0,c?c.clientWidth:0),u=x(l.scrollHeight,l.clientHeight,c?c.scrollHeight:0,c?c.clientHeight:0),s=-a.scrollLeft+xe(s),a=-a.scrollTop,"rtl"===C(c||l).direction&&(s+=x(l.clientWidth,c?c.clientWidth:0)-n),{width:n,height:u,x:s,y:a}));var n,i,o,s,a,l,c,u}function Ie(e){var t,r=e.reference,n=e.element,e=e.placement,i=e?k(e):null,e=e?ge(e):null,o=r.x+r.width/2-n.width/2,s=r.y+r.height/2-n.height/2;switch(i){case R:t={x:o,y:r.y-n.height};break;case A:t={x:o,y:r.y+r.height};break;case N:t={x:r.x+r.width,y:s};break;case O:t={x:r.x-n.width,y:s};break;default:t={x:r.x,y:r.y}}var a=i?ue(i):null;if(null!=a){var l="y"===a?"height":"width";switch(e){case M:t[a]=t[a]-(r[l]/2-n[l]/2);break;case b:t[a]=t[a]+(r[l]/2-n[l]/2)}}return t}function Me(e,t){var r,n,i,o,s,a,t=t=void 0===t?{}:t,l=t.placement,l=void 0===l?e.placement:l,c=t.strategy,c=void 0===c?e.strategy:c,u=t.boundary,u=void 0===u?F:u,d=t.rootBoundary,d=void 0===d?H:d,h=t.elementContext,h=void 0===h?U:h,p=t.altBoundary,p=void 0!==p&&p,t=t.padding,t=void 0===t?0:t,t=he("number"!=typeof t?t:pe(t,I)),f=e.rects.popper,p=e.elements[p?h===U?V:U:h],c=(r=y(p)?p:p.contextElement||E(e.elements.popper),p=d,n=c,o="clippingParents"===(d=u)?(s=Ae(ae(o=r)),y(i=0<=["absolute","fixed"].indexOf(C(o).position)&&v(o)?ce(o):o)?s.filter(function(e){return y(e)&&se(e,i)&&"body"!==m(e)}):[]):[].concat(d),s=[].concat(o,[p]),d=s[0],(p=s.reduce(function(e,t){t=Oe(r,t,n);return e.top=x(t.top,e.top),e.right=ee(t.right,e.right),e.bottom=ee(t.bottom,e.bottom),e.left=x(t.left,e.left),e},Oe(r,d,n))).width=p.right-p.left,p.height=p.bottom-p.top,p.x=p.left,p.y=p.top,p),u=ie(e.elements.reference),d=Ie({reference:u,element:f,placement:l}),p=Ne(Object.assign({},f,d)),f=h===U?p:u,g={top:c.top-f.top+t.top,bottom:f.bottom-c.bottom+t.bottom,left:c.left-f.left+t.left,right:f.right-c.right+t.right},d=e.modifiersData.offset;return h===U&&d&&(a=d[l],Object.keys(g).forEach(function(e){var t=0<=[N,A].indexOf(e)?1:-1,r=0<=[R,A].indexOf(e)?"y":"x";g[e]+=a[r]*t})),g}var ke={name:"flip",enabled:!0,phase:"main",fn:function(e){var d=e.state,t=e.options,e=e.name;if(!d.modifiersData[e]._skip){for(var r=t.mainAxis,n=void 0===r||r,r=t.altAxis,i=void 0===r||r,r=t.fallbackPlacements,h=t.padding,p=t.boundary,f=t.rootBoundary,o=t.altBoundary,s=t.flipVariations,g=void 0===s||s,m=t.allowedAutoPlacements,s=d.options.placement,t=k(s),r=r||(t!==s&&g?k(r=s)===L?[]:(t=Ee(r),[Se(r),t,Se(t)]):[Ee(s)]),a=[s].concat(r).reduce(function(e,t){return e.concat(k(t)===L?(r=d,n=(e=e=void 0===(e={placement:t,boundary:p,rootBoundary:f,padding:h,flipVariations:g,allowedAutoPlacements:m})?{}:e).placement,i=e.boundary,o=e.rootBoundary,s=e.padding,a=e.flipVariations,l=void 0===(e=e.allowedAutoPlacements)?$:e,c=ge(n),e=c?a?W:W.filter(function(e){return ge(e)===c}):I,u=(n=0===(n=e.filter(function(e){return 0<=l.indexOf(e)})).length?e:n).reduce(function(e,t){return e[t]=Me(r,{placement:t,boundary:i,rootBoundary:o,padding:s})[k(t)],e},{}),Object.keys(u).sort(function(e,t){return u[e]-u[t]})):t);var r,n,i,o,s,a,l,c,u},[]),l=d.rects.reference,c=d.rects.popper,u=new Map,y=!0,v=a[0],b=0;b<a.length;b++){var w=a[b],C=k(w),E=ge(w)===M,T=0<=[R,A].indexOf(C),S=T?"width":"height",_=Me(d,{placement:w,boundary:p,rootBoundary:f,altBoundary:o,padding:h}),T=T?E?N:O:E?A:R,E=(l[S]>c[S]&&(T=Ee(T)),Ee(T)),S=[];if(n&&S.push(_[C]<=0),i&&S.push(_[T]<=0,_[E]<=0),S.every(function(e){return e})){v=w,y=!1;break}u.set(w,S)}if(y)for(var x=g?3:1;0<x&&"break"!==function(t){var e=a.find(function(e){e=u.get(e);if(e)return e.slice(0,t).every(function(e){return e})});if(e)return v=e,"break"}(x);x--);d.placement!==v&&(d.modifiersData[e]._skip=!0,d.placement=v,d.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function De(e,t,r){return{top:e.top-t.height-(r=void 0===r?{x:0,y:0}:r).y,right:e.right-t.width+r.x,bottom:e.bottom-t.height+r.y,left:e.left-t.width-r.x}}function Pe(t){return[R,N,A,O].some(function(e){return 0<=t[e]})}var Le={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,e=e.name,r=t.rects.reference,n=t.rects.popper,i=t.modifiersData.preventOverflow,o=Me(t,{elementContext:"reference"}),s=Me(t,{altBoundary:!0}),o=De(o,r),r=De(s,n,i),s=Pe(o),n=Pe(r);t.modifiersData[e]={referenceClippingOffsets:o,popperEscapeOffsets:r,isReferenceHidden:s,hasPopperEscaped:n},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":s,"data-popper-escaped":n})}},Fe={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var s=e.state,t=e.options,e=e.name,t=t.offset,a=void 0===t?[0,0]:t,t=$.reduce(function(e,t){return e[t]=(t=t,r=s.rects,n=a,i=k(t),o=0<=[O,R].indexOf(i)?-1:1,r="function"==typeof n?n(Object.assign({},r,{placement:t})):n,t=r[0]||0,n=(r[1]||0)*o,0<=[O,N].indexOf(i)?{x:n,y:t}:{x:t,y:n}),e;var r,n,i,o},{}),r=t[s.placement],n=r.x,r=r.y;null!=s.modifiersData.popperOffsets&&(s.modifiersData.popperOffsets.x+=n,s.modifiersData.popperOffsets.y+=r),s.modifiersData[e]=t}},He={name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,e=e.name;t.modifiersData[e]=Ie({reference:t.rects.reference,element:t.rects.popper,placement:t.placement})},data:{}},Ue={name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t,r,n,i,o,s,a,l,c,u=e.state,d=e.options,e=e.name,h=d.mainAxis,h=void 0===h||h,p=d.altAxis,p=void 0!==p&&p,f=d.boundary,g=d.rootBoundary,m=d.altBoundary,y=d.padding,v=d.tether,v=void 0===v||v,d=d.tetherOffset,d=void 0===d?0:d,f=Me(u,{boundary:f,rootBoundary:g,padding:y,altBoundary:m}),g=k(u.placement),y=ge(u.placement),m=!y,b=ue(g),w="x"===b?"y":"x",C=u.modifiersData.popperOffsets,E=u.rects.reference,T=u.rects.popper,d="function"==typeof d?d(Object.assign({},u.rects,{placement:u.placement})):d,d="number"==typeof d?{mainAxis:d,altAxis:d}:Object.assign({mainAxis:0,altAxis:0},d),S=u.modifiersData.offset?u.modifiersData.offset[u.placement]:null,_={x:0,y:0};C&&(h&&(h="y"===b?"height":"width",s=(a=C[b])+f[r="y"===b?R:O],l=a-f[c="y"===b?A:N],t=v?-T[h]/2:0,i=(y===M?E:T)[h],y=y===M?-T[h]:-E[h],o=u.elements.arrow,o=v&&o?oe(o):{width:0,height:0},r=(n=u.modifiersData["arrow#persistent"]?u.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0})[r],n=n[c],c=de(0,E[h],o[h]),o=m?E[h]/2-t-c-r-d.mainAxis:i-c-r-d.mainAxis,i=m?-E[h]/2+t+c+n+d.mainAxis:y+c+n+d.mainAxis,m=(r=u.elements.arrow&&ce(u.elements.arrow))?"y"===b?r.clientTop||0:r.clientLeft||0:0,y=a+i-(t=null!=(h=null==S?void 0:S[b])?h:0),c=de(v?ee(s,a+o-t-m):s,a,v?x(l,y):l),C[b]=c,_[b]=c-a),p&&(n="y"==w?"height":"width",i=(r=C[w])+f["x"===b?R:O],h=r-f["x"===b?A:N],o=-1!==[R,O].indexOf(g),m=null!=(t=null==S?void 0:S[w])?t:0,s=o?i:r-E[n]-T[n]-m+d.altAxis,y=o?r+E[n]+T[n]-m-d.altAxis:h,a=v&&o?(c=de(s,r,l=y),l<c?l:c):de(v?s:i,r,v?y:h),C[w]=a,_[w]=a-r),u.modifiersData[e]=_)},requiresIfExists:["offset"]};function Ve(e){var r=new Map,n=new Set,i=[];return e.forEach(function(e){r.set(e.name,e)}),e.forEach(function(e){n.has(e.name)||function t(e){n.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach(function(e){n.has(e)||(e=r.get(e))&&t(e)}),i.push(e)}(e)}),i}var We={placement:"bottom",modifiers:[],strategy:"absolute"};function $e(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return!t.some(function(e){return!(e&&"function"==typeof e.getBoundingClientRect)})}function Be(e){var e=e=void 0===e?{}:e,t=e.defaultModifiers,l=void 0===t?[]:t,t=e.defaultOptions,c=void 0===t?We:t;return function(n,i,t){void 0===t&&(t=c);var r,o,p={placement:"bottom",orderedModifiers:[],options:Object.assign({},We,c),modifiersData:{},elements:{reference:n,popper:i},attributes:{},styles:{}},s=[],f=!1,g={state:p,setOptions:function(e){e="function"==typeof e?e(p.options):e;a(),p.options=Object.assign({},c,p.options,e),p.scrollParents={reference:y(n)?Ae(n):n.contextElement?Ae(n.contextElement):[],popper:Ae(i)};e=[].concat(l,p.options.modifiers),t=e.reduce(function(e,t){var r=e[t.name];return e[t.name]=r?Object.assign({},r,t,{options:Object.assign({},r.options,t.options),data:Object.assign({},r.data,t.data)}):t,e},{}),r=Ve(Object.keys(t).map(function(e){return t[e]}));var t,r,e=J.reduce(function(e,t){return e.concat(r.filter(function(e){return e.phase===t}))},[]);return p.orderedModifiers=e.filter(function(e){return e.enabled}),p.orderedModifiers.forEach(function(e){var t=e.name,r=e.options,e=e.effect;"function"==typeof e&&(e=e({state:p,name:t,instance:g,options:void 0===r?{}:r}),s.push(e||function(){}))}),g.update()},forceUpdate:function(){if(!f){var e=p.elements,t=e.reference,e=e.popper;if($e(t,e)){p.rects={reference:(t=t,s=ce(e),void 0===(a="fixed"===p.options.strategy)&&(a=!1),l=v(s),c=v(s)&&(d=(c=s).getBoundingClientRect(),u=te(d.width)/c.offsetWidth||1,d=te(d.height)/c.offsetHeight||1,1!==u||1!==d),u=E(s),d=ie(t,c,a),t={scrollLeft:0,scrollTop:0},h={x:0,y:0},!l&&a||("body"===m(s)&&!Re(u)||(t=(l=s)!==w(l)&&v(l)?{scrollLeft:l.scrollLeft,scrollTop:l.scrollTop}:_e(l)),v(s)?((h=ie(s,!0)).x+=s.clientLeft,h.y+=s.clientTop):u&&(h.x=xe(u))),{x:d.left+t.scrollLeft-h.x,y:d.top+t.scrollTop-h.y,width:d.width,height:d.height}),popper:oe(e)},p.reset=!1,p.placement=p.options.placement,p.orderedModifiers.forEach(function(e){return p.modifiersData[e.name]=Object.assign({},e.data)});for(var r,n,i,o=0;o<p.orderedModifiers.length;o++)!0!==p.reset?(r=(i=p.orderedModifiers[o]).fn,n=i.options,i=i.name,"function"==typeof r&&(p=r({state:p,options:void 0===n?{}:n,name:i,instance:g})||p)):(p.reset=!1,o=-1)}}var s,a,l,c,u,d,h},update:(r=function(){return new Promise(function(e){g.forceUpdate(),e(p)})},function(){return o=o||new Promise(function(e){Promise.resolve().then(function(){o=void 0,e(r())})})}),destroy:function(){a(),f=!0}};return $e(n,i)&&g.setOptions(t).then(function(e){!f&&t.onFirstUpdate&&t.onFirstUpdate(e)}),g;function a(){s.forEach(function(e){return e()}),s=[]}}}var je=Be(),ze=Be({defaultModifiers:[we,He,ve,Q]}),Ye=Be({defaultModifiers:[we,He,ve,Q,Fe,ke,Ue,fe,Le]});const Ge=Object.freeze(Object.defineProperty({__proto__:null,afterMain:G,afterRead:j,afterWrite:X,applyStyles:Q,arrow:fe,auto:L,basePlacements:I,beforeMain:z,beforeRead:t,beforeWrite:q,bottom:A,clippingParents:F,computeStyles:ve,createPopper:Ye,createPopperBase:je,createPopperLite:ze,detectOverflow:Me,end:b,eventListeners:we,flip:ke,hide:Le,left:O,main:Y,modifierPhases:J,offset:Fe,placements:$,popper:U,popperGenerator:Be,popperOffsets:He,preventOverflow:Ue,read:B,reference:V,right:N,start:M,top:R,variationPlacements:W,viewport:H,write:K},Symbol.toStringTag,{value:"Module"})),n=new Map,qe={set(e,t,r){n.has(e)||n.set(e,new Map);e=n.get(e);e.has(t)||0===e.size?e.set(t,r):console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(e.keys())[0]}.`)},get:(e,t)=>n.has(e)&&n.get(e).get(t)||null,remove(e,t){var r;n.has(e)&&((r=n.get(e)).delete(t),0===r.size)&&n.delete(e)}},Ke="transitionend",Xe=e=>e=e&&window.CSS&&window.CSS.escape?e.replace(/#([^\s"#']+)/g,(e,t)=>"#"+CSS.escape(t)):e,Je=e=>{e.dispatchEvent(new Event(Ke))},s=e=>!(!e||"object"!=typeof e)&&void 0!==(e=void 0!==e.jquery?e[0]:e).nodeType,i=e=>s(e)?e.jquery?e[0]:e:"string"==typeof e&&0<e.length?document.querySelector(Xe(e)):null,Ze=e=>{if(!s(e)||0===e.getClientRects().length)return!1;const t="visible"===getComputedStyle(e).getPropertyValue("visibility"),r=e.closest("details:not([open])");if(r&&r!==e){const t=e.closest("summary");if(t&&t.parentNode!==r)return!1;if(null===t)return!1}return t},o=e=>!e||e.nodeType!==Node.ELEMENT_NODE||!!e.classList.contains("disabled")||(void 0!==e.disabled?e.disabled:e.hasAttribute("disabled")&&"false"!==e.getAttribute("disabled")),Qe=e=>{var t;return document.documentElement.attachShadow?"function"==typeof e.getRootNode?(t=e.getRootNode())instanceof ShadowRoot?t:null:e instanceof ShadowRoot?e:e.parentNode?Qe(e.parentNode):null:null},et=()=>{},tt=e=>{e.offsetHeight},rt=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,nt=[],a=()=>"rtl"===document.documentElement.dir,r=n=>{var e=()=>{const e=rt();if(e){const t=n.NAME,r=e.fn[t];e.fn[t]=n.jQueryInterface,e.fn[t].Constructor=n,e.fn[t].noConflict=()=>(e.fn[t]=r,n.jQueryInterface)}};"loading"===document.readyState?(nt.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of nt)e()}),nt.push(e)):e()},l=(e,t=[],r=e)=>"function"==typeof e?e.call(...t):r,it=(r,i,e=!0)=>{if(e){e=(()=>{if(!i)return 0;let{transitionDuration:e,transitionDelay:t}=window.getComputedStyle(i);var r=Number.parseFloat(e),n=Number.parseFloat(t);return r||n?(e=e.split(",")[0],t=t.split(",")[0],1e3*(Number.parseFloat(e)+Number.parseFloat(t))):0})()+5;let t=!1;const n=({target:e})=>{e===i&&(t=!0,i.removeEventListener(Ke,n),l(r))};i.addEventListener(Ke,n),setTimeout(()=>{t||Je(i)},e)}else l(r)},ot=(e,t,r,n)=>{var i=e.length;let o=e.indexOf(t);return-1===o?!r&&n?e[i-1]:e[0]:(o+=r?1:-1,n&&(o=(o+i)%i),e[Math.max(0,Math.min(o,i-1))])},st=/[^.]*(?=\..*)\.|.*/,at=/\..*/,lt=/::\d+$/,ct={};let ut=1;const dt={mouseenter:"mouseover",mouseleave:"mouseout"},ht=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function pt(e,t){return t&&t+"::"+ut++||e.uidEvent||ut++}function ft(e){var t=pt(e);return e.uidEvent=t,ct[t]=ct[t]||{},ct[t]}function gt(e,t,r=null){return Object.values(e).find(e=>e.callable===t&&e.delegationSelector===r)}function mt(e,t,r){var n="string"==typeof t,t=!n&&t||r;let i=bt(e);return[n,t,i=ht.has(i)?i:e]}function yt(n,i,o,s,a){if("string"==typeof i&&n){let[e,t,r]=mt(i,o,s);if(i in dt){const n=t=>function(e){if(!e.relatedTarget||e.relatedTarget!==e.delegateTarget&&!e.delegateTarget.contains(e.relatedTarget))return t.call(this,e)};t=n(t)}var s=ft(n),s=s[r]||(s[r]={}),l=gt(s,t,e?o:null);if(l)return l.oneOff=l.oneOff&&a;var c,u,d,h,p,l=pt(t,i.replace(st,"")),i=e?(d=n,h=o,p=t,function t(r){var n=d.querySelectorAll(h);for(let e=r["target"];e&&e!==this;e=e.parentNode)for(const i of n)if(i===e)return wt(r,{delegateTarget:e}),t.oneOff&&f.off(d,r.type,h,p),p.apply(e,[r])}):(c=n,u=t,function e(t){return wt(t,{delegateTarget:c}),e.oneOff&&f.off(c,t.type,u),u.apply(c,[t])});i.delegationSelector=e?o:null,i.callable=t,i.oneOff=a,s[i.uidEvent=l]=i,n.addEventListener(r,i,e)}}function vt(e,t,r,n,i){n=gt(t[r],n,i);n&&(e.removeEventListener(r,n,Boolean(i)),delete t[r][n.uidEvent])}function bt(e){return e=e.replace(at,""),dt[e]||e}const f={on(e,t,r,n){yt(e,t,r,n,!1)},one(e,t,r,n){yt(e,t,r,n,!0)},off(e,t,r,n){if("string"==typeof t&&e){const[d,h,p]=mt(t,r,n),f=p!==t,g=ft(e),m=g[p]||{},y=t.startsWith(".");if(void 0===h){if(y)for(const r of Object.keys(g)){i=void 0;o=void 0;s=void 0;a=void 0;u=void 0;l=void 0;c=void 0;var i=e;var o=g;var s=r;var a=t.slice(1);var l,c,u=o[s]||{};for([l,c]of Object.entries(u))l.includes(a)&&vt(i,o,s,c.callable,c.delegationSelector)}for(const[r,n]of Object.entries(m)){const d=r.replace(lt,"");f&&!t.includes(d)||vt(e,g,p,n.callable,n.delegationSelector)}}else Object.keys(m).length&&vt(e,g,p,h,d?r:null)}},trigger(e,t,r){if("string"!=typeof t||!e)return null;var n=rt();let i=null,o=!0,s=!0,a=!1;t!==bt(t)&&n&&(i=n.Event(t,r),n(e).trigger(i),o=!i.isPropagationStopped(),s=!i.isImmediatePropagationStopped(),a=i.isDefaultPrevented());n=wt(new Event(t,{bubbles:o,cancelable:!0}),r);return a&&n.preventDefault(),s&&e.dispatchEvent(n),n.defaultPrevented&&i&&i.preventDefault(),n}};function wt(e,t={}){for(const[r,n]of Object.entries(t))try{e[r]=n}catch(t){Object.defineProperty(e,r,{configurable:!0,get:()=>n})}return e}function Ct(t){if("true"===t)return!0;if("false"===t)return!1;if(t===Number(t).toString())return Number(t);if(""===t||"null"===t)return null;if("string"!=typeof t)return t;try{return JSON.parse(decodeURIComponent(t))}catch(e){return t}}function Et(e){return e.replace(/[A-Z]/g,e=>"-"+e.toLowerCase())}const c={setDataAttribute(e,t,r){e.setAttribute("data-bs-"+Et(t),r)},removeDataAttribute(e,t){e.removeAttribute("data-bs-"+Et(t))},getDataAttributes(t){if(!t)return{};var r={};for(const n of Object.keys(t.dataset).filter(e=>e.startsWith("bs")&&!e.startsWith("bsConfig"))){let e=n.replace(/^bs/,"");r[e=e.charAt(0).toLowerCase()+e.slice(1)]=Ct(t.dataset[n])}return r},getDataAttribute:(e,t)=>Ct(e.getAttribute("data-bs-"+Et(t)))};class Tt{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,t){var r=s(t)?c.getDataAttribute(t,"config"):{};return{...this.constructor.Default,..."object"==typeof r?r:{},...s(t)?c.getDataAttributes(t):{},..."object"==typeof e?e:{}}}_typeCheckConfig(e,t=this.constructor.DefaultType){for(var[r,n]of Object.entries(t)){const t=e[r],o=s(t)?"element":null==(i=t)?""+i:Object.prototype.toString.call(i).match(/\s([a-z]+)/i)[1].toLowerCase();if(!new RegExp(n).test(o))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${r}" provided type "${o}" but expected type "${n}".`)}var i}}class u extends Tt{constructor(e,t){super(),(e=i(e))&&(this._element=e,this._config=this._getConfig(t),qe.set(this._element,this.constructor.DATA_KEY,this))}dispose(){qe.remove(this._element,this.constructor.DATA_KEY),f.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,t,r=!0){it(e,t,r)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return qe.get(i(e),this.DATA_KEY)}static getOrCreateInstance(e,t={}){return this.getInstance(e)||new this(e,"object"==typeof t?t:null)}static get VERSION(){return"5.3.6"}static get DATA_KEY(){return"bs."+this.NAME}static get EVENT_KEY(){return"."+this.DATA_KEY}static eventName(e){return""+e+this.EVENT_KEY}}const St=t=>{let r=t.getAttribute("data-bs-target");if(!r||"#"===r){let e=t.getAttribute("href");if(!e||!e.includes("#")&&!e.startsWith("."))return null;e.includes("#")&&!e.startsWith("#")&&(e="#"+e.split("#")[1]),r=e&&"#"!==e?e.trim():null}return r?r.split(",").map(e=>Xe(e)).join(","):null},d={find:(e,t=document.documentElement)=>[].concat(...Element.prototype.querySelectorAll.call(t,e)),findOne:(e,t=document.documentElement)=>Element.prototype.querySelector.call(t,e),children:(e,t)=>[].concat(...e.children).filter(e=>e.matches(t)),parents(e,t){var r=[];let n=e.parentNode.closest(t);for(;n;)r.push(n),n=n.parentNode.closest(t);return r},prev(e,t){let r=e.previousElementSibling;for(;r;){if(r.matches(t))return[r];r=r.previousElementSibling}return[]},next(e,t){let r=e.nextElementSibling;for(;r;){if(r.matches(t))return[r];r=r.nextElementSibling}return[]},focusableChildren(e){var t=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(e=>e+':not([tabindex^="-"])').join(",");return this.find(t,e).filter(e=>!o(e)&&Ze(e))},getSelectorFromElement(e){e=St(e);return e&&d.findOne(e)?e:null},getElementFromSelector(e){e=St(e);return e?d.findOne(e):null},getMultipleElementsFromSelector(e){e=St(e);return e?d.find(e):[]}},_t=(t,r="hide")=>{const e="click.dismiss"+t.EVENT_KEY,n=t.NAME;f.on(document,e,`[data-bs-dismiss="${n}"]`,function(e){["A","AREA"].includes(this.tagName)&&e.preventDefault(),o(this)||(e=d.getElementFromSelector(this)||this.closest("."+n),t.getOrCreateInstance(e)[r]())})};class xt extends u{static get NAME(){return"alert"}close(){var e;f.trigger(this._element,"close.bs.alert").defaultPrevented||(this._element.classList.remove("show"),e=this._element.classList.contains("fade"),this._queueCallback(()=>this._destroyElement(),this._element,e))}_destroyElement(){this._element.remove(),f.trigger(this._element,"closed.bs.alert"),this.dispose()}static jQueryInterface(t){return this.each(function(){var e=xt.getOrCreateInstance(this);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t](this)}})}}_t(xt,"close"),r(xt);const Rt='[data-bs-toggle="button"]';class At extends u{static get NAME(){return"button"}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle("active"))}static jQueryInterface(t){return this.each(function(){var e=At.getOrCreateInstance(this);"toggle"===t&&e[t]()})}}f.on(document,"click.bs.button.data-api",Rt,e=>{e.preventDefault();e=e.target.closest(Rt);At.getOrCreateInstance(e).toggle()}),r(At);const Nt=".bs.swipe",Ot=(Nt,Nt,Nt,Nt,Nt,{endCallback:null,leftCallback:null,rightCallback:null}),It={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class Mt extends Tt{constructor(e,t){super(),(this._element=e)&&Mt.isSupported()&&(this._config=this._getConfig(t),this._deltaX=0,this._supportPointerEvents=Boolean(window.PointerEvent),this._initEvents())}static get Default(){return Ot}static get DefaultType(){return It}static get NAME(){return"swipe"}dispose(){f.off(this._element,Nt)}_start(e){this._supportPointerEvents?this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX):this._deltaX=e.touches[0].clientX}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),l(this._config.endCallback)}_move(e){this._deltaX=e.touches&&1<e.touches.length?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){var e=Math.abs(this._deltaX);e<=40||(e=e/this._deltaX,this._deltaX=0,e&&l(0<e?this._config.rightCallback:this._config.leftCallback))}_initEvents(){this._supportPointerEvents?(f.on(this._element,"pointerdown.bs.swipe",e=>this._start(e)),f.on(this._element,"pointerup.bs.swipe",e=>this._end(e)),this._element.classList.add("pointer-event")):(f.on(this._element,"touchstart.bs.swipe",e=>this._start(e)),f.on(this._element,"touchmove.bs.swipe",e=>this._move(e)),f.on(this._element,"touchend.bs.swipe",e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&("pen"===e.pointerType||"touch"===e.pointerType)}static isSupported(){return"ontouchstart"in document.documentElement||0<navigator.maxTouchPoints}}const kt=".bs.carousel",Dt="next",Pt="prev",Lt="left",Ft="right",Ht="slid"+kt,Ut="carousel",Vt="active",Wt=".active",$t=".carousel-item",Bt=(Wt,$t,{ArrowLeft:Ft,ArrowRight:Lt}),jt={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},zt={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class Yt extends u{constructor(e,t){super(e,t),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=d.findOne(".carousel-indicators",this._element),this._addEventListeners(),this._config.ride===Ut&&this.cycle()}static get Default(){return jt}static get DefaultType(){return zt}static get NAME(){return"carousel"}next(){this._slide(Dt)}nextWhenVisible(){!document.hidden&&Ze(this._element)&&this.next()}prev(){this._slide(Pt)}pause(){this._isSliding&&Je(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){this._config.ride&&(this._isSliding?f.one(this._element,Ht,()=>this.cycle()):this.cycle())}to(e){var t,r=this._getItems();e>r.length-1||e<0||(this._isSliding?f.one(this._element,Ht,()=>this.to(e)):(t=this._getItemIndex(this._getActive()))!==e&&(t=t<e?Dt:Pt,this._slide(t,r[e])))}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&f.on(this._element,"keydown.bs.carousel",e=>this._keydown(e)),"hover"===this._config.pause&&(f.on(this._element,"mouseenter.bs.carousel",()=>this.pause()),f.on(this._element,"mouseleave.bs.carousel",()=>this._maybeEnableCycle())),this._config.touch&&Mt.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const e of d.find(".carousel-item img",this._element))f.on(e,"dragstart.bs.carousel",e=>e.preventDefault());const e={leftCallback:()=>this._slide(this._directionToOrder(Lt)),rightCallback:()=>this._slide(this._directionToOrder(Ft)),endCallback:()=>{"hover"===this._config.pause&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),500+this._config.interval))}};this._swipeHelper=new Mt(this._element,e)}_keydown(e){var t;/input|textarea/i.test(e.target.tagName)||(t=Bt[e.key])&&(e.preventDefault(),this._slide(this._directionToOrder(t)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){var t;this._indicatorsElement&&((t=d.findOne(Wt,this._indicatorsElement)).classList.remove(Vt),t.removeAttribute("aria-current"),t=d.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement))&&(t.classList.add(Vt),t.setAttribute("aria-current","true"))}_updateInterval(){var e=this._activeElement||this._getActive();e&&(e=Number.parseInt(e.getAttribute("data-bs-interval"),10),this._config.interval=e||this._config.defaultInterval)}_slide(t,e=null){if(!this._isSliding){const r=this._getActive(),n=t===Dt,i=e||ot(this._getItems(),r,n,this._config.wrap);if(i!==r){const o=this._getItemIndex(i),s=e=>f.trigger(this._element,e,{relatedTarget:i,direction:this._orderToDirection(t),from:this._getItemIndex(r),to:o});if(!s("slide.bs.carousel").defaultPrevented&&r&&i){e=Boolean(this._interval);this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(o),this._activeElement=i;const a=n?"carousel-item-start":"carousel-item-end",l=n?"carousel-item-next":"carousel-item-prev";i.classList.add(l),tt(i),r.classList.add(a),i.classList.add(a),this._queueCallback(()=>{i.classList.remove(a,l),i.classList.add(Vt),r.classList.remove(Vt,l,a),this._isSliding=!1,s(Ht)},r,this._isAnimated()),e&&this.cycle()}}}}_isAnimated(){return this._element.classList.contains("slide")}_getActive(){return d.findOne(".active.carousel-item",this._element)}_getItems(){return d.find($t,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return a()?e===Lt?Pt:Dt:e===Lt?Dt:Pt}_orderToDirection(e){return a()?e===Pt?Lt:Ft:e===Pt?Ft:Lt}static jQueryInterface(t){return this.each(function(){var e=Yt.getOrCreateInstance(this,t);if("number"!=typeof t){if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t]()}}else e.to(t)})}}f.on(document,"click.bs.carousel.data-api","[data-bs-slide], [data-bs-slide-to]",function(e){var t=d.getElementFromSelector(this);t&&t.classList.contains(Ut)&&(e.preventDefault(),e=Yt.getOrCreateInstance(t),(t=this.getAttribute("data-bs-slide-to"))?e.to(t):"next"===c.getDataAttribute(this,"slide")?e.next():e.prev(),e._maybeEnableCycle())}),f.on(window,"load.bs.carousel.data-api",()=>{for(const e of d.find('[data-bs-ride="carousel"]'))Yt.getOrCreateInstance(e)}),r(Yt);const Gt="show",qt="collapse",Kt="collapsing",Xt=(qt,qt,'[data-bs-toggle="collapse"]'),Jt={parent:null,toggle:!0},Zt={parent:"(null|element)",toggle:"boolean"};class Qt extends u{constructor(e,t){super(e,t),this._isTransitioning=!1,this._triggerArray=[];const r=d.find(Xt);for(const e of r){const t=d.getSelectorFromElement(e),r=d.find(t).filter(e=>e===this._element);null!==t&&r.length&&this._triggerArray.push(e)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return Jt}static get DefaultType(){return Zt}static get NAME(){return"collapse"}toggle(){this._isShown()?this.hide():this.show()}show(){if(!this._isTransitioning&&!this._isShown()){let e=[];if(!((e=this._config.parent?this._getFirstLevelChildren(".collapse.show, .collapse.collapsing").filter(e=>e!==this._element).map(e=>Qt.getOrCreateInstance(e,{toggle:!1})):e).length&&e[0]._isTransitioning||f.trigger(this._element,"show.bs.collapse").defaultPrevented)){for(const r of e)r.hide();const r=this._getDimension();this._element.classList.remove(qt),this._element.classList.add(Kt),this._element.style[r]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;var t="scroll"+(r[0].toUpperCase()+r.slice(1));this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(Kt),this._element.classList.add(qt,Gt),this._element.style[r]="",f.trigger(this._element,"shown.bs.collapse")},this._element,!0),this._element.style[r]=this._element[t]+"px"}}}hide(){if(!this._isTransitioning&&this._isShown()&&!f.trigger(this._element,"hide.bs.collapse").defaultPrevented){const t=this._getDimension();this._element.style[t]=this._element.getBoundingClientRect()[t]+"px",tt(this._element),this._element.classList.add(Kt),this._element.classList.remove(qt,Gt);for(const t of this._triggerArray){var e=d.getElementFromSelector(t);e&&!this._isShown(e)&&this._addAriaAndCollapsedClass([t],!1)}this._isTransitioning=!0,this._element.style[t]="",this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(Kt),this._element.classList.add(qt),f.trigger(this._element,"hidden.bs.collapse")},this._element,!0)}}_isShown(e=this._element){return e.classList.contains(Gt)}_configAfterMerge(e){return e.toggle=Boolean(e.toggle),e.parent=i(e.parent),e}_getDimension(){return this._element.classList.contains("collapse-horizontal")?"width":"height"}_initializeChildren(){if(this._config.parent){const e=this._getFirstLevelChildren(Xt);for(const t of e){const e=d.getElementFromSelector(t);e&&this._addAriaAndCollapsedClass([t],this._isShown(e))}}}_getFirstLevelChildren(e){const t=d.find(":scope .collapse .collapse",this._config.parent);return d.find(e,this._config.parent).filter(e=>!t.includes(e))}_addAriaAndCollapsedClass(e,t){if(e.length)for(const r of e)r.classList.toggle("collapsed",!t),r.setAttribute("aria-expanded",t)}static jQueryInterface(t){const r={};return"string"==typeof t&&/show|hide/.test(t)&&(r.toggle=!1),this.each(function(){var e=Qt.getOrCreateInstance(this,r);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}})}}f.on(document,"click.bs.collapse.data-api",Xt,function(e){("A"===e.target.tagName||e.delegateTarget&&"A"===e.delegateTarget.tagName)&&e.preventDefault();for(const e of d.getMultipleElementsFromSelector(this))Qt.getOrCreateInstance(e,{toggle:!1}).toggle()}),r(Qt);const er="dropdown",tr=".bs.dropdown",rr=".data-api",nr="ArrowDown",ir="click"+tr+rr,or="keydown"+tr+rr,sr="show",h='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',ar=(h,".dropdown-menu"),lr=a()?"top-end":"top-start",cr=a()?"top-start":"top-end",ur=a()?"bottom-end":"bottom-start",dr=a()?"bottom-start":"bottom-end",hr=a()?"left-start":"right-start",pr=a()?"right-start":"left-start",fr={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},gr={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class p extends u{constructor(e,t){super(e,t),this._popper=null,this._parent=this._element.parentNode,this._menu=d.next(this._element,ar)[0]||d.prev(this._element,ar)[0]||d.findOne(ar,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return fr}static get DefaultType(){return gr}static get NAME(){return er}toggle(){return this._isShown()?this.hide():this.show()}show(){if(!o(this._element)&&!this._isShown()){const e={relatedTarget:this._element};if(!f.trigger(this._element,"show.bs.dropdown",e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(".navbar-nav"))for(const e of[].concat(...document.body.children))f.on(e,"mouseover",et);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(sr),this._element.classList.add(sr),f.trigger(this._element,"shown.bs.dropdown",e)}}}hide(){var e;!o(this._element)&&this._isShown()&&(e={relatedTarget:this._element},this._completeHide(e))}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!f.trigger(this._element,"hide.bs.dropdown",e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const e of[].concat(...document.body.children))f.off(e,"mouseover",et);this._popper&&this._popper.destroy(),this._menu.classList.remove(sr),this._element.classList.remove(sr),this._element.setAttribute("aria-expanded","false"),c.removeDataAttribute(this._menu,"popper"),f.trigger(this._element,"hidden.bs.dropdown",e),this._element.focus()}}_getConfig(e){if("object"!=typeof(e=super._getConfig(e)).reference||s(e.reference)||"function"==typeof e.reference.getBoundingClientRect)return e;throw new TypeError(er.toUpperCase()+': Option "reference" provided type "object" without a required "getBoundingClientRect" method.')}_createPopper(){if(void 0===Ge)throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;"parent"===this._config.reference?e=this._parent:s(this._config.reference)?e=i(this._config.reference):"object"==typeof this._config.reference&&(e=this._config.reference);var t=this._getPopperConfig();this._popper=Ye(e,this._menu,t)}_isShown(){return this._menu.classList.contains(sr)}_getPlacement(){var e,t=this._parent;return t.classList.contains("dropend")?hr:t.classList.contains("dropstart")?pr:t.classList.contains("dropup-center")?"top":t.classList.contains("dropdown-center")?"bottom":(e="end"===getComputedStyle(this._menu).getPropertyValue("--bs-position").trim(),t.classList.contains("dropup")?e?cr:lr:e?dr:ur)}_detectNavbar(){return null!==this._element.closest(".navbar")}_getOffset(){const t=this._config["offset"];return"string"==typeof t?t.split(",").map(e=>Number.parseInt(e,10)):"function"==typeof t?e=>t(e,this._element):t}_getPopperConfig(){var e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return!this._inNavbar&&"static"!==this._config.display||(c.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...l(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:t}){var r=d.find(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",this._menu).filter(e=>Ze(e));r.length&&ot(r,t,e===nr,!r.includes(t)).focus()}static jQueryInterface(t){return this.each(function(){var e=p.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}})}static clearMenus(e){if(2!==e.button&&("keyup"!==e.type||"Tab"===e.key)){const n=d.find('[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled).show');for(const i of n){const n=p.getInstance(i);var t,r;n&&!1!==n._config.autoClose&&(t=(r=e.composedPath()).includes(n._menu),r.includes(n._element)||"inside"===n._config.autoClose&&!t||"outside"===n._config.autoClose&&t||n._menu.contains(e.target)&&("keyup"===e.type&&"Tab"===e.key||/input|select|option|textarea|form/i.test(e.target.tagName))||(r={relatedTarget:n._element},"click"===e.type&&(r.clickEvent=e),n._completeHide(r)))}}}static dataApiKeydownHandler(e){var t=/input|textarea/i.test(e.target.tagName),r="Escape"===e.key,n=["ArrowUp",nr].includes(e.key);!n&&!r||t&&!r||(e.preventDefault(),t=this.matches(h)?this:d.prev(this,h)[0]||d.next(this,h)[0]||d.findOne(h,e.delegateTarget.parentNode),r=p.getOrCreateInstance(t),n?(e.stopPropagation(),r.show(),r._selectMenuItem(e)):r._isShown()&&(e.stopPropagation(),r.hide(),t.focus()))}}f.on(document,or,h,p.dataApiKeydownHandler),f.on(document,or,ar,p.dataApiKeydownHandler),f.on(document,ir,p.clearMenus),f.on(document,"keyup.bs.dropdown.data-api",p.clearMenus),f.on(document,ir,h,function(e){e.preventDefault(),p.getOrCreateInstance(this).toggle()}),r(p);const mr="backdrop",yr="mousedown.bs."+mr,vr={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},br={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class wr extends Tt{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return vr}static get DefaultType(){return br}static get NAME(){return mr}show(e){var t;this._config.isVisible?(this._append(),t=this._getElement(),this._config.isAnimated&&tt(t),t.classList.add("show"),this._emulateAnimation(()=>{l(e)})):l(e)}hide(e){this._config.isVisible?(this._getElement().classList.remove("show"),this._emulateAnimation(()=>{this.dispose(),l(e)})):l(e)}dispose(){this._isAppended&&(f.off(this._element,yr),this._element.remove(),this._isAppended=!1)}_getElement(){var e;return this._element||((e=document.createElement("div")).className=this._config.className,this._config.isAnimated&&e.classList.add("fade"),this._element=e),this._element}_configAfterMerge(e){return e.rootElement=i(e.rootElement),e}_append(){var e;this._isAppended||(e=this._getElement(),this._config.rootElement.append(e),f.on(e,yr,()=>{l(this._config.clickCallback)}),this._isAppended=!0)}_emulateAnimation(e){it(e,this._getElement(),this._config.isAnimated)}}const Cr=".bs.focustrap",Er=(Cr,Cr,"backward"),Tr={autofocus:!0,trapElement:null},Sr={autofocus:"boolean",trapElement:"element"};class _r extends Tt{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Tr}static get DefaultType(){return Sr}static get NAME(){return"focustrap"}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),f.off(document,Cr),f.on(document,"focusin.bs.focustrap",e=>this._handleFocusin(e)),f.on(document,"keydown.tab.bs.focustrap",e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,f.off(document,Cr))}_handleFocusin(e){var t=this._config["trapElement"];e.target===document||e.target===t||t.contains(e.target)||(0===(e=d.focusableChildren(t)).length?t:this._lastTabNavDirection===Er?e[e.length-1]:e[0]).focus()}_handleKeydown(e){"Tab"===e.key&&(this._lastTabNavDirection=e.shiftKey?Er:"forward")}}const xr=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Rr=".sticky-top",Ar="padding-right",Nr="margin-right";class Or{constructor(){this._element=document.body}getWidth(){var e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const t=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Ar,e=>e+t),this._setElementAttributes(xr,Ar,e=>e+t),this._setElementAttributes(Rr,Nr,e=>e-t)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Ar),this._resetElementAttributes(xr,Ar),this._resetElementAttributes(Rr,Nr)}isOverflowing(){return 0<this.getWidth()}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,r,n){const i=this.getWidth();this._applyManipulationCallback(e,e=>{var t;e!==this._element&&window.innerWidth>e.clientWidth+i||(this._saveInitialAttribute(e,r),t=window.getComputedStyle(e).getPropertyValue(r),e.style.setProperty(r,n(Number.parseFloat(t))+"px"))})}_saveInitialAttribute(e,t){var r=e.style.getPropertyValue(t);r&&c.setDataAttribute(e,t,r)}_resetElementAttributes(e,r){this._applyManipulationCallback(e,e=>{var t=c.getDataAttribute(e,r);null!==t?(c.removeDataAttribute(e,r),e.style.setProperty(r,t)):e.style.removeProperty(r)})}_applyManipulationCallback(e,t){if(s(e))t(e);else for(const r of d.find(e,this._element))t(r)}}const g=".bs.modal",Ir=(g,g,"hidden"+g),Mr="show"+g,kr=(g,g,g,g,g,g,"modal-open"),Dr="modal-static",Pr={backdrop:!0,focus:!0,keyboard:!0},Lr={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class T extends u{constructor(e,t){super(e,t),this._dialog=d.findOne(".modal-dialog",this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Or,this._addEventListeners()}static get Default(){return Pr}static get DefaultType(){return Lr}static get NAME(){return"modal"}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||f.trigger(this._element,Mr,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(kr),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||f.trigger(this._element,"hide.bs.modal").defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove("show"),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){f.off(window,g),f.off(this._dialog,g),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new wr({isVisible:Boolean(this._config.backdrop),isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new _r({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;var t=d.findOne(".modal-body",this._dialog);t&&(t.scrollTop=0),tt(this._element),this._element.classList.add("show"),this._queueCallback(()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,f.trigger(this._element,"shown.bs.modal",{relatedTarget:e})},this._dialog,this._isAnimated())}_addEventListeners(){f.on(this._element,"keydown.dismiss.bs.modal",e=>{"Escape"===e.key&&(this._config.keyboard?this.hide():this._triggerBackdropTransition())}),f.on(window,"resize.bs.modal",()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),f.on(this._element,"mousedown.dismiss.bs.modal",t=>{f.one(this._element,"click.dismiss.bs.modal",e=>{this._element===t.target&&this._element===e.target&&("static"!==this._config.backdrop?this._config.backdrop&&this.hide():this._triggerBackdropTransition())})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(kr),this._resetAdjustments(),this._scrollBar.reset(),f.trigger(this._element,Ir)})}_isAnimated(){return this._element.classList.contains("fade")}_triggerBackdropTransition(){if(!f.trigger(this._element,"hidePrevented.bs.modal").defaultPrevented){const e=this._element.scrollHeight>document.documentElement.clientHeight,t=this._element.style.overflowY;"hidden"===t||this._element.classList.contains(Dr)||(e||(this._element.style.overflowY="hidden"),this._element.classList.add(Dr),this._queueCallback(()=>{this._element.classList.remove(Dr),this._queueCallback(()=>{this._element.style.overflowY=t},this._dialog)},this._dialog),this._element.focus())}}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,t=this._scrollBar.getWidth(),r=0<t;if(r&&!e){const e=a()?"paddingLeft":"paddingRight";this._element.style[e]=t+"px"}if(!r&&e){const e=a()?"paddingRight":"paddingLeft";this._element.style[e]=t+"px"}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(t,r){return this.each(function(){var e=T.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t](r)}})}}f.on(document,"click.bs.modal.data-api",'[data-bs-toggle="modal"]',function(e){const t=d.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&e.preventDefault(),f.one(t,Mr,e=>{e.defaultPrevented||f.one(t,Ir,()=>{Ze(this)&&this.focus()})});e=d.findOne(".modal.show");e&&T.getInstance(e).hide(),T.getOrCreateInstance(t).toggle(this)}),_t(T),r(T);const Fr=".bs.offcanvas",Hr="showing",Ur=".offcanvas.show",Vr="hidePrevented"+Fr,Wr="hidden"+Fr,$r={backdrop:!0,keyboard:!0,scroll:!1},Br={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class S extends u{constructor(e,t){super(e,t),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return $r}static get DefaultType(){return Br}static get NAME(){return"offcanvas"}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||f.trigger(this._element,"show.bs.offcanvas",{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._backdrop.show(),this._config.scroll||(new Or).hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(Hr),this._queueCallback(()=>{this._config.scroll&&!this._config.backdrop||this._focustrap.activate(),this._element.classList.add("show"),this._element.classList.remove(Hr),f.trigger(this._element,"shown.bs.offcanvas",{relatedTarget:e})},this._element,!0))}hide(){!this._isShown||f.trigger(this._element,"hide.bs.offcanvas").defaultPrevented||(this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add("hiding"),this._backdrop.hide(),this._queueCallback(()=>{this._element.classList.remove("show","hiding"),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||(new Or).reset(),f.trigger(this._element,Wr)},this._element,!0))}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){var e=Boolean(this._config.backdrop);return new wr({className:"offcanvas-backdrop",isVisible:e,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:e?()=>{"static"!==this._config.backdrop?this.hide():f.trigger(this._element,Vr)}:null})}_initializeFocusTrap(){return new _r({trapElement:this._element})}_addEventListeners(){f.on(this._element,"keydown.dismiss.bs.offcanvas",e=>{"Escape"===e.key&&(this._config.keyboard?this.hide():f.trigger(this._element,Vr))})}static jQueryInterface(t){return this.each(function(){var e=S.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t](this)}})}}f.on(document,"click.bs.offcanvas.data-api",'[data-bs-toggle="offcanvas"]',function(e){var t=d.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&e.preventDefault(),o(this)||(f.one(t,Wr,()=>{Ze(this)&&this.focus()}),(e=d.findOne(Ur))&&e!==t&&S.getInstance(e).hide(),S.getOrCreateInstance(t).toggle(this))}),f.on(window,"load.bs.offcanvas.data-api",()=>{for(const e of d.find(Ur))S.getOrCreateInstance(e).show()}),f.on(window,"resize.bs.offcanvas",()=>{for(const e of d.find("[aria-modal][class*=show][class*=offcanvas-]"))"fixed"!==getComputedStyle(e).position&&S.getOrCreateInstance(e).hide()}),_t(S),r(S);const jr={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},zr=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),Yr=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,Gr={allowList:jr,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},qr={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},Kr={entry:"(string|element|function|null)",selector:"(string|element)"};class Xr extends Tt{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return Gr}static get DefaultType(){return qr}static get NAME(){return"TemplateFactory"}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return 0<this.getContent().length}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){var e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[t,r]of Object.entries(this._config.content))this._setContent(e,r,t);const t=e.children[0],r=this._resolvePossibleFunction(this._config.extraClass);return r&&t.classList.add(...r.split(" ")),t}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(var[t,r]of Object.entries(e))super._typeCheckConfig({selector:t,entry:r},Kr)}_setContent(e,t,r){r=d.findOne(r,e);r&&((t=this._resolvePossibleFunction(t))?s(t)?this._putElementInTemplate(i(t),r):this._config.html?r.innerHTML=this._maybeSanitize(t):r.textContent=t:r.remove())}_maybeSanitize(e){if(this._config.sanitize){var t=e,r=this._config.allowList,n=this._config.sanitizeFn;if(!t.length)return t;if(n&&"function"==typeof n)return n(t);const i=(new window.DOMParser).parseFromString(t,"text/html"),o=[].concat(...i.body.querySelectorAll("*"));for(const t of o){const n=t.nodeName.toLowerCase();if(Object.keys(r).includes(n)){const i=[].concat(...t.attributes),o=[].concat(r["*"]||[],r[n]||[]);for(const r of i)((e,t)=>{const r=e.nodeName.toLowerCase();return t.includes(r)?!zr.has(r)||Boolean(Yr.test(e.nodeValue)):t.filter(e=>e instanceof RegExp).some(e=>e.test(r))})(r,o)||t.removeAttribute(r.nodeName)}else t.remove()}return i.body.innerHTML}return e}_resolvePossibleFunction(e){return l(e,[void 0,this])}_putElementInTemplate(e,t){this._config.html?(t.innerHTML="",t.append(e)):t.textContent=e.textContent}}const Jr=new Set(["sanitize","allowList","sanitizeFn"]),Zr="fade",Qr="show",en="hide.bs.modal",tn="hover",rn="focus",nn={AUTO:"auto",TOP:"top",RIGHT:a()?"left":"right",BOTTOM:"bottom",LEFT:a()?"right":"left"},on={allowList:jr,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},sn={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class _ extends u{constructor(e,t){if(void 0===Ge)throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,t),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return on}static get DefaultType(){return sn}static get NAME(){return"tooltip"}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){this._isEnabled&&(this._isShown()?this._leave():this._enter())}dispose(){clearTimeout(this._timeout),f.off(this._element.closest(".modal"),en,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if("none"===this._element.style.display)throw new Error("Please use show on visible elements");if(this._isWithContent()&&this._isEnabled){const r=f.trigger(this._element,this.constructor.eventName("show")),n=(Qe(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(!r.defaultPrevented&&n){this._disposePopper();var e=this._getTipElement(),t=(this._element.setAttribute("aria-describedby",e.getAttribute("id")),this._config)["container"];if(this._element.ownerDocument.documentElement.contains(this.tip)||(t.append(e),f.trigger(this._element,this.constructor.eventName("inserted"))),this._popper=this._createPopper(e),e.classList.add(Qr),"ontouchstart"in document.documentElement)for(const r of[].concat(...document.body.children))f.on(r,"mouseover",et);this._queueCallback(()=>{f.trigger(this._element,this.constructor.eventName("shown")),!1===this._isHovered&&this._leave(),this._isHovered=!1},this.tip,this._isAnimated())}}}hide(){if(this._isShown()&&!f.trigger(this._element,this.constructor.eventName("hide")).defaultPrevented){if(this._getTipElement().classList.remove(Qr),"ontouchstart"in document.documentElement)for(const e of[].concat(...document.body.children))f.off(e,"mouseover",et);this._activeTrigger.click=!1,this._activeTrigger[rn]=!1,this._activeTrigger[tn]=!1,this._isHovered=null,this._queueCallback(()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),f.trigger(this._element,this.constructor.eventName("hidden")))},this.tip,this._isAnimated())}}update(){this._popper&&this._popper.update()}_isWithContent(){return Boolean(this._getTitle())}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){e=this._getTemplateFactory(e).toHtml();if(!e)return null;e.classList.remove(Zr,Qr),e.classList.add(`bs-${this.constructor.NAME}-auto`);var t=(e=>{for(;e+=Math.floor(1e6*Math.random()),document.getElementById(e););return e})(this.constructor.NAME).toString();return e.setAttribute("id",t),this._isAnimated()&&e.classList.add(Zr),e}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new Xr({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{".tooltip-inner":this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Zr)}_isShown(){return this.tip&&this.tip.classList.contains(Qr)}_createPopper(e){var t=l(this._config.placement,[this,e,this._element]),t=nn[t.toUpperCase()];return Ye(this._element,e,this._getPopperConfig(t))}_getOffset(){const t=this._config["offset"];return"string"==typeof t?t.split(",").map(e=>Number.parseInt(e,10)):"function"==typeof t?e=>t(e,this._element):t}_resolvePossibleFunction(e){return l(e,[this._element,this._element])}_getPopperConfig(e){e={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:e=>{this._getTipElement().setAttribute("data-popper-placement",e.state.placement)}}]};return{...e,...l(this._config.popperConfig,[void 0,e])}}_setListeners(){const e=this._config.trigger.split(" ");for(const t of e)if("click"===t)f.on(this._element,this.constructor.eventName("click"),this._config.selector,e=>{this._initializeOnDelegatedTarget(e).toggle()});else if("manual"!==t){const e=t===tn?this.constructor.eventName("mouseenter"):this.constructor.eventName("focusin"),r=t===tn?this.constructor.eventName("mouseleave"):this.constructor.eventName("focusout");f.on(this._element,e,this._config.selector,e=>{var t=this._initializeOnDelegatedTarget(e);t._activeTrigger["focusin"===e.type?rn:tn]=!0,t._enter()}),f.on(this._element,r,this._config.selector,e=>{var t=this._initializeOnDelegatedTarget(e);t._activeTrigger["focusout"===e.type?rn:tn]=t._element.contains(e.relatedTarget),t._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},f.on(this._element.closest(".modal"),en,this._hideModalHandler)}_fixTitle(){var e=this._element.getAttribute("title");e&&(this._element.getAttribute("aria-label")||this._element.textContent.trim()||this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){this._isShown()||this._isHovered?this._isHovered=!0:(this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show))}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,t){clearTimeout(this._timeout),this._timeout=setTimeout(e,t)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){var t=c.getDataAttributes(this._element);for(const e of Object.keys(t))Jr.has(e)&&delete t[e];return e={...t,..."object"==typeof e&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=!1===e.container?document.body:i(e.container),"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),"number"==typeof e.title&&(e.title=e.title.toString()),"number"==typeof e.content&&(e.content=e.content.toString()),e}_getDelegateConfig(){var e,t,r={};for([e,t]of Object.entries(this._config))this.constructor.Default[e]!==t&&(r[e]=t);return r.selector=!1,r.trigger="manual",r}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(t){return this.each(function(){var e=_.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}})}}r(_);const an={..._.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},ln={..._.DefaultType,content:"(null|string|element|function)"};class cn extends _{static get Default(){return an}static get DefaultType(){return ln}static get NAME(){return"popover"}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{".popover-header":this._getTitle(),".popover-body":this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(t){return this.each(function(){var e=cn.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}})}}r(cn);const un=".bs.scrollspy",dn="click"+un,hn="active",pn="[href]",fn={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},gn={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class mn extends u{constructor(e,t){super(e,t),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement="visible"===getComputedStyle(this._element).overflowY?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return fn}static get DefaultType(){return gn}static get NAME(){return"scrollspy"}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=i(e.target)||document.body,e.rootMargin=e.offset?e.offset+"px 0px -30%":e.rootMargin,"string"==typeof e.threshold&&(e.threshold=e.threshold.split(",").map(e=>Number.parseFloat(e))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(f.off(this._config.target,dn),f.on(this._config.target,dn,pn,e=>{var t=this._observableSections.get(e.target.hash);t&&(e.preventDefault(),e=this._rootElement||window,t=t.offsetTop-this._element.offsetTop,e.scrollTo?e.scrollTo({top:t,behavior:"smooth"}):e.scrollTop=t)}))}_getNewObserver(){var e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(e=>this._observerCallback(e),e)}_observerCallback(e){const t=e=>this._targetLinks.get("#"+e.target.id),r=e=>{this._previousScrollData.visibleEntryTop=e.target.offsetTop,this._process(t(e))},n=(this._rootElement||document.documentElement).scrollTop,i=n>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=n;for(const o of e)if(o.isIntersecting){const e=o.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(i&&e){if(r(o),!n)return}else i||e||r(o)}else this._activeTarget=null,this._clearActiveClass(t(o))}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=d.find(pn,this._config.target);for(const t of e)if(t.hash&&!o(t)){const e=d.findOne(decodeURI(t.hash),this._element);Ze(e)&&(this._targetLinks.set(decodeURI(t.hash),t),this._observableSections.set(t.hash,e))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),(this._activeTarget=e).classList.add(hn),this._activateParents(e),f.trigger(this._element,"activate.bs.scrollspy",{relatedTarget:e}))}_activateParents(e){if(e.classList.contains("dropdown-item"))d.findOne(".dropdown-toggle",e.closest(".dropdown")).classList.add(hn);else for(const t of d.parents(e,".nav, .list-group"))for(const e of d.prev(t,".nav-link, .nav-item > .nav-link, .list-group-item"))e.classList.add(hn)}_clearActiveClass(e){e.classList.remove(hn);var t=d.find(pn+"."+hn,e);for(const e of t)e.classList.remove(hn)}static jQueryInterface(t){return this.each(function(){var e=mn.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t]()}})}}f.on(window,"load.bs.scrollspy.data-api",()=>{for(const e of d.find('[data-bs-spy="scroll"]'))mn.getOrCreateInstance(e)}),r(mn);const yn="ArrowRight",vn="ArrowDown",bn="Home",D="active",wn="show",Cn=".dropdown-toggle",En=`:not(${Cn})`,Tn='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Sn=`.nav-link${En}, .list-group-item${En}, [role="tab"]${En}, `+Tn;D,D,D;class P extends u{constructor(e){super(e),this._parent=this._element.closest('.list-group, .nav, [role="tablist"]'),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),f.on(this._element,"keydown.bs.tab",e=>this._keydown(e)))}static get NAME(){return"tab"}show(){var e,t,r=this._element;this._elemIsActive(r)||(t=(e=this._getActiveElem())?f.trigger(e,"hide.bs.tab",{relatedTarget:r}):null,f.trigger(r,"show.bs.tab",{relatedTarget:e}).defaultPrevented)||t&&t.defaultPrevented||(this._deactivate(e,r),this._activate(r,e))}_activate(e,t){e&&(e.classList.add(D),this._activate(d.getElementFromSelector(e)),this._queueCallback(()=>{"tab"===e.getAttribute("role")?(e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),f.trigger(e,"shown.bs.tab",{relatedTarget:t})):e.classList.add(wn)},e,e.classList.contains("fade")))}_deactivate(e,t){e&&(e.classList.remove(D),e.blur(),this._deactivate(d.getElementFromSelector(e)),this._queueCallback(()=>{"tab"===e.getAttribute("role")?(e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),f.trigger(e,"hidden.bs.tab",{relatedTarget:t})):e.classList.remove(wn)},e,e.classList.contains("fade")))}_keydown(t){if(["ArrowLeft",yn,"ArrowUp",vn,bn,"End"].includes(t.key)){t.stopPropagation(),t.preventDefault();var r,n=this._getChildren().filter(e=>!o(e));let e;(e=[bn,"End"].includes(t.key)?n[t.key===bn?0:n.length-1]:(r=[yn,vn].includes(t.key),ot(n,t.target,r,!0)))&&(e.focus({preventScroll:!0}),P.getOrCreateInstance(e).show())}}_getChildren(){return d.find(Sn,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,t){this._setAttributeIfNotExists(e,"role","tablist");for(const e of t)this._setInitialAttributesOnChild(e)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);var t=this._elemIsActive(e),r=this._getOuterElement(e);e.setAttribute("aria-selected",t),r!==e&&this._setAttributeIfNotExists(r,"role","presentation"),t||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){var t=d.getElementFromSelector(e);t&&(this._setAttributeIfNotExists(t,"role","tabpanel"),e.id)&&this._setAttributeIfNotExists(t,"aria-labelledby",""+e.id)}_toggleDropDown(e,r){const n=this._getOuterElement(e);n.classList.contains("dropdown")&&((e=(e,t)=>{e=d.findOne(e,n);e&&e.classList.toggle(t,r)})(Cn,D),e(".dropdown-menu",wn),n.setAttribute("aria-expanded",r))}_setAttributeIfNotExists(e,t,r){e.hasAttribute(t)||e.setAttribute(t,r)}_elemIsActive(e){return e.classList.contains(D)}_getInnerElement(e){return e.matches(Sn)?e:d.findOne(Sn,e)}_getOuterElement(e){return e.closest(".nav-item, .list-group-item")||e}static jQueryInterface(t){return this.each(function(){var e=P.getOrCreateInstance(this);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t]()}})}}f.on(document,"click.bs.tab",Tn,function(e){["A","AREA"].includes(this.tagName)&&e.preventDefault(),o(this)||P.getOrCreateInstance(this).show()}),f.on(window,"load.bs.tab",()=>{for(const e of d.find('.active[data-bs-toggle="tab"], .active[data-bs-toggle="pill"], .active[data-bs-toggle="list"]'))P.getOrCreateInstance(e)}),r(P);const _n="show",xn="showing",Rn={animation:"boolean",autohide:"boolean",delay:"number"},An={animation:!0,autohide:!0,delay:5e3};class Nn extends u{constructor(e,t){super(e,t),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return An}static get DefaultType(){return Rn}static get NAME(){return"toast"}show(){f.trigger(this._element,"show.bs.toast").defaultPrevented||(this._clearTimeout(),this._config.animation&&this._element.classList.add("fade"),this._element.classList.remove("hide"),tt(this._element),this._element.classList.add(_n,xn),this._queueCallback(()=>{this._element.classList.remove(xn),f.trigger(this._element,"shown.bs.toast"),this._maybeScheduleHide()},this._element,this._config.animation))}hide(){!this.isShown()||f.trigger(this._element,"hide.bs.toast").defaultPrevented||(this._element.classList.add(xn),this._queueCallback(()=>{this._element.classList.add("hide"),this._element.classList.remove(xn,_n),f.trigger(this._element,"hidden.bs.toast")},this._element,this._config.animation))}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(_n),super.dispose()}isShown(){return this._element.classList.contains(_n)}_maybeScheduleHide(){!this._config.autohide||this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay))}_onInteraction(e,t){switch(e.type){case"mouseover":case"mouseout":this._hasMouseInteraction=t;break;case"focusin":case"focusout":this._hasKeyboardInteraction=t}t?this._clearTimeout():(e=e.relatedTarget,this._element===e||this._element.contains(e)||this._maybeScheduleHide())}_setListeners(){f.on(this._element,"mouseover.bs.toast",e=>this._onInteraction(e,!0)),f.on(this._element,"mouseout.bs.toast",e=>this._onInteraction(e,!1)),f.on(this._element,"focusin.bs.toast",e=>this._onInteraction(e,!0)),f.on(this._element,"focusout.bs.toast",e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(t){return this.each(function(){var e=Nn.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t](this)}})}}_t(Nn),r(Nn);G=Object.freeze(Object.defineProperty({__proto__:null,Alert:xt,Button:At,Carousel:Yt,Collapse:Qt,Dropdown:p,Modal:T,Offcanvas:S,Popover:cn,ScrollSpy:mn,Tab:P,Toast:Nn,Tooltip:_},Symbol.toStringTag,{value:"Module"}));[].slice.call(document.querySelectorAll('[data-bs-toggle="dropdown"]')).map(function(e){var t={boundary:"viewport"===e.getAttribute("data-bs-boundary")?document.querySelector(".btn"):"clippingParents"};return new p(e,t)}),[].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]')).map(function(e){var t={delay:{show:50,hide:50},html:"true"===e.getAttribute("data-bs-html")??!1,placement:e.getAttribute("data-bs-placement")??"auto"};return new _(e,t)}),[].slice.call(document.querySelectorAll('[data-bs-toggle="popover"]')).map(function(e){var t={delay:{show:50,hide:50},html:"true"===e.getAttribute("data-bs-html")??!1,placement:e.getAttribute("data-bs-placement")??"auto"};return new cn(e,t)}),[].slice.call(document.querySelectorAll('[data-bs-toggle="switch-icon"]')).map(function(t){t.addEventListener("click",e=>{e.stopPropagation(),t.classList.toggle("active")})});{const Mn=window.location.hash;Mn&&[].slice.call(document.querySelectorAll('[data-bs-toggle="tab"]')).filter(e=>e.hash===Mn).map(e=>{new P(e).show()})}[].slice.call(document.querySelectorAll('[data-bs-toggle="toast"]')).map(function(e){if(e.hasAttribute("data-bs-target")){const t=new Nn(e.getAttribute("data-bs-target"));e.addEventListener("click",()=>{t.show()})}});const On=(e,t)=>{e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return e?`rgba(${parseInt(e[1],16)}, ${parseInt(e[2],16)}, ${parseInt(e[3],16)}, ${t})`:null},In=Object.freeze(Object.defineProperty({__proto__:null,getColor:(e,t=1)=>{e=getComputedStyle(document.body).getPropertyValue("--tblr-"+e).trim();return 1!==t?On(e,t):e},hexToRgba:On,prefix:"tblr-"},Symbol.toStringTag,{value:"Module"}));e.Alert=xt,e.Button=At,e.Carousel=Yt,e.Collapse=Qt,e.Dropdown=p,e.Modal=T,e.Offcanvas=S,e.Popover=cn,e.ScrollSpy=mn,e.Tab=P,e.Toast=Nn,e.Tooltip=_,e.bootstrap=G,e.tabler=In,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}),!function(e,t){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(e.document)return t(e);throw new Error("jQuery requires a window with a document")}:t(e)}("undefined"!=typeof window?window:this,function(C,L){"use strict";function v(e){return"function"==typeof e&&"number"!=typeof e.nodeType&&"function"!=typeof e.item}function F(e){return null!=e&&e===e.window}var t=[],H=Object.getPrototypeOf,a=t.slice,U=t.flat?function(e){return t.flat.call(e)}:function(e){return t.concat.apply([],e)},V=t.push,b=t.indexOf,W={},$=W.toString,B=W.hasOwnProperty,j=B.toString,z=j.call(Object),g={},E=C.document,Y={type:!0,src:!0,nonce:!0,noModule:!0};function G(e,t,r){var n,i,o=(r=r||E).createElement("script");if(o.text=e,t)for(n in Y)(i=t[n]||t.getAttribute&&t.getAttribute(n))&&o.setAttribute(n,i);r.head.appendChild(o).parentNode.removeChild(o)}function q(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?W[$.call(e)]||"object":typeof e}var K=/HTML$/i,T=function(e,t){return new T.fn.init(e,t)};function X(e){var t=!!e&&"length"in e&&e.length,r=q(e);return!v(e)&&!F(e)&&("array"===r||0===t||"number"==typeof t&&0<t&&t-1 in e)}function w(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}T.fn=T.prototype={jquery:"3.7.1",constructor:T,length:0,toArray:function(){return a.call(this)},get:function(e){return null==e?a.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){e=T.merge(this.constructor(),e);return e.prevObject=this,e},each:function(e){return T.each(this,e)},map:function(r){return this.pushStack(T.map(this,function(e,t){return r.call(e,t,e)}))},slice:function(){return this.pushStack(a.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(T.grep(this,function(e,t){return(t+1)%2}))},odd:function(){return this.pushStack(T.grep(this,function(e,t){return t%2}))},eq:function(e){var t=this.length,e=+e+(e<0?t:0);return this.pushStack(0<=e&&e<t?[this[e]]:[])},end:function(){return this.prevObject||this.constructor()},push:V,sort:t.sort,splice:t.splice},T.extend=T.fn.extend=function(){var e,t,r,n,i,o=arguments[0]||{},s=1,a=arguments.length,l=!1;for("boolean"==typeof o&&(l=o,o=arguments[s]||{},s++),"object"==typeof o||v(o)||(o={}),s===a&&(o=this,s--);s<a;s++)if(null!=(e=arguments[s]))for(t in e)r=e[t],"__proto__"!==t&&o!==r&&(l&&r&&(T.isPlainObject(r)||(n=Array.isArray(r)))?(i=o[t],i=n&&!Array.isArray(i)?[]:n||T.isPlainObject(i)?i:{},n=!1,o[t]=T.extend(l,i,r)):void 0!==r&&(o[t]=r));return o},T.extend({expando:"jQuery"+("3.7.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){return!(!e||"[object Object]"!==$.call(e)||(e=H(e))&&("function"!=typeof(e=B.call(e,"constructor")&&e.constructor)||j.call(e)!==z))},isEmptyObject:function(e){for(var t in e)return!1;return!0},globalEval:function(e,t,r){G(e,{nonce:t&&t.nonce},r)},each:function(e,t){var r,n=0;if(X(e))for(r=e.length;n<r&&!1!==t.call(e[n],n,e[n]);n++);else for(n in e)if(!1===t.call(e[n],n,e[n]))break;return e},text:function(e){var t,r="",n=0,i=e.nodeType;if(!i)for(;t=e[n++];)r+=T.text(t);return 1===i||11===i?e.textContent:9===i?e.documentElement.textContent:3===i||4===i?e.nodeValue:r},makeArray:function(e,t){t=t||[];return null!=e&&(X(Object(e))?T.merge(t,"string"==typeof e?[e]:e):V.call(t,e)),t},inArray:function(e,t,r){return null==t?-1:b.call(t,e,r)},isXMLDoc:function(e){var t=e&&e.namespaceURI,e=e&&(e.ownerDocument||e).documentElement;return!K.test(t||e&&e.nodeName||"HTML")},merge:function(e,t){for(var r=+t.length,n=0,i=e.length;n<r;n++)e[i++]=t[n];return e.length=i,e},grep:function(e,t,r){for(var n=[],i=0,o=e.length,s=!r;i<o;i++)!t(e[i],i)!=s&&n.push(e[i]);return n},map:function(e,t,r){var n,i,o=0,s=[];if(X(e))for(n=e.length;o<n;o++)null!=(i=t(e[o],o,r))&&s.push(i);else for(o in e)null!=(i=t(e[o],o,r))&&s.push(i);return U(s)},guid:1,support:g}),"function"==typeof Symbol&&(T.fn[Symbol.iterator]=t[Symbol.iterator]),T.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){W["[object "+t+"]"]=t.toLowerCase()});var J=t.pop,Z=t.sort,Q=t.splice,r="[\\x20\\t\\r\\n\\f]",ee=new RegExp("^"+r+"+|((?:^|[^\\\\])(?:\\\\.)*)"+r+"+$","g"),te=(T.contains=function(e,t){t=t&&t.parentNode;return e===t||!(!t||1!==t.nodeType||!(e.contains?e.contains(t):e.compareDocumentPosition&&16&e.compareDocumentPosition(t)))},/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g);function re(e,t){return t?"\0"===e?"�":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e}T.escapeSelector=function(e){return(e+"").replace(te,re)};var ne,S,ie,oe,se,_,n,x,h,ae,i=E,le=V,R=le,A=T.expando,N=0,ce=0,ue=Ne(),de=Ne(),he=Ne(),pe=Ne(),fe=function(e,t){return e===t&&(se=!0),0},ge="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",e="(?:\\\\[\\da-fA-F]{1,6}"+r+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",o="\\["+r+"*("+e+")(?:"+r+"*([*^$|!~]?=)"+r+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+e+"))|)"+r+"*\\]",s=":("+e+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+o+")*)|.*)\\)|)",me=new RegExp(r+"+","g"),ye=new RegExp("^"+r+"*,"+r+"*"),ve=new RegExp("^"+r+"*([>+~]|"+r+")"+r+"*"),be=new RegExp(r+"|>"),we=new RegExp(s),Ce=new RegExp("^"+e+"$"),Ee={ID:new RegExp("^#("+e+")"),CLASS:new RegExp("^\\.("+e+")"),TAG:new RegExp("^("+e+"|[*])"),ATTR:new RegExp("^"+o),PSEUDO:new RegExp("^"+s),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+r+"*(even|odd|(([+-]|)(\\d*)n|)"+r+"*(?:([+-]|)"+r+"*(\\d+)|))"+r+"*\\)|)","i"),bool:new RegExp("^(?:"+ge+")$","i"),needsContext:new RegExp("^"+r+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+r+"*((?:-\\d)?\\d*)"+r+"*\\)|)(?=[^-]|$)","i")},Te=/^(?:input|select|textarea|button)$/i,Se=/^h\d$/i,_e=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,xe=/[+~]/,d=new RegExp("\\\\[\\da-fA-F]{1,6}"+r+"?|\\\\([^\\r\\n\\f])","g"),p=function(e,t){e="0x"+e.slice(1)-65536;return t||(e<0?String.fromCharCode(65536+e):String.fromCharCode(e>>10|55296,1023&e|56320))},Re=function(){De()},Ae=He(function(e){return!0===e.disabled&&w(e,"fieldset")},{dir:"parentNode",next:"legend"});try{R.apply(t=a.call(i.childNodes),i.childNodes),t[i.childNodes.length].nodeType}catch(e){R={apply:function(e,t){le.apply(e,a.call(t))},call:function(e){le.apply(e,a.call(arguments,1))}}}function O(t,e,r,n){var i,o,s,a,l,c,u=e&&e.ownerDocument,d=e?e.nodeType:9;if(r=r||[],"string"!=typeof t||!t||1!==d&&9!==d&&11!==d)return r;if(!n&&(De(e),e=e||_,x)){if(11!==d&&(a=_e.exec(t)))if(i=a[1]){if(9===d){if(!(c=e.getElementById(i)))return r;if(c.id===i)return R.call(r,c),r}else if(u&&(c=u.getElementById(i))&&O.contains(e,c)&&c.id===i)return R.call(r,c),r}else{if(a[2])return R.apply(r,e.getElementsByTagName(t)),r;if((i=a[3])&&e.getElementsByClassName)return R.apply(r,e.getElementsByClassName(i)),r}if(!(pe[t+" "]||h&&h.test(t))){if(c=t,u=e,1===d&&(be.test(t)||ve.test(t))){for((u=xe.test(t)&&ke(e.parentNode)||e)==e&&g.scope||((s=e.getAttribute("id"))?s=T.escapeSelector(s):e.setAttribute("id",s=A)),o=(l=Le(t)).length;o--;)l[o]=(s?"#"+s:":scope")+" "+Fe(l[o]);c=l.join(",")}try{return R.apply(r,u.querySelectorAll(c)),r}catch(e){pe(t,!0)}finally{s===A&&e.removeAttribute("id")}}}return je(t.replace(ee,"$1"),e,r,n)}function Ne(){var r=[];function n(e,t){return r.push(e+" ")>S.cacheLength&&delete n[r.shift()],n[e+" "]=t}return n}function l(e){return e[A]=!0,e}function Oe(e){var t=_.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t)}}function Ie(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&Ae(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function Me(s){return l(function(o){return o=+o,l(function(e,t){for(var r,n=s([],e.length,o),i=n.length;i--;)e[r=n[i]]&&(e[r]=!(t[r]=e[r]))})})}function ke(e){return e&&void 0!==e.getElementsByTagName&&e}function De(e){var e=e?e.ownerDocument||e:i;return e!=_&&9===e.nodeType&&e.documentElement&&(n=(_=e).documentElement,x=!T.isXMLDoc(_),ae=n.matches||n.webkitMatchesSelector||n.msMatchesSelector,n.msMatchesSelector&&i!=_&&(e=_.defaultView)&&e.top!==e&&e.addEventListener("unload",Re),g.getById=Oe(function(e){return n.appendChild(e).id=T.expando,!_.getElementsByName||!_.getElementsByName(T.expando).length}),g.disconnectedMatch=Oe(function(e){return ae.call(e,"*")}),g.scope=Oe(function(){return _.querySelectorAll(":scope")}),g.cssHas=Oe(function(){try{_.querySelector(":has(*,:jqfake)")}catch(e){return 1}}),g.getById?(S.filter.ID=function(e){var t=e.replace(d,p);return function(e){return e.getAttribute("id")===t}},S.find.ID=function(e,t){if(void 0!==t.getElementById&&x)return(t=t.getElementById(e))?[t]:[]}):(S.filter.ID=function(e){var t=e.replace(d,p);return function(e){e=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return e&&e.value===t}},S.find.ID=function(e,t){if(void 0!==t.getElementById&&x){var r,n,i,o=t.getElementById(e);if(o){if((r=o.getAttributeNode("id"))&&r.value===e)return[o];for(i=t.getElementsByName(e),n=0;o=i[n++];)if((r=o.getAttributeNode("id"))&&r.value===e)return[o]}return[]}}),S.find.TAG=function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):t.querySelectorAll(e)},S.find.CLASS=function(e,t){if(void 0!==t.getElementsByClassName&&x)return t.getElementsByClassName(e)},h=[],Oe(function(e){var t;n.appendChild(e).innerHTML="<a id='"+A+"' href='' disabled='disabled'></a><select id='"+A+"-\r\\' disabled='disabled'><option selected=''></option></select>",e.querySelectorAll("[selected]").length||h.push("\\["+r+"*(?:value|"+ge+")"),e.querySelectorAll("[id~="+A+"-]").length||h.push("~="),e.querySelectorAll("a#"+A+"+*").length||h.push(".#.+[+~]"),e.querySelectorAll(":checked").length||h.push(":checked"),(t=_.createElement("input")).setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),n.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&h.push(":enabled",":disabled"),(t=_.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||h.push("\\["+r+"*name"+r+"*="+r+"*(?:''|\"\")")}),g.cssHas||h.push(":has"),h=h.length&&new RegExp(h.join("|")),fe=function(e,t){var r;return e===t?(se=!0,0):(r=!e.compareDocumentPosition-!t.compareDocumentPosition)||(1&(r=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!g.sortDetached&&t.compareDocumentPosition(e)===r?e===_||e.ownerDocument==i&&O.contains(i,e)?-1:t===_||t.ownerDocument==i&&O.contains(i,t)?1:oe?b.call(oe,e)-b.call(oe,t):0:4&r?-1:1)}),_}for(ne in O.matches=function(e,t){return O(e,null,null,t)},O.matchesSelector=function(e,t){if(De(e),x&&!pe[t+" "]&&(!h||!h.test(t)))try{var r=ae.call(e,t);if(r||g.disconnectedMatch||e.document&&11!==e.document.nodeType)return r}catch(e){pe(t,!0)}return 0<O(t,_,null,[e]).length},O.contains=function(e,t){return(e.ownerDocument||e)!=_&&De(e),T.contains(e,t)},O.attr=function(e,t){(e.ownerDocument||e)!=_&&De(e);var r=S.attrHandle[t.toLowerCase()],r=r&&B.call(S.attrHandle,t.toLowerCase())?r(e,t,!x):void 0;return void 0!==r?r:e.getAttribute(t)},O.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},T.uniqueSort=function(e){var t,r=[],n=0,i=0;if(se=!g.sortStable,oe=!g.sortStable&&a.call(e,0),Z.call(e,fe),se){for(;t=e[i++];)t===e[i]&&(n=r.push(i));for(;n--;)Q.call(e,r[n],1)}return oe=null,e},T.fn.uniqueSort=function(){return this.pushStack(T.uniqueSort(a.apply(this)))},(S=T.expr={cacheLength:50,createPseudo:l,match:Ee,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(d,p),e[3]=(e[3]||e[4]||e[5]||"").replace(d,p),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||O.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&O.error(e[0]),e},PSEUDO:function(e){var t,r=!e[6]&&e[2];return Ee.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":r&&we.test(r)&&(t=(t=Le(r,!0))&&r.indexOf(")",r.length-t)-r.length)&&(e[0]=e[0].slice(0,t),e[2]=r.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(d,p).toLowerCase();return"*"===e?function(){return!0}:function(e){return w(e,t)}},CLASS:function(e){var t=ue[e+" "];return t||(t=new RegExp("(^|"+r+")"+e+"("+r+"|$)"))&&ue(e,function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(t,r,n){return function(e){e=O.attr(e,t);return null==e?"!="===r:!r||(e+="","="===r?e===n:"!="===r?e!==n:"^="===r?n&&0===e.indexOf(n):"*="===r?n&&-1<e.indexOf(n):"$="===r?n&&e.slice(-n.length)===n:"~="===r?-1<(" "+e.replace(me," ")+" ").indexOf(n):"|="===r&&(e===n||e.slice(0,n.length+1)===n+"-"))}},CHILD:function(p,e,t,f,g){var m="nth"!==p.slice(0,3),y="last"!==p.slice(-4),v="of-type"===e;return 1===f&&0===g?function(e){return!!e.parentNode}:function(e,t,r){var n,i,o,s,a,l=m!=y?"nextSibling":"previousSibling",c=e.parentNode,u=v&&e.nodeName.toLowerCase(),d=!r&&!v,h=!1;if(c){if(m){for(;l;){for(o=e;o=o[l];)if(v?w(o,u):1===o.nodeType)return!1;a=l="only"===p&&!a&&"nextSibling"}return!0}if(a=[y?c.firstChild:c.lastChild],y&&d){for(h=(s=(n=(i=c[A]||(c[A]={}))[p]||[])[0]===N&&n[1])&&n[2],o=s&&c.childNodes[s];o=++s&&o&&o[l]||(h=s=0,a.pop());)if(1===o.nodeType&&++h&&o===e){i[p]=[N,s,h];break}}else if(!1===(h=d?s=(n=(i=e[A]||(e[A]={}))[p]||[])[0]===N&&n[1]:h))for(;(o=++s&&o&&o[l]||(h=s=0,a.pop()))&&((v?!w(o,u):1!==o.nodeType)||!++h||(d&&((i=o[A]||(o[A]={}))[p]=[N,h]),o!==e)););return(h-=g)===f||h%f==0&&0<=h/f}}},PSEUDO:function(e,o){var t,s=S.pseudos[e]||S.setFilters[e.toLowerCase()]||O.error("unsupported pseudo: "+e);return s[A]?s(o):1<s.length?(t=[e,e,"",o],S.setFilters.hasOwnProperty(e.toLowerCase())?l(function(e,t){for(var r,n=s(e,o),i=n.length;i--;)e[r=b.call(e,n[i])]=!(t[r]=n[i])}):function(e){return s(e,0,t)}):s}},pseudos:{not:l(function(e){var n=[],i=[],a=Be(e.replace(ee,"$1"));return a[A]?l(function(e,t,r,n){for(var i,o=a(e,null,n,[]),s=e.length;s--;)(i=o[s])&&(e[s]=!(t[s]=i))}):function(e,t,r){return n[0]=e,a(n,null,r,i),n[0]=null,!i.pop()}}),has:l(function(t){return function(e){return 0<O(t,e).length}}),contains:l(function(t){return t=t.replace(d,p),function(e){return-1<(e.textContent||T.text(e)).indexOf(t)}}),lang:l(function(r){return Ce.test(r||"")||O.error("unsupported lang: "+r),r=r.replace(d,p).toLowerCase(),function(e){var t;do{if(t=x?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(t=t.toLowerCase())===r||0===t.indexOf(r+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var t=C.location&&C.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===n},focus:function(e){return e===function(){try{return _.activeElement}catch(e){}}()&&_.hasFocus()&&!!(e.type||e.href||~e.tabIndex)},enabled:Ie(!1),disabled:Ie(!0),checked:function(e){return w(e,"input")&&!!e.checked||w(e,"option")&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!S.pseudos.empty(e)},header:function(e){return Se.test(e.nodeName)},input:function(e){return Te.test(e.nodeName)},button:function(e){return w(e,"input")&&"button"===e.type||w(e,"button")},text:function(e){return w(e,"input")&&"text"===e.type&&(null==(e=e.getAttribute("type"))||"text"===e.toLowerCase())},first:Me(function(){return[0]}),last:Me(function(e,t){return[t-1]}),eq:Me(function(e,t,r){return[r<0?r+t:r]}),even:Me(function(e,t){for(var r=0;r<t;r+=2)e.push(r);return e}),odd:Me(function(e,t){for(var r=1;r<t;r+=2)e.push(r);return e}),lt:Me(function(e,t,r){for(var n=r<0?r+t:t<r?t:r;0<=--n;)e.push(n);return e}),gt:Me(function(e,t,r){for(var n=r<0?r+t:r;++n<t;)e.push(n);return e})}}).pseudos.nth=S.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})S.pseudos[ne]=function(t){return function(e){return w(e,"input")&&e.type===t}}(ne);for(ne in{submit:!0,reset:!0})S.pseudos[ne]=function(t){return function(e){return(w(e,"input")||w(e,"button"))&&e.type===t}}(ne);function Pe(){}function Le(e,t){var r,n,i,o,s,a,l,c=de[e+" "];if(c)return t?0:c.slice(0);for(s=e,a=[],l=S.preFilter;s;){for(o in r&&!(n=ye.exec(s))||(n&&(s=s.slice(n[0].length)||s),a.push(i=[])),r=!1,(n=ve.exec(s))&&(r=n.shift(),i.push({value:r,type:n[0].replace(ee," ")}),s=s.slice(r.length)),S.filter)!(n=Ee[o].exec(s))||l[o]&&!(n=l[o](n))||(r=n.shift(),i.push({value:r,type:o,matches:n}),s=s.slice(r.length));if(!r)break}return t?s.length:s?O.error(e):de(e,a).slice(0)}function Fe(e){for(var t=0,r=e.length,n="";t<r;t++)n+=e[t].value;return n}function He(s,e,t){var a=e.dir,l=e.next,c=l||a,u=t&&"parentNode"===c,d=ce++;return e.first?function(e,t,r){for(;e=e[a];)if(1===e.nodeType||u)return s(e,t,r);return!1}:function(e,t,r){var n,i,o=[N,d];if(r){for(;e=e[a];)if((1===e.nodeType||u)&&s(e,t,r))return!0}else for(;e=e[a];)if(1===e.nodeType||u)if(i=e[A]||(e[A]={}),l&&w(e,l))e=e[a]||e;else{if((n=i[c])&&n[0]===N&&n[1]===d)return o[2]=n[2];if((i[c]=o)[2]=s(e,t,r))return!0}return!1}}function Ue(i){return 1<i.length?function(e,t,r){for(var n=i.length;n--;)if(!i[n](e,t,r))return!1;return!0}:i[0]}function Ve(e,t,r,n,i){for(var o,s=[],a=0,l=e.length,c=null!=t;a<l;a++)!(o=e[a])||r&&!r(o,n,i)||(s.push(o),c&&t.push(a));return s}function We(p,f,g,m,y,e){return m&&!m[A]&&(m=We(m)),y&&!y[A]&&(y=We(y,e)),l(function(e,t,r,n){var i,o,s,a,l=[],c=[],u=t.length,d=e||function(e,t,r){for(var n=0,i=t.length;n<i;n++)O(e,t[n],r);return r}(f||"*",r.nodeType?[r]:r,[]),h=!p||!e&&f?d:Ve(d,l,p,r,n);if(g?g(h,a=y||(e?p:u||m)?[]:t,r,n):a=h,m)for(i=Ve(a,c),m(i,[],r,n),o=i.length;o--;)(s=i[o])&&(a[c[o]]=!(h[c[o]]=s));if(e){if(y||p){if(y){for(i=[],o=a.length;o--;)(s=a[o])&&i.push(h[o]=s);y(null,a=[],i,n)}for(o=a.length;o--;)(s=a[o])&&-1<(i=y?b.call(e,s):l[o])&&(e[i]=!(t[i]=s))}}else a=Ve(a===t?a.splice(u,a.length):a),y?y(null,t,a,n):R.apply(t,a)})}function $e(m,y){function e(e,t,r,n,i){var o,s,a,l=0,c="0",u=e&&[],d=[],h=ie,p=e||b&&S.find.TAG("*",i),f=N+=null==h?1:Math.random()||.1,g=p.length;for(i&&(ie=t==_||t||i);c!==g&&null!=(o=p[c]);c++){if(b&&o){for(s=0,t||o.ownerDocument==_||(De(o),r=!x);a=m[s++];)if(a(o,t||_,r)){R.call(n,o);break}i&&(N=f)}v&&((o=!a&&o)&&l--,e)&&u.push(o)}if(l+=c,v&&c!==l){for(s=0;a=y[s++];)a(u,d,t,r);if(e){if(0<l)for(;c--;)u[c]||d[c]||(d[c]=J.call(n));d=Ve(d)}R.apply(n,d),i&&!e&&0<d.length&&1<l+y.length&&T.uniqueSort(n)}return i&&(N=f,ie=h),u}var v=0<y.length,b=0<m.length;return v?l(e):e}function Be(e,t){var r,n=[],i=[],o=he[e+" "];if(!o){for(r=(t=t||Le(e)).length;r--;)((o=function e(t){for(var n,r,i,o=t.length,s=S.relative[t[0].type],a=s||S.relative[" "],l=s?1:0,c=He(function(e){return e===n},a,!0),u=He(function(e){return-1<b.call(n,e)},a,!0),d=[function(e,t,r){return e=!s&&(r||t!=ie)||((n=t).nodeType?c:u)(e,t,r),n=null,e}];l<o;l++)if(r=S.relative[t[l].type])d=[He(Ue(d),r)];else{if((r=S.filter[t[l].type].apply(null,t[l].matches))[A]){for(i=++l;i<o&&!S.relative[t[i].type];i++);return We(1<l&&Ue(d),1<l&&Fe(t.slice(0,l-1).concat({value:" "===t[l-2].type?"*":""})).replace(ee,"$1"),r,l<i&&e(t.slice(l,i)),i<o&&e(t=t.slice(i)),i<o&&Fe(t))}d.push(r)}return Ue(d)}(t[r]))[A]?n:i).push(o);(o=he(e,$e(i,n))).selector=e}return o}function je(e,t,r,n){var i,o,s,a,l,c="function"==typeof e&&e,u=!n&&Le(e=c.selector||e);if(r=r||[],1===u.length){if(2<(o=u[0]=u[0].slice(0)).length&&"ID"===(s=o[0]).type&&9===t.nodeType&&x&&S.relative[o[1].type]){if(!(t=(S.find.ID(s.matches[0].replace(d,p),t)||[])[0]))return r;c&&(t=t.parentNode),e=e.slice(o.shift().value.length)}for(i=Ee.needsContext.test(e)?0:o.length;i--&&(s=o[i],!S.relative[a=s.type]);)if((l=S.find[a])&&(n=l(s.matches[0].replace(d,p),xe.test(o[0].type)&&ke(t.parentNode)||t))){if(o.splice(i,1),e=n.length&&Fe(o))break;return R.apply(r,n),r}}return(c||Be(e,u))(n,t,!x,r,!t||xe.test(e)&&ke(t.parentNode)||t),r}Pe.prototype=S.filters=S.pseudos,S.setFilters=new Pe,g.sortStable=A.split("").sort(fe).join("")===A,De(),g.sortDetached=Oe(function(e){return 1&e.compareDocumentPosition(_.createElement("fieldset"))}),T.find=O,T.expr[":"]=T.expr.pseudos,T.unique=T.uniqueSort,O.compile=Be,O.select=je,O.setDocument=De,O.tokenize=Le,O.escape=T.escapeSelector,O.getText=T.text,O.isXML=T.isXMLDoc,O.selectors=T.expr,O.support=T.support,O.uniqueSort=T.uniqueSort;function ze(e,t,r){for(var n=[],i=void 0!==r;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(i&&T(e).is(r))break;n.push(e)}return n}function Ye(e,t){for(var r=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&r.push(e);return r}var Ge=T.expr.match.needsContext,qe=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function Ke(e,r,n){return v(r)?T.grep(e,function(e,t){return!!r.call(e,t,e)!==n}):r.nodeType?T.grep(e,function(e){return e===r!==n}):"string"!=typeof r?T.grep(e,function(e){return-1<b.call(r,e)!==n}):T.filter(r,e,n)}T.filter=function(e,t,r){var n=t[0];return r&&(e=":not("+e+")"),1===t.length&&1===n.nodeType?T.find.matchesSelector(n,e)?[n]:[]:T.find.matches(e,T.grep(t,function(e){return 1===e.nodeType}))},T.fn.extend({find:function(e){var t,r,n=this.length,i=this;if("string"!=typeof e)return this.pushStack(T(e).filter(function(){for(t=0;t<n;t++)if(T.contains(i[t],this))return!0}));for(r=this.pushStack([]),t=0;t<n;t++)T.find(e,i[t],r);return 1<n?T.uniqueSort(r):r},filter:function(e){return this.pushStack(Ke(this,e||[],!1))},not:function(e){return this.pushStack(Ke(this,e||[],!0))},is:function(e){return!!Ke(this,"string"==typeof e&&Ge.test(e)?T(e):e||[],!1).length}});var Xe,Je=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,Ze=((T.fn.init=function(e,t,r){if(e){if(r=r||Xe,"string"!=typeof e)return e.nodeType?(this[0]=e,this.length=1,this):v(e)?void 0!==r.ready?r.ready(e):e(T):T.makeArray(e,this);if(!(n="<"===e[0]&&">"===e[e.length-1]&&3<=e.length?[null,e,null]:Je.exec(e))||!n[1]&&t)return(!t||t.jquery?t||r:this.constructor(t)).find(e);if(n[1]){if(t=t instanceof T?t[0]:t,T.merge(this,T.parseHTML(n[1],t&&t.nodeType?t.ownerDocument||t:E,!0)),qe.test(n[1])&&T.isPlainObject(t))for(var n in t)v(this[n])?this[n](t[n]):this.attr(n,t[n])}else(r=E.getElementById(n[2]))&&(this[0]=r,this.length=1)}return this}).prototype=T.fn,Xe=T(E),/^(?:parents|prev(?:Until|All))/),Qe={children:!0,contents:!0,next:!0,prev:!0};function et(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}T.fn.extend({has:function(e){var t=T(e,this),r=t.length;return this.filter(function(){for(var e=0;e<r;e++)if(T.contains(this,t[e]))return!0})},closest:function(e,t){var r,n=0,i=this.length,o=[],s="string"!=typeof e&&T(e);if(!Ge.test(e))for(;n<i;n++)for(r=this[n];r&&r!==t;r=r.parentNode)if(r.nodeType<11&&(s?-1<s.index(r):1===r.nodeType&&T.find.matchesSelector(r,e))){o.push(r);break}return this.pushStack(1<o.length?T.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?b.call(T(e),this[0]):b.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(T.uniqueSort(T.merge(this.get(),T(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),T.each({parent:function(e){e=e.parentNode;return e&&11!==e.nodeType?e:null},parents:function(e){return ze(e,"parentNode")},parentsUntil:function(e,t,r){return ze(e,"parentNode",r)},next:function(e){return et(e,"nextSibling")},prev:function(e){return et(e,"previousSibling")},nextAll:function(e){return ze(e,"nextSibling")},prevAll:function(e){return ze(e,"previousSibling")},nextUntil:function(e,t,r){return ze(e,"nextSibling",r)},prevUntil:function(e,t,r){return ze(e,"previousSibling",r)},siblings:function(e){return Ye((e.parentNode||{}).firstChild,e)},children:function(e){return Ye(e.firstChild)},contents:function(e){return null!=e.contentDocument&&H(e.contentDocument)?e.contentDocument:(w(e,"template")&&(e=e.content||e),T.merge([],e.childNodes))}},function(n,i){T.fn[n]=function(e,t){var r=T.map(this,i,e);return(t="Until"!==n.slice(-5)?e:t)&&"string"==typeof t&&(r=T.filter(t,r)),1<this.length&&(Qe[n]||T.uniqueSort(r),Ze.test(n))&&r.reverse(),this.pushStack(r)}});var I=/[^\x20\t\r\n\f]+/g;function tt(e){return e}function rt(e){throw e}function nt(e,t,r,n){var i;try{e&&v(i=e.promise)?i.call(e).done(t).fail(r):e&&v(i=e.then)?i.call(e,t,r):t.apply(void 0,[e].slice(n))}catch(e){r.apply(void 0,[e])}}T.Callbacks=function(n){var e,r;n="string"==typeof n?(e=n,r={},T.each(e.match(I)||[],function(e,t){r[t]=!0}),r):T.extend({},n);function i(){for(a=a||n.once,s=o=!0;c.length;u=-1)for(t=c.shift();++u<l.length;)!1===l[u].apply(t[0],t[1])&&n.stopOnFalse&&(u=l.length,t=!1);n.memory||(t=!1),o=!1,a&&(l=t?[]:"")}var o,t,s,a,l=[],c=[],u=-1,d={add:function(){return l&&(t&&!o&&(u=l.length-1,c.push(t)),function r(e){T.each(e,function(e,t){v(t)?n.unique&&d.has(t)||l.push(t):t&&t.length&&"string"!==q(t)&&r(t)})}(arguments),t)&&!o&&i(),this},remove:function(){return T.each(arguments,function(e,t){for(var r;-1<(r=T.inArray(t,l,r));)l.splice(r,1),r<=u&&u--}),this},has:function(e){return e?-1<T.inArray(e,l):0<l.length},empty:function(){return l=l&&[],this},disable:function(){return a=c=[],l=t="",this},disabled:function(){return!l},lock:function(){return a=c=[],t||o||(l=t=""),this},locked:function(){return!!a},fireWith:function(e,t){return a||(t=[e,(t=t||[]).slice?t.slice():t],c.push(t),o)||i(),this},fire:function(){return d.fireWith(this,arguments),this},fired:function(){return!!s}};return d},T.extend({Deferred:function(e){var o=[["notify","progress",T.Callbacks("memory"),T.Callbacks("memory"),2],["resolve","done",T.Callbacks("once memory"),T.Callbacks("once memory"),0,"resolved"],["reject","fail",T.Callbacks("once memory"),T.Callbacks("once memory"),1,"rejected"]],i="pending",s={state:function(){return i},always:function(){return a.done(arguments).fail(arguments),this},catch:function(e){return s.then(null,e)},pipe:function(){var i=arguments;return T.Deferred(function(n){T.each(o,function(e,t){var r=v(i[t[4]])&&i[t[4]];a[t[1]](function(){var e=r&&r.apply(this,arguments);e&&v(e.promise)?e.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[t[0]+"With"](this,r?[e]:arguments)})}),i=null}).promise()},then:function(t,r,n){var l=0;function c(i,o,s,a){return function(){function e(){var e,t;if(!(i<l)){if((e=s.apply(r,n))===o.promise())throw new TypeError("Thenable self-resolution");t=e&&("object"==typeof e||"function"==typeof e)&&e.then,v(t)?a?t.call(e,c(l,o,tt,a),c(l,o,rt,a)):(l++,t.call(e,c(l,o,tt,a),c(l,o,rt,a),c(l,o,tt,o.notifyWith))):(s!==tt&&(r=void 0,n=[e]),(a||o.resolveWith)(r,n))}}var r=this,n=arguments,t=a?e:function(){try{e()}catch(e){T.Deferred.exceptionHook&&T.Deferred.exceptionHook(e,t.error),l<=i+1&&(s!==rt&&(r=void 0,n=[e]),o.rejectWith(r,n))}};i?t():(T.Deferred.getErrorHook?t.error=T.Deferred.getErrorHook():T.Deferred.getStackHook&&(t.error=T.Deferred.getStackHook()),C.setTimeout(t))}}return T.Deferred(function(e){o[0][3].add(c(0,e,v(n)?n:tt,e.notifyWith)),o[1][3].add(c(0,e,v(t)?t:tt)),o[2][3].add(c(0,e,v(r)?r:rt))}).promise()},promise:function(e){return null!=e?T.extend(e,s):s}},a={};return T.each(o,function(e,t){var r=t[2],n=t[5];s[t[1]]=r.add,n&&r.add(function(){i=n},o[3-e][2].disable,o[3-e][3].disable,o[0][2].lock,o[0][3].lock),r.add(t[3].fire),a[t[0]]=function(){return a[t[0]+"With"](this===a?void 0:this,arguments),this},a[t[0]+"With"]=r.fireWith}),s.promise(a),e&&e.call(a,a),a},when:function(e){function t(t){return function(e){i[t]=this,o[t]=1<arguments.length?a.call(arguments):e,--r||s.resolveWith(i,o)}}var r=arguments.length,n=r,i=Array(n),o=a.call(arguments),s=T.Deferred();if(r<=1&&(nt(e,s.done(t(n)).resolve,s.reject,!r),"pending"===s.state()||v(o[n]&&o[n].then)))return s.then();for(;n--;)nt(o[n],t(n),s.reject);return s.promise()}});var it=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/,ot=(T.Deferred.exceptionHook=function(e,t){C.console&&C.console.warn&&e&&it.test(e.name)&&C.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)},T.readyException=function(e){C.setTimeout(function(){throw e})},T.Deferred());function st(){E.removeEventListener("DOMContentLoaded",st),C.removeEventListener("load",st),T.ready()}T.fn.ready=function(e){return ot.then(e).catch(function(e){T.readyException(e)}),this},T.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--T.readyWait:T.isReady)||(T.isReady=!0)!==e&&0<--T.readyWait||ot.resolveWith(E,[T])}}),T.ready.then=ot.then,"complete"===E.readyState||"loading"!==E.readyState&&!E.documentElement.doScroll?C.setTimeout(T.ready):(E.addEventListener("DOMContentLoaded",st),C.addEventListener("load",st));function u(e,t,r,n,i,o,s){var a=0,l=e.length,c=null==r;if("object"===q(r))for(a in i=!0,r)u(e,t,a,r[a],!0,o,s);else if(void 0!==n&&(i=!0,v(n)||(s=!0),t=c?s?(t.call(e,n),null):(c=t,function(e,t,r){return c.call(T(e),r)}):t))for(;a<l;a++)t(e[a],r,s?n:n.call(e[a],a,t(e[a],r)));return i?e:c?t.call(e):l?t(e[0],r):o}var at=/^-ms-/,lt=/-([a-z])/g;function ct(e,t){return t.toUpperCase()}function M(e){return e.replace(at,"ms-").replace(lt,ct)}function ut(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType}function dt(){this.expando=T.expando+dt.uid++}dt.uid=1,dt.prototype={cache:function(e){var t=e[this.expando];return t||(t={},ut(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,r){var n,i=this.cache(e);if("string"==typeof t)i[M(t)]=r;else for(n in t)i[M(n)]=t[n];return i},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][M(t)]},access:function(e,t,r){return void 0===t||t&&"string"==typeof t&&void 0===r?this.get(e,t):(this.set(e,t,r),void 0!==r?r:t)},remove:function(e,t){var r,n=e[this.expando];if(void 0!==n){if(void 0!==t){r=(t=Array.isArray(t)?t.map(M):(t=M(t))in n?[t]:t.match(I)||[]).length;for(;r--;)delete n[t[r]]}void 0!==t&&!T.isEmptyObject(n)||(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){e=e[this.expando];return void 0!==e&&!T.isEmptyObject(e)}};var y=new dt,c=new dt,ht=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,pt=/[A-Z]/g;function ft(e,t,r){var n,i;if(void 0===r&&1===e.nodeType)if(n="data-"+t.replace(pt,"-$&").toLowerCase(),"string"==typeof(r=e.getAttribute(n))){try{r="true"===(i=r)||"false"!==i&&("null"===i?null:i===+i+""?+i:ht.test(i)?JSON.parse(i):i)}catch(e){}c.set(e,t,r)}else r=void 0;return r}T.extend({hasData:function(e){return c.hasData(e)||y.hasData(e)},data:function(e,t,r){return c.access(e,t,r)},removeData:function(e,t){c.remove(e,t)},_data:function(e,t,r){return y.access(e,t,r)},_removeData:function(e,t){y.remove(e,t)}}),T.fn.extend({data:function(r,e){var t,n,i,o=this[0],s=o&&o.attributes;if(void 0!==r)return"object"==typeof r?this.each(function(){c.set(this,r)}):u(this,function(e){var t;if(o&&void 0===e)return void 0!==(t=c.get(o,r))||void 0!==(t=ft(o,r))?t:void 0;this.each(function(){c.set(this,r,e)})},null,e,1<arguments.length,null,!0);if(this.length&&(i=c.get(o),1===o.nodeType)&&!y.get(o,"hasDataAttrs")){for(t=s.length;t--;)s[t]&&0===(n=s[t].name).indexOf("data-")&&(n=M(n.slice(5)),ft(o,n,i[n]));y.set(o,"hasDataAttrs",!0)}return i},removeData:function(e){return this.each(function(){c.remove(this,e)})}}),T.extend({queue:function(e,t,r){var n;if(e)return n=y.get(e,t=(t||"fx")+"queue"),r&&(!n||Array.isArray(r)?n=y.access(e,t,T.makeArray(r)):n.push(r)),n||[]},dequeue:function(e,t){t=t||"fx";var r=T.queue(e,t),n=r.length,i=r.shift(),o=T._queueHooks(e,t);"inprogress"===i&&(i=r.shift(),n--),i&&("fx"===t&&r.unshift("inprogress"),delete o.stop,i.call(e,function(){T.dequeue(e,t)},o)),!n&&o&&o.empty.fire()},_queueHooks:function(e,t){var r=t+"queueHooks";return y.get(e,r)||y.access(e,r,{empty:T.Callbacks("once memory").add(function(){y.remove(e,[t+"queue",r])})})}}),T.fn.extend({queue:function(t,r){var e=2;return"string"!=typeof t&&(r=t,t="fx",e--),arguments.length<e?T.queue(this[0],t):void 0===r?this:this.each(function(){var e=T.queue(this,t,r);T._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&T.dequeue(this,t)})},dequeue:function(e){return this.each(function(){T.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){function r(){--i||o.resolveWith(s,[s])}var n,i=1,o=T.Deferred(),s=this,a=this.length;for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";a--;)(n=y.get(s[a],e+"queueHooks"))&&n.empty&&(i++,n.empty.add(r));return r(),o.promise(t)}});function gt(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&bt(e)&&"none"===T.css(e,"display")}var e=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,mt=new RegExp("^(?:([+-])=|)("+e+")([a-z%]*)$","i"),yt=["Top","Right","Bottom","Left"],vt=E.documentElement,bt=function(e){return T.contains(e.ownerDocument,e)},wt={composed:!0};vt.getRootNode&&(bt=function(e){return T.contains(e.ownerDocument,e)||e.getRootNode(wt)===e.ownerDocument});function Ct(e,t,r,n){var i,o,s=20,a=n?function(){return n.cur()}:function(){return T.css(e,t,"")},l=a(),c=r&&r[3]||(T.cssNumber[t]?"":"px"),u=e.nodeType&&(T.cssNumber[t]||"px"!==c&&+l)&&mt.exec(T.css(e,t));if(u&&u[3]!==c){for(c=c||u[3],u=+(l/=2)||1;s--;)T.style(e,t,u+c),(1-o)*(1-(o=a()/l||.5))<=0&&(s=0),u/=o;T.style(e,t,(u*=2)+c),r=r||[]}return r&&(u=+u||+l||0,i=r[1]?u+(r[1]+1)*r[2]:+r[2],n)&&(n.unit=c,n.start=u,n.end=i),i}var Et={};function Tt(e,t){for(var r,n,i,o,s,a=[],l=0,c=e.length;l<c;l++)(n=e[l]).style&&(r=n.style.display,t?("none"===r&&(a[l]=y.get(n,"display")||null,a[l]||(n.style.display="")),""===n.style.display&&gt(n)&&(a[l]=(s=o=void 0,o=(i=n).ownerDocument,i=i.nodeName,(s=Et[i])||(o=o.body.appendChild(o.createElement(i)),s=T.css(o,"display"),o.parentNode.removeChild(o),Et[i]=s="none"===s?"block":s),s))):"none"!==r&&(a[l]="none",y.set(n,"display",r)));for(l=0;l<c;l++)null!=a[l]&&(e[l].style.display=a[l]);return e}T.fn.extend({show:function(){return Tt(this,!0)},hide:function(){return Tt(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){gt(this)?T(this).show():T(this).hide()})}});var St=/^(?:checkbox|radio)$/i,_t=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,xt=/^$|^module$|\/(?:java|ecma)script/i,f=(o=E.createDocumentFragment().appendChild(E.createElement("div")),(s=E.createElement("input")).setAttribute("type","radio"),s.setAttribute("checked","checked"),s.setAttribute("name","t"),o.appendChild(s),g.checkClone=o.cloneNode(!0).cloneNode(!0).lastChild.checked,o.innerHTML="<textarea>x</textarea>",g.noCloneChecked=!!o.cloneNode(!0).lastChild.defaultValue,o.innerHTML="<option></option>",g.option=!!o.lastChild,{thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]});function m(e,t){var r=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[];return void 0===t||t&&w(e,t)?T.merge([e],r):r}function Rt(e,t){for(var r=0,n=e.length;r<n;r++)y.set(e[r],"globalEval",!t||y.get(t[r],"globalEval"))}f.tbody=f.tfoot=f.colgroup=f.caption=f.thead,f.th=f.td,g.option||(f.optgroup=f.option=[1,"<select multiple='multiple'>","</select>"]);var At=/<|&#?\w+;/;function Nt(e,t,r,n,i){for(var o,s,a,l,c,u=t.createDocumentFragment(),d=[],h=0,p=e.length;h<p;h++)if((o=e[h])||0===o)if("object"===q(o))T.merge(d,o.nodeType?[o]:o);else if(At.test(o)){for(s=s||u.appendChild(t.createElement("div")),a=(_t.exec(o)||["",""])[1].toLowerCase(),a=f[a]||f._default,s.innerHTML=a[1]+T.htmlPrefilter(o)+a[2],c=a[0];c--;)s=s.lastChild;T.merge(d,s.childNodes),(s=u.firstChild).textContent=""}else d.push(t.createTextNode(o));for(u.textContent="",h=0;o=d[h++];)if(n&&-1<T.inArray(o,n))i&&i.push(o);else if(l=bt(o),s=m(u.appendChild(o),"script"),l&&Rt(s),r)for(c=0;o=s[c++];)xt.test(o.type||"")&&r.push(o);return u}var Ot=/^([^.]*)(?:\.(.+)|)/;function It(){return!0}function Mt(){return!1}function kt(e,t,r,n,i,o){var s,a;if("object"==typeof t){for(a in"string"!=typeof r&&(n=n||r,r=void 0),t)kt(e,a,r,n,t[a],o);return e}if(null==n&&null==i?(i=r,n=r=void 0):null==i&&("string"==typeof r?(i=n,n=void 0):(i=n,n=r,r=void 0)),!1===i)i=Mt;else if(!i)return e;return 1===o&&(s=i,(i=function(e){return T().off(e),s.apply(this,arguments)}).guid=s.guid||(s.guid=T.guid++)),e.each(function(){T.event.add(this,t,i,n,r)})}function Dt(e,n,t){t?(y.set(e,n,!1),T.event.add(e,n,{namespace:!1,handler:function(e){var t,r=y.get(this,n);if(1&e.isTrigger&&this[n]){if(r)(T.event.special[n]||{}).delegateType&&e.stopPropagation();else if(r=a.call(arguments),y.set(this,n,r),this[n](),t=y.get(this,n),y.set(this,n,!1),r!==t)return e.stopImmediatePropagation(),e.preventDefault(),t}else r&&(y.set(this,n,T.event.trigger(r[0],r.slice(1),this)),e.stopPropagation(),e.isImmediatePropagationStopped=It)}})):void 0===y.get(e,n)&&T.event.add(e,n,It)}T.event={global:{},add:function(t,e,r,n,i){var o,s,a,l,c,u,d,h,p,f=y.get(t);if(ut(t))for(r.handler&&(r=(o=r).handler,i=o.selector),i&&T.find.matchesSelector(vt,i),r.guid||(r.guid=T.guid++),a=(a=f.events)||(f.events=Object.create(null)),s=(s=f.handle)||(f.handle=function(e){return void 0!==T&&T.event.triggered!==e.type?T.event.dispatch.apply(t,arguments):void 0}),l=(e=(e||"").match(I)||[""]).length;l--;)d=p=(h=Ot.exec(e[l])||[])[1],h=(h[2]||"").split(".").sort(),d&&(c=T.event.special[d]||{},d=(i?c.delegateType:c.bindType)||d,c=T.event.special[d]||{},p=T.extend({type:d,origType:p,data:n,handler:r,guid:r.guid,selector:i,needsContext:i&&T.expr.match.needsContext.test(i),namespace:h.join(".")},o),(u=a[d])||((u=a[d]=[]).delegateCount=0,c.setup&&!1!==c.setup.call(t,n,h,s))||t.addEventListener&&t.addEventListener(d,s),c.add&&(c.add.call(t,p),p.handler.guid||(p.handler.guid=r.guid)),i?u.splice(u.delegateCount++,0,p):u.push(p),T.event.global[d]=!0)},remove:function(e,t,r,n,i){var o,s,a,l,c,u,d,h,p,f,g,m=y.hasData(e)&&y.get(e);if(m&&(l=m.events)){for(c=(t=(t||"").match(I)||[""]).length;c--;)if(p=g=(a=Ot.exec(t[c])||[])[1],f=(a[2]||"").split(".").sort(),p){for(d=T.event.special[p]||{},h=l[p=(n?d.delegateType:d.bindType)||p]||[],a=a[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=h.length;o--;)u=h[o],!i&&g!==u.origType||r&&r.guid!==u.guid||a&&!a.test(u.namespace)||n&&n!==u.selector&&("**"!==n||!u.selector)||(h.splice(o,1),u.selector&&h.delegateCount--,d.remove&&d.remove.call(e,u));s&&!h.length&&(d.teardown&&!1!==d.teardown.call(e,f,m.handle)||T.removeEvent(e,p,m.handle),delete l[p])}else for(p in l)T.event.remove(e,p+t[c],r,n,!0);T.isEmptyObject(l)&&y.remove(e,"handle events")}},dispatch:function(e){var t,r,n,i,o,s=new Array(arguments.length),a=T.event.fix(e),e=(y.get(this,"events")||Object.create(null))[a.type]||[],l=T.event.special[a.type]||{};for(s[0]=a,t=1;t<arguments.length;t++)s[t]=arguments[t];if(a.delegateTarget=this,!l.preDispatch||!1!==l.preDispatch.call(this,a)){for(o=T.event.handlers.call(this,a,e),t=0;(n=o[t++])&&!a.isPropagationStopped();)for(a.currentTarget=n.elem,r=0;(i=n.handlers[r++])&&!a.isImmediatePropagationStopped();)a.rnamespace&&!1!==i.namespace&&!a.rnamespace.test(i.namespace)||(a.handleObj=i,a.data=i.data,void 0!==(i=((T.event.special[i.origType]||{}).handle||i.handler).apply(n.elem,s))&&!1===(a.result=i)&&(a.preventDefault(),a.stopPropagation()));return l.postDispatch&&l.postDispatch.call(this,a),a.result}},handlers:function(e,t){var r,n,i,o,s,a=[],l=t.delegateCount,c=e.target;if(l&&c.nodeType&&!("click"===e.type&&1<=e.button))for(;c!==this;c=c.parentNode||this)if(1===c.nodeType&&("click"!==e.type||!0!==c.disabled)){for(o=[],s={},r=0;r<l;r++)void 0===s[i=(n=t[r]).selector+" "]&&(s[i]=n.needsContext?-1<T(i,this).index(c):T.find(i,this,null,[c]).length),s[i]&&o.push(n);o.length&&a.push({elem:c,handlers:o})}return c=this,l<t.length&&a.push({elem:c,handlers:t.slice(l)}),a},addProp:function(t,e){Object.defineProperty(T.Event.prototype,t,{enumerable:!0,configurable:!0,get:v(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(e){return e[T.expando]?e:new T.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){e=this||e;return St.test(e.type)&&e.click&&w(e,"input")&&Dt(e,"click",!0),!1},trigger:function(e){e=this||e;return St.test(e.type)&&e.click&&w(e,"input")&&Dt(e,"click"),!0},_default:function(e){e=e.target;return St.test(e.type)&&e.click&&w(e,"input")&&y.get(e,"click")||w(e,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},T.removeEvent=function(e,t,r){e.removeEventListener&&e.removeEventListener(t,r)},T.Event=function(e,t){if(!(this instanceof T.Event))return new T.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?It:Mt,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&T.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[T.expando]=!0},T.Event.prototype={constructor:T.Event,isDefaultPrevented:Mt,isPropagationStopped:Mt,isImmediatePropagationStopped:Mt,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=It,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=It,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=It,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},T.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},T.event.addProp),T.each({focus:"focusin",blur:"focusout"},function(n,i){function o(e){var t,r;E.documentMode?(t=y.get(this,"handle"),(r=T.event.fix(e)).type="focusin"===e.type?"focus":"blur",r.isSimulated=!0,t(e),r.target===r.currentTarget&&t(r)):T.event.simulate(i,e.target,T.event.fix(e))}T.event.special[n]={setup:function(){var e;if(Dt(this,n,!0),!E.documentMode)return!1;(e=y.get(this,i))||this.addEventListener(i,o),y.set(this,i,(e||0)+1)},trigger:function(){return Dt(this,n),!0},teardown:function(){var e;if(!E.documentMode)return!1;(e=y.get(this,i)-1)?y.set(this,i,e):(this.removeEventListener(i,o),y.remove(this,i))},_default:function(e){return y.get(e.target,n)},delegateType:i},T.event.special[i]={setup:function(){var e=this.ownerDocument||this.document||this,t=E.documentMode?this:e,r=y.get(t,i);r||(E.documentMode?this.addEventListener(i,o):e.addEventListener(n,o,!0)),y.set(t,i,(r||0)+1)},teardown:function(){var e=this.ownerDocument||this.document||this,t=E.documentMode?this:e,r=y.get(t,i)-1;r?y.set(t,i,r):(E.documentMode?this.removeEventListener(i,o):e.removeEventListener(n,o,!0),y.remove(t,i))}}}),T.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,i){T.event.special[e]={delegateType:i,bindType:i,handle:function(e){var t,r=e.relatedTarget,n=e.handleObj;return r&&(r===this||T.contains(this,r))||(e.type=n.origType,t=n.handler.apply(this,arguments),e.type=i),t}}}),T.fn.extend({on:function(e,t,r,n){return kt(this,e,t,r,n)},one:function(e,t,r,n){return kt(this,e,t,r,n,1)},off:function(e,t,r){var n,i;if(e&&e.preventDefault&&e.handleObj)n=e.handleObj,T(e.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler);else{if("object"!=typeof e)return!1!==t&&"function"!=typeof t||(r=t,t=void 0),!1===r&&(r=Mt),this.each(function(){T.event.remove(this,e,r,t)});for(i in e)this.off(i,t,e[i])}return this}});var Pt=/<script|<style|<link/i,Lt=/checked\s*(?:[^=]|=\s*.checked.)/i,Ft=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function Ht(e,t){return w(e,"table")&&w(11!==t.nodeType?t:t.firstChild,"tr")&&T(e).children("tbody")[0]||e}function Ut(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function Vt(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Wt(e,t){var r,n,i,o;if(1===t.nodeType){if(y.hasData(e)&&(o=y.get(e).events))for(i in y.remove(t,"handle events"),o)for(r=0,n=o[i].length;r<n;r++)T.event.add(t,i,o[i][r]);c.hasData(e)&&(e=c.access(e),e=T.extend({},e),c.set(t,e))}}function $t(r,n,i,o){n=U(n);var e,t,s,a,l,c,u=0,d=r.length,h=d-1,p=n[0],f=v(p);if(f||1<d&&"string"==typeof p&&!g.checkClone&&Lt.test(p))return r.each(function(e){var t=r.eq(e);f&&(n[0]=p.call(this,e,t.html())),$t(t,n,i,o)});if(d&&(t=(e=Nt(n,r[0].ownerDocument,!1,r,o)).firstChild,1===e.childNodes.length&&(e=t),t||o)){for(a=(s=T.map(m(e,"script"),Ut)).length;u<d;u++)l=e,u!==h&&(l=T.clone(l,!0,!0),a)&&T.merge(s,m(l,"script")),i.call(r[u],l,u);if(a)for(c=s[s.length-1].ownerDocument,T.map(s,Vt),u=0;u<a;u++)l=s[u],xt.test(l.type||"")&&!y.access(l,"globalEval")&&T.contains(c,l)&&(l.src&&"module"!==(l.type||"").toLowerCase()?T._evalUrl&&!l.noModule&&T._evalUrl(l.src,{nonce:l.nonce||l.getAttribute("nonce")},c):G(l.textContent.replace(Ft,""),l,c))}return r}function Bt(e,t,r){for(var n,i=t?T.filter(t,e):e,o=0;null!=(n=i[o]);o++)r||1!==n.nodeType||T.cleanData(m(n)),n.parentNode&&(r&&bt(n)&&Rt(m(n,"script")),n.parentNode.removeChild(n));return e}T.extend({htmlPrefilter:function(e){return e},clone:function(e,t,r){var n,i,o,s,a,l,c,u=e.cloneNode(!0),d=bt(e);if(!(g.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||T.isXMLDoc(e)))for(s=m(u),n=0,i=(o=m(e)).length;n<i;n++)a=o[n],l=s[n],c=void 0,"input"===(c=l.nodeName.toLowerCase())&&St.test(a.type)?l.checked=a.checked:"input"!==c&&"textarea"!==c||(l.defaultValue=a.defaultValue);if(t)if(r)for(o=o||m(e),s=s||m(u),n=0,i=o.length;n<i;n++)Wt(o[n],s[n]);else Wt(e,u);return 0<(s=m(u,"script")).length&&Rt(s,!d&&m(e,"script")),u},cleanData:function(e){for(var t,r,n,i=T.event.special,o=0;void 0!==(r=e[o]);o++)if(ut(r)){if(t=r[y.expando]){if(t.events)for(n in t.events)i[n]?T.event.remove(r,n):T.removeEvent(r,n,t.handle);r[y.expando]=void 0}r[c.expando]&&(r[c.expando]=void 0)}}}),T.fn.extend({detach:function(e){return Bt(this,e,!0)},remove:function(e){return Bt(this,e)},text:function(e){return u(this,function(e){return void 0===e?T.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return $t(this,arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Ht(this,e).appendChild(e)})},prepend:function(){return $t(this,arguments,function(e){var t;1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(t=Ht(this,e)).insertBefore(e,t.firstChild)})},before:function(){return $t(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return $t(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(T.cleanData(m(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return T.clone(this,e,t)})},html:function(e){return u(this,function(e){var t=this[0]||{},r=0,n=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Pt.test(e)&&!f[(_t.exec(e)||["",""])[1].toLowerCase()]){e=T.htmlPrefilter(e);try{for(;r<n;r++)1===(t=this[r]||{}).nodeType&&(T.cleanData(m(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var r=[];return $t(this,arguments,function(e){var t=this.parentNode;T.inArray(this,r)<0&&(T.cleanData(m(this)),t)&&t.replaceChild(e,this)},r)}}),T.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,s){T.fn[e]=function(e){for(var t,r=[],n=T(e),i=n.length-1,o=0;o<=i;o++)t=o===i?this:this.clone(!0),T(n[o])[s](t),V.apply(r,t.get());return this.pushStack(r)}});function jt(e){var t=e.ownerDocument.defaultView;return(t=t&&t.opener?t:C).getComputedStyle(e)}function zt(e,t,r){var n,i={};for(n in t)i[n]=e.style[n],e.style[n]=t[n];for(n in r=r.call(e),t)e.style[n]=i[n];return r}var Yt,Gt,qt,Kt,Xt,Jt,Zt,k,Qt=new RegExp("^("+e+")(?!px)[a-z%]+$","i"),er=/^--/,tr=new RegExp(yt.join("|"),"i");function rr(){var e;k&&(Zt.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",k.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",vt.appendChild(Zt).appendChild(k),e=C.getComputedStyle(k),Yt="1%"!==e.top,Jt=12===nr(e.marginLeft),k.style.right="60%",Kt=36===nr(e.right),Gt=36===nr(e.width),k.style.position="absolute",qt=12===nr(k.offsetWidth/3),vt.removeChild(Zt),k=null)}function nr(e){return Math.round(parseFloat(e))}function ir(e,t,r){var n,i=er.test(t),o=e.style;return(r=r||jt(e))&&(n=r.getPropertyValue(t)||r[t],""!==(n=i?n&&(n.replace(ee,"$1")||void 0):n)||bt(e)||(n=T.style(e,t)),!g.pixelBoxStyles())&&Qt.test(n)&&tr.test(t)&&(i=o.width,e=o.minWidth,t=o.maxWidth,o.minWidth=o.maxWidth=o.width=n,n=r.width,o.width=i,o.minWidth=e,o.maxWidth=t),void 0!==n?n+"":n}function or(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}Zt=E.createElement("div"),(k=E.createElement("div")).style&&(k.style.backgroundClip="content-box",k.cloneNode(!0).style.backgroundClip="",g.clearCloneStyle="content-box"===k.style.backgroundClip,T.extend(g,{boxSizingReliable:function(){return rr(),Gt},pixelBoxStyles:function(){return rr(),Kt},pixelPosition:function(){return rr(),Yt},reliableMarginLeft:function(){return rr(),Jt},scrollboxSize:function(){return rr(),qt},reliableTrDimensions:function(){var e,t,r;return null==Xt&&(e=E.createElement("table"),t=E.createElement("tr"),r=E.createElement("div"),e.style.cssText="position:absolute;left:-11111px;border-collapse:separate",t.style.cssText="box-sizing:content-box;border:1px solid",t.style.height="1px",r.style.height="9px",r.style.display="block",vt.appendChild(e).appendChild(t).appendChild(r),r=C.getComputedStyle(t),Xt=parseInt(r.height,10)+parseInt(r.borderTopWidth,10)+parseInt(r.borderBottomWidth,10)===t.offsetHeight,vt.removeChild(e)),Xt}}));var sr=["Webkit","Moz","ms"],ar=E.createElement("div").style,lr={};function cr(e){var t=T.cssProps[e]||lr[e];return t||(e in ar?e:lr[e]=function(e){for(var t=e[0].toUpperCase()+e.slice(1),r=sr.length;r--;)if((e=sr[r]+t)in ar)return e}(e)||e)}var ur=/^(none|table(?!-c[ea]).+)/,dr={position:"absolute",visibility:"hidden",display:"block"},hr={letterSpacing:"0",fontWeight:"400"};function pr(e,t,r){var n=mt.exec(t);return n?Math.max(0,n[2]-(r||0))+(n[3]||"px"):t}function fr(e,t,r,n,i,o){var s="width"===t?1:0,a=0,l=0,c=0;if(r===(n?"border":"content"))return 0;for(;s<4;s+=2)"margin"===r&&(c+=T.css(e,r+yt[s],!0,i)),n?("content"===r&&(l-=T.css(e,"padding"+yt[s],!0,i)),"margin"!==r&&(l-=T.css(e,"border"+yt[s]+"Width",!0,i))):(l+=T.css(e,"padding"+yt[s],!0,i),"padding"!==r?l+=T.css(e,"border"+yt[s]+"Width",!0,i):a+=T.css(e,"border"+yt[s]+"Width",!0,i));return!n&&0<=o&&(l+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-o-l-a-.5))||0),l+c}function gr(e,t,r){var n=jt(e),i=(!g.boxSizingReliable()||r)&&"border-box"===T.css(e,"boxSizing",!1,n),o=i,s=ir(e,t,n),a="offset"+t[0].toUpperCase()+t.slice(1);if(Qt.test(s)){if(!r)return s;s="auto"}return(!g.boxSizingReliable()&&i||!g.reliableTrDimensions()&&w(e,"tr")||"auto"===s||!parseFloat(s)&&"inline"===T.css(e,"display",!1,n))&&e.getClientRects().length&&(i="border-box"===T.css(e,"boxSizing",!1,n),o=a in e)&&(s=e[a]),(s=parseFloat(s)||0)+fr(e,t,r||(i?"border":"content"),o,n,s)+"px"}function D(e,t,r,n,i){return new D.prototype.init(e,t,r,n,i)}T.extend({cssHooks:{opacity:{get:function(e,t){if(t)return""===(t=ir(e,"opacity"))?"1":t}}},cssNumber:{animationIterationCount:!0,aspectRatio:!0,borderImageSlice:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,scale:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeMiterlimit:!0,strokeOpacity:!0},cssProps:{},style:function(e,t,r,n){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,s,a=M(t),l=er.test(t),c=e.style;if(l||(t=cr(a)),s=T.cssHooks[t]||T.cssHooks[a],void 0===r)return s&&"get"in s&&void 0!==(i=s.get(e,!1,n))?i:c[t];"string"===(o=typeof r)&&(i=mt.exec(r))&&i[1]&&(r=Ct(e,t,i),o="number"),null==r||r!=r||("number"!==o||l||(r+=i&&i[3]||(T.cssNumber[a]?"":"px")),g.clearCloneStyle||""!==r||0!==t.indexOf("background")||(c[t]="inherit"),s&&"set"in s&&void 0===(r=s.set(e,r,n)))||(l?c.setProperty(t,r):c[t]=r)}},css:function(e,t,r,n){var i,o=M(t);return er.test(t)||(t=cr(o)),"normal"===(i=void 0===(i=(o=T.cssHooks[t]||T.cssHooks[o])&&"get"in o?o.get(e,!0,r):i)?ir(e,t,n):i)&&t in hr&&(i=hr[t]),(""===r||r)&&(o=parseFloat(i),!0===r||isFinite(o))?o||0:i}}),T.each(["height","width"],function(e,s){T.cssHooks[s]={get:function(e,t,r){if(t)return!ur.test(T.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?gr(e,s,r):zt(e,dr,function(){return gr(e,s,r)})},set:function(e,t,r){var n=jt(e),i=!g.scrollboxSize()&&"absolute"===n.position,o=(i||r)&&"border-box"===T.css(e,"boxSizing",!1,n),r=r?fr(e,s,r,o,n):0;return o&&i&&(r-=Math.ceil(e["offset"+s[0].toUpperCase()+s.slice(1)]-parseFloat(n[s])-fr(e,s,"border",!1,n)-.5)),r&&(o=mt.exec(t))&&"px"!==(o[3]||"px")&&(e.style[s]=t,t=T.css(e,s)),pr(0,t,r)}}}),T.cssHooks.marginLeft=or(g.reliableMarginLeft,function(e,t){if(t)return(parseFloat(ir(e,"marginLeft"))||e.getBoundingClientRect().left-zt(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),T.each({margin:"",padding:"",border:"Width"},function(i,o){T.cssHooks[i+o]={expand:function(e){for(var t=0,r={},n="string"==typeof e?e.split(" "):[e];t<4;t++)r[i+yt[t]+o]=n[t]||n[t-2]||n[0];return r}},"margin"!==i&&(T.cssHooks[i+o].set=pr)}),T.fn.extend({css:function(e,t){return u(this,function(e,t,r){var n,i,o={},s=0;if(Array.isArray(t)){for(n=jt(e),i=t.length;s<i;s++)o[t[s]]=T.css(e,t[s],!1,n);return o}return void 0!==r?T.style(e,t,r):T.css(e,t)},e,t,1<arguments.length)}}),((T.Tween=D).prototype={constructor:D,init:function(e,t,r,n,i,o){this.elem=e,this.prop=r,this.easing=i||T.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=n,this.unit=o||(T.cssNumber[r]?"":"px")},cur:function(){var e=D.propHooks[this.prop];return(e&&e.get?e:D.propHooks._default).get(this)},run:function(e){var t,r=D.propHooks[this.prop];return this.options.duration?this.pos=t=T.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),(r&&r.set?r:D.propHooks._default).set(this),this}}).init.prototype=D.prototype,(D.propHooks={_default:{get:function(e){return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(e=T.css(e.elem,e.prop,""))&&"auto"!==e?e:0},set:function(e){T.fx.step[e.prop]?T.fx.step[e.prop](e):1!==e.elem.nodeType||!T.cssHooks[e.prop]&&null==e.elem.style[cr(e.prop)]?e.elem[e.prop]=e.now:T.style(e.elem,e.prop,e.now+e.unit)}}}).scrollTop=D.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},T.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},T.fx=D.prototype.init,T.fx.step={};var mr,yr,vr=/^(?:toggle|show|hide)$/,br=/queueHooks$/;function wr(){yr&&(!1===E.hidden&&C.requestAnimationFrame?C.requestAnimationFrame(wr):C.setTimeout(wr,T.fx.interval),T.fx.tick())}function Cr(){return C.setTimeout(function(){mr=void 0}),mr=Date.now()}function Er(e,t){var r,n=0,i={height:e};for(t=t?1:0;n<4;n+=2-t)i["margin"+(r=yt[n])]=i["padding"+r]=e;return t&&(i.opacity=i.width=e),i}function Tr(e,t,r){for(var n,i=(P.tweeners[t]||[]).concat(P.tweeners["*"]),o=0,s=i.length;o<s;o++)if(n=i[o].call(r,t,e))return n}function P(i,e,t){var r,o,n,s,a,l,c,u=0,d=P.prefilters.length,h=T.Deferred().always(function(){delete p.elem}),p=function(){if(!o){for(var e=mr||Cr(),e=Math.max(0,f.startTime+f.duration-e),t=1-(e/f.duration||0),r=0,n=f.tweens.length;r<n;r++)f.tweens[r].run(t);if(h.notifyWith(i,[f,t,e]),t<1&&n)return e;n||h.notifyWith(i,[f,1,0]),h.resolveWith(i,[f])}return!1},f=h.promise({elem:i,props:T.extend({},e),opts:T.extend(!0,{specialEasing:{},easing:T.easing._default},t),originalProperties:e,originalOptions:t,startTime:mr||Cr(),duration:t.duration,tweens:[],createTween:function(e,t){t=T.Tween(i,f.opts,e,t,f.opts.specialEasing[e]||f.opts.easing);return f.tweens.push(t),t},stop:function(e){var t=0,r=e?f.tweens.length:0;if(!o){for(o=!0;t<r;t++)f.tweens[t].run(1);e?(h.notifyWith(i,[f,1,0]),h.resolveWith(i,[f,e])):h.rejectWith(i,[f,e])}return this}}),g=f.props,m=g,y=f.opts.specialEasing;for(n in m)if(a=y[s=M(n)],l=m[n],Array.isArray(l)&&(a=l[1],l=m[n]=l[0]),n!==s&&(m[s]=l,delete m[n]),(c=T.cssHooks[s])&&"expand"in c)for(n in l=c.expand(l),delete m[s],l)n in m||(m[n]=l[n],y[n]=a);else y[s]=a;for(;u<d;u++)if(r=P.prefilters[u].call(f,i,g,f.opts))return v(r.stop)&&(T._queueHooks(f.elem,f.opts.queue).stop=r.stop.bind(r)),r;return T.map(g,Tr,f),v(f.opts.start)&&f.opts.start.call(i,f),f.progress(f.opts.progress).done(f.opts.done,f.opts.complete).fail(f.opts.fail).always(f.opts.always),T.fx.timer(T.extend(p,{elem:i,anim:f,queue:f.opts.queue})),f}T.Animation=T.extend(P,{tweeners:{"*":[function(e,t){var r=this.createTween(e,t);return Ct(r.elem,e,mt.exec(t),r),r}]},tweener:function(e,t){for(var r,n=0,i=(e=v(e)?(t=e,["*"]):e.match(I)).length;n<i;n++)r=e[n],P.tweeners[r]=P.tweeners[r]||[],P.tweeners[r].unshift(t)},prefilters:[function(e,t,r){var n,i,o,s,a,l,c,u="width"in t||"height"in t,d=this,h={},p=e.style,f=e.nodeType&&gt(e),g=y.get(e,"fxshow");for(n in r.queue||(null==(s=T._queueHooks(e,"fx")).unqueued&&(s.unqueued=0,a=s.empty.fire,s.empty.fire=function(){s.unqueued||a()}),s.unqueued++,d.always(function(){d.always(function(){s.unqueued--,T.queue(e,"fx").length||s.empty.fire()})})),t)if(i=t[n],vr.test(i)){if(delete t[n],o=o||"toggle"===i,i===(f?"hide":"show")){if("show"!==i||!g||void 0===g[n])continue;f=!0}h[n]=g&&g[n]||T.style(e,n)}if((l=!T.isEmptyObject(t))||!T.isEmptyObject(h))for(n in u&&1===e.nodeType&&(r.overflow=[p.overflow,p.overflowX,p.overflowY],null==(c=g&&g.display)&&(c=y.get(e,"display")),"none"===(u=T.css(e,"display"))&&(c?u=c:(Tt([e],!0),c=e.style.display||c,u=T.css(e,"display"),Tt([e]))),"inline"===u||"inline-block"===u&&null!=c)&&"none"===T.css(e,"float")&&(l||(d.done(function(){p.display=c}),null==c&&(u=p.display,c="none"===u?"":u)),p.display="inline-block"),r.overflow&&(p.overflow="hidden",d.always(function(){p.overflow=r.overflow[0],p.overflowX=r.overflow[1],p.overflowY=r.overflow[2]})),l=!1,h)l||(g?"hidden"in g&&(f=g.hidden):g=y.access(e,"fxshow",{display:c}),o&&(g.hidden=!f),f&&Tt([e],!0),d.done(function(){for(n in f||Tt([e]),y.remove(e,"fxshow"),h)T.style(e,n,h[n])})),l=Tr(f?g[n]:0,n,d),n in g||(g[n]=l.start,f&&(l.end=l.start,l.start=0))}],prefilter:function(e,t){t?P.prefilters.unshift(e):P.prefilters.push(e)}}),T.speed=function(e,t,r){var n=e&&"object"==typeof e?T.extend({},e):{complete:r||!r&&t||v(e)&&e,duration:e,easing:r&&t||t&&!v(t)&&t};return T.fx.off?n.duration=0:"number"!=typeof n.duration&&(n.duration in T.fx.speeds?n.duration=T.fx.speeds[n.duration]:n.duration=T.fx.speeds._default),null!=n.queue&&!0!==n.queue||(n.queue="fx"),n.old=n.complete,n.complete=function(){v(n.old)&&n.old.call(this),n.queue&&T.dequeue(this,n.queue)},n},T.fn.extend({fadeTo:function(e,t,r,n){return this.filter(gt).css("opacity",0).show().end().animate({opacity:t},e,r,n)},animate:function(t,e,r,n){function i(){var e=P(this,T.extend({},t),s);(o||y.get(this,"finish"))&&e.stop(!0)}var o=T.isEmptyObject(t),s=T.speed(e,r,n);return i.finish=i,o||!1===s.queue?this.each(i):this.queue(s.queue,i)},stop:function(i,e,o){function s(e){var t=e.stop;delete e.stop,t(o)}return"string"!=typeof i&&(o=e,e=i,i=void 0),e&&this.queue(i||"fx",[]),this.each(function(){var e=!0,t=null!=i&&i+"queueHooks",r=T.timers,n=y.get(this);if(t)n[t]&&n[t].stop&&s(n[t]);else for(t in n)n[t]&&n[t].stop&&br.test(t)&&s(n[t]);for(t=r.length;t--;)r[t].elem!==this||null!=i&&r[t].queue!==i||(r[t].anim.stop(o),e=!1,r.splice(t,1));!e&&o||T.dequeue(this,i)})},finish:function(s){return!1!==s&&(s=s||"fx"),this.each(function(){var e,t=y.get(this),r=t[s+"queue"],n=t[s+"queueHooks"],i=T.timers,o=r?r.length:0;for(t.finish=!0,T.queue(this,s,[]),n&&n.stop&&n.stop.call(this,!0),e=i.length;e--;)i[e].elem===this&&i[e].queue===s&&(i[e].anim.stop(!0),i.splice(e,1));for(e=0;e<o;e++)r[e]&&r[e].finish&&r[e].finish.call(this);delete t.finish})}}),T.each(["toggle","show","hide"],function(e,n){var i=T.fn[n];T.fn[n]=function(e,t,r){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(Er(n,!0),e,t,r)}}),T.each({slideDown:Er("show"),slideUp:Er("hide"),slideToggle:Er("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,n){T.fn[e]=function(e,t,r){return this.animate(n,e,t,r)}}),T.timers=[],T.fx.tick=function(){var e,t=0,r=T.timers;for(mr=Date.now();t<r.length;t++)(e=r[t])()||r[t]!==e||r.splice(t--,1);r.length||T.fx.stop(),mr=void 0},T.fx.timer=function(e){T.timers.push(e),T.fx.start()},T.fx.interval=13,T.fx.start=function(){yr||(yr=!0,wr())},T.fx.stop=function(){yr=null},T.fx.speeds={slow:600,fast:200,_default:400},T.fn.delay=function(n,e){return n=T.fx&&T.fx.speeds[n]||n,this.queue(e=e||"fx",function(e,t){var r=C.setTimeout(e,n);t.stop=function(){C.clearTimeout(r)}})},s=E.createElement("input"),o=E.createElement("select").appendChild(E.createElement("option")),s.type="checkbox",g.checkOn=""!==s.value,g.optSelected=o.selected,(s=E.createElement("input")).value="t",s.type="radio",g.radioValue="t"===s.value;var Sr,_r=T.expr.attrHandle,xr=(T.fn.extend({attr:function(e,t){return u(this,T.attr,e,t,1<arguments.length)},removeAttr:function(e){return this.each(function(){T.removeAttr(this,e)})}}),T.extend({attr:function(e,t,r){var n,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===e.getAttribute?T.prop(e,t,r):(1===o&&T.isXMLDoc(e)||(i=T.attrHooks[t.toLowerCase()]||(T.expr.match.bool.test(t)?Sr:void 0)),void 0!==r?null===r?void T.removeAttr(e,t):i&&"set"in i&&void 0!==(n=i.set(e,r,t))?n:(e.setAttribute(t,r+""),r):!(i&&"get"in i&&null!==(n=i.get(e,t)))&&null==(n=T.find.attr(e,t))?void 0:n)},attrHooks:{type:{set:function(e,t){var r;if(!g.radioValue&&"radio"===t&&w(e,"input"))return r=e.value,e.setAttribute("type",t),r&&(e.value=r),t}}},removeAttr:function(e,t){var r,n=0,i=t&&t.match(I);if(i&&1===e.nodeType)for(;r=i[n++];)e.removeAttribute(r)}}),Sr={set:function(e,t,r){return!1===t?T.removeAttr(e,r):e.setAttribute(r,r),r}},T.each(T.expr.match.bool.source.match(/\w+/g),function(e,t){var s=_r[t]||T.find.attr;_r[t]=function(e,t,r){var n,i,o=t.toLowerCase();return r||(i=_r[o],_r[o]=n,n=null!=s(e,t,r)?o:null,_r[o]=i),n}}),/^(?:input|select|textarea|button)$/i),Rr=/^(?:a|area)$/i;function Ar(e){return(e.match(I)||[]).join(" ")}function Nr(e){return e.getAttribute&&e.getAttribute("class")||""}function Or(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(I)||[]}T.fn.extend({prop:function(e,t){return u(this,T.prop,e,t,1<arguments.length)},removeProp:function(e){return this.each(function(){delete this[T.propFix[e]||e]})}}),T.extend({prop:function(e,t,r){var n,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&T.isXMLDoc(e)||(t=T.propFix[t]||t,i=T.propHooks[t]),void 0!==r?i&&"set"in i&&void 0!==(n=i.set(e,r,t))?n:e[t]=r:i&&"get"in i&&null!==(n=i.get(e,t))?n:e[t]},propHooks:{tabIndex:{get:function(e){var t=T.find.attr(e,"tabindex");return t?parseInt(t,10):xr.test(e.nodeName)||Rr.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),g.optSelected||(T.propHooks.selected={get:function(e){e=e.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(e){e=e.parentNode;e&&(e.selectedIndex,e.parentNode)&&e.parentNode.selectedIndex}}),T.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){T.propFix[this.toLowerCase()]=this}),T.fn.extend({addClass:function(t){var e,r,n,i,o,s;return v(t)?this.each(function(e){T(this).addClass(t.call(this,e,Nr(this)))}):(e=Or(t)).length?this.each(function(){if(n=Nr(this),r=1===this.nodeType&&" "+Ar(n)+" "){for(o=0;o<e.length;o++)i=e[o],r.indexOf(" "+i+" ")<0&&(r+=i+" ");s=Ar(r),n!==s&&this.setAttribute("class",s)}}):this},removeClass:function(t){var e,r,n,i,o,s;return v(t)?this.each(function(e){T(this).removeClass(t.call(this,e,Nr(this)))}):arguments.length?(e=Or(t)).length?this.each(function(){if(n=Nr(this),r=1===this.nodeType&&" "+Ar(n)+" "){for(o=0;o<e.length;o++)for(i=e[o];-1<r.indexOf(" "+i+" ");)r=r.replace(" "+i+" "," ");s=Ar(r),n!==s&&this.setAttribute("class",s)}}):this:this.attr("class","")},toggleClass:function(t,r){var e,n,i,o,s=typeof t,a="string"==s||Array.isArray(t);return v(t)?this.each(function(e){T(this).toggleClass(t.call(this,e,Nr(this),r),r)}):"boolean"==typeof r&&a?r?this.addClass(t):this.removeClass(t):(e=Or(t),this.each(function(){if(a)for(o=T(this),i=0;i<e.length;i++)n=e[i],o.hasClass(n)?o.removeClass(n):o.addClass(n);else void 0!==t&&"boolean"!=s||((n=Nr(this))&&y.set(this,"__className__",n),this.setAttribute&&this.setAttribute("class",!n&&!1!==t&&y.get(this,"__className__")||""))}))},hasClass:function(e){for(var t,r=0,n=" "+e+" ";t=this[r++];)if(1===t.nodeType&&-1<(" "+Ar(Nr(t))+" ").indexOf(n))return!0;return!1}});function Ir(e){e.stopPropagation()}var Mr=/\r/g,kr=(T.fn.extend({val:function(t){var r,e,n,i=this[0];return arguments.length?(n=v(t),this.each(function(e){1!==this.nodeType||(null==(e=n?t.call(this,e,T(this).val()):t)?e="":"number"==typeof e?e+="":Array.isArray(e)&&(e=T.map(e,function(e){return null==e?"":e+""})),(r=T.valHooks[this.type]||T.valHooks[this.nodeName.toLowerCase()])&&"set"in r&&void 0!==r.set(this,e,"value"))||(this.value=e)})):i?(r=T.valHooks[i.type]||T.valHooks[i.nodeName.toLowerCase()])&&"get"in r&&void 0!==(e=r.get(i,"value"))?e:"string"==typeof(e=i.value)?e.replace(Mr,""):null==e?"":e:void 0}}),T.extend({valHooks:{option:{get:function(e){var t=T.find.attr(e,"value");return null!=t?t:Ar(T.text(e))}},select:{get:function(e){for(var t,r=e.options,n=e.selectedIndex,i="select-one"===e.type,o=i?null:[],s=i?n+1:r.length,a=n<0?s:i?n:0;a<s;a++)if(((t=r[a]).selected||a===n)&&!t.disabled&&(!t.parentNode.disabled||!w(t.parentNode,"optgroup"))){if(t=T(t).val(),i)return t;o.push(t)}return o},set:function(e,t){for(var r,n,i=e.options,o=T.makeArray(t),s=i.length;s--;)((n=i[s]).selected=-1<T.inArray(T.valHooks.option.get(n),o))&&(r=!0);return r||(e.selectedIndex=-1),o}}}}),T.each(["radio","checkbox"],function(){T.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=-1<T.inArray(T(e).val(),t)}},g.checkOn||(T.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),C.location),Dr={guid:Date.now()},Pr=/\?/,Lr=(T.parseXML=function(e){var t,r;if(!e||"string"!=typeof e)return null;try{t=(new C.DOMParser).parseFromString(e,"text/xml")}catch(e){}return r=t&&t.getElementsByTagName("parsererror")[0],t&&!r||T.error("Invalid XML: "+(r?T.map(r.childNodes,function(e){return e.textContent}).join("\n"):e)),t},/^(?:focusinfocus|focusoutblur)$/),Fr=(T.extend(T.event,{trigger:function(e,t,r,n){var i,o,s,a,l,c,u,d=[r||E],h=B.call(e,"type")?e.type:e,p=B.call(e,"namespace")?e.namespace.split("."):[],f=u=o=r=r||E;if(3!==r.nodeType&&8!==r.nodeType&&!Lr.test(h+T.event.triggered)&&(-1<h.indexOf(".")&&(h=(p=h.split(".")).shift(),p.sort()),a=h.indexOf(":")<0&&"on"+h,(e=e[T.expando]?e:new T.Event(h,"object"==typeof e&&e)).isTrigger=n?2:3,e.namespace=p.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=r),t=null==t?[e]:T.makeArray(t,[e]),c=T.event.special[h]||{},n||!c.trigger||!1!==c.trigger.apply(r,t))){if(!n&&!c.noBubble&&!F(r)){for(s=c.delegateType||h,Lr.test(s+h)||(f=f.parentNode);f;f=f.parentNode)d.push(f),o=f;o===(r.ownerDocument||E)&&d.push(o.defaultView||o.parentWindow||C)}for(i=0;(f=d[i++])&&!e.isPropagationStopped();)u=f,e.type=1<i?s:c.bindType||h,(l=(y.get(f,"events")||Object.create(null))[e.type]&&y.get(f,"handle"))&&l.apply(f,t),(l=a&&f[a])&&l.apply&&ut(f)&&(e.result=l.apply(f,t),!1===e.result)&&e.preventDefault();return e.type=h,n||e.isDefaultPrevented()||c._default&&!1!==c._default.apply(d.pop(),t)||!ut(r)||a&&v(r[h])&&!F(r)&&((o=r[a])&&(r[a]=null),T.event.triggered=h,e.isPropagationStopped()&&u.addEventListener(h,Ir),r[h](),e.isPropagationStopped()&&u.removeEventListener(h,Ir),T.event.triggered=void 0,o)&&(r[a]=o),e.result}},simulate:function(e,t,r){r=T.extend(new T.Event,r,{type:e,isSimulated:!0});T.event.trigger(r,null,t)}}),T.fn.extend({trigger:function(e,t){return this.each(function(){T.event.trigger(e,t,this)})},triggerHandler:function(e,t){var r=this[0];if(r)return T.event.trigger(e,t,r,!0)}}),/\[\]$/),Hr=/\r?\n/g,Ur=/^(?:submit|button|image|reset|file)$/i,Vr=/^(?:input|select|textarea|keygen)/i;T.param=function(e,t){function r(e,t){t=v(t)?t():t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==t?"":t)}var n,i=[];if(null==e)return"";if(Array.isArray(e)||e.jquery&&!T.isPlainObject(e))T.each(e,function(){r(this.name,this.value)});else for(n in e)!function r(n,e,i,o){if(Array.isArray(e))T.each(e,function(e,t){i||Fr.test(n)?o(n,t):r(n+"["+("object"==typeof t&&null!=t?e:"")+"]",t,i,o)});else if(i||"object"!==q(e))o(n,e);else for(var t in e)r(n+"["+t+"]",e[t],i,o)}(n,e[n],t,r);return i.join("&")},T.fn.extend({serialize:function(){return T.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=T.prop(this,"elements");return e?T.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!T(this).is(":disabled")&&Vr.test(this.nodeName)&&!Ur.test(e)&&(this.checked||!St.test(e))}).map(function(e,t){var r=T(this).val();return null==r?null:Array.isArray(r)?T.map(r,function(e){return{name:t.name,value:e.replace(Hr,"\r\n")}}):{name:t.name,value:r.replace(Hr,"\r\n")}}).get()}});var Wr=/%20/g,$r=/#.*$/,Br=/([?&])_=[^&]*/,jr=/^(.*?):[ \t]*([^\r\n]*)$/gm,zr=/^(?:GET|HEAD)$/,Yr=/^\/\//,Gr={},qr={},Kr="*/".concat("*"),Xr=E.createElement("a");function Jr(o){return function(e,t){"string"!=typeof e&&(t=e,e="*");var r,n=0,i=e.toLowerCase().match(I)||[];if(v(t))for(;r=i[n++];)"+"===r[0]?(r=r.slice(1)||"*",(o[r]=o[r]||[]).unshift(t)):(o[r]=o[r]||[]).push(t)}}function Zr(t,n,i,o){var s={},a=t===qr;function l(e){var r;return s[e]=!0,T.each(t[e]||[],function(e,t){t=t(n,i,o);return"string"!=typeof t||a||s[t]?a?!(r=t):void 0:(n.dataTypes.unshift(t),l(t),!1)}),r}return l(n.dataTypes[0])||!s["*"]&&l("*")}function Qr(e,t){var r,n,i=T.ajaxSettings.flatOptions||{};for(r in t)void 0!==t[r]&&((i[r]?e:n=n||{})[r]=t[r]);return n&&T.extend(!0,e,n),e}Xr.href=kr.href,T.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:kr.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(kr.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Kr,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":T.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Qr(Qr(e,T.ajaxSettings),t):Qr(T.ajaxSettings,e)},ajaxPrefilter:Jr(Gr),ajaxTransport:Jr(qr),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0);var l,c,u,r,d,h,p,n,f=T.ajaxSetup({},t=t||{}),g=f.context||f,m=f.context&&(g.nodeType||g.jquery)?T(g):T.event,y=T.Deferred(),v=T.Callbacks("once memory"),b=f.statusCode||{},i={},o={},s="canceled",w={readyState:0,getResponseHeader:function(e){var t;if(h){if(!r)for(r={};t=jr.exec(u);)r[t[1].toLowerCase()+" "]=(r[t[1].toLowerCase()+" "]||[]).concat(t[2]);t=r[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return h?u:null},setRequestHeader:function(e,t){return null==h&&(e=o[e.toLowerCase()]=o[e.toLowerCase()]||e,i[e]=t),this},overrideMimeType:function(e){return null==h&&(f.mimeType=e),this},statusCode:function(e){if(e)if(h)w.always(e[w.status]);else for(var t in e)b[t]=[b[t],e[t]];return this},abort:function(e){e=e||s;return l&&l.abort(e),a(0,e),this}};if(y.promise(w),f.url=((e||f.url||kr.href)+"").replace(Yr,kr.protocol+"//"),f.type=t.method||t.type||f.method||f.type,f.dataTypes=(f.dataType||"*").toLowerCase().match(I)||[""],null==f.crossDomain){e=E.createElement("a");try{e.href=f.url,e.href=e.href,f.crossDomain=Xr.protocol+"//"+Xr.host!=e.protocol+"//"+e.host}catch(e){f.crossDomain=!0}}if(f.data&&f.processData&&"string"!=typeof f.data&&(f.data=T.param(f.data,f.traditional)),Zr(Gr,f,t,w),!h){for(n in(p=T.event&&f.global)&&0==T.active++&&T.event.trigger("ajaxStart"),f.type=f.type.toUpperCase(),f.hasContent=!zr.test(f.type),c=f.url.replace($r,""),f.hasContent?f.data&&f.processData&&0===(f.contentType||"").indexOf("application/x-www-form-urlencoded")&&(f.data=f.data.replace(Wr,"+")):(e=f.url.slice(c.length),f.data&&(f.processData||"string"==typeof f.data)&&(c+=(Pr.test(c)?"&":"?")+f.data,delete f.data),!1===f.cache&&(c=c.replace(Br,"$1"),e=(Pr.test(c)?"&":"?")+"_="+Dr.guid+++e),f.url=c+e),f.ifModified&&(T.lastModified[c]&&w.setRequestHeader("If-Modified-Since",T.lastModified[c]),T.etag[c])&&w.setRequestHeader("If-None-Match",T.etag[c]),(f.data&&f.hasContent&&!1!==f.contentType||t.contentType)&&w.setRequestHeader("Content-Type",f.contentType),w.setRequestHeader("Accept",f.dataTypes[0]&&f.accepts[f.dataTypes[0]]?f.accepts[f.dataTypes[0]]+("*"!==f.dataTypes[0]?", "+Kr+"; q=0.01":""):f.accepts["*"]),f.headers)w.setRequestHeader(n,f.headers[n]);if(f.beforeSend&&(!1===f.beforeSend.call(g,w,f)||h))return w.abort();if(s="abort",v.add(f.complete),w.done(f.success),w.fail(f.error),l=Zr(qr,f,t,w)){if(w.readyState=1,p&&m.trigger("ajaxSend",[w,f]),h)return w;f.async&&0<f.timeout&&(d=C.setTimeout(function(){w.abort("timeout")},f.timeout));try{h=!1,l.send(i,a)}catch(e){if(h)throw e;a(-1,e)}}else a(-1,"No Transport")}return w;function a(e,t,r,n){var i,o,s,a=t;h||(h=!0,d&&C.clearTimeout(d),l=void 0,u=n||"",w.readyState=0<e?4:0,n=200<=e&&e<300||304===e,r&&(s=function(e,t,r){for(var n,i,o,s,a=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===n&&(n=e.mimeType||t.getResponseHeader("Content-Type"));if(n)for(i in a)if(a[i]&&a[i].test(n)){l.unshift(i);break}if(l[0]in r)o=l[0];else{for(i in r){if(!l[0]||e.converters[i+" "+l[0]]){o=i;break}s=s||i}o=o||s}if(o)return o!==l[0]&&l.unshift(o),r[o]}(f,w,r)),!n&&-1<T.inArray("script",f.dataTypes)&&T.inArray("json",f.dataTypes)<0&&(f.converters["text script"]=function(){}),s=function(e,t,r,n){var i,o,s,a,l,c={},u=e.dataTypes.slice();if(u[1])for(s in e.converters)c[s.toLowerCase()]=e.converters[s];for(o=u.shift();o;)if(e.responseFields[o]&&(r[e.responseFields[o]]=t),!l&&n&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=o,o=u.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(!(s=c[l+" "+o]||c["* "+o]))for(i in c)if((a=i.split(" "))[1]===o&&(s=c[l+" "+a[0]]||c["* "+a[0]])){!0===s?s=c[i]:!0!==c[i]&&(o=a[0],u.unshift(a[1]));break}if(!0!==s)if(s&&e.throws)t=s(t);else try{t=s(t)}catch(e){return{state:"parsererror",error:s?e:"No conversion from "+l+" to "+o}}}return{state:"success",data:t}}(f,s,w,n),n?(f.ifModified&&((r=w.getResponseHeader("Last-Modified"))&&(T.lastModified[c]=r),r=w.getResponseHeader("etag"))&&(T.etag[c]=r),204===e||"HEAD"===f.type?a="nocontent":304===e?a="notmodified":(a=s.state,i=s.data,n=!(o=s.error))):(o=a,!e&&a||(a="error",e<0&&(e=0))),w.status=e,w.statusText=(t||a)+"",n?y.resolveWith(g,[i,a,w]):y.rejectWith(g,[w,a,o]),w.statusCode(b),b=void 0,p&&m.trigger(n?"ajaxSuccess":"ajaxError",[w,f,n?i:o]),v.fireWith(g,[w,a]),p&&(m.trigger("ajaxComplete",[w,f]),--T.active||T.event.trigger("ajaxStop")))}},getJSON:function(e,t,r){return T.get(e,t,r,"json")},getScript:function(e,t){return T.get(e,void 0,t,"script")}}),T.each(["get","post"],function(e,i){T[i]=function(e,t,r,n){return v(t)&&(n=n||r,r=t,t=void 0),T.ajax(T.extend({url:e,type:i,dataType:n,data:t,success:r},T.isPlainObject(e)&&e))}}),T.ajaxPrefilter(function(e){for(var t in e.headers)"content-type"===t.toLowerCase()&&(e.contentType=e.headers[t]||"")}),T._evalUrl=function(e,t,r){return T.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){T.globalEval(e,t,r)}})},T.fn.extend({wrapAll:function(e){return this[0]&&(v(e)&&(e=e.call(this[0])),e=T(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(r){return v(r)?this.each(function(e){T(this).wrapInner(r.call(this,e))}):this.each(function(){var e=T(this),t=e.contents();t.length?t.wrapAll(r):e.append(r)})},wrap:function(t){var r=v(t);return this.each(function(e){T(this).wrapAll(r?t.call(this,e):t)})},unwrap:function(e){return this.parent(e).not("body").each(function(){T(this).replaceWith(this.childNodes)}),this}}),T.expr.pseudos.hidden=function(e){return!T.expr.pseudos.visible(e)},T.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},T.ajaxSettings.xhr=function(){try{return new C.XMLHttpRequest}catch(e){}};var en={0:200,1223:204},tn=T.ajaxSettings.xhr(),rn=(g.cors=!!tn&&"withCredentials"in tn,g.ajax=tn=!!tn,T.ajaxTransport(function(i){var o,s;if(g.cors||tn&&!i.crossDomain)return{send:function(e,t){var r,n=i.xhr();if(n.open(i.type,i.url,i.async,i.username,i.password),i.xhrFields)for(r in i.xhrFields)n[r]=i.xhrFields[r];for(r in i.mimeType&&n.overrideMimeType&&n.overrideMimeType(i.mimeType),i.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest"),e)n.setRequestHeader(r,e[r]);o=function(e){return function(){o&&(o=s=n.onload=n.onerror=n.onabort=n.ontimeout=n.onreadystatechange=null,"abort"===e?n.abort():"error"===e?"number"!=typeof n.status?t(0,"error"):t(n.status,n.statusText):t(en[n.status]||n.status,n.statusText,"text"!==(n.responseType||"text")||"string"!=typeof n.responseText?{binary:n.response}:{text:n.responseText},n.getAllResponseHeaders()))}},n.onload=o(),s=n.onerror=n.ontimeout=o("error"),void 0!==n.onabort?n.onabort=s:n.onreadystatechange=function(){4===n.readyState&&C.setTimeout(function(){o&&s()})},o=o("abort");try{n.send(i.hasContent&&i.data||null)}catch(e){if(o)throw e}},abort:function(){o&&o()}}}),T.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),T.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return T.globalEval(e),e}}}),T.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),T.ajaxTransport("script",function(r){var n,i;if(r.crossDomain||r.scriptAttrs)return{send:function(e,t){n=T("<script>").attr(r.scriptAttrs||{}).prop({charset:r.scriptCharset,src:r.url}).on("load error",i=function(e){n.remove(),i=null,e&&t("error"===e.type?404:200,e.type)}),E.head.appendChild(n[0])},abort:function(){i&&i()}}}),[]),nn=/(=)\?(?=&|$)|\?\?/,on=(T.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=rn.pop()||T.expando+"_"+Dr.guid++;return this[e]=!0,e}}),T.ajaxPrefilter("json jsonp",function(e,t,r){var n,i,o,s=!1!==e.jsonp&&(nn.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&nn.test(e.data)&&"data");if(s||"jsonp"===e.dataTypes[0])return n=e.jsonpCallback=v(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,s?e[s]=e[s].replace(nn,"$1"+n):!1!==e.jsonp&&(e.url+=(Pr.test(e.url)?"&":"?")+e.jsonp+"="+n),e.converters["script json"]=function(){return o||T.error(n+" was not called"),o[0]},e.dataTypes[0]="json",i=C[n],C[n]=function(){o=arguments},r.always(function(){void 0===i?T(C).removeProp(n):C[n]=i,e[n]&&(e.jsonpCallback=t.jsonpCallback,rn.push(n)),o&&v(i)&&i(o[0]),o=i=void 0}),"script"}),g.createHTMLDocument=((e=E.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===e.childNodes.length),T.parseHTML=function(e,t,r){var n;return"string"!=typeof e?[]:("boolean"==typeof t&&(r=t,t=!1),t||(g.createHTMLDocument?((n=(t=E.implementation.createHTMLDocument("")).createElement("base")).href=E.location.href,t.head.appendChild(n)):t=E),n=!r&&[],(r=qe.exec(e))?[t.createElement(r[1])]:(r=Nt([e],t,n),n&&n.length&&T(n).remove(),T.merge([],r.childNodes)))},T.fn.load=function(e,t,r){var n,i,o,s=this,a=e.indexOf(" ");return-1<a&&(n=Ar(e.slice(a)),e=e.slice(0,a)),v(t)?(r=t,t=void 0):t&&"object"==typeof t&&(i="POST"),0<s.length&&T.ajax({url:e,type:i||"GET",dataType:"html",data:t}).done(function(e){o=arguments,s.html(n?T("<div>").append(T.parseHTML(e)).find(n):e)}).always(r&&function(e,t){s.each(function(){r.apply(this,o||[e.responseText,t,e])})}),this},T.expr.pseudos.animated=function(t){return T.grep(T.timers,function(e){return t===e.elem}).length},T.offset={setOffset:function(e,t,r){var n,i,o,s,a=T.css(e,"position"),l=T(e),c={};"static"===a&&(e.style.position="relative"),o=l.offset(),n=T.css(e,"top"),s=T.css(e,"left"),a=("absolute"===a||"fixed"===a)&&-1<(n+s).indexOf("auto")?(i=(a=l.position()).top,a.left):(i=parseFloat(n)||0,parseFloat(s)||0),null!=(t=v(t)?t.call(e,r,T.extend({},o)):t).top&&(c.top=t.top-o.top+i),null!=t.left&&(c.left=t.left-o.left+a),"using"in t?t.using.call(e,c):l.css(c)}},T.fn.extend({offset:function(t){var e,r;return arguments.length?void 0===t?this:this.each(function(e){T.offset.setOffset(this,t,e)}):(r=this[0])?r.getClientRects().length?(e=r.getBoundingClientRect(),r=r.ownerDocument.defaultView,{top:e.top+r.pageYOffset,left:e.left+r.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,r,n=this[0],i={top:0,left:0};if("fixed"===T.css(n,"position"))t=n.getBoundingClientRect();else{for(t=this.offset(),r=n.ownerDocument,e=n.offsetParent||r.documentElement;e&&(e===r.body||e===r.documentElement)&&"static"===T.css(e,"position");)e=e.parentNode;e&&e!==n&&1===e.nodeType&&((i=T(e).offset()).top+=T.css(e,"borderTopWidth",!0),i.left+=T.css(e,"borderLeftWidth",!0))}return{top:t.top-i.top-T.css(n,"marginTop",!0),left:t.left-i.left-T.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&"static"===T.css(e,"position");)e=e.offsetParent;return e||vt})}}),T.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,i){var o="pageYOffset"===i;T.fn[t]=function(e){return u(this,function(e,t,r){var n;if(F(e)?n=e:9===e.nodeType&&(n=e.defaultView),void 0===r)return n?n[i]:e[t];n?n.scrollTo(o?n.pageXOffset:r,o?r:n.pageYOffset):e[t]=r},t,e,arguments.length)}}),T.each(["top","left"],function(e,r){T.cssHooks[r]=or(g.pixelPosition,function(e,t){if(t)return t=ir(e,r),Qt.test(t)?T(e).position()[r]+"px":t})}),T.each({Height:"height",Width:"width"},function(s,a){T.each({padding:"inner"+s,content:a,"":"outer"+s},function(n,o){T.fn[o]=function(e,t){var r=arguments.length&&(n||"boolean"!=typeof e),i=n||(!0===e||!0===t?"margin":"border");return u(this,function(e,t,r){var n;return F(e)?0===o.indexOf("outer")?e["inner"+s]:e.document.documentElement["client"+s]:9===e.nodeType?(n=e.documentElement,Math.max(e.body["scroll"+s],n["scroll"+s],e.body["offset"+s],n["offset"+s],n["client"+s])):void 0===r?T.css(e,t,i):T.style(e,t,r,i)},a,r?e:void 0,r)}})}),T.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){T.fn[t]=function(e){return this.on(t,e)}}),T.fn.extend({bind:function(e,t,r){return this.on(e,null,t,r)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,r,n){return this.on(t,e,r,n)},undelegate:function(e,t,r){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",r)},hover:function(e,t){return this.on("mouseenter",e).on("mouseleave",t||e)}}),T.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,r){T.fn[r]=function(e,t){return 0<arguments.length?this.on(r,null,e,t):this.trigger(r)}}),/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g),sn=(T.proxy=function(e,t){var r,n;if("string"==typeof t&&(n=e[t],t=e,e=n),v(e))return r=a.call(arguments,2),(n=function(){return e.apply(t||this,r.concat(a.call(arguments)))}).guid=e.guid=e.guid||T.guid++,n},T.holdReady=function(e){e?T.readyWait++:T.ready(!0)},T.isArray=Array.isArray,T.parseJSON=JSON.parse,T.nodeName=w,T.isFunction=v,T.isWindow=F,T.camelCase=M,T.type=q,T.now=Date.now,T.isNumeric=function(e){var t=T.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},T.trim=function(e){return null==e?"":(e+"").replace(on,"$1")},"function"==typeof define&&define.amd&&define("jquery",[],function(){return T}),C.jQuery),an=C.$;return T.noConflict=function(e){return C.$===T&&(C.$=an),e&&C.jQuery===T&&(C.jQuery=sn),T},void 0===L&&(C.jQuery=C.$=T),T}),!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(n){var r=[],i=n(document),o=n(window),l=[];n.alert=function(e,t){return n.alert.impl.init(e,t)},n.alert.close=function(){n.alert.impl.close()},n.alert.focus=function(e){n.alert.impl.focus(e)},n.alert.setContainerDimensions=function(){n.alert.impl.setContainerDimensions()},n.alert.setPosition=function(){n.alert.impl.setPosition()},n.alert.update=function(e,t){n.alert.impl.update(e,t)},n.fn.alert=function(e){return n.alert.impl.init(this,e)},n.alert.defaults={appendTo:"body",focus:!0,opacity:50,overlayId:"alertmodal-overlay",overlayCss:{},containerId:"alertmodal-container",containerCss:{},dataId:"alertmodal-data",dataCss:{},minHeight:null,minWidth:null,maxHeight:null,maxWidth:null,autoResize:!1,autoPosition:!0,zIndex:20200,close:!0,closeHTML:'<a class="modalCloseImg" title="Close"></a>',closeClass:"alertmodal-close",escClose:!1,overlayClose:!1,fixed:!0,position:null,persist:!1,alert:!0,onOpen:null,onShow:null,onClose:null},n.alert.impl={d:{},init:function(e,t){var r=this;if(r.d.data)return!1;if(n.boxModel,r.o=n.extend({},n.alert.defaults,t),r.zIndex=r.o.zIndex,r.occb=!1,"object"==typeof e)e=e instanceof jQuery?e:n(e),r.d.placeholder=!1,0<e.parent().parent().length&&(e.before(n("<span></span>").attr("id","alertmodal-placeholder").css({display:"none"})),r.d.placeholder=!0,r.display=e.css("display"),r.o.persist||(r.d.orig=e.clone(!0)));else{if("string"!=typeof e&&"number"!=typeof e)return alert("AlertModal Error: Unsupported data type: "+typeof e),r;e=n("<div></div>").html(e)}return r.create(e),e=null,r.open(),n.isFunction(r.o.onShow)&&r.o.onShow.apply(r,[r.d]),r},create:function(e){var t=this;t.getDimensions(),t.o.alert&&syn.$b.isIE6&&(t.d.iframe=n('<iframe src="javascript:false;"></iframe>').css(n.extend(t.o.iframeCss,{display:"none",opacity:0,position:"fixed",height:l[0],width:l[1],zIndex:t.o.zIndex,top:0,left:0})).appendTo(t.o.appendTo)),t.d.overlay=n("<div></div>").attr("id",t.o.overlayId).addClass("alertmodal-overlay").css(n.extend(t.o.overlayCss,{display:"none",opacity:t.o.opacity/100,height:t.o.alert?r[0]:0,width:t.o.alert?r[1]:0,position:"fixed",left:0,top:0,zIndex:t.o.zIndex+1})).appendTo(t.o.appendTo),t.d.container=n("<div></div>").attr("id",t.o.containerId).addClass("alertmodal-container").css(n.extend({position:"fixed"},t.o.containerCss,{display:"none",zIndex:t.o.zIndex+2})).append(t.o.close&&t.o.closeHTML?n(t.o.closeHTML).addClass(t.o.closeClass):"").appendTo(t.o.appendTo),t.d.wrap=n("<div></div>").attr("tabIndex",-1).addClass("alertmodal-wrap").css({height:"100%",outline:0,width:"100%"}).appendTo(t.d.container),t.d.data=e.attr("id",e.attr("id")||t.o.dataId).addClass("alertmodal-data").css(n.extend(t.o.dataCss,{display:"none"})).appendTo("body"),e=null,t.setContainerDimensions(),t.d.data.appendTo(t.d.wrap),syn.$b.isIE6&&t.fixIE()},bindEvents:function(){var t=this;n("."+t.o.closeClass).bind("click.alertmodal",function(e){e.preventDefault(),t.close()}),t.o.alert&&t.o.close&&t.o.overlayClose&&t.d.overlay.bind("click.alertmodal",function(e){e.preventDefault(),t.close()}),i.bind("keydown.alertmodal",function(e){t.o.alert&&9===e.keyCode?t.watchTab(e):t.o.close&&t.o.escClose&&27===e.keyCode&&(e.preventDefault(),t.close())}),o.bind("resize.alertmodal orientationchange.alertmodal",function(){t.getDimensions(),t.o.autoResize?t.setContainerDimensions():t.o.autoPosition&&t.setPosition(),syn.$b.isIE6?t.fixIE():t.o.alert&&(t.d.iframe&&t.d.iframe.css({height:l[0],width:l[1]}),t.d.overlay.css({height:r[0],width:r[1]}))})},unbindEvents:function(){n("."+this.o.closeClass).unbind("click.alertmodal"),i.unbind("keydown.alertmodal"),o.unbind(".alertmodal"),this.d.overlay.unbind("click.alertmodal")},fixIE:function(){var e=this,g=e.o.position;n.each([e.d.iframe||null,e.o.alert?e.d.overlay:null,"fixed"===e.d.container.css("position")?e.d.container:null],function(e,t){var r,n,i,o,s,a,l,c,u,d,h,p,f;t&&(r="document.body.clientHeight",n="document.body.clientWidth",h="document.body.scrollHeight",i="document.body.scrollLeft",o="document.body.scrollTop",s="document.body.scrollWidth",a="document.documentElement.clientHeight",l="document.documentElement.clientWidth",c="document.documentElement.scrollLeft",u="document.documentElement.scrollTop",(d=t[0].style).position="absolute",e<2?(d.removeExpression("height"),d.removeExpression("width"),d.setExpression("height",h+" > "+r+" ? "+h+" : "+r+' + "px"'),d.setExpression("width",s+" > "+n+" ? "+s+" : "+n+' + "px"')):(g&&g.constructor===Array?(f=-1===(e=g[0]?"number"==typeof g[0]?g[0].toString():g[0].replace(/px/,""):t.css("top").replace(/px/,"")).indexOf("%")?e+" + (t = "+u+" ? "+u+" : "+o+') + "px"':parseInt(e.replace(/%/,""))+" * (("+a+" || "+r+") / 100) + (t = "+u+" ? "+u+" : "+o+') + "px"',g[1]&&(p=-1===(h="number"==typeof g[1]?g[1].toString():g[1].replace(/px/,"")).indexOf("%")?h+" + (t = "+c+" ? "+c+" : "+i+') + "px"':parseInt(h.replace(/%/,""))+" * (("+l+" || "+n+") / 100) + (t = "+c+" ? "+c+" : "+i+') + "px"')):(f="("+a+" || "+r+") / 2 - (this.offsetHeight / 2) + (t = "+u+" ? "+u+" : "+o+') + "px"',p="("+l+" || "+n+") / 2 - (this.offsetWidth / 2) + (t = "+c+" ? "+c+" : "+i+') + "px"'),d.removeExpression("top"),d.removeExpression("left"),d.setExpression("top",f),d.setExpression("left",p)))})},focus:function(e){var t=this,e=e&&-1!==n.inArray(e,["first","last"])?e:"first",r=n(":input:enabled:visible:"+e,t.d.wrap);setTimeout(function(){(0<r.length?r:t.d.wrap).focus()},10)},getDimensions:function(){var e=o.height();r=[i.height(),i.width()],l=[e,o.width()]},getVal:function(e,t){return e?"number"==typeof e?e:"auto"===e?0:0<e.indexOf("%")?parseInt(e.replace(/%/,""))/100*("h"===t?l[0]:l[1]):parseInt(e.replace(/px/,"")):null},update:function(e,t){var r=this;if(!r.d.data)return!1;r.d.origHeight=r.getVal(e,"h"),r.d.origWidth=r.getVal(t,"w"),r.d.data.hide(),e&&r.d.container.css("height",e),t&&r.d.container.css("width",t),r.setContainerDimensions(),r.d.data.show(),r.o.focus&&r.focus(),r.unbindEvents(),r.bindEvents()},setContainerDimensions:function(){var e=this,t=(syn.$b.isIE6||syn.$b.isIE7,e.getVal(e.d.container.css("height"),"h")),r=e.getVal(e.d.container.css("width"),"h"),n=e.d.data.outerHeight(!0),i=e.d.data.outerWidth(!0),o=(e.d.origHeight=e.d.origHeight||t,e.d.origWidth=e.d.origWidth||r,e.o.maxHeight?e.getVal(e.o.maxHeight,"h"):null),s=e.o.maxWidth?e.getVal(e.o.maxWidth,"w"):null,o=o&&o<l[0]?o:l[0],s=s&&s<l[1]?s:l[1],a=e.o.minHeight?e.getVal(e.o.minHeight,"h"):"auto",t=t&&a<t?n?o<n?o:e.o.minHeight&&"auto"!==a&&n<a?a:n:a:e.o.autoResize&&o<t?o:t<a?a:t,o=e.o.minWidth?e.getVal(e.o.minWidth,"w"):"auto",r=r&&o<r?i?s<i?s:e.o.minWidth&&"auto"!==o&&i<o?o:i:o:e.o.autoResize&&s<r?s:r<o?o:r;e.d.container.css({height:t,width:r}),e.d.wrap.css({overflow:t<n||r<i?"auto":"visible"}),e.o.autoPosition&&e.setPosition()},setPosition:function(){var e,t=this,r=l[0]/2-t.d.container.outerHeight(!0)/2,n=l[1]/2-t.d.container.outerWidth(!0)/2,i="fixed"!==t.d.container.css("position")?o.scrollTop():0,i=t.o.position&&"[object Array]"===Object.prototype.toString.call(t.o.position)?(e=i+(t.o.position[0]||r),t.o.position[1]||n):(e=i+r,n);t.d.container.css({left:i,top:e})},watchTab:function(e){var t,r=this;0<n(e.target).parents(".alertmodal-container").length?(r.inputs=n(":input:enabled:visible:first, :input:enabled:visible:last",r.d.data[0]),(!e.shiftKey&&e.target===r.inputs[r.inputs.length-1]||e.shiftKey&&e.target===r.inputs[0]||0===r.inputs.length)&&(e.preventDefault(),t=e.shiftKey?"last":"first",r.focus(t))):(e.preventDefault(),r.focus())},open:function(){var e=this;e.d.iframe&&e.d.iframe.show(),n.isFunction(e.o.onOpen)?e.o.onOpen.apply(e,[e.d]):(e.d.overlay.show(),e.d.container.show(),e.d.data.show()),e.o.focus&&e.focus(),e.bindEvents()},close:function(){var e,t=this;if(!t.d.data)return!1;t.unbindEvents(),n.isFunction(t.o.onClose)&&!t.occb?(t.occb=!0,t.o.onClose.apply(t,[t.d])):(t.d.placeholder?(e=n("#alertmodal-placeholder"),t.o.persist?e.replaceWith(t.d.data.removeClass("alertmodal-data").css("display",t.display)):(t.d.data.hide().remove(),e.replaceWith(t.d.orig))):t.d.data.hide().remove(),t.d.container.hide().remove(),t.d.overlay.hide(),t.d.iframe&&t.d.iframe.hide().remove(),t.d.overlay.remove(),t.d={})}}}),!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=e(require("jQuery")):e(jQuery)}(function(n){var r=[],i=n(document),e=navigator.userAgent.toLowerCase(),o=n(window),l=[],c={ieQuirks:null,msie:/msie/.test(e)&&!/opera/.test(e),opera:/opera/.test(e)};c.ie6=c.msie&&/msie 6./.test(e)&&"object"!=typeof window.XMLHttpRequest,c.ie7=c.msie&&/msie 7.0/.test(e),c.boxModel="CSS1Compat"===document.compatMode,n.modal=function(e,t){return n.modal.impl.init(e,t)},n.modal.close=function(){n.modal.impl.close()},n.modal.focus=function(e){n.modal.impl.focus(e)},n.modal.setContainerDimensions=function(){n.modal.impl.setContainerDimensions()},n.modal.setPosition=function(){n.modal.impl.setPosition()},n.modal.update=function(e,t){n.modal.impl.update(e,t)},n.fn.modal=function(e){return n.modal.impl.init(this,e)},n.modal.defaults={appendTo:"body",focus:!0,opacity:50,overlayId:"simplemodal-overlay",overlayCss:{},containerId:"simplemodal-container",containerCss:{},dataId:"simplemodal-data",dataCss:{},minHeight:null,minWidth:null,maxHeight:null,maxWidth:null,autoResize:!1,autoPosition:!0,zIndex:1e3,close:!0,closeHTML:'<a class="modalCloseImg" title="Close"></a>',closeClass:"simplemodal-close",escClose:!0,overlayClose:!1,fixed:!0,position:null,persist:!1,modal:!0,onOpen:null,onShow:null,onClose:null},n.modal.impl={d:{},init:function(e,t){var r=this;if(r.d.data)return!1;if(c.ieQuirks=c.msie&&!c.boxModel,r.o=n.extend({},n.modal.defaults,t),r.zIndex=r.o.zIndex,r.occb=!1,"object"==typeof e)e=e instanceof n?e:n(e),r.d.placeholder=!1,0<e.parent().parent().length&&(e.before(n("<span></span>").attr("id","simplemodal-placeholder").css({display:"none"})),r.d.placeholder=!0,r.display=e.css("display"),r.o.persist||(r.d.orig=e.clone(!0)));else{if("string"!=typeof e&&"number"!=typeof e)return alert("SimpleModal Error: Unsupported data type: "+typeof e),r;e=n("<div></div>").html(e)}return r.create(e),e=null,r.open(),n.isFunction(r.o.onShow)&&r.o.onShow.apply(r,[r.d]),r},create:function(e){var t=this;t.getDimensions(),t.o.modal&&c.ie6&&(t.d.iframe=n('<iframe src="javascript:false;"></iframe>').css(n.extend(t.o.iframeCss,{display:"none",opacity:0,position:"fixed",height:l[0],width:l[1],zIndex:t.o.zIndex,top:0,left:0})).appendTo(t.o.appendTo)),t.d.overlay=n("<div></div>").attr("id",t.o.overlayId).addClass("simplemodal-overlay").css(n.extend(t.o.overlayCss,{display:"none",opacity:t.o.opacity/100,height:t.o.modal?r[0]:0,width:t.o.modal?r[1]:0,position:"fixed",left:0,top:0,zIndex:t.o.zIndex+1})).appendTo(t.o.appendTo),t.d.container=n("<div></div>").attr("id",t.o.containerId).attr("role","dialog").addClass("simplemodal-container").css(n.extend({position:t.o.fixed?"fixed":"absolute"},t.o.containerCss,{display:"none",zIndex:t.o.zIndex+2})).append(t.o.close&&t.o.closeHTML?n(t.o.closeHTML).addClass(t.o.closeClass):"").appendTo(t.o.appendTo),t.d.wrap=n("<div></div>").attr("tabIndex",-1).addClass("simplemodal-wrap").css({height:"100%",outline:0,width:"100%"}).appendTo(t.d.container),t.d.data=e.attr("id",e.attr("id")||t.o.dataId).addClass("simplemodal-data").css(n.extend(t.o.dataCss,{display:"none"})).appendTo("body"),e=null,t.setContainerDimensions(),t.d.data.appendTo(t.d.wrap),(c.ie6||c.ieQuirks)&&t.fixIE()},bindEvents:function(){var t=this;n("."+t.o.closeClass).bind("click.simplemodal",function(e){e.preventDefault(),t.close()}),t.o.modal&&t.o.close&&t.o.overlayClose&&t.d.overlay.bind("click.simplemodal",function(e){e.preventDefault(),t.close()}),i.bind("keydown.simplemodal",function(e){t.o.modal&&9===e.keyCode?t.watchTab(e):t.o.close&&t.o.escClose&&27===e.keyCode&&(e.preventDefault(),t.close())}),o.bind("resize.simplemodal orientationchange.simplemodal",function(){t.getDimensions(),t.o.autoResize?t.setContainerDimensions():t.o.autoPosition&&t.setPosition(),c.ie6||c.ieQuirks?t.fixIE():t.o.modal&&(t.d.iframe&&t.d.iframe.css({height:l[0],width:l[1]}),t.d.overlay.css({height:r[0],width:r[1]}))})},unbindEvents:function(){n("."+this.o.closeClass).unbind("click.simplemodal"),i.unbind("keydown.simplemodal"),o.unbind(".simplemodal"),this.d.overlay.unbind("click.simplemodal")},fixIE:function(){var e=this,g=e.o.position;n.each([e.d.iframe||null,e.o.modal?e.d.overlay:null,"fixed"===e.d.container.css("position")?e.d.container:null],function(e,t){var r,n,i,o,s,a,l,c,u,d,h,p,f;t&&(r="document.body.clientHeight",n="document.body.clientWidth",h="document.body.scrollHeight",i="document.body.scrollLeft",o="document.body.scrollTop",s="document.body.scrollWidth",a="document.documentElement.clientHeight",l="document.documentElement.clientWidth",c="document.documentElement.scrollLeft",u="document.documentElement.scrollTop",(d=t[0].style).position="absolute",e<2?(d.removeExpression("height"),d.removeExpression("width"),d.setExpression("height",h+" > "+r+" ? "+h+" : "+r+' + "px"'),d.setExpression("width",s+" > "+n+" ? "+s+" : "+n+' + "px"')):(g&&g.constructor===Array?(f=-1===(e=g[0]?"number"==typeof g[0]?g[0].toString():g[0].replace(/px/,""):t.css("top").replace(/px/,"")).indexOf("%")?e+" + (t = "+u+" ? "+u+" : "+o+') + "px"':parseInt(e.replace(/%/,""))+" * (("+a+" || "+r+") / 100) + (t = "+u+" ? "+u+" : "+o+') + "px"',g[1]&&(p=-1===(h="number"==typeof g[1]?g[1].toString():g[1].replace(/px/,"")).indexOf("%")?h+" + (t = "+c+" ? "+c+" : "+i+') + "px"':parseInt(h.replace(/%/,""))+" * (("+l+" || "+n+") / 100) + (t = "+c+" ? "+c+" : "+i+') + "px"')):(f="("+a+" || "+r+") / 2 - (this.offsetHeight / 2) + (t = "+u+" ? "+u+" : "+o+') + "px"',p="("+l+" || "+n+") / 2 - (this.offsetWidth / 2) + (t = "+c+" ? "+c+" : "+i+') + "px"'),d.removeExpression("top"),d.removeExpression("left"),d.setExpression("top",f),d.setExpression("left",p)))})},focus:function(e){var t=this,e=e&&-1!==n.inArray(e,["first","last"])?e:"first",r=n(":input:enabled:visible:"+e,t.d.wrap);setTimeout(function(){(0<r.length?r:t.d.wrap).focus()},10)},getDimensions:function(){var e=void 0===window.innerHeight?o.height():window.innerHeight;r=[i.height(),i.width()],l=[e,o.width()]},getVal:function(e,t){return e?"number"==typeof e?e:"auto"===e?0:0<e.indexOf("%")?parseInt(e.replace(/%/,""))/100*("h"===t?l[0]:l[1]):parseInt(e.replace(/px/,"")):null},update:function(e,t){var r=this;if(!r.d.data)return!1;r.d.origHeight=r.getVal(e,"h"),r.d.origWidth=r.getVal(t,"w"),r.d.data.hide(),e&&r.d.container.css("height",e),t&&r.d.container.css("width",t),r.setContainerDimensions(),r.d.data.show(),r.o.focus&&r.focus(),r.unbindEvents(),r.bindEvents()},setContainerDimensions:function(){var e=this,t=c.ie6||c.ie7,r=e.d.origHeight||(c.opera?e.d.container.height():e.getVal(t?e.d.container[0].currentStyle.height:e.d.container.css("height"),"h")),t=e.d.origWidth||(c.opera?e.d.container.width():e.getVal(t?e.d.container[0].currentStyle.width:e.d.container.css("width"),"w")),n=e.d.data.outerHeight(!0),i=e.d.data.outerWidth(!0),o=(e.d.origHeight=e.d.origHeight||r,e.d.origWidth=e.d.origWidth||t,e.o.maxHeight?e.getVal(e.o.maxHeight,"h"):null),s=e.o.maxWidth?e.getVal(e.o.maxWidth,"w"):null,o=o&&o<l[0]?o:l[0],s=s&&s<l[1]?s:l[1],a=e.o.minHeight?e.getVal(e.o.minHeight,"h"):"auto",r=r?e.o.autoResize&&o<r?o:r<a?a:r:n?o<n?o:e.o.minHeight&&"auto"!==a&&n<a?a:n:a,o=e.o.minWidth?e.getVal(e.o.minWidth,"w"):"auto",t=t?e.o.autoResize&&s<t?s:t<o?o:t:i?s<i?s:e.o.minWidth&&"auto"!==o&&i<o?o:i:o;e.d.container.css({height:r,width:t}),e.d.wrap.css({overflow:r<n||t<i?"auto":"visible"}),e.o.autoPosition&&e.setPosition()},setPosition:function(){var e,t=this,r=l[0]/2-t.d.container.outerHeight(!0)/2,n=l[1]/2-t.d.container.outerWidth(!0)/2,i="fixed"!==t.d.container.css("position")?o.scrollTop():0,i=t.o.position&&"[object Array]"===Object.prototype.toString.call(t.o.position)?(e=parseFloat(i)+parseFloat(t.o.position[0]||r),t.o.position[1]||n):(e=i+r,n);t.d.container.css({left:i,top:e})},watchTab:function(e){var t,r=this;0<n(e.target).parents(".simplemodal-container").length?(r.inputs=n(":input:enabled:visible:first, :input:enabled:visible:last",r.d.data[0]),(!e.shiftKey&&e.target===r.inputs[r.inputs.length-1]||e.shiftKey&&e.target===r.inputs[0]||0===r.inputs.length)&&(e.preventDefault(),t=e.shiftKey?"last":"first",r.focus(t))):(e.preventDefault(),r.focus())},open:function(){var e=this;e.d.iframe&&e.d.iframe.show(),n.isFunction(e.o.onOpen)?e.o.onOpen.apply(e,[e.d]):(e.d.overlay.show(),e.d.container.show(),e.d.data.show()),e.o.focus&&e.focus(),e.bindEvents()},close:function(){var e,t=this;if(!t.d.data)return!1;t.unbindEvents(),n.isFunction(t.o.onClose)&&!t.occb?(t.occb=!0,t.o.onClose.apply(t,[t.d])):(t.d.placeholder?(e=n("#simplemodal-placeholder"),t.o.persist?e.replaceWith(t.d.data.removeClass("simplemodal-data").css("display",t.display)):(t.d.data.hide().remove(),e.replaceWith(t.d.orig))):t.d.data.hide().remove(),t.d.container.hide().remove(),t.d.overlay.hide(),t.d.iframe&&t.d.iframe.hide().remove(),t.d.overlay.remove(),t.d={})}}}),!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof exports?require("jquery"):jQuery)}(function(T){var n,e=navigator.userAgent,S=/iphone/i.test(e),_=/chrome/i.test(e),x=/android/i.test(e);T.mask={definitions:{9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},autoclear:!0,dataName:"rawMaskFn",placeholder:"_"},T.fn.extend({caret:function(e,t){var r;if(0!==this.length&&!this.is(":hidden"))return"number"==typeof e?(t="number"==typeof t?t:e,this.each(function(){this.setSelectionRange?this.setSelectionRange(e,t):this.createTextRange&&((r=this.createTextRange()).collapse(!0),r.moveEnd("character",t),r.moveStart("character",e),r.select())})):(this[0].setSelectionRange?(e=this[0].selectionStart,t=this[0].selectionEnd):document.selection&&document.selection.createRange&&(r=document.selection.createRange(),e=0-r.duplicate().moveStart("character",-1e5),t=e+r.text.length),{begin:e,end:t})},unmask:function(){return this.trigger("unmask")},mask:function(t,l){var r,v,c,b,w,C,E,e;return!t&&0<this.length?(e=T(this[0]).data(T.mask.dataName))?e():void 0:(l=T.extend({autoclear:T.mask.autoclear,placeholder:T.mask.placeholder,completed:null},l),r=T.mask.definitions,v=[],c=C=t.length,b=null,T.each(t.split(""),function(e,t){"?"==t?(C--,c=e):r[t]?(v.push(new RegExp(r[t])),null===b&&(b=v.length-1),e<c&&(w=v.length-1)):v.push(null)}),this.trigger("unmask").each(function(){function u(){if(l.completed){for(var e=b;e<=w;e++)if(v[e]&&y[e]===d(e))return;l.completed.call(m)}}function d(e){return l.placeholder.charAt(e<l.placeholder.length?e:0)}function h(e){for(;++e<C&&!v[e];);return e}function p(e,t){var r,n;if(!(e<0)){for(r=e,n=h(t);r<C;r++)if(v[r]){if(!(n<C&&v[r].test(y[n])))break;y[r]=y[n],y[n]=d(n),n=h(n)}g(),m.caret(Math.max(b,e))}}function i(){o(),m.val()!=a&&m.change()}function f(e,t){for(var r=e;r<t&&r<C;r++)v[r]&&(y[r]=d(r))}function g(){m.val(y.join(""))}function o(e){for(var t,r=m.val(),n=-1,i=0,o=0;i<C;i++)if(v[i]){for(y[i]=d(i);o++<r.length;)if(t=r.charAt(o-1),v[i].test(t)){y[i]=t,n=i;break}if(o>r.length){f(i+1,C);break}}else y[i]===r.charAt(o)&&o++,i<c&&(n=i);return e?g():n+1<c?l.autoclear||y.join("")===s?(m.val()&&m.val(""),f(0,C)):g():(g(),m.val(m.val().substring(0,n+1))),c?i:b}var m=T(this),y=T.map(t.split(""),function(e,t){return"?"!=e?r[e]?d(t):e:void 0}),s=y.join(""),a=m.val();m.data(T.mask.dataName,function(){return T.map(y,function(e,t){return v[t]&&e!=d(t)?e:null}).join("")}),m.one("unmask",function(){m.off(".mask").removeData(T.mask.dataName)}).on("focus.mask",function(){var e;m.prop("readonly")||(clearTimeout(n),a=m.val(),e=o(),n=setTimeout(function(){m.get(0)===document.activeElement&&(g(),e==t.replace("?","").length?m.caret(0,e):m.caret(e))},10))}).on("blur.mask",i).on("keydown.mask",function(e){var t,r,n;m.prop("readonly")||(n=e.which||e.keyCode,E=m.val(),8===n||46===n||S&&127===n?(t=(r=m.caret()).begin,(r=r.end)-t==0&&(t=46!==n?function(e){for(;0<=--e&&!v[e];);return e}(t):r=h(t-1),r=46===n?h(r):r),f(t,r),p(t,r-1),e.preventDefault()):13===n?i.call(this,e):27===n&&(m.val(a),m.caret(0,o()),e.preventDefault()))}).on("keypress.mask",function(e){if(!m.prop("readonly")){var t,r,n,i=e.which||e.keyCode,o=m.caret();if(!(e.ctrlKey||e.altKey||e.metaKey||i<32)&&i&&13!==i){if(o.end-o.begin!=0&&(f(o.begin,o.end),p(o.begin,o.end-1)),(t=h(o.begin-1))<C&&(r=String.fromCharCode(i),v[t].test(r))){for(var s,a,l=t,c=d(t);l<C;l++)if(v[l]){if(s=h(l),a=y[l],y[l]=c,!(s<C&&v[s].test(a)))break;c=a}y[t]=r,g(),n=h(t),x?setTimeout(function(){T.proxy(T.fn.caret,m,n)()},0):m.caret(n),o.begin<=w&&u()}e.preventDefault()}}}).on("input.mask paste.mask",function(){m.prop("readonly")||setTimeout(function(){var e=o(!0);m.caret(e),u()},0)}),_&&x&&m.off("input.mask").on("input.mask",function(){var e=m.val(),t=m.caret();if(E&&E.length&&E.length>e.length){for(o(!0);0<t.begin&&!v[t.begin-1];)t.begin--;if(0===t.begin)for(;t.begin<b&&!v[t.begin];)t.begin++}else for(o(!0);t.begin<C&&!v[t.begin];)t.begin++;m.caret(t.begin,t.begin),u()}),o()}))}})}),!function(s){function a(e){var t=this.className.match(/resizer\-(\w+)/);return 2!=t.length||("t"==(t=t[1])[T=0]?T|=1:"b"==t[0]&&(T|=4),t.match(/l/)?T|=8:t.match(/r/)&&(T|=2),i=s(this).closest(".window").removeClass("minimized").removeClass("maximized").removeData("oldPos"),m=i.find("> .windowtitlebar").height()+5,(E=r(i)).right=E.parentW-i.outerWidth()-E.left,E.bottom=E.parentH-i.outerHeight()-E.top,E.width=E.height="auto",o=e.pageX,g=e.pageY,C.css(E),w.show(),!1)}function l(e){var t;return i=s(this).closest(".window"),(t=b?t:(new Date).getTime())-R<=250?(R=0,i.triggerHandler("dblclick")):(R=t,i.WM_raise(),(_=r(i)).width=i.width()+2,_.height=i.height()+2,_.bottom=_.right="auto",x.css(_),S.show(),o=e.pageX,g=e.pageY),!1}function r(e){return(e=e.offset()).top-=s(document).scrollTop(),e.left-=s(document).scrollLeft(),e.parentW=s(window).width(),e.parentH=s(window).height(),e}function n(e){var t;e.data("oldPos")||(t=r(e),e.data("oldPos",{top:t.top,left:t.left,right:"auto",bottom:"auto",width:e.width(),height:e.height()}))}function c(){return!1}function u(){return s(this).closest(".window").WM_raise(),!0}function d(){return s(this).closest(".window").WM_minimize(),!1}function h(){return s(this).closest(".window").WM_restore(),!1}function p(){return s(this).closest(".window").WM_maximize(),!1}function f(){var e=s(this).closest(".window"),t=e.attr("id"),r=syn.$w.channels.filter(function(e){return e.elID==t});return 0<r.length&&(e=(r=r[0]).windowHandle,r.channel.destroy(),""!=(r=e.attr("baseELID"))&&s("#"+r).closest(".window").WM_raise(),r=e.attr("id")+"_overlay",s("#"+r).remove(),e.WM_close()),!1}var i,o,g,m,y=1e4,v=50,b=navigator.userAgent.match(/MSIE/),w=s("<div id=resizerproxy>").mousemove(function(e){var t;return 1&T?(E.top+=-1*(g-e.pageY),(t=E.parentH-E.top-E.bottom-m)<0&&(E.top+=t)):4&T&&(E.bottom+=g-e.pageY,(t=E.parentH-E.top-E.bottom-m)<0)&&(E.bottom+=t),8&T?(E.left+=-1*(o-e.pageX),(t=E.parentW-E.left-E.right-160)<0&&(E.left+=t)):2&T&&(E.right+=o-e.pageX,(t=E.parentW-E.left-E.right-160)<0)&&(E.left+=t),o=e.pageX,g=e.pageY,C.css(E),!1}).mouseup(function(){return w.hide(),i.css(E).WM_ensure_viewable(),i=void 0,!1}),C=s("<div>").appendTo(w),E=null,T=null,S=s("<div id=moverproxy>").mousemove(function(e){return _.top+=-1*(g-e.pageY),_.left+=-1*(o-e.pageX),o=e.pageX,g=e.pageY,x.css(_),!1}).mouseup(function(){return S.hide(),i.css(_).WM_ensure_viewable().removeClass("moving"),i=void 0,!1}),_={left:0,top:0,right:"auto",bottom:"auto",width:0,height:0},x=s("<div>").appendTo(S),R=0;S[0].onselectstart=c,s.fn.WM_ensure_viewable=function(){return this.filter(".window").each(function(){var e=s(this),t=r(e);t.top<0?e.css("top",0):t.parentH-t.top<20&&e.css("top",t.parentH-20),t.left+e.width()<80?e.css({left:-1*e.width()+80,width:e.width(),right:"auto"}):t.parentW-t.left<30&&e.css("left",t.parentW-30)}),this},s.fn.WM_minimize=function(){return this.each(function(){var e=s(this);if(!e.is(".window"))return!0;e.removeClass("maximized"),n(e),m=e.find(">.windowtitlebar").height()+5,e.css({left:"auto",top:"auto",right:0,width:300,height:m,zIndex:1e4}).removeClass("focused").addClass("minimized")}),s.WM_retileMin(),this},s.WM_retileMin=function(){return s(".window.minimized").each(function(e){e*=m+2;s(this).css("bottom")!=e&&s(this).css("bottom",e)}),this},s.fn.WM_maximize=function(){var t;return this.each(function(){var e=s(this);if(!e.is(".window"))return!0;e.hasClass("minimized")&&(e.removeClass("minimized"),t=1),n(e),e.css({left:0,top:0,bottom:0,right:0,width:"auto",height:"auto"}).WM_raise().addClass("maximized")}),t&&s.WM_retileMin(),this},s.fn.WM_restore=function(){var t;return this.each(function(){var e=s(this);if(!e.is(".window"))return!0;e.hasClass("minimized")?(e.removeClass("minimized"),t=1):e.removeClass("maximized"),e.css(e.data("oldPos")).removeData("oldPos").WM_ensure_viewable()}),t&&s.WM_retileMin(),this.WM_raise(),this},s.fn.WM_raise=function(){var e,t=this.filter(".window:first");return 0==t.length||t.hasClass("focused")||(s(".window.focused").removeClass("focused"),t.addClass("focused"),(e=t.attr("baseELID"))?t.attr("id")!=e&&t.css("zIndex",++y):""!=e&&t.css("zIndex",++y)),this},s.fn.WM_close=function(){var e,t=this.attr("channelID");return t&&(e=syn.$w.channels.find(function(e){return e.id==t}),-1<(e=syn.$w.channels.indexOf(e)))&&syn.$w.channels.splice(e,1),this.filter(".window").remove()},s.WM_open=function(e,t,r,n){n=n||{};var i=s('<div class=window><div class=windowtitlebar><img src=/favicon.ico width=16 height=16 class=titlebaricon><div class=titlebartext></div><div class=horizbuts><div class=minimizebut title="hidden"></div><div class=restorebut style="display:none;" title=restore></div><div class="maximizebut" style="display: none;" title=close></div><div class=closebut title=close></div></div></div><div class=windowcontent></div><div class=resizer-tl></div><div class=resizer-t></div><div class=resizer-tr></div><div class=resizer-r></div><div class=resizer-br></div><div class=resizer-b></div><div class=resizer-bl></div><div class=resizer-l></div></div>'),e=(i[0].id=e,n.name||n.title||r||t),e=(t&&(e=t.replace(/^https?:\/\/[^\/]+\//,"").replace(/\.\w+$/,"").replace(/[^A-Za-z0-9]/g,"")),i.addClass("windowname_"+(e=e||"default")),400<(v+=10)&&(v=50),n.width&&i.css("width",n.width),n.height&&i.css("height",n.height),n.top?i.css("top",n.top):i.css("top",v),n.left?i.css("left",n.left):i.css("left",v),s(".resizer-tl,.resizer-t,.resizer-tr,.resizer-r,.resizer-br,.resizer-b,.resizer-bl,.resizer-l",i).mousedown(a),i.click(u),s(".windowtitlebar",i)),o=(e.mousedown(l),e.find("> .horizbuts").mousedown(c).children()),o=(o.eq(0).click(d),o.eq(1).click(h),o.eq(2).click(p),o.eq(3).click(f),e.children(".titlebartext").text(n.title||t||""));return o[0].onselectstart=c,o[0].unselectable="on",s(window.document.body).append(i),t&&("string"==typeof t?(e=n.scrolling||"no",(o=t.match(/^(https?\:\/\/)([^\/]+)/))&&o[2]!=document.location.hostname&&i.find(".titlebaricon").attr("src",o[1]+o[2]+"/favicon.ico"),s('<iframe src="'+t+'" target="'+r+'" scrolling="'+e+'"></iframe><div class=iframecover></div>').appendTo(i.find(".windowcontent"))):i.find(".windowcontent").append(t)),i.WM_raise(),i},s(document).delegate("a","click",function(e){return!((!e.button||0==e.button)&&this.target.match(/^\_child\b/)&&(e=s(this),window.jQuery.WM_open(this.href,this.target,{title:e.attr("title")||e.text().substr(0,100)}),1))}),s(window).resize(function(){return s(".window").WM_ensure_viewable(),!0}),s(function(){b&&s(document.body).addClass("IE"),s(document.body).append(S).append(w)})}(jQuery),!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(E){E.ui=E.ui||{};E.ui.version="1.12.1";var i,n,T,S,o,s,a,l,c,r,u=0,d=Array.prototype.slice;E.cleanData=(i=E.cleanData,function(e){for(var t,r,n=0;null!=(r=e[n]);n++)try{(t=E._data(r,"events"))&&t.remove&&E(r).triggerHandler("remove")}catch(e){}i(e)}),E.widget=function(e,r,t){var n,i,o,s={},a=e.split(".")[0],l=a+"-"+(e=e.split(".")[1]);return t||(t=r,r=E.Widget),E.isArray(t)&&(t=E.extend.apply(null,[{}].concat(t))),E.expr[":"][l.toLowerCase()]=function(e){return!!E.data(e,l)},E[a]=E[a]||{},n=E[a][e],i=E[a][e]=function(e,t){if(!this._createWidget)return new i(e,t);arguments.length&&this._createWidget(e,t)},E.extend(i,n,{version:t.version,_proto:E.extend({},t),_childConstructors:[]}),(o=new r).options=E.widget.extend({},o.options),E.each(t,function(t,n){function i(){return r.prototype[t].apply(this,arguments)}function o(e){return r.prototype[t].apply(this,e)}E.isFunction(n)?s[t]=function(){var e,t=this._super,r=this._superApply;return this._super=i,this._superApply=o,e=n.apply(this,arguments),this._super=t,this._superApply=r,e}:s[t]=n}),i.prototype=E.widget.extend(o,{widgetEventPrefix:n&&o.widgetEventPrefix||e},s,{constructor:i,namespace:a,widgetName:e,widgetFullName:l}),n?(E.each(n._childConstructors,function(e,t){var r=t.prototype;E.widget(r.namespace+"."+r.widgetName,i,t._proto)}),delete n._childConstructors):r._childConstructors.push(i),E.widget.bridge(e,i),i},E.widget.extend=function(e){for(var t,r,n=d.call(arguments,1),i=0,o=n.length;i<o;i++)for(t in n[i])r=n[i][t],n[i].hasOwnProperty(t)&&void 0!==r&&(E.isPlainObject(r)?e[t]=E.isPlainObject(e[t])?E.widget.extend({},e[t],r):E.widget.extend({},r):e[t]=r);return e},E.widget.bridge=function(o,t){var s=t.prototype.widgetFullName||o;E.fn[o]=function(r){var e="string"==typeof r,n=d.call(arguments,1),i=this;return e?this.length||"instance"!==r?this.each(function(){var e,t=E.data(this,s);return"instance"===r?(i=t,!1):t?E.isFunction(t[r])&&"_"!==r.charAt(0)?(e=t[r].apply(t,n))!==t&&void 0!==e?(i=e&&e.jquery?i.pushStack(e.get()):e,!1):void 0:E.error("no such method '"+r+"' for "+o+" widget instance"):E.error("cannot call methods on "+o+" prior to initialization; attempted to call method '"+r+"'")}):i=void 0:(n.length&&(r=E.widget.extend.apply(null,[r].concat(n))),this.each(function(){var e=E.data(this,s);e?(e.option(r||{}),e._init&&e._init()):E.data(this,s,new t(r,this))})),i}},E.Widget=function(){},E.Widget._childConstructors=[],E.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},_createWidget:function(e,t){t=E(t||this.defaultElement||this)[0],this.element=E(t),this.uuid=u++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=E(),this.hoverable=E(),this.focusable=E(),this.classesElementLookup={},t!==this&&(E.data(t,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===t&&this.destroy()}}),this.document=E(t.style?t.ownerDocument:t.document||t),this.window=E(this.document[0].defaultView||this.document[0].parentWindow)),this.options=E.widget.extend({},this.options,this._getCreateOptions(),e),this._create(),this.options.disabled&&this._setOptionDisabled(this.options.disabled),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:E.noop,_create:E.noop,_init:E.noop,destroy:function(){var r=this;this._destroy(),E.each(this.classesElementLookup,function(e,t){r._removeClass(t,e)}),this.element.off(this.eventNamespace).removeData(this.widgetFullName),this.widget().off(this.eventNamespace).removeAttr("aria-disabled"),this.bindings.off(this.eventNamespace)},_destroy:E.noop,widget:function(){return this.element},option:function(e,t){var r,n,i,o=e;if(0===arguments.length)return E.widget.extend({},this.options);if("string"==typeof e)if(o={},e=(r=e.split(".")).shift(),r.length){for(n=o[e]=E.widget.extend({},this.options[e]),i=0;i<r.length-1;i++)n[r[i]]=n[r[i]]||{},n=n[r[i]];if(e=r.pop(),1===arguments.length)return void 0===n[e]?null:n[e];n[e]=t}else{if(1===arguments.length)return void 0===this.options[e]?null:this.options[e];o[e]=t}return this._setOptions(o),this},_setOptions:function(e){for(var t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return"classes"===e&&this._setOptionClasses(t),this.options[e]=t,"disabled"===e&&this._setOptionDisabled(t),this},_setOptionClasses:function(e){var t,r,n;for(t in e)n=this.classesElementLookup[t],e[t]!==this.options.classes[t]&&n&&n.length&&(r=E(n.get()),this._removeClass(n,t),r.addClass(this._classes({element:r,keys:t,classes:e,add:!0})))},_setOptionDisabled:function(e){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!e),e&&(this._removeClass(this.hoverable,null,"ui-state-hover"),this._removeClass(this.focusable,null,"ui-state-focus"))},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_classes:function(i){var o=[],s=this;function e(e,t){for(var r,n=0;n<e.length;n++)r=s.classesElementLookup[e[n]]||E(),r=i.add?E(E.unique(r.get().concat(i.element.get()))):E(r.not(i.element).get()),s.classesElementLookup[e[n]]=r,o.push(e[n]),t&&i.classes[e[n]]&&o.push(i.classes[e[n]])}return i=E.extend({element:this.element,classes:this.options.classes||{}},i),this._on(i.element,{remove:"_untrackClassesElement"}),i.keys&&e(i.keys.match(/\S+/g)||[],!0),i.extra&&e(i.extra.match(/\S+/g)||[]),o.join(" ")},_untrackClassesElement:function(r){var n=this;E.each(n.classesElementLookup,function(e,t){-1!==E.inArray(r.target,t)&&(n.classesElementLookup[e]=E(t.not(r.target).get()))})},_removeClass:function(e,t,r){return this._toggleClass(e,t,r,!1)},_addClass:function(e,t,r){return this._toggleClass(e,t,r,!0)},_toggleClass:function(e,t,r,n){var i="string"==typeof e||null===e,t={extra:i?t:r,keys:i?e:t,element:i?this.element:e,add:n="boolean"==typeof n?n:r};return t.element.toggleClass(this._classes(t),n),this},_on:function(i,o,e){var s,a=this;"boolean"!=typeof i&&(e=o,o=i,i=!1),e?(o=s=E(o),this.bindings=this.bindings.add(o)):(e=o,o=this.element,s=this.widget()),E.each(e,function(e,t){function r(){if(i||!0!==a.options.disabled&&!E(this).hasClass("ui-state-disabled"))return("string"==typeof t?a[t]:t).apply(a,arguments)}"string"!=typeof t&&(r.guid=t.guid=t.guid||r.guid||E.guid++);var e=e.match(/^([\w:-]*)\s*(.*)$/),n=e[1]+a.eventNamespace,e=e[2];e?s.on(n,e,r):o.on(n,r)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.off(t).off(t),this.bindings=E(this.bindings.not(e).get()),this.focusable=E(this.focusable.not(e).get()),this.hoverable=E(this.hoverable.not(e).get())},_delay:function(e,t){var r=this;return setTimeout(function(){return("string"==typeof e?r[e]:e).apply(r,arguments)},t||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){this._addClass(E(e.currentTarget),null,"ui-state-hover")},mouseleave:function(e){this._removeClass(E(e.currentTarget),null,"ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){this._addClass(E(e.currentTarget),null,"ui-state-focus")},focusout:function(e){this._removeClass(E(e.currentTarget),null,"ui-state-focus")}})},_trigger:function(e,t,r){var n,i,o=this.options[e];if(r=r||{},(t=E.Event(t)).type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),t.target=this.element[0],i=t.originalEvent)for(n in i)n in t||(t[n]=i[n]);return this.element.trigger(t,r),!(E.isFunction(o)&&!1===o.apply(this.element[0],[t].concat(r))||t.isDefaultPrevented())}},E.each({show:"fadeIn",hide:"fadeOut"},function(o,s){E.Widget.prototype["_"+o]=function(t,e,r){var n=(e="string"==typeof e?{effect:e}:e)?!0!==e&&"number"!=typeof e&&e.effect||s:o,i=!E.isEmptyObject(e="number"==typeof(e=e||{})?{duration:e}:e);e.complete=r,e.delay&&t.delay(e.delay),i&&E.effects&&E.effects.effect[n]?t[o](e):n!==o&&t[n]?t[n](e.duration,e.easing,r):t.queue(function(e){E(this)[o](),r&&r.call(t[0]),e()})}}),E.widget;function _(e,t,r){return[parseFloat(e[0])*(c.test(e[0])?t/100:1),parseFloat(e[1])*(c.test(e[1])?r/100:1)]}function x(e,t){return parseInt(E.css(e,t),10)||0}T=Math.max,S=Math.abs,o=/left|center|right/,s=/top|center|bottom/,a=/[\+\-]\d+(\.[\d]+)?%?/,l=/^\w+/,c=/%$/,r=E.fn.position,E.position={scrollbarWidth:function(){var e,t,r;return void 0!==n?n:(r=(t=E("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>")).children()[0],E("body").append(t),e=r.offsetWidth,t.css("overflow","scroll"),e===(r=r.offsetWidth)&&(r=t[0].clientWidth),t.remove(),n=e-r)},getScrollInfo:function(e){var t=e.isWindow||e.isDocument?"":e.element.css("overflow-x"),r=e.isWindow||e.isDocument?"":e.element.css("overflow-y"),t="scroll"===t||"auto"===t&&e.width<e.element[0].scrollWidth;return{width:"scroll"===r||"auto"===r&&e.height<e.element[0].scrollHeight?E.position.scrollbarWidth():0,height:t?E.position.scrollbarWidth():0}},getWithinInfo:function(e){var t=E(e||window),r=E.isWindow(t[0]),n=!!t[0]&&9===t[0].nodeType;return{element:t,isWindow:r,isDocument:n,offset:!r&&!n?E(e).offset():{left:0,top:0},scrollLeft:t.scrollLeft(),scrollTop:t.scrollTop(),width:t.outerWidth(),height:t.outerHeight()}}},E.fn.position=function(d){if(!d||!d.of)return r.apply(this,arguments);d=E.extend({},d);var h,p,f,g,m,e,y=E(d.of),v=E.position.getWithinInfo(d.within),b=E.position.getScrollInfo(v),w=(d.collision||"flip").split(" "),C={},t=9===(t=(e=y)[0]).nodeType?{width:e.width(),height:e.height(),offset:{top:0,left:0}}:E.isWindow(t)?{width:e.width(),height:e.height(),offset:{top:e.scrollTop(),left:e.scrollLeft()}}:t.preventDefault?{width:0,height:0,offset:{top:t.pageY,left:t.pageX}}:{width:e.outerWidth(),height:e.outerHeight(),offset:e.offset()};return y[0].preventDefault&&(d.at="left top"),p=t.width,f=t.height,m=E.extend({},g=t.offset),E.each(["my","at"],function(){var e,t,r=(d[this]||"").split(" ");(r=1===r.length?o.test(r[0])?r.concat(["center"]):s.test(r[0])?["center"].concat(r):["center","center"]:r)[0]=o.test(r[0])?r[0]:"center",r[1]=s.test(r[1])?r[1]:"center",e=a.exec(r[0]),t=a.exec(r[1]),C[this]=[e?e[0]:0,t?t[0]:0],d[this]=[l.exec(r[0])[0],l.exec(r[1])[0]]}),1===w.length&&(w[1]=w[0]),"right"===d.at[0]?m.left+=p:"center"===d.at[0]&&(m.left+=p/2),"bottom"===d.at[1]?m.top+=f:"center"===d.at[1]&&(m.top+=f/2),h=_(C.at,p,f),m.left+=h[0],m.top+=h[1],this.each(function(){var r,e,s=E(this),a=s.outerWidth(),l=s.outerHeight(),t=x(this,"marginLeft"),n=x(this,"marginTop"),i=a+t+x(this,"marginRight")+b.width,o=l+n+x(this,"marginBottom")+b.height,c=E.extend({},m),u=_(C.my,s.outerWidth(),s.outerHeight());"right"===d.my[0]?c.left-=a:"center"===d.my[0]&&(c.left-=a/2),"bottom"===d.my[1]?c.top-=l:"center"===d.my[1]&&(c.top-=l/2),c.left+=u[0],c.top+=u[1],r={marginLeft:t,marginTop:n},E.each(["left","top"],function(e,t){E.ui.position[w[e]]&&E.ui.position[w[e]][t](c,{targetWidth:p,targetHeight:f,elemWidth:a,elemHeight:l,collisionPosition:r,collisionWidth:i,collisionHeight:o,offset:[h[0]+u[0],h[1]+u[1]],my:d.my,at:d.at,within:v,elem:s})}),d.using&&(e=function(e){var t=g.left-c.left,r=t+p-a,n=g.top-c.top,i=n+f-l,o={target:{element:y,left:g.left,top:g.top,width:p,height:f},element:{element:s,left:c.left,top:c.top,width:a,height:l},horizontal:r<0?"left":0<t?"right":"center",vertical:i<0?"top":0<n?"bottom":"middle"};p<a&&S(t+r)<p&&(o.horizontal="center"),f<l&&S(n+i)<f&&(o.vertical="middle"),T(S(t),S(r))>T(S(n),S(i))?o.important="horizontal":o.important="vertical",d.using.call(this,e,o)}),s.offset(E.extend(c,{using:e}))})},E.ui.position={fit:{left:function(e,t){var r,n=t.within,i=n.isWindow?n.scrollLeft:n.offset.left,n=n.width,o=e.left-t.collisionPosition.marginLeft,s=i-o,a=o+t.collisionWidth-n-i;t.collisionWidth>n?0<s&&a<=0?(r=e.left+s+t.collisionWidth-n-i,e.left+=s-r):e.left=!(0<a&&s<=0)&&a<s?i+n-t.collisionWidth:i:0<s?e.left+=s:0<a?e.left-=a:e.left=T(e.left-o,e.left)},top:function(e,t){var r,n=t.within,n=n.isWindow?n.scrollTop:n.offset.top,i=t.within.height,o=e.top-t.collisionPosition.marginTop,s=n-o,a=o+t.collisionHeight-i-n;t.collisionHeight>i?0<s&&a<=0?(r=e.top+s+t.collisionHeight-i-n,e.top+=s-r):e.top=!(0<a&&s<=0)&&a<s?n+i-t.collisionHeight:n:0<s?e.top+=s:0<a?e.top-=a:e.top=T(e.top-o,e.top)}},flip:{left:function(e,t){var r=t.within,n=r.offset.left+r.scrollLeft,i=r.width,r=r.isWindow?r.scrollLeft:r.offset.left,o=e.left-t.collisionPosition.marginLeft,s=o-r,o=o+t.collisionWidth-i-r,a="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,l="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,c=-2*t.offset[0];s<0?((i=e.left+a+l+c+t.collisionWidth-i-n)<0||i<S(s))&&(e.left+=a+l+c):0<o&&(0<(n=e.left-t.collisionPosition.marginLeft+a+l+c-r)||S(n)<o)&&(e.left+=a+l+c)},top:function(e,t){var r=t.within,n=r.offset.top+r.scrollTop,i=r.height,r=r.isWindow?r.scrollTop:r.offset.top,o=e.top-t.collisionPosition.marginTop,s=o-r,o=o+t.collisionHeight-i-r,a="top"===t.my[1]?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,l="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,c=-2*t.offset[1];s<0?((i=e.top+a+l+c+t.collisionHeight-i-n)<0||i<S(s))&&(e.top+=a+l+c):0<o&&(0<(n=e.top-t.collisionPosition.marginTop+a+l+c-r)||S(n)<o)&&(e.top+=a+l+c)}},flipfit:{left:function(){E.ui.position.flip.left.apply(this,arguments),E.ui.position.fit.left.apply(this,arguments)},top:function(){E.ui.position.flip.top.apply(this,arguments),E.ui.position.fit.top.apply(this,arguments)}}};var e;E.ui.position,E.ui.keyCode={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38},E.fn.extend({uniqueId:(e=0,function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})}),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&E(this).removeAttr("id")})}}),E.ui.safeActiveElement=function(t){var r;try{r=t.activeElement}catch(e){r=t.body}return r=(r=r||t.body).nodeName?r:t.body},E.widget("ui.menu",{version:"1.12.1",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-caret-1-e"},items:"> *",menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().attr({role:this.options.role,tabIndex:0}),this._addClass("ui-menu","ui-widget ui-widget-content"),this._on({"mousedown .ui-menu-item":function(e){e.preventDefault()},"click .ui-menu-item":function(e){var t=E(e.target),r=E(E.ui.safeActiveElement(this.document[0]));!this.mouseHandled&&t.not(".ui-state-disabled").length&&(this.select(e),e.isPropagationStopped()||(this.mouseHandled=!0),t.has(".ui-menu").length?this.expand(e):!this.element.is(":focus")&&r.closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active)&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer))},"mouseenter .ui-menu-item":function(e){var t,r;this.previousFilter||(t=E(e.target).closest(".ui-menu-item"),r=E(e.currentTarget),t[0]===r[0]&&(this._removeClass(r.siblings().children(".ui-state-active"),null,"ui-state-active"),this.focus(e,r)))},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(e,t){var r=this.active||this.element.find(this.options.items).eq(0);t||this.focus(e,r)},blur:function(e){this._delay(function(){E.contains(this.element[0],E.ui.safeActiveElement(this.document[0]))||this.collapseAll(e)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(e){this._closeOnDocumentClick(e)&&this.collapseAll(e),this.mouseHandled=!1}})},_destroy:function(){var e=this.element.find(".ui-menu-item").removeAttr("role aria-disabled").children(".ui-menu-item-wrapper").removeUniqueId().removeAttr("tabIndex role aria-haspopup");this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeAttr("role aria-labelledby aria-expanded aria-hidden aria-disabled tabIndex").removeUniqueId().show(),e.children().each(function(){var e=E(this);e.data("ui-menu-submenu-caret")&&e.remove()})},_keydown:function(e){var t,r,n,i=!0;switch(e.keyCode){case E.ui.keyCode.PAGE_UP:this.previousPage(e);break;case E.ui.keyCode.PAGE_DOWN:this.nextPage(e);break;case E.ui.keyCode.HOME:this._move("first","first",e);break;case E.ui.keyCode.END:this._move("last","last",e);break;case E.ui.keyCode.UP:this.previous(e);break;case E.ui.keyCode.DOWN:this.next(e);break;case E.ui.keyCode.LEFT:this.collapse(e);break;case E.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(e);break;case E.ui.keyCode.ENTER:case E.ui.keyCode.SPACE:this._activate(e);break;case E.ui.keyCode.ESCAPE:this.collapse(e);break;default:t=this.previousFilter||"",n=i=!1,r=96<=e.keyCode&&e.keyCode<=105?(e.keyCode-96).toString():String.fromCharCode(e.keyCode),clearTimeout(this.filterTimer),r===t?n=!0:r=t+r,t=this._filterMenuItems(r),(t=n&&-1!==t.index(this.active.next())?this.active.nextAll(".ui-menu-item"):t).length||(r=String.fromCharCode(e.keyCode),t=this._filterMenuItems(r)),t.length?(this.focus(e,t),this.previousFilter=r,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter}i&&e.preventDefault()},_activate:function(e){this.active&&!this.active.is(".ui-state-disabled")&&(this.active.children("[aria-haspopup='true']").length?this.expand(e):this.select(e))},refresh:function(){var e,t,n=this,i=this.options.icons.submenu,r=this.element.find(this.options.menus);this._toggleClass("ui-menu-icons",null,!!this.element.find(".ui-icon").length),e=r.filter(":not(.ui-menu)").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var e=E(this),t=e.prev(),r=E("<span>").data("ui-menu-submenu-caret",!0);n._addClass(r,"ui-menu-icon","ui-icon "+i),t.attr("aria-haspopup","true").prepend(r),e.attr("aria-labelledby",t.attr("id"))}),this._addClass(e,"ui-menu","ui-widget ui-widget-content ui-front"),(e=r.add(this.element).find(this.options.items)).not(".ui-menu-item").each(function(){var e=E(this);n._isDivider(e)&&n._addClass(e,"ui-menu-divider","ui-widget-content")}),t=(r=e.not(".ui-menu-item, .ui-menu-divider")).children().not(".ui-menu").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),this._addClass(r,"ui-menu-item")._addClass(t,"ui-menu-item-wrapper"),e.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!E.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(e,t){var r;"icons"===e&&(r=this.element.find(".ui-menu-icon"),this._removeClass(r,null,this.options.icons.submenu)._addClass(r,null,t.submenu)),this._super(e,t)},_setOptionDisabled:function(e){this._super(e),this.element.attr("aria-disabled",String(e)),this._toggleClass(null,"ui-state-disabled",!!e)},focus:function(e,t){var r;this.blur(e,e&&"focus"===e.type),this._scrollIntoView(t),this.active=t.first(),r=this.active.children(".ui-menu-item-wrapper"),this._addClass(r,null,"ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",r.attr("id")),r=this.active.parent().closest(".ui-menu-item").children(".ui-menu-item-wrapper"),this._addClass(r,null,"ui-state-active"),e&&"keydown"===e.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),(r=t.children(".ui-menu")).length&&e&&/^mouse/.test(e.type)&&this._startOpening(r),this.activeMenu=t.parent(),this._trigger("focus",e,{item:t})},_scrollIntoView:function(e){var t,r,n;this._hasScroll()&&(t=parseFloat(E.css(this.activeMenu[0],"borderTopWidth"))||0,r=parseFloat(E.css(this.activeMenu[0],"paddingTop"))||0,t=e.offset().top-this.activeMenu.offset().top-t-r,r=this.activeMenu.scrollTop(),n=this.activeMenu.height(),e=e.outerHeight(),t<0?this.activeMenu.scrollTop(r+t):n<t+e&&this.activeMenu.scrollTop(r+t-n+e))},blur:function(e,t){t||clearTimeout(this.timer),this.active&&(this._removeClass(this.active.children(".ui-menu-item-wrapper"),null,"ui-state-active"),this._trigger("blur",e,{item:this.active}),this.active=null)},_startOpening:function(e){clearTimeout(this.timer),"true"===e.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(e)},this.delay))},_open:function(e){var t=E.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(e.parents(".ui-menu")).hide().attr("aria-hidden","true"),e.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(t)},collapseAll:function(t,r){clearTimeout(this.timer),this.timer=this._delay(function(){var e=r?this.element:E(t&&t.target).closest(this.element.find(".ui-menu"));e.length||(e=this.element),this._close(e),this.blur(t),this._removeClass(e.find(".ui-state-active"),null,"ui-state-active"),this.activeMenu=e},this.delay)},_close:function(e){(e=e||(this.active?this.active.parent():this.element)).find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false")},_closeOnDocumentClick:function(e){return!E(e.target).closest(".ui-menu").length},_isDivider:function(e){return!/[^\-\u2014\u2013\s]/.test(e.text())},collapse:function(e){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);t&&t.length&&(this._close(),this.focus(e,t))},expand:function(e){var t=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();t&&t.length&&(this._open(t.parent()),this._delay(function(){this.focus(e,t)}))},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(e,t,r){var n;(n=this.active?"first"===e||"last"===e?this.active["first"===e?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[e+"All"](".ui-menu-item").eq(0):n)&&n.length&&this.active||(n=this.activeMenu.find(this.options.items)[t]()),this.focus(r,n)},nextPage:function(e){var t,r,n;this.active?this.isLastItem()||(this._hasScroll()?(r=this.active.offset().top,n=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return(t=E(this)).offset().top-r-n<0}),this.focus(e,t)):this.focus(e,this.activeMenu.find(this.options.items)[this.active?"last":"first"]())):this.next(e)},previousPage:function(e){var t,r,n;this.active?this.isFirstItem()||(this._hasScroll()?(r=this.active.offset().top,n=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return 0<(t=E(this)).offset().top-r+n}),this.focus(e,t)):this.focus(e,this.activeMenu.find(this.options.items).first())):this.next(e)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(e){this.active=this.active||E(e.target).closest(".ui-menu-item");var t={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(e,!0),this._trigger("select",e,t)},_filterMenuItems:function(e){var e=e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),t=new RegExp("^"+e,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return t.test(E.trim(E(this).children(".ui-menu-item-wrapper").text()))})}})}),!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery","jquery-ui/ui/widgets/menu"],e):e(jQuery)}(function(a){"use strict";var r="onselectstart"in document.createElement("div"),e=a.ui.menu.version.match(/^(\d)\.(\d+)/),t=parseInt(e[1],10),e=parseInt(e[2],10),i=t<2&&e<=10,o=t<2&&e<=11;a.widget("moogle.contextmenu",{version:"@VERSION",options:{addClass:"ui-contextmenu",closeOnWindowBlur:!0,autoFocus:!1,autoTrigger:!0,delegate:null,hide:{effect:"fadeOut",duration:"fast"},ignoreParentSelect:!0,menu:null,position:null,preventContextMenuForPopup:!1,preventSelect:!1,show:{effect:"slideDown",duration:"fast"},taphold:!1,uiMenuOptions:{},beforeOpen:a.noop,blur:a.noop,close:a.noop,create:a.noop,createMenu:a.noop,focus:a.noop,open:a.noop,select:a.noop},_create:function(){var t,e=this.options;if(this.$headStyle=null,this.$menu=null,this.menuIsTemp=!1,this.currentTarget=null,this.extraData={},(this.previousFocus=null)==e.delegate&&a.error("ui-contextmenu: Missing required option `delegate`."),e.preventSelect){t="#"+(a(this.element).is(document)?a("body"):this.element).uniqueId().attr("id")+" "+e.delegate+" { -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; }",this.$headStyle=a("<style class='moogle-contextmenu-style' />").prop("type","text/css").appendTo("head");try{this.$headStyle.html(t)}catch(e){this.$headStyle[0].styleSheet.cssText=t}r&&this.element.on("selectstart"+this.eventNamespace,e.delegate,function(e){e.preventDefault()})}this._createUiMenu(e.menu),t="contextmenu"+this.eventNamespace,e.taphold&&(t+=" taphold"+this.eventNamespace),this.element.on(t,e.delegate,a.proxy(this._openMenu,this))},_destroy:function(){this.element.off(this.eventNamespace),this._createUiMenu(null),this.$headStyle&&(this.$headStyle.remove(),this.$headStyle=null)},_createUiMenu:function(e){var t,r,i=this.options;this.isOpen()&&(t=this.currentTarget,r=this.extraData,this._closeMenu(!0),this.currentTarget=t,this.extraData=r),this.menuIsTemp?this.$menu.remove():this.$menu&&this.$menu.menu("destroy").removeClass(this.options.addClass).hide(),this.$menu=null,this.menuIsTemp=!1,e&&(a.isArray(e)?(this.$menu=a.moogle.contextmenu.createMenuMarkup(e),this.menuIsTemp=!0):this.$menu="string"==typeof e?a(e):e,this.$menu.hide().addClass(i.addClass).menu(a.extend(!0,{},i.uiMenuOptions,{items:"> :not(.ui-widget-header)",blur:a.proxy(i.blur,this),create:a.proxy(i.createMenu,this),focus:a.proxy(i.focus,this),select:a.proxy(function(e,t){var r=a.moogle.contextmenu.isMenu(t.item),n=t.item.data("actionHandler");t.cmd=t.item.attr("data-command"),t.target=a(this.currentTarget),t.extraData=this.extraData,r&&i.ignoreParentSelect||(r=this._trigger.call(this,"select",e,t),!1!==(r=n?n.call(this,e,t):r)&&this._closeMenu.call(this),e.preventDefault())},this)})))},_openMenu:function(t,e){var r,n=this.options,i=n.position,o=this,s=!!t.isTrigger;if(n.autoTrigger||s){if(t.preventDefault(),this.currentTarget=t.target,this.extraData=t._extraData||{},r={menu:this.$menu,target:a(this.currentTarget),extraData:this.extraData,originalEvent:t,result:null},!e){if(s=this._trigger("beforeOpen",t,r),e=r.result&&a.isFunction(r.result.promise)?r.result:null,r.result=null,!1===s)return this.currentTarget=null,!1;if(e)return e.done(function(){o._openMenu(t,!0)}),this.currentTarget=null,!1;r.menu=this.$menu}a(document).on("keydown"+this.eventNamespace,function(e){e.which===a.ui.keyCode.ESCAPE&&o._closeMenu()}).on("mousedown"+this.eventNamespace+" touchstart"+this.eventNamespace,function(e){a(e.target).closest(".ui-menu-item").length||o._closeMenu()}),a(window).on("blur"+this.eventNamespace,function(e){n.closeOnWindowBlur&&o._closeMenu()}),a.isFunction(i)&&(i=i(t,r)),i=a.extend({my:"left top",at:"left bottom",of:void 0===t.pageX?t.target:t,collision:"fit"},i),this._updateEntries(this.$menu),this.$menu.show().css({position:"absolute",left:0,top:0}).position(i).hide(),n.preventContextMenuForPopup&&this.$menu.on("contextmenu"+this.eventNamespace,function(e){e.preventDefault()}),this._show(this.$menu,n.show,function(){var e;n.autoFocus&&(o.previousFocus=a(t.target),e=o.$menu.children("li.ui-menu-item").not(".ui-state-disabled").first(),o.$menu.menu("focus",null,e).focus()),o._trigger.call(o,"open",t,r)})}},_closeMenu:function(e){var t=this,e=!e&&this.options.hide,r={menu:this.$menu,target:a(this.currentTarget),extraData:this.extraData};a(document).off("mousedown"+this.eventNamespace).off("touchstart"+this.eventNamespace).off("keydown"+this.eventNamespace),a(window).off("blur"+this.eventNamespace),t.currentTarget=null,t.extraData={},this.$menu?(this.$menu.off("contextmenu"+this.eventNamespace),this._hide(this.$menu,e,function(){t.previousFocus&&(t.previousFocus.focus(),t.previousFocus=null),t._trigger("close",null,r)})):t._trigger("close",null,r)},_setOption:function(e,t){"menu"===e&&this.replaceMenu(t),a.Widget.prototype._setOption.apply(this,arguments)},_getMenuEntry:function(e){return this.$menu.find("li[data-command="+e+"]")},close:function(){this.isOpen()&&this._closeMenu()},_updateEntries:function(){var i=this,o={menu:this.$menu,target:a(this.currentTarget),extraData:this.extraData};a.each(this.$menu.find(".ui-menu-item"),function(e,t){var t=a(t),r=t.data("disabledHandler"),n=r?r({type:"disabled"},o):null;o.item=t,o.cmd=t.attr("data-command"),null!=n&&(i.enableEntry(o.cmd,!n),i.showEntry(o.cmd,"hide"!==n)),null!=(n=(r=t.data("titleHandler"))?r({type:"title"},o):null)&&i.setTitle(o.cmd,""+n),null!=(n=(r=t.data("tooltipHandler"))?r({type:"tooltip"},o):null)&&t.attr("title",""+n)})},enableEntry:function(e,t){this._getMenuEntry(e).toggleClass("ui-state-disabled",!1===t)},getEntry:function(e){return this._getMenuEntry(e)},getEntryWrapper:function(e){return this._getMenuEntry(e).find(">[role=menuitem]").addBack("[role=menuitem]")},getMenu:function(){return this.$menu},isOpen:function(){return!!this.$menu&&!!this.currentTarget},open:function(e,t){t=t||{};var r=e&&e.type&&e.target,n=r?e:{},i=r?e.target:e,i=jQuery.Event("contextmenu",{target:a(i).get(0),pageX:n.pageX,pageY:n.pageY,originalEvent:r?e:void 0,_extraData:t});return this.element.trigger(i)},replaceMenu:function(e){this._createUiMenu(e)},setEntry:function(e,t){var r=this._getMenuEntry(e);if("string"==typeof t)return window.console&&window.console.warn("setEntry(cmd, t) with a plain string title is deprecated since v1.18.Use setTitle(cmd, '"+t+"') instead."),this.setTitle(e,t);r.empty(),t.cmd=t.cmd||e,a.moogle.contextmenu.createEntryMarkup(t,r),a.isArray(t.children)&&(e=a("<ul/>").appendTo(r),a.moogle.contextmenu.createMenuMarkup(t.children,e)),r.removeClass("ui-menu-item"),this.getMenu().menu("refresh")},setIcon:function(e,t){return this.updateEntry(e,{uiIcon:t})},setTitle:function(e,t){return this.updateEntry(e,{title:t})},showEntry:function(e,t){this._getMenuEntry(e).toggle(!1!==t)},updateEntry:function(e,t){var r=this._getMenuEntry(e);void 0!==t.title&&a.moogle.contextmenu.updateTitle(r,""+t.title),void 0!==t.tooltip&&(null===t.tooltip?r.removeAttr("title"):r.attr("title",t.tooltip)),void 0!==t.uiIcon&&((e=this.getEntryWrapper(e)).find("span.ui-icon").not(".ui-menu-icon").remove(),t.uiIcon)&&e.append(a("<span class='ui-icon' />").addClass(t.uiIcon)),void 0!==t.hide?r.toggle(!t.hide):void 0!==t.show&&r.toggle(!!t.show),void 0!==t.data&&r.data(t.data),void 0===t.disabled&&(t.disabled=r.hasClass("ui-state-disabled")),t.setClass?(r.hasClass("ui-menu-item")&&(t.setClass+=" ui-menu-item"),r.removeClass(),r.addClass(t.setClass)):t.addClass&&r.addClass(t.addClass),r.toggleClass("ui-state-disabled",!!t.disabled)}}),a.extend(a.moogle.contextmenu,{createEntryMarkup:function(r,n){var e=null;n.attr("data-command",r.cmd),/[^\-\u2014\u2013\s]/.test(r.title)?(e=i?a("<a/>",{html:""+r.title,href:"#"}).appendTo(n):o?(n.html(""+r.title),n):a("<div/>",{html:""+r.title}).appendTo(n),r.uiIcon&&e.append(a("<span class='ui-icon' />").addClass(r.uiIcon)),a.each(["action","disabled","title","tooltip"],function(e,t){a.isFunction(r[t])&&n.data(t+"Handler",r[t])}),!0===r.disabled&&n.addClass("ui-state-disabled"),r.isHeader&&n.addClass("ui-widget-header"),r.addClass&&n.addClass(r.addClass),a.isPlainObject(r.data)&&n.data(r.data),"string"==typeof r.tooltip&&n.attr("title",r.tooltip)):n.text(r.title)},createMenuMarkup:function(e,t){var r,n,i;for(null==t&&(t=a("<ul class='ui-helper-hidden' />").appendTo("body")),r=0;r<e.length;r++)n=e[r],i=a("<li/>").appendTo(t),a.moogle.contextmenu.createEntryMarkup(n,i),a.isArray(n.children)&&(i=a("<ul/>").appendTo(i),a.moogle.contextmenu.createMenuMarkup(n.children,i));return t},isMenu:function(e){return i?0<e.has(">a[aria-haspopup='true']").length:o?e.is("[aria-haspopup='true']"):0<e.has(">div[aria-haspopup='true']").length},replaceFirstTextNodeChild:function(e,t){var r=e.find(">span.ui-icon,>ul.ui-menu").detach();e.empty().html(t).append(r)},updateTitle:function(e,t){i?a.moogle.contextmenu.replaceFirstTextNodeChild(a("a",e),t):o?a.moogle.contextmenu.replaceFirstTextNodeChild(e,t):a.moogle.contextmenu.replaceFirstTextNodeChild(a("div",e),t)}})}),!function(e){"object"==typeof module&&"object"==typeof module.exports?e(require("jquery"),window,document):e(jQuery,window,document)}(function(c,u,d,l){function t(e,t){this.$chartContainer=c(e),this.opts=t,this.defaultOptions={icons:{theme:"oci",parentNode:"oci-menu",expandToUp:"oci-chevron-up",collapseToDown:"oci-chevron-down",collapseToLeft:"oci-chevron-left",expandToRight:"oci-chevron-right",backToCompact:"oci-corner-top-left",backToLoose:"oci-corner-bottom-right",collapsed:"oci-plus-square",expanded:"oci-minus-square",spinner:"oci-spinner"},nodeTitle:"name",nodeId:"id",toggleSiblingsResp:!1,visibleLevel:999,chartClass:"",exportButton:!1,exportButtonName:"Export",exportFilename:"OrgChart",exportFileextension:"png",draggable:!1,direction:"t2b",pan:!1,zoom:!1,zoominLimit:7,zoomoutLimit:.5}}t.prototype={init:function(e){this.options=c.extend({},this.defaultOptions,this.opts,e);var e=this.$chartContainer,t=(this.$chart&&this.$chart.remove(),this.options.data),r=this.$chart=c("<div>",{data:{options:this.options},class:"orgchart"+(""!==this.options.chartClass?" "+this.options.chartClass:"")+("t2b"!==this.options.direction?" "+this.options.direction:""),click:function(e){c(e.target).closest(".node").length||r.find(".node.focused").removeClass("focused")}}),n=("undefined"!=typeof MutationObserver&&this.triggerInitEvent(),r.append(c('<ul class="nodes"><li class="hierarchy"></li></ul>')).find(".hierarchy"));return t instanceof c?this.buildHierarchy(n,this.buildJsonDS(t.children()),0,this.options):t.relationship?this.buildHierarchy(n,t):this.buildHierarchy(n,this.attachRel(t,"00")),e.append(r),this.options.exportButton&&!c(".oc-export-btn").length&&this.attachExportButton(),this.options.pan&&this.bindPan(),this.options.zoom&&this.bindZoom(),this},handleCompactNodes:function(){this.$chart.find(".node.compact").each((e,t)=>{c(t).addClass(c(t).parents(".compact").length%2==0?"even":"odd")})},triggerInitEvent:function(){var i=this,o=new MutationObserver(function(e){o.disconnect();e:for(var t=0;t<e.length;t++)for(var r=0;r<e[t].addedNodes.length;r++)if(e[t].addedNodes[r].classList.contains("orgchart")){i.handleCompactNodes(),i.options.initCompleted&&"function"==typeof i.options.initCompleted&&i.options.initCompleted(i.$chart);var n=c.Event("init.orgchart");i.$chart.trigger(n);break e}});o.observe(this.$chartContainer[0],{childList:!0})},triggerShowEvent:function(e,t){t=c.Event("show-"+t+".orgchart");e.trigger(t)},triggerHideEvent:function(e,t){t=c.Event("hide-"+t+".orgchart");e.trigger(t)},attachExportButton:function(){var t=this,e=c("<button>",{class:"oc-export-btn",text:this.options.exportButtonName,click:function(e){e.preventDefault(),t.export()}});this.$chartContainer.after(e)},setOptions:function(e,t){return"string"==typeof e&&("pan"===e&&(t?this.bindPan():this.unbindPan()),"zoom"===e)&&(t?this.bindZoom():this.unbindZoom()),"object"==typeof e&&(e.data?this.init(e):(void 0!==e.pan&&(e.pan?this.bindPan():this.unbindPan()),void 0!==e.zoom&&(e.zoom?this.bindZoom():this.unbindZoom()))),this},panStartHandler:function(e){var i=c(e.delegateTarget);if(c(e.target).closest(".node").length||e.touches&&1<e.touches.length)i.data("panning",!1);else{i.css("cursor","move").data("panning",!0);var t,r=0,n=0,o=i.css("transform"),s=("none"!==o&&(t=o.split(","),n=-1===o.indexOf("3d")?(r=parseInt(t[4]),parseInt(t[5])):(r=parseInt(t[12]),parseInt(t[13]))),0),a=0;if(e.targetTouches){if(1===e.targetTouches.length)s=e.targetTouches[0].pageX-r,a=e.targetTouches[0].pageY-n;else if(1<e.targetTouches.length)return}else s=e.pageX-r,a=e.pageY-n;i.on("mousemove touchmove",function(e){if(i.data("panning")){var t=0,r=0;if(e.targetTouches){if(1===e.targetTouches.length)t=e.targetTouches[0].pageX-s,r=e.targetTouches[0].pageY-a;else if(1<e.targetTouches.length)return}else t=e.pageX-s,r=e.pageY-a;var n,e=i.css("transform");"none"===e?-1===e.indexOf("3d")?i.css("transform","matrix(1, 0, 0, 1, "+t+", "+r+")"):i.css("transform","matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, "+t+", "+r+", 0, 1)"):(n=e.split(","),-1===e.indexOf("3d")?(n[4]=" "+t,n[5]=" "+r+")"):(n[12]=" "+t,n[13]=" "+r),i.css("transform",n.join(",")))}})}},panEndHandler:function(e){e.data.chart.data("panning")&&e.data.chart.data("panning",!1).css("cursor","default").off("mousemove")},bindPan:function(){this.$chartContainer.css("overflow","hidden"),this.$chart.on("mousedown touchstart",this.panStartHandler),c(d).on("mouseup touchend",{chart:this.$chart},this.panEndHandler)},unbindPan:function(){this.$chartContainer.css("overflow","auto"),this.$chart.off("mousedown touchstart",this.panStartHandler),c(d).off("mouseup touchend",this.panEndHandler)},zoomWheelHandler:function(e){var t=e.data.oc,e=(e.preventDefault(),1+(0<e.originalEvent.deltaY?-.2:.2));t.setChartScale(t.$chart,e)},zoomStartHandler:function(e){var t;e.touches&&2===e.touches.length&&((t=e.data.oc).$chart.data("pinching",!0),e=t.getPinchDist(e),t.$chart.data("pinchDistStart",e))},zoomingHandler:function(e){var t=e.data.oc;t.$chart.data("pinching")&&(e=t.getPinchDist(e),t.$chart.data("pinchDistEnd",e))},zoomEndHandler:function(e){var t,e=e.data.oc;e.$chart.data("pinching")&&(e.$chart.data("pinching",!1),0<(t=e.$chart.data("pinchDistEnd")-e.$chart.data("pinchDistStart"))?e.setChartScale(e.$chart,1.2):t<0&&e.setChartScale(e.$chart,.8))},bindZoom:function(){this.$chartContainer.on("wheel",{oc:this},this.zoomWheelHandler),this.$chartContainer.on("touchstart",{oc:this},this.zoomStartHandler),c(d).on("touchmove",{oc:this},this.zoomingHandler),c(d).on("touchend",{oc:this},this.zoomEndHandler)},unbindZoom:function(){this.$chartContainer.off("wheel",this.zoomWheelHandler),this.$chartContainer.off("touchstart",this.zoomStartHandler),c(d).off("touchmove",this.zoomingHandler),c(d).off("touchend",this.zoomEndHandler)},getPinchDist:function(e){return Math.sqrt((e.touches[0].clientX-e.touches[1].clientX)*(e.touches[0].clientX-e.touches[1].clientX)+(e.touches[0].clientY-e.touches[1].clientY)*(e.touches[0].clientY-e.touches[1].clientY))},setChartScale:function(e,t){var r,n=e.data("options"),i=e.css("transform"),o=1;"none"===i?e.css("transform","scale("+t+","+t+")"):(r=i.split(","),-1===i.indexOf("3d")?(o=Math.abs(u.parseFloat(r[3])*t))>n.zoomoutLimit&&o<n.zoominLimit&&e.css("transform",i+" scale("+t+","+t+")"):(o=Math.abs(u.parseFloat(r[1])*t))>n.zoomoutLimit&&o<n.zoominLimit&&e.css("transform",i+" scale3d("+t+","+t+", 1)"))},buildJsonDS:function(e){var t=this,r={name:e.contents().eq(0).text().trim(),relationship:(e.parent().parent().is("li")?"1":"0")+(e.siblings("li").length?1:0)+(e.children("ul").length?1:0)};return c.each(e.data(),function(e,t){r[e]=t}),e.children("ul").children().each(function(){r.children||(r.children=[]),r.children.push(t.buildJsonDS(c(this)))}),r},attachRel:function(t,e){var r=this;return t.relationship=e+(t.children&&0<t.children.length?1:0),this.options?.compact?.constructor===Function&&this.options.compact(t)&&(t.compact=!0),t.children&&t.children.forEach(function(e){t.hybrid||t.vertical?e.vertical=!0:t.compact&&e.children?e.compact=!0:t.compact&&!e.children&&(e.associatedCompact=!0),r.attachRel(e,"1"+(1<t.children.length?1:0))}),t},loopChart:function(e,t){t=null!==t&&t!==l&&t;var r=this,e=e.find(".node:first"),n={id:e[0].id};return t&&c.each(e.data("nodeData"),function(e,t){n[e]=t}),e.siblings(".nodes").children().each(function(){n.children||(n.children=[]),n.children.push(r.loopChart(c(this),t))}),n},getHierarchy:function(e){var t;return e=null!==e&&e!==l&&e,void 0===this.$chart?"Error: orgchart does not exist":this.$chart.find(".node").length?(t=!0,this.$chart.find(".node").each(function(){if(!this.id)return t=!1}),t?this.loopChart(this.$chart,e):"Error: All nodes of orghcart to be exported must have data-id attribute!"):"Error: nodes do not exist"},getNodeState:function(e,t){var r={},n=!!e.closest("vertical").length;if("parent"===(t=t||"self")){if(n?(r=e.closest("ul").parents("ul")).length||(r=e.closest(".nodes")).length||(r=e.closest(".vertical").siblings(":first")):r=e.closest(".nodes").siblings(".node"),r.length)return r.is(".hidden")||!r.is(".hidden")&&r.closest(".nodes").is(".hidden")||!r.is(".hidden")&&r.closest(".vertical").is(".hidden")?{exist:!0,visible:!1}:{exist:!0,visible:!0}}else if("children"===t){if((r=n?e.parent().children("ul"):e.siblings(".nodes")).length)return r.is(".hidden")?{exist:!0,visible:!1}:{exist:!0,visible:!0}}else if("siblings"===t){if((r=n?e.closest("ul"):e.parent().siblings()).length&&(!n||1<r.children("li").length))return r.is(".hidden")||r.parent().is(".hidden")||n&&r.closest(".vertical").is(".hidden")?{exist:!0,visible:!1}:{exist:!0,visible:!0}}else if((r=e).length)return r.closest(".nodes").length&&r.closest(".nodes").is(".hidden")||r.closest(".hierarchy").length&&r.closest(".hierarchy").is(".hidden")||r.closest(".vertical").length&&(r.closest(".nodes").is(".hidden")||r.closest(".vertical").is(".hidden"))?{exist:!0,visible:!1}:{exist:!0,visible:!0};return{exist:!1,visible:!1}},getParent:function(e){return this.getRelatedNodes(e,"parent")},getChildren:function(e){return this.getRelatedNodes(e,"children")},getSiblings:function(e){return this.getRelatedNodes(e,"siblings")},getRelatedNodes:function(e,t){return e&&e instanceof c&&e.is(".node")?"parent"===t?e.closest(".nodes").siblings(".node"):"children"===t?e.siblings(".nodes").children(".hierarchy").find(".node:first"):"siblings"===t?e.closest(".hierarchy").siblings().find(".node:first"):c():c()},hideParentEnd:function(e){c(e.target).removeClass("sliding"),e.data.parent.addClass("hidden")},hideParent:function(e){var t=e.closest(".nodes").siblings(".node");t.find(".spinner").length&&e.closest(".orgchart").data("inAjax",!1),this.getNodeState(e,"siblings").visible&&this.hideSiblings(e),e.parent().addClass("isAncestorsCollapsed"),this.getNodeState(t).visible&&t.addClass("sliding slide-down").one("transitionend",{parent:t},this.hideParentEnd),this.getNodeState(t,"parent").visible&&this.hideParent(t)},showParentEnd:function(e){var t=e.data.node;c(e.target).removeClass("sliding"),this.isInAction(t)&&this.switchVerticalArrow(t.children(".topEdge"))},showParent:function(e){var t=e.closest(".nodes").siblings(".node").removeClass("hidden");e.closest(".hierarchy").removeClass("isAncestorsCollapsed"),this.repaint(t[0]),t.addClass("sliding").removeClass("slide-down").one("transitionend",{node:e},this.showParentEnd.bind(this))},stopAjax:function(e){e.find(".spinner").length&&e.closest(".orgchart").data("inAjax",!1)},isVisibleNode:function(e,t){return this.getNodeState(c(t)).visible},isCompactDescendant:function(e,t){return c(t).parent().is(".node.compact")},hideChildrenEnd:function(e){var t=e.data.node;e.data.animatedNodes.removeClass("sliding"),e.data.animatedNodes.closest(".nodes").addClass("hidden"),this.isInAction(t)&&this.switchVerticalArrow(t.children(".bottomEdge"))},hideChildren:function(e){e.closest(".hierarchy").addClass("isChildrenCollapsed");var t=e.siblings(".nodes"),r=(this.stopAjax(t),t.find(".node").filter(this.isVisibleNode.bind(this)).not(this.isCompactDescendant.bind(this)));t.is(".vertical")||r.closest(".hierarchy").addClass("isCollapsedDescendant"),(t.is(".vertical")||t.find(".vertical").length)&&r.find(this.options.icons.expanded).removeClass(this.options.icons.expanded).addClass(this.options.icons.collapsed),this.repaint(r.get(0)),r.addClass("sliding slide-up").eq(0).one("transitionend",{animatedNodes:r,lowerLevel:t,node:e},this.hideChildrenEnd.bind(this))},showChildrenEnd:function(e){var t=e.data.node;e.data.animatedNodes.removeClass("sliding"),this.isInAction(t)&&this.switchVerticalArrow(t.children(".bottomEdge"))},showChildren:function(e){e.closest(".hierarchy").removeClass("isChildrenCollapsed");var t=e.siblings(".nodes"),r=t.is(".vertical"),t=(r?t.removeClass("hidden").find(".node"):t.removeClass("hidden").children(".hierarchy").find(".node:first")).filter(this.isVisibleNode.bind(this));r||(t.filter(":not(:only-child)").closest(".hierarchy").addClass("isChildrenCollapsed"),t.closest(".hierarchy").removeClass("isCollapsedDescendant")),this.repaint(t.get(0)),t.addClass("sliding").removeClass("slide-up").eq(0).one("transitionend",{node:e,animatedNodes:t},this.showChildrenEnd.bind(this))},hideSiblingsEnd:function(e){var t=this,r=e.data.node,n=e.data.nodeContainer,i=e.data.direction,i=i?"left"===i?n.prevAll(":not(.hidden)"):n.nextAll(":not(.hidden)"):n.siblings();e.data.animatedNodes.removeClass("sliding"),i.find(".node:gt(0)").filter(this.isVisibleNode.bind(this)).removeClass("slide-left slide-right").addClass(function(){return t.options.compact?"":"slide-up"}),i.find(".nodes, .vertical").addClass("hidden").end().addClass("hidden"),this.isInAction(r)&&this.switchHorizontalArrow(r)},hideSiblings:function(e,t){var r=e.closest(".hierarchy").addClass("isSiblingsCollapsed"),n=(r.siblings().find(".spinner").length&&e.closest(".orgchart").data("inAjax",!1),t?"left"===t?r.addClass("left-sibs").prevAll(".isSiblingsCollapsed").removeClass("isSiblingsCollapsed left-sibs").end().prevAll().addClass("isCollapsedSibling isChildrenCollapsed").find(".node").filter(this.isVisibleNode.bind(this)).addClass("sliding slide-right"):r.addClass("right-sibs").nextAll(".isSiblingsCollapsed").removeClass("isSiblingsCollapsed right-sibs").end().nextAll().addClass("isCollapsedSibling isChildrenCollapsed").find(".node").filter(this.isVisibleNode.bind(this)).addClass("sliding slide-left"):(r.prevAll().find(".node").filter(this.isVisibleNode.bind(this)).addClass("sliding slide-right"),r.nextAll().find(".node").filter(this.isVisibleNode.bind(this)).addClass("sliding slide-left"),r.siblings().addClass("isCollapsedSibling isChildrenCollapsed")),r.siblings().find(".sliding"));n.eq(0).one("transitionend",{node:e,nodeContainer:r,direction:t,animatedNodes:n},this.hideSiblingsEnd.bind(this))},showSiblingsEnd:function(e){var t=e.data.node;e.data.visibleNodes.removeClass("sliding"),this.isInAction(t)&&(this.switchHorizontalArrow(t),t.children(".topEdge").removeClass(this.options.icons.expandToUp).addClass(this.options.icons.collapseToDown))},showRelatedParentEnd:function(e){c(e.target).removeClass("sliding")},showSiblings:function(e,t){var r=c(),n=e.closest(".hierarchy"),r=(t?"left"===t?n.prevAll():n.nextAll():e.closest(".hierarchy").siblings()).removeClass("hidden"),i=e.closest(".nodes").siblings(".node"),n=(t?(n.removeClass(t+"-sibs"),n.is("[class*=-sibs]")||n.removeClass("isSiblingsCollapsed"),r.removeClass("isCollapsedSibling "+t+"-sibs")):(e.closest(".hierarchy").removeClass("isSiblingsCollapsed"),r.removeClass("isCollapsedSibling")),this.getNodeState(e,"parent").visible||(e.closest(".hierarchy").removeClass("isAncestorsCollapsed"),i.removeClass("hidden"),this.repaint(i[0]),i.addClass("sliding").removeClass("slide-down").one("transitionend",this.showRelatedParentEnd)),r.find(".node").filter(this.isVisibleNode.bind(this)));this.repaint(n.get(0)),n.addClass("sliding").removeClass("slide-left slide-right"),n.eq(0).one("transitionend",{node:e,visibleNodes:n},this.showSiblingsEnd.bind(this))},startLoading:function(e){var t=this.$chart;return(void 0===t.data("inAjax")||!0!==t.data("inAjax"))&&(e.addClass("hidden"),e.parent().append(`<i class="${this.options.icons.theme} ${this.options.icons.spinner} spinner"></i>`).children().not(".spinner").css("opacity",.2),t.data("inAjax",!0),c(".oc-export-btn").prop("disabled",!0),!0)},endLoading:function(e){var t=e.parent();e.removeClass("hidden"),t.find(".spinner").remove(),t.children().removeAttr("style"),this.$chart.data("inAjax",!1),c(".oc-export-btn").prop("disabled",!1)},isInAction:function(t){return[this.options.icons.expandToUp,this.options.icons.collapseToDown,this.options.icons.collapseToLeft,this.options.icons.expandToRight].some(e=>-1<t.children(".edge").attr("class").indexOf(e))},switchVerticalArrow:function(e){e.toggleClass(this.options.icons.expandToUp+" "+this.options.icons.collapseToDown)},switchHorizontalArrow:function(e){var t,r=this.options;r.toggleSiblingsResp&&(void 0===r.ajaxURL||e.closest(".nodes").data("siblingsLoaded"))?((t=e.parent().prev()).length&&(t.is(".hidden")?e.children(".leftEdge").addClass(r.icons.collapseToLeft).removeClass(r.icons.expandToRight):e.children(".leftEdge").addClass(r.icons.expandToRight).removeClass(r.icons.collapseToLeft)),(t=e.parent().next()).length&&(t.is(".hidden")?e.children(".rightEdge").addClass(r.icons.expandToRight).removeClass(r.icons.collapseToLeft):e.children(".rightEdge").addClass(r.icons.collapseToLeft).removeClass(r.icons.expandToRight))):(t=!!(t=e.parent().siblings()).length&&!t.is(".hidden"),e.children(".leftEdge").toggleClass(r.icons.expandToRight,t).toggleClass(r.icons.collapseToLeft,!t),e.children(".rightEdge").toggleClass(r.icons.collapseToLeft,t).toggleClass(r.icons.expandToRight,!t))},repaint:function(e){e&&(e.style.offsetWidth=e.offsetWidth)},nodeEnterLeaveHandler:function(e){var t,r,n,i=c(e.delegateTarget),o=!1;i.closest(".nodes.vertical").length?(t=i.children(".toggleBtn"),"mouseenter"===e.type?i.children(".toggleBtn").length&&(o=this.getNodeState(i,"children").visible,t.toggleClass(this.options.icons.collapsed,!o).toggleClass(this.options.icons.expanded,o)):t.removeClass(this.options.icons.collapsed+" "+this.options.icons.expanded)):(t=i.children(".topEdge"),i.children(".rightEdge"),r=i.children(".bottomEdge"),n=i.children(".leftEdge"),"mouseenter"===e.type?(t.length&&(o=this.getNodeState(i,"parent").visible,t.toggleClass(this.options.icons.expandToUp,!o).toggleClass(this.options.icons.collapseToDown,o)),r.length&&(o=this.getNodeState(i,"children").visible,r.toggleClass(this.options.icons.collapseToDown,!o).toggleClass(this.options.icons.expandToUp,o)),n.length&&this.switchHorizontalArrow(i)):i.children(".edge").removeClass(`${this.options.icons.expandToUp} ${this.options.icons.collapseToDown} ${this.options.icons.collapseToLeft} `+this.options.icons.expandToRight))},nodeClickHandler:function(e){this.$chart.find(".focused").removeClass("focused"),c(e.delegateTarget).addClass("focused")},addAncestors:function(e,t){var r=this.$chart.children(".nodes").children(".hierarchy");this.buildHierarchy(r,e),r.children().slice(0,2).wrapAll('<li class="hierarchy"></li>').parent().appendTo(c("#"+t).siblings(".nodes"))},addDescendants:function(e,t){var r=this,n=c('<ul class="nodes"></ul>');t.after(n),c.each(e,function(e){n.append(c('<li class="hierarchy"></li>')),r.buildHierarchy(n.children().eq(e),this)})},HideFirstParentEnd:function(e){var e=e.data.topEdge,t=e.parent();this.isInAction(t)&&(this.switchVerticalArrow(e),this.switchHorizontalArrow(t))},topEdgeClickHandler:function(e){var t,r=c(e.target),e=c(e.delegateTarget),n=this.getNodeState(e,"parent");n.exist&&!(t=e.closest(".nodes").siblings(".node")).is(".sliding")&&(n.visible?(this.hideParent(e),t.one("transitionend",{topEdge:r},this.HideFirstParentEnd.bind(this)),this.triggerHideEvent(e,"parent")):(this.showParent(e),this.triggerShowEvent(e,"parent")))},bottomEdgeClickHandler:function(e){c(e.target);var e=c(e.delegateTarget),t=this.getNodeState(e,"children");t.exist&&!e.siblings(".nodes").children().children(".node").is(".sliding")&&(t.visible?(this.hideChildren(e),this.triggerHideEvent(e,"children")):(this.showChildren(e),this.triggerShowEvent(e,"children")))},hEdgeClickHandler:function(e){var t,r=c(e.target),e=c(e.delegateTarget),n=this.options,i=this.getNodeState(e,"siblings");i.exist&&!e.closest(".hierarchy").siblings().find(".sliding").length&&(n.toggleSiblingsResp?(n=e.closest(".hierarchy").prev(),t=e.closest(".hierarchy").next(),r.is(".leftEdge")?n.is(".hidden")?(this.showSiblings(e,"left"),this.triggerShowEvent(e,"siblings")):(this.hideSiblings(e,"left"),this.triggerHideEvent(e,"siblings")):t.is(".hidden")?(this.showSiblings(e,"right"),this.triggerShowEvent(e,"siblings")):(this.hideSiblings(e,"right"),this.triggerHideEvent(e,"siblings"))):i.visible?(this.hideSiblings(e),this.triggerHideEvent(e,"siblings")):(this.showSiblings(e),this.triggerShowEvent(e,"siblings")))},backToCompactHandler:function(e){c(e.delegateTarget).removeClass("looseMode").find(".looseMode").removeClass("looseMode").children(".backToCompactSymbol").addClass("hidden").end().children(".backToLooseSymbol").removeClass("hidden"),c(e.delegateTarget).children(".backToCompactSymbol").addClass("hidden").end().children(".backToLooseSymbol").removeClass("hidden")},backToLooseHandler:function(e){c(e.delegateTarget).addClass("looseMode").children(".backToLooseSymbol").addClass("hidden").end().children(".backToCompactSymbol").removeClass("hidden")},expandVNodesEnd:function(e){e.data.vNodes.removeClass("sliding")},collapseVNodesEnd:function(e){e.data.vNodes.removeClass("sliding").closest("ul").addClass("hidden")},toggleVNodes:function(e){var e=c(e.target),t=e.parent().next(),r=t.find(".node"),n=t.children().children(".node");n.is(".sliding")||(e.toggleClass(this.options.icons.collapsed+" "+this.options.icons.expanded),r.eq(0).is(".slide-up")?(t.removeClass("hidden"),this.repaint(n.get(0)),n.addClass("sliding").removeClass("slide-up").eq(0).one("transitionend",{vNodes:n},this.expandVNodesEnd)):(r.addClass("sliding slide-up").eq(0).one("transitionend",{vNodes:r},this.collapseVNodesEnd),r.find(".toggleBtn").removeClass(this.options.icons.collapsed+" "+this.options.icons.expanded)))},createGhostNode:function(e){var t,r,n=c(e.target),i=this.options,e=e.originalEvent,o=/firefox/.test(u.navigator.userAgent.toLowerCase());if(d.querySelector(".ghost-node"))t=n.closest(".orgchart").children(".ghost-node").get(0),r=c(t).children().get(0);else{if(!(t=d.createElementNS("http://www.w3.org/2000/svg","svg")).classList)return;t.classList.add("ghost-node"),r=d.createElementNS("http://www.w3.org/2000/svg","rect"),t.appendChild(r),n.closest(".orgchart").append(t)}var s=n.closest(".orgchart").css("transform").split(","),a="t2b"===i.direction||"b2t"===i.direction,s=Math.abs(u.parseFloat(a?s[0].slice(s[0].indexOf("(")+1):s[1])),a=(t.setAttribute("width",a?n.outerWidth(!1):n.outerHeight(!1)),t.setAttribute("height",a?n.outerHeight(!1):n.outerWidth(!1)),r.setAttribute("x",5*s),r.setAttribute("y",5*s),r.setAttribute("width",120*s),r.setAttribute("height",40*s),r.setAttribute("rx",4*s),r.setAttribute("ry",4*s),r.setAttribute("stroke-width",+s),e.offsetX*s),l=e.offsetY*s;"l2r"===i.direction?(a=e.offsetY*s,l=e.offsetX*s):"r2l"===i.direction?(a=n.outerWidth(!1)-e.offsetY*s,l=e.offsetX*s):"b2t"===i.direction&&(a=n.outerWidth(!1)-e.offsetX*s,l=n.outerHeight(!1)-e.offsetY*s),o?(r.setAttribute("fill","rgb(255, 255, 255)"),r.setAttribute("stroke","rgb(191, 0, 0)"),(i=d.createElement("img")).src="data:image/svg+xml;utf8,"+(new XMLSerializer).serializeToString(t),e.dataTransfer.setDragImage(i,a,l)):e.dataTransfer.setDragImage&&e.dataTransfer.setDragImage(t,a,l)},getUpperLevel:function(e){return e.is(".node")?e.parents(".hierarchy").length:0},getLowerLevel:function(e){return e.is(".node")?e.closest(".hierarchy").find(".nodes").length+1:0},getLevelOrderNodes:function(e){if(!e)return[];var t=[],r=[];for(t.push(e);t.length;){for(var n=[],i=0;i<t.length;i++){var o=t.shift(),s=this.getChildren(o);s.length&&t.push(s.toArray().flat()),n.push(c(o))}r.push(n)}return r},filterAllowedDropNodes:function(r){var n=this.options,i=r.closest("[draggable]").hasClass("node"),o=r.closest(".nodes").siblings(".node"),s=r.closest(".hierarchy").find(".node");this.$chart.data("dragged",r).find(".node").each(function(e,t){i&&-1!==s.index(t)||n.dropCriteria&&!n.dropCriteria(r,o,c(t))||c(t).addClass("allowedDrop")})},dragstartHandler:function(e){e.originalEvent.dataTransfer.setData("text/html","hack for firefox"),"none"!==this.$chart.css("transform")&&this.createGhostNode(e),this.filterAllowedDropNodes(c(e.target))},dragoverHandler:function(e){c(e.delegateTarget).is(".allowedDrop")?e.preventDefault():e.originalEvent.dataTransfer.dropEffect="none"},dragendHandler:function(e){this.$chart.find(".allowedDrop").removeClass("allowedDrop")},dropHandler:async function(e){var t,r,n,i,o,e=c(e.delegateTarget),s=this.$chart.data("dragged");s.hasClass("node")?e.hasClass("allowedDrop")&&(t=s.closest(".nodes").siblings(".node"),r=c.Event("nodedrop.orgchart"),this.$chart.trigger(r,{draggedNode:s,dragZone:t,dropZone:e}),r.isDefaultPrevented()||(r=this.$chart.data("options").data,o=(i=new JSONDigger(r,this.$chart.data("options").nodeId,"children")).findOneNode({hybrid:!0}),1<this.$chart.data("options").verticalLevel||o?(o=i.findNodeById(s.data("nodeData").id),n=Object.assign({},o),i.removeNode(o.id),(o=i.findNodeById(e.data("nodeData").id)).children?o.children.push(n):o.children=[n],this.init({data:r})):(e.siblings(".nodes").length?(i=`<i class="edge horizontalEdge rightEdge ${this.options.icons.theme}"></i><i class="edge horizontalEdge leftEdge ${this.options.icons.theme}"></i>`,s.find(".horizontalEdge").length||s.append(i),e.siblings(".nodes").append(s.closest(".hierarchy")),1===(o=s.closest(".hierarchy").siblings().find(".node:first")).length&&o.append(i)):(e.append(`<i class="edge verticalEdge bottomEdge ${this.options.icons.theme}"></i>`).after('<ul class="nodes"></ul>').siblings(".nodes").append(s.find(".horizontalEdge").remove().end().closest(".hierarchy")),e.children(".title").length&&e.children(".title").prepend(`<i class="${this.options.icons.theme} ${this.$chart.data("options").icons.parentNode} parentNodeSymbol"></i>`)),1===t.siblings(".nodes").children(".hierarchy").length?t.siblings(".nodes").children(".hierarchy").find(".node:first").find(".horizontalEdge").remove():0===t.siblings(".nodes").children(".hierarchy").length&&t.find(".bottomEdge, .parentNodeSymbol").remove().end().siblings(".nodes").remove()))):this.$chart.triggerHandler({type:"otherdropped.orgchart",draggedItem:s,dropZone:e})},touchstartHandler:function(e){this.touchHandled||e.touches&&1<e.touches.length||(this.touchHandled=!0,this.touchMoved=!1,e.preventDefault())},touchmoveHandler:function(e){var t;!this.touchHandled||e.touches&&1<e.touches.length||(e.preventDefault(),this.touchMoved||(this.filterAllowedDropNodes(c(e.currentTarget)),this.touchDragImage=this.createDragImage(e,this.$chart.data("dragged")[0])),this.touchMoved=!0,this.moveDragImage(e,this.touchDragImage),0<(e=c(d.elementFromPoint(e.touches[0].clientX,e.touches[0].clientY)).closest("div.node")).length&&(t=e[0],e.is(".allowedDrop"))?this.touchTargetNode=t:this.touchTargetNode=null)},touchendHandler:function(e){var t,r;this.touchHandled&&(this.destroyDragImage(),this.touchMoved?(this.touchTargetNode&&(t={delegateTarget:this.touchTargetNode},this.dropHandler(t),this.touchTargetNode=null),this.dragendHandler(e)):(t=e.changedTouches[0],(r=d.createEvent("MouseEvents")).initMouseEvent("click",!0,!0,u,1,t.screenX,t.screenY,t.clientX,t.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,0,null),e.target.dispatchEvent(r)),this.touchHandled=!1)},createDragImage:function(e,t){var r=t.cloneNode(!0),t=(this.copyStyle(t,r),r.style.top=r.style.left="-9999px",t.getBoundingClientRect()),e=this.getTouchPoint(e);return this.touchDragImageOffset={x:e.x-t.left,y:e.y-t.top},r.style.opacity="0.5",d.body.appendChild(r),r},destroyDragImage:function(){this.touchDragImage&&this.touchDragImage.parentElement&&this.touchDragImage.parentElement.removeChild(this.touchDragImage),this.touchDragImageOffset=null,this.touchDragImage=null},copyStyle:function(e,t){["id","class","style","draggable"].forEach(function(e){t.removeAttribute(e)}),e instanceof HTMLCanvasElement&&((n=t).width=(r=e).width,n.height=r.height,n.getContext("2d").drawImage(r,0,0));for(var r,n,i=getComputedStyle(e),o=0;o<i.length;o++){var s=i[o];s.indexOf("transition")<0&&(t.style[s]=i[s])}t.style.pointerEvents="none";for(o=0;o<e.children.length;o++)this.copyStyle(e.children[o],t.children[o])},getTouchPoint:function(e){return{x:(e=e&&e.touches?e.touches[0]:e).clientX,y:e.clientY}},moveDragImage:function(r,n){var i;r&&n&&(i=this,requestAnimationFrame(function(){var e=i.getTouchPoint(r),t=n.style;t.position="absolute",t.pointerEvents="none",t.zIndex="999999",i.touchDragImageOffset&&(t.left=Math.round(e.x-i.touchDragImageOffset.x)+"px",t.top=Math.round(e.y-i.touchDragImageOffset.y)+"px")}))},bindDragDrop:function(e){e.on("dragstart",this.dragstartHandler.bind(this)).on("dragover",this.dragoverHandler.bind(this)).on("dragend",this.dragendHandler.bind(this)).on("drop",this.dropHandler.bind(this)).on("touchstart",this.touchstartHandler.bind(this)).on("touchmove",this.touchmoveHandler.bind(this)).on("touchend",this.touchendHandler.bind(this))},createNode:function(r){var n=this.options,e=r.level,t=(r.children&&r[n.nodeId]&&c.each(r.children,function(e,t){t.parentId=r[n.nodeId]}),c("<div"+(n.draggable?' draggable="true"':"")+(r[n.nodeId]?' id="'+r[n.nodeId]+'"':"")+(r.parentId?' data-parent="'+r.parentId+'"':"")+">").addClass("node "+(r.className||"")+(e>n.visibleLevel?" slide-up":""))),i=(n.nodeTemplate?t.append(n.nodeTemplate(r)):t.append('<div class="title">'+r[n.nodeTitle]+"</div>").append(void 0!==n.nodeContent?'<div class="content">'+(r[n.nodeContent]||"")+"</div>":""),c.extend({},r)),i=(delete i.children,t.data("nodeData",i),r.relationship||"");return n.verticalLevel&&e>=n.verticalLevel||r.vertical?Number(i.substr(2,1))&&t.append(`<i class="toggleBtn ${n.icons.theme}"></i>`).children(".title").prepend(`<i class="${n.icons.theme} ${n.icons.parentNode} parentNodeSymbol"></i>`):r.hybrid?Number(i.substr(2,1))&&t.append(`<i class="edge verticalEdge bottomEdge ${n.icons.theme}"></i>`).children(".title").prepend(`<i class="${n.icons.theme} ${n.icons.parentNode} parentNodeSymbol"></i>`):r.compact?(t.css("grid-template-columns",`repeat(${Math.floor(Math.sqrt(r.children.length+1))}, auto)`),Number(i.substr(2,1))&&t.append(`
            <i class="${n.icons.theme} ${n.icons.backToCompact} backToCompactSymbol hidden"></i>
            <i class="${n.icons.theme} ${n.icons.backToLoose} backToLooseSymbol"></i>
            `).children(".title").prepend(`<i class="${n.icons.theme} ${n.icons.parentNode} parentNodeSymbol"></i>`)):r.associatedCompact||(Number(i.substr(0,1))&&t.append(`<i class="edge verticalEdge topEdge ${n.icons.theme}"></i>`),Number(i.substr(1,1))&&t.append(`<i class="edge horizontalEdge rightEdge ${n.icons.theme}"></i><i class="edge horizontalEdge leftEdge ${n.icons.theme}"></i>`),Number(i.substr(2,1))&&t.append(`<i class="edge verticalEdge bottomEdge ${n.icons.theme}"></i>`).children(".title").prepend(`<i class="${n.icons.theme} ${n.icons.parentNode} parentNodeSymbol"></i>`)),t.on("mouseenter mouseleave",this.nodeEnterLeaveHandler.bind(this)),t.on("click",this.nodeClickHandler.bind(this)),t.on("click",".topEdge",this.topEdgeClickHandler.bind(this)),t.on("click",".bottomEdge",this.bottomEdgeClickHandler.bind(this)),t.on("click",".leftEdge, .rightEdge",this.hEdgeClickHandler.bind(this)),t.on("click",".toggleBtn",this.toggleVNodes.bind(this)),t.on("click","> .backToCompactSymbol",this.backToCompactHandler.bind(this)),t.on("click","> .backToLooseSymbol",this.backToLooseHandler.bind(this)),n.draggable&&(this.bindDragDrop(t),this.touchHandled=!1,this.touchMoved=!1,this.touchTargetNode=null),n.createNode&&n.createNode(t,r),t},buildHierarchy:function(e,t){var r,n,i,o=this,s=this.options,a=0,a=t.level||(t.level=e.parentsUntil(".orgchart",".nodes").length);2<Object.keys(t).length&&(r=this.createNode(t),e.append(r)),t.children&&t.children.length&&(n=a+1>s.visibleLevel||t.collapsed!==l&&t.collapsed,s.verticalLevel&&a+1>=s.verticalLevel||t.hybrid?(i=c('<ul class="nodes">'),n&&s.verticalLevel&&a+1>=s.verticalLevel&&i.addClass("hidden"),(s.verticalLevel&&a+1===s.verticalLevel||t.hybrid)&&!e.closest(".vertical").length?e.append(i.addClass("vertical")):e.append(i)):t.compact?r.addClass("compact"):(i=c('<ul class="nodes'+(n?" hidden":"")+'">'),2!==Object.keys(t).length&&n&&e.addClass("isChildrenCollapsed"),e.append(i)),c.each(t.children,function(){var e;this.level=a+1,t.compact?o.buildHierarchy(r,this):(e=c('<li class="hierarchy">'),i.append(e),o.buildHierarchy(e,this))}))},buildChildNode:function(e,t){this.buildHierarchy(e,{children:t})},addChildren:function(e,t){this.buildChildNode(e.closest(".hierarchy"),t),e.find(".parentNodeSymbol").length||e.children(".title").prepend(`<i class="${this.options.icons.theme} ${this.options.icons.parentNode} parentNodeSymbol"></i>`),e.closest(".nodes.vertical").length?e.children(".toggleBtn").length||e.append(`<i class="toggleBtn ${this.options.icons.theme}"></i>`):e.children(".bottomEdge").length||e.append(`<i class="edge verticalEdge bottomEdge ${this.options.icons.theme}"></i>`),this.isInAction(e)&&this.switchVerticalArrow(e.children(".bottomEdge"))},buildParentNode:function(e,t){t.relationship=t.relationship||"001";t=c('<ul class="nodes"><li class="hierarchy"></li></ul>').find(".hierarchy").append(this.createNode(t)).end();this.$chart.prepend(t).find(".hierarchy:first").append(e.closest("ul").addClass("nodes"))},addParent:function(e,t){this.buildParentNode(e,t),e.children(".topEdge").length||e.children(".title").after(`<i class="edge verticalEdge topEdge ${this.options.icons.theme}"></i>`),this.isInAction(e)&&this.switchVerticalArrow(e.children(".topEdge"))},buildSiblingNode:function(e,t){var r,n=(c.isArray(t)?t:t.children).length,i=e.parent().is(".nodes")?e.siblings().length+1:1,n=i+n,n=1<n?Math.floor(n/2-1):0;e.closest(".nodes").parent().is(".hierarchy")?(this.buildChildNode(e.parent().closest(".hierarchy"),t),r=e.parent().closest(".hierarchy").children(".nodes:last").children(".hierarchy"),1<i?r.eq(0).before(e.siblings().addBack().unwrap()):r.eq(n).after(e.unwrap())):(this.buildHierarchy(e.parent().prepend(c('<li class="hierarchy">')).children(".hierarchy:first"),t),e.prevAll(".hierarchy").children(".nodes").children().eq(n).after(e))},addSiblings:function(e,t){this.buildSiblingNode(e.closest(".hierarchy"),t),e.closest(".nodes").data("siblingsLoaded",!0),e.children(".leftEdge").length||e.children(".topEdge").after(`<i class="edge horizontalEdge rightEdge ${this.options.icons.theme}"></i><i class="edge horizontalEdge leftEdge ${this.options.icons.theme}"></i>`),this.isInAction(e)&&(this.switchHorizontalArrow(e),e.children(".topEdge").removeClass(this.options.icons.expandToUp).addClass(this.options.icons.collapseToDown))},removeNodes:function(e){var t=e.closest(".hierarchy").parent();t.parent().is(".hierarchy")?this.getNodeState(e,"siblings").exist?(e.closest(".hierarchy").remove(),1===t.children().length&&t.find(".node:first .horizontalEdge").remove()):t.siblings(".node").find(".bottomEdge").remove().end().end().remove():t.closest(".orgchart").remove()},hideDropZones:function(){this.$chart.find(".allowedDrop").removeClass("allowedDrop")},showDropZones:function(e){this.$chart.find(".node").each(function(e,t){c(t).addClass("allowedDrop")}),this.$chart.data("dragged",c(e))},processExternalDrop:function(e,t){t&&this.$chart.data("dragged",c(t)),e.closest(".node").triggerHandler({type:"drop"})},exportPDF:function(e,t){var r={},n=Math.floor(e.width),i=Math.floor(e.height);u.jsPDF||(u.jsPDF=u.jspdf.jsPDF),(r=i<n?new jsPDF({orientation:"landscape",unit:"px",format:[n,i]}):new jsPDF({orientation:"portrait",unit:"px",format:[i,n]})).addImage(e.toDataURL(),"png",0,0),r.save(t+".pdf")},exportPNG:function(e,t){var r="WebkitAppearance"in d.documentElement.style,n=!!u.sidebar,i="Microsoft Internet Explorer"===navigator.appName||"Netscape"===navigator.appName&&-1<navigator.appVersion.indexOf("Edge"),o=this.$chartContainer;!r&&!n||i?u.navigator.msSaveBlob(e.msToBlob(),t+".png"):(r=".download-btn"+(""!==this.options.chartClass?"."+this.options.chartClass:""),o.find(r).length||o.append('<a class="download-btn'+(""!==this.options.chartClass?" "+this.options.chartClass:"")+'" download="'+t+'.png"></a>'),o.find(r).attr("href",e.toDataURL())[0].click())},export:function(t,r){var n=this;if(t=void 0!==t?t:this.options.exportFilename,r=void 0!==r?r:this.options.exportFileextension,c(this).children(".spinner").length)return!1;var i=this.$chartContainer,e=i.find(".mask"),e=(e.length?e.removeClass("hidden"):i.append(`<div class="mask"><i class="${this.options.icons.theme} ${this.options.icons.spinner} spinner"></i></div>`),i.addClass("canvasContainer").find('.orgchart:not(".hidden")').get(0)),o="l2r"===n.options.direction||"r2l"===n.options.direction;html2canvas(e,{width:o?e.clientHeight:e.clientWidth,height:o?e.clientWidth:e.clientHeight,onclone:function(e){c(e).find(".canvasContainer").css("overflow","visible").find('.orgchart:not(".hidden"):first').css("transform","")}}).then(function(e){i.find(".mask").addClass("hidden"),"pdf"===r.toLowerCase()?n.exportPDF(e,t):n.exportPNG(e,t),i.removeClass("canvasContainer")},function(){i.removeClass("canvasContainer")})}},c.fn.orgchart=function(e){return new t(this,e).init()}}),!function(E){E.ui=E.ui||{};E.ui.version="1.13.2";var i,n,T,S,o,s,a,l,c,r,u=0,d=Array.prototype.hasOwnProperty,h=Array.prototype.slice;E.cleanData=(i=E.cleanData,function(e){for(var t,r,n=0;null!=(r=e[n]);n++)(t=E._data(r,"events"))&&t.remove&&E(r).triggerHandler("remove");i(e)}),E.widget=function(e,r,t){var n,i,o,s={},a=e.split(".")[0],l=a+"-"+(e=e.split(".")[1]);return t||(t=r,r=E.Widget),Array.isArray(t)&&(t=E.extend.apply(null,[{}].concat(t))),E.expr.pseudos[l.toLowerCase()]=function(e){return!!E.data(e,l)},E[a]=E[a]||{},n=E[a][e],i=E[a][e]=function(e,t){if(!this||!this._createWidget)return new i(e,t);arguments.length&&this._createWidget(e,t)},E.extend(i,n,{version:t.version,_proto:E.extend({},t),_childConstructors:[]}),(o=new r).options=E.widget.extend({},o.options),E.each(t,function(t,n){function i(){return r.prototype[t].apply(this,arguments)}function o(e){return r.prototype[t].apply(this,e)}s[t]="function"!=typeof n?n:function(){var e,t=this._super,r=this._superApply;return this._super=i,this._superApply=o,e=n.apply(this,arguments),this._super=t,this._superApply=r,e}}),i.prototype=E.widget.extend(o,{widgetEventPrefix:n&&o.widgetEventPrefix||e},s,{constructor:i,namespace:a,widgetName:e,widgetFullName:l}),n?(E.each(n._childConstructors,function(e,t){var r=t.prototype;E.widget(r.namespace+"."+r.widgetName,i,t._proto)}),delete n._childConstructors):r._childConstructors.push(i),E.widget.bridge(e,i),i},E.widget.extend=function(e){for(var t,r,n=h.call(arguments,1),i=0,o=n.length;i<o;i++)for(t in n[i])r=n[i][t],d.call(n[i],t)&&void 0!==r&&(E.isPlainObject(r)?e[t]=E.isPlainObject(e[t])?E.widget.extend({},e[t],r):E.widget.extend({},r):e[t]=r);return e},E.widget.bridge=function(o,t){var s=t.prototype.widgetFullName||o;E.fn[o]=function(r){var e="string"==typeof r,n=h.call(arguments,1),i=this;return e?this.length||"instance"!==r?this.each(function(){var e,t=E.data(this,s);return"instance"===r?(i=t,!1):t?"function"!=typeof t[r]||"_"===r.charAt(0)?E.error("no such method '"+r+"' for "+o+" widget instance"):(e=t[r].apply(t,n))!==t&&void 0!==e?(i=e&&e.jquery?i.pushStack(e.get()):e,!1):void 0:E.error("cannot call methods on "+o+" prior to initialization; attempted to call method '"+r+"'")}):i=void 0:(n.length&&(r=E.widget.extend.apply(null,[r].concat(n))),this.each(function(){var e=E.data(this,s);e?(e.option(r||{}),e._init&&e._init()):E.data(this,s,new t(r,this))})),i}},E.Widget=function(){},E.Widget._childConstructors=[],E.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},_createWidget:function(e,t){t=E(t||this.defaultElement||this)[0],this.element=E(t),this.uuid=u++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=E(),this.hoverable=E(),this.focusable=E(),this.classesElementLookup={},t!==this&&(E.data(t,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===t&&this.destroy()}}),this.document=E(t.style?t.ownerDocument:t.document||t),this.window=E(this.document[0].defaultView||this.document[0].parentWindow)),this.options=E.widget.extend({},this.options,this._getCreateOptions(),e),this._create(),this.options.disabled&&this._setOptionDisabled(this.options.disabled),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:E.noop,_create:E.noop,_init:E.noop,destroy:function(){var r=this;this._destroy(),E.each(this.classesElementLookup,function(e,t){r._removeClass(t,e)}),this.element.off(this.eventNamespace).removeData(this.widgetFullName),this.widget().off(this.eventNamespace).removeAttr("aria-disabled"),this.bindings.off(this.eventNamespace)},_destroy:E.noop,widget:function(){return this.element},option:function(e,t){var r,n,i,o=e;if(0===arguments.length)return E.widget.extend({},this.options);if("string"==typeof e)if(o={},e=(r=e.split(".")).shift(),r.length){for(n=o[e]=E.widget.extend({},this.options[e]),i=0;i<r.length-1;i++)n[r[i]]=n[r[i]]||{},n=n[r[i]];if(e=r.pop(),1===arguments.length)return void 0===n[e]?null:n[e];n[e]=t}else{if(1===arguments.length)return void 0===this.options[e]?null:this.options[e];o[e]=t}return this._setOptions(o),this},_setOptions:function(e){for(var t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return"classes"===e&&this._setOptionClasses(t),this.options[e]=t,"disabled"===e&&this._setOptionDisabled(t),this},_setOptionClasses:function(e){var t,r,n;for(t in e)n=this.classesElementLookup[t],e[t]!==this.options.classes[t]&&n&&n.length&&(r=E(n.get()),this._removeClass(n,t),r.addClass(this._classes({element:r,keys:t,classes:e,add:!0})))},_setOptionDisabled:function(e){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!e),e&&(this._removeClass(this.hoverable,null,"ui-state-hover"),this._removeClass(this.focusable,null,"ui-state-focus"))},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_classes:function(i){var o=[],s=this;function e(e,t){for(var r,n=0;n<e.length;n++)r=s.classesElementLookup[e[n]]||E(),r=i.add?(function(){var r=[];i.element.each(function(e,t){E.map(s.classesElementLookup,function(e){return e}).some(function(e){return e.is(t)})||r.push(t)}),s._on(E(r),{remove:"_untrackClassesElement"})}(),E(E.uniqueSort(r.get().concat(i.element.get())))):E(r.not(i.element).get()),s.classesElementLookup[e[n]]=r,o.push(e[n]),t&&i.classes[e[n]]&&o.push(i.classes[e[n]])}return(i=E.extend({element:this.element,classes:this.options.classes||{}},i)).keys&&e(i.keys.match(/\S+/g)||[],!0),i.extra&&e(i.extra.match(/\S+/g)||[]),o.join(" ")},_untrackClassesElement:function(r){var n=this;E.each(n.classesElementLookup,function(e,t){-1!==E.inArray(r.target,t)&&(n.classesElementLookup[e]=E(t.not(r.target).get()))}),this._off(E(r.target))},_removeClass:function(e,t,r){return this._toggleClass(e,t,r,!1)},_addClass:function(e,t,r){return this._toggleClass(e,t,r,!0)},_toggleClass:function(e,t,r,n){var i="string"==typeof e||null===e,t={extra:i?t:r,keys:i?e:t,element:i?this.element:e,add:n="boolean"==typeof n?n:r};return t.element.toggleClass(this._classes(t),n),this},_on:function(i,o,e){var s,a=this;"boolean"!=typeof i&&(e=o,o=i,i=!1),e?(o=s=E(o),this.bindings=this.bindings.add(o)):(e=o,o=this.element,s=this.widget()),E.each(e,function(e,t){function r(){if(i||!0!==a.options.disabled&&!E(this).hasClass("ui-state-disabled"))return("string"==typeof t?a[t]:t).apply(a,arguments)}"string"!=typeof t&&(r.guid=t.guid=t.guid||r.guid||E.guid++);var e=e.match(/^([\w:-]*)\s*(.*)$/),n=e[1]+a.eventNamespace,e=e[2];e?s.on(n,e,r):o.on(n,r)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.off(t),this.bindings=E(this.bindings.not(e).get()),this.focusable=E(this.focusable.not(e).get()),this.hoverable=E(this.hoverable.not(e).get())},_delay:function(e,t){var r=this;return setTimeout(function(){return("string"==typeof e?r[e]:e).apply(r,arguments)},t||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){this._addClass(E(e.currentTarget),null,"ui-state-hover")},mouseleave:function(e){this._removeClass(E(e.currentTarget),null,"ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){this._addClass(E(e.currentTarget),null,"ui-state-focus")},focusout:function(e){this._removeClass(E(e.currentTarget),null,"ui-state-focus")}})},_trigger:function(e,t,r){var n,i,o=this.options[e];if(r=r||{},(t=E.Event(t)).type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),t.target=this.element[0],i=t.originalEvent)for(n in i)n in t||(t[n]=i[n]);return this.element.trigger(t,r),!("function"==typeof o&&!1===o.apply(this.element[0],[t].concat(r))||t.isDefaultPrevented())}},E.each({show:"fadeIn",hide:"fadeOut"},function(o,s){E.Widget.prototype["_"+o]=function(t,e,r){var n,i=(e="string"==typeof e?{effect:e}:e)?!0!==e&&"number"!=typeof e&&e.effect||s:o;"number"==typeof(e=e||{})?e={duration:e}:!0===e&&(e={}),n=!E.isEmptyObject(e),e.complete=r,e.delay&&t.delay(e.delay),n&&E.effects&&E.effects.effect[i]?t[o](e):i!==o&&t[i]?t[i](e.duration,e.easing,r):t.queue(function(e){E(this)[o](),r&&r.call(t[0]),e()})}}),E.widget;function _(e,t,r){return[parseFloat(e[0])*(c.test(e[0])?t/100:1),parseFloat(e[1])*(c.test(e[1])?r/100:1)]}function x(e,t){return parseInt(E.css(e,t),10)||0}function R(e){return null!=e&&e===e.window}T=Math.max,S=Math.abs,o=/left|center|right/,s=/top|center|bottom/,a=/[\+\-]\d+(\.[\d]+)?%?/,l=/^\w+/,c=/%$/,r=E.fn.position,E.position={scrollbarWidth:function(){var e,t,r;return void 0!==n?n:(r=(t=E("<div style='display:block;position:absolute;width:200px;height:200px;overflow:hidden;'><div style='height:300px;width:auto;'></div></div>")).children()[0],E("body").append(t),e=r.offsetWidth,t.css("overflow","scroll"),e===(r=r.offsetWidth)&&(r=t[0].clientWidth),t.remove(),n=e-r)},getScrollInfo:function(e){var t=e.isWindow||e.isDocument?"":e.element.css("overflow-x"),r=e.isWindow||e.isDocument?"":e.element.css("overflow-y"),t="scroll"===t||"auto"===t&&e.width<e.element[0].scrollWidth;return{width:"scroll"===r||"auto"===r&&e.height<e.element[0].scrollHeight?E.position.scrollbarWidth():0,height:t?E.position.scrollbarWidth():0}},getWithinInfo:function(e){var t=E(e||window),r=R(t[0]),n=!!t[0]&&9===t[0].nodeType;return{element:t,isWindow:r,isDocument:n,offset:!r&&!n?E(e).offset():{left:0,top:0},scrollLeft:t.scrollLeft(),scrollTop:t.scrollTop(),width:t.outerWidth(),height:t.outerHeight()}}},E.fn.position=function(d){var h,p,f,g,m,y,v,b,w,C,e,t;return d&&d.of?(y="string"==typeof(d=E.extend({},d)).of?E(document).find(d.of):E(d.of),v=E.position.getWithinInfo(d.within),b=E.position.getScrollInfo(v),w=(d.collision||"flip").split(" "),C={},t=9===(t=(e=y)[0]).nodeType?{width:e.width(),height:e.height(),offset:{top:0,left:0}}:R(t)?{width:e.width(),height:e.height(),offset:{top:e.scrollTop(),left:e.scrollLeft()}}:t.preventDefault?{width:0,height:0,offset:{top:t.pageY,left:t.pageX}}:{width:e.outerWidth(),height:e.outerHeight(),offset:e.offset()},y[0].preventDefault&&(d.at="left top"),p=t.width,f=t.height,m=E.extend({},g=t.offset),E.each(["my","at"],function(){var e,t,r=(d[this]||"").split(" ");(r=1===r.length?o.test(r[0])?r.concat(["center"]):s.test(r[0])?["center"].concat(r):["center","center"]:r)[0]=o.test(r[0])?r[0]:"center",r[1]=s.test(r[1])?r[1]:"center",e=a.exec(r[0]),t=a.exec(r[1]),C[this]=[e?e[0]:0,t?t[0]:0],d[this]=[l.exec(r[0])[0],l.exec(r[1])[0]]}),1===w.length&&(w[1]=w[0]),"right"===d.at[0]?m.left+=p:"center"===d.at[0]&&(m.left+=p/2),"bottom"===d.at[1]?m.top+=f:"center"===d.at[1]&&(m.top+=f/2),h=_(C.at,p,f),m.left+=h[0],m.top+=h[1],this.each(function(){var r,e,s=E(this),a=s.outerWidth(),l=s.outerHeight(),t=x(this,"marginLeft"),n=x(this,"marginTop"),i=a+t+x(this,"marginRight")+b.width,o=l+n+x(this,"marginBottom")+b.height,c=E.extend({},m),u=_(C.my,s.outerWidth(),s.outerHeight());"right"===d.my[0]?c.left-=a:"center"===d.my[0]&&(c.left-=a/2),"bottom"===d.my[1]?c.top-=l:"center"===d.my[1]&&(c.top-=l/2),c.left+=u[0],c.top+=u[1],r={marginLeft:t,marginTop:n},E.each(["left","top"],function(e,t){E.ui.position[w[e]]&&E.ui.position[w[e]][t](c,{targetWidth:p,targetHeight:f,elemWidth:a,elemHeight:l,collisionPosition:r,collisionWidth:i,collisionHeight:o,offset:[h[0]+u[0],h[1]+u[1]],my:d.my,at:d.at,within:v,elem:s})}),d.using&&(e=function(e){var t=g.left-c.left,r=t+p-a,n=g.top-c.top,i=n+f-l,o={target:{element:y,left:g.left,top:g.top,width:p,height:f},element:{element:s,left:c.left,top:c.top,width:a,height:l},horizontal:r<0?"left":0<t?"right":"center",vertical:i<0?"top":0<n?"bottom":"middle"};p<a&&S(t+r)<p&&(o.horizontal="center"),f<l&&S(n+i)<f&&(o.vertical="middle"),T(S(t),S(r))>T(S(n),S(i))?o.important="horizontal":o.important="vertical",d.using.call(this,e,o)}),s.offset(E.extend(c,{using:e}))})):r.apply(this,arguments)},E.ui.position={fit:{left:function(e,t){var r,n=t.within,i=n.isWindow?n.scrollLeft:n.offset.left,n=n.width,o=e.left-t.collisionPosition.marginLeft,s=i-o,a=o+t.collisionWidth-n-i;t.collisionWidth>n?0<s&&a<=0?(r=e.left+s+t.collisionWidth-n-i,e.left+=s-r):e.left=!(0<a&&s<=0)&&a<s?i+n-t.collisionWidth:i:0<s?e.left+=s:0<a?e.left-=a:e.left=T(e.left-o,e.left)},top:function(e,t){var r,n=t.within,n=n.isWindow?n.scrollTop:n.offset.top,i=t.within.height,o=e.top-t.collisionPosition.marginTop,s=n-o,a=o+t.collisionHeight-i-n;t.collisionHeight>i?0<s&&a<=0?(r=e.top+s+t.collisionHeight-i-n,e.top+=s-r):e.top=!(0<a&&s<=0)&&a<s?n+i-t.collisionHeight:n:0<s?e.top+=s:0<a?e.top-=a:e.top=T(e.top-o,e.top)}},flip:{left:function(e,t){var r=t.within,n=r.offset.left+r.scrollLeft,i=r.width,r=r.isWindow?r.scrollLeft:r.offset.left,o=e.left-t.collisionPosition.marginLeft,s=o-r,o=o+t.collisionWidth-i-r,a="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,l="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,c=-2*t.offset[0];s<0?((i=e.left+a+l+c+t.collisionWidth-i-n)<0||i<S(s))&&(e.left+=a+l+c):0<o&&(0<(n=e.left-t.collisionPosition.marginLeft+a+l+c-r)||S(n)<o)&&(e.left+=a+l+c)},top:function(e,t){var r=t.within,n=r.offset.top+r.scrollTop,i=r.height,r=r.isWindow?r.scrollTop:r.offset.top,o=e.top-t.collisionPosition.marginTop,s=o-r,o=o+t.collisionHeight-i-r,a="top"===t.my[1]?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,l="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,c=-2*t.offset[1];s<0?((i=e.top+a+l+c+t.collisionHeight-i-n)<0||i<S(s))&&(e.top+=a+l+c):0<o&&(0<(n=e.top-t.collisionPosition.marginTop+a+l+c-r)||S(n)<o)&&(e.top+=a+l+c)}},flipfit:{left:function(){E.ui.position.flip.left.apply(this,arguments),E.ui.position.fit.left.apply(this,arguments)},top:function(){E.ui.position.flip.top.apply(this,arguments),E.ui.position.fit.top.apply(this,arguments)}}};var t,p,e;E.ui.position,E.expr.pseudos||(E.expr.pseudos=E.expr[":"]),E.uniqueSort||(E.uniqueSort=E.unique),E.escapeSelector||(t=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g,p=function(e,t){return t?"\0"===e?"�":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},E.escapeSelector=function(e){return(e+"").replace(t,p)}),E.fn.even&&E.fn.odd||E.fn.extend({even:function(){return this.filter(function(e){return e%2==0})},odd:function(){return this.filter(function(e){return e%2==1})}}),E.ui.keyCode={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38},E.fn.scrollParent=function(e){var t=this.css("position"),r="absolute"===t,n=e?/(auto|scroll|hidden)/:/(auto|scroll)/,e=this.parents().filter(function(){var e=E(this);return(!r||"static"!==e.css("position"))&&n.test(e.css("overflow")+e.css("overflow-y")+e.css("overflow-x"))}).eq(0);return"fixed"!==t&&e.length?e:E(this[0].ownerDocument||document)},E.fn.extend({uniqueId:(e=0,function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})}),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&E(this).removeAttr("id")})}})}(jQuery),!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=e(require("jquery")):e(jQuery)}(function(e){var t;return t=function(C){"use strict";if(!C.ui||!C.ui.fancytree){for(var e,h=null,c=new RegExp(/\.|\//),t=/[&<>"'/]/g,r=/[<>"'/]/g,p="$recursive_request",f="$request_target_invalid",n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},i={16:!0,17:!0,18:!0},d={8:"backspace",9:"tab",10:"return",13:"return",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",59:";",61:"=",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},g={16:"shift",17:"ctrl",18:"alt",91:"meta",93:"meta"},o={0:"",1:"left",2:"middle",3:"right"},m="active expanded focus folder lazy radiogroup selected unselectable unselectableIgnore".split(" "),y={},v="columns types".split(" "),b="checkbox expanded extraClasses folder icon iconTooltip key lazy partsel radiogroup refKey selected statusNodeType title tooltip type unselectable unselectableIgnore unselectableStatus".split(" "),s={},w={},a={active:!0,children:!0,data:!0,focus:!0},l=0;l<m.length;l++)y[m[l]]=!0;for(l=0;l<b.length;l++)e=b[l],s[e]=!0,e!==e.toLowerCase()&&(w[e.toLowerCase()]=e);var E=Array.isArray;return T(C.ui,"Fancytree requires jQuery UI (http://jqueryui.com)"),Date.now||(Date.now=function(){return(new Date).getTime()}),D.prototype={_findDirectChild:function(e){var t,r,n=this.children;if(n)if("string"==typeof e){for(t=0,r=n.length;t<r;t++)if(n[t].key===e)return n[t]}else{if("number"==typeof e)return this.children[e];if(e.parent===this)return e}return null},_setChildren:function(e){T(e&&(!this.children||0===this.children.length),"only init supported"),this.children=[];for(var t=0,r=e.length;t<r;t++)this.children.push(new D(this,e[t]));this.tree._callHook("treeStructureChanged",this.tree,"setChildren")},addChildren:function(e,t){var r,n,i,o,s=this.getFirstChild(),a=this.getLastChild(),l=[];for(C.isPlainObject(e)&&(e=[e]),this.children||(this.children=[]),r=0,n=e.length;r<n;r++)l.push(new D(this,e[r]));if(o=l[0],null==t?this.children=this.children.concat(l):(t=this._findDirectChild(t),T(0<=(i=C.inArray(t,this.children)),"insertBefore must be an existing child"),this.children.splice.apply(this.children,[i,0].concat(l))),s&&!t){for(r=0,n=l.length;r<n;r++)l[r].render();s!==this.getFirstChild()&&s.renderStatus(),a!==this.getLastChild()&&a.renderStatus()}else this.parent&&!this.parent.ul&&!this.tr||this.render();return 3===this.tree.options.selectMode&&this.fixSelection3FromEndNodes(),this.triggerModifyChild("add",1===l.length?l[0]:null),o},addClass:function(e){return this.toggleClass(e,!0)},addNode:function(e,t){switch(t=void 0!==t&&"over"!==t?t:"child"){case"after":return this.getParent().addChildren(e,this.getNextSibling());case"before":return this.getParent().addChildren(e,this);case"firstChild":var r=this.children?this.children[0]:null;return this.addChildren(e,r);case"child":case"over":return this.addChildren(e)}T(!1,"Invalid mode: "+t)},addPagingNode:function(e,t){var r,n;if(t=t||"child",!1!==e)return e=C.extend({title:this.tree.options.strings.moreData,statusNodeType:"paging",icon:!1},e),this.partload=!0,this.addNode(e,t);for(r=this.children.length-1;0<=r;r--)"paging"===(n=this.children[r]).statusNodeType&&this.removeChild(n);this.partload=!1},appendSibling:function(e){return this.addNode(e,"after")},applyCommand:function(e,t){return this.tree.applyCommand(e,this,t)},applyPatch:function(e){if(null===e)return this.remove(),A(this);var t,r,n={children:!0,expanded:!0,parent:!0};for(t in e)S(e,t)&&(r=e[t],n[t]||_(r)||(s[t]?this[t]=r:this.data[t]=r));return S(e,"children")&&(this.removeChildren(),e.children)&&this._setChildren(e.children),this.isVisible()&&(this.renderTitle(),this.renderStatus()),S(e,"expanded")?this.setExpanded(e.expanded):A(this)},collapseSiblings:function(){return this.tree._callHook("nodeCollapseSiblings",this)},copyTo:function(e,t,r){return e.addNode(this.toDict(!0,r),t)},countChildren:function(e){var t,r,n,i=this.children;if(!i)return 0;if(n=i.length,!1!==e)for(t=0,r=n;t<r;t++)n+=i[t].countChildren();return n},debug:function(e){4<=this.tree.options.debugLevel&&(Array.prototype.unshift.call(arguments,this.toString()),u("log",arguments))},discard:function(){return this.warn("FancytreeNode.discard() is deprecated since 2014-02-16. Use .resetLazy() instead."),this.resetLazy()},discardMarkup:function(e){this.tree._callHook(e?"nodeRemoveMarkup":"nodeRemoveChildMarkup",this)},error:function(e){1<=this.tree.options.debugLevel&&(Array.prototype.unshift.call(arguments,this.toString()),u("error",arguments))},findAll:function(t){t=_(t)?t:k(t);var r=[];return this.visit(function(e){t(e)&&r.push(e)}),r},findFirst:function(t){t=_(t)?t:k(t);var r=null;return this.visit(function(e){if(t(e))return r=e,!1}),r},findRelatedNode:function(e,t){return this.tree.findRelatedNode(this,e,t)},_changeSelectStatusAttrs:function(e){var t=!1,r=this.tree.options,n=h.evalOption("unselectable",this,this,r,!1),r=h.evalOption("unselectableStatus",this,this,r,void 0);switch(e=n&&null!=r?r:e){case!1:t=this.selected||this.partsel,this.selected=!1,this.partsel=!1;break;case!0:t=!this.selected||!this.partsel,this.selected=!0,this.partsel=!0;break;case void 0:t=this.selected||!this.partsel,this.selected=!1,this.partsel=!0;break;default:T(!1,"invalid state: "+e)}return t&&this.renderStatus(),t},fixSelection3AfterClick:function(e){var t=this.isSelected();this.visit(function(e){if(e._changeSelectStatusAttrs(t),e.radiogroup)return"skip"}),this.fixSelection3FromEndNodes(e)},fixSelection3FromEndNodes:function(e){var d=this.tree.options;T(3===d.selectMode,"expected selectMode 3"),function e(t){var r,n,i,o,s,a,l,c,u=t.children;if(u&&u.length){for(l=!(a=!0),r=0,n=u.length;r<n;r++)o=e(i=u[r]),h.evalOption("unselectableIgnore",i,i,d,!1)||(!1!==o&&(l=!0),!0!==o&&(a=!1));s=!!a||!!l&&void 0}else s=null==(c=h.evalOption("unselectableStatus",t,t,d,void 0))?!!t.selected:!!c;return t.partsel&&!t.selected&&t.lazy&&null==t.children&&(s=void 0),t._changeSelectStatusAttrs(s),s}(this),this.visitParents(function(e){for(var t,r,n,i=e.children,o=!0,s=!1,a=0,l=i.length;a<l;a++)t=i[a],h.evalOption("unselectableIgnore",t,t,d,!1)||(((r=null==(n=h.evalOption("unselectableStatus",t,t,d,void 0))?!!t.selected:!!n)||t.partsel)&&(s=!0),r)||(o=!1);e._changeSelectStatusAttrs(r=!!o||!!s&&void 0)})},fromDict:function(e){for(var t in e)s[t]?this[t]=e[t]:"data"===t?C.extend(this.data,e.data):_(e[t])||a[t]||(this.data[t]=e[t]);e.children&&(this.removeChildren(),this.addChildren(e.children)),this.renderTitle()},getChildren:function(){if(void 0!==this.hasChildren())return this.children},getFirstChild:function(){return this.children?this.children[0]:null},getIndex:function(){return C.inArray(this,this.parent.children)},getIndexHier:function(e,r){e=e||".";var n,i=[];return C.each(this.getParentList(!1,!0),function(e,t){n=""+(t.getIndex()+1),r&&(n=("0000000"+n).substr(-r)),i.push(n)}),i.join(e)},getKeyPath:function(e){var t=this.tree.options.keyPathSeparator;return t+this.getPath(!e,"key",t)},getLastChild:function(){return this.children?this.children[this.children.length-1]:null},getLevel:function(){for(var e=0,t=this.parent;t;)e++,t=t.parent;return e},getNextSibling:function(){if(this.parent)for(var e=this.parent.children,t=0,r=e.length-1;t<r;t++)if(e[t]===this)return e[t+1];return null},getParent:function(){return this.parent},getParentList:function(e,t){for(var r=[],n=t?this:this.parent;n;)(e||n.parent)&&r.unshift(n),n=n.parent;return r},getPath:function(e,t,r){r=r||"/";var n,i=[],o=_(t=t||"title");return this.visitParents(function(e){e.parent&&(n=o?t(e):e[t],i.unshift(n))},e=!1!==e),i.join(r)},getPrevSibling:function(){if(this.parent)for(var e=this.parent.children,t=1,r=e.length;t<r;t++)if(e[t]===this)return e[t-1];return null},getSelectedNodes:function(t){var r=[];return this.visit(function(e){if(e.selected&&(r.push(e),!0===t))return"skip"}),r},hasChildren:function(){return this.lazy?null==this.children?void 0:0!==this.children.length&&(1!==this.children.length||!this.children[0].isStatusNode()||void 0):!(!this.children||!this.children.length)},hasClass:function(e){return 0<=(" "+(this.extraClasses||"")+" ").indexOf(" "+e+" ")},hasFocus:function(){return this.tree.hasFocus()&&this.tree.focusNode===this},info:function(e){3<=this.tree.options.debugLevel&&(Array.prototype.unshift.call(arguments,this.toString()),u("info",arguments))},isActive:function(){return this.tree.activeNode===this},isBelowOf:function(e){return this.getIndexHier(".",5)>e.getIndexHier(".",5)},isChildOf:function(e){return this.parent&&this.parent===e},isDescendantOf:function(e){if(e&&e.tree===this.tree)for(var t=this.parent;t;){if(t===e)return!0;t===t.parent&&C.error("Recursive parent link: "+t),t=t.parent}return!1},isExpanded:function(){return!!this.expanded},isFirstSibling:function(){var e=this.parent;return!e||e.children[0]===this},isFolder:function(){return!!this.folder},isLastSibling:function(){var e=this.parent;return!e||e.children[e.children.length-1]===this},isLazy:function(){return!!this.lazy},isLoaded:function(){return!this.lazy||void 0!==this.hasChildren()},isLoading:function(){return!!this._isLoading},isRoot:function(){return this.isRootNode()},isPartsel:function(){return!this.selected&&!!this.partsel},isPartload:function(){return!!this.partload},isRootNode:function(){return this.tree.rootNode===this},isSelected:function(){return!!this.selected},isStatusNode:function(){return!!this.statusNodeType},isPagingNode:function(){return"paging"===this.statusNodeType},isTopLevel:function(){return this.tree.rootNode===this.parent},isUndefined:function(){return void 0===this.hasChildren()},isVisible:function(){var e,t,r=this.tree.enableFilter,n=this.getParentList(!1,!1);if(r&&!this.match&&!this.subMatchCount)return!1;for(e=0,t=n.length;e<t;e++)if(!n[e].expanded)return!1;return!0},lazyLoad:function(e){C.error("FancytreeNode.lazyLoad() is deprecated since 2014-02-16. Use .load() instead.")},load:function(e){var t=this,r=this.isExpanded();return T(this.isLazy(),"load() requires a lazy node"),!e&&!this.isUndefined()||(this.isLoaded()&&this.resetLazy(),!1===(e=this.tree._triggerNodeEvent("lazyLoad",this)))?A(this):(T("boolean"!=typeof e,"lazyLoad event must return source in data.result"),e=this.tree._callHook("nodeLoadChildren",this,e),r?(this.expanded=!0,e.always(function(){t.render()})):e.always(function(){t.renderStatus()}),e)},makeVisible:function(e){for(var t=this,r=[],n=new C.Deferred,i=this.getParentList(!1,!1),o=i.length,s=!(e&&!0===e.noAnimation),a=!(e&&!1===e.scrollIntoView),l=o-1;0<=l;l--)r.push(i[l].setExpanded(!0,e));return C.when.apply(C,r).done(function(){a?t.scrollIntoView(s).done(function(){n.resolve()}):n.resolve()}),n.promise()},moveTo:function(t,e,r){void 0===e||"over"===e?e="child":"firstChild"===e&&(t.children&&t.children.length?(e="before",t=t.children[0]):e="child");var n,i=this.tree,o=this.parent,s="child"===e?t:t.parent;if(this!==t){if(this.parent?s.isDescendantOf(this)&&C.error("Cannot move a node to its own descendant"):C.error("Cannot move system root"),s!==o&&o.triggerModifyChild("remove",this),1===this.parent.children.length){if(this.parent===s)return;this.parent.children=this.parent.lazy?[]:null,this.parent.expanded=!1}else T(0<=(n=C.inArray(this,this.parent.children)),"invalid source parent"),this.parent.children.splice(n,1);if((this.parent=s).hasChildren())switch(e){case"child":s.children.push(this);break;case"before":T(0<=(n=C.inArray(t,s.children)),"invalid target parent"),s.children.splice(n,0,this);break;case"after":T(0<=(n=C.inArray(t,s.children)),"invalid target parent"),s.children.splice(n+1,0,this);break;default:C.error("Invalid mode "+e)}else s.children=[this];r&&t.visit(r,!0),s===o?s.triggerModifyChild("move",this):s.triggerModifyChild("add",this),i!==t.tree&&(this.warn("Cross-tree moveTo is experimental!"),this.visit(function(e){e.tree=t.tree},!0)),i._callHook("treeStructureChanged",i,"moveTo"),o.isDescendantOf(s)||o.render(),s.isDescendantOf(o)||s===o||s.render()}},navigate:function(e,t){var r=C.ui.keyCode;switch(e){case"left":case r.LEFT:if(this.expanded)return this.setExpanded(!1);break;case"right":case r.RIGHT:if(this.expanded||!this.children&&!this.lazy)break;return this.setExpanded()}if(r=this.findRelatedNode(e)){try{r.makeVisible({scrollIntoView:!1})}catch(e){}return!1===t?(r.setFocus(),A()):r.setActive()}return this.warn("Could not find related node '"+e+"'."),A()},remove:function(){return this.parent.removeChild(this)},removeChild:function(e){return this.tree._callHook("nodeRemoveChild",this,e)},removeChildren:function(){return this.tree._callHook("nodeRemoveChildren",this)},removeClass:function(e){return this.toggleClass(e,!1)},render:function(e,t){return this.tree._callHook("nodeRender",this,e,t)},renderTitle:function(){return this.tree._callHook("nodeRenderTitle",this)},renderStatus:function(){return this.tree._callHook("nodeRenderStatus",this)},replaceWith:function(e){var r=this.parent,n=C.inArray(this,r.children),i=this;return T(this.isPagingNode(),"replaceWith() currently requires a paging status node"),(e=this.tree._callHook("nodeLoadChildren",this,e)).done(function(e){var t=i.children;for(l=0;l<t.length;l++)t[l].parent=r;r.children.splice.apply(r.children,[n+1,0].concat(t)),i.children=null,i.remove(),r.render()}).fail(function(){i.setExpanded()}),e},resetLazy:function(){this.removeChildren(),this.expanded=!1,this.lazy=!0,this.children=void 0,this.renderStatus()},scheduleAction:function(e,t){this.tree.timer&&(clearTimeout(this.tree.timer),this.tree.debug("clearTimeout(%o)",this.tree.timer)),this.tree.timer=null;var r=this;switch(e){case"cancel":break;case"expand":this.tree.timer=setTimeout(function(){r.tree.debug("setTimeout: trigger expand"),r.setExpanded(!0)},t);break;case"activate":this.tree.timer=setTimeout(function(){r.tree.debug("setTimeout: trigger activate"),r.setActive(!0)},t);break;default:C.error("Invalid mode "+e)}},scrollIntoView:function(e,t){if(void 0!==t&&(r=t).tree&&void 0!==r.statusNodeType)throw Error("scrollIntoView() with 'topNode' option is deprecated since 2014-05-08. Use 'options.topNode' instead.");var r=C.extend({effects:!0===e?{duration:200,queue:!1}:e,scrollOfs:this.tree.options.scrollOfs,scrollParent:this.tree.options.scrollParent,topNode:null},t),e=r.scrollParent,t=this.tree.$container,n=t.css("overflow-y");e?e.jquery||(e=C(e)):e=!this.tree.tbody&&("scroll"===n||"auto"===n)?t:t.scrollParent(),e[0]!==document&&e[0]!==document.body||(this.debug("scrollIntoView(): normalizing scrollParent to 'window':",e[0]),e=C(window));var i,o,s=new C.Deferred,a=this,n=C(this.span).height(),t=r.scrollOfs.top||0,l=r.scrollOfs.bottom||0,c=e.height(),u=e.scrollTop(),d=e,h=e[0]===window,p=r.topNode||null,f=null;return this.isRootNode()||!this.isVisible()?(this.info("scrollIntoView(): node is invisible."),A()):(h?(o=C(this.span).offset().top,i=p&&p.span?C(p.span).offset().top:0,d=C("html,body")):(T(e[0]!==document&&e[0]!==document.body,"scrollParent should be a simple element or `window`, not document or body."),h=e.offset().top,o=C(this.span).offset().top-h+u,i=p?C(p.span).offset().top-h+u:0,c-=Math.max(0,e.innerHeight()-e[0].clientHeight)),o<u+t?f=o-t:u+c-l<o+n&&(f=o+n-c+l,p)&&(T(p.isRootNode()||p.isVisible(),"topNode must be visible"),i<f)&&(f=i-t),null===f?s.resolveWith(this):r.effects?(r.effects.complete=function(){s.resolveWith(a)},d.stop(!0).animate({scrollTop:f},r.effects)):(d[0].scrollTop=f,s.resolveWith(this)),s.promise())},setActive:function(e,t){return this.tree._callHook("nodeSetActive",this,e,t)},setExpanded:function(e,t){return this.tree._callHook("nodeSetExpanded",this,e,t)},setFocus:function(e){return this.tree._callHook("nodeSetFocus",this,e)},setSelected:function(e,t){return this.tree._callHook("nodeSetSelected",this,e,t)},setStatus:function(e,t,r){return this.tree._callHook("nodeSetStatus",this,e,t,r)},setTitle:function(e){this.title=e,this.renderTitle(),this.triggerModify("rename")},sortChildren:function(e,t){var r,n,i=this.children;if(i){if(i.sort(e=e||function(e,t){e=e.title.toLowerCase(),t=t.title.toLowerCase();return e===t?0:t<e?1:-1}),t)for(r=0,n=i.length;r<n;r++)i[r].children&&i[r].sortChildren(e,"$norender$");"$norender$"!==t&&this.render(),this.triggerModifyChild("sort")}},toDict:function(e,t){var r,n,i,o,s={},a=this;if(C.each(b,function(e,t){!a[t]&&!1!==a[t]||(s[t]=a[t])}),C.isEmptyObject(this.data)||(s.data=C.extend({},this.data),C.isEmptyObject(s.data)&&delete s.data),t){if(!1===(o=t(s,a)))return!1;"skip"===o&&(e=!1)}if(e&&E(this.children))for(s.children=[],r=0,n=this.children.length;r<n;r++)(i=this.children[r]).isStatusNode()||!1!==(o=i.toDict(!0,t))&&s.children.push(o);return s},toggleClass:function(e,t){var r,n,i=e.match(/\S+/g)||[],o=0,s=!1,a=this[this.tree.statusClassPropName],l=" "+(this.extraClasses||"")+" ";for(a&&C(a).toggleClass(e,t);r=i[o++];)if(n=0<=l.indexOf(" "+r+" "),t=void 0===t?!n:!!t)n||(l+=r+" ",s=!0);else for(;-1<l.indexOf(" "+r+" ");)l=l.replace(" "+r+" "," ");return this.extraClasses=x(l),s},toggleExpanded:function(){return this.tree._callHook("nodeToggleExpanded",this)},toggleSelected:function(){return this.tree._callHook("nodeToggleSelected",this)},toString:function(){return"FancytreeNode@"+this.key+"[title='"+this.title+"']"},triggerModifyChild:function(e,t,r){var n=this.tree.options.modifyChild;n&&(t&&t.parent!==this&&C.error("childNode "+t+" is not a child of "+this),e={node:this,tree:this.tree,operation:e,childNode:t||null},r&&C.extend(e,r),n({type:"modifyChild"},e))},triggerModify:function(e,t){this.parent.triggerModifyChild(e,this,t)},visit:function(e,t){var r,n,i=!0,o=this.children;if((!0!==t||!1!==(i=e(this))&&"skip"!==i)&&o)for(r=0,n=o.length;r<n&&!1!==(i=o[r].visit(e,!0));r++);return i},visitAndLoad:function(r,e,t){var n,i,o,s=this;return!r||!0!==e||!1!==(i=r(s))&&"skip"!==i?s.children||s.lazy?(n=new C.Deferred,o=[],s.load().done(function(){for(var e=0,t=s.children.length;e<t;e++){if(!1===(i=s.children[e].visitAndLoad(r,!0,!0))){n.reject();break}"skip"!==i&&o.push(i)}C.when.apply(this,o).then(function(){n.resolve()})}),n.promise()):A():t?i:A()},visitParents:function(e,t){if(t&&!1===e(this))return!1;for(var r=this.parent;r;){if(!1===e(r))return!1;r=r.parent}return!0},visitSiblings:function(e,t){for(var r,n=this.parent.children,i=0,o=n.length;i<o;i++)if(r=n[i],(t||r!==this)&&!1===e(r))return!1;return!0},warn:function(e){2<=this.tree.options.debugLevel&&(Array.prototype.unshift.call(arguments,this.toString()),u("warn",arguments))}},C.extend(P.prototype={_makeHookContext:function(e,t,r){var n,i;return void 0!==e.node?(t&&e.originalEvent!==t&&C.error("invalid args"),n=e):e.tree?n={node:e,tree:i=e.tree,widget:i.widget,options:i.widget.options,originalEvent:t,typeInfo:i.types[e.type]||{}}:e.widget?n={node:null,tree:e,widget:e.widget,options:e.widget.options,originalEvent:t}:C.error("invalid args"),r&&C.extend(n,r),n},_callHook:function(e,t,r){var t=this._makeHookContext(t),n=this[e],i=Array.prototype.slice.call(arguments,2);return _(n)||C.error("_callHook('"+e+"') is not a function"),i.unshift(t),n.apply(this,i)},_setExpiringValue:function(e,t,r){this._tempCache[e]={value:t,expire:Date.now()+(+r||50)}},_getExpiringValue:function(e){var t=this._tempCache[e];return t&&t.expire>Date.now()?t.value:(delete this._tempCache[e],null)},_usesExtension:function(e){return 0<=C.inArray(e,this.options.extensions)},_requireExtension:function(e,t,r,n){null!=r&&(r=!!r);var i=this._local.name,o=this.options.extensions,o=C.inArray(e,o)<C.inArray(i,o),s=t&&null==this.ext[e],o=!s&&null!=r&&r!==o;return T(i&&i!==e,"invalid or same name '"+i+"' (require yourself?)"),!s&&!o||(n||(s||t?(n="'"+i+"' extension requires '"+e+"'",o&&(n+=" to be registered "+(r?"before":"after")+" itself")):n="If used together, `"+e+"` must be registered "+(r?"before":"after")+" `"+i+"`"),C.error(n),!1)},activateKey:function(e,t){e=this.getNodeByKey(e);return e?e.setActive(!0,t):this.activeNode&&this.activeNode.setActive(!1,t),e},addPagingNode:function(e,t){return this.rootNode.addPagingNode(e,t)},applyCommand:function(e,t,r){var n;switch(t=t||this.getActiveNode(),e){case"moveUp":(n=t.getPrevSibling())&&(t.moveTo(n,"before"),t.setActive());break;case"moveDown":(n=t.getNextSibling())&&(t.moveTo(n,"after"),t.setActive());break;case"indent":(n=t.getPrevSibling())&&(t.moveTo(n,"child"),n.setExpanded(),t.setActive());break;case"outdent":t.isTopLevel()||(t.moveTo(t.getParent(),"after"),t.setActive());break;case"remove":n=t.getPrevSibling()||t.getParent(),t.remove(),n&&n.setActive();break;case"addChild":t.editCreateNode("child","");break;case"addSibling":t.editCreateNode("after","");break;case"rename":t.editStart();break;case"down":case"first":case"last":case"left":case"parent":case"right":case"up":return t.navigate(e);default:C.error("Unhandled command: '"+e+"'")}},applyPatch:function(e){for(var t,r,n,i,o=e.length,s=[],a=0;a<o;a++)T(2===(n=e[a]).length,"patchList must be an array of length-2-arrays"),r=n[0],n=n[1],(i=null===r?this.rootNode:this.getNodeByKey(r))?(t=new C.Deferred,s.push(t),i.applyPatch(n).always(O(t,i))):this.warn("could not find node with key '"+r+"'");return C.when.apply(C,s).promise()},clear:function(e){this._callHook("treeClear",this)},count:function(){return this.rootNode.countChildren()},debug:function(e){4<=this.options.debugLevel&&(Array.prototype.unshift.call(arguments,this.toString()),u("log",arguments))},destroy:function(){this.widget.destroy()},enable:function(e){!1===e?this.widget.disable():this.widget.enable()},enableUpdate:function(e){return!!this._enableUpdate==!!(e=!1!==e)?e:((this._enableUpdate=e)?(this.debug("enableUpdate(true): redraw "),this._callHook("treeStructureChanged",this,"enableUpdate"),this.render()):this.debug("enableUpdate(false)..."),!e)},error:function(e){1<=this.options.debugLevel&&(Array.prototype.unshift.call(arguments,this.toString()),u("error",arguments))},expandAll:function(t,r){var e=this.enableUpdate(!1);t=!1!==t,this.visit(function(e){!1!==e.hasChildren()&&e.isExpanded()!==t&&e.setExpanded(t,r)}),this.enableUpdate(e)},findAll:function(e){return this.rootNode.findAll(e)},findFirst:function(e){return this.rootNode.findFirst(e)},findNextNode:function(t,r){var n,i=null,e=this.getFirstChild();function o(e){if((i=t(e)?e:i)||e===r)return!1}return t="string"==typeof t?(n=new RegExp("^"+t,"i"),function(e){return n.test(e.title)}):t,r=r||e,this.visitRows(o,{start:r,includeSelf:!1}),i||r===e||this.visitRows(o,{start:e,includeSelf:!0}),i},findRelatedNode:function(e,t,r){var n=null,i=C.ui.keyCode;switch(t){case"parent":case i.BACKSPACE:e.parent&&e.parent.parent&&(n=e.parent);break;case"first":case i.HOME:this.visit(function(e){if(e.isVisible())return n=e,!1});break;case"last":case i.END:this.visit(function(e){e.isVisible()&&(n=e)});break;case"left":case i.LEFT:e.expanded?e.setExpanded(!1):e.parent&&e.parent.parent&&(n=e.parent);break;case"right":case i.RIGHT:e.expanded||!e.children&&!e.lazy?e.children&&e.children.length&&(n=e.children[0]):(e.setExpanded(),n=e);break;case"up":case i.UP:this.visitRows(function(e){return n=e,!1},{start:e,reverse:!0,includeSelf:!1});break;case"down":case i.DOWN:this.visitRows(function(e){return n=e,!1},{start:e,includeSelf:!1});break;default:this.tree.warn("Unknown relation '"+t+"'.")}return n},generateFormElements:function(e,t,r){r=r||{};var n="string"==typeof e?e:"ft_"+this._id+"[]",i="string"==typeof t?t:"ft_"+this._id+"_active",o="fancytree_result_"+this._id,s=C("#"+o),a=3===this.options.selectMode&&!1!==r.stopOnParents;function l(e){s.append(C("<input>",{type:"checkbox",name:n,value:e.key,checked:!0}))}s.length?s.empty():s=C("<div>",{id:o}).hide().insertAfter(this.$container),!1!==t&&this.activeNode&&s.append(C("<input>",{type:"radio",name:i,value:this.activeNode.key,checked:!0})),r.filter?this.visit(function(e){var t=r.filter(e);if("skip"===t)return t;!1!==t&&l(e)}):!1!==e&&(o=this.getSelectedNodes(a),C.each(o,function(e,t){l(t)}))},getActiveNode:function(){return this.activeNode},getFirstChild:function(){return this.rootNode.getFirstChild()},getFocusNode:function(){return this.focusNode},getOption:function(e){return this.widget.option(e)},getNodeByKey:function(t,e){var r,n;return!e&&(r=document.getElementById(this.options.idPrefix+t))?r.ftnode||null:(e=e||this.rootNode,n=null,t=""+t,e.visit(function(e){if(e.key===t)return n=e,!1},!0),n)},getRootNode:function(){return this.rootNode},getSelectedNodes:function(e){return this.rootNode.getSelectedNodes(e)},hasFocus:function(){return!!this._hasFocus},info:function(e){3<=this.options.debugLevel&&(Array.prototype.unshift.call(arguments,this.toString()),u("info",arguments))},isLoading:function(){var t=!1;return this.rootNode.visit(function(e){if(e._isLoading||e._requestId)return!(t=!0)},!0),t},loadKeyPath:function(e,t){var n,r,i,o=this,s=new C.Deferred,a=this.getRootNode(),l=this.options.keyPathSeparator,c=[],u=C.extend({},t);for("function"==typeof t?n=t:t&&t.callback&&(n=t.callback),u.callback=function(e,t,r){n&&n.call(e,t,r),s.notifyWith(e,[{node:t,status:r}])},null==u.matchKey&&(u.matchKey=function(e,t){return e.key===t}),E(e)||(e=[e]),r=0;r<e.length;r++)(i=e[r]).charAt(0)===l&&(i=i.substr(1)),c.push(i.split(l));return setTimeout(function(){o._loadKeyPathImpl(s,u,a,c).done(function(){s.resolve()})},0),s.promise()},_loadKeyPathImpl:function(e,o,t,r){var n,i,s,a,l,c,u,d,h,p,f=this;for(u={},i=0;i<r.length;i++)for(h=r[i],d=t;h.length;){if(s=h.shift(),!(a=function(e,t){var r,n,i=e.children;if(i)for(r=0,n=i.length;r<n;r++)if(o.matchKey(i[r],t))return i[r];return null}(d,s))){this.warn("loadKeyPath: key not found: "+s+" (parent: "+d+")"),o.callback(this,s,"error");break}if(0===h.length){o.callback(this,a,"ok");break}if(a.lazy&&void 0===a.hasChildren()){o.callback(this,a,"loaded"),u[s=a.key]?u[s].pathSegList.push(h):u[s]={parent:a,pathSegList:[h]};break}o.callback(this,a,"loaded"),d=a}for(l in n=[],u)S(u,l)&&(c=u[l],p=new C.Deferred,n.push(p),function(t,r,e){o.callback(f,r,"loading"),r.load().done(function(){f._loadKeyPathImpl.call(f,t,o,r,e).always(O(t,f))}).fail(function(e){f.warn("loadKeyPath: error loading lazy "+r),o.callback(f,a,"error"),t.rejectWith(f)})}(p,c.parent,c.pathSegList));return C.when.apply(C,n).promise()},reactivate:function(e){var t,r=this.activeNode;return r?(this.activeNode=null,t=r.setActive(!0,{noFocus:!0}),e&&r.setFocus(),t):A()},reload:function(e){return this._callHook("treeClear",this),this._callHook("treeLoad",this,e)},render:function(e,t){return this.rootNode.render(e,t)},selectAll:function(t){this.visit(function(e){e.setSelected(t)})},setFocus:function(e){return this._callHook("treeSetFocus",this,e)},setOption:function(e,t){return this.widget.option(e,t)},debugTime:function(e){4<=this.options.debugLevel&&window.console.time(this+" - "+e)},debugTimeEnd:function(e){4<=this.options.debugLevel&&window.console.timeEnd(this+" - "+e)},toDict:function(e,t){t=this.rootNode.toDict(!0,t);return e?t:t.children},toString:function(){return"Fancytree@"+this._id},_triggerNodeEvent:function(e,t,r,n){t=this._makeHookContext(t,r,n),n=this.widget._trigger(e,r,t);return!1!==n&&void 0!==t.result?t.result:n},_triggerTreeEvent:function(e,t,r){r=this._makeHookContext(this,t,r),e=this.widget._trigger(e,t,r);return!1!==e&&void 0!==r.result?r.result:e},visit:function(e){return this.rootNode.visit(e,!1)},visitRows:function(t,e){if(!this.rootNode.hasChildren())return!1;if(e&&e.reverse)return delete e.reverse,this._visitRowsUp(t,e);for(var r,n,i,o=0,s=!1===(e=e||{}).includeSelf,a=!!e.includeHidden,l=!a&&this.enableFilter,c=e.start||this.rootNode.children[0],u=c.parent;u;){for(T(0<=(n=(i=u.children).indexOf(c)+o),"Could not find "+c+" in parent's children: "+u),r=n;r<i.length;r++)if(c=i[r],!l||c.match||c.subMatchCount){if(!s&&!1===t(c))return!1;if(s=!1,c.children&&c.children.length&&(a||c.expanded)&&!1===c.visit(function(e){return!l||e.match||e.subMatchCount?!1!==t(e)&&(a||!e.children||e.expanded?void 0:"skip"):"skip"},!1))return!1}u=(c=u).parent,o=1}return!0},_visitRowsUp:function(e,t){for(var r,n,i,o=!!t.includeHidden,s=t.start||this.rootNode.children[0];;){if((r=(i=s.parent).children)[0]===s){if(!(s=i).parent)break;r=i.children}else for(n=r.indexOf(s),s=r[n-1];(o||s.expanded)&&s.children&&s.children.length;)s=(r=(i=s).children)[r.length-1];if((o||s.isVisible())&&!1===e(s))return!1}},warn:function(e){2<=this.options.debugLevel&&(Array.prototype.unshift.call(arguments,this.toString()),u("warn",arguments))}},{nodeClick:function(e){var t,r,n=e.targetType,i=e.node;if("expander"===n)i.isLoading()?i.debug("Got 2nd click while loading: ignored"):this._callHook("nodeToggleExpanded",e);else if("checkbox"===n)this._callHook("nodeToggleSelected",e),e.options.focusOnSelect&&this._callHook("nodeSetFocus",e,!0);else{if(t=!(r=!1),i.folder)switch(e.options.clickFolderMode){case 2:t=!(r=!0);break;case 3:r=t=!0}t&&(this.nodeSetFocus(e),this._callHook("nodeSetActive",e,!0)),r&&this._callHook("nodeToggleExpanded",e)}},nodeCollapseSiblings:function(e,t){var r,n,i,o=e.node;if(o.parent)for(n=0,i=(r=o.parent.children).length;n<i;n++)r[n]!==o&&r[n].expanded&&this._callHook("nodeSetExpanded",r[n],!1,t)},nodeDblclick:function(e){"title"===e.targetType&&4===e.options.clickFolderMode&&this._callHook("nodeToggleExpanded",e),"title"===e.targetType&&e.originalEvent.preventDefault()},nodeKeydown:function(e){var t,r=e.originalEvent,n=e.node,i=e.tree,o=e.options,s=r.which,a=r.key||String.fromCharCode(s),l=!!(r.altKey||r.ctrlKey||r.metaKey),s=!g[s]&&!d[s]&&!l,l=C(r.target),c=!0,u=!(r.ctrlKey||!o.autoActivate);if(n||(t=this.getActiveNode()||this.getFirstChild())&&(t.setFocus(),(n=e.node=this.focusNode).debug("Keydown force focus on active node")),o.quicksearch&&s&&!l.is(":input:enabled"))500<(t=Date.now())-i.lastQuicksearchTime&&(i.lastQuicksearchTerm=""),i.lastQuicksearchTime=t,i.lastQuicksearchTerm+=a,(s=i.findNextNode(i.lastQuicksearchTerm,i.getActiveNode()))&&s.setActive(),r.preventDefault();else{switch(h.eventToString(r)){case"+":case"=":i.nodeSetExpanded(e,!0);break;case"-":i.nodeSetExpanded(e,!1);break;case"space":n.isPagingNode()?i._triggerNodeEvent("clickPaging",e,r):h.evalOption("checkbox",n,n,o,!1)?i.nodeToggleSelected(e):i.nodeSetActive(e,!0);break;case"return":i.nodeSetActive(e,!0);break;case"home":case"end":case"backspace":case"left":case"right":case"up":case"down":n.navigate(r.which,u);break;default:c=!1}c&&r.preventDefault()}},nodeLoadChildren:function(o,s){var t,r,a,e=null,n=!0,l=o.tree,c=o.node,u=c.parent,i="nodeLoadChildren",d=Date.now();return _(s)&&T(!_(s=s.call(l,{type:"source"},o)),"source callback must not return another function"),_(s.then)?e=s:s.url?e=(t=C.extend({},o.options.ajax,s)).debugDelay?(r=t.debugDelay,delete t.debugDelay,E(r)&&(r=r[0]+Math.random()*(r[1]-r[0])),c.warn("nodeLoadChildren waiting debugDelay "+Math.round(r)+" ms ..."),C.Deferred(function(e){setTimeout(function(){C.ajax(t).done(function(){e.resolveWith(this,arguments)}).fail(function(){e.rejectWith(this,arguments)})},r)})):C.ajax(t):C.isPlainObject(s)||E(s)?n=!(e={then:function(e,t){e(s,null,null)}}):C.error("Invalid source type: "+s),c._requestId&&(c.warn("Recursive load request #"+d+" while #"+c._requestId+" is pending."),c._requestId=d),n&&(l.debugTime(i),l.nodeSetStatus(o,"loading")),a=new C.Deferred,e.then(function(e,t,r){var n,i;if("json"!==s.dataType&&"jsonp"!==s.dataType||"string"!=typeof e||C.error("Ajax request returned a string (did you get the JSON dataType wrong?)."),c._requestId&&c._requestId>d)a.rejectWith(this,[p]);else if(null===c.parent&&null!==u)a.rejectWith(this,[f]);else{if(o.options.postProcess){try{(i=l._triggerNodeEvent("postProcess",o,o.originalEvent,{response:e,error:null,dataType:s.dataType})).error&&l.warn("postProcess returned error:",i)}catch(e){i={error:e,message:""+e,details:"postProcess failed"}}if(i.error)return n=C.isPlainObject(i.error)?i.error:{message:i.error},n=l._makeHookContext(c,null,n),void a.rejectWith(this,[n]);(E(i)||C.isPlainObject(i)&&E(i.children))&&(e=i)}else e&&S(e,"d")&&o.options.enableAspx&&(42===o.options.enableAspx&&l.warn("The default for enableAspx will change to `false` in the fututure. Pass `enableAspx: true` or implement postProcess to silence this warning."),e="string"==typeof e.d?C.parseJSON(e.d):e.d);a.resolveWith(this,[e])}},function(e,t,r){e=l._makeHookContext(c,null,{error:e,args:Array.prototype.slice.call(arguments),message:r,details:e.status+": "+r});a.rejectWith(this,[e])}),a.done(function(e){var t,r,n;l.nodeSetStatus(o,"ok"),C.isPlainObject(e)?(T(c.isRootNode(),"source may only be an object for root nodes (expecting an array of child objects otherwise)"),T(E(e.children),"if an object is passed as source, it must contain a 'children' array (all other properties are added to 'tree.data')"),t=(r=e).children,delete r.children,C.each(v,function(e,t){void 0!==r[t]&&(l[t]=r[t],delete r[t])}),C.extend(l.data,r)):t=e,T(E(t),"expected array of children"),c._setChildren(t),l.options.nodata&&0===t.length&&(_(l.options.nodata)?n=l.options.nodata.call(l,{type:"nodata"},o):!0===l.options.nodata&&c.isRootNode()?n=l.options.strings.noData:"string"==typeof l.options.nodata&&c.isRootNode()&&(n=l.options.nodata),n)&&c.setStatus("nodata",n),l._triggerNodeEvent("loadChildren",c)}).fail(function(e){var t;e===p?c.warn("Ignored response for obsolete load request #"+d+" (expected #"+c._requestId+")"):e===f?c.warn("Lazy parent node was removed while loading: discarding response."):(e.node&&e.error&&e.message?t=e:"[object Object]"===(t=l._makeHookContext(c,null,{error:e,args:Array.prototype.slice.call(arguments),message:e?e.message||e.toString():""})).message&&(t.message=""),c.warn("Load children failed ("+t.message+")",t),!1!==l._triggerNodeEvent("loadError",t,null)&&l.nodeSetStatus(o,"error",t.message,t.details))}).always(function(){c._requestId=null,n&&l.debugTimeEnd(i)}),a.promise()},nodeLoadKeyPath:function(e,t){},nodeRemoveChild:function(e,t){var r=e.node,n=C.extend({},e,{node:t}),i=r.children;if(1===i.length)return T(t===i[0],"invalid single child"),this.nodeRemoveChildren(e);this.activeNode&&(t===this.activeNode||this.activeNode.isDescendantOf(t))&&this.activeNode.setActive(!1),this.focusNode&&(t===this.focusNode||this.focusNode.isDescendantOf(t))&&(this.focusNode=null),this.nodeRemoveMarkup(n),this.nodeRemoveChildren(n),T(0<=(e=C.inArray(t,i)),"invalid child"),r.triggerModifyChild("remove",t),t.visit(function(e){e.parent=null},!0),this._callHook("treeRegisterNode",this,!1,t),i.splice(e,1)},nodeRemoveChildMarkup:function(e){e=e.node;e.ul&&(e.isRootNode()?C(e.ul).empty():(C(e.ul).remove(),e.ul=null),e.visit(function(e){e.li=e.ul=null}))},nodeRemoveChildren:function(e){var t=e.tree,r=e.node;r.children&&(this.activeNode&&this.activeNode.isDescendantOf(r)&&this.activeNode.setActive(!1),this.focusNode&&this.focusNode.isDescendantOf(r)&&(this.focusNode=null),this.nodeRemoveChildMarkup(e),r.triggerModifyChild("remove",null),r.visit(function(e){e.parent=null,t._callHook("treeRegisterNode",t,!1,e)}),r.lazy?r.children=[]:r.children=null,r.isRootNode()||(r.expanded=!1),this.nodeRenderStatus(e))},nodeRemoveMarkup:function(e){var t=e.node;t.li&&(C(t.li).remove(),t.li=null),this.nodeRemoveChildMarkup(e)},nodeRender:function(e,t,r,n,i){var o,s,a,l,c,u,d,h=e.node,p=e.tree,f=e.options,g=f.aria,m=!1,y=h.parent,v=!y,b=h.children,w=null;if(!1!==p._enableUpdate&&(v||y.ul)){if(T(v||y.ul,"parent UL must exist"),v||(h.li&&(t||h.li.parentNode!==h.parent.ul)&&(h.li.parentNode===h.parent.ul?w=h.li.nextSibling:this.debug("Unlinking "+h+" (must be child of "+h.parent+")"),this.nodeRemoveMarkup(e)),h.li?this.nodeRenderStatus(e):(m=!0,h.li=document.createElement("li"),(h.li.ftnode=h).key&&f.generateIds&&(h.li.id=f.idPrefix+h.key),h.span=document.createElement("span"),h.span.className="fancytree-node",g&&!h.tr&&C(h.li).attr("role","treeitem"),h.li.appendChild(h.span),this.nodeRenderTitle(e),f.createNode&&f.createNode.call(p,{type:"createNode"},e)),f.renderNode&&f.renderNode.call(p,{type:"renderNode"},e)),b){if(v||h.expanded||!0===r){for(h.ul||(h.ul=document.createElement("ul"),(!0!==n||i)&&h.expanded||(h.ul.style.display="none"),g&&C(h.ul).attr("role","group"),h.li?h.li.appendChild(h.ul):h.tree.$div.append(h.ul)),l=0,c=b.length;l<c;l++)d=C.extend({},e,{node:b[l]}),this.nodeRender(d,t,r,!1,!0);for(o=h.ul.firstChild;o;)o=(a=o.ftnode)&&a.parent!==h?(h.debug("_fixParent: remove missing "+a,o),u=o.nextSibling,o.parentNode.removeChild(o),u):o.nextSibling;for(o=h.ul.firstChild,l=0,c=b.length-1;l<c;l++)(s=b[l])===(a=o.ftnode)?o=o.nextSibling:h.ul.insertBefore(s.li,a.li)}}else h.ul&&(this.warn("remove child markup for "+h),this.nodeRemoveChildMarkup(e));v||m&&y.ul.insertBefore(h.li,w)}},nodeRenderTitle:function(e,t){var r,n=e.node,i=e.tree,o=e.options,s=o.aria,a=n.getLevel(),l=[];void 0!==t&&(n.title=t),n.span&&!1!==i._enableUpdate&&(t=s&&!1!==n.hasChildren()?" role='button'":"",a<o.minExpandLevel?(n.lazy||(n.expanded=!0),1<a&&l.push("<span "+t+" class='fancytree-expander fancytree-expander-fixed'></span>")):l.push("<span "+t+" class='fancytree-expander'></span>"),(a=h.evalOption("checkbox",n,n,o,!1))&&!n.isStatusNode()&&(r="fancytree-checkbox",("radio"===a||n.parent&&n.parent.radiogroup)&&(r+=" fancytree-radio"),l.push("<span "+(t=s?" role='checkbox'":"")+" class='"+r+"'></span>")),void 0!==n.data.iconClass&&(n.icon?C.error("'iconClass' node option is deprecated since v2.14.0: use 'icon' only instead"):(n.warn("'iconClass' node option is deprecated since v2.14.0: use 'icon' instead"),n.icon=n.data.iconClass)),!1!==(a=h.evalOption("icon",n,n,o,!0))&&(t=s?" role='presentation'":"",r=(r=h.evalOption("iconTooltip",n,n,o,null))?" title='"+M(r)+"'":"","string"==typeof a?c.test(a)?(a="/"===a.charAt(0)?a:(o.imagePath||"")+a,l.push("<img src='"+a+"' class='fancytree-icon'"+r+" alt='' />")):l.push("<span "+t+" class='fancytree-custom-icon "+a+"'"+r+"></span>"):a.text?l.push("<span "+t+" class='fancytree-custom-icon "+(a.addClass||"")+"'"+r+">"+h.escapeHtml(a.text)+"</span>"):a.html?l.push("<span "+t+" class='fancytree-custom-icon "+(a.addClass||"")+"'"+r+">"+a.html+"</span>"):l.push("<span "+t+" class='fancytree-icon'"+r+"></span>")),s="",s=(s=o.renderTitle?o.renderTitle.call(i,{type:"renderTitle"},e)||"":s)||"<span class='fancytree-title'"+(a=(a=!0===(a=h.evalOption("tooltip",n,n,o,null))?n.title:a)?" title='"+M(a)+"'":"")+(o.titlesTabbable?" tabindex='0'":"")+">"+(o.escapeTitles?h.escapeHtml(n.title):n.title)+"</span>",l.push(s),n.span.innerHTML=l.join(""),this.nodeRenderStatus(e),o.enhanceTitle)&&(e.$title=C(">span.fancytree-title",n.span),o.enhanceTitle.call(i,{type:"enhanceTitle"},e))},nodeRenderStatus:function(e){var t,r=e.node,n=e.tree,e=e.options,i=r.hasChildren(),o=r.isLastSibling(),s=e.aria,a=e._classNames,l=[],c=r[n.statusClassPropName];c&&!1!==n._enableUpdate&&(s&&(t=C(r.tr||r.li)),l.push(a.node),n.activeNode===r&&l.push(a.active),n.focusNode===r&&l.push(a.focused),r.expanded&&l.push(a.expanded),s&&(!1===i?t.removeAttr("aria-expanded"):t.attr("aria-expanded",Boolean(r.expanded))),r.folder&&l.push(a.folder),!1!==i&&l.push(a.hasChildren),o&&l.push(a.lastsib),r.lazy&&null==r.children&&l.push(a.lazy),r.partload&&l.push(a.partload),r.partsel&&l.push(a.partsel),h.evalOption("unselectable",r,r,e,!1)&&l.push(a.unselectable),r._isLoading&&l.push(a.loading),r._error&&l.push(a.error),r.statusNodeType&&l.push(a.statusNodePrefix+r.statusNodeType),r.selected?(l.push(a.selected),s&&t.attr("aria-selected",!0)):s&&t.attr("aria-selected",!1),r.extraClasses&&l.push(r.extraClasses),l.push(!1===i?a.combinedExpanderPrefix+"n"+(o?"l":""):a.combinedExpanderPrefix+(r.expanded?"e":"c")+(r.lazy&&null==r.children?"d":"")+(o?"l":"")),l.push(a.combinedIconPrefix+(r.expanded?"e":"c")+(r.folder?"f":"")),c.className=l.join(" "),r.li)&&C(r.li).toggleClass(a.lastsib,o)},nodeSetActive:function(e,t,r){var n=e.node,i=e.tree,o=e.options,s=!0===(r=r||{}).noEvents,a=!0===r.noFocus,r=!1!==r.scrollIntoView,l=n===i.activeNode;if(l!=(t=!1!==t)){if(r&&e.originalEvent&&C(e.originalEvent.target).is("a,:checkbox")&&(n.info("Not scrolling while clicking an embedded link."),r=!1),t&&!s&&!1===this._triggerNodeEvent("beforeActivate",n,e.originalEvent))return N(n,["rejected"]);t?(i.activeNode&&(T(i.activeNode!==n,"node was active (inconsistency)"),l=C.extend({},e,{node:i.activeNode}),i.nodeSetActive(l,!1),T(null===i.activeNode,"deactivate was out of sync?")),o.activeVisible&&n.makeVisible({scrollIntoView:r}),i.activeNode=n,i.nodeRenderStatus(e),a||i.nodeSetFocus(e),s||i._triggerNodeEvent("activate",n,e.originalEvent)):(T(i.activeNode===n,"node was not active (inconsistency)"),i.activeNode=null,this.nodeRenderStatus(e),s||e.tree._triggerNodeEvent("deactivate",n,e.originalEvent))}return A(n)},nodeSetExpanded:function(n,i,e){var t,r,o,s,a,l,c=n.node,u=n.tree,d=n.options,h=!0===(e=e||{}).noAnimation,p=!0===e.noEvents;if(i=!1!==i,C(c.li).hasClass(d._classNames.animating))return c.warn("setExpanded("+i+") while animating: ignored."),N(c,["recursion"]);if(c.expanded&&i||!c.expanded&&!i)return A(c);if(i&&!c.lazy&&!c.hasChildren())return A(c);if(!i&&c.getLevel()<d.minExpandLevel)return N(c,["locked"]);if(!p&&!1===this._triggerNodeEvent("beforeExpand",c,n.originalEvent))return N(c,["rejected"]);if(h||c.isVisible()||(h=e.noAnimation=!0),r=new C.Deferred,i&&!c.expanded&&d.autoCollapse){a=c.getParentList(!1,!0),l=d.autoCollapse;try{for(d.autoCollapse=!1,o=0,s=a.length;o<s;o++)this._callHook("nodeCollapseSiblings",a[o],e)}finally{d.autoCollapse=l}}return r.done(function(){var e=c.getLastChild();i&&d.autoScroll&&!h&&e&&u._enableUpdate?e.scrollIntoView(!0,{topNode:c}).always(function(){p||n.tree._triggerNodeEvent(i?"expand":"collapse",n)}):p||n.tree._triggerNodeEvent(i?"expand":"collapse",n)}),t=function(e){var t=d._classNames,r=d.toggleEffect;if(c.expanded=i,u._callHook("treeStructureChanged",n,i?"expand":"collapse"),u._callHook("nodeRender",n,!1,!1,!0),c.ul)if("none"!==c.ul.style.display==!!c.expanded)c.warn("nodeSetExpanded: UL.style.display already set");else{if(r&&!h)return C(c.li).addClass(t.animating),void(_(C(c.ul)[r.effect])?C(c.ul)[r.effect]({duration:r.duration,always:function(){C(this).removeClass(t.animating),C(c.li).removeClass(t.animating),e()}}):(C(c.ul).stop(!0,!0),C(c.ul).parent().find(".ui-effects-placeholder").remove(),C(c.ul).toggle(r.effect,r.options,r.duration,function(){C(this).removeClass(t.animating),C(c.li).removeClass(t.animating),e()})));c.ul.style.display=c.expanded||!parent?"":"none"}e()},i&&c.lazy&&void 0===c.hasChildren()?c.load().done(function(){r.notifyWith&&r.notifyWith(c,["loaded"]),t(function(){r.resolveWith(c)})}).fail(function(e){t(function(){r.rejectWith(c,["load failed ("+e+")"])})}):t(function(){r.resolveWith(c)}),r.promise()},nodeSetFocus:function(e,t){var r,n=e.tree,i=e.node,o=n.options,s=!!e.originalEvent&&C(e.originalEvent.target).is(":input");if(t=!1!==t,n.focusNode){if(n.focusNode===i&&t)return;r=C.extend({},e,{node:n.focusNode}),n.focusNode=null,this._triggerNodeEvent("blur",r),this._callHook("nodeRenderStatus",r)}t&&(this.hasFocus()||(i.debug("nodeSetFocus: forcing container focus"),this._callHook("treeSetFocus",e,!0,{calledByNode:!0})),i.makeVisible({scrollIntoView:!1}),n.focusNode=i,o.titlesTabbable&&!s&&C(i.span).find(".fancytree-title").focus(),o.aria&&C(n.$container).attr("aria-activedescendant",C(i.tr||i.li).uniqueId().attr("id")),this._triggerNodeEvent("focus",e),document.activeElement===n.$container.get(0)||1<=C(document.activeElement,n.$container).length||C(n.$container).focus(),o.autoScroll&&i.scrollIntoView(),this._callHook("nodeRenderStatus",e))},nodeSetSelected:function(e,t,r){var n=e.node,i=e.tree,o=e.options,s=!0===(r=r||{}).noEvents,a=n.parent;if(t=!1!==t,!h.evalOption("unselectable",n,n,o,!1))return n._lastSelectIntent=t,!!n.selected!==t||3===o.selectMode&&n.partsel&&!t?s||!1!==this._triggerNodeEvent("beforeSelect",n,e.originalEvent)?(t&&1===o.selectMode?(i.lastSelectedNode&&i.lastSelectedNode.setSelected(!1),n.selected=t):3!==o.selectMode||!a||a.radiogroup||n.radiogroup?a&&a.radiogroup?n.visitSiblings(function(e){e._changeSelectStatusAttrs(t&&e===n)},!0):n.selected=t:(n.selected=t,n.fixSelection3AfterClick(r)),this.nodeRenderStatus(e),i.lastSelectedNode=t?n:null,void(s||i._triggerNodeEvent("select",e))):!!n.selected:t},nodeSetStatus:function(n,e,t,r){var i=n.node,o=n.tree;function s(e,t){var r=i.children?i.children[0]:null;r&&r.isStatusNode()?(C.extend(r,e),r.statusNodeType=t,o._callHook("nodeRenderTitle",r)):(i._setChildren([e]),o._callHook("treeStructureChanged",n,"setStatusNode"),i.children[0].statusNodeType=t,o.render()),i.children[0]}switch(e){case"ok":var a=i.children?i.children[0]:null;if(a&&a.isStatusNode()){try{i.ul&&(i.ul.removeChild(a.li),a.li=null)}catch(e){}1===i.children.length?i.children=[]:i.children.shift(),o._callHook("treeStructureChanged",n,"clearStatusNode")}i._isLoading=!1,i._error=null,i.renderStatus();break;case"loading":i.parent||s({title:o.options.strings.loading+(t?" ("+t+")":""),checkbox:!1,tooltip:r},e),i._isLoading=!0,i._error=null,i.renderStatus();break;case"error":s({title:o.options.strings.loadError+(t?" ("+t+")":""),checkbox:!1,tooltip:r},e),i._isLoading=!1,i._error={message:t,details:r},i.renderStatus();break;case"nodata":s({title:t||o.options.strings.noData,checkbox:!1,tooltip:r},e),i._isLoading=!1,i._error=null,i.renderStatus();break;default:C.error("invalid node status "+e)}},nodeToggleExpanded:function(e){return this.nodeSetExpanded(e,!e.node.expanded)},nodeToggleSelected:function(e){var t=e.node,r=!t.selected;return t.partsel&&!t.selected&&!0===t._lastSelectIntent&&(t.selected=!(r=!1)),t._lastSelectIntent=r,this.nodeSetSelected(e,r)},treeClear:function(e){var t=e.tree;t.activeNode=null,t.focusNode=null,t.$div.find(">ul.fancytree-container").empty(),t.rootNode.children=null,t._callHook("treeStructureChanged",e,"clear")},treeCreate:function(e){},treeDestroy:function(e){this.$div.find(">ul.fancytree-container").remove(),this.$source&&this.$source.removeClass("fancytree-helper-hidden")},treeInit:function(e){var r=e.tree,n=r.options;r.$container.attr("tabindex",n.tabindex),C.each(v,function(e,t){void 0!==n[t]&&(r.info("Move option "+t+" to tree"),r[t]=n[t],delete n[t])}),n.checkboxAutoHide&&r.$container.addClass("fancytree-checkbox-auto-hide"),n.rtl?r.$container.attr("DIR","RTL").addClass("fancytree-rtl"):r.$container.removeAttr("DIR").removeClass("fancytree-rtl"),n.aria&&(r.$container.attr("role","tree"),1!==n.selectMode)&&r.$container.attr("aria-multiselectable",!0),this.treeLoad(e)},treeLoad:function(e,t){var r,n,i,o=e.tree,s=e.widget.element,a=C.extend({},e,{node:this.rootNode});if(o.rootNode.children&&this.treeClear(e),t=t||this.options.source)"string"==typeof t&&C.error("Not implemented");else switch(n=s.data("type")||"html"){case"html":(i=s.find(">ul").not(".fancytree-container").first()).length?(i.addClass("ui-fancytree-source fancytree-helper-hidden"),t=C.ui.fancytree.parseHtml(i),this.data=C.extend(this.data,I(i))):(h.warn("No `source` option was passed and container does not contain `<ul>`: assuming `source: []`."),t=[]);break;case"json":t=C.parseJSON(s.text()),s.contents().filter(function(){return 3===this.nodeType}).remove(),C.isPlainObject(t)&&(T(E(t.children),"if an object is passed as source, it must contain a 'children' array (all other properties are added to 'tree.data')"),t=(r=t).children,delete r.children,C.each(v,function(e,t){void 0!==r[t]&&(o[t]=r[t],delete r[t])}),C.extend(o.data,r));break;default:C.error("Invalid data-type: "+n)}return o._triggerTreeEvent("preInit",null),this.nodeLoadChildren(a,t).done(function(){o._callHook("treeStructureChanged",e,"loadChildren"),o.render(),3===e.options.selectMode&&o.rootNode.fixSelection3FromEndNodes(),o.activeNode&&o.options.activeVisible&&o.activeNode.makeVisible(),o._triggerTreeEvent("init",null,{status:!0})}).fail(function(){o.render(),o._triggerTreeEvent("init",null,{status:!1})})},treeRegisterNode:function(e,t,r){e.tree._callHook("treeStructureChanged",e,t?"addNode":"removeNode")},treeSetFocus:function(e,t,r){(t=!1!==t)!==this.hasFocus()&&(!(this._hasFocus=t)&&this.focusNode?this.focusNode.setFocus(!1):!t||r&&r.calledByNode||C(this.$container).focus(),this.$container.toggleClass("fancytree-treefocus",t),this._triggerTreeEvent(t?"focusTree":"blurTree"),t)&&!this.activeNode&&(r=this._lastMousedownNode||this.getFirstChild())&&r.setFocus()},treeSetOption:function(e,t,r){var n=e.tree,i=!0,o=!1,s=!1;switch(t){case"aria":case"checkbox":case"icon":case"minExpandLevel":case"tabindex":s=o=!0;break;case"checkboxAutoHide":n.$container.toggleClass("fancytree-checkbox-auto-hide",!!r);break;case"escapeTitles":case"tooltip":s=!0;break;case"rtl":!1===r?n.$container.removeAttr("DIR").removeClass("fancytree-rtl"):n.$container.attr("DIR","RTL").addClass("fancytree-rtl"),s=!0;break;case"source":i=!1,n._callHook("treeLoad",n,r),s=!0}n.debug("set option "+t+"="+r+" <"+typeof r+">"),i&&(this.widget._super||C.Widget.prototype._setOption).call(this.widget,t,r),o&&n._callHook("treeCreate",n),s&&n.render(!0,!1)},treeStructureChanged:function(e,t){}}),C.widget("ui.fancytree",{options:{activeVisible:!0,ajax:{type:"GET",cache:!1,dataType:"json"},aria:!0,autoActivate:!0,autoCollapse:!1,autoScroll:!1,checkbox:!1,clickFolderMode:4,copyFunctionsToData:!1,debugLevel:null,disabled:!1,enableAspx:42,escapeTitles:!1,extensions:[],focusOnSelect:!1,generateIds:!1,icon:!0,idPrefix:"ft_",keyboard:!0,keyPathSeparator:"/",minExpandLevel:1,nodata:!0,quicksearch:!1,rtl:!1,scrollOfs:{top:0,bottom:0},scrollParent:null,selectMode:2,strings:{loading:"Loading...",loadError:"Load error!",moreData:"More...",noData:"No data."},tabindex:"0",titlesTabbable:!1,toggleEffect:{effect:"slideToggle",duration:200},tooltip:!1,treeId:null,_classNames:{active:"fancytree-active",animating:"fancytree-animating",combinedExpanderPrefix:"fancytree-exp-",combinedIconPrefix:"fancytree-ico-",error:"fancytree-error",expanded:"fancytree-expanded",focused:"fancytree-focused",folder:"fancytree-folder",hasChildren:"fancytree-has-children",lastsib:"fancytree-lastsib",lazy:"fancytree-lazy",loading:"fancytree-loading",node:"fancytree-node",partload:"fancytree-partload",partsel:"fancytree-partsel",radio:"fancytree-radio",selected:"fancytree-selected",statusNodePrefix:"fancytree-statusnode-",unselectable:"fancytree-unselectable"},lazyLoad:null,postProcess:null},_deprecationWarning:function(e){var t=this.tree;t&&3<=t.options.debugLevel&&t.warn("$().fancytree('"+e+"') is deprecated (see https://wwwendt.de/tech/fancytree/doc/jsdoc/Fancytree_Widget.html")},_create:function(){this.tree=new P(this),this.$source=this.source||"json"===this.element.data("type")?this.element:this.element.find(">ul").first();for(var e,t,r=this.options,n=r.extensions,i=(this.tree,0);i<n.length;i++){t=n[i],(e=C.ui.fancytree._extensions[t])||C.error("Could not apply extension '"+t+"' (it is not registered, did you forget to include it?)"),this.tree.options[t]=function e(t){var r,n,i,o,s=t||{},a=1,l=arguments.length;if("object"==typeof s||_(s)||(s={}),a===l)throw Error("need at least two args");for(;a<l;a++)if(null!=(r=arguments[a]))for(n in r)S(r,n)&&(o=s[n],s!==(i=r[n]))&&(i&&C.isPlainObject(i)?(o=o&&C.isPlainObject(o)?o:{},s[n]=e(o,i)):void 0!==i&&(s[n]=i));return s}({},e.options,this.tree.options[t]),T(void 0===this.tree.ext[t],"Extension name must not exist as Fancytree.ext attribute: '"+t+"'"),this.tree.ext[t]={},o=l=a=s=void 0;var o,s=this.tree,a=e,l=t;for(o in a)"function"==typeof a[o]?"function"==typeof s[o]?s[o]=R(o,s,0,a,l):"_"===o.charAt(0)?s.ext[l][o]=R(o,s,0,a,l):C.error("Could not override tree."+o+". Use prefix '_' to create tree."+l+"._"+o):"options"!==o&&(s.ext[l][o]=a[o]);0}void 0!==r.icons&&(!0===r.icon?(this.tree.warn("'icons' tree option is deprecated since v2.14.0: use 'icon' instead"),r.icon=r.icons):C.error("'icons' tree option is deprecated since v2.14.0: use 'icon' only instead")),void 0!==r.iconClass&&(r.icon?C.error("'iconClass' tree option is deprecated since v2.14.0: use 'icon' only instead"):(this.tree.warn("'iconClass' tree option is deprecated since v2.14.0: use 'icon' instead"),r.icon=r.iconClass)),void 0!==r.tabbable&&(r.tabindex=r.tabbable?"0":"-1",this.tree.warn("'tabbable' tree option is deprecated since v2.17.0: use 'tabindex='"+r.tabindex+"' instead")),this.tree._callHook("treeCreate",this.tree)},_init:function(){this.tree._callHook("treeInit",this.tree),this._bind()},_setOption:function(e,t){return this.tree._callHook("treeSetOption",this.tree,e,t)},_destroy:function(){this._unbind(),this.tree._callHook("treeDestroy",this.tree)},_unbind:function(){var e=this.tree._ns;this.element.off(e),this.tree.$container.off(e),C(document).off(e)},_bind:function(){var s=this,a=this.options,o=this.tree,e=o._ns;this._unbind(),o.$container.on("focusin"+e+" focusout"+e,function(e){var t=h.getNode(e),r="focusin"===e.type;if(!r&&t&&C(e.target).is("a"))t.debug("Ignored focusout on embedded <a> element.");else{if(r){if(o._getExpiringValue("focusin"))return void o.debug("Ignored double focusin.");o._setExpiringValue("focusin",!0,50),t||(t=o._getExpiringValue("mouseDownNode"))&&o.debug("Reconstruct mouse target for focusin from recent event.")}t?o._callHook("nodeSetFocus",o._makeHookContext(t,e),r):o.tbody&&C(e.target).parents("table.fancytree-container > thead").length?o.debug("Ignore focus event outside table body.",e):o._callHook("treeSetFocus",o,r)}}).on("selectstart"+e,"span.fancytree-title",function(e){e.preventDefault()}).on("keydown"+e,function(e){if(a.disabled||!1===a.keyboard)return!0;var t,r=o.focusNode,n=o._makeHookContext(r||o,e),i=o.phase;try{return o.phase="userEvent","preventNav"===(t=r?o._triggerNodeEvent("keydown",r,e):o._triggerTreeEvent("keydown",e))?t=!0:!1!==t&&(t=o._callHook("nodeKeydown",n)),t}finally{o.phase=i}}).on("mousedown"+e,function(e){e=h.getEventTarget(e);o._lastMousedownNode=e?e.node:null,o._setExpiringValue("mouseDownNode",o._lastMousedownNode)}).on("click"+e+" dblclick"+e,function(e){if(a.disabled)return!0;var t,r=h.getEventTarget(e),n=r.node,i=s.tree,o=i.phase;if(!n)return!0;t=i._makeHookContext(n,e);try{switch(i.phase="userEvent",e.type){case"click":return t.targetType=r.type,n.isPagingNode()?!0===i._triggerNodeEvent("clickPaging",t,e):!1!==i._triggerNodeEvent("click",t,e)&&i._callHook("nodeClick",t);case"dblclick":return t.targetType=r.type,!1!==i._triggerNodeEvent("dblclick",t,e)&&i._callHook("nodeDblclick",t)}}finally{i.phase=o}})},getActiveNode:function(){return this._deprecationWarning("getActiveNode"),this.tree.activeNode},getNodeByKey:function(e){return this._deprecationWarning("getNodeByKey"),this.tree.getNodeByKey(e)},getRootNode:function(){return this._deprecationWarning("getRootNode"),this.tree.rootNode},getTree:function(){return this._deprecationWarning("getTree"),this.tree}}),h=C.ui.fancytree,C.extend(C.ui.fancytree,{version:"2.38.3",buildType:"production",debugLevel:3,_nextId:1,_nextNodeKey:1,_extensions:{},_FancytreeClass:P,_FancytreeNodeClass:D,jquerySupports:{positionMyOfs:function(e){for(var t,r,n=C.map(x(e).split("."),function(e){return parseInt(e,10)}),i=C.map(Array.prototype.slice.call(arguments,1),function(e){return parseInt(e,10)}),o=0;o<i.length;o++)if((t=n[o]||0)!==(r=i[o]||0))return r<t;return!0}(C.ui.version,1,9)},assert:T,createTree:function(e,t){e=C(e).fancytree(t);return h.getTree(e)},debounce:function(t,r,n,i){var o;return 3===arguments.length&&"boolean"!=typeof n&&(i=n,n=!1),function(){var e=arguments;i=i||this,n&&!o&&r.apply(i,e),clearTimeout(o),o=setTimeout(function(){n||r.apply(i,e),o=null},t)}},debug:function(e){4<=C.ui.fancytree.debugLevel&&u("log",arguments)},error:function(e){1<=C.ui.fancytree.debugLevel&&u("error",arguments)},escapeHtml:function(e){return(""+e).replace(t,function(e){return n[e]})},fixPositionOptions:function(e){var t,r,n,i;return(e.offset||0<=(""+e.my+e.at).indexOf("%"))&&C.error("expected new position syntax (but '%' is not supported)"),!C.ui.fancytree.jquerySupports.positionMyOfs&&(t=/(\w+)([+-]?\d+)?\s+(\w+)([+-]?\d+)?/.exec(e.my),r=/(\w+)([+-]?\d+)?\s+(\w+)([+-]?\d+)?/.exec(e.at),n=(t[2]?+t[2]:0)+(r[2]?+r[2]:0),i=(t[4]?+t[4]:0)+(r[4]?+r[4]:0),e=C.extend({},e,{my:t[1]+" "+t[3],at:r[1]+" "+r[3]}),n||i)&&(e.offset=n+" "+i),e},getEventTarget:function(e){var t=e&&e.target?e.target.className:"",r={node:this.getNode(e.target),type:void 0};return/\bfancytree-title\b/.test(t)?r.type="title":/\bfancytree-expander\b/.test(t)?r.type=!1===r.node.hasChildren()?"prefix":"expander":/\bfancytree-checkbox\b/.test(t)?r.type="checkbox":/\bfancytree(-custom)?-icon\b/.test(t)?r.type="icon":/\bfancytree-node\b/.test(t)?r.type="title":e&&e.target&&((t=C(e.target)).is("ul[role=group]")?((r.node&&r.node.tree||h).debug("Ignoring click on outer UL."),r.node=null):t.closest(".fancytree-title").length?r.type="title":t.closest(".fancytree-checkbox").length?r.type="checkbox":t.closest(".fancytree-expander").length&&(r.type="expander")),r},getEventTargetType:function(e){return this.getEventTarget(e).type},getNode:function(e){if(e instanceof D)return e;for(e instanceof C?e=e[0]:void 0!==e.originalEvent&&(e=e.target);e;){if(e.ftnode)return e.ftnode;e=e.parentNode}return null},getTree:function(e){var t=e;return e instanceof P?e:("number"==typeof(e=void 0===e?0:e)?e=C(".fancytree-container").eq(e):"string"==typeof e?(e=C("#ft-id-"+t).eq(0)).length||(e=C(t).eq(0)):e instanceof Element||e instanceof HTMLDocument?e=C(e):e instanceof C?e=e.eq(0):void 0!==e.originalEvent&&(e=C(e.target)),(t=(e=e.closest(":ui-fancytree")).data("ui-fancytree")||e.data("fancytree"))?t.tree:null)},evalOption:function(e,t,r,n,i){var o,s=t.tree,n=n[e],r=r[e];return _(n)?(t={node:t,tree:s,widget:s.widget,options:s.widget.options,typeInfo:s.types[t.type]||{}},null==(o=n.call(s,{type:e},t))&&(o=r)):o=null==r?n:r,o=null==o?i:o},setSpanIcon:function(e,t,r){var n=C(e);"string"==typeof r?n.attr("class",t+" "+r):(r.text?n.text(""+r.text):r.html&&(e.innerHTML=r.html),n.attr("class",t+" "+(r.addClass||"")))},eventToString:function(e){var t=e.which,r=e.type,n=[];return e.altKey&&n.push("alt"),e.ctrlKey&&n.push("ctrl"),e.metaKey&&n.push("meta"),e.shiftKey&&n.push("shift"),"click"===r||"dblclick"===r?n.push(o[e.button]+r):"wheel"===r?n.push(r):i[t]||n.push(d[t]||String.fromCharCode(t).toLowerCase()),n.join("+")},info:function(e){3<=C.ui.fancytree.debugLevel&&u("info",arguments)},keyEventToString:function(e){return this.warn("keyEventToString() is deprecated: use eventToString()"),this.eventToString(e)},overrideMethod:function(e,t,r,n){var i,o=e[t]||C.noop;e[t]=function(){var e=n||this;try{return i=e._super,e._super=o,r.apply(e,arguments)}finally{e._super=i}}},parseHtml:function(s){var a,l,c,u,d,h,p,f,e=s.find(">li"),g=[];return e.each(function(){var e,t,r=C(this),n=r.find(">span",this).first(),i=n.length?null:r.find(">a").first(),o={tooltip:null,data:{}};for(n.length?o.title=n.html():i&&i.length?(o.title=i.html(),o.data.href=i.attr("href"),o.data.target=i.attr("target"),o.tooltip=i.attr("title")):(o.title=r.html(),0<=(d=o.title.search(/<ul/i))&&(o.title=o.title.substring(0,d))),o.title=x(o.title),u=0,h=m.length;u<h;u++)o[m[u]]=void 0;for(a=this.className.split(" "),c=[],u=0,h=a.length;u<h;u++)l=a[u],y[l]?o[l]=!0:c.push(l);if(o.extraClasses=c.join(" "),(p=r.attr("title"))&&(o.tooltip=p),(p=r.attr("id"))&&(o.key=p),r.attr("hideCheckbox")&&(o.checkbox=!1),(e=I(r))&&!C.isEmptyObject(e)){for(t in w)S(e,t)&&(e[w[t]]=e[t],delete e[t]);for(u=0,h=b.length;u<h;u++)p=b[u],null!=(f=e[p])&&(delete e[p],o[p]=f);C.extend(o.data,e)}(s=r.find(">ul").first()).length?o.children=C.ui.fancytree.parseHtml(s):o.children=o.lazy?void 0:null,g.push(o)}),g},registerExtension:function(e){T(null!=e.name,"extensions must have a `name` property."),T(null!=e.version,"extensions must have a `version` property."),C.ui.fancytree._extensions[e.name]=e},trim:x,unescapeHtml:function(e){var t=document.createElement("div");return t.innerHTML=e,0===t.childNodes.length?"":t.childNodes[0].nodeValue},warn:function(e){2<=C.ui.fancytree.debugLevel&&u("warn",arguments)}}),C.ui.fancytree}function T(e,t){e||(C.ui.fancytree.error(t="Fancytree assertion failed"+(t=t?": "+t:"")),C.error(t))}function S(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function _(e){return"function"==typeof e}function x(e){return null==e?"":e.trim()}function u(t,r){var n,i,t=window.console?window.console[t]:null;if(t)try{t.apply(window.console,r)}catch(e){for(i="",n=0;n<r.length;n++)i+=r[n];t(i)}}function R(e,n,t,r,i){var o,s,a;function l(){return o.apply(n,arguments)}function c(e){return o.apply(n,e)}return o=n[e],s=r[e],a=n.ext[i],function(){var e=n._local,t=n._super,r=n._superApply;try{return n._local=a,n._super=l,n._superApply=c,s.apply(n,arguments)}finally{n._local=e,n._super=t,n._superApply=r}}}function A(e,t){return(void 0===e?C.Deferred(function(){this.resolve()}):C.Deferred(function(){this.resolveWith(e,t)})).promise()}function N(e,t){return(void 0===e?C.Deferred(function(){this.reject()}):C.Deferred(function(){this.rejectWith(e,t)})).promise()}function O(e,t){return function(){e.resolveWith(t)}}function I(e){var e=C.extend({},e.data()),t=e.json;return delete e.fancytree,delete e.uiFancytree,t&&(delete e.json,e=C.extend(e,t)),e}function M(e){return(""+e).replace(r,function(e){return n[e]})}function k(t){return t=t.toLowerCase(),function(e){return 0<=e.title.toLowerCase().indexOf(t)}}function D(e,t){var r,n,i;for(this.parent=e,this.tree=e.tree,this.ul=null,this.li=null,this.statusNodeType=null,this._isLoading=!1,this._error=null,this.data={},r=0,n=b.length;r<n;r++)this[i=b[r]]=t[i];for(i in null==this.unselectableIgnore&&null==this.unselectableStatus||(this.unselectable=!0),t.hideCheckbox&&C.error("'hideCheckbox' node option was removed in v2.23.0: use 'checkbox: false'"),t.data&&C.extend(this.data,t.data),t)s[i]||!this.tree.options.copyFunctionsToData&&_(t[i])||a[i]||(this.data[i]=t[i]);null==this.key?this.tree.options.defaultKey?(this.key=""+this.tree.options.defaultKey(this),T(this.key,"defaultKey() must return a unique key")):this.key="_"+h._nextNodeKey++:this.key=""+this.key,t.active&&(T(null===this.tree.activeNode,"only one active node allowed"),this.tree.activeNode=this),t.selected&&(this.tree.lastSelectedNode=this),(e=t.children)?e.length?this._setChildren(e):this.children=this.lazy?[]:null:this.children=null,this.tree._callHook("treeRegisterNode",this.tree,!0,this)}function P(e){this.widget=e,this.$div=e.element,this.options=e.options,this.options&&(void 0!==this.options.lazyload&&C.error("The 'lazyload' event is deprecated since 2014-02-25. Use 'lazyLoad' (with uppercase L) instead."),void 0!==this.options.loaderror&&C.error("The 'loaderror' event was renamed since 2014-07-03. Use 'loadError' (with uppercase E) instead."),void 0!==this.options.fx&&C.error("The 'fx' option was replaced by 'toggleEffect' since 2014-11-30."),void 0!==this.options.removeNode)&&C.error("The 'removeNode' event was replaced by 'modifyChild' since 2.20 (2016-09-10)."),this.ext={},this.types={},this.columns={},this.data=I(this.$div),this._id=""+(this.options.treeId||C.ui.fancytree._nextId++),this._ns=".fancytree-"+this._id,this.activeNode=null,this.focusNode=null,this._hasFocus=null,this._tempCache={},this._lastMousedownNode=null,this._enableUpdate=!0,this.lastSelectedNode=null,this.systemFocusElement=null,this.lastQuicksearchTerm="",this.lastQuicksearchTime=0,this.viewport=null,this.statusClassPropName="span",this.ariaPropName="li",this.nodeContainerAttrName="li",this.$div.find(">ul.fancytree-container").remove(),this.rootNode=new D({tree:this},{title:"root",key:"root_"+this._id,children:null,expanded:!0}),this.rootNode.parent=null,e=C("<ul>",{id:"ft-id-"+this._id,class:"ui-fancytree fancytree-container fancytree-plain"}).appendTo(this.$div),this.$container=e,this.rootNode.ul=e[0],null==this.options.debugLevel&&(this.options.debugLevel=h.debugLevel)}C.ui.fancytree.warn("Fancytree: ignored duplicate include")},"function"==typeof define&&define.amd?define(["jquery","./jquery.fancytree.ui-deps"],t):"object"==typeof module&&module.exports?(require("./jquery.fancytree.ui-deps"),module.exports=t(require("jquery"))):t(jQuery),t=function(o){"use strict";return o.ui.fancytree._FancytreeClass.prototype.countSelected=function(e){this.options;return this.getSelectedNodes(e).length},o.ui.fancytree._FancytreeNodeClass.prototype.updateCounters=function(){var e=o("span.fancytree-childcounter",this.span),t=this.tree.options.childcounter,r=this.countChildren(t.deep);!(this.data.childCounter=r)&&t.hideZeros||this.isExpanded()&&t.hideExpanded?e.remove():(e=e.length?e:o("<span class='fancytree-childcounter'/>").appendTo(o("span.fancytree-icon,span.fancytree-custom-icon",this.span))).text(r),!t.deep||this.isTopLevel()||this.isRootNode()||this.parent.updateCounters()},o.ui.fancytree.prototype.widgetMethod1=function(e){this.tree;return e},o.ui.fancytree.registerExtension({name:"childcounter",version:"2.38.3",options:{deep:!0,hideZeros:!0,hideExpanded:!1},foo:42,_appendCounter:function(e){},treeInit:function(e){e.options,e.options.childcounter;this._superApply(arguments),this.$container.addClass("fancytree-ext-childcounter")},treeDestroy:function(e){this._superApply(arguments)},nodeRenderTitle:function(e,t){var r=e.node,n=e.options.childcounter,i=null==r.data.childCounter?r.countChildren(n.deep):+r.data.childCounter;this._super(e,t),!i&&n.hideZeros||r.isExpanded()&&n.hideExpanded||o("span.fancytree-icon,span.fancytree-custom-icon",r.span).append(o("<span class='fancytree-childcounter'/>").text(i))},nodeSetExpanded:function(e,t,r){var n=e.tree;e.node;return this._superApply(arguments).always(function(){n.nodeRenderTitle(e)})}}),o.ui.fancytree},"function"==typeof define&&define.amd?define(["jquery","./jquery.fancytree"],t):"object"==typeof module&&module.exports?(require("./jquery.fancytree"),module.exports=t(require("jquery"))):t(jQuery),t=function(u){"use strict";var d=u.ui.fancytree.assert;function r(e,t,r){for(var n,i,o=3&e.length,s=e.length-o,a=r,l=3432918353,c=461845907,u=0;u<s;)i=255&e.charCodeAt(u)|(255&e.charCodeAt(++u))<<8|(255&e.charCodeAt(++u))<<16|(255&e.charCodeAt(++u))<<24,++u,a=27492+(65535&(n=5*(65535&(a=(a^=i=(65535&(i=(i=(65535&i)*l+(((i>>>16)*l&65535)<<16)&4294967295)<<15|i>>>17))*c+(((i>>>16)*c&65535)<<16)&4294967295)<<13|a>>>19))+((5*(a>>>16)&65535)<<16)&4294967295))+((58964+(n>>>16)&65535)<<16);switch(i=0,o){case 3:i^=(255&e.charCodeAt(u+2))<<16;case 2:i^=(255&e.charCodeAt(u+1))<<8;case 1:a^=i=(65535&(i=(i=(65535&(i^=255&e.charCodeAt(u)))*l+(((i>>>16)*l&65535)<<16)&4294967295)<<15|i>>>17))*c+(((i>>>16)*c&65535)<<16)&4294967295}return a=2246822507*(65535&(a=(a^=e.length)^a>>>16))+((2246822507*(a>>>16)&65535)<<16)&4294967295,a=3266489909*(65535&(a^=a>>>13))+((3266489909*(a>>>16)&65535)<<16)&4294967295,a^=a>>>16,t?("0000000"+(a>>>0).toString(16)).substr(-8):a>>>0}return u.ui.fancytree._FancytreeNodeClass.prototype.getCloneList=function(e){var t,r=this.tree,n=r.refMap[this.refKey]||null,i=r.keyMap;return n&&(t=this.key,e?n=u.map(n,function(e){return i[e]}):(n=u.map(n,function(e){return e===t?null:i[e]})).length<1&&(n=null)),n},u.ui.fancytree._FancytreeNodeClass.prototype.isClone=function(){var e=this.refKey||null,e=e&&this.tree.refMap[e]||null;return!!(e&&1<e.length)},u.ui.fancytree._FancytreeNodeClass.prototype.reRegister=function(t,e){t=null==t?null:""+t,e=null==e?null:""+e;var r=this.tree,n=this.key,i=this.refKey,o=r.keyMap,r=r.refMap,s=r[i]||null,a=!1;return null!=t&&t!==this.key&&(o[t]&&u.error("[ext-clones] reRegister("+t+"): already exists: "+this),delete o[n],o[t]=this,s&&(r[i]=u.map(s,function(e){return e===n?t:e})),this.key=t,a=!0),null!=e&&e!==this.refKey&&(s&&(1===s.length?delete r[i]:r[i]=u.map(s,function(e){return e===n?null:e})),r[e]?r[e].append(t):r[e]=[this.key],this.refKey=e,a=!0),a},u.ui.fancytree._FancytreeNodeClass.prototype.setRefKey=function(e){return this.reRegister(null,e)},u.ui.fancytree._FancytreeClass.prototype.getNodesByRef=function(e,t){var r=this.keyMap,e=this.refMap[e]||null;return e=e&&(e=t?u.map(e,function(e){e=r[e];return e.isDescendantOf(t)?e:null}):u.map(e,function(e){return r[e]})).length<1?null:e},u.ui.fancytree._FancytreeClass.prototype.changeRefKey=function(e,t){var r,n=this.keyMap,i=this.refMap[e]||null;if(i){for(r=0;r<i.length;r++)n[i[r]].refKey=t;delete this.refMap[e],this.refMap[t]=i}},u.ui.fancytree.registerExtension({name:"clones",version:"2.38.3",options:{highlightActiveClones:!0,highlightClones:!1},treeCreate:function(e){this._superApply(arguments),e.tree.refMap={},e.tree.keyMap={}},treeInit:function(e){this.$container.addClass("fancytree-ext-clones"),d(null==e.options.defaultKey),e.options.defaultKey=function(e){return t=e,"id_"+(e=r(t=(t=u.map(e.getParentList(!1,!0),function(e){return e.refKey||e.key})).join("/"),!0))+r(e+t,!0);var t},this._superApply(arguments)},treeClear:function(e){return e.tree.refMap={},e.tree.keyMap={},this._superApply(arguments)},treeRegisterNode:function(e,t,r){var n,i,o=e.tree,s=o.keyMap,a=o.refMap,l=r.key,c=r&&null!=r.refKey?""+r.refKey:null;return r.isStatusNode()||(t?(null!=s[r.key]&&(i=s[r.key],i="clones.treeRegisterNode: duplicate key '"+r.key+"': /"+r.getPath(!0)+" => "+i.getPath(!0),o.error(i),u.error(i)),s[l]=r,c&&((n=a[c])?(n.push(l),2===n.length&&e.options.clones.highlightClones&&s[n[0]].renderStatus()):a[c]=[l])):(null==s[l]&&u.error("clones.treeRegisterNode: node.key not registered: "+r.key),delete s[l],c&&(n=a[c])&&((o=n.length)<=1?(d(1===o),d(n[0]===l),delete a[c]):(function(e,t){for(var r=e.length-1;0<=r;r--)if(e[r]===t)return e.splice(r,1)}(n,l),2===o&&e.options.clones.highlightClones&&s[n[0]].renderStatus())))),this._super(e,t,r)},nodeRenderStatus:function(e){var t=e.node,r=this._super(e);return e.options.clones.highlightClones&&(e=u(t[e.tree.statusClassPropName])).length&&t.isClone()&&e.addClass("fancytree-clone"),r},nodeSetActive:function(e,r,t){var n=e.tree.statusClassPropName,i=e.node,o=this._superApply(arguments);return e.options.clones.highlightActiveClones&&i.isClone()&&u.each(i.getCloneList(!0),function(e,t){u(t[n]).toggleClass("fancytree-active-clone",!1!==r)}),o}}),u.ui.fancytree},"function"==typeof define&&define.amd?define(["jquery","./jquery.fancytree"],t):"object"==typeof module&&module.exports?(require("./jquery.fancytree"),module.exports=t(require("jquery"))):t(jQuery),t=function(f){"use strict";var s,a,g=f.ui.fancytree,o=/Mac/.test(navigator.platform),l="fancytree-drag-source",c="fancytree-drag-remove",m="fancytree-drop-accept",y="fancytree-drop-after",v="fancytree-drop-before",b="fancytree-drop-over",w="fancytree-drop-reject",C="fancytree-drop-target",u="application/x-fancytree-node",E=null,d=null,h=null,p=null,T=null,S=null,_=null,x=null,R=null,A=null;function N(){h=d=S=x=_=A=T=null,p&&p.removeClass(l+" "+c),p=null,E&&E.hide(),a&&(a.remove(),a=null)}function O(e){return 0===e?"":0<e?"+"+e:""+e}function I(e,t){var r,n=t.tree,i=t.dataTransfer;"dragstart"===e.type?(t.effectAllowed=n.options.dnd5.effectAllowed,t.dropEffect=n.options.dnd5.dropEffectDefault):(t.effectAllowed=x,t.dropEffect=_),t.dropEffectSuggested=(e=e,r=(n=n).options.dnd5.dropEffectDefault,o?e.metaKey&&e.altKey||e.ctrlKey?r="link":e.metaKey?r="move":e.altKey&&(r="copy"):e.ctrlKey?r="copy":e.shiftKey?r="move":e.altKey&&(r="link"),r!==S&&n.info("evalEffectModifiers: "+e.type+" - evalEffectModifiers(): "+S+" -> "+r),S=r),t.isMove="move"===t.dropEffect,t.files=i.files||[]}function M(e,t,r){var n=t.tree,i=t.dataTransfer;"dragstart"!==e.type&&x!==t.effectAllowed&&n.warn("effectAllowed should only be changed in dragstart event: "+e.type+": data.effectAllowed changed from "+x+" -> "+t.effectAllowed),!1===r&&(n.info("applyDropEffectCallback: allowDrop === false"),t.effectAllowed="none",t.dropEffect="none"),t.isMove="move"===t.dropEffect,"dragstart"===e.type&&(x=t.effectAllowed,_=t.dropEffect),i.effectAllowed=x,i.dropEffect=_}function k(e,t){if(t.options.dnd5.scroll&&(p=t.tree,a=e,h=p.options.dnd5,s=p.$scrollParent[0],c=h.scrollSensitivity,h=h.scrollSpeed,n=0,s!==document&&"HTML"!==s.tagName?(o=p.$scrollParent.offset(),u=s.scrollTop,o.top+s.offsetHeight-a.pageY<c?0<s.scrollHeight-p.$scrollParent.innerHeight()-u&&(s.scrollTop=n=u+h):0<u&&a.pageY-o.top<c&&(s.scrollTop=n=u-h)):0<(u=f(document).scrollTop())&&a.pageY-u<c?(n=u-h,f(document).scrollTop(n)):f(window).height()-(a.pageY-u)<c&&(n=u+h,f(document).scrollTop(n)),n)&&p.debug("autoScroll: "+n+"px"),!t.node)return t.tree.warn("Ignored dragover for non-node"),R;var r,n,i,o=null,s=t.tree,a=s.options,l=a.dnd5,c=t.node,u=t.otherNode,d="center",h=f(c.span),p=h.find("span.fancytree-title");if(!1===T)return s.debug("Ignored dragover, since dragenter returned false."),!1;if("string"==typeof T&&f.error("assert failed: dragenter returned string"),n=h.offset(),i=(e.pageY-n.top)/h.height(),void 0===e.pageY&&s.warn("event.pageY is undefined: see issue #1013."),T.after&&.75<i||!T.over&&T.after&&.5<i?o="after":T.before&&i<=.25||!T.over&&T.before&&i<=.5?o="before":T.over&&(o="over"),l.preventVoidMoves&&"move"===t.dropEffect&&(c===u?(c.debug("Drop over source node prevented."),o=null):"before"===o&&u&&c===u.getNextSibling()?(c.debug("Drop after source node prevented."),o=null):"after"===o&&u&&c===u.getPrevSibling()?(c.debug("Drop before source node prevented."),o=null):"over"===o&&u&&u.parent===c&&u.isLastSibling()&&(c.debug("Drop last child over own parent prevented."),o=null)),(t.hitMode=o)&&l.dragOver&&(I(e,t),l.dragOver(c,t),M(e,t,!!o),o=t.hitMode),"after"===(R=o)||"before"===o||"over"===o){switch(r=l.dropMarkerOffsetX||0,o){case"before":d="top",r+=l.dropMarkerInsertOffsetX||0;break;case"after":d="bottom",r+=l.dropMarkerInsertOffsetX||0}i={my:"left"+O(r)+" center",at:"left "+d,of:p},a.rtl&&(i.my="right"+O(-r)+" center",i.at="right "+d),E.toggleClass(y,"after"===o).toggleClass(b,"over"===o).toggleClass(v,"before"===o).show().position(g.fixPositionOptions(i))}else E.hide();return f(c.span).toggleClass(C,"after"===o||"before"===o||"over"===o).toggleClass(y,"after"===o).toggleClass(v,"before"===o).toggleClass(m,"over"===o).toggleClass(w,!1===o),o}function D(e){var t,r=this,n=r.options.dnd5,i=null,o=g.getNode(e),s=e.dataTransfer||e.originalEvent.dataTransfer,a={tree:r,node:o,options:r.options,originalEvent:e.originalEvent,widget:r.widget,hitMode:T,dataTransfer:s,otherNode:d||null,otherNodeList:h||null,otherNodeData:null,useDefaultImage:!0,dropEffect:void 0,dropEffectSuggested:void 0,effectAllowed:void 0,files:null,isCancelled:void 0,isMove:void 0};switch(e.type){case"dragenter":A=null,o?(f(o.span).addClass(b).removeClass(m+" "+w),l=0<=f.inArray(u,s.types),n.preventNonNodes&&!l?(o.debug("Reject dropping a non-node."),T=!1):!n.preventForeignNodes||d&&d.tree===o.tree?n.preventSameParent&&a.otherNode&&a.otherNode.tree===o.tree&&o.parent===a.otherNode.parent?(o.debug("Reject dropping as sibling (same parent)."),T=!1):n.preventRecursion&&a.otherNode&&a.otherNode.tree===o.tree&&o.isDescendantOf(a.otherNode)?(o.debug("Reject dropping below own ancestor."),T=!1):n.preventLazyParents&&!o.isLoaded()?(o.warn("Drop over unloaded target node prevented."),T=!1):(E.show(),I(e,a),l=n.dragEnter(o,a),l=!!(l=l)&&(l=f.isPlainObject(l)?{over:!!l.over,before:!!l.before,after:!!l.after}:Array.isArray(l)?{over:0<=f.inArray("over",l),before:0<=f.inArray("before",l),after:0<=f.inArray("after",l)}:{over:!0===l||"over"===l,before:!0===l||"before"===l,after:!0===l||"after"===l},0!==Object.keys(l).length)&&l,M(e,a,i=(T=l)&&(l.over||l.before||l.after))):(o.debug("Reject dropping a foreign node."),T=!1)):(r.debug("Ignore non-node "+e.type+": "+e.target.tagName+"."+e.target.className),T=!1);break;case"dragover":o?(I(e,a),i=!!(R=k(e,a)),("over"===R||!1===R)&&!o.expanded&&!1!==o.hasChildren()?A?!(n.autoExpandMS&&Date.now()-A>n.autoExpandMS)||o.isLoading()||n.dragExpand&&!1===n.dragExpand(o,a)||o.setExpanded():A=Date.now():A=null):r.debug("Ignore non-node "+e.type+": "+e.target.tagName+"."+e.target.className);break;case"dragleave":o?f(o.span).hasClass(b)?(f(o.span).removeClass(b+" "+m+" "+w),o.scheduleAction("cancel"),n.dragLeave(o,a),E.hide()):o.debug("Ignore dragleave (multi)."):r.debug("Ignore non-node "+e.type+": "+e.target.tagName+"."+e.target.className);break;case"drop":if(0<=f.inArray(u,s.types)&&(t=s.getData(u),r.info(e.type+": getData('application/x-fancytree-node'): '"+t+"'")),t||(t=s.getData("text"),r.info(e.type+": getData('text'): '"+t+"'")),t)try{void 0!==(c=JSON.parse(t)).title&&(a.otherNodeData=c)}catch(e){}r.debug(e.type+": nodeData: '"+t+"', otherNodeData: ",a.otherNodeData),f(o.span).removeClass(b+" "+m+" "+w),a.hitMode=R,I(e,a),a.isCancelled=!R;var l=d&&d.span,c=d&&d.tree;n.dragDrop(o,a),e.preventDefault(),l&&!document.body.contains(l)&&(c===r?(r.debug("Drop handler removed source element: generating dragEnd."),n.dragEnd(d,a)):r.warn("Drop handler removed source element: dragend event may be lost.")),N()}if(i)return e.preventDefault(),!1}return f.ui.fancytree.getDragNodeList=function(){return h||[]},f.ui.fancytree.getDragNode=function(){return d},f.ui.fancytree.registerExtension({name:"dnd5",version:"2.38.3",options:{autoExpandMS:1500,dropMarkerInsertOffsetX:-16,dropMarkerOffsetX:-24,dropMarkerParent:"body",multiSource:!1,effectAllowed:"all",dropEffectDefault:"move",preventForeignNodes:!1,preventLazyParents:!0,preventNonNodes:!1,preventRecursion:!0,preventSameParent:!1,preventVoidMoves:!0,scroll:!0,scrollSensitivity:20,scrollSpeed:5,setTextTypeJson:!1,sourceCopyHook:null,dragStart:null,dragDrag:f.noop,dragEnd:f.noop,dragEnter:null,dragOver:f.noop,dragExpand:f.noop,dragDrop:f.noop,dragLeave:f.noop},treeInit:function(e){var t=e.tree,r=e.options,n=r.glyph||null,i=r.dnd5;0<=f.inArray("dnd",r.extensions)&&f.error("Extensions 'dnd' and 'dnd5' are mutually exclusive."),i.dragStop&&f.error("dragStop is not used by ext-dnd5. Use dragEnd instead."),null!=i.preventRecursiveMoves&&f.error("preventRecursiveMoves was renamed to preventRecursion."),i.dragStart&&g.overrideMethod(e.options,"createNode",function(e,t){this._super.apply(this,arguments),t.node.span?t.node.span.draggable=!0:t.node.warn("Cannot add `draggable`: no span tag")}),this._superApply(arguments),this.$container.addClass("fancytree-ext-dnd5"),e=f("<span>").appendTo(this.$container),this.$scrollParent=e.scrollParent(),e.remove(),(E=f("#fancytree-drop-marker")).length||(E=f("<div id='fancytree-drop-marker'></div>").hide().css({"z-index":1e3,"pointer-events":"none"}).prependTo(i.dropMarkerParent),n&&g.setSpanIcon(E[0],n.map._addClass,n.map.dropMarker)),E.toggleClass("fancytree-rtl",!!r.rtl),i.dragStart&&t.$container.on("dragstart drag dragend",function(e){var t=this.options.dnd5,r=g.getNode(e),n=e.dataTransfer||e.originalEvent.dataTransfer,i={tree:this,node:r,options:this.options,originalEvent:e.originalEvent,widget:this.widget,dataTransfer:n,useDefaultImage:!0,dropEffect:void 0,dropEffectSuggested:void 0,effectAllowed:void 0,files:void 0,isCancelled:void 0,isMove:void 0};switch(e.type){case"dragstart":if(!r)return this.info("Ignored dragstart on a non-node."),!1;d=r,h=!1===t.multiSource?[r]:!0===t.multiSource?r.isSelected()?this.getSelectedNodes():[r]:t.multiSource(r,i),(p=f(f.map(h,function(e){return e.span}))).addClass(l);var o=r.toDict(!0,t.sourceCopyHook);o.treeId=r.tree._id,o=JSON.stringify(o);try{n.setData(u,o),n.setData("text/html",f(r.span).html()),n.setData("text/plain",r.title)}catch(e){this.warn("Could not set data (IE only accepts 'text') - "+e)}return(t.setTextTypeJson?n.setData("text",o):n.setData("text",r.title),I(e,i),!1===t.dragStart(r,i))?(N(),!1):(M(e,i),a=null,i.useDefaultImage&&(s=f(r.span).find(".fancytree-title"),h&&1<h.length&&(a=f("<span class='fancytree-childcounter'/>").text("+"+(h.length-1)).appendTo(s)),n.setDragImage)&&n.setDragImage(s[0],-10,-10),!0);case"drag":I(e,i),t.dragDrag(r,i),M(e,i),p.toggleClass(c,i.isMove);break;case"dragend":I(e,i),N(),i.isCancelled=!R,t.dragEnd(r,i,!R)}}.bind(t)),i.dragEnter&&t.$container.on("dragenter dragover dragleave drop",D.bind(t))}}),f.ui.fancytree},"function"==typeof define&&define.amd?define(["jquery","./jquery.fancytree"],t):"object"==typeof module&&module.exports?(require("./jquery.fancytree"),module.exports=t(require("jquery"))):t(jQuery),t=function(c){"use strict";var t=/Mac/.test(navigator.platform),u=c.ui.fancytree.escapeHtml,d=c.ui.fancytree.trim,a=c.ui.fancytree.unescapeHtml;return c.ui.fancytree._FancytreeNodeClass.prototype.editStart=function(){var t,r=this,e=this.tree,n=e.ext.edit,i=e.options.edit,o=c(".fancytree-title",r.span),s={node:r,tree:e,options:e.options,isNew:c(r[e.statusClassPropName]).hasClass("fancytree-edit-new"),orgTitle:r.title,input:null,dirty:!1};if(!1===i.beforeEdit.call(r,{type:"beforeEdit"},s))return!1;c.ui.fancytree.assert(!n.currentNode,"recursive edit"),n.currentNode=this,n.eventData=s,e.widget._unbind(),n.lastDraggableAttrValue=r.span.draggable,n.lastDraggableAttrValue&&(r.span.draggable=!1),c(document).on("mousedown.fancytree-edit",function(e){c(e.target).hasClass("fancytree-edit-input")||r.editEnd(!0,e)}),t=c("<input />",{class:"fancytree-edit-input",type:"text",value:e.options.escapeTitles?s.orgTitle:a(s.orgTitle)}),n.eventData.input=t,null!=i.adjustWidthOfs&&t.width(o.width()+i.adjustWidthOfs),null!=i.inputCss&&t.css(i.inputCss),o.html(t),t.focus().change(function(e){t.addClass("fancytree-edit-dirty")}).on("keydown",function(e){switch(e.which){case c.ui.keyCode.ESCAPE:r.editEnd(!1,e);break;case c.ui.keyCode.ENTER:return r.editEnd(!0,e),!1}e.stopPropagation()}).blur(function(e){return r.editEnd(!0,e)}),i.edit.call(r,{type:"edit"},s)},c.ui.fancytree._FancytreeNodeClass.prototype.editEnd=function(e,t){var r,n=this,i=this.tree,o=i.ext.edit,s=o.eventData,a=i.options.edit,l=c(".fancytree-title",n.span).find("input.fancytree-edit-input");return a.trim&&l.val(d(l.val())),r=l.val(),s.dirty=r!==n.title,s.originalEvent=t,!1===e?s.save=!1:s.isNew?s.save=""!==r:s.save=s.dirty&&""!==r,!1!==a.beforeClose.call(n,{type:"beforeClose"},s)&&!(s.save&&!1===a.save.call(n,{type:"save"},s)||(l.removeClass("fancytree-edit-dirty").off(),c(document).off(".fancytree-edit"),(s.save?(n.setTitle(i.options.escapeTitles?r:u(r)),n):s.isNew?(n.remove(),n=s.node=null,o.relatedNode):(n.renderTitle(),n)).setFocus(),o.eventData=null,o.currentNode=null,o.relatedNode=null,i.widget._bind(),n&&o.lastDraggableAttrValue&&(n.span.draggable=!0),i.$container.get(0).focus({preventScroll:!0}),s.input=null,a.close.call(n,{type:"close"},s),0))},c.ui.fancytree._FancytreeNodeClass.prototype.editCreateNode=function(e,t){var r,n=this.tree,i=this;e=e||"child",null==t?t={title:""}:"string"==typeof t?t={title:t}:c.ui.fancytree.assert(c.isPlainObject(t)),"child"!==e||this.isExpanded()||!1===this.hasChildren()?((r=this.addNode(t,e)).match=!0,c(r[n.statusClassPropName]).removeClass("fancytree-hide").addClass("fancytree-match"),r.makeVisible().done(function(){c(r[n.statusClassPropName]).addClass("fancytree-edit-new"),i.tree.ext.edit.relatedNode=i,r.editStart()})):this.setExpanded().done(function(){i.editCreateNode(e,t)})},c.ui.fancytree._FancytreeClass.prototype.isEditing=function(){return this.ext.edit?this.ext.edit.currentNode:null},c.ui.fancytree._FancytreeNodeClass.prototype.isEditing=function(){return!!this.tree.ext.edit&&this.tree.ext.edit.currentNode===this},c.ui.fancytree.registerExtension({name:"edit",version:"2.38.3",options:{adjustWidthOfs:4,allowEmpty:!1,inputCss:{minWidth:"3em"},triggerStart:["f2","mac+enter","shift+click"],trim:!0,beforeClose:c.noop,beforeEdit:c.noop,close:c.noop,edit:c.noop,save:c.noop},currentNode:null,treeInit:function(e){var n=e.tree;this._superApply(arguments),this.$container.addClass("fancytree-ext-edit").on("fancytreebeforeupdateviewport",function(e,t){var r=n.isEditing();r&&(r.info("Cancel edit due to scroll event."),r.editEnd(!1,e))})},nodeClick:function(e){var t=c.ui.fancytree.eventToString(e.originalEvent),r=e.options.edit.triggerStart;return"shift+click"===t&&0<=c.inArray("shift+click",r)&&e.originalEvent.shiftKey||"click"===t&&0<=c.inArray("clickActive",r)&&e.node.isActive()&&!e.node.isEditing()&&c(e.originalEvent.target).hasClass("fancytree-title")?(e.node.editStart(),!1):this._superApply(arguments)},nodeDblclick:function(e){return 0<=c.inArray("dblclick",e.options.edit.triggerStart)?(e.node.editStart(),!1):this._superApply(arguments)},nodeKeydown:function(e){switch(e.originalEvent.which){case 113:if(0<=c.inArray("f2",e.options.edit.triggerStart))return e.node.editStart(),!1;break;case c.ui.keyCode.ENTER:if(0<=c.inArray("mac+enter",e.options.edit.triggerStart)&&t)return e.node.editStart(),!1}return this._superApply(arguments)}}),c.ui.fancytree},"function"==typeof define&&define.amd?define(["jquery","./jquery.fancytree"],t):"object"==typeof module&&module.exports?(require("./jquery.fancytree"),module.exports=t(require("jquery"))):t(jQuery),t=function(m){"use strict";var y="__not_found__",v=m.ui.fancytree.escapeHtml,b="￷",w="￸";function C(e){return(e+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}function E(e,t,r){for(var n=[],i=1;i<t.length;i++){var o=t[i].length+(1===i?0:1)+(n[n.length-1]||0);n.push(o)}var s=e.split("");return n.forEach(r?function(e){s[e]=b+s[e]+w}:function(e){s[e]="<mark>"+s[e]+"</mark>"}),s.join("")}return m.ui.fancytree._FancytreeClass.prototype._applyFilterImpl=function(n,i,e){var t,o,s,a,l,c,r,u=0,d=this.options,h=d.escapeTitles,p=d.autoCollapse,f=m.extend({},d.filter,e),e="hide"===f.mode,g=!!f.leavesOnly&&!i;if("string"==typeof n){if(""===n)return this.warn("Fancytree passing an empty string as a filter is handled as clearFilter()."),void this.clearFilter();r=f.fuzzy?n.split("").map(C).reduce(function(e,t){return e+"([^"+t+"]*)"+t},""):C(n),o=new RegExp(r,"i"),s=new RegExp(C(n),"gi"),h&&(a=new RegExp(C(b),"g"),l=new RegExp(C(w),"g")),n=function(e){var t,r;return!!e.title&&((t=(r=h?e.title:0<=(r=e.title).indexOf(">")?m("<div/>").html(r).text():r).match(o))&&f.highlight&&(h?(c=f.fuzzy?E(r,t,h):r.replace(s,function(e){return b+e+w}),e.titleWithHighlight=v(c).replace(a,"<mark>").replace(l,"</mark>")):f.fuzzy?e.titleWithHighlight=E(r,t):e.titleWithHighlight=r.replace(s,function(e){return"<mark>"+e+"</mark>"})),!!t)}}return this.enableFilter=!0,this.lastFilterArgs=arguments,r=this.enableUpdate(!1),this.$div.addClass("fancytree-ext-filter"),e?this.$div.addClass("fancytree-ext-filter-hide"):this.$div.addClass("fancytree-ext-filter-dimm"),this.$div.toggleClass("fancytree-ext-filter-hide-expanders",!!f.hideExpanders),this.rootNode.subMatchCount=0,this.visit(function(e){delete e.match,delete e.titleWithHighlight,e.subMatchCount=0}),(t=this.getRootNode()._findDirectChild(y))&&t.remove(),d.autoCollapse=!1,this.visit(function(t){if(!g||null==t.children){var e=n(t),r=!1;if("skip"===e)return t.visit(function(e){e.match=!1},!0),"skip";e||!i&&"branch"!==e||!t.parent.match||(r=e=!0),e&&(u++,t.match=!0,t.visitParents(function(e){e!==t&&(e.subMatchCount+=1),!f.autoExpand||r||e.expanded||(e.setExpanded(!0,{noAnimation:!0,noEvents:!0,scrollIntoView:!1}),e._filterAutoExpanded=!0)},!0))}}),d.autoCollapse=p,0===u&&f.nodata&&e&&(!0===(t="function"==typeof(t=f.nodata)?t():t)?t={}:"string"==typeof t&&(t={title:t}),t=m.extend({statusNodeType:"nodata",key:y,title:this.options.strings.noData},t),this.getRootNode().addNode(t).match=!0),this._callHook("treeStructureChanged",this,"applyFilter"),this.enableUpdate(r),u},m.ui.fancytree._FancytreeClass.prototype.filterNodes=function(e,t){return"boolean"==typeof t&&(t={leavesOnly:t},this.warn("Fancytree.filterNodes() leavesOnly option is deprecated since 2.9.0 / 2015-04-19. Use opts.leavesOnly instead.")),this._applyFilterImpl(e,!1,t)},m.ui.fancytree._FancytreeClass.prototype.filterBranches=function(e,t){return this._applyFilterImpl(e,!0,t)},m.ui.fancytree._FancytreeClass.prototype.updateFilter=function(){this.enableFilter&&this.lastFilterArgs&&this.options.filter.autoApply?this._applyFilterImpl.apply(this,this.lastFilterArgs):this.warn("updateFilter(): no filter active.")},m.ui.fancytree._FancytreeClass.prototype.clearFilter=function(){var t,e=this.getRootNode()._findDirectChild(y),r=this.options.escapeTitles,n=this.options.enhanceTitle,i=this.enableUpdate(!1);e&&e.remove(),delete this.rootNode.match,delete this.rootNode.subMatchCount,this.visit(function(e){e.match&&e.span&&(t=m(e.span).find(">span.fancytree-title"),r?t.text(e.title):t.html(e.title),n)&&n({type:"enhanceTitle"},{node:e,$title:t}),delete e.match,delete e.subMatchCount,delete e.titleWithHighlight,e.$subMatchBadge&&(e.$subMatchBadge.remove(),delete e.$subMatchBadge),e._filterAutoExpanded&&e.expanded&&e.setExpanded(!1,{noAnimation:!0,noEvents:!0,scrollIntoView:!1}),delete e._filterAutoExpanded}),this.enableFilter=!1,this.lastFilterArgs=null,this.$div.removeClass("fancytree-ext-filter fancytree-ext-filter-dimm fancytree-ext-filter-hide"),this._callHook("treeStructureChanged",this,"clearFilter"),this.enableUpdate(i)},m.ui.fancytree._FancytreeClass.prototype.isFilterActive=function(){return!!this.enableFilter},m.ui.fancytree._FancytreeNodeClass.prototype.isMatched=function(){return!(this.tree.enableFilter&&!this.match)},m.ui.fancytree.registerExtension({name:"filter",version:"2.38.3",options:{autoApply:!0,autoExpand:!1,counter:!0,fuzzy:!1,hideExpandedCounter:!0,hideExpanders:!1,highlight:!0,leavesOnly:!1,nodata:!0,mode:"dimm"},nodeLoadChildren:function(e,t){var r=e.tree;return this._superApply(arguments).done(function(){r.enableFilter&&r.lastFilterArgs&&e.options.filter.autoApply&&r._applyFilterImpl.apply(r,r.lastFilterArgs)})},nodeSetExpanded:function(e,t,r){var n=e.node;return delete n._filterAutoExpanded,!t&&e.options.filter.hideExpandedCounter&&n.$subMatchBadge&&n.$subMatchBadge.show(),this._superApply(arguments)},nodeRenderStatus:function(e){var t=e.node,r=e.tree,n=e.options.filter,i=m(t.span).find("span.fancytree-title"),o=m(t[r.statusClassPropName]),s=e.options.enhanceTitle,a=e.options.escapeTitles,e=this._super(e);return o.length&&r.enableFilter&&(o.toggleClass("fancytree-match",!!t.match).toggleClass("fancytree-submatch",!!t.subMatchCount).toggleClass("fancytree-hide",!(t.match||t.subMatchCount)),!n.counter||!t.subMatchCount||t.isExpanded()&&n.hideExpandedCounter?t.$subMatchBadge&&t.$subMatchBadge.hide():(t.$subMatchBadge||(t.$subMatchBadge=m("<span class='fancytree-childcounter'/>"),m("span.fancytree-icon, span.fancytree-custom-icon",t.span).append(t.$subMatchBadge)),t.$subMatchBadge.show().text(t.subMatchCount)),!t.span||t.isEditing&&t.isEditing.call(t)||(t.titleWithHighlight?i.html(t.titleWithHighlight):a?i.text(t.title):i.html(t.title),s&&s({type:"enhanceTitle"},{node:t,$title:i}))),e}}),m.ui.fancytree},"function"==typeof define&&define.amd?define(["jquery","./jquery.fancytree"],t):"object"==typeof module&&module.exports?(require("./jquery.fancytree"),module.exports=t(require("jquery"))):t(jQuery),t=function(l){"use strict";var a=l.ui.fancytree,r={awesome3:{_addClass:"",checkbox:"icon-check-empty",checkboxSelected:"icon-check",checkboxUnknown:"icon-check icon-muted",dragHelper:"icon-caret-right",dropMarker:"icon-caret-right",error:"icon-exclamation-sign",expanderClosed:"icon-caret-right",expanderLazy:"icon-angle-right",expanderOpen:"icon-caret-down",loading:"icon-refresh icon-spin",nodata:"icon-meh",noExpander:"",radio:"icon-circle-blank",radioSelected:"icon-circle",doc:"icon-file-alt",docOpen:"icon-file-alt",folder:"icon-folder-close-alt",folderOpen:"icon-folder-open-alt"},awesome4:{_addClass:"fa",checkbox:"fa-square-o",checkboxSelected:"fa-check-square-o",checkboxUnknown:"fa-square fancytree-helper-indeterminate-cb",dragHelper:"fa-arrow-right",dropMarker:"fa-long-arrow-right",error:"fa-warning",expanderClosed:"fa-caret-right",expanderLazy:"fa-angle-right",expanderOpen:"fa-caret-down",loading:{html:"<span class='fa fa-spinner fa-pulse' />"},nodata:"fa-meh-o",noExpander:"",radio:"fa-circle-thin",radioSelected:"fa-circle",doc:"fa-file-o",docOpen:"fa-file-o",folder:"fa-folder-o",folderOpen:"fa-folder-open-o"},awesome5:{_addClass:"",checkbox:"far fa-square",checkboxSelected:"far fa-check-square",checkboxUnknown:"fas fa-square fancytree-helper-indeterminate-cb",radio:"far fa-circle",radioSelected:"fas fa-circle",radioUnknown:"far fa-dot-circle",dragHelper:"fas fa-arrow-right",dropMarker:"fas fa-long-arrow-alt-right",error:"fas fa-exclamation-triangle",expanderClosed:"fas fa-caret-right",expanderLazy:"fas fa-angle-right",expanderOpen:"fas fa-caret-down",loading:"fas fa-spinner fa-pulse",nodata:"far fa-meh",noExpander:"",doc:"far fa-file",docOpen:"far fa-file",folder:"far fa-folder",folderOpen:"far fa-folder-open"},bootstrap3:{_addClass:"glyphicon",checkbox:"glyphicon-unchecked",checkboxSelected:"glyphicon-check",checkboxUnknown:"glyphicon-expand fancytree-helper-indeterminate-cb",dragHelper:"glyphicon-play",dropMarker:"glyphicon-arrow-right",error:"glyphicon-warning-sign",expanderClosed:"glyphicon-menu-right",expanderLazy:"glyphicon-menu-right",expanderOpen:"glyphicon-menu-down",loading:"glyphicon-refresh fancytree-helper-spin",nodata:"glyphicon-info-sign",noExpander:"",radio:"glyphicon-remove-circle",radioSelected:"glyphicon-ok-circle",doc:"glyphicon-file",docOpen:"glyphicon-file",folder:"glyphicon-folder-close",folderOpen:"glyphicon-folder-open"},material:{_addClass:"material-icons",checkbox:{text:"check_box_outline_blank"},checkboxSelected:{text:"check_box"},checkboxUnknown:{text:"indeterminate_check_box"},dragHelper:{text:"play_arrow"},dropMarker:{text:"arrow-forward"},error:{text:"warning"},expanderClosed:{text:"chevron_right"},expanderLazy:{text:"last_page"},expanderOpen:{text:"expand_more"},loading:{text:"autorenew",addClass:"fancytree-helper-spin"},nodata:{text:"info"},noExpander:{text:""},radio:{text:"radio_button_unchecked"},radioSelected:{text:"radio_button_checked"},doc:{text:"insert_drive_file"},docOpen:{text:"insert_drive_file"},folder:{text:"folder"},folderOpen:{text:"folder_open"}}};function c(e,t,r,n,i){var n=n.map,o=n[i],s=l(t),a=s.find(".fancytree-childcounter"),r=r+" "+(n._addClass||"");"string"==typeof(o="function"==typeof o?o.call(this,e,t,i):o)?(t.innerHTML="",s.attr("class",r+" "+o).append(a)):o&&(o.text?t.textContent=""+o.text:o.html?t.innerHTML=o.html:t.innerHTML="",s.attr("class",r+" "+(o.addClass||"")).append(a))}return l.ui.fancytree.registerExtension({name:"glyph",version:"2.38.3",options:{preset:null,map:{}},treeInit:function(e){var t=e.tree,e=e.options.glyph;e.preset?(a.assert(!!r[e.preset],"Invalid value for `options.glyph.preset`: "+e.preset),e.map=l.extend({},r[e.preset],e.map)):t.warn("ext-glyph: missing `preset` option."),this._superApply(arguments),t.$container.addClass("fancytree-ext-glyph")},nodeRenderStatus:function(e){var t,r,n,i=e.node,o=l(i.span),s=e.options.glyph,e=this._super(e);return!i.isRootNode()&&((n=o.children(".fancytree-expander").get(0))&&(r=i.expanded&&i.hasChildren()?"expanderOpen":i.isUndefined()?"expanderLazy":i.hasChildren()?"expanderClosed":"noExpander",c(i,n,"fancytree-expander",s,r)),(n=(i.tr?l("td",i.tr).find(".fancytree-checkbox"):o.children(".fancytree-checkbox")).get(0))&&(t=a.evalOption("checkbox",i,i,s,!1),i.parent&&i.parent.radiogroup||"radio"===t?c(i,n,"fancytree-checkbox fancytree-radio",s,r=i.selected?"radioSelected":"radio"):c(i,n,"fancytree-checkbox",s,r=i.selected?"checkboxSelected":i.partsel?"checkboxUnknown":"checkbox")),n=o.children(".fancytree-icon").get(0))&&(r=i.statusNodeType||(i.folder?i.expanded&&i.hasChildren()?"folderOpen":"folder":i.expanded?"docOpen":"doc"),c(i,n,"fancytree-icon",s,r)),e},nodeSetStatus:function(e,t,r,n){var i,o=e.options.glyph,e=e.node,s=this._superApply(arguments);return"error"!==t&&"loading"!==t&&"nodata"!==t||(e.parent?(i=l(".fancytree-expander",e.span).get(0))&&c(e,i,"fancytree-expander",o,t):(i=l(".fancytree-statusnode-"+t,e[this.nodeContainerAttrName]).find(".fancytree-icon").get(0))&&c(e,i,"fancytree-icon",o,t)),s}}),l.ui.fancytree},"function"==typeof define&&define.amd?define(["jquery","./jquery.fancytree"],t):"object"==typeof module&&module.exports?(require("./jquery.fancytree"),module.exports=t(require("jquery"))):t(jQuery),t=function(u){"use strict";var d=u.ui.keyCode,i={text:[d.UP,d.DOWN],checkbox:[d.UP,d.DOWN,d.LEFT,d.RIGHT],link:[d.UP,d.DOWN,d.LEFT,d.RIGHT],radiobutton:[d.UP,d.DOWN,d.LEFT,d.RIGHT],"select-one":[d.LEFT,d.RIGHT],"select-multiple":[d.LEFT,d.RIGHT]};function o(e,t){var r,n,i,o,s,a,l=e.closest("td"),c=null;switch(t){case d.LEFT:c=l.prev();break;case d.RIGHT:c=l.next();break;case d.UP:case d.DOWN:for(r=l.parent(),i=r,s=l.get(0),a=0,i.children().each(function(){if(this===s)return!1;o=u(this).prop("colspan"),a+=o||1}),n=a;;){if(!(r=t===d.UP?r.prev():r.next()).length)break;if(!r.is(":hidden")&&((c=function(e,t){var r,n=null,i=0;return e.children().each(function(){if(t<=i)return n=u(this),!1;r=u(this).prop("colspan"),i+=r||1}),n}(r,n))&&c.find(":input,a").length))break}}return c}return u.ui.fancytree.registerExtension({name:"gridnav",version:"2.38.3",options:{autofocusInput:!1,handleCursorKeys:!0},treeInit:function(r){this._requireExtension("table",!0,!0),this._superApply(arguments),this.$container.addClass("fancytree-ext-gridnav"),this.$container.on("focusin",function(e){var t=u.ui.fancytree.getNode(e.target);t&&!t.isActive()&&(t=r.tree._makeHookContext(t,e),r.tree._callHook("nodeSetActive",t,!0))})},nodeSetActive:function(e,t,r){var n=e.options.gridnav,i=e.node,o=e.originalEvent||{},o=u(o.target).is(":input");t=!1!==t,this._superApply(arguments),t&&(e.options.titlesTabbable?(o||(u(i.span).find("span.fancytree-title").focus(),i.setFocus()),e.tree.$container.attr("tabindex","-1")):n.autofocusInput&&!o&&u(i.tr||i.span).find(":input:enabled").first().focus())},nodeKeydown:function(e){var t,r=e.options.gridnav,e=e.originalEvent,n=u(e.target);return n.is(":input:enabled")?t=n.prop("type"):n.is("a")&&(t="link"),t&&r.handleCursorKeys?!((r=i[t])&&0<=u.inArray(e.which,r)&&(t=o(n,e.which))&&t.length&&(t.find(":input:enabled,a").focus(),1)):this._superApply(arguments)}}),u.ui.fancytree},"function"==typeof define&&define.amd?define(["jquery","./jquery.fancytree","./jquery.fancytree.table"],t):"object"==typeof module&&module.exports?(require("./jquery.fancytree.table"),module.exports=t(require("jquery"))):t(jQuery),t=function(s){"use strict";return s.ui.fancytree.registerExtension({name:"multi",version:"2.38.3",options:{allowNoSelect:!1,mode:"sameParent"},treeInit:function(e){this._superApply(arguments),this.$container.addClass("fancytree-ext-multi"),1===e.options.selectMode&&s.error("Fancytree ext-multi: selectMode: 1 (single) is not compatible.")},nodeClick:function(e){var t=e.tree,r=e.node,n=t.getActiveNode()||t.getFirstChild(),i="checkbox"===e.targetType,o="expander"===e.targetType;switch(s.ui.fancytree.eventToString(e.originalEvent)){case"click":o||i||(t.selectAll(!1),r.setSelected());break;case"shift+click":t.visitRows(function(e){if(e.setSelected(),e===r)return!1},{start:n,reverse:n.isBelowOf(r)});break;case"ctrl+click":case"meta+click":return void r.toggleSelected()}return this._superApply(arguments)},nodeKeydown:function(e){var t=e.tree,r=e.node,n=e.originalEvent;switch(s.ui.fancytree.eventToString(n)){case"up":case"down":t.selectAll(!1),r.navigate(n.which,!0),t.getActiveNode().setSelected();break;case"shift+up":case"shift+down":r.navigate(n.which,!0),t.getActiveNode().setSelected()}return this._superApply(arguments)}}),s.ui.fancytree},"function"==typeof define&&define.amd?define(["jquery","./jquery.fancytree"],t):"object"==typeof module&&module.exports?(require("./jquery.fancytree"),module.exports=t(require("jquery"))):t(jQuery),t=function(f){"use strict";var t=null,r=null,n=null,i=f.ui.fancytree.assert,d="active",g="expanded",h="focus",p="selected";try{i(window.localStorage&&window.localStorage.getItem),r={get:function(e){return window.localStorage.getItem(e)},set:function(e,t){window.localStorage.setItem(e,t)},remove:function(e){window.localStorage.removeItem(e)}}}catch(e){f.ui.fancytree.warn("Could not access window.localStorage",e)}try{i(window.sessionStorage&&window.sessionStorage.getItem),n={get:function(e){return window.sessionStorage.getItem(e)},set:function(e,t){window.sessionStorage.setItem(e,t)},remove:function(e){window.sessionStorage.removeItem(e)}}}catch(e){f.ui.fancytree.warn("Could not access window.sessionStorage",e)}return"function"==typeof Cookies?t={get:Cookies.get,set:function(e,t){Cookies.set(e,t,this.options.persist.cookie)},remove:Cookies.remove}:f&&"function"==typeof f.cookie&&(t={get:f.cookie,set:function(e,t){f.cookie(e,t,this.options.persist.cookie)},remove:f.removeCookie}),f.ui.fancytree._FancytreeClass.prototype.clearPersistData=function(e){var t=this.ext.persist,r=t.cookiePrefix;0<=(e=e||"active expanded focus selected").indexOf(d)&&t._data(r+d,null),0<=e.indexOf(g)&&t._data(r+g,null),0<=e.indexOf(h)&&t._data(r+h,null),0<=e.indexOf(p)&&t._data(r+p,null)},f.ui.fancytree._FancytreeClass.prototype.clearCookies=function(e){return this.warn("'tree.clearCookies()' is deprecated since v2.27.0: use 'clearPersistData()' instead."),this.clearPersistData(e)},f.ui.fancytree._FancytreeClass.prototype.getPersistData=function(){var e=this.ext.persist,t=e.cookiePrefix,r=e.cookieDelimiter,n={};return n[d]=e._data(t+d),n[g]=(e._data(t+g)||"").split(r),n[p]=(e._data(t+p)||"").split(r),n[h]=e._data(t+h),n},f.ui.fancytree.registerExtension({name:"persist",version:"2.38.3",options:{cookieDelimiter:"~",cookiePrefix:void 0,cookie:{raw:!1,expires:"",path:"",domain:"",secure:!1},expandLazy:!1,expandOpts:void 0,fireActivate:!0,overrideSource:!0,store:"auto",types:"active expanded focus selected"},_data:function(e,t){var r=this._local.store;if(void 0===t)return r.get.call(this,e);null===t?r.remove.call(this,e):r.set.call(this,e,t)},_appendKey:function(e,t,r){t=""+t;var n=this._local,i=this.options.persist.cookieDelimiter,e=n.cookiePrefix+e,o=n._data(e),o=o?o.split(i):[],s=f.inArray(t,o);0<=s&&o.splice(s,1),r&&o.push(t),n._data(e,o.join(i))},treeInit:function(e){var a=e.tree,l=e.options,c=this._local,u=this.options.persist;return c.cookiePrefix=u.cookiePrefix||"fancytree-"+a._id+"-",c.storeActive=0<=u.types.indexOf(d),c.storeExpanded=0<=u.types.indexOf(g),c.storeSelected=0<=u.types.indexOf(p),c.storeFocus=0<=u.types.indexOf(h),c.store=null,"auto"===u.store&&(u.store=r?"local":"cookie"),f.isPlainObject(u.store)?c.store=u.store:"cookie"===u.store?c.store=t:"local"!==u.store&&"session"!==u.store||(c.store="local"===u.store?r:n),i(c.store,"Need a valid store."),a.$div.on("fancytreeinit",function(e){var t,r,n,i,o,s;!1!==a._triggerTreeEvent("beforeRestore",null,{})&&(n=c._data(c.cookiePrefix+h),i=!1===u.fireActivate,o=c._data(c.cookiePrefix+g),s=o&&o.split(u.cookieDelimiter),(c.storeExpanded?function e(t,r,n,i,o){var s,a,l,c,u=!1,d=t.options.persist.expandOpts,h=[],p=[];for(n=n||[],o=o||f.Deferred(),s=0,l=n.length;s<l;s++)a=n[s],(c=t.getNodeByKey(a))?i&&c.isUndefined()?(u=!0,t.debug("_loadLazyNodes: "+c+" is lazy: loading..."),h.push("expand"===i?c.setExpanded(!0,d):c.load())):(t.debug("_loadLazyNodes: "+c+" already loaded."),c.setExpanded(!0,d)):(p.push(a),t.debug("_loadLazyNodes: "+c+" was not yet found."));return f.when.apply(f,h).always(function(){if(u&&0<p.length)e(t,r,p,i,o);else{if(p.length)for(t.warn("_loadLazyNodes: could not load those keys: ",p),s=0,l=p.length;s<l;s++)a=n[s],r._appendKey(g,n[s],!1);o.resolve()}}),o}(a,c,s,!!u.expandLazy&&"expand",null):(new f.Deferred).resolve()).done(function(){if(c.storeSelected){if(o=c._data(c.cookiePrefix+p))for(s=o.split(u.cookieDelimiter),t=0;t<s.length;t++)(r=a.getNodeByKey(s[t]))?(void 0===r.selected||u.overrideSource&&!1===r.selected)&&(r.selected=!0,r.renderStatus()):c._appendKey(p,s[t],!1);3===a.options.selectMode&&a.visit(function(e){if(e.selected)return e.fixSelection3AfterClick(),"skip"})}c.storeActive&&(o=c._data(c.cookiePrefix+d))&&(l.persist.overrideSource||!a.activeNode)&&(r=a.getNodeByKey(o))&&(r.debug("persist: set active",o),r.setActive(!0,{noFocus:!0,noEvents:i})),c.storeFocus&&n&&(r=a.getNodeByKey(n))&&(a.options.titlesTabbable?f(r.span).find(".fancytree-title"):f(a.$container)).focus(),a._triggerTreeEvent("restore",null,{})}))}),this._superApply(arguments)},nodeSetActive:function(e,t,r){var n,i=this._local;return n=this._superApply(arguments),i.storeActive&&i._data(i.cookiePrefix+d,this.activeNode?this.activeNode.key:null),n},nodeSetExpanded:function(e,t,r){var n,e=e.node,i=this._local;return t=!1!==t,n=this._superApply(arguments),i.storeExpanded&&i._appendKey(g,e.key,t),n},nodeSetFocus:function(e,t){var r,n=this._local;return r=this._superApply(arguments),n.storeFocus&&n._data(n.cookiePrefix+h,this.focusNode?this.focusNode.key:null),r},nodeSetSelected:function(e,t,r){var n,i=e.tree,o=e.node,s=this._local;return n=this._superApply(arguments),s.storeSelected&&(3===i.options.selectMode?(i=(i=f.map(i.getSelectedNodes(!0),function(e){return e.key})).join(e.options.persist.cookieDelimiter),s._data(s.cookiePrefix+p,i)):s._appendKey(p,o.key,o.selected)),n}}),f.ui.fancytree},"function"==typeof define&&define.amd?define(["jquery","./jquery.fancytree"],t):"object"==typeof module&&module.exports?(require("./jquery.fancytree"),module.exports=t(require("jquery"))):t(jQuery),t=function(b){"use strict";var w=b.ui.fancytree.assert;function C(e,r){e.visit(function(e){var t=e.tr;if(t&&(t.style.display=e.hide||!r?"none":""),!e.expanded)return"skip"})}return b.ui.fancytree.registerExtension({name:"table",version:"2.38.3",options:{checkboxColumnIdx:null,indentation:16,mergeStatusColumns:!0,nodeColumnIdx:0},treeInit:function(e){var t,r,n,i,o=e.tree,e=e.options,s=e.table,a=o.widget.element;if(null!=s.customStatus&&(null==e.renderStatusColumns?(o.warn("The 'customStatus' option is deprecated since v2.15.0. Use 'renderStatusColumns' instead."),e.renderStatusColumns=s.customStatus):b.error("The 'customStatus' option is deprecated since v2.15.0. Use 'renderStatusColumns' only instead.")),e.renderStatusColumns&&!0===e.renderStatusColumns&&(e.renderStatusColumns=e.renderColumns),a.addClass("fancytree-container fancytree-ext-table"),(i=a.find(">tbody")).length||(a.find(">tr").length&&b.error("Expected table > tbody > tr. If you see this please open an issue."),i=b("<tbody>").appendTo(a)),o.tbody=i[0],o.columnCount=b("thead >tr",a).last().find(">th",a).length,(n=i.children("tr").first()).length)r=n.children("td").length,o.columnCount&&r!==o.columnCount&&(o.warn("Column count mismatch between thead ("+o.columnCount+") and tbody ("+r+"): using tbody."),o.columnCount=r),n=n.clone();else for(w(1<=o.columnCount,"Need either <thead> or <tbody> with <td> elements to determine column count."),n=b("<tr />"),t=0;t<o.columnCount;t++)n.append("<td />");n.find(">td").eq(s.nodeColumnIdx).html("<span class='fancytree-node' />"),e.aria&&(n.attr("role","row"),n.find("td").attr("role","gridcell")),o.rowFragment=document.createDocumentFragment(),o.rowFragment.appendChild(n.get(0)),i.empty(),o.statusClassPropName="tr",o.ariaPropName="tr",this.nodeContainerAttrName="tr",o.$container=a,this._superApply(arguments),b(o.rootNode.ul).remove(),o.rootNode.ul=null,this.$container.attr("tabindex",e.tabindex),e.aria&&o.$container.attr("role","treegrid").attr("aria-readonly",!0)},nodeRemoveChildMarkup:function(e){e.node.visit(function(e){e.tr&&(b(e.tr).remove(),e.tr=null)})},nodeRemoveMarkup:function(e){var t=e.node;t.tr&&(b(t.tr).remove(),t.tr=null),this.nodeRemoveChildMarkup(e)},nodeRender:function(e,t,r,n,i){var o,s,a,l,c,u,d,h,p,f,g=e.tree,m=e.node,y=e.options,v=!m.parent;if(!1!==g._enableUpdate){if(i||(e.hasCollapsedParents=m.parent&&!m.parent.expanded),!v)if(m.tr&&t&&this.nodeRemoveMarkup(e),m.tr)t?this.nodeRenderTitle(e):this.nodeRenderStatus(e);else{if(e.hasCollapsedParents&&!r)return;c=g.rowFragment.firstChild.cloneNode(!0),u=function(e){var t,r,n=e.parent,i=n?n.children:null;if(i&&1<i.length&&i[0]!==e)for(r=i[b.inArray(e,i)-1],w(r.tr);r.children&&r.children.length&&(t=r.children[r.children.length-1]).tr;)r=t;else r=n;return r}(m),w(u),(!0===n&&i||r&&e.hasCollapsedParents)&&(c.style.display="none"),u.tr?(p=u.tr,f=c,p.parentNode.insertBefore(f,p.nextSibling)):(w(!u.parent,"prev. row must have a tr, or be system root"),f=g.tbody,p=c,f.insertBefore(p,f.firstChild)),m.tr=c,m.key&&y.generateIds&&(m.tr.id=y.idPrefix+m.key),(m.tr.ftnode=m).span=b("span.fancytree-node",m.tr).get(0),this.nodeRenderTitle(e),y.createNode&&y.createNode.call(g,{type:"createNode"},e)}if(y.renderNode&&y.renderNode.call(g,{type:"renderNode"},e),(o=m.children)&&(v||r||m.expanded))for(a=0,l=o.length;a<l;a++)(h=b.extend({},e,{node:o[a]})).hasCollapsedParents=h.hasCollapsedParents||!m.expanded,this.nodeRender(h,t,r,n,!0);o&&!i&&(d=m.tr||null,s=g.tbody.firstChild,m.visit(function(e){var t;e.tr&&(e.parent.expanded||"none"===e.tr.style.display||(e.tr.style.display="none",C(e,!1)),e.tr.previousSibling!==d&&(m.debug("_fixOrder: mismatch at node: "+e),t=d?d.nextSibling:s,g.tbody.insertBefore(e.tr,t)),d=e.tr)}))}},nodeRenderTitle:function(e,t){var r,n=e.tree,i=e.node,o=e.options,s=i.isStatusNode(),t=this._super(e,t);return i.isRootNode()||(o.checkbox&&!s&&null!=o.table.checkboxColumnIdx&&(r=b("span.fancytree-checkbox",i.span),b(i.tr).find("td").eq(+o.table.checkboxColumnIdx).html(r)),this.nodeRenderStatus(e),s?o.renderStatusColumns?o.renderStatusColumns.call(n,{type:"renderStatusColumns"},e):o.table.mergeStatusColumns&&i.isTopLevel()&&b(i.tr).find(">td").eq(0).prop("colspan",n.columnCount).text(i.title).addClass("fancytree-status-merged").nextAll().remove():o.renderColumns&&o.renderColumns.call(n,{type:"renderColumns"},e)),t},nodeRenderStatus:function(e){var t=e.node,r=e.options;this._super(e),b(t.tr).removeClass("fancytree-node"),e=(t.getLevel()-1)*r.table.indentation,r.rtl?b(t.span).css({paddingRight:e+"px"}):b(t.span).css({paddingLeft:e+"px"})},nodeSetExpanded:function(t,r,n){var i,e;return r=!1!==r,t.node.expanded&&r||!t.node.expanded&&!r?this._superApply(arguments):(i=new b.Deferred,e=b.extend({},n,{noEvents:!0,noAnimation:!0}),n=n||{},this._super(t,r,e).done(function(){o(!0)}).fail(function(){o(!1)}),i.promise());function o(e){e?(C(t.node,r),r&&t.options.autoScroll&&!n.noAnimation&&t.node.hasChildren()?t.node.getLastChild().scrollIntoView(!0,{topNode:t.node}).always(function(){n.noEvents||t.tree._triggerNodeEvent(r?"expand":"collapse",t),i.resolveWith(t.node)}):(n.noEvents||t.tree._triggerNodeEvent(r?"expand":"collapse",t),i.resolveWith(t.node))):(n.noEvents||t.tree._triggerNodeEvent(r?"expand":"collapse",t),i.rejectWith(t.node))}},nodeSetStatus:function(e,t,r,n){return"ok"===t&&(e=(t=e.node).children?t.children[0]:null)&&e.isStatusNode()&&b(e.tr).remove(),this._superApply(arguments)},treeClear:function(e){return this.nodeRemoveChildMarkup(this._makeHookContext(this.rootNode)),this._superApply(arguments)},treeDestroy:function(e){return this.$container.find("tbody").empty(),this.$source&&this.$source.removeClass("fancytree-helper-hidden"),this._superApply(arguments)}}),b.ui.fancytree},"function"==typeof define&&define.amd?define(["jquery","./jquery.fancytree"],t):"object"==typeof module&&module.exports?(require("./jquery.fancytree"),module.exports=t(require("jquery"))):t(jQuery),t=function(o){"use strict";return o.ui.fancytree.registerExtension({name:"themeroller",version:"2.38.3",options:{activeClass:"ui-state-active",addClass:"ui-corner-all",focusClass:"ui-state-focus",hoverClass:"ui-state-hover",selectedClass:"ui-state-highlight"},treeInit:function(e){var t=e.widget.element,r=e.options.themeroller;this._superApply(arguments),"TABLE"===t[0].nodeName?(t.addClass("ui-widget ui-corner-all"),t.find(">thead tr").addClass("ui-widget-header"),t.find(">tbody").addClass("ui-widget-conent")):t.addClass("ui-widget ui-widget-content ui-corner-all"),t.on("mouseenter mouseleave",".fancytree-node",function(e){var t=o.ui.fancytree.getNode(e.target),e="mouseenter"===e.type;o(t.tr||t.span).toggleClass(r.hoverClass+" "+r.addClass,e)})},treeDestroy:function(e){this._superApply(arguments),e.widget.element.removeClass("ui-widget ui-widget-content ui-corner-all")},nodeRenderStatus:function(e){var t={},r=e.node,n=o(r.tr||r.span),i=e.options.themeroller;this._super(e),t[i.activeClass]=!1,t[i.focusClass]=!1,t[i.selectedClass]=!1,r.isActive()&&(t[i.activeClass]=!0),r.hasFocus()&&(t[i.focusClass]=!0),r.isSelected()&&!r.isActive()&&(t[i.selectedClass]=!0),n.toggleClass(i.activeClass,t[i.activeClass]),n.toggleClass(i.focusClass,t[i.focusClass]),n.toggleClass(i.selectedClass,t[i.selectedClass]),n.addClass(i.addClass)}}),o.ui.fancytree},"function"==typeof define&&define.amd?define(["jquery","./jquery.fancytree"],t):"object"==typeof module&&module.exports?(require("./jquery.fancytree"),module.exports=t(require("jquery"))):t(jQuery),t=function(c){"use strict";var u=/^([+-]?(?:\d+|\d*\.\d+))([a-z]*|%)$/;function d(e,t){var r=c("#"+(e="fancytree-style-"+e));if(t){r.length||(r=c("<style />").attr("id",e).addClass("fancytree-style").prop("type","text/css").appendTo("head"));try{r.html(t)}catch(e){r[0].styleSheet.cssText=t}}else r.remove()}function h(e,t,r,n,i,o){for(var s="#"+e+" span.fancytree-level-",a=[],l=0;l<t;l++)a.push(s+(l+1)+" span.fancytree-title { padding-left: "+(l*r+n)+o+"; }");return a.push("#"+e+" div.ui-effects-wrapper ul li span.fancytree-title, #"+e+" li.fancytree-animating span.fancytree-title { padding-left: "+i+o+"; position: static; width: auto; }"),a.join("\n")}return c.ui.fancytree.registerExtension({name:"wide",version:"2.38.3",options:{iconWidth:null,iconSpacing:null,labelSpacing:null,levelOfs:null},treeCreate:function(e){this._superApply(arguments),this.$container.addClass("fancytree-ext-wide");var t,r,n=e.options.wide,i=c("<li id='fancytreeTemp'><span class='fancytree-node'><span class='fancytree-icon' /><span class='fancytree-title' /></span><ul />").appendTo(e.tree.$container),o=i.find(".fancytree-icon"),s=i.find("ul"),a=n.iconSpacing||o.css("margin-left"),o=n.iconWidth||o.css("width"),l=n.labelSpacing||"3px",n=n.levelOfs||s.css("padding-left");i.remove(),s=a.match(u)[2],a=parseFloat(a,10),i=l.match(u)[2],l=parseFloat(l,10),t=o.match(u)[2],o=parseFloat(o,10),r=n.match(u)[2],s===t&&r===t&&i===t||c.error("iconWidth, iconSpacing, and levelOfs must have the same css measure unit"),this._local.measureUnit=t,this._local.levelOfs=parseFloat(n),this._local.lineOfs=(1+(e.options.checkbox?1:0)+(!1===e.options.icon?0:1))*(o+a)+a,this._local.labelOfs=l,this._local.maxDepth=10,d(s=this.$container.uniqueId().attr("id"),h(s,this._local.maxDepth,this._local.levelOfs,this._local.lineOfs,this._local.labelOfs,this._local.measureUnit))},treeDestroy:function(e){return d(this.$container.attr("id"),null),this._superApply(arguments)},nodeRenderStatus:function(e){var t,r=e.node,n=r.getLevel(),e=this._super(e);return n>this._local.maxDepth&&(t=this.$container.attr("id"),this._local.maxDepth*=2,r.debug("Define global ext-wide css up to level "+this._local.maxDepth),d(t,h(t,this._local.maxDepth,this._local.levelOfs,this._local.lineOfs,this._local.labelSpacing,this._local.measureUnit))),c(r.span).addClass("fancytree-level-"+n),e}}),c.ui.fancytree},"function"==typeof define&&define.amd?define(["jquery","./jquery.fancytree"],t):"object"==typeof module&&module.exports?(require("./jquery.fancytree"),module.exports=t(require("jquery"))):t(jQuery),e.ui.fancytree}),!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof module&&"undefined"!=typeof exports?module.exports=t():e.Papa=t()}(this,function n(){"use strict";var i="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==i?i:{};var u,o=!i.document&&!!i.postMessage,s=i.IS_PAPA_WORKER||!1,a={},l=0,w={};function c(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(e){var t=E(e);t.chunkSize=parseInt(t.chunkSize),e.step||e.chunk||(t.chunkSize=null);this._handle=new r(t),(this._handle.streamer=this)._config=t}.call(this,e),this.parseChunk=function(e,t){this.isFirstChunk&&Y(this._config.beforeFirstChunk)&&void 0!==(r=this._config.beforeFirstChunk(e))&&(e=r),this.isFirstChunk=!1,this._halted=!1;var r=this._partialLine+e,e=(this._partialLine="",this._handle.parse(r,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){var n=e.meta.cursor,r=(this._finished||(this._partialLine=r.substring(n-this._baseIndex),this._baseIndex=n),e&&e.data&&(this._rowCount+=e.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview);if(s)i.postMessage({results:e,workerId:w.WORKER_ID,finished:r});else if(Y(this._config.chunk)&&!t){if(this._config.chunk(e,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=e=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(e.data),this._completeResults.errors=this._completeResults.errors.concat(e.errors),this._completeResults.meta=e.meta),this._completed||!r||!Y(this._config.complete)||e&&e.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),r||e&&e.meta.paused||this._nextChunk(),e}this._halted=!0},this._sendError=function(e){Y(this._config.error)?this._config.error(e):s&&this._config.error&&i.postMessage({workerId:w.WORKER_ID,error:e,finished:!1})}}function d(e){var n;(e=e||{}).chunkSize||(e.chunkSize=w.RemoteChunkSize),c.call(this,e),this._nextChunk=o?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(n=new XMLHttpRequest,this._config.withCredentials&&(n.withCredentials=this._config.withCredentials),o||(n.onload=b(this._chunkLoaded,this),n.onerror=b(this._chunkError,this)),n.open(this._config.downloadRequestBody?"POST":"GET",this._input,!o),this._config.downloadRequestHeaders){var e,t=this._config.downloadRequestHeaders;for(e in t)n.setRequestHeader(e,t[e])}var r;this._config.chunkSize&&(r=this._start+this._config.chunkSize-1,n.setRequestHeader("Range","bytes="+this._start+"-"+r));try{n.send(this._config.downloadRequestBody)}catch(e){this._chunkError(e.message)}o&&0===n.status&&this._chunkError()}},this._chunkLoaded=function(){4===n.readyState&&(n.status<200||400<=n.status?this._chunkError():(this._start+=this._config.chunkSize||n.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(e){e=e.getResponseHeader("Content-Range");return null!==e?parseInt(e.substring(e.lastIndexOf("/")+1)):-1}(n),this.parseChunk(n.responseText)))},this._chunkError=function(e){e=n.statusText||e;this._sendError(new Error(e))}}function h(e){(e=e||{}).chunkSize||(e.chunkSize=w.LocalChunkSize),c.call(this,e);var r,n,i="undefined"!=typeof FileReader;this.stream=function(e){this._input=e,n=e.slice||e.webkitSlice||e.mozSlice,i?((r=new FileReader).onload=b(this._chunkLoaded,this),r.onerror=b(this._chunkError,this)):r=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input,t=(this._config.chunkSize&&(t=Math.min(this._start+this._config.chunkSize,this._input.size),e=n.call(e,this._start,t)),r.readAsText(e,this._config.encoding));i||this._chunkLoaded({target:{result:t}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(r.error)}}function p(e){var r;c.call(this,e=e||{}),this.stream=function(e){return r=e,this._nextChunk()},this._nextChunk=function(){var e,t;if(!this._finished)return e=this._config.chunkSize,r=e?(t=r.substring(0,e),r.substring(e)):(t=r,""),this._finished=!r,this.parseChunk(t)}}function f(e){c.call(this,e=e||{});var t=[],r=!0,n=!1;this.pause=function(){c.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){c.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(e){this._input=e,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){n&&1===t.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):r=!0},this._streamData=b(function(e){try{t.push("string"==typeof e?e:e.toString(this._config.encoding)),r&&(r=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(e){this._streamError(e)}},this),this._streamError=b(function(e){this._streamCleanUp(),this._sendError(e)},this),this._streamEnd=b(function(){this._streamCleanUp(),n=!0,this._streamData("")},this),this._streamCleanUp=b(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function g(e){var t=require("stream").Duplex,r=E(e),n=!0,i=!1,o=[],s=null;this._onCsvData=function(e){e=e.data;s.push(e)||this._handle.paused()||this._handle.pause()},this._onCsvComplete=function(){s.push(null)},r.step=b(this._onCsvData,this),r.complete=b(this._onCsvComplete,this),c.call(this,r),this._nextChunk=function(){i&&1===o.length&&(this._finished=!0),o.length?o.shift()():n=!0},this._addToParseQueue=function(e,t){o.push(b(function(){if(this.parseChunk("string"==typeof e?e:e.toString(r.encoding)),Y(t))return t()},this)),n&&(n=!1,this._nextChunk())},this._onRead=function(){this._handle.paused()&&this._handle.resume()},this._onWrite=function(e,t,r){this._addToParseQueue(e,r)},this._onWriteComplete=function(){i=!0,this._addToParseQueue("")},this.getStream=function(){return s},(s=new t({readableObjectMode:!0,decodeStrings:!1,read:b(this._onRead,this),write:b(this._onWrite,this)})).once("finish",b(this._onWriteComplete,this))}function r(y){var i,o,s,t,a=Math.pow(2,53),l=-a,c=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,u=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,r=this,n=0,d=0,h=!1,e=!1,p=[],f={data:[],errors:[],meta:{}};function v(e){return"greedy"===y.skipEmptyLines?""===e.join("").trim():1===e.length&&0===e[0].length}function g(){if(f&&s&&(b("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+w.DefaultDelimiter+"'"),s=!1),y.skipEmptyLines&&(f.data=f.data.filter(function(e){return!v(e)})),m()){if(f)if(Array.isArray(f.data[0])){for(var e=0;m()&&e<f.data.length;e++)f.data[e].forEach(t);f.data.splice(0,1)}else f.data.forEach(t);function t(e,t){Y(y.transformHeader)&&(e=y.transformHeader(e,t)),p.push(e)}}function r(e,t){for(var r=y.header?{}:[],n=0;n<e.length;n++){var i=n,o=e[n],o=function(e,t){if(function(e){y.dynamicTypingFunction&&void 0===y.dynamicTyping[e]&&(y.dynamicTyping[e]=y.dynamicTypingFunction(e));return!0===(y.dynamicTyping[e]||y.dynamicTyping)}(e))return"true"===t||"TRUE"===t||"false"!==t&&"FALSE"!==t&&(function(e){if(c.test(e)){e=parseFloat(e);if(l<e&&e<a)return 1}}(t)?parseFloat(t):u.test(t)?new Date(t):""===t?null:t);return t}(i=y.header?n>=p.length?"__parsed_extra":p[n]:i,o=y.transform?y.transform(o,i):o);"__parsed_extra"===i?(r[i]=r[i]||[],r[i].push(o)):r[i]=o}return y.header&&(n>p.length?b("FieldMismatch","TooManyFields","Too many fields: expected "+p.length+" fields but parsed "+n,d+t):n<p.length&&b("FieldMismatch","TooFewFields","Too few fields: expected "+p.length+" fields but parsed "+n,d+t)),r}var n;f&&(y.header||y.dynamicTyping||y.transform)&&(n=1,!f.data.length||Array.isArray(f.data[0])?(f.data=f.data.map(r),n=f.data.length):f.data=r(f.data,0),y.header&&f.meta&&(f.meta.fields=p),d+=n)}function m(){return y.header&&0===p.length}function b(e,t,r,n){e={type:e,code:t,message:r};void 0!==n&&(e.row=n),f.errors.push(e)}Y(y.step)&&(t=y.step,y.step=function(e){f=e,m()?g():(g(),0!==f.data.length&&(n+=e.data.length,y.preview&&n>y.preview?o.abort():(f.data=f.data[0],t(f,r))))}),this.parse=function(e,t,r){var n=y.quoteChar||'"',n=(y.newline||(y.newline=function(e,t){e=e.substring(0,1048576);var t=new RegExp(z(t)+"([^]*?)"+z(t),"gm"),r=(e=e.replace(t,"")).split("\r"),t=e.split("\n"),e=1<t.length&&t[0].length<r[0].length;if(1===r.length||e)return"\n";for(var n=0,i=0;i<r.length;i++)"\n"===r[i][0]&&n++;return n>=r.length/2?"\r\n":"\r"}(e,n)),s=!1,y.delimiter?Y(y.delimiter)&&(y.delimiter=y.delimiter(e),f.meta.delimiter=y.delimiter):((n=function(e,t,r,n,i){var o,s,a,l;i=i||[",","\t","|",";",w.RECORD_SEP,w.UNIT_SEP];for(var c=0;c<i.length;c++){for(var u,d=i[c],h=0,p=0,f=0,g=(a=void 0,new C({comments:n,delimiter:d,newline:t,preview:10}).parse(e)),m=0;m<g.data.length;m++)r&&v(g.data[m])?f++:(u=g.data[m].length,p+=u,void 0===a?a=u:0<u&&(h+=Math.abs(u-a),a=u));0<g.data.length&&(p/=g.data.length-f),(void 0===s||h<=s)&&(void 0===l||l<p)&&1.99<p&&(s=h,o=d,l=p)}return{successful:!!(y.delimiter=o),bestDelimiter:o}}(e,y.newline,y.skipEmptyLines,y.comments,y.delimitersToGuess)).successful?y.delimiter=n.bestDelimiter:(s=!0,y.delimiter=w.DefaultDelimiter),f.meta.delimiter=y.delimiter),E(y));return y.preview&&y.header&&n.preview++,i=e,o=new C(n),f=o.parse(i,t,r),g(),h?{meta:{paused:!0}}:f||{meta:{paused:!1}}},this.paused=function(){return h},this.pause=function(){h=!0,o.abort(),i=Y(y.chunk)?"":i.substring(o.getCharIndex())},this.resume=function(){r.streamer._halted?(h=!1,r.streamer.parseChunk(i,!0)):setTimeout(r.resume,3)},this.aborted=function(){return e},this.abort=function(){e=!0,o.abort(),f.meta.aborted=!0,Y(y.complete)&&y.complete(f),i=""}}function z(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function C(D){var P=(D=D||{}).delimiter,L=D.newline,F=D.comments,H=D.step,U=D.preview,V=D.fastMode,W=void 0===D.quoteChar||null===D.quoteChar?'"':D.quoteChar,$=W;if(void 0!==D.escapeChar&&($=D.escapeChar),("string"!=typeof P||-1<w.BAD_DELIMITERS.indexOf(P))&&(P=","),F===P)throw new Error("Comment character same as delimiter");!0===F?F="#":("string"!=typeof F||-1<w.BAD_DELIMITERS.indexOf(F))&&(F=!1),"\n"!==L&&"\r"!==L&&"\r\n"!==L&&(L="\n");var B=0,j=!1;this.parse=function(r,t,n){if("string"!=typeof r)throw new Error("Input must be a string");var i=r.length,e=P.length,o=L.length,s=F.length,a=Y(H),l=[],c=[],u=[],d=B=0;if(!r)return M();if(D.header&&!t){var h,p,f=r.split(L)[0].split(P),g=[],m={},y=!1;for(h in f){var v=f[h],b=v=Y(D.transformHeader)?D.transformHeader(v,h):v,w=m[v]||0;for(0<w&&(y=!0,b=v+"_"+w),m[v]=w+1;g.includes(b);)b=b+"_"+w;g.push(b)}y&&((p=r.split(L))[0]=g.join(P),r=p.join(L))}if(V||!1!==V&&-1===r.indexOf(W)){for(var C=r.split(L),E=0;E<C.length;E++){if(u=C[E],B+=u.length,E!==C.length-1)B+=L.length;else if(n)return M();if(!F||u.substring(0,s)!==F){if(a){if(l=[],A(u.split(P)),k(),j)return M()}else A(u.split(P));if(U&&U<=E)return l=l.slice(0,U),M(!0)}}return M()}for(var T=r.indexOf(P,B),S=r.indexOf(L,B),_=new RegExp(z($)+z(W),"g"),x=r.indexOf(W,B);;)if(r[B]===W)for(x=B,B++;;){if(-1===(x=r.indexOf(W,x+1)))return n||c.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:l.length,index:B}),O();if(x===i-1)return O(r.substring(B,x).replace(_,W));if(W===$&&r[x+1]===$)x++;else if(W===$||0===x||r[x-1]!==$){-1!==T&&T<x+1&&(T=r.indexOf(P,x+1));var R=N(-1===(S=-1!==S&&S<x+1?r.indexOf(L,x+1):S)?T:Math.min(T,S));if(r.substr(x+1+R,e)===P){u.push(r.substring(B,x).replace(_,W)),r[B=x+1+R+e]!==W&&(x=r.indexOf(W,B)),T=r.indexOf(P,B),S=r.indexOf(L,B);break}R=N(S);if(r.substring(x+1+R,x+1+R+o)===L){if(u.push(r.substring(B,x).replace(_,W)),I(x+1+R+o),T=r.indexOf(P,B),x=r.indexOf(W,B),a&&(k(),j))return M();if(U&&l.length>=U)return M(!0);break}c.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:l.length,index:B}),x++}}else if(F&&0===u.length&&r.substring(B,B+s)===F){if(-1===S)return M();B=S+o,S=r.indexOf(L,B),T=r.indexOf(P,B)}else if(-1!==T&&(T<S||-1===S))u.push(r.substring(B,T)),B=T+e,T=r.indexOf(P,B);else{if(-1===S)break;if(u.push(r.substring(B,S)),I(S+o),a&&(k(),j))return M();if(U&&l.length>=U)return M(!0)}return O();function A(e){l.push(e),d=B}function N(e){var t=0;return t=-1!==e&&(e=r.substring(x+1,e))&&""===e.trim()?e.length:t}function O(e){return n||(void 0===e&&(e=r.substring(B)),u.push(e),B=i,A(u),a&&k()),M()}function I(e){B=e,A(u),u=[],S=r.indexOf(L,B)}function M(e){return{data:l,errors:c,meta:{delimiter:P,linebreak:L,aborted:j,truncated:!!e,cursor:d+(t||0)}}}function k(){H(M()),l=[],c=[]}},this.abort=function(){j=!0},this.getCharIndex=function(){return B}}function m(e){var t=e.data,r=a[t.workerId],n=!1;if(t.error)r.userError(t.error,t.file);else if(t.results&&t.results.data){var i={abort:function(){n=!0,y(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:v,resume:v};if(Y(r.userStep)){for(var o=0;o<t.results.data.length&&(r.userStep({data:t.results.data[o],errors:t.results.errors,meta:t.results.meta},i),!n);o++);delete t.results}else Y(r.userChunk)&&(r.userChunk(t.results,i,t.file),delete t.results)}t.finished&&!n&&y(t.workerId,t.results)}function y(e,t){var r=a[e];Y(r.userComplete)&&r.userComplete(t),r.terminate(),delete a[e]}function v(){throw new Error("Not implemented.")}function E(e){if("object"!=typeof e||null===e)return e;var t,r=Array.isArray(e)?[]:{};for(t in e)r[t]=E(e[t]);return r}function b(e,t){return function(){e.apply(t,arguments)}}function Y(e){return"function"==typeof e}return w.parse=function(e,t){var r=(t=t||{}).dynamicTyping||!1;Y(r)&&(t.dynamicTypingFunction=r,r={});if(t.dynamicTyping=r,t.transform=!!Y(t.transform)&&t.transform,!t.worker||!w.WORKERS_SUPPORTED)return r=null,e===w.NODE_STREAM_INPUT&&"undefined"==typeof PAPA_BROWSER_CONTEXT?(r=new g(t)).getStream():("string"==typeof e?(e=function(e){return 65279!==e.charCodeAt(0)?e:e.slice(1)}(e),r=new(t.download?d:p)(t)):!0===e.readable&&Y(e.read)&&Y(e.on)?r=new f(t):(i.File&&e instanceof File||e instanceof Object)&&(r=new h(t)),r.stream(e));(r=function(){var e;return!!w.WORKERS_SUPPORTED&&(e=function(){var e=i.URL||i.webkitURL||null,t=n.toString();return w.BLOB_URL||(w.BLOB_URL=e.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",t,")();"],{type:"text/javascript"})))}(),(e=new i.Worker(e)).onmessage=m,e.id=l++,a[e.id]=e)}()).userStep=t.step,r.userChunk=t.chunk,r.userComplete=t.complete,r.userError=t.error,t.step=Y(t.step),t.chunk=Y(t.chunk),t.complete=Y(t.complete),t.error=Y(t.error),delete t.worker,r.postMessage({input:e,config:t,workerId:r.id})},w.unparse=function(e,t){var i=!1,m=!0,y=",",v="\r\n",o='"',s=o+o,r=!1,n=null,a=!1,l=(function(){if("object"==typeof t){if("string"!=typeof t.delimiter||w.BAD_DELIMITERS.filter(function(e){return-1!==t.delimiter.indexOf(e)}).length||(y=t.delimiter),"boolean"!=typeof t.quotes&&"function"!=typeof t.quotes&&!Array.isArray(t.quotes)||(i=t.quotes),"boolean"!=typeof t.skipEmptyLines&&"string"!=typeof t.skipEmptyLines||(r=t.skipEmptyLines),"string"==typeof t.newline&&(v=t.newline),"string"==typeof t.quoteChar&&(o=t.quoteChar),"boolean"==typeof t.header&&(m=t.header),Array.isArray(t.columns)){if(0===t.columns.length)throw new Error("Option columns is empty");n=t.columns}void 0!==t.escapeChar&&(s=t.escapeChar+o),("boolean"==typeof t.escapeFormulae||t.escapeFormulae instanceof RegExp)&&(a=t.escapeFormulae instanceof RegExp?t.escapeFormulae:/^[=+\-@\t\r].*$/)}}(),new RegExp(z(o),"g"));"string"==typeof e&&(e=JSON.parse(e));if(Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return c(null,e,r);if("object"==typeof e[0])return c(n||Object.keys(e[0]),e,r)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||n),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:"object"==typeof e.data[0]?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||"object"==typeof e.data[0]||(e.data=[e.data])),c(e.fields||[],e.data||[],r);throw new Error("Unable to serialize unrecognized input");function c(e,t,r){var n="",i=("string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t)),Array.isArray(e)&&0<e.length),o=!Array.isArray(t[0]);if(i&&m){for(var s=0;s<e.length;s++)0<s&&(n+=y),n+=b(e[s],s);0<t.length&&(n+=v)}for(var a=0;a<t.length;a++){var l=(i?e:t[a]).length,c=!1,u=i?0===Object.keys(t[a]).length:0===t[a].length;if(r&&!i&&(c="greedy"===r?""===t[a].join("").trim():1===t[a].length&&0===t[a][0].length),"greedy"===r&&i){for(var d=[],h=0;h<l;h++){var p=o?e[h]:h;d.push(t[a][p])}c=""===d.join("").trim()}if(!c){for(var f=0;f<l;f++){0<f&&!u&&(n+=y);var g=i&&o?e[f]:f;n+=b(t[a][g],f)}a<t.length-1&&(!r||0<l&&!u)&&(n+=v)}}return n}function b(e,t){var r,n;return null==e?"":e.constructor===Date?JSON.stringify(e).slice(1,25):(n=!1,a&&"string"==typeof e&&a.test(e)&&(e="'"+e,n=!0),r=e.toString().replace(l,s),(n=n||!0===i||"function"==typeof i&&i(e,t)||Array.isArray(i)&&i[t]||function(e,t){for(var r=0;r<t.length;r++)if(-1<e.indexOf(t[r]))return!0;return!1}(r,w.BAD_DELIMITERS)||-1<r.indexOf(y)||" "===r.charAt(0)||" "===r.charAt(r.length-1))?o+r+o:r)}},w.RECORD_SEP=String.fromCharCode(30),w.UNIT_SEP=String.fromCharCode(31),w.BYTE_ORDER_MARK="\ufeff",w.BAD_DELIMITERS=["\r","\n",'"',w.BYTE_ORDER_MARK],w.WORKERS_SUPPORTED=!o&&!!i.Worker,w.NODE_STREAM_INPUT=1,w.LocalChunkSize=10485760,w.RemoteChunkSize=5242880,w.DefaultDelimiter=",",w.Parser=C,w.ParserHandle=r,w.NetworkStreamer=d,w.FileStreamer=h,w.StringStreamer=p,w.ReadableStreamStreamer=f,"undefined"==typeof PAPA_BROWSER_CONTEXT&&(w.DuplexStreamStreamer=g),i.jQuery&&((u=i.jQuery).fn.parse=function(a){var r=a.config||{},l=[];return this.each(function(e){if(!("INPUT"===u(this).prop("tagName").toUpperCase()&&"file"===u(this).attr("type").toLowerCase()&&i.FileReader)||!this.files||0===this.files.length)return!0;for(var t=0;t<this.files.length;t++)l.push({file:this.files[t],inputElem:this,instanceConfig:u.extend({},r)})}),e(),this;function e(){if(0===l.length)Y(a.complete)&&a.complete();else{var e,t,r,n,i=l[0];if(Y(a.before)){var o=a.before(i.file,i.inputElem);if("object"==typeof o){if("abort"===o.action)return e="AbortError",t=i.file,r=i.inputElem,n=o.reason,void(Y(a.error)&&a.error({name:e},t,r,n));if("skip"===o.action)return void c();"object"==typeof o.config&&(i.instanceConfig=u.extend(i.instanceConfig,o.config))}else if("skip"===o)return void c()}var s=i.instanceConfig.complete;i.instanceConfig.complete=function(e){Y(s)&&s(e,i.file,i.inputElem),c()},w.parse(i.file,i.instanceConfig)}}function c(){l.splice(0,1),e()}}),s&&(i.onmessage=function(e){e=e.data;void 0===w.WORKER_ID&&e&&(w.WORKER_ID=e.workerId);"string"==typeof e.input?i.postMessage({workerId:w.WORKER_ID,results:w.parse(e.input,e.config),finished:!0}):(i.File&&e.input instanceof File||e.input instanceof Object)&&(e=w.parse(e.input,e.config))&&i.postMessage({workerId:w.WORKER_ID,results:e,finished:!0})}),(d.prototype=Object.create(c.prototype)).constructor=d,(h.prototype=Object.create(c.prototype)).constructor=h,(p.prototype=Object.create(p.prototype)).constructor=p,(f.prototype=Object.create(c.prototype)).constructor=f,"undefined"==typeof PAPA_BROWSER_CONTEXT&&((g.prototype=Object.create(c.prototype)).constructor=g),w});var XLSX={};function make_xlsx_lib(s){s.version="0.18.5";function f(e){-1!=r.indexOf(e)&&(_=M[0]=e)}var ae,g=1200,_=1252,r=("undefined"!=typeof cptable?ae=cptable:"undefined"!=typeof module&&"undefined"!=typeof require&&(ae=void 0),[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4]),M={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969};var Ee=function(e){f(g=e)};function m(){Ee(1200),f(1252)}function Te(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function a(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Se=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);if(255!=t||254!=r)return 254==t&&255==r?a(e.slice(2)):65279==t?e.slice(1):e;for(var n=e.slice(2),i=[],o=0;o<n.length>>1;++o)i[o]=String.fromCharCode(n.charCodeAt(2*o)+(n.charCodeAt(2*o+1)<<8));return i.join("")},u=function(e){return String.fromCharCode(e)},n=function(e){return String.fromCharCode(e)},le=(void 0!==ae&&(Ee=function(e){f(g=e)},Se=function(e){return 255===e.charCodeAt(0)&&254===e.charCodeAt(1)?ae.utils.decode(1200,Te(e.slice(2))):e},u=function(e){return 1200===g?String.fromCharCode(e):ae.utils.decode(g,[255&e,e>>8])[0]},n=function(e){return ae.utils.decode(_,[e])[0]}),null),h=!0,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function J(e){for(var t,r,n,i,o="",s=0,a=0,l=0;l<e.length;)n=(t=e.charCodeAt(l++))>>2,i=(3&t)<<4|(t=e.charCodeAt(l++))>>4,s=(15&t)<<2|(r=e.charCodeAt(l++))>>6,a=63&r,isNaN(t)?s=a=64:isNaN(r)&&(a=64),o+=c.charAt(n)+c.charAt(i)+c.charAt(s)+c.charAt(a);return o}function _e(e){var t,r,n="";e=e.replace(/[^\w\+\/\=]/g,"");for(var i=0;i<e.length;)t=c.indexOf(e.charAt(i++)),r=c.indexOf(e.charAt(i++)),n+=String.fromCharCode(t<<2|r>>4),64!==(t=c.indexOf(e.charAt(i++)))&&(n+=String.fromCharCode((15&r)<<4|t>>2)),64!==(r=c.indexOf(e.charAt(i++)))&&(n+=String.fromCharCode((3&t)<<6|r));return n}var ce="undefined"!=typeof Buffer&&!1,w=function(){if("undefined"==typeof Buffer)return function(){};var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch(e){t=!0}return t?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}();function B(e){return ce?Buffer.alloc?Buffer.alloc(e):new Buffer(e):new("undefined"!=typeof Uint8Array?Uint8Array:Array)(e)}function Z(e){return ce?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):new("undefined"!=typeof Uint8Array?Uint8Array:Array)(e)}var xe=function(e){return ce?w(e,"binary"):e.split("").map(function(e){return 255&e.charCodeAt(0)})};function l(e){if("undefined"==typeof ArrayBuffer)return xe(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=255&e.charCodeAt(n);return t}function p(e){if(Array.isArray(e))return e.map(function(e){return String.fromCharCode(e)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function v(e){if("undefined"==typeof ArrayBuffer)throw new Error("Unsupported");if(e instanceof ArrayBuffer)return v(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Re=ce?function(e){return Buffer.concat(e.map(function(e){return Buffer.isBuffer(e)?e:w(e)}))}:function(e){if("undefined"==typeof Uint8Array)return[].concat.apply([],e.map(function(e){return Array.isArray(e)?e:[].slice.call(e)}));for(var t=0,r=0,t=0;t<e.length;++t)r+=e[t].length;for(var n,i=new Uint8Array(r),r=t=0;t<e.length;r+=n,++t)if(n=e[t].length,e[t]instanceof Uint8Array)i.set(e[t],r);else{if("string"==typeof e[t])throw"wtf";i.set(new Uint8Array(e[t]),r)}return i};var Q=/\u0000/g,ee=/[\u0001-\u0006]/g;function x(e){for(var t="",r=e.length-1;0<=r;)t+=e.charAt(r--);return t}function R(e,t){e=""+e;return t<=e.length?e:I("0",t-e.length)+e}function k(e,t){e=""+e;return t<=e.length?e:I(" ",t-e.length)+e}function L(e,t){e=""+e;return t<=e.length?e:e+I(" ",t-e.length)}var i=Math.pow(2,32);function F(e,t){var r,n;return i<e||e<-i?(n=e,r=t,n=""+Math.round(n),r<=n.length?n:I("0",r-n.length)+n):(r=Math.round(e),(n=t)<=(e=""+(e=r)).length?e:I("0",n-e.length)+e)}function H(e,t){return e.length>=7+(t=t||0)&&103==(32|e.charCodeAt(t))&&101==(32|e.charCodeAt(t+1))&&110==(32|e.charCodeAt(t+2))&&101==(32|e.charCodeAt(t+3))&&114==(32|e.charCodeAt(t+4))&&97==(32|e.charCodeAt(t+5))&&108==(32|e.charCodeAt(t+6))}var U=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],V=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];var ue={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},o={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},b={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function j(e,t,r){var n,i=e<0?-1:1,o=e*i,s=0,a=1,l=0,c=1,u=0,d=0;for(Math.floor(o);u<t&&(l=(n=Math.floor(o))*a+s,d=n*u+c,!(o-n<5e-8));)o=1/(o-n),s=a,a=l,c=u,u=d;return t<d&&(l=t<u?(d=c,s):(d=u,a)),r?[e=Math.floor(i*l/d),i*l-e*d,d]:[0,i*l,d]}function z(e,t,r){var n,i,o,s;return 2958465<e||e<0?null:(o=[],s={D:n=0|e,T:i=Math.floor(86400*(e-n)),u:86400*(e-n)-i,y:e=0,m:0,d:0,H:0,M:0,S:0,q:0},Math.abs(s.u)<1e-6&&(s.u=0),t&&t.date1904&&(n+=1462),.9999<s.u&&(s.u=0,86400==++i)&&(s.T=i=0,++n,++s.D),60===n?(o=r?[1317,10,29]:[1900,2,29],e=3):0===n?(o=r?[1317,8,29]:[1900,1,0],e=6):(60<n&&--n,(t=new Date(1900,0,1)).setDate(t.getDate()+n-1),o=[t.getFullYear(),t.getMonth()+1,t.getDate()],e=t.getDay(),n<60&&(e=(e+6)%7),r&&(e=function(e,t){t[0]-=581;t=e.getDay();e<60&&(t=(t+6)%7);return t}(t,o))),s.y=o[0],s.m=o[1],s.d=o[2],s.S=i%60,i=Math.floor(i/60),s.M=i%60,i=Math.floor(i/60),s.H=i,s.q=e,s)}var K=new Date(1899,11,31,0,0,0),te=K.getTime(),re=new Date(1900,2,1,0,0,0);function ne(e,t){var r=e.getTime();return t?r-=1262304e5:re<=e&&(r+=864e5),(r-(te+6e4*(e.getTimezoneOffset()-K.getTimezoneOffset())))/864e5}function ie(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Ae(e){var t,r,n=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),i=-4<=n&&n<=-1?e.toPrecision(10+n):Math.abs(n)<=9?(t=(i=e)<0?12:11,(r=ie(i.toFixed(12))).length<=t||(r=i.toPrecision(10)).length<=t?r:i.toExponential(5)):10===n?e.toFixed(10).substr(0,12):(r=ie((t=e).toFixed(11))).length>(t<0?12:11)||"0"===r||"-0"===r?t.toPrecision(6):r;return ie(-1==(n=i.toUpperCase()).indexOf("E")?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2"))}function Ne(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):Ae(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return qe(14,ne(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Oe(e){if(e.length<=3)return e;for(var t=e.length%3,r=e.substr(0,t);t!=e.length;t+=3)r+=(0<r.length?",":"")+e.substr(t,3);return r}var Ie=/%/g;var Me=/# (\?+)( ?)\/( ?)(\d+)/;var ke=/^#*0*\.([0#]+)/,De=/\).*[0#]/,Pe=/\(###\) ###\\?-####/;function Le(e){for(var t,r="",n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function Fe(e,t){t=Math.pow(10,t);return""+Math.round(e*t)/t}function He(e,t){var e=e-Math.floor(e),r=Math.pow(10,t);return t<(""+Math.round(e*r)).length?0:Math.round(e*r)}function Ue(e,t,r){if(40===e.charCodeAt(0)&&!t.match(De))return n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,""),0<=r?Ue("n",n,r):"("+Ue("n",n,-r)+")";if(44===t.charCodeAt(t.length-1)){for(var n=e,i=t,o=r,s=i.length-1;44===i.charCodeAt(s-1);)--s;return We(n,i.substr(0,s),o/Math.pow(10,3*(i.length-s)))}if(-1!==t.indexOf("%"))return o=e,c=r,l=(u=t).replace(Ie,""),u=u.length-l.length,We(o,l,c*Math.pow(10,2*u))+I("%",u);if(-1!==t.indexOf("E"))return function e(t,r){var n,i=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0==r)return"0.0E+0";if(r<0)return"-"+e(t,-r);var o=t.indexOf("."),s=(-1===o&&(o=t.indexOf("E")),Math.floor(Math.log(r)*Math.LOG10E)%o);if(s<0&&(s+=o),-1===(n=(r/Math.pow(10,s)).toPrecision(1+i+(o+s)%o)).indexOf("e")){var a=Math.floor(Math.log(r)*Math.LOG10E);for(-1===n.indexOf(".")?n=n.charAt(0)+"."+n.substr(1)+"E+"+(a-n.length+s):n+="E+"+(a-s);"0."===n.substr(0,2);)n=(n=n.charAt(0)+n.substr(2,o)+"."+n.substr(2+o)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,r,n){return t+r+n.substr(0,(o+s)%o)+"."+n.substr(s)+"E"})}else n=r.toExponential(i);return t.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),(n=t.match(/E\-/)&&n.match(/e\+/)?n.replace(/e\+/,"e"):n).replace("e","E")}(t,r);if(36===t.charCodeAt(0))return"$"+Ue(e,t.substr(" "==t.charAt(1)?2:1),r);var a,l,c,u,d,h=Math.abs(r),p=r<0?"-":"";if(t.match(/^00+$/))return p+F(h,t.length);if(t.match(/^[#?]+$/))return(f="0"===(f=F(r,0))?"":f).length>t.length?f:Le(t.substr(0,t.length-f.length))+f;if(a=t.match(Me))return l=a,c=h,u=p,v=parseInt(l[4],10),c=Math.round(c*v),d=Math.floor(c/v),u+(0===d?"":""+d)+" "+(0==(c=c-d*v)?I(" ",l[1].length+1+l[4].length):k(c,l[1].length)+l[2]+"/"+l[3]+R(v,l[4].length));if(t.match(/^#+0+$/))return p+F(h,t.length-t.indexOf("0"));if(a=t.match(ke))return f=Fe(r,a[1].length).replace(/^([^\.]+)$/,"$1."+Le(a[1])).replace(/\.$/,"."+Le(a[1])).replace(/\.(\d*)$/,function(e,t){return"."+t+I("0",Le(a[1]).length-t.length)}),-1!==t.indexOf("0.")?f:f.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return p+Fe(h,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return p+Oe(F(h,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ue(e,t,-r):Oe(""+(Math.floor(r)+((d=a[1].length)<(""+Math.round((r-Math.floor(r))*Math.pow(10,d))).length?1:0)))+"."+R(He(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return Ue(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return f=x(Ue(e,t.replace(/[\\-]/g,""),r)),g=0,x(x(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return g<f.length?f.charAt(g++):"0"===e?"0":""}));if(t.match(Pe))return"("+(f=Ue(e,"##########",r)).substr(0,3)+") "+f.substr(3,3)+"-"+f.substr(6);var f,g,m,y,v="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return g=Math.min(a[4].length,7),y=j(h,Math.pow(10,g)-1,!1),f=p," "==(v=We("n",a[1],y[1])).charAt(v.length-1)&&(v=v.substr(0,v.length-1)+"0"),f+=v+a[2]+"/"+a[3],(v=L(y[2],g)).length<a[4].length&&(v=Le(a[4].substr(a[4].length-v.length))+v),f+=v;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return g=Math.min(Math.max(a[1].length,a[4].length),7),p+((y=j(h,Math.pow(10,g)-1,!0))[0]||(y[1]?"":"0"))+" "+(y[1]?k(y[1],g)+a[2]+"/"+a[3]+L(y[2],g):I(" ",2*g+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return f=F(r,0),t.length<=f.length?f:Le(t.substr(0,t.length-f.length))+f;if(a=t.match(/^([#0?]+)\.([#0]+)$/))return g=(f=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1")).indexOf("."),y=t.indexOf(".")-g,m=t.length-f.length-y,Le(t.substr(0,y)+f+t.substr(t.length-m));if(a=t.match(/^00,000\.([#0]*0)$/))return g=He(r,a[1].length),r<0?"-"+Ue(e,t,-r):Oe((y=r)<2147483647&&-2147483648<y?""+(0<=y?0|y:y-1|0):""+Math.floor(y)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?R(0,3-e.length):"")+e})+"."+R(g,a[1].length);switch(t){case"###,##0.00":return Ue(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var b=Oe(F(h,0));return"0"!==b?p+b:"";case"###,###.00":return Ue(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Ue(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Ve(e,t,r){if(40===e.charCodeAt(0)&&!t.match(De))return n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,""),0<=r?Ve("n",n,r):"("+Ve("n",n,-r)+")";if(44===t.charCodeAt(t.length-1)){for(var n=e,i=t,o=r,s=i.length-1;44===i.charCodeAt(s-1);)--s;return We(n,i.substr(0,s),o/Math.pow(10,3*(i.length-s)))}if(-1!==t.indexOf("%"))return o=e,l=r,c=(m=t).replace(Ie,""),m=m.length-c.length,We(o,c,l*Math.pow(10,2*m))+I("%",m);if(-1!==t.indexOf("E"))return function e(t,r){var n,i=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0==r)return"0.0E+0";if(r<0)return"-"+e(t,-r);var o,s=t.indexOf("."),a=(-1===s&&(s=t.indexOf("E")),Math.floor(Math.log(r)*Math.LOG10E)%s);a<0&&(a+=s),(n=(r/Math.pow(10,a)).toPrecision(1+i+(s+a)%s)).match(/[Ee]/)||(o=Math.floor(Math.log(r)*Math.LOG10E),-1===n.indexOf(".")?n=n.charAt(0)+"."+n.substr(1)+"E+"+(o-n.length+a):n+="E+"+(o-a),n=n.replace(/\+-/,"-")),n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,r,n){return t+r+n.substr(0,(s+a)%s)+"."+n.substr(a)+"E"})}else n=r.toExponential(i);return t.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),(n=t.match(/E\-/)&&n.match(/e\+/)?n.replace(/e\+/,"e"):n).replace("e","E")}(t,r);if(36===t.charCodeAt(0))return"$"+Ve(e,t.substr(" "==t.charAt(1)?2:1),r);var a,l,c,u=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+R(u,t.length);if(t.match(/^[#?]+$/))return(h=0===r?"":""+r).length>t.length?h:Le(t.substr(0,t.length-h.length))+h;if(a=t.match(Me))return d+(0===(c=u)?"":""+c)+I(" ",(l=a)[1].length+2+l[4].length);if(t.match(/^#+0+$/))return d+R(u,t.length-t.indexOf("0"));if(a=t.match(ke))return h=(h=(""+r).replace(/^([^\.]+)$/,"$1."+Le(a[1])).replace(/\.$/,"."+Le(a[1]))).replace(/\.(\d*)$/,function(e,t){return"."+t+I("0",Le(a[1]).length-t.length)}),-1!==t.indexOf("0.")?h:h.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return d+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return d+Oe(""+u);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ve(e,t,-r):Oe(""+r)+"."+I("0",a[1].length);if(a=t.match(/^#,#*,#0/))return Ve(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return h=x(Ve(e,t.replace(/[\\-]/g,""),r)),p=0,x(x(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return p<h.length?h.charAt(p++):"0"===e?"0":""}));if(t.match(Pe))return"("+(h=Ve(e,"##########",r)).substr(0,3)+") "+h.substr(3,3)+"-"+h.substr(6);var h,p,f,g,m="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return p=Math.min(a[4].length,7),f=j(u,Math.pow(10,p)-1,!1),h=d," "==(m=We("n",a[1],f[1])).charAt(m.length-1)&&(m=m.substr(0,m.length-1)+"0"),h+=m+a[2]+"/"+a[3],(m=L(f[2],p)).length<a[4].length&&(m=Le(a[4].substr(a[4].length-m.length))+m),h+=m;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return p=Math.min(Math.max(a[1].length,a[4].length),7),d+((f=j(u,Math.pow(10,p)-1,!0))[0]||(f[1]?"":"0"))+" "+(f[1]?k(f[1],p)+a[2]+"/"+a[3]+L(f[2],p):I(" ",2*p+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return h=""+r,t.length<=h.length?h:Le(t.substr(0,t.length-h.length))+h;if(a=t.match(/^([#0]+)\.([#0]+)$/))return p=(h=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1")).indexOf("."),f=t.indexOf(".")-p,g=t.length-h.length-f,Le(t.substr(0,f)+h+t.substr(t.length-g));if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Ve(e,t,-r):Oe(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?R(0,3-e.length):"")+e})+"."+R(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var y=Oe(""+u);return"0"!==y?d+y:"";default:if(t.match(/\.[0#?]*$/))return Ve(e,t.slice(0,t.lastIndexOf(".")),r)+Le(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function We(e,t,r){return((0|r)===r?Ve:Ue)(e,t,r)}var $e=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Be(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":H(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("上午/下午"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(n=r;"]"!==e.charAt(t++)&&t<e.length;)n+=e.charAt(t);if(n.match($e))return!0;break;case".":case"0":case"#":for(;t<e.length&&(-1<"0#?.,E+-%".indexOf(r=e.charAt(++t))||"\\"==r&&"-"==e.charAt(t+1)&&-1<"0#".indexOf(e.charAt(t+2))););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&-1<"0123456789".indexOf(e.charAt(++t)););break;default:++t}return!1}function je(e,t,r,n){for(var i,o,s,a=[],l="",c=0,u="",d="t",h="H";c<e.length;)switch(u=e.charAt(c)){case"G":if(!H(e,c))throw new Error("unrecognized character "+u+" in "+e);a[a.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";34!==(s=e.charCodeAt(++c))&&c<e.length;)l+=String.fromCharCode(s);a[a.length]={t:"t",v:l},++c;break;case"\\":var p=e.charAt(++c);a[a.length]={t:"("===p||")"===p?p:"t",v:p},++c;break;case"_":a[a.length]={t:"t",v:" "},c+=2;break;case"@":a[a.length]={t:"T",v:t},++c;break;case"B":case"b":if("1"===e.charAt(c+1)||"2"===e.charAt(c+1)){if(null==i&&null==(i=z(t,r,"2"===e.charAt(c+1))))return"";a[a.length]={t:"X",v:e.substr(c,2)},d=u,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==i&&null==(i=z(t,r)))return"";for(l=u;++c<e.length&&e.charAt(c).toLowerCase()===u;)l+=u;"h"===(u="m"===u&&"h"===d.toLowerCase()?"M":u)&&(u=h),a[a.length]={t:u,v:l},d=u;break;case"A":case"a":case"上":p={t:u,v:u};if(null==i&&(i=z(t,r)),"A/P"===e.substr(c,3).toUpperCase()?(null!=i&&(p.v=12<=i.H?"P":"A"),p.t="T",h="h",c+=3):"AM/PM"===e.substr(c,5).toUpperCase()?(null!=i&&(p.v=12<=i.H?"PM":"AM"),p.t="T",c+=5,h="h"):"上午/下午"===e.substr(c,5).toUpperCase()?(null!=i&&(p.v=12<=i.H?"下午":"上午"),p.t="T",c+=5,h="h"):(p.t="t",++c),null==i&&"T"===p.t)return"";a[a.length]=p,d=u;break;case"[":for(l=u;"]"!==e.charAt(c++)&&c<e.length;)l+=e.charAt(c);if("]"!==l.slice(-1))throw'unterminated "[" block: |'+l+"|";if(l.match($e)){if(null==i&&null==(i=z(t,r)))return"";a[a.length]={t:"Z",v:l.toLowerCase()},d=l.charAt(1)}else-1<l.indexOf("$")&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",Be(e)||(a[a.length]={t:"t",v:l}));break;case".":if(null!=i){for(l=u;++c<e.length&&"0"===(u=e.charAt(c));)l+=u;a[a.length]={t:"s",v:l};break}case"0":case"#":for(l=u;++c<e.length&&-1<"0#?.,E+-%".indexOf(u=e.charAt(c));)l+=u;a[a.length]={t:"n",v:l};break;case"?":for(l=u;e.charAt(++c)===u;)l+=u;a[a.length]={t:u,v:l},d=u;break;case"*":++c," "!=e.charAt(c)&&"*"!=e.charAt(c)||++c;break;case"(":case")":a[a.length]={t:1===n?"t":u,v:u},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=u;c<e.length&&-1<"0123456789".indexOf(e.charAt(++c));)l+=e.charAt(c);a[a.length]={t:"D",v:l};break;case" ":a[a.length]={t:u,v:u},++c;break;case"$":a[a.length]={t:"t",v:"$"},++c;break;default:if(-1===",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(u))throw new Error("unrecognized character "+u+" in "+e);a[a.length]={t:"t",v:u},++c}var f,g=0,m=0;for(c=a.length-1,d="t";0<=c;--c)switch(a[c].t){case"h":case"H":a[c].t=h,d="h",g<1&&(g=1);break;case"s":(f=a[c].v.match(/\.0+$/))&&(m=Math.max(m,f[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":d=a[c].t;break;case"m":"s"===d&&(a[c].t="M",g<2)&&(g=2);break;case"X":break;case"Z":(g=(g=g<1&&a[c].v.match(/[Hh]/)?1:g)<2&&a[c].v.match(/[Mm]/)?2:g)<3&&a[c].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:.5<=i.u&&(i.u=0,++i.S),60<=i.S&&(i.S=0,++i.M),60<=i.M&&(i.M=0,++i.H);break;case 2:.5<=i.u&&(i.u=0,++i.S),60<=i.S&&(i.S=0,++i.M)}var y="";for(c=0;c<a.length;++c)switch(a[c].t){case"t":case"T":case" ":case"D":break;case"X":a[c].v="",a[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[c].v=function(e,t,r,n){var i,o="",s=0,a=0,l=r.y,c=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:i=l%100,c=2;break;default:i=l%1e4,c=4}break;case 109:switch(t.length){case 1:case 2:i=r.m,c=t.length;break;case 3:return V[r.m-1][1];case 5:return V[r.m-1][0];default:return V[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:i=r.d,c=t.length;break;case 3:return U[r.q][0];default:return U[r.q][1]}break;case 104:switch(t.length){case 1:case 2:i=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:i=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:i=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==r.u||"s"!=t&&"ss"!=t?(60*(a=2<=n?3===n?1e3:100:1===n?10:1)<=(s=Math.round(a*(r.S+r.u)))&&(s=0),"s"===t?0===s?"0":""+s/a:(o=R(s,2+n),"ss"===t?o.substr(0,2):"."+o.substr(2,t.length-1))):R(r.S,t.length);case 90:switch(t){case"[h]":case"[hh]":i=24*r.D+r.H;break;case"[m]":case"[mm]":i=60*(24*r.D+r.H)+r.M;break;case"[s]":case"[ss]":i=60*(60*(24*r.D+r.H)+r.M)+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=3===t.length?1:2;break;case 101:i=l,c=1}return 0<c?R(i,c):""}(a[c].t.charCodeAt(0),a[c].v,i,m),a[c].t="t";break;case"n":case"?":for(C=c+1;null!=a[C]&&("?"===(u=a[C].t)||"D"===u||(" "===u||"t"===u)&&null!=a[C+1]&&("?"===a[C+1].t||"t"===a[C+1].t&&"/"===a[C+1].v)||"("===a[c].t&&(" "===u||"n"===u||")"===u)||"t"===u&&("/"===a[C].v||" "===a[C].v&&null!=a[C+1]&&"?"==a[C+1].t));)a[c].v+=a[C].v,a[C]={v:"",t:";"},++C;y+=a[c].v,c=C-1;break;case"G":a[c].t="t",a[c].v=Ne(t,r)}var v,b,w="";if(0<y.length){40==y.charCodeAt(0)?(v=t<0&&45===y.charCodeAt(0)?-t:t,b=We("n",y,v)):(b=We("n",y,v=t<0&&1<n?-t:t),v<0&&a[0]&&"t"==a[0].t&&(b=b.substr(1),a[0].v="-"+a[0].v));for(var C=b.length-1,E=a.length,c=0;c<a.length;++c)if(null!=a[c]&&"t"!=a[c].t&&-1<a[c].v.indexOf(".")){E=c;break}var T=a.length;if(E===a.length&&-1===b.indexOf("E")){for(c=a.length-1;0<=c;--c)null!=a[c]&&-1!=="n?".indexOf(a[c].t)&&(C>=a[c].v.length-1?(C-=a[c].v.length,a[c].v=b.substr(C+1,a[c].v.length)):C<0?a[c].v="":(a[c].v=b.substr(0,C+1),C=-1),a[c].t="t",T=c);0<=C&&T<a.length&&(a[T].v=b.substr(0,C+1)+a[T].v)}else if(E!==a.length&&-1===b.indexOf("E")){for(C=b.indexOf(".")-1,c=E;0<=c;--c)if(null!=a[c]&&-1!=="n?".indexOf(a[c].t)){for(o=-1<a[c].v.indexOf(".")&&c===E?a[c].v.indexOf(".")-1:a[c].v.length-1,w=a[c].v.substr(o+1);0<=o;--o)0<=C&&("0"===a[c].v.charAt(o)||"#"===a[c].v.charAt(o))&&(w=b.charAt(C--)+w);a[c].v=w,a[c].t="t",T=c}for(0<=C&&T<a.length&&(a[T].v=b.substr(0,C+1)+a[T].v),C=b.indexOf(".")+1,c=E;c<a.length;++c)if(null!=a[c]&&(-1!=="n?(".indexOf(a[c].t)||c===E)){for(o=-1<a[c].v.indexOf(".")&&c===E?a[c].v.indexOf(".")+1:0,w=a[c].v.substr(0,o);o<a[c].v.length;++o)C<b.length&&(w+=b.charAt(C++));a[c].v=w,a[c].t="t",T=c}}}for(c=0;c<a.length;++c)null!=a[c]&&-1<"n?".indexOf(a[c].t)&&(v=1<n&&t<0&&0<c&&"-"===a[c-1].v?-t:t,a[c].v=We(a[c].t,a[c].v,v),a[c].t="t");var S="";for(c=0;c!==a.length;++c)null!=a[c]&&(S+=a[c].v);return S}var ze=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Ye(e,t){if(null!=t){var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return 1;break;case">":if(r<e)return 1;break;case"<":if(e<r)return 1;break;case"<>":if(e!=r)return 1;break;case">=":if(r<=e)return 1;break;case"<=":if(e<=r)return 1}}}function Ge(e,t){var r=function(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),!0===r)throw new Error("Format |"+e+"| unterminated string ");return t}(e),e=r.length,n=r[e-1].indexOf("@");if(e<4&&-1<n&&--e,4<r.length)throw new Error("cannot find right format for |"+r.join("|")+"|");if("number"!=typeof t)return[4,4===r.length||-1<n?r[r.length-1]:"@"];switch(r.length){case 1:r=-1<n?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=-1<n?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=-1<n?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"]}var i,o,s=0<t?r[0]:t<0?r[1]:r[2];return!(-1===r[0].indexOf("[")&&-1===r[1].indexOf("[")||null==r[0].match(/\[[=<>]/)&&null==r[1].match(/\[[=<>]/))?(i=r[0].match(ze),o=r[1].match(ze),Ye(t,i)?[e,r[0]]:Ye(t,o)?[e,r[1]]:[e,r[null!=i&&null!=o?2:1]]):[e,s]}function qe(e,t,r){null==r&&(r={});var n="";switch(typeof e){case"string":n="m/d/yy"==e&&r.dateNF?r.dateNF:e;break;case"number":null==(n=null==(n=14==e&&r.dateNF?r.dateNF:(null!=r.table?r.table:ue)[e])?r.table&&r.table[o[e]]||ue[o[e]]:n)&&(n=b[e]||"General")}if(H(n,0))return Ne(t,r);var i=Ge(n,t=t instanceof Date?ne(t,r.date1904):t);if(H(i[1]))return Ne(t,r);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return je(i[1],t,r,i[0])}function Ke(e,t){if("number"!=typeof t){t=+t||-1;for(var r=0;r<392;++r)if(null==ue[r])t<0&&(t=r);else if(ue[r]==e){t=r;break}t<0&&(t=391)}return ue[t]=e,t}function Xe(e){for(var t=0;392!=t;++t)void 0!==e[t]&&Ke(e[t],t)}function Je(){var e;(e=e||{})[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',ue=e}var Ze={format:qe,load:Ke,_table:ue,load_table:Xe,parse_date_code:z,is_date:Be,get_table:function(){return Ze._table=ue}},Qe={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},et=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;(Nt={}).version="1.2.0",tt=function(){for(var e,t=new Array(256),r=0;256!=r;++r)t[e=r]=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&e?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1;return"undefined"!=typeof Int32Array?new Int32Array(t):t}(),e=function(e){for(var t=0,r=0,n=0,i=new("undefined"!=typeof Int32Array?Int32Array:Array)(4096),n=0;256!=n;++n)i[n]=e[n];for(n=0;256!=n;++n)for(r=e[n],t=256+n;t<4096;t+=256)r=i[t]=r>>>8^e[255&r];var o=[];for(n=1;16!=n;++n)o[n-1]="undefined"!=typeof Int32Array?i.subarray(256*n,256*n+256):i.slice(256*n,256*n+256);return o}(tt),rt=e[0],nt=e[1],it=e[2],ot=e[3],st=e[4],at=e[5],lt=e[6],ct=e[7],ut=e[8],dt=e[9],ht=e[10],pt=e[11],ft=e[12],gt=e[13],mt=e[14],Nt.table=tt,Nt.bstr=function(e,t){for(var r=-1^t,n=0,i=e.length;n<i;)r=r>>>8^tt[255&(r^e.charCodeAt(n++))];return~r},Nt.buf=function(e,t){for(var r=-1^t,n=e.length-15,i=0;i<n;)r=mt[e[i++]^255&r]^gt[e[i++]^r>>8&255]^ft[e[i++]^r>>16&255]^pt[e[i++]^r>>>24]^ht[e[i++]]^dt[e[i++]]^ut[e[i++]]^ct[e[i++]]^lt[e[i++]]^at[e[i++]]^st[e[i++]]^ot[e[i++]]^it[e[i++]]^nt[e[i++]]^rt[e[i++]]^tt[e[i++]];for(n+=15;i<n;)r=r>>>8^tt[255&(r^e[i++])];return~r},Nt.str=function(e,t){for(var r,n=-1^t,i=0,o=e.length,s=0;i<o;)n=(s=e.charCodeAt(i++))<128?n>>>8^tt[255&(n^s)]:s<2048?(n=n>>>8^tt[255&(n^(192|s>>6&31))])>>>8^tt[255&(n^(128|63&s))]:55296<=s&&s<57344?(s=64+(1023&s),r=1023&e.charCodeAt(i++),(n=(n=(n=n>>>8^tt[255&(n^(240|s>>8&7))])>>>8^tt[255&(n^(128|s>>2&63))])>>>8^tt[255&(n^(128|r>>6&15|(3&s)<<4))])>>>8^tt[255&(n^(128|63&r))]):(n=(n=n>>>8^tt[255&(n^(224|s>>12&15))])>>>8^tt[255&(n^(128|s>>6&63))])>>>8^tt[255&(n^(128|63&s))];return~n};var tt,rt,nt,it,ot,st,at,lt,ct,ut,dt,ht,pt,ft,gt,mt,yt,vt=Nt,X=function(){var i,e={};function p(e){var t;return"/"==e.charAt(e.length-1)?-1===e.slice(0,-1).indexOf("/")?e:p(e.slice(0,-1)):-1===(t=e.lastIndexOf("/"))?e:e.slice(0,t+1)}function f(e){var t;return"/"==e.charAt(e.length-1)?f(e.slice(0,-1)):-1===(t=e.lastIndexOf("/"))?e:e.slice(t+1)}function x(e){hn(e,0);for(var t,r={};e.l<=e.length-4;){var n=e._R(2),i=e._R(2),o=e.l+i,s={};21589===n&&(1&(t=e._R(1))&&(s.mtime=e._R(4)),5<i&&(2&t&&(s.atime=e._R(4)),4&t)&&(s.ctime=e._R(4)),s.mtime)&&(s.mt=new Date(1e3*s.mtime)),e.l=o,r[n]=s}return r}function o(){i=i||void 0}function s(e,t){if(80==e[0]&&75==e[1])return le(e,t);if(109==(32|e[0])&&105==(32|e[1])){var r=e,n=t;if("mime-version:"!=se(r.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var i=n&&n.root||"",o=(ce&&Buffer.isBuffer(r)?r.toString("binary"):se(r)).split("\r\n"),s=0,a="";for(s=0;s<o.length;++s)if(a=o[s],/^Content-Location:/i.test(a)&&(a=a.slice(a.indexOf("file")),i=i||a.slice(0,a.lastIndexOf("/")+1),a.slice(0,i.length)!=i))for(;0<i.length&&(i=(i=i.slice(0,i.length-1)).slice(0,i.lastIndexOf("/")+1),a.slice(0,i.length)!=i););if(!(n=(o[1]||"").match(/boundary="(.*?)"/)))throw new Error("MAD cannot find boundary");var L="--"+(n[1]||""),l={FileIndex:[],FullPaths:[]};ne(l);var F,H=0;for(s=0;s<o.length;++s){var U=o[s];U!==L&&U!==L+"--"||(H++&&!function(e,t,r){for(var n,i="",o="",s="",a=0;a<10;++a){var l=t[a];if(!l||l.match(/^\s*$/))break;var c=l.match(/^(.*?):\s*([^\s].*)$/);if(c)switch(c[1].toLowerCase()){case"content-location":i=c[2].trim();break;case"content-type":s=c[2].trim();break;case"content-transfer-encoding":o=c[2].trim()}}switch(++a,o.toLowerCase()){case"base64":n=xe(_e(t.slice(a).join("")));break;case"quoted-printable":n=function(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r];r<=e.length&&"="==n.charAt(n.length-1);)n=n.slice(0,n.length-1)+e[++r];t.push(n)}for(var i=0;i<t.length;++i)t[i]=t[i].replace(/[=][0-9A-Fa-f]{2}/g,function(e){return String.fromCharCode(parseInt(e.slice(1),16))});return xe(t.join("\r\n"))}(t.slice(a));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+o)}e=ae(e,i.slice(r.length),n,{unsafe:!0});s&&(e.ctype=s)}(l,o.slice(F,s),i),F=s)}return l}if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var c,u=512,d=[],h=e.slice(0,512),V=(hn(h,0),function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(oe,"Header Signature: "),e.l+=16;var t=e._R(2,"u");return[e._R(2,"u"),t]}(h));switch(c=V[0]){case 3:u=512;break;case 4:u=4096;break;case 0:if(0==V[1])return le(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+c)}512!==u&&hn(h=e.slice(0,u),28);var r=e.slice(0,u),n=h,W=c,p=9;switch(n.l+=2,p=n._R(2)){case 9:if(3!=W)throw new Error("Sector Shift: Expected 9 saw "+p);break;case 12:if(4!=W)throw new Error("Sector Shift: Expected 12 saw "+p);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+p)}n.chk("0600","Mini Sector Shift: "),n.chk("000000000000","Reserved: ");var f=h._R(4,"i");if(3===c&&0!==f)throw new Error("# Directory Sectors: Expected 0 saw "+f);h.l+=4,f=h._R(4,"i"),h.l+=4,h.chk("00100000","Mini Stream Cutoff Size: ");for(var $,g=h._R(4,"i"),B=h._R(4,"i"),m=h._R(4,"i"),y=h._R(4,"i"),v=0;v<109&&!(($=h._R(4,"i"))<0);++v)d[v]=$;for(var b,w=function(e,t){for(var r=Math.ceil(e.length/t)-1,n=[],i=1;i<r;++i)n[i-1]=e.slice(i*t,(i+1)*t);return n[r-1]=e.slice(r*t),n}(e,u),m=(!function e(t,r,n,i,o){var s=ie;if(t===ie){if(0!==r)throw new Error("DIFAT chain shorter than expected")}else if(-1!==t){var a=n[t],l=(i>>>2)-1;if(a){for(var c=0;c<l&&(s=nn(a,4*c))!==ie;++c)o.push(s);e(nn(a,i-4),r-1,n,i,o)}}}(m,y,w,u,d),function(e,t,r,n){var i=e.length,o=[],s=[],a=[],l=[],c=n-1,u=0,d=0,h=0,p=0;for(u=0;u<i;++u)if(a=[],i<=(h=u+t)&&(h-=i),!s[h]){l=[];var f=[];for(d=h;0<=d;){s[d]=f[d]=!0,a[a.length]=d,l.push(e[d]);var g=r[Math.floor(4*d/n)];if(n<4+(p=4*d&c))throw new Error("FAT boundary crossed: "+d+" 4 "+n);if(!e[g])break;if(d=nn(e[g],p),f[d])break}o[h]={nodes:a,data:$r([l])}}return o}(w,f,d,u)),y=(m[f].name="!Directory",0<B&&g!==ie&&(m[g].name="!MiniFAT"),m[d[0]].name="!FAT",m.fat_addrs=d,m.ssz=u,[]),C=[],j=[],E=m,z=w,Y=y,G=B,q={},K=C,X=g,T=0,J=Y.length?2:0,Z=E[f].data,S=0,Q=0;S<Z.length;S+=128){var _=Z.slice(S,S+128),x=(hn(_,64),Q=_._R(2),b=Br(_,0,Q-J),Y.push(b),{name:b,type:_._R(1),color:_._R(1),L:_._R(4,"i"),R:_._R(4,"i"),C:_._R(4,"i"),clsid:_._R(16),state:_._R(4,"i"),start:0,size:0});0!==_._R(2)+_._R(2)+_._R(2)+_._R(2)&&(x.ct=re(_,_.l-8)),0!==_._R(2)+_._R(2)+_._R(2)+_._R(2)&&(x.mt=re(_,_.l-8)),x.start=_._R(4,"i"),x.size=_._R(4,"i"),x.size<0&&x.start<0&&(x.size=x.type=0,x.start=ie,x.name=""),5===x.type?(T=x.start,0<G&&T!==ie&&(E[T].name="!StreamData")):4096<=x.size?(x.storage="fat",void 0===E[x.start]&&(E[x.start]=function(e,t,r,n,i){var o=[],s=[];i=i||[];var a=n-1,l=0,c=0;for(l=t;0<=l;){i[l]=!0,o[o.length]=l,s.push(e[l]);var u=r[Math.floor(4*l/n)];if(n<4+(c=4*l&a))throw new Error("FAT boundary crossed: "+l+" 4 "+n);if(!e[u])break;l=nn(e[u],c)}return{nodes:o,data:$r([s])}}(z,x.start,E.fat_addrs,E.ssz)),E[x.start].name=x.name,x.content=E[x.start].data.slice(0,x.size)):(x.storage="minifat",x.size<0?x.size=0:T!==ie&&x.start!==ie&&E[T]&&(x.content=function(e,t,r){var n=e.start,i=e.size,o=[],s=n;for(;r&&0<i&&0<=s;)o.push(t.slice(64*s,64*s+64)),i-=64,s=nn(r,4*s);return 0===o.length?ye(0):Re(o).slice(0,e.size)}(x,E[T].data,(E[X]||{}).data))),x.content&&hn(x.content,0),q[b]=x,K.push(x)}for(var R=C,A=j,ee=y,N=0,O=0,I=0,te=0,M=0,k=ee.length,D=[],P=[];N<k;++N)D[N]=P[N]=N,A[N]=ee[N];for(;M<P.length;++M)O=R[N=P[M]].L,I=R[N].R,te=R[N].C,D[N]===N&&(-1!==O&&D[O]!==O&&(D[N]=D[O]),-1!==I)&&D[I]!==I&&(D[N]=D[I]),-1!==te&&(D[te]=N),-1!==O&&N!=D[N]&&(D[O]=D[N],P.lastIndexOf(O)<M)&&P.push(O),-1!==I&&N!=D[N]&&(D[I]=D[N],P.lastIndexOf(I)<M)&&P.push(I);for(N=1;N<k;++N)D[N]===N&&(-1!==I&&D[I]!==I?D[N]=D[I]:-1!==O&&D[O]!==O&&(D[N]=D[O]));for(N=1;N<k;++N)if(0!==R[N].type){if((M=N)!=D[M])for(;M=D[M],A[N]=A[M]+"/"+A[N],0!==M&&-1!==D[M]&&M!=D[M];);D[N]=-1}for(A[0]+="/",N=1;N<k;++N)2!==R[N].type&&(A[N]+="/");y.shift();m={FileIndex:C,FullPaths:j};return t&&t.raw&&(m.raw={header:r,sectors:w}),m}function re(e,t){return new Date(1e3*(rn(e,t+4)/1e7*Math.pow(2,32)+rn(e,t)/1e7-11644473600))}function ne(e,t){var t=t||{},r=t.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=r+"/",e.FileIndex[0]={name:r,type:5}),t.CLSID&&(e.FileIndex[0].clsid=t.CLSID),r=e,t="Sh33tJ5",X.find(r,"/"+t)||((e=ye(4))[0]=55,e[1]=e[3]=50,e[2]=54,r.FileIndex.push({name:t,type:2,content:e,size:4,L:69,R:69,C:69}),r.FullPaths.push(r.FullPaths[0]+t),j(r))}function j(e,t){ne(e);for(var r=!1,n=!1,i=e.FullPaths.length-1;0<=i;--i){var o=e.FileIndex[i];switch(o.type){case 0:n?r=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:n=!0,isNaN(o.R*o.L*o.C)&&(r=!0),-1<o.R&&-1<o.L&&o.R==o.L&&(r=!0);break;default:r=!0}}if(r||t){for(var s=new Date(1987,1,19),a=0,l=Object.create?Object.create(null):{},c=[],i=0;i<e.FullPaths.length;++i)l[e.FullPaths[i]]=!0,0!==e.FileIndex[i].type&&c.push([e.FullPaths[i],e.FileIndex[i]]);for(i=0;i<c.length;++i){var u=p(c[i][0]);(n=l[u])||(c.push([u,{name:f(u).replace("/",""),type:1,clsid:g,ct:s,mt:s,content:null}]),l[u]=!0)}for(c.sort(function(e,t){for(var r,e=e[0],t=t[0],n=e.split("/"),i=t.split("/"),o=0,s=Math.min(n.length,i.length);o<s;++o){if(r=n[o].length-i[o].length)return r;if(n[o]!=i[o])return n[o]<i[o]?-1:1}return n.length-i.length}),e.FullPaths=[],e.FileIndex=[],i=0;i<c.length;++i)e.FullPaths[i]=c[i][0],e.FileIndex[i]=c[i][1];for(i=0;i<c.length;++i){var d=e.FileIndex[i],h=e.FullPaths[i];if(d.name=f(h).replace("/",""),d.L=d.R=d.C=-(d.color=1),d.size=d.content?d.content.length:0,d.start=0,d.clsid=d.clsid||g,0===i)d.C=1<c.length?1:-1,d.size=0,d.type=5;else if("/"==h.slice(-1)){for(a=i+1;a<c.length&&p(e.FullPaths[a])!=h;++a);for(d.C=c.length<=a?-1:a,a=i+1;a<c.length&&p(e.FullPaths[a])!=p(h);++a);d.R=c.length<=a?-1:a,d.type=1}else p(e.FullPaths[i+1]||"")==p(h)&&(d.R=i+1),d.type=2}}}function n(e,t){var r=t||{};if("mad"==r.fileType){for(var n=e,L=r||{},i=L.boundary||"SheetJS",o=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(i="------="+i).slice(2)+'"',"","",""],F=n.FullPaths[0],s=F,a=n.FileIndex[0],l=1;l<n.FullPaths.length;++l)if(s=n.FullPaths[l].slice(F.length),(a=n.FileIndex[l]).size&&a.content&&"Sh33tJ5"!=s){s=s.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"});for(var c=a.content,u=ce&&Buffer.isBuffer(c)?c.toString("binary"):se(c),H=0,U=Math.min(1024,u.length),V=0,d=0;d<=U;++d)32<=(V=u.charCodeAt(d))&&V<128&&++H;c=4*U/5<=H;o.push(i),o.push("Content-Location: "+(L.root||"file:///C:/SheetJS/")+s),o.push("Content-Transfer-Encoding: "+(c?"quoted-printable":"base64")),o.push("Content-Type: "+function(e,t){if(e.ctype)return e.ctype;var e=e.name||"",r=e.match(/\.([^\.]+)$/);if(r&&G[r[1]])return G[r[1]];if(t&&(r=(e=t).match(/[\.\\]([^\.\\])+$/))&&G[r[1]])return G[r[1]];return"application/octet-stream"}(a,s)),o.push(""),o.push((c?function(e){e=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(e){e=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==e.length?"0"+e:e)});"\n"==(e=e.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(e="=0D"+e.slice(1));e=e.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A");for(var t=[],r=e.split("\r\n"),n=0;n<r.length;++n){var i=r[n];if(0==i.length)t.push("");else for(var o=0;o<i.length;){var s=76,a=i.slice(o,o+s);"="==a.charAt(s-1)?s--:"="==a.charAt(s-2)?s-=2:"="==a.charAt(s-3)&&(s-=3),a=i.slice(o,o+s),(o+=s)<i.length&&(a+="="),t.push(a)}}return t.join("\r\n")}:function(e){for(var t=J(e),r=[],n=0;n<t.length;n+=76)r.push(t.slice(n,n+76));return r.join("\r\n")+"\r\n"})(u))}return o.push(i+"--\r\n"),o.join("\r\n")}if(j(e),"zip"===r.fileType){var h=e,t=(t=r)||{},p=[],f=[],g=ye(1),m=t.compression?8:0,y=0,v=0,b=0,w=0,C=0,W=h.FullPaths[0],E=W,T=h.FileIndex[0],S=[],$=0;for(v=1;v<h.FullPaths.length;++v)if(E=h.FullPaths[v].slice(W.length),(T=h.FileIndex[v]).size&&T.content&&"Sh33tJ5"!=E){var B=w,_=ye(E.length);for(b=0;b<E.length;++b)_._W(1,127&E.charCodeAt(b));_=_.slice(0,_.l),S[C]=vt.buf(T.content,0);var x=T.content;8==m&&(x=function(e){return z?z.deflateRawSync(e):K(e)}(x)),(g=ye(30))._W(4,67324752),g._W(2,20),g._W(2,y),g._W(2,m),T.mt?function(e,t){var r;r=((t="string"==typeof t?new Date(t):t).getHours()<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e._W(2,r),r=(t.getFullYear()-1980<<4|t.getMonth()+1)<<5|t.getDate(),e._W(2,r)}(g,T.mt):g._W(4,0),g._W(-4,8&y?0:S[C]),g._W(4,8&y?0:x.length),g._W(4,8&y?0:T.content.length),g._W(2,_.length),g._W(2,0),w+=g.length,p.push(g),w+=_.length,p.push(_),w+=x.length,p.push(x),8&y&&((g=ye(12))._W(-4,S[C]),g._W(4,x.length),g._W(4,T.content.length),w+=g.l,p.push(g)),(g=ye(46))._W(4,33639248),g._W(2,0),g._W(2,20),g._W(2,y),g._W(2,m),g._W(4,0),g._W(-4,S[C]),g._W(4,x.length),g._W(4,T.content.length),g._W(2,_.length),g._W(2,0),g._W(2,0),g._W(2,0),g._W(2,0),g._W(4,0),g._W(4,B),$+=g.l,f.push(g),$+=_.length,f.push(_),++C}return(g=ye(22))._W(4,101010256),g._W(2,0),g._W(2,0),g._W(2,C),g._W(2,C),g._W(4,$),g._W(4,w),g._W(2,0),Re([Re(p),Re(f),g])}for(var R=function(e){for(var t=0,r=0,n=0;n<e.FileIndex.length;++n){var i=e.FileIndex[n];i.content&&0<(i=i.content.length)&&(i<4096?t+=i+63>>6:r+=i+511>>9)}for(var o=e.FullPaths.length+3>>2,s=t+127>>7,a=(t+7>>3)+r+o+s,l=a+127>>7,c=l<=109?0:Math.ceil((l-109)/127);l<a+l+c+127>>7;)c=++l<=109?0:Math.ceil((l-109)/127);s=[1,c,l,s,o,r,t,0];return e.FileIndex[0].size=t<<6,s[7]=(e.FileIndex[0].start=s[0]+s[1]+s[2]+s[3]+s[4]+s[5])+(s[6]+7>>3),s}(e),A=ye(R[7]<<9),N=0,O=0,N=0;N<8;++N)A._W(1,q[N]);for(N=0;N<8;++N)A._W(2,0);for(A._W(2,62),A._W(2,3),A._W(2,65534),A._W(2,9),A._W(2,6),N=0;N<3;++N)A._W(2,0);for(A._W(4,0),A._W(4,R[2]),A._W(4,R[0]+R[1]+R[2]+R[3]-1),A._W(4,0),A._W(4,4096),A._W(4,R[3]?R[0]+R[1]+R[2]-1:ie),A._W(4,R[3]),A._W(-4,R[1]?R[0]-1:ie),A._W(4,R[1]),N=0;N<109;++N)A._W(-4,N<R[2]?R[1]+N:-1);if(R[1])for(O=0;O<R[1];++O){for(;N<236+127*O;++N)A._W(-4,N<R[2]?R[1]+N:-1);A._W(-4,O===R[1]-1?ie:O+1)}function I(e){for(O+=e;N<O-1;++N)A._W(-4,N+1);e&&(++N,A._W(-4,ie))}O=N=0;for(O+=R[1];N<O;++N)A._W(-4,Y.DIFSECT);for(O+=R[2];N<O;++N)A._W(-4,Y.FATSECT);I(R[3]),I(R[4]);for(var M=0,k=0,D=e.FileIndex[0];M<e.FileIndex.length;++M)!(D=e.FileIndex[M]).content||(k=D.content.length)<4096||(D.start=O,I(k+511>>9));for(I(R[6]+7>>3);511&A.l;)A._W(-4,Y.ENDOFCHAIN);for(M=O=N=0;M<e.FileIndex.length;++M)!(D=e.FileIndex[M]).content||!(k=D.content.length)||4096<=k||(D.start=O,I(k+63>>6));for(;511&A.l;)A._W(-4,Y.ENDOFCHAIN);for(N=0;N<R[4]<<2;++N){var P=e.FullPaths[N];if(P&&0!==P.length){D=e.FileIndex[N],0===N&&(D.start=D.size?D.start-1:ie);P=0===N&&r.root||D.name,k=2*(P.length+1);if(A._W(64,P,"utf16le"),A._W(2,k),A._W(1,D.type),A._W(1,D.color),A._W(-4,D.L),A._W(-4,D.R),A._W(-4,D.C),D.clsid)A._W(16,D.clsid,"hex");else for(M=0;M<4;++M)A._W(4,0);A._W(4,D.state||0),A._W(4,0),A._W(4,0),A._W(4,0),A._W(4,0),A._W(4,D.start),A._W(4,D.size),A._W(4,0)}else{for(M=0;M<17;++M)A._W(4,0);for(M=0;M<3;++M)A._W(4,-1);for(M=0;M<12;++M)A._W(4,0)}}for(N=1;N<e.FileIndex.length;++N)if(4096<=(D=e.FileIndex[N]).size)if(A.l=D.start+1<<9,ce&&Buffer.isBuffer(D.content))D.content.copy(A,A.l,0,D.size),A.l+=D.size+511&-512;else{for(M=0;M<D.size;++M)A._W(1,D.content[M]);for(;511&M;++M)A._W(1,0)}for(N=1;N<e.FileIndex.length;++N)if(0<(D=e.FileIndex[N]).size&&D.size<4096)if(ce&&Buffer.isBuffer(D.content))D.content.copy(A,A.l,0,D.size),A.l+=D.size+63&-64;else{for(M=0;M<D.size;++M)A._W(1,D.content[M]);for(;63&M;++M)A._W(1,0)}if(ce)A.l=A.length;else for(;A.l<A.length;)A._W(1,0);return A}e.version="1.2.1";var z,ie=-2,oe="d0cf11e0a1b11ae1",q=[208,207,17,224,161,177,26,225],g="00000000000000000000000000000000",Y={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ie,FREESECT:-1,HEADER_SIGNATURE:oe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:g,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function se(e){for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}var I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],E=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],T=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];for(var t,_="undefined"!=typeof Uint8Array,R=_?new Uint8Array(256):[],r=0;r<256;++r)R[r]=255&((t=139536&((t=r)<<1|t<<11)|558144&(t<<5|t<<15))>>16|t>>8|t);function A(e,t){var r=7&t,t=t>>>3;return(e[t]|(r<=5?0:e[1+t]<<8))>>>r&7}function M(e,t){var r=7&t,t=t>>>3;return(e[t]|(r<=3?0:e[1+t]<<8))>>>r&31}function k(e,t){var r=7&t,t=t>>>3;return(e[t]|(r<=1?0:e[1+t]<<8))>>>r&127}function m(e,t,r){var n=7&t,t=t>>>3,i=(1<<r)-1,o=e[t]>>>n;return r<8-n||(o|=e[1+t]<<8-n,r<16-n)||(o|=e[2+t]<<16-n,r<24-n)||(o|=e[3+t]<<24-n),o&i}function D(e,t,r){var n=7&t,i=t>>>3;return n<=5?e[i]|=(7&r)<<n:(e[i]|=r<<n&255,e[1+i]=(7&r)>>8-n),t+3}function S(e,t,r){var n=t>>>3;return e[n]|=255&(r<<=7&t),e[1+n]=r>>>=8,t+8}function P(e,t,r){var n=t>>>3;e[n]|=255&(r<<=7&t),e[1+n]=255&(r>>>=8),e[2+n]=r>>>8}function y(e,t){var r=e.length,n=t<2*r?2*r:t+5,i=0;if(!(t<=r)){if(ce){var o=Z(n);if(e.copy)e.copy(o);else for(;i<e.length;++i)o[i]=e[i];return o}if(_){var s=new Uint8Array(n);if(s.set)s.set(e);else for(;i<r;++i)s[i]=e[i];return s}e.length=n}return e}function N(e){for(var t=new Array(e),r=0;r<e;++r)t[r]=0;return t}function O(e,t,r){for(var n,i=1,o=0,s=0,a=0,l=e.length,c=_?new Uint16Array(32):N(32),o=0;o<32;++o)c[o]=0;for(o=l;o<r;++o)e[o]=0;var l=e.length,u=_?new Uint16Array(l):N(l);for(o=0;o<l;++o)c[n=e[o]]++,i<n&&(i=n),u[o]=0;for(c[0]=0,o=1;o<=i;++o)c[o+16]=a=a+c[o-1]<<1;for(o=0;o<l;++o)0!=(a=e[o])&&(u[o]=c[a+16]++);var d,h,p,f;for(o=0;o<l;++o)if(0!=(d=e[o]))for(h=u[o],p=i,f=void 0,f=R[255&h],a=(p<=8?f>>>8-p:(f=f<<8|R[h>>8&255],p<=16?f>>>16-p:(f<<8|R[h>>16&255])>>>24-p))>>i-d,s=(1<<i+4-d)-1;0<=s;--s)t[a|s<<d]=15&d|o<<4;return i}var v=_?new Uint16Array(512):N(512),b=_?new Uint16Array(32):N(32);if(!_){for(var a=0;a<512;++a)v[a]=0;for(a=0;a<32;++a)b[a]=0}for(var u=[],l=0;l<32;l++)u.push(5);O(u,b,32);for(var c=[],l=0;l<=143;l++)c.push(8);for(;l<=255;l++)c.push(9);for(;l<=279;l++)c.push(7);for(;l<=287;l++)c.push(8);O(c,v,288);var d=function(){for(var w=_?new Uint8Array(32768):[],e=0,t=0;e<T.length-1;++e)for(;t<T[e+1];++t)w[t]=e;for(;t<32768;++t)w[t]=29;for(var C=_?new Uint8Array(259):[],e=0,t=0;e<E.length-1;++e)for(;t<E[e+1];++t)C[t]=e;return function(e,t){if(e.length<8){for(var r=e,n=t,i=0;i<r.length;){var o=Math.min(65535,r.length-i),s=i+o==r.length;for(n._W(1,+s),n._W(2,o),n._W(2,65535&~o);0<o--;)n[n.l++]=r[i++]}return n.l}for(var a,l=e,c=t,u=0,d=0,h=_?new Uint16Array(32768):[];d<l.length;){var p=Math.min(65535,l.length-d);if(p<10){for(7&(u=D(c,u,+!(d+p!=l.length)))&&(u+=8-(7&u)),c.l=u/8|0,c._W(2,p),c._W(2,65535&~p);0<p--;)c[c.l++]=l[d++];u=8*c.l}else{for(var u=D(c,u,+!(d+p!=l.length)+2),f=0;0<p--;){var g=l[d],f=32767&(f<<5^g),m=-1,y=0;if((m=h[f])&&(d<(m|=-32768&d)&&(m-=32768),m<d))for(;l[m+y]==l[d+y]&&y<250;)++y;if(2<y){(g=C[y])<=22?u=S(c,u,R[g+1]>>1)-1:(S(c,u,3),S(c,u+=5,R[g-23]>>5),u+=3);var v=g<8?0:g-4>>2,v=(0<v&&(P(c,u,y-E[g]),u+=v),g=w[d-m],u=S(c,u,R[g]>>3),u-=3,g<4?0:g-2>>1);0<v&&(P(c,u,d-m-T[g]),u+=v);for(var b=0;b<y;++b)h[f]=32767&d,f=32767&(f<<5^l[d]),++d;p-=y-1}else g<=143?g+=48:(v=1,c[(a=u)>>>3]|=v=(1&v)<<(7&a),u=a+1),u=S(c,u,R[g]),h[f]=32767&d,++d}u=S(c,u,0)-1}}return c.l=(u+7)/8|0,c.l}}();function K(e){var t=ye(50+Math.floor(1.1*e.length)),e=d(e,t);return t.slice(0,e)}var L=_?new Uint16Array(32768):N(32768),F=_?new Uint16Array(32768):N(32768),H=_?new Uint16Array(128):N(128),U=1,V=1;function h(e,t){if(3==e[0]&&!(3&e[1]))return[B(t),2];for(var r=0,n=0,i=Z(t||1<<18),o=0,s=i.length>>>0,a=0,l=0;0==(1&n);)if(n=A(e,r),r+=3,n>>>1==0){7&r&&(r+=8-(7&r));var c=e[r>>>3]|e[1+(r>>>3)]<<8;if(r+=32,0<c)for(!t&&s<o+c&&(s=(i=y(i,o+c)).length);0<c--;)i[o++]=e[r>>>3],r+=8}else for(l=n>>1==1?(a=9,5):(r=function(e,t){for(var r,n,i,o=M(e,t)+257,s=M(e,t+=5)+1,a=(n=t+=5,i=7&t,4+(((r=e)[n=t>>>3]|(i<=4?0:r[1+n]<<8))>>>i&15)),l=(t+=4,0),c=_?new Uint8Array(19):N(19),u=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],d=1,h=_?new Uint8Array(8):N(8),p=_?new Uint8Array(8):N(8),f=c.length,g=0;g<a;++g)c[I[g]]=l=A(e,t),d<l&&(d=l),h[l]++,t+=3;var m=0;for(h[0]=0,g=1;g<=d;++g)p[g]=m=m+h[g-1]<<1;for(g=0;g<f;++g)0!=(m=c[g])&&(u[g]=p[m]++);for(var y,g=0;g<f;++g)if(0!=(y=c[g]))for(var m=R[u[g]]>>8-y,v=(1<<7-y)-1;0<=v;--v)H[m|v<<y]=7&y|g<<3;for(var b,w,C,E=[],d=1;E.length<o+s;)switch(m=H[k(e,t)],t+=7&m,m>>>=3){case 16:for(l=3+(C=void 0,C=7&(w=t),((b=e)[w=t>>>3]|(C<=6?0:b[1+w]<<8))>>>C&3),t+=2,m=E[E.length-1];0<l--;)E.push(m);break;case 17:for(l=3+A(e,t),t+=3;0<l--;)E.push(0);break;case 18:for(l=11+k(e,t),t+=7;0<l--;)E.push(0);break;default:E.push(m),d<m&&(d=m)}var T=E.slice(0,o),S=E.slice(o);for(g=o;g<286;++g)T[g]=0;for(g=s;g<30;++g)S[g]=0;return U=O(T,L,286),V=O(S,F,30),t}(e,r),a=U,V);;){!t&&s<o+32767&&(s=(i=y(i,o+32767)).length);var u=m(e,r,a),d=(n>>>1==1?v:L)[u];if(r+=15&d,0==((d>>>=4)>>>8&255))i[o++]=d;else{if(256==d)break;var h=(d-=257)<8?0:d-4>>2,p=(5<h&&(h=0),o+E[d]),h=(0<h&&(p+=m(e,r,h),r+=h),u=m(e,r,l),r+=15&(d=(n>>>1==1?b:F)[u]),(d>>>=4)<4?0:d-2>>1),f=T[d];for(0<h&&(f+=m(e,r,h),r+=h),!t&&s<p&&(s=(i=y(i,p+100)).length);o<p;)i[o]=i[o-f],++o}}return t?[i,r+7>>>3]:[i.slice(0,o),r+7>>>3]}function W(e,t){t=h(e.slice(e.l||0),t);return e.l+=t[1],t[0]}function $(e,t){if(!e)throw new Error(t);"undefined"!=typeof console&&console.error(t)}function le(e,t){for(var r=e,n=(hn(r,0),{FileIndex:[],FullPaths:[]}),i=(ne(n,{root:t.root}),r.length-4);(80!=r[i]||75!=r[i+1]||5!=r[i+2]||6!=r[i+3])&&0<=i;)--i;r.l=i+4,r.l+=4;var o=r._R(2),e=(r.l+=6,r._R(4));for(r.l=e,i=0;i<o;++i){r.l+=20;var s=r._R(4),a=r._R(4),l=r._R(2),c=r._R(2),u=r._R(2),d=(r.l+=8,r._R(4)),h=x(r.slice(r.l+l,r.l+l+c)),l=(r.l+=l+c+u,r.l),p=(r.l=d+4,S=_=T=E=C=w=b=v=y=m=g=f=d=u=c=p=void 0,r),c=s,u=a,d=n,f=h,g=(p.l+=2,p._R(2)),m=p._R(2),y=function(e){var t=65535&e._R(2),e=65535&e._R(2),r=new Date,n=31&e,i=15&(e>>>=5),e=(e>>>=4,r.setMilliseconds(0),r.setFullYear(1980+e),r.setMonth(i-1),r.setDate(n),31&t),i=63&(t>>>=5);return r.setHours(t>>>=6),r.setMinutes(i),r.setSeconds(e<<1),r}(p);if(8257&g)throw new Error("Unsupported ZIP encryption");p._R(4);for(var v=p._R(4),b=p._R(4),w=p._R(2),C=p._R(2),E="",T=0;T<w;++T)E+=String.fromCharCode(p[p.l++]);C&&(((_=x(p.slice(p.l,p.l+C)))[21589]||{}).mt&&(y=_[21589].mt),((f||{})[21589]||{}).mt)&&(y=f[21589].mt),p.l+=C;var S=p.slice(p.l,p.l+v);switch(m){case 8:S=function(e,t){var r,n;return z?(n=(r=new z.InflateRaw)._processChunk(e.slice(e.l),r._finishFlushFlag),e.l+=r.bytesRead,n):W(e,t)}(p,b);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+m)}var _=!1;8&g&&(134695760==p._R(4)&&(p._R(4),_=!0),v=p._R(4),b=p._R(4)),v!=c&&$(_,"Bad compressed size: "+c+" != "+v),b!=u&&$(_,"Bad uncompressed size: "+u+" != "+b),ae(d,E,S,{unsafe:!0,mt:y}),r.l=l}return n}var G={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ae(e,t,r,n){var i,o=n&&n.unsafe,s=(o||ne(e),!o&&X.find(e,t));return s||(i=e.FullPaths[0],i=t.slice(0,i.length)==i?t:("/"!=i.slice(-1)&&(i+="/"),(i+t).replace("//","/")),s={name:f(t),type:2},e.FileIndex.push(s),e.FullPaths.push(i),o)||X.utils.cfb_gc(e),s.content=r,s.size=r?r.length:0,n&&(n.CLSID&&(s.clsid=n.CLSID),n.mt&&(s.mt=n.mt),n.ct)&&(s.ct=n.ct),s}return e.find=function(e,t){var r=e.FullPaths.map(function(e){return e.toUpperCase()}),n=r.map(function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]}),i=!1,o=(47===t.charCodeAt(0)?(i=!0,t=r[0].slice(0,-1)+t):i=-1!==t.indexOf("/"),t.toUpperCase()),s=(!0===i?r:n).indexOf(o);if(-1!==s)return e.FileIndex[s];var a=!o.match(ee),o=o.replace(Q,"");for(a&&(o=o.replace(ee,"!")),s=0;s<r.length;++s){if((a?r[s].replace(ee,"!"):r[s]).replace(Q,"")==o)return e.FileIndex[s];if((a?n[s].replace(ee,"!"):n[s]).replace(Q,"")==o)return e.FileIndex[s]}return null},e.read=function(e,t){var r,n=t&&t.type;switch(n||ce&&Buffer.isBuffer(e)&&(n="buffer"),n||"base64"){case"file":return r=t,o(),s(i.readFileSync(e),r);case"base64":return s(xe(_e(e)),t);case"binary":return s(xe(e),t)}return s(e,t)},e.parse=s,e.write=function(e,t){var r=n(e,t);switch(t&&t.type||"buffer"){case"file":return o(),i.writeFileSync(t.filename,r),r;case"binary":return"string"==typeof r?r:se(r);case"base64":return J("string"==typeof r?r:se(r));case"buffer":if(ce)return Buffer.isBuffer(r)?r:w(r);case"array":return"string"==typeof r?xe(r):r}return r},e.writeFile=function(e,t,r){o(),e=n(e,r),i.writeFileSync(t,e)},e.utils={cfb_new:function(e){var t={};return ne(t,e),t},cfb_add:ae,cfb_del:function(e,t){ne(e);var r=X.find(e,t);if(r)for(var n=0;n<e.FileIndex.length;++n)if(e.FileIndex[n]==r)return e.FileIndex.splice(n,1),e.FullPaths.splice(n,1),!0;return!1},cfb_mov:function(e,t,r){ne(e);var n=X.find(e,t);if(n)for(var i=0;i<e.FileIndex.length;++i)if(e.FileIndex[i]==n)return e.FileIndex[i].name=f(r),e.FullPaths[i]=r,!0;return!1},cfb_gc:function(e){j(e,!0)},ReadShift:sn,CheckField:dn,prep_blob:hn,bconcat:Re,use_zlib:function(e){try{var t=new e.InflateRaw;if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");z=e}catch(e){console.error("cannot use native zlib: "+(e.message||e))}},_deflateRaw:K,_inflateRaw:W,consts:Y},e}();if("undefined"!=typeof require)try{yt=void 0}catch(e){}function bt(e){if("string"==typeof e)return l(e);if(Array.isArray(e)){var t=e;if("undefined"==typeof Uint8Array)throw new Error("Unsupported");return new Uint8Array(t)}return e}function wt(e,t,r){if(void 0!==yt&&yt.writeFileSync)return r?yt.writeFileSync(e,t,r):yt.writeFileSync(e,t);if("undefined"!=typeof Deno){if(r&&"string"==typeof t)switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=l(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n="utf8"==r?mr(t):t;if("undefined"!=typeof IE_SaveFile)return IE_SaveFile(n,e);if("undefined"!=typeof Blob){n=new Blob([bt(n)],{type:"application/octet-stream"});if("undefined"!=typeof navigator&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if("undefined"!=typeof saveAs)return saveAs(n,e);if("undefined"!=typeof URL&&"undefined"!=typeof document&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(n);if("object"==typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&"undefined"!=typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});n=document.createElement("a");if(null!=n.download)return n.download=e,n.href=i,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL&&"undefined"!=typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if("undefined"!=typeof $&&"undefined"!=typeof File&&"undefined"!=typeof Folder)try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=p(t)),o.write(t),o.close(),t}catch(e){if(!e.message||!e.message.match(/onstruct/))throw e}throw new Error("cannot save file "+e)}function oe(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Ct(e,t){for(var r=[],n=oe(e),i=0;i!==n.length;++i)null==r[e[n[i]][t]]&&(r[e[n[i]][t]]=n[i]);return r}function Et(e){for(var t=[],r=oe(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Tt(e){for(var t=[],r=oe(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}var St=new Date(1899,11,30,0,0,0);function _t(e,t){var r=e.getTime(),t=(t&&(r-=1263168e5),St.getTime()+6e4*(e.getTimezoneOffset()-St.getTimezoneOffset()));return(r-t)/864e5}var e=new Date,xt=St.getTime()+6e4*(e.getTimezoneOffset()-St.getTimezoneOffset()),Rt=e.getTimezoneOffset();function At(e){var t=new Date;return t.setTime(24*e*60*60*1e3+xt),t.getTimezoneOffset()!==Rt&&t.setTime(t.getTime()+6e4*(t.getTimezoneOffset()-Rt)),t}var Nt=new Date("2017-02-19T19:06:09.000Z"),Ot=isNaN(Nt.getFullYear())?new Date("2/19/17"):Nt,It=2017==Ot.getFullYear();function de(e,t){var r=new Date(e);return It?(0<t?r.setTime(r.getTime()+60*r.getTimezoneOffset()*1e3):t<0&&r.setTime(r.getTime()-60*r.getTimezoneOffset()*1e3),r):e instanceof Date?e:1917!=Ot.getFullYear()||isNaN(r.getFullYear())?(t=e.match(/\d+/g)||["2017","2","19","0","0","0"],t=new Date(+t[0],+t[1]-1,+t[2],+t[3]||0,+t[4]||0,+t[5]||0),-1<e.indexOf("Z")?new Date(t.getTime()-60*t.getTimezoneOffset()*1e3):t):(t=r.getFullYear(),-1<e.indexOf(""+t)||r.setFullYear(r.getFullYear()+100),r)}function Mt(e,t){if(ce&&Buffer.isBuffer(e)){if(t){if(255==e[0]&&254==e[1])return mr(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return mr(a(e.slice(2).toString("binary")))}return e.toString("binary")}if("undefined"!=typeof TextDecoder)try{if(t){if(255==e[0]&&254==e[1])return mr(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return mr(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"","ƒ":"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"","Š":"","‹":"","Œ":"","Ž":"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"","š":"","›":"","œ":"","ž":"","Ÿ":""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(e){return r[e]||e})}catch(e){}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function he(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t,r={};for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=he(e[t]));return r}function I(e,t){for(var r="";r.length<t;)r+=e;return r}function kt(e){var r,t=Number(e);return isNaN(t)?!/\d/.test(e)||(r=1,e=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""}),isNaN(t=Number(e))&&(e=e.replace(/[(](.*)[)]/,function(e,t){return r=-r,t}),isNaN(t=Number(e))))?t:t/r:isFinite(t)?t:NaN}var Dt=["january","february","march","april","may","june","july","august","september","october","november","december"];function Pt(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),o=t.getDate();if(isNaN(o))return r;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(3<(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length&&-1==Dt.indexOf(s))return r}else if(s.match(/[a-z]/))return r;return n<0||8099<n||(!(0<i||1<o)||101==n)&&e.match(/[^-0-9:,\/\\]/)?r:t}Lt=5=="abacaba".split(/(:?b)/i).length;var Lt,Ft=function(e,t,r){if(Lt||"string"==typeof t)return e.split(t);for(var n=e.split(t),i=[n[0]],o=1;o<n.length;++o)i.push(r),i.push(n[o]);return i};function Ht(e){return e?e.content&&e.type?Mt(e.content,!0):e.data?Se(e.data):e.asNodeBuffer&&ce?Se(e.asNodeBuffer().toString("binary")):e.asBinary?Se(e.asBinary()):e._data&&e._data.getContent?Se(Mt(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Ut(e){var t;return e?e.data?Te(e.data):e.asNodeBuffer&&ce?e.asNodeBuffer():e._data&&e._data.getContent?"string"==typeof(t=e._data.getContent())?Te(t):Array.prototype.slice.call(t):e.content&&e.type?e.content:null:null}function Vt(e,t){for(var r=e.FullPaths||oe(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),o=0;o<r.length;++o){var s=r[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==s||i==s)return e.files?e.files[r[o]]:e.FileIndex[o]}return null}function Wt(e,t){e=Vt(e,t);if(null==e)throw new Error("Cannot find file "+t+" in zip");return e}function D(e,t,r){if(!r)return((r=Wt(e,t))&&".bin"===r.name.slice(-4)?Ut:Ht)(r);if(!t)return null;try{return D(e,t)}catch(e){return null}}function $t(e,t,r){if(!r)return Ht(Wt(e,t));if(!t)return null;try{return $t(e,t)}catch(e){return null}}function Bt(e){for(var t=e.FullPaths||oe(e.files),r=[],n=0;n<t.length;++n)"/"!=t[n].slice(-1)&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function P(e,t,r){if(e.FullPaths){var n;if("string"==typeof r)return n=(ce?w:function(e){for(var t=[],r=0,n=e.length+250,i=B(e.length+255),o=0;o<e.length;++o){var s,a=e.charCodeAt(o);a<128?i[r++]=a:a<2048?(i[r++]=192|a>>6&31,i[r++]=128|63&a):55296<=a&&a<57344?(a=64+(1023&a),s=1023&e.charCodeAt(++o),i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|s>>6&15|(3&a)<<4,i[r++]=128|63&s):(i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|63&a),n<r&&(t.push(i.slice(0,r)),r=0,i=B(65535),n=65530)}return t.push(i.slice(0,r)),Re(t)})(r),X.utils.cfb_add(e,t,n);X.utils.cfb_add(e,t,r)}else e.file(t,r)}function jt(){return X.utils.cfb_new()}function zt(e,t){switch(t.type){case"base64":return X.read(e,{type:"base64"});case"binary":return X.read(e,{type:"binary"});case"buffer":case"array":return X.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Yt(e,t){if("/"==e.charAt(0))return e.slice(1);for(var r=t.split("/"),n=("/"!=t.slice(-1)&&r.pop(),e.split("/"));0!==n.length;){var i=n.shift();".."===i?r.pop():"."!==i&&r.push(i)}return r.join("/")}var C='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',Gt=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,e=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,qt=C.match(e)?e:/<[^>]*>/g,Kt=/<\w*:/,Xt=/<(\/?)\w+:/;function pe(e,t,r){for(var n={},i=0,o=0;i!==e.length&&32!==(o=e.charCodeAt(i))&&10!==o&&13!==o;++i);if(t||(n[0]=e.slice(0,i)),i!==e.length){var s,a,l=e.match(Gt),c=0,u=0,d="",h="";if(l)for(u=0;u!=l.length;++u){for(h=l[u],o=0;o!=h.length&&61!==h.charCodeAt(o);++o);for(d=h.slice(0,o).trim();32==h.charCodeAt(o+1);)++o;for(s=34==(i=h.charCodeAt(o+1))||39==i?1:0,s=h.slice(o+1+s,h.length-s),c=0;c!=d.length&&58!==d.charCodeAt(c);++c);c===d.length?(n[d=0<d.indexOf("_")?d.slice(0,d.indexOf("_")):d]=s,r||(n[d.toLowerCase()]=s)):n[a=(5===c&&"xmlns"===d.slice(0,5)?"xmlns":"")+d.slice(c+1)]&&"ext"==d.slice(c-3,c)||(n[a]=s,r)||(n[a.toLowerCase()]=s)}}return n}function Jt(e){return e.replace(Xt,"<$1")}var Zt,Qt,er={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},tr=Et(er),fe=(Zt=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,Qt=/_x([\da-fA-F]{4})_/gi,function e(t){var r,t=t+"",n=t.indexOf("<![CDATA[");return-1==n?t.replace(Zt,function(e,t){return er[e]||String.fromCharCode(parseInt(t,-1<e.indexOf("x")?16:10))||e}).replace(Qt,function(e,t){return String.fromCharCode(parseInt(t,16))}):(r=t.indexOf("]]>"),e(t.slice(0,n))+t.slice(n+9,r)+e(t.slice(r+3)))}),rr=/[&<>'"]/g,nr=/[\u0000-\u0008\u000b-\u001f]/g;function E(e){return(e+"").replace(rr,function(e){return tr[e]}).replace(nr,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function ir(e){return E(e).replace(/ /g,"_x0020_")}var or=/[\u0000-\u001f]/g;function sr(e){return(e+"").replace(rr,function(e){return tr[e]}).replace(/\n/g,"<br/>").replace(or,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}ar=/&#(\d+);/g;var ar,lr=function(e){return e.replace(ar,cr)};function cr(e,t){return String.fromCharCode(parseInt(t,10))}function ge(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function ur(e){for(var t,r,n,i="",o=0,s=0;o<e.length;)(n=e.charCodeAt(o++))<128?i+=String.fromCharCode(n):(t=e.charCodeAt(o++),191<n&&n<224?(s=(31&n)<<6,s|=63&t,i+=String.fromCharCode(s)):(r=e.charCodeAt(o++),n<240?i+=String.fromCharCode((15&n)<<12|(63&t)<<6|63&r):(n=((7&n)<<18|(63&t)<<12|(63&r)<<6|63&(s=e.charCodeAt(o++)))-65536,i=(i+=String.fromCharCode(55296+(n>>>10&1023)))+String.fromCharCode(56320+(1023&n)))));return i}function dr(e){for(var t,r,n=B(2*e.length),i=1,o=0,s=0,a=0;a<e.length;a+=i)i=1,(r=e.charCodeAt(a))<128?t=r:r<224?(t=64*(31&r)+(63&e.charCodeAt(a+1)),i=2):r<240?(t=4096*(15&r)+64*(63&e.charCodeAt(a+1))+(63&e.charCodeAt(a+2)),i=3):(i=4,t=262144*(7&r)+4096*(63&e.charCodeAt(a+1))+64*(63&e.charCodeAt(a+2))+(63&e.charCodeAt(a+3)),s=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==s&&(n[o++]=255&s,n[o++]=s>>>8,s=0),n[o++]=t%256,n[o++]=t>>>8;return n.slice(0,o).toString("ucs2")}function hr(e){return w(e,"binary").toString("utf8")}var pr,fr,gr,Nt="foo bar bazâð£",me=ce&&(hr(Nt)==ur(Nt)?hr:dr(Nt)==ur(Nt)&&dr)||ur,mr=ce?function(e){return w(e,"utf8").toString("binary")}:function(e){for(var t,r=[],n=0,i=0;n<e.length;)switch(!0){case(i=e.charCodeAt(n++))<128:r.push(String.fromCharCode(i));break;case i<2048:r.push(String.fromCharCode(192+(i>>6))),r.push(String.fromCharCode(128+(63&i)));break;case 55296<=i&&i<57344:i-=55296,t=e.charCodeAt(n++)-56320+(i<<10),r.push(String.fromCharCode(240+(t>>18&7))),r.push(String.fromCharCode(144+(t>>12&63))),r.push(String.fromCharCode(128+(t>>6&63))),r.push(String.fromCharCode(128+(63&t)));break;default:r.push(String.fromCharCode(224+(i>>12))),r.push(String.fromCharCode(128+(i>>6&63))),r.push(String.fromCharCode(128+(63&i)))}return r.join("")},yr=(pr={},function(e,t){var r=e+"|"+(t||"");return pr[r]||(pr[r]=new RegExp("<(?:\\w+:)?"+e+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+e+">",t||""))}),vr=(fr=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]}),function(e){for(var t=e.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),r=0;r<fr.length;++r)t=t.replace(fr[r][0],fr[r][1]);return t}),br=(gr={},function(e){return void 0!==gr[e]?gr[e]:gr[e]=new RegExp("<(?:vt:)?"+e+">([\\s\\S]*?)</(?:vt:)?"+e+">","g")}),wr=/<\/?(?:vt:)?variant>/g,Cr=/<(?:vt:)([^>]*)>([\s\S]*)</;function Er(e,t){var r=pe(e),e=e.match(br(r.baseType))||[],n=[];if(e.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+e.length+" != "+r.size)}else e.forEach(function(e){e=e.replace(wr,"").match(Cr);e&&n.push({v:me(e[2]),t:e[1]})});return n}var Tr=/(^\s|\s$|\n)/;function Sr(e,t){return"<"+e+(t.match(Tr)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function _r(t){return oe(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function T(e,t,r){return"<"+e+(null!=r?_r(r):"")+(null!=t?(t.match(Tr)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function xr(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(e){if(t)throw e}return""}function Rr(e){if(ce&&Buffer.isBuffer(e))return e.toString("utf8");if("string"==typeof e)return e;if("undefined"!=typeof Uint8Array&&e instanceof Uint8Array)return me(p(v(e)));throw new Error("Bad input format: expected Buffer or string")}var Ar=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm,Nr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Or=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ir={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Mr(e){for(var t=[],r=0;r<e[0].length;++r)if(e[0][r])for(var n=0,i=e[0][r].length;n<i;n+=10240)t.push.apply(t,e[0][r].slice(n,n+10240));return t}function kr(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(en(e,i)));return n.join("").replace(Q,"")}function Dr(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")}function Pr(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(Qr(e,i)));return n.join("")}function Lr(e,t){var r=rn(e,t);return 0<r?zr(e,t+4,t+4+r-1):""}function Fr(e,t){var r=rn(e,t);return 0<r?zr(e,t+4,t+4+r-1):""}function Hr(e,t){var r=2*rn(e,t);return 0<r?zr(e,t+4,t+4+r-1):""}function Ur(e,t){var r=rn(e,t);return 0<r?Br(e,t+4,t+4+r):""}function Vr(e,t){var r=rn(e,t);return 0<r?zr(e,t+4,t+4+r):""}function Wr(e,t){for(var r=e,n=t,e=1-2*(r[n+7]>>>7),t=((127&r[n+7])<<4)+(r[n+6]>>>4&15),i=15&r[n+6],o=5;0<=o;--o)i=256*i+r[n+o];return 2047==t?0==i?1/0*e:NaN:(0==t?t=-1022:(t-=1023,i+=Math.pow(2,52)),e*Math.pow(2,t-52)*i)}var $r=ce?function(e){return 0<e[0].length&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(e){return Buffer.isBuffer(e)?e:w(e)})):Mr(e)}:Mr,Br=ce?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Q,""):kr(e,t,r)}:kr,jr=ce?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Dr(e,t,r)}:Dr,zr=ce?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf8",t,r):Pr(e,t,r)}:Pr,Yr=Lr,Gr=Fr,qr=Hr,Kr=Ur,Xr=Vr,Jr=Wr,Zr=function(e){return Array.isArray(e)||"undefined"!=typeof Uint8Array&&e instanceof Uint8Array};ce&&(Yr=function(e,t){var r;return Buffer.isBuffer(e)?0<(r=e.readUInt32LE(t))?e.toString("utf8",t+4,t+4+r-1):"":Lr(e,t)},Gr=function(e,t){var r;return Buffer.isBuffer(e)?0<(r=e.readUInt32LE(t))?e.toString("utf8",t+4,t+4+r-1):"":Fr(e,t)},qr=function(e,t){var r;return Buffer.isBuffer(e)?(r=2*e.readUInt32LE(t),e.toString("utf16le",t+4,t+4+r-1)):Hr(e,t)},Kr=function(e,t){var r;return Buffer.isBuffer(e)?(r=e.readUInt32LE(t),e.toString("utf16le",t+4,t+4+r)):Ur(e,t)},Xr=function(e,t){var r;return Buffer.isBuffer(e)?(r=e.readUInt32LE(t),e.toString("utf8",t+4,t+4+r)):Vr(e,t)},Jr=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):Wr(e,t)},Zr=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||"undefined"!=typeof Uint8Array&&e instanceof Uint8Array}),void 0!==ae&&(Br=function(e,t,r){return ae.utils.decode(1200,e.slice(t,r)).replace(Q,"")},zr=function(e,t,r){return ae.utils.decode(65001,e.slice(t,r))},Yr=function(e,t){var r=rn(e,t);return 0<r?ae.utils.decode(_,e.slice(t+4,t+4+r-1)):""},Gr=function(e,t){var r=rn(e,t);return 0<r?ae.utils.decode(g,e.slice(t+4,t+4+r-1)):""},qr=function(e,t){var r=2*rn(e,t);return 0<r?ae.utils.decode(1200,e.slice(t+4,t+4+r-1)):""},Kr=function(e,t){var r=rn(e,t);return 0<r?ae.utils.decode(1200,e.slice(t+4,t+4+r)):""},Xr=function(e,t){var r=rn(e,t);return 0<r?ae.utils.decode(65001,e.slice(t+4,t+4+r)):""});var Qr=function(e,t){return e[t]},en=function(e,t){return 256*e[t+1]+e[t]},tn=function(e,t){e=256*e[t+1]+e[t];return e<32768?e:-1*(65535-e+1)},rn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},nn=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},on=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function sn(e,t){var r,n,i,o,s,a,l="",c=[];switch(t){case"dbcs":if(a=this.l,ce&&Buffer.isBuffer(this))l=this.slice(this.l,this.l+2*e).toString("utf16le");else for(s=0;s<e;++s)l+=String.fromCharCode(en(this,a)),a+=2;e*=2;break;case"utf8":l=zr(this,this.l,this.l+e);break;case"utf16le":l=Br(this,this.l,this.l+(e*=2));break;case"wstr":if(void 0===ae)return sn.call(this,e,"dbcs");l=ae.utils.decode(g,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":l=Yr(this,this.l),e=4+rn(this,this.l);break;case"lpstr-cp":l=Gr(this,this.l),e=4+rn(this,this.l);break;case"lpwstr":l=qr(this,this.l),e=4+2*rn(this,this.l);break;case"lpp4":e=4+rn(this,this.l),l=Kr(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+rn(this,this.l),l=Xr(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,l="";0!==(i=Qr(this,this.l+e++));)c.push(u(i));l=c.join("");break;case"_wstr":for(e=0,l="";0!==(i=en(this,this.l+e));)c.push(u(i)),e+=2;e+=2,l=c.join("");break;case"dbcs-cont":for(l="",a=this.l,s=0;s<e;++s){if(this.lens&&-1!==this.lens.indexOf(a))return i=Qr(this,a),this.l=a+1,o=sn.call(this,e-s,i?"dbcs-cont":"sbcs-cont"),c.join("")+o;c.push(u(en(this,a))),a+=2}l=c.join(""),e*=2;break;case"cpstr":if(void 0!==ae){l=ae.utils.decode(g,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(l="",a=this.l,s=0;s!=e;++s){if(this.lens&&-1!==this.lens.indexOf(a))return i=Qr(this,a),this.l=a+1,o=sn.call(this,e-s,i?"dbcs-cont":"sbcs-cont"),c.join("")+o;c.push(u(Qr(this,a))),a+=1}l=c.join("");break;default:switch(e){case 1:return r=Qr(this,this.l),this.l++,r;case 2:return r=("i"===t?tn:en)(this,this.l),this.l+=2,r;case 4:case-4:return"i"===t||0==(128&this[this.l+3])?(r=(0<e?nn:on)(this,this.l),this.l+=4,r):(n=rn(this,this.l),this.l+=4,n);case 8:case-8:if("f"===t)return n=8==e?Jr(this,this.l):Jr([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:l=jr(this,this.l,e)}}return this.l+=e,l}var an=function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},ln=function(e,t,r){e[r]=255&t,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},cn=function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255};function un(e,t,r){var n=0,i=0;if("dbcs"===r){for(i=0;i!=t.length;++i)cn(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if("sbcs"===r){if(void 0!==ae&&874==_)for(i=0;i!=t.length;++i){var o=ae.utils.encode(_,t.charAt(i));this[this.l+i]=o[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=255&t.charCodeAt(i);n=t.length}else{if("hex"===r){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}if("utf16le"===r){for(var s=Math.min(this.l+e,this.length),i=0;i<Math.min(t.length,e);++i){var a=t.charCodeAt(i);this[this.l++]=255&a,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}switch(e){case 1:n=1,this[this.l]=255&t;break;case 2:n=2,this[this.l]=255&t,this[this.l+1]=255&(t>>>=8);break;case 3:n=3,this[this.l]=255&t,this[this.l+1]=255&(t>>>=8),this[this.l+2]=255&(t>>>=8);break;case 4:n=4,an(this,t,this.l);break;case 8:if(n=8,"f"===r){var l=this,c=t,u=this.l,d=(c<0||1/c==-1/0?1:0)<<7,h=0,p=0,f=d?-c:c;isFinite(f)?0==f?h=p=0:(h=Math.floor(Math.log(f)/Math.LN2),p=f*Math.pow(2,52-h),h<=-1023&&(!isFinite(p)||p<Math.pow(2,52))?h=-1022:(p-=Math.pow(2,52),h+=1023)):(h=2047,p=isNaN(c)?26985:0);for(var g=0;g<=5;++g,p/=256)l[u+g]=255&p;l[u+6]=(15&h)<<4|15&p,l[u+7]=h>>4|d;break}case 16:break;case-4:n=4,ln(this,t,this.l)}}return this.l+=n,this}function dn(e,t){var r=jr(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function hn(e,t){e.l=t,e._R=sn,e.chk=dn,e._W=un}function pn(e,t){e.l+=t}function ye(e){e=B(e);return hn(e,0),e}function fn(e,t,r){if(e){hn(e,e.l||0);for(var n=e.length,i=0;e.l<n;){128&(i=e._R(1))&&(i=(127&i)+((127&e._R(1))<<7));for(var o,s=Ku[i]||Ku[65535],a=127&(o=e._R(1)),l=1;l<4&&128&o;++l)a+=(127&(o=e._R(1)))<<7*l;var c=e.l+a,u=s.f&&s.f(e,a,r);if(e.l=c,t(u,s,i))return}}}function gn(){function t(e){return hn(e=ye(e),0),e}function r(){o&&(o.length>o.l&&((o=o.slice(0,o.l)).l=o.length),0<o.length&&e.push(o),o=null)}function n(e){return o&&e<o.length-o.l?o:(r(),o=t(Math.max(e+1,i)))}var e=[],i=ce?256:2048,o=t(i);return{next:n,push:function(e){r(),null==(o=e).l&&(o.l=o.length),n(i)},end:function(){return r(),Re(e)},_bufs:e}}function N(e,t,r,n){var i,t=+t;if(!isNaN(t)){i=1+(128<=t?1:0)+1,128<=(n=n||Ku[t].p||(r||[]).length||0)&&++i,16384<=n&&++i,2097152<=n&&++i;var o=e.next(i);t<=127?o._W(1,t):(o._W(1,128+(127&t)),o._W(1,t>>7));for(var s=0;4!=s;++s){if(!(128<=n)){o._W(1,n);break}o._W(1,128+(127&n)),n>>=7}0<n&&Zr(r)&&e.push(r)}}function mn(e,t,r){var n=he(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;256<=n.c;)n.c-=256;for(;65536<=n.r;)n.r-=65536}return n}function yn(e,t,r){e=he(e);return e.s=mn(e.s,t.s,r),e.e=mn(e.e,t.s,r),e}function vn(e,t){if(e.cRel&&e.c<0)for(e=he(e);e.c<0;)e.c+=8<t?16384:256;if(e.rRel&&e.r<0)for(e=he(e);e.r<0;)e.r+=8<t?1048576:5<t?65536:16384;var r=se(e);return e.cRel||null==e.cRel||(r=r.replace(/^([A-Z])/,"$$$1")),r=e.rRel||null==e.rRel?r:r.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function bn(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(12<=t.biff?1048575:8<=t.biff?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(12<=t.biff?16383:255)||e.e.cRel?vn(e.s,t.biff)+":"+vn(e.e,t.biff):(e.s.rRel?"":"$")+ve(e.s.r)+":"+(e.e.rRel?"":"$")+ve(e.e.r):(e.s.cRel?"":"$")+be(e.s.c)+":"+(e.e.cRel?"":"$")+be(e.e.c)}function wn(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function ve(e){return""+(e+1)}function Cn(e){for(var t=e.replace(/^\$([A-Z])/,"$1"),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function be(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function W(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);48<=i&&i<=57?t=10*t+(i-48):65<=i&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function se(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function En(e){var t=e.indexOf(":");return-1==t?{s:W(e),e:W(e)}:{s:W(e.slice(0,t)),e:W(e.slice(t+1))}}function we(e,t){return void 0===t||"number"==typeof t?we(e.s,e.e):(e="string"!=typeof e?se(e):e)==(t="string"!=typeof t?se(t):t)?e:e+":"+t}function Ce(e){for(var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,o=e.length,r=0;n<o&&!((i=e.charCodeAt(n)-64)<1||26<i);++n)r=26*r+i;for(t.s.c=--r,r=0;n<o&&!((i=e.charCodeAt(n)-48)<0||9<i);++n)r=10*r+i;if(t.s.r=--r,n===o||10!=i)t.e.c=t.s.c,t.e.r=t.s.r;else{for(++n,r=0;n!=o&&!((i=e.charCodeAt(n)-64)<1||26<i);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=o&&!((i=e.charCodeAt(n)-48)<0||9<i);++n)r=10*r+i;t.e.r=--r}return t}function Tn(e,t){var r="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=qe(e.z,r?_t(t):t)}catch(e){}try{return e.w=qe((e.XF||{}).numFmtId||(r?14:0),r?_t(t):t)}catch(e){return""+t}}function Sn(e,t,r){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),"e"==e.t?si[e.v]||e.v:Tn(e,null==t?e.v:t))}function _n(e,t){var t=t&&t.sheet?t.sheet:"Sheet1",r={};return r[t]=e,{SheetNames:[t],Sheets:r}}function xn(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,o=(null!=le&&null==i&&(i=le),e||(i?[]:{})),s=0,a=0,l=(o&&null!=n.origin&&("number"==typeof n.origin?s=n.origin:(s=(r="string"==typeof n.origin?W(n.origin):n.origin).r,a=r.c),o["!ref"]||(o["!ref"]="A1:A1")),{s:{c:1e7,r:1e7},e:{c:0,r:0}});o["!ref"]&&(e=Ce(o["!ref"]),l.s.c=e.s.c,l.s.r=e.s.r,l.e.c=Math.max(l.e.c,e.e.c),l.e.r=Math.max(l.e.r,e.e.r),-1==s)&&(l.e.r=s=e.e.r+1);for(var c=0;c!=t.length;++c)if(t[c]){if(!Array.isArray(t[c]))throw new Error("aoa_to_sheet expects an array of arrays");for(var u=0;u!=t[c].length;++u)if(void 0!==t[c][u]){var d={v:t[c][u]},h=s+c,p=a+u;if(l.s.r>h&&(l.s.r=h),l.s.c>p&&(l.s.c=p),l.e.r<h&&(l.e.r=h),l.e.c<p&&(l.e.c=p),!t[c][u]||"object"!=typeof t[c][u]||Array.isArray(t[c][u])||t[c][u]instanceof Date)if(Array.isArray(d.v)&&(d.f=t[c][u][1],d.v=d.v[0]),null===d.v)if(d.f)d.t="n";else if(n.nullError)d.t="e",d.v=0;else{if(!n.sheetStubs)continue;d.t="z"}else"number"==typeof d.v?d.t="n":"boolean"==typeof d.v?d.t="b":d.v instanceof Date?(d.z=n.dateNF||ue[14],n.cellDates?(d.t="d",d.w=qe(d.z,_t(d.v))):(d.t="n",d.v=_t(d.v),d.w=qe(d.z,d.v))):d.t="s";else d=t[c][u];i?(o[h]||(o[h]=[]),o[h][p]&&o[h][p].z&&(d.z=o[h][p].z),o[h][p]=d):(o[p=se({c:p,r:h})]&&o[p].z&&(d.z=o[p].z),o[p]=d)}}return l.s.c<1e7&&(o["!ref"]=we(l)),o}function Rn(e,t){return xn(null,e,t)}function An(e,t){return(t=t||ye(4))._W(4,e),t}function Nn(e){var t=e._R(4);return 0===t?"":e._R(t,"dbcs")}function On(e,t){var r=!1;return null==t&&(r=!0,t=ye(4+2*e.length)),t._W(4,e.length),0<e.length&&t._W(0,e,"dbcs"),r?t.slice(0,t.l):t}function In(e,t){var r,n=e.l,i=e._R(1),o=Nn(e),s=[],o={t:o,h:o};if(0!=(1&i)){for(var a=e._R(4),l=0;l!=a;++l)s.push({ich:(r=e)._R(2),ifnt:r._R(2)});o.r=s}else o.r=[{ich:0,ifnt:0}];return e.l=n+t,o}e=In;function Mn(e,t){var r,n=!1;return null==t&&(n=!0,t=ye(23+4*e.t.length)),t._W(1,1),On(e.t,t),t._W(4,1),e={ich:0,ifnt:0},(r=(r=t)||ye(4))._W(2,e.ich||0),r._W(2,e.ifnt||0),n?t.slice(0,t.l):t}function kn(e){var t=e._R(4),r=e._R(2);return r+=e._R(1)<<16,e.l++,{c:t,iStyleRef:r}}function Dn(e,t){return(t=null==t?ye(8):t)._W(-4,e.c),t._W(3,e.iStyleRef||e.s),t._W(1,0),t}function Pn(e){var t=e._R(2);return t+=e._R(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Ln(e,t){return(t=null==t?ye(4):t)._W(3,e.iStyleRef||e.s),t._W(1,0),t}var Fn=Nn,Hn=On;function Un(e){var t=e._R(4);return 0===t||4294967295===t?"":e._R(t,"dbcs")}function Vn(e,t){var r=!1;return null==t&&(r=!0,t=ye(127)),t._W(4,0<e.length?e.length:4294967295),0<e.length&&t._W(0,e,"dbcs"),r?t.slice(0,t.l):t}var Wn=Nn,$n=Un,Bn=Vn;function jn(e){var t=e.slice(e.l,e.l+4),r=1&t[0],n=2&t[0],e=(e.l+=4,0==n?Jr([0,0,0,0,252&t[0],t[1],t[2],t[3]],0):nn(t,0)>>2);return r?e/100:e}function zn(e,t){null==t&&(t=ye(4));var r=0,n=0,i=100*e;if(e==(0|e)&&-(1<<29)<=e&&e<1<<29?n=1:i==(0|i)&&-(1<<29)<=i&&i<1<<29&&(r=n=1),!n)throw new Error("unsupported RkNumber "+e);t._W(-4,((r?i:e)<<2)+(r+2))}function Yn(e){var t={s:{},e:{}};return t.s.r=e._R(4),t.e.r=e._R(4),t.s.c=e._R(4),t.e.c=e._R(4),t}var Gn=Yn,qn=function(e,t){return(t=t||ye(16))._W(4,e.s.r),t._W(4,e.e.r),t._W(4,e.s.c),t._W(4,e.e.c),t};function Kn(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e._R(8,"f")}function Xn(e,t){return(t||ye(8))._W(8,e,"f")}function Jn(e,t){var r;t=t||ye(8),!e||e.auto?(t._W(4,0),t._W(4,0)):(null!=e.index?(t._W(1,2),t._W(1,e.index)):null!=e.theme?(t._W(1,6),t._W(1,e.theme)):(t._W(1,5),t._W(1,0)),0<(r=e.tint||0)?r*=32767:r<0&&(r*=32768),t._W(2,r),e.rgb&&null==e.theme?("number"==typeof(r=e.rgb||"FFFFFF")&&(r=("000000"+r.toString(16)).slice(-6)),t._W(1,parseInt(r.slice(0,2),16)),t._W(1,parseInt(r.slice(2,4),16)),t._W(1,parseInt(r.slice(4,6),16)),t._W(1,255)):(t._W(2,0),t._W(1,0),t._W(1,0)))}function Zn(e,t){var r=e._R(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[e._R(4)]||""}if(400<r)throw new Error("Unsupported Clipboard: "+r.toString(16));return e.l-=4,e._R(0,1==t?"lpstr":"lpwstr")}var Qn=12,ei=[80,81],ti={1:{n:"CodePage",t:2},2:{n:"Category",t:80},3:{n:"PresentationFormat",t:80},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:80},15:{n:"Company",t:80},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:80},27:{n:"ContentStatus",t:80},28:{n:"Language",t:80},29:{n:"Version",t:80},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},ri={1:{n:"CodePage",t:2},2:{n:"Title",t:80},3:{n:"Subject",t:80},4:{n:"Author",t:80},5:{n:"Keywords",t:80},6:{n:"Comments",t:80},7:{n:"Template",t:80},8:{n:"LastAuthor",t:80},9:{n:"RevNumber",t:80},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:80},19:{n:"DocSecurity",t:3},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},ni={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},ii=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];var oi=he([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].map(function(e){return[e>>16&255,e>>8&255,255&e]})),si={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},ai={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},li={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},ci={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function ui(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function di(r,n){function e(e){r[e]&&0<r[e].length&&(o=r[e][0],a[a.length]=T("Override",null,{PartName:("/"==o[0]?"":"/")+o,ContentType:ci[e][n.bookType]||ci[e].xlsx}))}function t(t){(r[t]||[]).forEach(function(e){a[a.length]=T("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:ci[t][n.bookType]||ci[t].xlsx})})}function i(t){(r[t]||[]).forEach(function(e){a[a.length]=T("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:s[t][0]})})}var o,s=function(e){for(var t=[],r=oe(e),n=0;n!==r.length;++n)null==t[e[r[n]]]&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}(li),a=[];a[a.length]=C,a[a.length]=T("Types",null,{xmlns:Nr.CT,"xmlns:xsd":Nr.xsd,"xmlns:xsi":Nr.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(e){return T("Default",null,{Extension:e[0],ContentType:e[1]})}));return e("workbooks"),t("sheets"),t("charts"),i("themes"),["strs","styles"].forEach(e),["coreprops","extprops","custprops"].forEach(i),i("vba"),i("comments"),i("threadedcomments"),i("drawings"),t("metadata"),i("people"),2<a.length&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var A={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function hi(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function pi(e,n){var i,o={"!id":{}};return e&&("/"!==n.charAt(0)&&(n="/"+n),i={},(e.match(qt)||[]).forEach(function(e){var t,r,e=pe(e);"<Relationship"===e[0]&&((t={}).Type=e.Type,t.Target=e.Target,t.Id=e.Id,e.TargetMode&&(t.TargetMode=e.TargetMode),r="External"===e.TargetMode?e.Target:Yt(e.Target,n),o[r]=t,i[e.Id]=t)}),o["!id"]=i),o}function fi(t){var r=[C,T("Relationships",null,{xmlns:Nr.RELS})];return oe(t["!id"]).forEach(function(e){r[r.length]=T("Relationship",null,t["!id"][e])}),2<r.length&&(r[r.length]="</Relationships>",r[1]=r[1].replace("/>",">")),r.join("")}function O(e,t,r,n,i,o){if(i=i||{},e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=n,i.Target=r,o?i.TargetMode=o:-1<[A.HLINK,A.XPATH,A.XMISS].indexOf(i.Type)&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}var gi="application/vnd.oasis.opendocument.spreadsheet";function mi(e,t,r){return['  <rdf:Description rdf:about="'+e+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+'"/>\n',"  </rdf:Description>\n"].join("")}function yi(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+s.version+"</meta:generator></office:meta></office:document-meta>"}var vi=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],bi=function(){for(var e=new Array(vi.length),t=0;t<vi.length;++t){var r=vi[t],r="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return e}();function wi(e){var t={};e=me(e);for(var r=0;r<vi.length;++r){var n=vi[r],i=e.match(bi[r]);null!=i&&0<i.length&&(t[n[1]]=fe(i[1])),"date"===n[2]&&t[n[1]]&&(t[n[1]]=de(t[n[1]]))}return t}function Ci(e,t,r,n,i){null==i[e]&&null!=t&&""!==t&&(t=E(i[e]=t),n[n.length]=r?T(e,t,r):Sr(e,t))}function Ei(e,t){var r=t||{},n=[C,T("cp:coreProperties",null,{"xmlns:cp":Nr.CORE_PROPS,"xmlns:dc":Nr.dc,"xmlns:dcterms":Nr.dcterms,"xmlns:dcmitype":Nr.dcmitype,"xmlns:xsi":Nr.xsi})],i={};if(e||r.Props){e&&(null!=e.CreatedDate&&Ci("dcterms:created","string"==typeof e.CreatedDate?e.CreatedDate:xr(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),null!=e.ModifiedDate)&&Ci("dcterms:modified","string"==typeof e.ModifiedDate?e.ModifiedDate:xr(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i);for(var o=0;o!=vi.length;++o){var s=vi[o],a=r.Props&&null!=r.Props[s[1]]?r.Props[s[1]]:e?e[s[1]]:null;!0===a?a="1":!1===a?a="0":"number"==typeof a&&(a=String(a)),null!=a&&Ci(s[0],a,null,n,i)}2<n.length&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">"))}return n.join("")}var Ti=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Si=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function _i(e,t,r,n){var i=[];if("string"==typeof e)i=Er(e,n);else for(var o=0;o<e.length;++o)i=i.concat(e[o].map(function(e){return{v:e}}));var s,a="string"==typeof t?Er(t,n).map(function(e){return e.v}):t,l=0;if(0<a.length)for(var c=0;c!==i.length;c+=2){switch(s=+i[c+1].v,i[c].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=s,r.SheetNames=a.slice(l,l+s);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=s,r.DefinedNames=a.slice(l,l+s);break;case"Charts":case"Diagramme":r.Chartsheets=s,r.ChartNames=a.slice(l,l+s)}l+=s}}function xi(r){var n=[],i=T;return(r=r||{}).Application="SheetJS",n[n.length]=C,n[n.length]=T("Properties",null,{xmlns:Nr.EXT_PROPS,"xmlns:vt":Nr.vt}),Ti.forEach(function(e){if(void 0!==r[e[1]]){var t;switch(e[2]){case"string":t=E(String(r[e[1]]));break;case"bool":t=r[e[1]]?"true":"false"}void 0!==t&&(n[n.length]=i(e[0],t))}}),n[n.length]=i("HeadingPairs",i("vt:vector",i("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+i("vt:variant",i("vt:i4",String(r.Worksheets))),{size:2,baseType:"variant"})),n[n.length]=i("TitlesOfParts",i("vt:vector",r.SheetNames.map(function(e){return"<vt:lpstr>"+E(e)+"</vt:lpstr>"}).join(""),{size:r.Worksheets,baseType:"lpstr"})),2<n.length&&(n[n.length]="</Properties>",n[1]=n[1].replace("/>",">")),n.join("")}var Ri=/<[^>]+>[^<]*/g;function Ai(t){var r,n=[C,T("Properties",null,{xmlns:Nr.CUST_PROPS,"xmlns:vt":Nr.vt})];return t&&(r=1,oe(t).forEach(function(e){++r,n[n.length]=T("property",function(e,t){switch(typeof e){case"string":var r=T("vt:lpwstr",E(e));return r=t?r.replace(/&quot;/g,"_x0022_"):r;case"number":return T((0|e)==e?"vt:i4":"vt:r8",E(String(e)));case"boolean":return T("vt:bool",e?"true":"false")}if(e instanceof Date)return T("vt:filetime",xr(e));throw new Error("Unable to serialize "+e)}(t[e],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:E(e)})}),2<n.length)&&(n[n.length]="</Properties>",n[1]=n[1].replace("/>",">")),n.join("")}var Ni,Oi={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function Ii(e){var t=e._R(4),e=e._R(4);return new Date(1e3*(e/1e7*Math.pow(2,32)+t/1e7-11644473600)).toISOString().replace(/\.000/,"")}function Mi(e,t,r){var n=e.l,i=e._R(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return i}function ki(e,t,r){var n=e._R(0,"lpwstr");return r&&(e.l+=4-(n.length+1&3)&3),n}function Di(e,t,r){return 31===t?ki(e):Mi(e,0,r)}function Pi(e,t,r){return Di(e,t,!1===r?0:4)}function Li(e){for(var t,r,n,i=e._R(4),o=[],s=0;s<i/2;++s)o.push((n=r=void 0,r=(t=e).l,n=Ui(t,81),0==t[t.l]&&0==t[t.l+1]&&t.l-r&2&&(t.l+=2),[n,Ui(t,3)]));return o}function Fi(e,t){for(var r=e._R(4),n={},i=0;i!=r;++i){var o=e._R(4),s=e._R(4);n[o]=e._R(s,1200===t?"utf16le":"utf8").replace(Q,"").replace(ee,"!"),1200===t&&s%2&&(e.l+=2)}return 3&e.l&&(e.l=e.l>>3<<2),n}function Hi(e){var t=e._R(4),r=e.slice(e.l,e.l+t);return e.l+=t,0<(3&t)&&(e.l+=4-(3&t)&3),r}function Ui(e,t,r){var n,i,o=e._R(2),s=r||{};if(e.l+=2,t!==Qn&&o!==t&&-1===ei.indexOf(t)&&(4126!=(65534&t)||4126!=(65534&o)))throw new Error("Expected type "+t+" saw "+o);switch(t===Qn?o:t){case 2:return i=e._R(2,"i"),s.raw||(e.l+=2),i;case 3:return i=e._R(4,"i");case 11:return 0!==e._R(4);case 19:return i=e._R(4);case 30:return Mi(e,0,4).replace(Q,"");case 31:return ki(e);case 64:return Ii(e);case 65:return Hi(e);case 71:return(i={}).Size=(n=e)._R(4),n.l+=i.Size+3-(i.Size-1)%4,i;case 80:return Pi(e,o,!s.raw).replace(Q,"");case 81:return function(e,t){if(t)return Di(e,t,0);throw new Error("VtUnalignedString must have positive length")}(e,o).replace(Q,"");case 4108:return Li(e);case 4126:case 4127:return(4127==o?function(e){for(var t=e._R(4),r=[],n=0;n!=t;++n){var i=e.l;r[n]=e._R(0,"lpwstr").replace(Q,""),e.l-i&2&&(e.l+=2)}return r}:function(e){for(var t=e._R(4),r=[],n=0;n!=t;++n)r[n]=e._R(0,"lpstr-cp").replace(Q,"");return r})(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+o)}}function Vi(e,t){var r,n,i,o=ye(4),s=ye(4);switch(o._W(4,80==e?31:e),e){case 3:s._W(-4,t);break;case 5:(s=ye(8))._W(8,t,"f");break;case 11:s._W(4,t?1:0);break;case 64:n=(r=("string"==typeof(r=t)?new Date(Date.parse(r)):r).getTime()/1e3+11644473600)%Math.pow(2,32),r=(r-n)/Math.pow(2,32),r*=1e7,0<(i=(n*=1e7)/Math.pow(2,32)|0)&&(n%=Math.pow(2,32),r+=i),(i=ye(8))._W(4,n),i._W(4,r),s=i;break;case 31:case 80:for((s=ye(4+2*(t.length+1)+(t.length%2?0:2)))._W(4,t.length+1),s._W(0,t,"dbcs");s.l!=s.length;)s._W(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Re([o,s])}function Wi(e,t){for(var r=e.l,n=e._R(4),i=e._R(4),o=[],s=0,a=0,l=-1,c={},s=0;s!=i;++s){var u=e._R(4),d=e._R(4);o[s]=[u,d+r]}o.sort(function(e,t){return e[1]-t[1]});var h={};for(s=0;s!=i;++s){if(e.l!==o[s][1]){var p=!0;if(0<s&&t)switch(t[o[s-1][0]].t){case 2:e.l+2===o[s][1]&&(e.l+=2,p=!1);break;case 80:case 4108:e.l<=o[s][1]&&(e.l=o[s][1],p=!1)}if((!t||0==s)&&e.l<=o[s][1]&&(p=!1,e.l=o[s][1]),p)throw new Error("Read Error: Expected address "+o[s][1]+" at "+e.l+" :"+s)}if(t){var f=t[o[s][0]];if(h[f.n]=Ui(e,f.t,{raw:!0}),"version"===f.p&&(h[f.n]=String(h[f.n]>>16)+"."+("0000"+String(65535&h[f.n])).slice(-4)),"CodePage"==f.n)switch(h[f.n]){case 0:h[f.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Ee(a=h[f.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[f.n])}}else if(1===o[s][0]){a=h.CodePage=Ui(e,2);Ee(a),-1!==l&&(m=e.l,e.l=o[l][1],c=Fi(e,a),e.l=m)}else if(0===o[s][0])0===a?(l=s,e.l=o[s+1][1]):c=Fi(e,a);else{var g,m=c[o[s][0]];switch(e[e.l]){case 65:e.l+=4,g=Hi(e);break;case 30:case 31:e.l+=4,g=Pi(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,g=e._R(4,"i");break;case 19:e.l+=4,g=e._R(4);break;case 5:e.l+=4,g=e._R(8,"f");break;case 11:e.l+=4,g=y(e,4);break;case 64:e.l+=4,g=de(Ii(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[m]=g}}return e.l=r+n,h}var $i=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Bi(e,t,r){var n,i,o,s,a=ye(8),l=[],c=[],u=8,d=0,h=ye(8),p=ye(8);if(h._W(4,2),h._W(4,1200),p._W(4,1),c.push(h),l.push(p),u+=8+h.length,!t){(p=ye(8))._W(4,0),l.unshift(p);var f=[ye(4)];for(f[0]._W(4,e.length),d=0;d<e.length;++d){var g=e[d][0];for((h=ye(8+2*(g.length+1)+(g.length%2?0:2)))._W(4,d+2),h._W(4,g.length+1),h._W(0,g,"dbcs");h.l!=h.length;)h._W(1,0);f.push(h)}h=Re(f),c.unshift(h),u+=8+h.length}for(d=0;d<e.length;++d)t&&!t[e[d][0]]||-1<$i.indexOf(e[d][0])||-1<Si.indexOf(e[d][0])||null!=e[d][1]&&(o=e[d][1],n=0,h=t?("version"==(i=r[n=+t[e[d][0]]]).p&&"string"==typeof o&&(o=(+(s=o.split("."))[0]<<16)+(+s[1]||0)),Vi(i.t,o)):(-1==(s=function(e){switch(typeof e){case"boolean":return 11;case"number":return(0|e)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64}return-1}(o))&&(s=31,o=String(o)),Vi(s,o)),c.push(h),(p=ye(8))._W(4,t?n:2+d),l.push(p),u+=8+h.length);for(var m=8*(c.length+1),d=0;d<c.length;++d)l[d]._W(4,m),m+=c[d].length;return a._W(4,u),a._W(4,c.length),Re([a].concat(l).concat(c))}function ji(e,t,r){e=e.content;if(!e)return{};hn(e,0);var n,i,o=0,s=(e.chk("feff","Byte Order: "),e._R(2),e._R(4)),a=e._R(16);if(a!==X.utils.consts.HEADER_CLSID&&a!==r)throw new Error("Bad PropertySet CLSID "+a);if(1!==(r=e._R(4))&&2!==r)throw new Error("Unrecognized #Sets: "+r);if(a=e._R(16),i=e._R(4),1===r&&i!==e.l)throw new Error("Length mismatch: "+i+" !== "+e.l);2===r&&(n=e._R(16),o=e._R(4));var l,c,u=Wi(e,t),d={SystemIdentifier:s};for(l in u)d[l]=u[l];if(d.FMTID=a,1!==r){if(o-e.l==2&&(e.l+=2),e.l!==o)throw new Error("Length mismatch 2: "+e.l+" !== "+o);try{c=Wi(e,null)}catch(e){}for(l in c)d[l]=c[l];d.FMTID=[a,n]}return d}function zi(e,t,r,n,i,o){var s=ye(i?68:48),a=[s],t=(s._W(2,65534),s._W(2,0),s._W(4,842412599),s._W(16,X.utils.consts.HEADER_CLSID,"hex"),s._W(4,i?2:1),s._W(16,t,"hex"),s._W(4,i?68:48),Bi(e,r,n));return a.push(t),i&&(e=Bi(i,null,null),s._W(16,o,"hex"),s._W(4,68+t.length),a.push(e)),Re(a)}function Yi(e,t){return e._R(t),null}function y(e,t){return 1===e._R(t)}function Gi(e,t){return(t=t||ye(2))._W(2,+!!e),t}function d(e){return e._R(2,"u")}function qi(e,t){return(t=t||ye(2))._W(2,e),t}function Ki(e,t){for(var r=e,e=t,n=d,i=[],o=r.l+e;r.l<o;)i.push(n(r,o-r.l));if(o!==r.l)throw new Error("Slurp error");return i}function Xi(e,t,r){(r=r||ye(2))._W(1,"e"==t?+e:+!!e),r._W(1,"e"==t?1:0)}function Ji(e,t,r){var n=e._R(r&&12<=r.biff?2:1),i="sbcs-cont",o=g,r=(r&&8<=r.biff&&(g=1200),r&&8!=r.biff?12==r.biff&&(i="wstr"):e._R(1)&&(i="dbcs-cont"),2<=r.biff&&r.biff<=5&&(i="cpstr"),n?e._R(n,i):"");return g=o,r}function Zi(e,t,r){if(r){if(2<=r.biff&&r.biff<=5)return e._R(t,"cpstr");if(12<=r.biff)return e._R(t,"dbcs-cont")}return 0===e._R(1)?e._R(t,"sbcs-cont"):e._R(t,"dbcs-cont")}function Qi(e,t,r){var n=e._R(r&&2==r.biff?1:2);return 0===n?(e.l++,""):Zi(e,n,r)}function eo(e,t,r){var n;return 5<r.biff?Qi(e,0,r):0===(n=e._R(1))?(e.l++,""):e._R(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function to(e,t,r){return(r=r||ye(3+2*e.length))._W(2,e.length),r._W(1,1),r._W(31,e,"utf16le"),r}function ro(e){var t,r,n=e._R(16);switch(n){case"e0c9ea79f9bace118c8200aa004ba90b":return i=(t=e)._R(4),r=t.l,a=!1,24<i&&(t.l+=i-24,"795881f43b1d7f48af2c825dc4852763"===t._R(16)&&(a=!0),t.l=r),r=t._R((a?i-24:i)>>1,"utf16le").replace(Q,""),a&&(t.l+=24),r;case"0303000000000000c000000000000046":for(var i=e,o=i._R(2),s="";0<o--;)s+="../";var a=i._R(0,"lpstr-ansi");if(i.l+=2,57005!=i._R(2))throw new Error("Bad FileMoniker");if(0===i._R(4))return s+a.replace(/\\/g,"/");if(a=i._R(4),3!=i._R(2))throw new Error("Bad FileMoniker");return s+i._R(a>>1,"utf16le").replace(Q,"");default:throw new Error("Unsupported Moniker "+n)}}function no(e){var t=e._R(4);return 0<t?e._R(t,"utf16le").replace(Q,""):""}function io(e,t){(t=t||ye(6+2*e.length))._W(4,1+e.length);for(var r=0;r<e.length;++r)t._W(2,e.charCodeAt(r));t._W(2,0)}function oo(e){return[e._R(1),e._R(1),e._R(1),e._R(1)]}function so(e){e=oo(e);return e[3]=0,e}function ao(e){return{r:e._R(2),c:e._R(2),ixfe:e._R(2)}}function lo(e,t,r,n){return(n=n||ye(6))._W(2,e),n._W(2,t),n._W(2,r||0),n}function co(e){return[e._R(2),jn(e)]}function uo(e){var t=e._R(2),r=e._R(2);return{s:{c:e._R(2),r:t},e:{c:e._R(2),r:r}}}function ho(e,t){(t=t||ye(8))._W(2,e.s.r),t._W(2,e.e.r),t._W(2,e.s.c),t._W(2,e.e.c)}function po(e){var t=e._R(2),r=e._R(2);return{s:{c:e._R(1),r:t},e:{c:e._R(1),r:r}}}var fo=po;function go(e){e.l+=4;var t=e._R(2),r=e._R(2),n=e._R(2);return e.l+=12,[r,t,n]}function mo(e){e.l+=2,e.l+=e._R(2)}var yo={0:mo,4:mo,5:mo,6:mo,7:function(e){return e.l+=4,e.cf=e._R(2),{}},8:mo,9:mo,10:mo,11:mo,12:mo,13:function(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e._R(2),e.l+=4,t},14:mo,15:mo,16:mo,17:mo,18:mo,19:mo,20:mo,21:go};function vo(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e._R(2),2<=(t-=2)&&(r.dt=e._R(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(6<t)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e._R(t),r}function bo(e,t,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}r=ye(i);return r._W(2,n),r._W(2,t),4<i&&r._W(2,29282),6<i&&r._W(2,1997),8<i&&(r._W(2,49161),r._W(2,1),r._W(2,1798),r._W(2,0)),r}function wo(e){for(var t,r,n,i=ye(8),o=(i._W(4,e.Count),i._W(4,e.Unique),[]),s=0;s<e.length;++s)o[s]=(t=e[s],n=r=void 0,t=t.t||"",(r=ye(3))._W(2,t.length),r._W(1,1),(n=ye(2*t.length))._W(2*t.length,t,"utf16le"),Re([r,n]));var a=Re([i].concat(o));return a.parts=[i.length].concat(o.map(function(e){return e.length})),a}function Co(e,t,r){var n=0,e=(r&&2==r.biff||(n=e._R(2)),e._R(2));return r&&2==r.biff&&(n=1-(e>>15),e&=32767),[{Unsynced:1&n,DyZero:(2&n)>>1,ExAsc:(4&n)>>2,ExDsc:(8&n)>>3},e]}Nt=eo;function Eo(e,t,r){var t=e.l+t,r=8!=r.biff&&r.biff?2:4,n=e._R(r),r=e._R(r),i=e._R(2),o=e._R(2);return e.l=t,{s:{r:n,c:i},e:{r:r,c:o}}}function To(e,t,r,n){r=r&&5==r.biff,(n=n||ye(r?16:20))._W(2,0),e.style?(n._W(2,e.numFmtId||0),n._W(2,65524)):(n._W(2,e.numFmtId||0),n._W(2,t<<4)),t=0;return 0<e.numFmtId&&r&&(t|=1024),n._W(4,t),n._W(4,0),r||n._W(4,0),n._W(2,0),n}function So(e,t,r){var n=ao(e),e=(2!=r.biff&&9!=t||++e.l,t=(r=e)._R(1),1===r._R(1)?t:1===t);return n.val=e,n.t=!0===e||!1===e?"b":"e",n}function _o(e,t,r){return 0===t?"":eo(e,0,r)}function xo(e,t,r){var n,i=e._R(2),i={fBuiltIn:1&i,fWantAdvise:i>>>1&1,fWantPict:i>>>2&1,fOle:i>>>3&1,fOleLink:i>>>4&1,cf:i>>>5&1023,fIcon:i>>>15&1};return 14849===r.sbcch&&(n=function(e,t,r){e.l+=4;var t=e.l+(t-=4),r=Ji(e,0,r),n=e._R(2);if(n!==(t-=e.l))throw new Error("Malformed AddinUdf: padding = "+t+" != "+n);return e.l+=n,r}(e,t-2,r)),i.body=n||e._R(t-2),"string"==typeof n&&(i.Name=n),i}var Ro=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Ao(e,t,r){var t=e.l+t,n=e._R(2),i=e._R(1),o=e._R(1),s=e._R(r&&2==r.biff?1:2),a=0,o=((!r||5<=r.biff)&&(5!=r.biff&&(e.l+=2),a=e._R(2),5==r.biff&&(e.l+=2),e.l+=4),Zi(e,o,r)),n=(32&n&&(o=Ro[o.charCodeAt(0)]),t-e.l);return r&&2==r.biff&&--n,{chKey:i,Name:o,itab:a,rgce:t!=e.l&&0!==s&&0<n?function(e,t,r,n){var i,t=e.l+t,n=zl(e,n,r);t!==e.l&&(i=jl(e,t-e.l,n,r));return[n,i]}(e,n,r,s):[]}}function No(e,t,r){var n;if(r.biff<8)return a=r,3==(n=e)[n.l+1]&&n[n.l]++,3==(n=Ji(n,0,a)).charCodeAt(0)?n.slice(1):n;for(var i,o,s=[],a=e.l+t,l=e._R(8<r.biff?4:2);0!=l--;)s.push((i=e,r.biff,o=8<(o=r).biff?4:2,[i._R(o),i._R(o,"i"),i._R(o,"i")]));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return s}function Oo(e,t,r){var n=fo(e,6);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,function(e,t,r){var n,i=e.l+t,o=2==r.biff?1:2,s=e._R(o);if(65535==s)return[[],pn(e,t-2)];var a=zl(e,s,r);t!==s+o&&(n=jl(e,t-s-o,a,r));return e.l=i,[a,n]}(e,t,r)]}var Io={8:function(e,t){var t=e.l+t,r=(e.l+=10,e._R(2)),n=(e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4,e._R(1));return e.l+=n,e.l=t,{fmt:r}}};function Mo(e){for(var t=ye(24),r=W(e[0]),n=(t._W(2,r.r),t._W(2,r.r),t._W(2,r.c),t._W(2,r.c),"d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" ")),i=0;i<16;++i)t._W(1,parseInt(n[i],16));return Re([t,function(e){var t=ye(512),r=0,n=e.Target,i=-1<(e=(n="file://"==n.slice(0,7)?n.slice(7):n).indexOf("#"))?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3}t._W(4,2),t._W(4,i);for(var o=[8,6815827,6619237,4849780,83],r=0;r<o.length;++r)t._W(4,o[r]);if(28==i)io(n=n.slice(1),t);else if(2&i){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t._W(1,parseInt(o[r],16));var s=-1<e?n.slice(0,e):n;for(t._W(4,2*(s.length+1)),r=0;r<s.length;++r)t._W(2,s.charCodeAt(r));t._W(2,0),8&i&&io(-1<e?n.slice(e+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t._W(1,parseInt(o[r],16));for(var a=0;"../"==n.slice(3*a,3*a+3)||"..\\"==n.slice(3*a,3*a+3);)++a;for(t._W(2,a),t._W(4,n.length-3*a+1),r=0;r<n.length-3*a;++r)t._W(1,255&n.charCodeAt(r+3*a));for(t._W(1,0),t._W(2,65535),t._W(2,57005),r=0;r<6;++r)t._W(4,0)}return t.slice(0,t.l)}(e[1])])}function ko(e,t,r){var n,i,o,s,a,l;return r.cellStyles?(l=r&&12<=r.biff?4:2,n=e._R(l),i=e._R(l),o=e._R(l),s=e._R(l),a=e._R(2),2==l&&(e.l+=2),l={s:n,e:i,w:o,ixfe:s,flags:a},(5<=r.biff||!r.biff)&&(l.level=a>>8&7),l):pn(e,t)}var Do=ao,Po=Ki,Lo=Qi;var Fo,Ho,Uo,Vo=[2,3,48,49,131,139,140,245],Wo=(Fo={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},Ho=Et({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127}),Uo={B:8,C:250,L:1,D:8,"?":0,"":0},{to_workbook:function(e,t){try{return _n($o(e,t),t)}catch(e){if(t&&t.WTF)throw e}return{SheetNames:[],Sheets:{}}},to_sheet:$o,from_sheet:function(e,t){if(0<=+(t=t||{}).codepage&&Ee(+t.codepage),"string"==t.type)throw new Error("Cannot write DBF to JS string");for(var r=gn(),n=(t=Ch(e,{header:1,raw:!0,cellDates:!0}))[0],i=t.slice(1),o=e["!cols"]||[],s=0,a=0,l=0,c=1,s=0;s<n.length;++s)if(((o[s]||{}).DBF||{}).name)n[s]=o[s].DBF.name,++l;else if(null!=n[s]){if(++l,"number"==typeof n[s]&&(n[s]=n[s].toString(10)),"string"!=typeof n[s])throw new Error("DBF Invalid column name "+n[s]+" |"+typeof n[s]+"|");if(n.indexOf(n[s])!==s)for(a=0;a<1024;++a)if(-1==n.indexOf(n[s]+"_"+a)){n[s]+="_"+a;break}}var u=Ce(e["!ref"]),d=[],h=[],p=[];for(s=0;s<=u.e.c-u.s.c;++s){for(var f="",g="",m=0,y=[],a=0;a<i.length;++a)null!=i[a][s]&&y.push(i[a][s]);if(0==y.length||null==n[s])d[s]="?";else{for(a=0;a<y.length;++a){switch(typeof y[a]){case"number":g="B";break;case"string":g="C";break;case"boolean":g="L";break;case"object":g=y[a]instanceof Date?"D":"C";break;default:g="C"}m=Math.max(m,String(y[a]).length),f=f&&f!=g?"C":g}250<m&&(m=250),"C"==(g=((o[s]||{}).DBF||{}).type)&&o[s].DBF.len>m&&(m=o[s].DBF.len),"B"==f&&"N"==g&&(f="N",p[s]=o[s].DBF.dec,m=o[s].DBF.len),h[s]="C"==f||"N"==g?m:Uo[f]||0,c+=h[s],d[s]=f}}var v,b,w=r.next(32);for(w._W(4,318902576),w._W(4,i.length),w._W(2,296+32*l),w._W(2,c),s=0;s<4;++s)w._W(4,0);for(w._W(4,0|(+Ho[_]||3)<<8),a=s=0;s<n.length;++s)null!=n[s]&&(v=r.next(32),b=(n[s].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11),v._W(1,b,"sbcs"),v._W(1,"?"==d[s]?"C":d[s],"sbcs"),v._W(4,a),v._W(1,h[s]||Uo[d[s]]||0),v._W(1,p[s]||0),v._W(1,2),v._W(4,0),v._W(1,0),v._W(4,0),v._W(4,0),a+=h[s]||Uo[d[s]]||0);var C=r.next(264);for(C._W(4,13),s=0;s<65;++s)C._W(4,0);for(s=0;s<i.length;++s){var E=r.next(c);for(E._W(1,0),a=0;a<n.length;++a)if(null!=n[a])switch(d[a]){case"L":E._W(1,null==i[s][a]?63:i[s][a]?84:70);break;case"B":E._W(8,i[s][a]||0,"f");break;case"N":var T="0";for("number"==typeof i[s][a]&&(T=i[s][a].toFixed(p[a]||0)),l=0;l<h[a]-T.length;++l)E._W(1,32);E._W(1,T,"sbcs");break;case"D":i[s][a]?(E._W(4,("0000"+i[s][a].getFullYear()).slice(-4),"sbcs"),E._W(2,("00"+(i[s][a].getMonth()+1)).slice(-2),"sbcs"),E._W(2,("00"+i[s][a].getDate()).slice(-2),"sbcs")):E._W(8,"00000000","sbcs");break;case"C":var S=String(null!=i[s][a]?i[s][a]:"").slice(0,h[a]);for(E._W(1,S,"sbcs"),l=0;l<h[a]-S.length;++l)E._W(1,32)}}return r.next(1)._W(1,26),r.end()}});function $o(e,t){t=t||{},t.dateNF||(t.dateNF="yyyymmdd"),e=Rn(function(e,t){var r=[],n=B(1);switch(t.type){case"base64":n=xe(_e(e));break;case"binary":n=xe(e);break;case"buffer":case"array":n=e}hn(n,0);var i=n._R(1),o=!!(136&i),s=!1,a=!1;switch(i){case 2:case 3:break;case 48:case 49:o=s=!0;break;case 131:case 139:break;case 140:a=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+i.toString(16))}for(var l=0,c=521,u=(2==i&&(l=n._R(2)),n.l+=3,1048576<(l=2!=i?n._R(4):l)&&(l=1e6),2!=i&&(c=n._R(2)),n._R(2)),d=t.codepage||1252,h=(2!=i&&(n.l+=16,n._R(1),0!==n[n.l]&&(d=Fo[n[n.l]]),n.l+=1,n.l+=2),a&&(n.l+=36),[]),p={},f=Math.min(n.length,2==i?521:c-10-(s?264:0)),g=a?32:11;n.l<f&&13!=n[n.l];)switch((p={}).name=ae.utils.decode(d,n.slice(n.l,n.l+g)).replace(/[\u0000\r\n].*$/g,""),n.l+=g,p.type=String.fromCharCode(n._R(1)),2==i||a||(p.offset=n._R(4)),p.len=n._R(1),2==i&&(p.offset=n._R(2)),p.dec=n._R(1),p.name.length&&h.push(p),2!=i&&(n.l+=a?13:14),p.type){case"B":s&&8==p.len||!t.WTF||console.log("Skipping "+p.name+":"+p.type);break;case"G":case"P":t.WTF&&console.log("Skipping "+p.name+":"+p.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+p.type)}if(13!==n[n.l]&&(n.l=c-1),13!==n._R(1))throw new Error("DBF Terminator not found "+n.l+" "+n[n.l]);n.l=c;var m=0,y=0;for(r[0]=[],y=0;y!=h.length;++y)r[0][y]=h[y].name;for(;0<l--;)if(42===n[n.l])n.l+=u;else for(++n.l,r[++m]=[],y=y=0;y!=h.length;++y){var v=n.slice(n.l,n.l+h[y].len),b=(n.l+=h[y].len,hn(v,0),ae.utils.decode(d,v));switch(h[y].type){case"C":b.trim().length&&(r[m][y]=b.replace(/\s+$/,""));break;case"D":8===b.length?r[m][y]=new Date(+b.slice(0,4),+b.slice(4,6)-1,+b.slice(6,8)):r[m][y]=b;break;case"F":r[m][y]=parseFloat(b.trim());break;case"+":case"I":r[m][y]=a?2147483648^v._R(-4,"i"):v._R(4,"i");break;case"L":switch(b.trim().toUpperCase()){case"Y":case"T":r[m][y]=!0;break;case"N":case"F":r[m][y]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+b+"|")}break;case"M":if(!o)throw new Error("DBF Unexpected MEMO for type "+i.toString(16));r[m][y]="##MEMO##"+(a?parseInt(b.trim(),10):v._R(4));break;case"N":(b=b.replace(/\u0000/g,"").trim())&&"."!=b&&(r[m][y]=+b||0);break;case"@":r[m][y]=new Date(v._R(-8,"f")-621356832e5);break;case"T":r[m][y]=new Date(864e5*(v._R(4)-2440588)+v._R(4));break;case"Y":r[m][y]=v._R(4,"i")/1e4+v._R(4,"i")/1e4*Math.pow(2,32);break;case"O":r[m][y]=-v._R(-8,"f");break;case"B":if(s&&8==h[y].len){r[m][y]=v._R(8,"f");break}case"G":case"P":v.l+=h[y].len;break;case"0":if("_NullFlags"===h[y].name)break;default:throw new Error("DBF Unsupported data type "+h[y].type)}}if(2!=i&&n.l<n.length&&26!=n[n.l++])throw new Error("DBF EOF Marker missing "+(n.l-1)+" of "+n.length+" "+n[n.l-1].toString(16));return t&&t.sheetRows&&(r=r.slice(0,t.sheetRows)),t.DBF=h,r}(e,t),t);return e["!cols"]=t.DBF.map(function(e){return{wch:e.len,DBF:e}}),delete t.DBF,e}Bo={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},jo=new RegExp("N("+oe(Bo).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),zo=function(e,t){t=Bo[t];return"number"==typeof t?n(t):t},Yo=function(e,t,r){t=t.charCodeAt(0)-32<<4|r.charCodeAt(0)-48;return 59==t?e:n(t)},Bo["|"]=254;var Bo,jo,zo,Yo,Go={to_workbook:function(e,t){return _n(Ko(e,t),t)},to_sheet:Ko,from_sheet:function(e,t){var r,n,i=["ID;PWXL;N;E"],o=[],s=Ce(e["!ref"]),a=Array.isArray(e),l="\r\n";i.push("P;PGeneral"),i.push("F;P0;DG0G8;M255"),e["!cols"]&&(r=i,e["!cols"].forEach(function(e,t){t="F;W"+(t+1)+" "+(t+1)+" ";e.hidden?t+="0":("number"!=typeof e.width||e.wpx||(e.wpx=Ca(e.width)),"number"!=typeof e.wpx||e.wch||(e.wch=Ea(e.wpx)),"number"==typeof e.wch&&(t+=Math.round(e.wch)))," "!=t.charAt(t.length-1)&&r.push(t)})),e["!rows"]&&(n=i,e["!rows"].forEach(function(e,t){var r="F;";e.hidden?r+="M0;":e.hpt?r+="M"+20*e.hpt+";":e.hpx&&(r+="M"+20*Aa(e.hpx)+";"),2<r.length&&n.push(r+"R"+(t+1))})),i.push("B;Y"+(s.e.r-s.s.r+1)+";X"+(s.e.c-s.s.c+1)+";D"+[s.s.c,s.s.r,s.e.c,s.e.r].join(" "));for(var c=s.s.r;c<=s.e.r;++c)for(var u=s.s.c;u<=s.e.c;++u){var d=se({r:c,c:u});(d=a?(e[c]||[])[u]:e[d])&&(null!=d.v||d.f&&!d.F)&&o.push(function(e,t,r){var n="C;Y"+(t+1)+";X"+(r+1)+";K";switch(e.t){case"n":n+=e.v||0,e.f&&!e.F&&(n+=";E"+xl(e.f,{r:t,c:r}));break;case"b":n+=e.v?"TRUE":"FALSE";break;case"e":n+=e.w||e.v;break;case"d":n+='"'+(e.w||e.v)+'"';break;case"s":n+='"'+e.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return n}(d,c,u))}return i.join(l)+l+o.join(l)+l+"E"+l}};function qo(e,t){var r,n,i=e.split(/[\n\r]+/),o=-1,s=-1,a=0,l=0,c=[],u=[],d=null,e={},h=[],p=[],f=0;for(0<=+t.codepage&&Ee(+t.codepage);a!==i.length;++a){var g,f=0,m=i[a].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,Yo).replace(jo,zo),y=m.replace(/;;/g,"\0").split(";").map(function(e){return e.replace(/\u0000/g,";")}),v=y[0];if(0<m.length)switch(v){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==y[1].charAt(0)&&u.push(m.slice(3).replace(/;;/g,";"));break;case"C":for(var b=!1,w=!1,C=!1,E=!1,T=-1,S=-1,l=1;l<y.length;++l)switch(y[l].charAt(0)){case"A":break;case"X":s=parseInt(y[l].slice(1))-1,w=!0;break;case"Y":for(o=parseInt(y[l].slice(1))-1,w||(s=0),n=c.length;n<=o;++n)c[n]=[];break;case"K":'"'===(g=y[l].slice(1)).charAt(0)?g=g.slice(1,g.length-1):"TRUE"===g?g=!0:"FALSE"===g?g=!1:isNaN(kt(g))?isNaN(Pt(g).getDate())||(g=de(g)):(g=kt(g),null!==d&&Be(d)&&(g=At(g))),void 0!==ae&&"string"==typeof g&&"string"!=(t||{}).type&&(t||{}).codepage&&(g=ae.utils.decode(t.codepage,g)),b=!0;break;case"E":var E=!0,_=Tl(y[l].slice(1),{r:o,c:s});c[o][s]=[c[o][s],_];break;case"S":C=!0,c[o][s]=[c[o][s],"S5S"];break;case"G":break;case"R":T=parseInt(y[l].slice(1))-1;break;case"C":S=parseInt(y[l].slice(1))-1;break;default:if(t&&t.WTF)throw new Error("SYLK bad record "+m)}if(b&&(c[o][s]&&2==c[o][s].length?c[o][s][0]=g:c[o][s]=g,d=null),C){if(E)throw new Error("SYLK shared formula cannot have own formula");var x=-1<T&&c[T][S];if(!x||!x[1])throw new Error("SYLK shared formula cannot find base");c[o][s][1]=Rl(x[1],{r:o-T,c:s-S})}break;case"F":var R=0;for(l=1;l<y.length;++l)switch(y[l].charAt(0)){case"X":s=parseInt(y[l].slice(1))-1,++R;break;case"Y":for(o=parseInt(y[l].slice(1))-1,n=c.length;n<=o;++n)c[n]=[];break;case"M":f=parseInt(y[l].slice(1))/20;break;case"F":case"G":break;case"P":d=u[parseInt(y[l].slice(1))];break;case"S":case"D":case"N":break;case"W":for(r=y[l].slice(1).split(" "),n=parseInt(r[0],10);n<=parseInt(r[1],10);++n)f=parseInt(r[2],10),p[n-1]=0===f?{hidden:!0}:{wch:f},xa(p[n-1]);break;case"C":p[s=parseInt(y[l].slice(1))-1]||(p[s]={});break;case"R":h[o=parseInt(y[l].slice(1))-1]||(h[o]={}),0<f?(h[o].hpt=f,h[o].hpx=Na(f)):0===f&&(h[o].hidden=!0);break;default:if(t&&t.WTF)throw new Error("SYLK bad record "+m)}R<1&&(d=null);break;default:if(t&&t.WTF)throw new Error("SYLK bad record "+m)}}return 0<h.length&&(e["!rows"]=h),0<p.length&&(e["!cols"]=p),[c=t&&t.sheetRows?c.slice(0,t.sheetRows):c,e]}function Ko(e,t){var e=function(e,t){switch(t.type){case"base64":return qo(_e(e),t);case"binary":return qo(e,t);case"buffer":return qo(ce&&Buffer.isBuffer(e)?e.toString("binary"):p(e),t);case"array":return qo(Mt(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),r=e[0],n=e[1],i=Rn(r,t);return oe(n).forEach(function(e){i[e]=n[e]}),i}var Xo={to_workbook:function(e,t){return _n(Zo(e,t),t)},to_sheet:Zo,from_sheet:function(e){var t=[],r=Ce(e["!ref"]),n=Array.isArray(e);Qo(t,"TABLE",0,1,"sheetjs"),Qo(t,"VECTORS",0,r.e.r-r.s.r+1,""),Qo(t,"TUPLES",0,r.e.c-r.s.c+1,""),Qo(t,"DATA",0,0,"");for(var i=r.s.r;i<=r.e.r;++i){es(t,-1,0,"BOT");for(var o=r.s.c;o<=r.e.c;++o){var s,a=se({r:i,c:o});if(s=n?(e[i]||[])[o]:e[a])switch(s.t){case"n":var l=h?s.w:s.v;null==(l=l||null==s.v?l:s.v)?h&&s.f&&!s.F?es(t,1,0,"="+s.f):es(t,1,0,""):es(t,0,l,"V");break;case"b":es(t,0,s.v?1:0,s.v?"TRUE":"FALSE");break;case"s":es(t,1,0,!h||isNaN(s.v)?s.v:'="'+s.v+'"');break;case"d":s.w||(s.w=qe(s.z||ue[14],_t(de(s.v)))),h?es(t,0,s.w,"V"):es(t,1,0,s.w);break;default:es(t,1,0,"")}else es(t,1,0,"")}}es(t,-1,0,"EOD");return t.join("\r\n")}};function Jo(e,t){for(var r=e.split("\n"),n=-1,i=-1,o=0,s=[];o!==r.length;++o)if("BOT"===r[o].trim())s[++n]=[],i=0;else if(!(n<0)){for(var a=r[o].trim().split(","),l=a[0],c=a[1],u=r[++o]||"";1&(u.match(/["]/g)||[]).length&&o<r.length-1;)u+="\n"+r[++o];switch(u=u.trim(),+l){case-1:if("BOT"===u){s[++n]=[],i=0;continue}if("EOD"!==u)throw new Error("Unrecognized DIF special command "+u);break;case 0:"TRUE"===u?s[n][i]=!0:"FALSE"===u?s[n][i]=!1:isNaN(kt(c))?isNaN(Pt(c).getDate())?s[n][i]=c:s[n][i]=de(c):s[n][i]=kt(c),++i;break;case 1:u=(u=u.slice(1,u.length-1)).replace(/""/g,'"'),h&&u&&u.match(/^=".*"$/)&&(u=u.slice(2,-1)),s[n][i++]=""!==u?u:null}if("EOD"===u)break}return s=t&&t.sheetRows?s.slice(0,t.sheetRows):s}function Zo(e,t){return Rn(function(e,t){switch(t.type){case"base64":return Jo(_e(e),t);case"binary":return Jo(e,t);case"buffer":return Jo(ce&&Buffer.isBuffer(e)?e.toString("binary"):p(e),t);case"array":return Jo(Mt(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),t)}function Qo(e,t,r,n,i){e.push(t),e.push(r+","+n),e.push('"'+i.replace(/"/g,'""')+'"')}function es(e,t,r,n){e.push(t+","+r),e.push(1==t?'"'+n.replace(/"/g,'""')+'"':n)}ts=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),rs=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",ns=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),is="--SocialCalcSpreadsheetControlSave--";var ts,rs,ns,is,os={to_workbook:function(e,t){return _n(as(e,t),t)},to_sheet:as,from_sheet:function(e){return[ts,rs,ns,rs,function(e){if(!e||!e["!ref"])return"";for(var t,r,n=[],i=[],o=En(e["!ref"]),s=Array.isArray(e),a=o.s.r;a<=o.e.r;++a)for(var l=o.s.c;l<=o.e.c;++l)if(r=se({r:a,c:l}),(t=s?(e[a]||[])[l]:e[r])&&null!=t.v&&"z"!==t.t){switch(i=["cell",r,"t"],t.t){case"s":case"str":i.push(ss(t.v));break;case"n":t.f?(i[2]="vtf",i[3]="n",i[4]=t.v,i[5]=ss(t.f)):(i[2]="v",i[3]=t.v);break;case"b":i[2]="vt"+(t.f?"f":"c"),i[3]="nl",i[4]=t.v?"1":"0",i[5]=ss(t.f||(t.v?"TRUE":"FALSE"));break;case"d":var c=_t(de(t.v));i[2]="vtc",i[3]="nd",i[4]=""+c,i[5]=t.w||qe(t.z||ue[14],c);break;case"e":continue}n.push(i.join(":"))}return n.push("sheet:c:"+(o.e.c-o.s.c+1)+":r:"+(o.e.r-o.s.r+1)+":tvf:1"),n.push("valueformat:1:text-wiki"),n.join("\n")}(e),is].join("\n")}};function ss(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function as(e,t){return Rn(function(e,t){for(var r,n=e.split("\n"),i=-1,o=0,s=[];o!==n.length;++o){var a=n[o].trim().split(":");if("cell"===a[0]){var l=W(a[1]);if(s.length<=l.r)for(i=s.length;i<=l.r;++i)s[i]||(s[i]=[]);switch(i=l.r,r=l.c,a[2]){case"t":s[i][r]=a[3].replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n");break;case"v":s[i][r]=+a[3];break;case"vtf":var c=a[a.length-1];case"vtc":"nl"===a[3]?s[i][r]=!!+a[4]:s[i][r]=+a[4],"vtf"==a[2]&&(s[i][r]=[s[i][r],c])}}}return s=t&&t.sheetRows?s.slice(0,t.sheetRows):s}(e,t),t)}ls={44:",",9:"\t",59:";",124:"|"},cs={44:3,9:2,59:1,124:0};var ls,cs,us={to_workbook:function(e,t){return _n(gs(e,t),t)},to_sheet:gs,from_sheet:function(e){for(var t=[],r=Ce(e["!ref"]),n=Array.isArray(e),i=r.s.r;i<=r.e.r;++i){for(var o=[],s=r.s.c;s<=r.e.c;++s){var a=se({r:i,c:s});if((a=n?(e[i]||[])[s]:e[a])&&null!=a.v){for(var l=(a.w||(Sn(a),a.w)||"").slice(0,10);l.length<10;)l+=" ";o.push(l+(0===s?" ":""))}else o.push("          ")}t.push(o.join(""))}return t.join("\n")}};function ds(e,t,r,n,i){i.raw?t[r][n]=e:""!==e&&("TRUE"===e?t[r][n]=!0:"FALSE"===e?t[r][n]=!1:isNaN(kt(e))?isNaN(Pt(e).getDate())?t[r][n]=e:t[r][n]=de(e):t[r][n]=kt(e))}function hs(e){for(var t={},r=!1,n=0,i=0;n<e.length;++n)34==(i=e.charCodeAt(n))?r=!r:!r&&i in ls&&(t[i]=(t[i]||0)+1);for(n in i=[],t)Object.prototype.hasOwnProperty.call(t,n)&&i.push([t[n],n]);if(!i.length)for(n in t=cs)Object.prototype.hasOwnProperty.call(t,n)&&i.push([t[n],n]);return i.sort(function(e,t){return e[0]-t[0]||cs[e[1]]-cs[t[1]]}),ls[i.pop()[1]]||44}function ps(n,e){var i=e||{},e="",o=(null!=le&&null==i.dense&&(i.dense=le),i.dense?[]:{}),s={s:{c:0,r:0},e:{c:0,r:0}},a=("sep="==n.slice(0,4)?13==n.charCodeAt(5)&&10==n.charCodeAt(6)?(e=n.charAt(4),n=n.slice(7)):13==n.charCodeAt(5)||10==n.charCodeAt(5)?(e=n.charAt(4),n=n.slice(6)):e=hs(n.slice(0,1024)):e=i&&i.FS?i.FS:hs(n.slice(0,1024)),0),l=0,c=0,u=0,d=0,h=e.charCodeAt(0),t=!1,p=0,f=n.charCodeAt(0),g=(n=n.replace(/\r\n/gm,"\n"),null!=i.dateNF?(e=(e="number"==typeof(e=i.dateNF)?ue[e]:e).replace(et,"(\\d+)"),new RegExp("^"+e+"$")):null);function r(){var e,t=n.slice(u,d),r={};if(0===(t='"'==t.charAt(0)&&'"'==t.charAt(t.length-1)?t.slice(1,-1).replace(/""/g,'"'):t).length?r.t="z":i.raw||0===t.trim().length?(r.t="s",r.v=t):61==t.charCodeAt(0)?34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(r.t="s",r.v=t.slice(2,-1).replace(/""/g,'"')):1!=t.length?(r.t="n",r.f=t.slice(1)):(r.t="s",r.v=t):"TRUE"==t?(r.t="b",r.v=!0):"FALSE"==t?(r.t="b",r.v=!1):isNaN(c=kt(t))?!isNaN(Pt(t).getDate())||g&&t.match(g)?(r.z=i.dateNF||ue[14],e=0,g&&t.match(g)&&(t=function(e,n){var i=-1,o=-1,s=-1,a=-1,l=-1,c=-1;(e.match(et)||[]).forEach(function(e,t){var r=parseInt(n[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":i=r;break;case"d":s=r;break;case"h":a=r;break;case"s":c=r;break;case"m":0<=a?l=r:o=r}}),0<=c&&-1==l&&0<=o&&(l=o,o=-1);8==(e=7==(e=(""+(0<=i?i:(new Date).getFullYear())).slice(-4)+"-"+("00"+(1<=o?o:1)).slice(-2)+"-"+("00"+(1<=s?s:1)).slice(-2)).length?"0"+e:e).length&&(e="20"+e);var t=("00"+(0<=a?a:0)).slice(-2)+":"+("00"+(0<=l?l:0)).slice(-2)+":"+("00"+(0<=c?c:0)).slice(-2);return-1==a&&-1==l&&-1==c?e:-1==i&&-1==o&&-1==s?t:e+"T"+t}(i.dateNF,t.match(g)||[]),e=1),i.cellDates?(r.t="d",r.v=de(t,e)):(r.t="n",r.v=_t(de(t,e))),!1!==i.cellText&&(r.w=qe(r.z,r.v instanceof Date?_t(r.v):r.v)),i.cellNF||delete r.z):(r.t="s",r.v=t):(!(r.t="n")!==i.cellText&&(r.w=t),r.v=c),"z"!=r.t&&(i.dense?(o[a]||(o[a]=[]),o[a][l]=r):o[se({c:l,r:a})]=r),u=d+1,f=n.charCodeAt(u),s.e.c<l&&(s.e.c=l),s.e.r<a&&(s.e.r=a),p!=h)return l=0,++a,!!(i.sheetRows&&i.sheetRows<=a);++l}e:for(;d<n.length;++d)switch(p=n.charCodeAt(d)){case 34:34===f&&(t=!t);break;case h:case 10:case 13:if(!t&&r())break e}return 0<d-u&&r(),o["!ref"]=we(s),o}function fs(e,t){return!t||!t.PRN||t.FS||"sep="==e.slice(0,4)||0<=e.indexOf("\t")||0<=e.indexOf(",")||0<=e.indexOf(";")?ps(e,t):Rn(function(e,t){var r=t||{},n=[];if(e&&0!==e.length){for(var i=e.split(/[\r\n]/),o=i.length-1;0<=o&&0===i[o].length;)--o;for(var s=10,a=0,l=0;l<=o;++l)-1==(a=i[l].indexOf(" "))?a=i[l].length:a++,s=Math.max(s,a);for(l=0;l<=o;++l){n[l]=[];var c=0;for(ds(i[l].slice(0,s).trim(),n,l,c,r),c=1;c<=(i[l].length-s)/10+1;++c)ds(i[l].slice(s+10*(c-1),s+10*c).trim(),n,l,c,r)}r.sheetRows&&(n=n.slice(0,r.sheetRows))}return n}(e,t),t)}function gs(e,t){var r="",n="string"==t.type?[0,0,0,0]:ah(e,t);switch(t.type){case"base64":r=_e(e);break;case"binary":r=e;break;case"buffer":r=65001==t.codepage?e.toString("utf8"):t.codepage&&void 0!==ae?ae.utils.decode(t.codepage,e):ce&&Buffer.isBuffer(e)?e.toString("binary"):p(e);break;case"array":r=Mt(e);break;case"string":r=e;break;default:throw new Error("Unrecognized type "+t.type)}return 239==n[0]&&187==n[1]&&191==n[2]?r=me(r.slice(3)):"string"!=t.type&&"buffer"!=t.type&&65001==t.codepage?r=me(r):"binary"==t.type&&void 0!==ae&&t.codepage&&(r=ae.utils.decode(t.codepage,ae.utils.encode(28591,r))),"socialcalc:version:"==r.slice(0,19)?os.to_sheet("string"==t.type?r:me(r),t):fs(r,t)}ms={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},ys=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""],vs={0:{n:"BOF",f:d},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e,t,r){var n={s:{c:0,r:0},e:{c:0,r:0}};return 8==t&&r.qpro?(n.s.c=e._R(1),e.l++,n.s.r=e._R(2),n.e.c=e._R(1),e.l++,n.e.r=e._R(2)):(n.s.c=e._R(2),n.s.r=e._R(2),12==t&&r.qpro&&(e.l+=2),n.e.c=e._R(2),n.e.r=e._R(2),12==t&&r.qpro&&(e.l+=2),65535==n.s.c&&(n.s.c=n.e.c=n.s.r=n.e.r=0)),n}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,t,r){return(r=Ts(e,0,r))[1].v=e._R(2,"i"),r}},14:{n:"NUMBER",f:function(e,t,r){return(r=Ts(e,0,r))[1].v=e._R(8,"f"),r}},15:{n:"LABEL",f:Ss},16:{n:"FORMULA",f:function(e,t,r){var t=e.l+t,n=Ts(e,0,r);return n[1].v=e._R(8,"f"),r.qpro?e.l=t:(r=e._R(2),function(e,t){hn(e,0);var r=[],n=0,i="",o="",s="",a="";for(;e.l<e.length;){var l=e[e.l++];switch(l){case 0:r.push(e._R(8,"f"));break;case 1:o=_s(t[0].c,e._R(2),!0),i=_s(t[0].r,e._R(2),!1),r.push(o+i);break;case 2:var c=_s(t[0].c,e._R(2),!0),u=_s(t[0].r,e._R(2),!1);o=_s(t[0].c,e._R(2),!0),i=_s(t[0].r,e._R(2),!1),r.push(c+u+":"+o+i);break;case 3:if(e.l<e.length)return console.error("WK1 premature formula end");break;case 4:r.push("("+r.pop()+")");break;case 5:r.push(e._R(2));break;case 6:for(var d="";l=e[e.l++];)d+=String.fromCharCode(l);r.push('"'+d.replace(/"/g,'""')+'"');break;case 8:r.push("-"+r.pop());break;case 23:r.push("+"+r.pop());break;case 22:r.push("NOT("+r.pop()+")");break;case 20:case 21:a=r.pop(),s=r.pop(),r.push(["AND","OR"][l-20]+"("+s+","+a+")");break;default:if(l<32&&ys[l])a=r.pop(),s=r.pop(),r.push(s+ys[l]+a);else{if(!ms[l])return l<=7?console.error("WK1 invalid opcode "+l.toString(16)):l<=24?console.error("WK1 unsupported op "+l.toString(16)):l<=30?console.error("WK1 invalid opcode "+l.toString(16)):l<=115?console.error("WK1 unsupported function opcode "+l.toString(16)):console.error("WK1 unrecognized opcode "+l.toString(16));if(69==(n=ms[l][1])&&(n=e[e.l++]),r.length<n)return console.error("WK1 bad formula parse 0x"+l.toString(16)+":|"+r.join("|")+"|");c=r.slice(-n);r.length-=n,r.push(ms[l][0]+"("+c.join(",")+")")}}}1==r.length?t[1].f=""+r[0]:console.error("WK1 bad formula parse |"+r.join("|")+"|")}(e.slice(e.l,e.l+r),n),e.l+=r),n}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:Ss},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ns},222:{n:"SHEETNAMELP",f:function(e,t){for(var r=e[e.l++],n=(t-1<r&&(r=t-1),"");n.length<r;)n+=String.fromCharCode(e[e.l++]);return n}},65535:{n:""}},bs={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(e,t){var r=xs(e);return r[1].t="s",r[1].v=e._R(t-4,"cstr"),r}},23:{n:"NUMBER17",f:Rs},24:{n:"NUMBER18",f:function(e,t){var r=xs(e),n=(r[1].v=e._R(2),r[1].v>>1);if(1&r[1].v)switch(7&n){case 0:n=5e3*(n>>3);break;case 1:n=500*(n>>3);break;case 2:n=(n>>3)/20;break;case 3:n=(n>>3)/200;break;case 4:n=(n>>3)/2e3;break;case 5:n=(n>>3)/2e4;break;case 6:n=(n>>3)/16;break;case 7:n=(n>>3)/64}return r[1].v=n,r}},25:{n:"FORMULA19",f:function(e,t){var r=Rs(e);return e.l+=t-14,r}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(e,t){for(var r={},n=e.l+t;e.l<n;){var i=e._R(2);if(14e3==i){for(r[i]=[0,""],r[i][0]=e._R(2);e[e.l];)r[i][1]+=String.fromCharCode(e[e.l]),e.l++;e.l++}}return r}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(e,t){var r=xs(e),e=e._R(4);return r[1].v=e>>6,r}},38:{n:"??"},39:{n:"NUMBER27",f:As},40:{n:"FORMULA28",f:function(e,t){var r=As(e);return e.l+=t-10,r}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ns},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(e,t,r){if(r.qpro&&!(t<21))return r=e._R(1),e.l+=17,e.l+=1,e.l+=2,[r,e._R(t-21,"cstr")]}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};var ms,ys,vs,bs,ws={sheet_to_wk1:function(e,t){if(0<=+(t=t||{}).codepage&&Ee(+t.codepage),"string"==t.type)throw new Error("Cannot write WK1 to JS string");for(var r,n,i,o,s,a=gn(),l=Ce(e["!ref"]),c=Array.isArray(e),u=[],d=(S(a,0,(t=1030,(r=ye(2))._W(2,t),r)),S(a,6,(t=l,(r=ye(8))._W(2,t.s.c),r._W(2,t.s.r),r._W(2,t.e.c),r._W(2,t.e.r),r)),Math.min(l.e.r,8191)),h=l.s.r;h<=d;++h)for(var p=ve(h),f=l.s.c;f<=l.e.c;++f){h===l.s.r&&(u[f]=be(f));var g=c?(e[h]||[])[f]:e[u[f]+p];g&&"z"!=g.t&&("n"==g.t?(0|g.v)==g.v&&-32768<=g.v&&g.v<=32767?S(a,13,(n=h,i=f,o=g.v,s=void 0,(s=ye(7))._W(1,255),s._W(2,i),s._W(2,n),s._W(2,o,"i"),s)):S(a,14,(i=h,n=f,o=g.v,s=void 0,(s=ye(13))._W(1,255),s._W(2,n),s._W(2,i),s._W(8,o,"f"),s)):S(a,15,function(e,t,r){var n=ye(7+r.length);n._W(1,255),n._W(2,t),n._W(2,e),n._W(1,39);for(var i=0;i<n.length;++i){var o=r.charCodeAt(i);n._W(1,128<=o?95:o)}return n._W(1,0),n}(h,f,Sn(g).slice(0,239))))}return S(a,1),a.end()},book_to_wk3:function(e,t){if(0<=+(t=t||{}).codepage&&Ee(+t.codepage),"string"==t.type)throw new Error("Cannot write WK3 to JS string");var r=gn();S(r,0,function(e){for(var t=ye(26),r=(t._W(2,4096),t._W(2,4),t._W(4,0),0),n=0,i=0,o=0;o<e.SheetNames.length;++o){var s=e.SheetNames[o],s=e.Sheets[s];s&&s["!ref"]&&(++i,s=En(s["!ref"]),r<s.e.r&&(r=s.e.r),n<s.e.c)&&(n=s.e.c)}8191<r&&(r=8191);return t._W(2,r),t._W(1,i),t._W(1,n),t._W(2,0),t._W(2,0),t._W(1,1),t._W(1,2),t._W(4,0),t._W(4,0),t}(e));for(var n=0,i=0;n<e.SheetNames.length;++n)(e.Sheets[e.SheetNames[n]]||{})["!ref"]&&S(r,27,function(e,t){var r=ye(5+e.length);r._W(2,14e3),r._W(2,t);for(var n=0;n<e.length;++n){var i=e.charCodeAt(n);r[r.l++]=127<i?95:i}return r[r.l++]=0,r}(e.SheetNames[n],i++));for(var o,s,a,l,c,u,d=0,n=0;n<e.SheetNames.length;++n){var h=e.Sheets[e.SheetNames[n]];if(h&&h["!ref"]){for(var p=Ce(h["!ref"]),f=Array.isArray(h),g=[],m=Math.min(p.e.r,8191),y=p.s.r;y<=m;++y)for(var v=ve(y),b=p.s.c;b<=p.e.c;++b){y===p.s.r&&(g[b]=be(b));var w=f?(h[y]||[])[b]:h[g[b]+v];w&&"z"!=w.t&&("n"==w.t?S(r,23,(o=y,s=b,a=d,l=w.v,u=c=void 0,(u=ye(14))._W(2,o),u._W(1,a),u._W(1,s),0==l?(u._W(4,0),u._W(4,0),u._W(2,65535)):(l<(c=s=a=o=0)&&(o=1,l=-l),a=0|Math.log2(l),l/=Math.pow(2,a-31),0==(2147483648&(c=l>>>0))&&(++a,c=(l/=2)>>>0),l-=c,c=(2147483648|c)>>>0,l*=Math.pow(2,32),s=l>>>0,u._W(4,s),u._W(4,c),a+=16383+(o?32768:0),u._W(2,a)),u)):S(r,22,function(e,t,r,n){var i=ye(6+n.length);i._W(2,e),i._W(1,r),i._W(1,t),i._W(1,39);for(var o=0;o<n.length;++o){var s=n.charCodeAt(o);i._W(1,128<=s?95:s)}return i._W(1,0),i}(y,b,d,Sn(w).slice(0,239))))}++d}}return S(r,1),r.end()},to_workbook:function(e,t){switch(t.type){case"base64":return Es(xe(_e(e)),t);case"binary":return Es(xe(e),t);case"buffer":case"array":return Es(e,t)}throw"Unsupported type "+t.type}};function Cs(e,t,r){if(e){hn(e,e.l||0);for(var n=r.Enum||vs;e.l<e.length;){var i=e._R(2),o=n[i]||n[65535],s=e._R(2),a=e.l+s,s=o.f&&o.f(e,s,r);if(e.l=a,t(s,o,i))return}}}function Es(e,t){if(!e)return e;var i=t||{},o=(null!=le&&null==i.dense&&(i.dense=le),i.dense?[]:{}),s="Sheet1",a="",l=0,c={},u=[],n=[],d={s:{r:0,c:0},e:{r:0,c:0}},h=i.sheetRows||0;if(0==e[2]&&(8==e[3]||9==e[3])&&16<=e.length&&5==e[14]&&108===e[15])throw new Error("Unsupported Works 3 for Mac file");if(2==e[2])i.Enum=vs,Cs(e,function(e,t,r){switch(r){case 0:4096<=(i.vers=e)&&(i.qpro=!0);break;case 6:d=e;break;case 204:e&&(a=e);break;case 222:a=e;break;case 15:case 51:i.qpro||(e[1].v=e[1].v.slice(1));case 13:case 14:case 16:14==r&&112==(112&e[2])&&1<(15&e[2])&&(15&e[2])<15&&(e[1].z=i.dateNF||ue[14],i.cellDates)&&(e[1].t="d",e[1].v=At(e[1].v)),i.qpro&&e[3]>l&&(o["!ref"]=we(d),c[s]=o,u.push(s),o=i.dense?[]:{},d={s:{r:0,c:0},e:{r:0,c:0}},l=e[3],s=a||"Sheet"+(l+1),a="");var n=i.dense?(o[e[0].r]||[])[e[0].c]:o[se(e[0])];n?(n.t=e[1].t,n.v=e[1].v,null!=e[1].z&&(n.z=e[1].z),null!=e[1].f&&(n.f=e[1].f)):i.dense?(o[e[0].r]||(o[e[0].r]=[]),o[e[0].r][e[0].c]=e[1]):o[se(e[0])]=e[1]}},i);else{if(26!=e[2]&&14!=e[2])throw new Error("Unrecognized LOTUS BOF "+e[2]);i.Enum=bs,14==e[2]&&(i.qpro=!0,e.l=0),Cs(e,function(e,t,r){switch(r){case 204:s=e;break;case 22:e[1].v=e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:e[3]>l&&(o["!ref"]=we(d),c[s]=o,u.push(s),o=i.dense?[]:{},d={s:{r:0,c:0},e:{r:0,c:0}},l=e[3],s="Sheet"+(l+1)),0<h&&e[0].r>=h||(i.dense?(o[e[0].r]||(o[e[0].r]=[]),o[e[0].r][e[0].c]=e[1]):o[se(e[0])]=e[1],d.e.c<e[0].c&&(d.e.c=e[0].c),d.e.r<e[0].r&&(d.e.r=e[0].r));break;case 27:e[14e3]&&(n[e[14e3][0]]=e[14e3][1]);break;case 1537:n[e[0]]=e[1],e[0]==l&&(s=e[1])}},i)}if(o["!ref"]=we(d),c[a||s]=o,u.push(a||s),!n.length)return{SheetNames:u,Sheets:c};for(var r={},p=[],f=0;f<n.length;++f)c[u[f]]?(p.push(n[f]||u[f]),r[n[f]]=c[n[f]]||c[u[f]]):(p.push(n[f]),r[n[f]]={"!ref":"A1"});return{SheetNames:p,Sheets:r}}function Ts(e,t,r){var n=[{c:0,r:0},{t:"n",v:0},0,0];return r.qpro&&20768!=r.vers?(n[0].c=e._R(1),n[3]=e._R(1),n[0].r=e._R(2),e.l+=2):(n[2]=e._R(1),n[0].c=e._R(2),n[0].r=e._R(2)),n}function Ss(e,t,r){var n,t=e.l+t,i=Ts(e,0,r);return i[1].t="s",20768==r.vers?(e.l++,n=e._R(1),i[1].v=e._R(n,"utf8")):(r.qpro&&e.l++,i[1].v=e._R(t-e.l,"cstr")),i}function _s(e,t,r){var n=32768&t;return(n?"":"$")+(r?be:ve)(t=(n?e:0)+(8192<=(t&=-32769)?t-16384:t))}function xs(e){var t=[{c:0,r:0},{t:"n",v:0},0];return t[0].r=e._R(2),t[3]=e[e.l++],t[0].c=e[e.l++],t}function Rs(e,t){var r,n=xs(e),i=e._R(4),o=e._R(4),e=e._R(2);return 65535==e?0===i&&3221225472===o?(n[1].t="e",n[1].v=15):0===i&&3489660928===o?(n[1].t="e",n[1].v=42):n[1].v=0:(r=32768&e,e=(32767&e)-16446,n[1].v=(1-2*r)*(o*Math.pow(2,32+e)+i*Math.pow(2,e))),n}function As(e,t){var r=xs(e),e=e._R(8,"f");return r[1].v=e,r}function Ns(e,t){return 0==e[e.l+t-1]?e._R(t,"cstr"):""}Os=yr("t"),Is=yr("rPr"),Ms=/<(?:\w+:)?r>/g,ks=/<\/(?:\w+:)?r>/;var Os,Is,Ms,ks,Ds=function(e){return e.replace(Ms,"").split(ks).map(Ps).filter(function(e){return e.v})};function Ps(e){var t=e.match(Os);return t?(t={t:"s",v:fe(t[1])},(e=e.match(Is))&&(t.s=function(e){var t={},r=e.match(qt),n=0,i=!1;if(r)for(;n!=r.length;++n){var o=pe(r[n]);switch(o[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":"1"!=o.val&&(t.cp=M[parseInt(o.val,10)]);break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=o.val;break;case"<sz":t.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting"}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if("0"==o.val)break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if("0"==o.val)break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":o.rgb&&(t.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(47!==o[0].charCodeAt(1)&&!i)throw new Error("Unrecognized rich format "+o[0])}}return t}(e[1])),t):{t:"s",v:""}}Ls=/(\r\n|\n)/g;var Ls,Fs=function(e){return e.map(Hs).join("")};function Hs(e){var t,r,n,i=[[],e.v,[]];return e.v?(e.s&&(e=e.s,t=i[0],r=i[2],n=[],e.u&&n.push("text-decoration: underline;"),e.uval&&n.push("text-underline-style:"+e.uval+";"),e.sz&&n.push("font-size:"+e.sz+"pt;"),e.outline&&n.push("text-effect: outline;"),e.shadow&&n.push("text-shadow: auto;"),t.push('<span style="'+n.join("")+'">'),e.b&&(t.push("<b>"),r.push("</b>")),e.i&&(t.push("<i>"),r.push("</i>")),e.strike&&(t.push("<s>"),r.push("</s>")),"superscript"==(n=e.valign||"")||"super"==n?n="sup":"subscript"==n&&(n="sub"),""!=n&&(t.push("<"+n+">"),r.push("</"+n+">")),r.push("</span>")),i[0].join("")+i[1].replace(Ls,"<br/>")+i[2].join("")):""}var Us=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Vs=/<(?:\w+:)?r>/,Ws=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function $s(e,t){var t=!t||t.cellHTML,r={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=fe(me(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=me(e),t&&(r.h=sr(r.t))):e.match(Vs)&&(r.r=me(e),r.t=fe(me((e.replace(Ws,"").match(Us)||[]).join("").replace(qt,""))),t)&&(r.h=Fs(Ds(r.r))),r):{t:""}}var Bs=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,js=/<(?:\w+:)?(?:si|sstItem)>/g,zs=/<\/(?:\w+:)?(?:si|sstItem)>/;var Ys=/^\s|\s$|[\t\n\r]/;function Gs(e,t){if(!t.bookSST)return"";var r=[C];r[r.length]=T("sst",null,{xmlns:Or[0],count:e.Count,uniqueCount:e.Unique});for(var n,i,o=0;o!=e.length;++o)null!=e[o]&&(i="<si>",(n=e[o]).r?i+=n.r:(i+="<t",n.t||(n.t=""),n.t.match(Ys)&&(i+=' xml:space="preserve"'),i+=">"+E(n.t)+"</t>"),r[r.length]=i+="</si>");return 2<r.length&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}var qs=function(e,t){var r=!1;return null==t&&(r=!0,t=ye(15+4*e.t.length)),t._W(1,0),On(e.t,t),r?t.slice(0,t.l):t};function Ks(e){var t,r,n=gn();N(n,159,(t=e,(r=r||ye(8))._W(4,t.Count),r._W(4,t.Unique),r));for(var i=0;i<e.length;++i)N(n,19,qs(e[i]));return N(n,160),n.end()}function Xs(e){if(void 0!==ae)return ae.utils.encode(_,e);for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Js(e,t){var r={};return r.Major=e._R(2),r.Minor=e._R(2),4<=t&&(e.l+=t-4),r}function Zs(e){for(var t=[],r=(e.l+=4,e._R(4));0<r--;)t.push(function(e){for(var t=e._R(4),t=e.l+t-4,r={},n=e._R(4),i=[];0<n--;)i.push({t:e._R(4),v:e._R(0,"lpp4")});if(r.name=e._R(0,"lpp4"),r.comps=i,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return r}(e));return t}function Qs(e){t={},(r=e)._R(4),r.l+=4,t.id=r._R(0,"lpp4"),t.name=r._R(0,"lpp4"),t.R=Js(r,4),t.U=Js(r,4),t.W=Js(r,4);var t,r=t;if(r.ename=e._R(0,"8lpp4"),r.blksz=e._R(4),r.cmode=e._R(4),4!=e._R(4))throw new Error("Bad !Primary record")}function ea(e,t){var t=e.l+t,r={},n=(r.Flags=63&e._R(4),e.l+=4,r.AlgID=e._R(4),!1);switch(r.AlgID){case 26126:case 26127:case 26128:n=36==r.Flags;break;case 26625:n=4==r.Flags;break;case 0:n=16==r.Flags||4==r.Flags||36==r.Flags;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(n)return r.AlgIDHash=e._R(4),r.KeySize=e._R(4),r.ProviderType=e._R(4),e.l+=8,r.CSPName=e._R(t-e.l>>1,"utf16le"),e.l=t,r;throw new Error("Encryption Flags/AlgID mismatch")}function ta(e,t){var r={},t=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e._R(4),r.VerifierHash=e.slice(e.l,t),e.l=t,r}function ra(e){var t,r,n,i=Js(e);switch(i.Minor){case 2:return[i.Minor,function(e){if(36!=(63&e._R(4)))throw new Error("EncryptionInfo mismatch");var t=e._R(4),t=ea(e,t),e=ta(e,e.length-e.l);return{t:"Std",h:t,v:e}}(e)];case 3:return[i.Minor,function(){throw new Error("File is password-protected: ECMA-376 Extensible")}()];case 4:return[i.Minor,(r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"],(t=e).l+=4,t=t._R(t.length-t.l,"utf8"),n={},t.replace(qt,function(e){var t=pe(e);switch(Jt(t[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach(function(e){n[e]=t[e]});break;case"<dataIntegrity":n.encryptedHmacKey=t.encryptedHmacKey,n.encryptedHmacValue=t.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=t.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(t);break;default:throw t[0]}}),n)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+i.Minor)}function na(e){var t,r=0,n=Xs(e),i=n.length+1,o=B(i);for(o[0]=n.length,t=1;t!=i;++t)o[t]=n[t-1];for(t=i-1;0<=t;--t)r=((0==(16384&r)?0:1)|r<<1&32767)^o[t];return 52811^r}ia=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],oa=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],sa=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],aa=function(e){return 255&(e/2|128*e)};var ia,oa,sa,aa,la=function(e){for(var t,r=Xs(e),n=function(e){for(var t=oa[e.length-1],r=104,n=e.length-1;0<=n;--n)for(var i=e[n],o=0;7!=o;++o)64&i&&(t^=sa[r]),i*=2,--r;return t}(r),i=r.length,o=B(16),s=0;16!=s;++s)o[s]=0;for(1==(1&i)&&(o[i]=ca(ia[0],n>>8),e=r[r.length-1],o[--i]=ca(e,255&n));0<i;)o[--i]=ca(r[i],n>>8),o[--i]=ca(r[i],255&n);for(t=(i=15)-r.length;0<t;)o[i]=ca(ia[t],n>>8),--t,o[--i]=ca(r[i],255&n),--i,--t;return o};function ca(e,t){return aa(e^t)}var ua=function(e){var t=0,r=la(e);return function(e){e=function(e,t,r,n,i){var o,s;for(i=i||t,n=n||la(e),o=0;o!=t.length;++o)s=t[o],s^=n[r],i[o]=255&(s>>5|s<<3),++r;return[i,r,n]}("",e,t,r);return t=e[1],e[0]}};function da(e,t,r){r=r||{};r.Info=e._R(2),e.l-=2,1===r.Info?r.Data=function(e){var t={},r=t.EncryptionVersionInfo=Js(e,4);if(1!=r.Major||1!=r.Minor)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e._R(16),t.EncryptedVerifier=e._R(16),t.EncryptedVerifierHash=e._R(16),t}(e):r.Data=function(e,t){var r={},n=r.EncryptionVersionInfo=Js(e,4);if(t-=4,2!=n.Minor)throw new Error("unrecognized minor version code: "+n.Minor);if(4<n.Major||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);return r.Flags=e._R(4),t-=4,n=e._R(4),t-=4,r.EncryptionHeader=ea(e,n),r.EncryptionVerifier=ta(e,t-=n),r}(e,t)}var ha={to_workbook:function(e,t){return _n(pa(e,t),t)},to_sheet:pa,from_sheet:function(e){for(var t=["{\\rtf1\\ansi"],r=Ce(e["!ref"]),n=Array.isArray(e),i=r.s.r;i<=r.e.r;++i){t.push("\\trowd\\trautofit1");for(var o=r.s.c;o<=r.e.c;++o)t.push("\\cellx"+(o+1));for(t.push("\\pard\\intbl"),o=r.s.c;o<=r.e.c;++o){var s=se({r:i,c:o});(s=n?(e[i]||[])[o]:e[s])&&(null!=s.v||s.f&&!s.F)&&(t.push(" "+(s.w||(Sn(s),s.w))),t.push("\\cell"))}t.push("\\pard\\intbl\\row")}return t.join("")+"}"}};function pa(e,t){switch(t.type){case"base64":return fa(_e(e),t);case"binary":return fa(e,t);case"buffer":return fa(ce&&Buffer.isBuffer(e)?e.toString("binary"):p(e),t);case"array":return fa(Mt(e),t)}throw new Error("Unrecognized type "+t.type)}function fa(e,t){var s,a=(t||{}).dense?[]:{},t=e.match(/\\trowd.*?\\row\b/g);if(t.length)return s={s:{c:0,r:0},e:{c:0,r:t.length-1}},t.forEach(function(e,t){Array.isArray(a)&&(a[t]=[]);for(var r,n=/\\\w+\b/g,i=0,o=-1;r=n.exec(e);)"\\cell"===r[0]&&(++o,(r=" "==(r=e.slice(i,n.lastIndex-r[0].length))[0]?r.slice(1):r).length)&&(r={v:r,t:"s"},Array.isArray(a)?a[t][o]=r:a[se({r:t,c:o})]=r),i=n.lastIndex;o>s.e.c&&(s.e.c=o)}),a["!ref"]=we(s),a;throw new Error("RTF missing table")}function ga(e){for(var t=0,r=1;3!=t;++t)r=256*r+(255<e[t]?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function ma(e,t){return 0===t?e:((e=function(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,e=Math.max(t,r,n),i=Math.min(t,r,n),o=e-i;if(0==o)return[0,0,t];var s=0,a=o/(1<(i=e+i)?2-i:i);switch(e){case t:s=((r-n)/o+6)%6;break;case r:s=(n-t)/o+2;break;case n:s=(t-r)/o+4}return[s/6,a,i/2]}((e=(e=e).slice("#"===e[0]?1:0).slice(0,6),[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)])))[2]=t<0?e[2]*(1+t):1-(1-e[2])*(1-t),ga(function(e){var t,r=e[0],n=e[1],e=e[2],i=2*n*(e<.5?e:1-e),o=[e=e-i/2,e,e],s=6*r;if(0!==n)switch(0|s){case 0:case 6:t=i*s,o[0]+=i,o[1]+=t;break;case 1:o[0]+=t=i*(2-s),o[1]+=i;break;case 2:t=i*(s-2),o[1]+=i,o[2]+=t;break;case 3:o[1]+=t=i*(4-s),o[2]+=i;break;case 4:t=i*(s-4),o[2]+=i,o[0]+=t;break;case 5:o[2]+=t=i*(6-s),o[0]+=i}for(var a=0;3!=a;++a)o[a]=Math.round(255*o[a]);return o}(e)))}var ya=6,va=15,ba=1,wa=ya;function Ca(e){return Math.floor((e+Math.round(128/wa)/256)*wa)}function Ea(e){return Math.floor((e-5)/wa*100+.5)/100}function Ta(e){return Math.round((e*wa+5)/wa*256)/256}function Sa(e){return Ta(Ea(Ca(e)))}function _a(e){var t=Math.abs(e-Sa(e)),r=wa;if(.005<t)for(wa=ba;wa<va;++wa)Math.abs(e-Sa(e))<=t&&(t=Math.abs(e-Sa(e)),r=wa);wa=r}function xa(e){e.width?(e.wpx=Ca(e.width),e.wch=Ea(e.wpx),e.MDW=wa):e.wpx?(e.wch=Ea(e.wpx),e.width=Ta(e.wch),e.MDW=wa):"number"==typeof e.wch&&(e.width=Ta(e.wch),e.wpx=Ca(e.width),e.MDW=wa),e.customWidth&&delete e.customWidth}var Ra=96;function Aa(e){return 96*e/Ra}function Na(e){return e*Ra/96}var Oa={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};var Ia=["numFmtId","fillId","fontId","borderId","xfId"],Ma=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];ka=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,Da=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,Pa=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,La=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,Fa=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;var ka,Da,Pa,La,Fa,Ha=function(e,t,r){var n,i,o,s,a,l,c,u,d,h,p,f,g,m,y,v,b,w,C={};if(e){if(n=(e=e.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(ka)){var E=n,T=C,S=r;T.NumberFmt=[];for(var _=oe(ue),x=0;x<_.length;++x)T.NumberFmt[_[x]]=ue[_[x]];var R=E[0].match(qt);if(R)for(x=0;x<R.length;++x){var A=pe(R[x]);switch(Jt(A[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":var N=fe(me(A.formatCode)),O=parseInt(A.numFmtId,10);if(T.NumberFmt[O]=N,0<O){if(392<O){for(O=392;60<O&&null!=T.NumberFmt[O];--O);T.NumberFmt[O]=N}Ke(N,O)}break;case"</numFmt>":break;default:if(S.WTF)throw new Error("unrecognized "+A[0]+" in numFmts")}}}(n=e.match(La))&&(E=n,o=t,s=r,(i=C).Fonts=[],l=!(a={}),(E[0].match(qt)||[]).forEach(function(e){var t,r=pe(e);switch(Jt(r[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":i.Fonts.push(a),a={};break;case"<name":r.val&&(a.name=me(r.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=r.val?ge(r.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=r.val?ge(r.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(r.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=r.val?ge(r.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=r.val?ge(r.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=r.val?ge(r.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=r.val?ge(r.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=r.val?ge(r.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":r.val&&(a.sz=+r.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":r.val&&(a.vertAlign=r.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":r.val&&(a.family=parseInt(r.val,10));break;case"<family/>":case"</family>":break;case"<scheme":r.val&&(a.scheme=r.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":"1"!=r.val&&(r.codepage=M[parseInt(r.val,10)]);break;case"<color":a.color||(a.color={}),r.auto&&(a.color.auto=ge(r.auto)),r.rgb?a.color.rgb=r.rgb.slice(-6):r.indexed?(a.color.index=parseInt(r.indexed,10),t=oi[a.color.index],t=(t=81==a.color.index?oi[1]:t)||oi[1],a.color.rgb=t[0].toString(16)+t[1].toString(16)+t[2].toString(16)):r.theme&&(a.color.theme=parseInt(r.theme,10),r.tint&&(a.color.tint=parseFloat(r.tint)),r.theme)&&o.themeElements&&o.themeElements.clrScheme&&(a.color.rgb=ma(o.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0));break;case"<color/>":case"</color>":break;case"<AlternateContent":l=!0;break;case"</AlternateContent>":l=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(s&&s.WTF&&!l)throw new Error("unrecognized "+r[0]+" in fonts")}})),(n=e.match(Pa))&&(t=n,u=r,(c=C).Fills=[],h=!(d={}),(t[0].match(qt)||[]).forEach(function(e){var t=pe(e);switch(Jt(t[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":d={},c.Fills.push(d);break;case"</fill>":case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":c.Fills.push(d),d={};break;case"<patternFill":case"<patternFill>":t.patternType&&(d.patternType=t.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":d.bgColor||(d.bgColor={}),t.indexed&&(d.bgColor.indexed=parseInt(t.indexed,10)),t.theme&&(d.bgColor.theme=parseInt(t.theme,10)),t.tint&&(d.bgColor.tint=parseFloat(t.tint)),t.rgb&&(d.bgColor.rgb=t.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":d.fgColor||(d.fgColor={}),t.theme&&(d.fgColor.theme=parseInt(t.theme,10)),t.tint&&(d.fgColor.tint=parseFloat(t.tint)),null!=t.rgb&&(d.fgColor.rgb=t.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":case"</stop>":break;case"<color":case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":h=!0;break;case"</ext>":h=!1;break;default:if(u&&u.WTF&&!h)throw new Error("unrecognized "+t[0]+" in fills")}})),(n=e.match(Fa))&&(t=n,f=r,(p=C).Borders=[],m=!(g={}),(t[0].match(qt)||[]).forEach(function(e){var t=pe(e);switch(Jt(t[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":g={},t.diagonalUp&&(g.diagonalUp=ge(t.diagonalUp)),t.diagonalDown&&(g.diagonalDown=ge(t.diagonalDown)),p.Borders.push(g);break;case"</border>":case"<left/>":break;case"<left":case"<left>":case"</left>":case"<right/>":break;case"<right":case"<right>":case"</right>":case"<top/>":break;case"<top":case"<top>":case"</top>":case"<bottom/>":break;case"<bottom":case"<bottom>":case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":break;case"<start":case"<start>":case"<start/>":case"</start>":break;case"<end":case"<end>":case"<end/>":case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":m=!0;break;case"</ext>":m=!1;break;default:if(f&&f.WTF&&!m)throw new Error("unrecognized "+t[0]+" in borders")}})),(n=e.match(Da))&&(t=n,v=r,w=!((y=C).CellXf=[]),(t[0].match(qt)||[]).forEach(function(e){var t=pe(e),r=0;switch(Jt(t[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(delete(b=t)[0],r=0;r<Ia.length;++r)b[Ia[r]]&&(b[Ia[r]]=parseInt(b[Ia[r]],10));for(r=0;r<Ma.length;++r)b[Ma[r]]&&(b[Ma[r]]=ge(b[Ma[r]]));if(y.NumberFmt&&392<b.numFmtId)for(r=392;60<r;--r)if(y.NumberFmt[b.numFmtId]==y.NumberFmt[r]){b.numFmtId=r;break}y.CellXf.push(b);break;case"</xf>":break;case"<alignment":case"<alignment/>":var n={};t.vertical&&(n.vertical=t.vertical),t.horizontal&&(n.horizontal=t.horizontal),null!=t.textRotation&&(n.textRotation=t.textRotation),t.indent&&(n.indent=t.indent),t.wrapText&&(n.wrapText=ge(t.wrapText)),b.alignment=n;break;case"</alignment>":case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":w=!0;break;case"</AlternateContent>":w=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":w=!0;break;case"</ext>":w=!1;break;default:if(v&&v.WTF&&!w)throw new Error("unrecognized "+t[0]+" in cellXfs")}}))}return C};function Ua(e,t){var r,n,i,o,s=[C,T("styleSheet",null,{xmlns:Or[0],"xmlns:vt":Nr.vt})];return e.SSF&&null!=(n=e.SSF,i=["<numFmts>"],[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var t=e[0];t<=e[1];++t)null!=n[t]&&(i[i.length]=T("numFmt",null,{numFmtId:t,formatCode:E(n[t])}))}),r=1===i.length?"":(i[i.length]="</numFmts>",i[0]=T("numFmts",null,{count:i.length-2}).replace("/>",">"),i.join("")))&&(s[s.length]=r),s[s.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',s[s.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',s[s.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',s[s.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',e=t.cellXfs,(o=[])[o.length]="<cellXfs/>",e.forEach(function(e){o[o.length]=T("xf",null,e)}),o[o.length]="</cellXfs>",(r=2===o.length?"":(o[0]=T("cellXfs",null,{count:o.length-2}).replace("/>",">"),o.join("")))&&(s[s.length]=r),s[s.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',s[s.length]='<dxfs count="0"/>',s[s.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',2<s.length&&(s[s.length]="</styleSheet>",s[1]=s[1].replace("/>",">")),s.join("")}function Va(e,t){(t=t||ye(153))._W(2,20*e.sz),r=e,n=(n=t)||ye(2),r=(r.italic?2:0)|(r.strike?8:0)|(r.outline?16:0)|(r.shadow?32:0)|(r.condense?64:0)|(r.extend?128:0),n._W(1,r),n._W(1,0),t._W(2,e.bold?700:400);var r=0,n=("superscript"==e.vertAlign?r=1:"subscript"==e.vertAlign&&(r=2),t._W(2,r),t._W(1,e.underline||0),t._W(1,e.family||0),t._W(1,e.charset||0),t._W(1,0),Jn(e.color,t),0);return"major"==e.scheme&&(n=1),"minor"==e.scheme&&(n=2),t._W(1,n),On(e.name,t),t.length>t.l?t.slice(0,t.l):t}var Wa,$a=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Ba=pn;function ja(e,t){t=t||ye(84);var e=(Wa=Wa||Et($a))[e.patternType],r=(t._W(4,e=null==e?40:e),0);if(40!=e)for(Jn({auto:1},t),Jn({auto:1},t);r<12;++r)t._W(4,0);else{for(;r<4;++r)t._W(4,0);for(;r<12;++r)t._W(4,0)}return t.length>t.l?t.slice(0,t.l):t}function za(e,t,r){(r=r||ye(16))._W(2,t||0),r._W(2,e.numFmtId||0),r._W(2,0),r._W(2,0),r._W(2,0),r._W(1,0),r._W(1,0);return r._W(1,0),r._W(1,0),r._W(1,0),r._W(1,0),r}function Ya(e,t){(t=t||ye(10))._W(1,0),t._W(1,0),t._W(4,0),t._W(4,0)}var Ga=pn;function qa(o,s){var r;s&&(r=0,[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var t=e[0];t<=e[1];++t)null!=s[t]&&++r}),0!=r)&&(N(o,615,An(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var t,r,n,i=e[0];i<=e[1];++i)null!=s[i]&&N(o,44,(r=s[t=i],(n=(n=void 0)||ye(6+4*r.length))._W(2,t),On(r,n),t=n.length>n.l?n.slice(0,n.l):n,null==n.l&&(n.l=n.length),t))}),N(o,616))}function Ka(e){var t;N(e,613,An(1)),N(e,46,((t=t||ye(51))._W(1,0),Ya(0,t),Ya(0,t),Ya(0,t),Ya(0,t),Ya(0,t),t.length>t.l?t.slice(0,t.l):t)),N(e,614)}function Xa(e){var t,r;N(e,619,An(1)),N(e,48,(t={xfId:0,builtinId:0,name:"Normal"},(r=r||ye(52))._W(4,t.xfId),r._W(2,1),r._W(1,+t.builtinId),r._W(1,0),Vn(t.name||"",r),r.length>r.l?r.slice(0,r.l):r)),N(e,620)}function Ja(e){var t,r,n,i;N(e,508,(t=0,r="TableStyleMedium9",n="PivotStyleMedium4",(i=ye(2052))._W(4,t),Vn(r,i),Vn(n,i),i.length>i.l?i.slice(0,i.l):i)),N(e,509)}function Za(e,t){var r,n=gn();return N(n,278),qa(n,e.SSF),N(e=n,611,An(1)),N(e,43,Va({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),N(e,612),N(e=n,603,An(2)),N(e,45,ja({patternType:"none"})),N(e,45,ja({patternType:"gray125"})),N(e,604),Ka(n),N(e=n,626,An(1)),N(e,47,za({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),N(e,627),r=n,e=t.cellXfs,N(r,617,An(e.length)),e.forEach(function(e){N(r,47,za(e,0))}),N(r,618),Xa(n),N(t=n,505,An(0)),N(t,506),Ja(n),N(n,279),n.end()}var Qa=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function el(e,r,n){r.themeElements.clrScheme=[];var i={};(e[0].match(qt)||[]).forEach(function(e){var t=pe(e);switch(t[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":i.rgb=t.val;break;case"<a:sysClr":i.rgb=t.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===t[0].charAt(1)?(r.themeElements.clrScheme[Qa.indexOf(t[0])]=i,i={}):i.name=t[0].slice(3,t[0].length-1);break;default:if(n&&n.WTF)throw new Error("Unrecognized "+t[0]+" in clrScheme")}})}function tl(){}function rl(){}var nl=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,il=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,ol=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;var sl=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function al(e,t){e&&0!==e.length||(e=ll());var r,n,i,o,s,a={};if(r=e.match(sl))return n=r[0],o=t,(i=a).themeElements={},[["clrScheme",nl,el],["fontScheme",il,tl],["fmtScheme",ol,rl]].forEach(function(e){if(!(s=n.match(e[1])))throw new Error(e[0]+" not found in themeElements");e[2](s,i,o)}),a.raw=e,a;throw new Error("themeElements not found in theme")}function ll(e,t){return t&&t.themeXLSX?t.themeXLSX:e&&"string"==typeof e.raw?e.raw:((t=[C])[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join(""))}function cl(e){var t={};switch(t.xclrType=e._R(2),t.nTintShade=e._R(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=pn(e,4);break;case 2:t.xclrValue=oo(e);break;case 3:t.xclrValue=e._R(4);break;case 4:e.l+=4}return e.l+=8,t}function ul(e){var t=e._R(2),r=e._R(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=cl(e);break;case 6:n[1]=pn(e,r);break;case 14:case 15:n[1]=e._R(1==r?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function dl(){var e,t,r,n=gn();return N(n,332),N(n,334,An(1)),N(n,335,((t=ye(12+2*(e={name:"XLDAPR",version:12e4,flags:3496657072}).name.length))._W(4,e.flags),t._W(4,e.version),On(e.name,t),t.slice(0,t.l))),N(n,336),N(n,339,(e=1,(r=ye(8+2*(t="XLDAPR").length))._W(4,e),On(t,r),r.slice(0,r.l))),N(n,52),N(n,35,An(514)),N(n,4096,An(0)),N(n,4097,qi(1)),N(n,36),N(n,53),N(n,340),N(n,337,(e=1,t=!0,(r=ye(8))._W(4,e),r._W(4,t?1:0),r)),N(n,51,function(e){var t=ye(4+8*e.length);t._W(4,e.length);for(var r=0;r<e.length;++r)t._W(4,e[r][0]),t._W(4,e[r][1]);return t}([[1,0]])),N(n,338),N(n,333),n.end()}function hl(){var e=[C];return e.push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>'),e.join("")}var pl=1024;function fl(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[T("xml",null,{"xmlns:v":Ir.v,"xmlns:o":Ir.o,"xmlns:x":Ir.x,"xmlns:mv":Ir.mv}).replace(/\/>/,">"),T("o:shapelayout",T("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),T("v:shapetype",[T("v:stroke",null,{joinstyle:"miter"}),T("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];pl<1e3*e;)pl+=1e3;return t.forEach(function(e){var t=W(e[0]),r={color2:"#BEFF82",type:"gradient"},n=("gradient"==r.type&&(r.angle="-180"),"gradient"==r.type?T("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null),n=T("v:fill",n,r);++pl,i=i.concat(["<v:shape"+_r({id:"_x0000_s"+pl,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",n,T("v:shadow",null,{on:"t",obscured:"t"}),T("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Sr("x:Anchor",[t.c+1,0,t.r+1,0,t.c+3,20,t.r+5,20].join(",")),Sr("x:AutoFill","False"),Sr("x:Row",String(t.r)),Sr("x:Column",String(t.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function gl(o,e,s,a){var l,c=Array.isArray(o);e.forEach(function(e){var t,r=W(e.ref),n=((l=c?(o[r.r]||(o[r.r]=[]),o[r.r][r.c]):o[e.ref])||(l={t:"z"},c?o[r.r][r.c]=l:o[e.ref]=l,(t=Ce(o["!ref"]||"BDWGO1000001:A1")).s.r>r.r&&(t.s.r=r.r),t.e.r<r.r&&(t.e.r=r.r),t.s.c>r.c&&(t.s.c=r.c),t.e.c<r.c&&(t.e.c=r.c),(r=we(t))!==o["!ref"]&&(o["!ref"]=r)),l.c||(l.c=[]),{a:e.author,t:e.t,r:e.r,T:s});e.h&&(n.h=e.h);for(var i=l.c.length-1;0<=i;--i){if(!s&&l.c[i].T)return;s&&!l.c[i].T&&l.c.splice(i,1)}if(s&&a)for(i=0;i<a.length;++i)if(n.a==a[i].id){n.a=a[i].name||n.a;break}l.c.push(n)})}function ml(e){var o=[C,T("comments",null,{xmlns:Or[0]})],s=[];return o.push("<authors>"),e.forEach(function(e){e[1].forEach(function(e){var t=E(e.a);-1==s.indexOf(t)&&(s.push(t),o.push("<author>"+t+"</author>")),e.T&&e.ID&&-1==s.indexOf("tc="+e.ID)&&(s.push("tc="+e.ID),o.push("<author>tc="+e.ID+"</author>"))})}),0==s.length&&(s.push("SheetJ5"),o.push("<author>SheetJ5</author>")),o.push("</authors>"),o.push("<commentList>"),e.forEach(function(e){var t=0,r=[];if(e[1][0]&&e[1][0].T&&e[1][0].ID?t=s.indexOf("tc="+e[1][0].ID):e[1].forEach(function(e){e.a&&(t=s.indexOf(E(e.a))),r.push(e.t||"")}),o.push('<comment ref="'+e[0]+'" authorId="'+t+'"><text>'),r.length<=1)o.push(Sr("t",E(r[0]||"")));else{for(var n="Comment:\n    "+r[0]+"\n",i=1;i<r.length;++i)n+="Reply:\n    "+r[i]+"\n";o.push(Sr("t",E(n)))}o.push("</text></comment>")}),o.push("</commentList>"),2<o.length&&(o[o.length]="</comments>",o[1]=o[1].replace("/>",">")),o.join("")}var yl=Nn;function vl(e){var i=gn(),o=[];return N(i,628),N(i,630),e.forEach(function(e){e[1].forEach(function(e){-1<o.indexOf(e.a)||(o.push(e.a.slice(0,54)),N(i,632,On(e.a.slice(0,54))))})}),N(i,631),N(i,633),e.forEach(function(n){n[1].forEach(function(e){e.iauthor=o.indexOf(e.a);var t,r={s:W(n[0]),e:W(n[0])};N(i,635,(r=[r,e],(t=null==t?ye(36):t)._W(4,r[1].iauthor),qn(r[0],t),t._W(4,0),t._W(4,0),t._W(4,0),t._W(4,0),t)),e.t&&0<e.t.length&&N(i,637,Mn(e)),N(i,636),delete e.iauthor})}),N(i,634),N(i,629),i.end()}var bl="application/vnd.ms-office.vbaProject";var wl=["xlsb","xlsm","xlam","biff8","xla"];Cl=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,El={r:0,c:0};var Cl,El,Tl=function(e,t){return El=t,e.replace(Cl,Sl)};function Sl(e,t,r,n){var i=!1,o=!1,r=(0==r.length?o=!0:"["==r.charAt(0)&&(o=!0,r=r.slice(1,-1)),0==n.length?i=!0:"["==n.charAt(0)&&(i=!0,n=n.slice(1,-1)),0<r.length?0|parseInt(r,10):0),n=0<n.length?0|parseInt(n,10):0;return i?n+=El.c:--n,o?r+=El.r:--r,t+(i?"":"$")+be(n)+(o?"":"$")+ve(r)}var _l=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,xl=function(e,s){return e.replace(_l,function(e,t,r,n,i,o){n=Cn(n)-(r?0:s.c),o=wn(o)-(i?0:s.r);return t+"R"+(0==o?"":i?1+o:"["+o+"]")+"C"+(0==n?"":r?1+n:"["+n+"]")})};function Rl(e,s){return e.replace(_l,function(e,t,r,n,i,o){return t+("$"==r?r+n:be(Cn(n)+s.c))+("$"==i?i+o:ve(wn(o)+s.r))})}function Al(e){return e.replace(/_xlfn\./g,"")}function t(e){e.l+=1}function Nl(e,t){e=e._R(1==t?1:2);return[16383&e,e>>14&1,e>>15&1]}function Ol(e,t,r){var n=2;if(r){if(2<=r.biff&&r.biff<=5)return Il(e);12==r.biff&&(n=4)}var r=e._R(n),n=e._R(n),i=Nl(e,2),e=Nl(e,2);return{s:{r:r,c:i[0],cRel:i[1],rRel:i[2]},e:{r:n,c:e[0],cRel:e[1],rRel:e[2]}}}function Il(e){var t=Nl(e,2),r=Nl(e,2),n=e._R(1),e=e._R(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:e,cRel:r[1],rRel:r[2]}}}function Ml(e,t,r){var n,i;return r&&2<=r.biff&&r.biff<=5?(n=Nl(i=e,2),i=i._R(1),{r:n[0],c:i,cRel:n[1],rRel:n[2]}):{r:e._R(r&&12==r.biff?4:2),c:(i=Nl(e,2))[0],cRel:i[1],rRel:i[2]}}function kl(e){var t=1&e[e.l+1];return e.l+=4,[t,1]}function Dl(e){return[e._R(1),e._R(1)]}function Pl(e,t,r){var n=0,i=0;12==r.biff?(n=e._R(4),i=e._R(4)):(i=1+e._R(1),n=1+e._R(2)),2<=r.biff&&r.biff<8&&(--n,0==--i)&&(i=256);for(var o=0,s=[];o!=n&&(s[o]=[]);++o)for(var a=0;a!=i;++a)s[o][a]=function(e,t){var r=[e._R(1)];if(12==t)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2}switch(r[0]){case 4:r[1]=y(e,1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:r[1]=si[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Kn(e);break;case 2:r[1]=eo(e,0,{biff:0<t&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}(e,r.biff);return s}function Ll(e,t,r){return e.l+=2,[(n=(e=e)._R(2),e=e._R(2),{r:n,c:255&e,fQuoted:!!(16384&e),cRel:e>>15,rRel:e>>15})];var n}function Fl(e){return e.l+=6,[]}function Hl(e){return e.l+=2,[d(e),1&e._R(2)]}var Ul=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];var Vl={1:{n:"PtgExp",f:function(e,t,r){return e.l++,r&&12==r.biff?[e._R(4,"i"),0]:[e._R(2),e._R(r&&2==r.biff?1:2)]}},2:{n:"PtgTbl",f:pn},3:{n:"PtgAdd",f:t},4:{n:"PtgSub",f:t},5:{n:"PtgMul",f:t},6:{n:"PtgDiv",f:t},7:{n:"PtgPower",f:t},8:{n:"PtgConcat",f:t},9:{n:"PtgLt",f:t},10:{n:"PtgLe",f:t},11:{n:"PtgEq",f:t},12:{n:"PtgGe",f:t},13:{n:"PtgGt",f:t},14:{n:"PtgNe",f:t},15:{n:"PtgIsect",f:t},16:{n:"PtgUnion",f:t},17:{n:"PtgRange",f:t},18:{n:"PtgUplus",f:t},19:{n:"PtgUminus",f:t},20:{n:"PtgPercent",f:t},21:{n:"PtgParen",f:t},22:{n:"PtgMissArg",f:t},23:{n:"PtgStr",f:function(e,t,r){return e.l++,Ji(e,0,r)}},26:{n:"PtgSheet",f:function(e,t,r){return e.l+=5,e.l+=2,e.l+=2==r.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,t,r){return e.l+=2==r.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,si[e._R(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e._R(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e._R(2)}},31:{n:"PtgNum",f:function(e){return e.l++,Kn(e)}},32:{n:"PtgArray",f:function(e,t,r){var n=(96&e[e.l++])>>5;return e.l+=2==r.biff?6:12==r.biff?14:7,[n]}},33:{n:"PtgFunc",f:function(e,t,r){var n=(96&e[e.l])>>5,e=(e.l+=1,e._R(r&&r.biff<=3?1:2));return[oc[e],ic[e],n]}},34:{n:"PtgFuncVar",f:function(e,t,r){var n=e[e.l++],i=e._R(1),r=r&&r.biff<=3?[88==n?-1:0,e._R(1)]:[e[e.l+1]>>7,32767&e._R(2)];return[i,(0===r[0]?ic:nc)[r[1]]]}},35:{n:"PtgName",f:function(e,t,r){var n=e._R(1)>>>5&3,i=!r||8<=r.biff?4:2,i=e._R(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[n,0,i]}},36:{n:"PtgRef",f:function(e,t,r){var n=(96&e[e.l])>>5;return e.l+=1,[n,Ml(e,0,r)]}},37:{n:"PtgArea",f:function(e,t,r){return[(96&e[e.l++])>>5,Ol(e,2<=r.biff&&r.biff,r)]}},38:{n:"PtgMemArea",f:function(e,t,r){var n=e._R(1)>>>5&3;return e.l+=r&&2==r.biff?3:4,[n,e._R(r&&2==r.biff?1:2)]}},39:{n:"PtgMemErr",f:pn},40:{n:"PtgMemNoMem",f:pn},41:{n:"PtgMemFunc",f:function(e,t,r){return[e._R(1)>>>5&3,e._R(r&&2==r.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,t,r){var n=e._R(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,12==r.biff&&(e.l+=2),[n]}},43:{n:"PtgAreaErr",f:function(e,t,r){var n=(96&e[e.l++])>>5;return e.l+=r&&8<r.biff?12:r.biff<8?6:8,[n]}},44:{n:"PtgRefN",f:function(e,t,r){var n=(96&e[e.l])>>5;return e.l+=1,[n,function(e,t){var r,n;if(2<=(t=t&&t.biff?t.biff:8)&&t<=5)return s=(a=e)._R(2),a=a._R(1),r=(32768&s)>>15,n=(16384&s)>>14,s&=16383,1==r&&8192<=s&&(s-=16384),1==n&&128<=a&&(a-=256),{r:s,c:a,cRel:n,rRel:r};var i=e._R(12<=t?4:2),o=e._R(2),s=(16384&o)>>14,a=(32768&o)>>15;if(o&=16383,1==a)for(;524287<i;)i-=1048576;if(1==s)for(;8191<o;)o-=16384;return{r:i,c:o,cRel:s,rRel:a}}(e,r)]}},45:{n:"PtgAreaN",f:function(e,t,r){var n,i=(96&e[e.l++])>>5;return e=e,[i,(i=r).biff<8?Il(e):(r=e._R(12==i.biff?4:2),i=e._R(12==i.biff?4:2),n=Nl(e,2),e=Nl(e,2),{s:{r:r,c:n[0],cRel:n[1],rRel:n[2]},e:{r:i,c:e[0],cRel:e[1],rRel:e[2]}})]}},46:{n:"PtgMemAreaN",f:function(e){return[e._R(1)>>>5&3,e._R(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e._R(1)>>>5&3,e._R(2)]}},57:{n:"PtgNameX",f:function(e,t,r){var n,i,o;return 5==r.biff?(n=(r=e)._R(1)>>>5&3,i=r._R(2,"i"),r.l+=8,o=r._R(2),r.l+=12,[n,i,o]):[e._R(1)>>>5&3,e._R(2),e._R(4)]}},58:{n:"PtgRef3d",f:function(e,t,r){var n=(96&e[e.l])>>5,i=(e.l+=1,e._R(2));return r&&5==r.biff&&(e.l+=12),[n,i,Ml(e,0,r)]}},59:{n:"PtgArea3d",f:function(e,t,r){var n=(96&e[e.l++])>>5,i=e._R(2,"i");if(r)switch(r.biff){case 5:e.l+=12,0;break;case 12:0}return[n,i,Ol(e,0,r)]}},60:{n:"PtgRefErr3d",f:function(e,t,r){var n=(96&e[e.l++])>>5,i=e._R(2),o=4;if(r)switch(r.biff){case 5:o=15;break;case 12:o=6}return e.l+=o,[n,i]}},61:{n:"PtgAreaErr3d",f:function(e,t,r){var n=(96&e[e.l++])>>5,i=e._R(2),o=8;if(r)switch(r.biff){case 5:e.l+=12,o=6;break;case 12:o=12}return e.l+=o,[n,i]}},255:{}},Wl={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},$l={1:{n:"PtgElfLel",f:Hl},2:{n:"PtgElfRw",f:Ll},3:{n:"PtgElfCol",f:Ll},6:{n:"PtgElfRwV",f:Ll},7:{n:"PtgElfColV",f:Ll},10:{n:"PtgElfRadical",f:Ll},11:{n:"PtgElfRadicalS",f:Fl},13:{n:"PtgElfColS",f:Fl},15:{n:"PtgElfColSV",f:Fl},16:{n:"PtgElfRadicalLel",f:Hl},25:{n:"PtgList",f:function(e){e.l+=2;var t=e._R(2),r=e._R(2),n=e._R(4),i=e._R(2),e=e._R(2);return{ixti:t,coltype:3&r,rt:Ul[r>>2&31],idx:n,c:i,C:e}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e._R(4)]}},255:{}},Bl={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,t,r){var n=255&e[e.l+1]?1:0;return e.l+=r&&2==r.biff?3:4,[n]}},2:{n:"PtgAttrIf",f:function(e,t,r){var n=255&e[e.l+1]?1:0;return e.l+=2,[n,e._R(r&&2==r.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,t,r){e.l+=2;for(var n=e._R(r&&2==r.biff?1:2),i=[],o=0;o<=n;++o)i.push(e._R(r&&2==r.biff?1:2));return i}},8:{n:"PtgAttrGoto",f:function(e,t,r){var n=255&e[e.l+1]?1:0;return e.l+=2,[n,e._R(r&&2==r.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,t,r){e.l+=r&&2==r.biff?3:4}},32:{n:"PtgAttrBaxcel",f:kl},33:{n:"PtgAttrBaxcel",f:kl},64:{n:"PtgAttrSpace",f:function(e){return e._R(2),Dl(e)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e._R(2),Dl(e)}},128:{n:"PtgAttrIfError",f:function(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e._R(2)]}},255:{}};function jl(e,t,r,n){if(n.biff<8)return pn(e,t);for(var i=e.l+t,o=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=Pl(e,0,n),o.push(r[s][1]);break;case"PtgMemArea":r[s][2]=function(e,t){for(var r=e._R(12==t.biff?4:2),n=[],i=0;i!=r;++i)n.push((12==t.biff?Gn:uo)(e,8));return n}(e,(r[s][1],n)),o.push(r[s][2]);break;case"PtgExp":n&&12==n.biff&&(r[s][1][1]=e._R(4),o.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return 0!==(t=i-e.l)&&o.push(pn(e,t)),o}function zl(e,t,r){for(var n,i,o=e.l+t,s=[];o!=e.l;)t=o-e.l,i=e[e.l],n=Vl[i]||Vl[Wl[i]],(n=24!==i&&25!==i?n:(24===i?$l:Bl)[e[e.l+1]])&&n.f?s.push([n.n,n.f(e,t,r)]):pn(e,t);return s}var Yl={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Gl(e,t,r){if(!e)return"SH33TJSERR0";if(8<r.biff&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return 1e4<t&&(t-=65536),0==(t=t<0?-t:t)?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(8<r.biff)switch(e[n[0]][0]){case 357:return i=-1==n[1]?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return null!=r.SID?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=-1==n[1]?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(e){return e.Name}).join(";;");default:return e[n[0]][0][3]?(i=-1==n[1]?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function ql(e,t,r){e=Gl(e,t,r);if("#REF"==e)return e;t=e,e=r;if(t||e&&e.biff<=5&&2<=e.biff)return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t;throw new Error("empty sheet name")}function Kl(e,t,r,n,i){var o,s,a=i&&i.biff||8,l={s:{c:0,r:0},e:{c:0,r:0}},c=[],u=0,d=0,h="";if(!e[0]||!e[0][0])return"";for(var p=-1,f="",g=0,m=e[0].length;g<m;++g){switch((N=e[0][g])[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(A=c.pop(),o=c.pop(),0<=p){switch(e[0][p][1][0]){case 0:f=I(" ",e[0][p][1][1]);break;case 1:f=I("\r",e[0][p][1][1]);break;default:if(f="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}o+=f,p=-1}c.push(o+Yl[N[0]]+A);break;case"PtgIsect":A=c.pop(),o=c.pop(),c.push(o+" "+A);break;case"PtgUnion":A=c.pop(),o=c.pop(),c.push(o+","+A);break;case"PtgRange":A=c.pop(),o=c.pop(),c.push(o+":"+A);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":break;case"PtgRef":y=mn(N[1][1],l,i),c.push(vn(y,a));break;case"PtgRefN":y=r?mn(N[1][1],r,i):N[1][1],c.push(vn(y,a));break;case"PtgRef3d":var u=N[1][1],y=mn(N[1][2],l,i);h=ql(n,u,i);c.push(h+"!"+vn(y,a));break;case"PtgFunc":case"PtgFuncVar":var v=N[1][0],b=N[1][1],v=v||0,w=0==(v&=127)?[]:c.slice(-v);c.length-=v,"User"===b&&(b=w.shift()),c.push(b+"("+w.join(",")+")");break;case"PtgBool":c.push(N[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(N[1]);break;case"PtgNum":c.push(String(N[1]));break;case"PtgStr":c.push('"'+N[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(N[1]);break;case"PtgAreaN":s=yn(N[1][1],r?{s:r}:l,i),c.push(bn(s,i));break;case"PtgArea":s=yn(N[1][1],l,i),c.push(bn(s,i));break;case"PtgArea3d":u=N[1][1],s=N[1][2],h=ql(n,u,i),c.push(h+"!"+bn(s,i));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=N[1][2],v=(n.names||[])[d-1]||(n[0]||[])[d],b=v?v.Name:"SH33TJSNAME"+String(d);b&&"_xlfn."==b.slice(0,6)&&!i.xlfn&&(b=b.slice(6)),c.push(b);break;case"PtgNameX":var C,E,w=N[1][1];d=N[1][2],i.biff<=5?(n[w=w<0?-w:w]&&(C=n[w][d]),c.push((C=C||{Name:"SH33TJSERRY"}).Name)):(E="",14849!=((n[w]||[])[0]||[])[0]&&(1025==((n[w]||[])[0]||[])[0]?n[w][d]&&0<n[w][d].itab&&(E=n.SheetNames[n[w][d].itab-1]+"!"):E=n.SheetNames[d-1]+"!"),n[w]&&n[w][d]?E+=n[w][d].Name:n[0]&&n[0][d]?E+=n[0][d].Name:(x=(Gl(n,w,i)||"").split(";;"))[d-1]?E=x[d-1]:E+="SH33TJSERRX",c.push(E));break;case"PtgParen":var T="(",S=")";if(0<=p){switch(f="",e[0][p][1][0]){case 2:T=I(" ",e[0][p][1][1])+T;break;case 3:T=I("\r",e[0][p][1][1])+T;break;case 4:S=I(" ",e[0][p][1][1])+S;break;case 5:S=I("\r",e[0][p][1][1])+S;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}c.push(T+c.pop()+S);break;case"PtgRefErr":case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":y={c:N[1][1],r:N[1][0]};var _={c:r.c,r:r.r};if(n.sharedf[se(y)]){var x=n.sharedf[se(y)];c.push(Kl(x,0,_,n,i))}else{for(var R=!1,A=0;A!=n.arrayf.length;++A)if(o=n.arrayf[A],!(y.c<o[0].s.c||y.c>o[0].e.c||y.r<o[0].s.r||y.r>o[0].e.r)){c.push(Kl(o[1],0,_,n,i)),R=!0;break}R||c.push(N[1])}break;case"PtgArray":c.push("{"+function(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],o=0;o<n.length;++o){var s=n[o];s?2===s[0]?i.push('"'+s[1].replace(/"/g,'""')+'"'):i.push(s[1]):i.push("")}t.push(i.join(","))}return t.join(";")}(N[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=g;break;case"PtgTbl":case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+N[1].idx+"[#"+N[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(N))}if(3!=i.biff&&0<=p&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][g][0])){var N,O=!0;switch((N=e[0][p])[1][0]){case 4:O=!1;case 0:f=I(" ",N[1][1]);break;case 5:O=!1;case 1:f=I("\r",N[1][1]);break;default:if(f="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+N[1][0])}c.push((O?f:"")+c.pop()+(O?"":f)),p=-1}}if(1<c.length&&i.WTF)throw new Error("bad formula stack");return c[0]}function Xl(e,t,r){var n,i,o,s,a,t=e.l+t,l=ao(e),c=(2==r.biff&&++e.l,function(e){var t;if(65535!==en(e,e.l+6))return[Kn(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=1===e[e.l+2],e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}(e)),u=e._R(1),e=(2!=r.biff&&(e._R(1),5<=r.biff)&&e._R(4),e=t-(t=e).l,r=r,o=t.l+e,s=2==r.biff?1:2,65535==(a=t._R(s))?[[],pn(t,e-2)]:(i=zl(t,a,r),e!==a+s&&(n=jl(t,e-a-s,i,r)),t.l=o,[i,n]));return{cell:l,val:c[0],formula:e,shared:u>>3&1,tt:c[1]}}function Jl(e,t,r,n,i){for(var t=lo(t,r,i),i=null==(r=e.v)?((i=ye(8))._W(1,3),i._W(1,0),i._W(2,0),i._W(2,0),i._W(2,65535),i):Xn("number"==typeof r?r:0),r=ye(6),o=(r._W(2,33),r._W(4,0),ye(e.bf.length)),s=0;s<e.bf.length;++s)o[s]=e.bf[s];return Re([t,i,r,o])}function Zl(e,t,r){var n=e._R(4),n=zl(e,n,r),i=e._R(4);return[n,0<i?jl(e,i,n,r):null]}var Ql=Zl,ec=Zl,tc=Zl,rc=Zl,nc={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},ic={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},oc={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function sc(e){return(e=(e=(e=(e=61==(e="of:"==e.slice(0,3)?e.slice(3):e).charCodeAt(0)&&61==(e=e.slice(1)).charCodeAt(0)?e.slice(1):e).replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,t){return t.replace(/\./g,"")})).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function ac(e){e=e.split(":");return[e[0].split(".")[0],e[0].split(".")[1]+(1<e.length?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var lc={},cc={},uc="undefined"!=typeof Map;function dc(e,t,r){var n=0,i=e.length;if(r){if(uc?r.has(t):Object.prototype.hasOwnProperty.call(r,t))for(var o=uc?r.get(t):r[t];n<o.length;++n)if(e[o[n]].t===t)return e.Count++,o[n]}else for(;n<i;++n)if(e[n].t===t)return e.Count++,n;return e[i]={t:t},e.Count++,e.Unique++,r&&(uc?(r.has(t)||r.set(t,[]),r.get(t)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t])).push(i),i}function hc(e,t){var e={min:e+1,max:e+1},r=-1;return t.MDW&&(wa=t.MDW),null!=t.width?e.customWidth=1:null!=t.wpx?r=Ea(t.wpx):null!=t.wch&&(r=t.wch),-1<r?(e.width=Ta(r),e.customWidth=1):null!=t.width&&(e.width=t.width),t.hidden&&(e.hidden=!0),null!=t.level&&(e.outlineLevel=e.level=t.level),e}function pc(e,t){e&&(t="xlml"==t?[1,1,1,1,.5,.5]:[.7,.7,.75,.75,.3,.3],null==e.left&&(e.left=t[0]),null==e.right&&(e.right=t[1]),null==e.top&&(e.top=t[2]),null==e.bottom&&(e.bottom=t[3]),null==e.header&&(e.header=t[4]),null==e.footer)&&(e.footer=t[5])}function fc(e,t,r){var n=r.revssf[null!=t.z?t.z:"General"],i=60,o=e.length;if(null==n&&r.ssf)for(;i<392;++i)if(null==r.ssf[i]){Ke(t.z,i),r.ssf[i]=t.z,r.revssf[t.z]=n=i;break}for(i=0;i!=o;++i)if(e[i].numFmtId===n)return i;return e[o]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},o}function gc(e,t,r,n,i,o){try{n.cellNF&&(e.z=ue[t])}catch(e){if(n.WTF)throw e}if("z"!==e.t||n.cellStyles){if("d"===e.t&&"string"==typeof e.v&&(e.v=de(e.v)),(!n||!1!==n.cellText)&&"z"!==e.t)try{if(null==ue[t]&&Ke(Qe[t]||"General",t),"e"===e.t)e.w=e.w||si[e.v];else if(0===t)if("n"===e.t)(0|e.v)===e.v?e.w=e.v.toString(10):e.w=Ae(e.v);else if("d"===e.t){var s=_t(e.v);e.w=(0|s)===s?s.toString(10):Ae(s)}else{if(void 0===e.v)return;e.w=Ne(e.v,cc)}else"d"===e.t?e.w=qe(t,_t(e.v),cc):e.w=qe(t,e.v,cc)}catch(e){if(n.WTF)throw e}if(n.cellStyles&&null!=r)try{e.s=o.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=ma(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF)&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=ma(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF)&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb)}catch(e){if(n.WTF&&o.Fills)throw e}}}var mc=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,yc=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,vc=/<(?:\w:)?hyperlink [^>]*>/gm,bc=/"(\w*:\w*)"/,wc=/<(?:\w:)?col\b[^>]*[\/]?>/g,Cc=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Ec=/<(?:\w:)?pageMargins[^>]*\/>/g,Tc=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Sc=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,_c=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function xc(e,t,r,n,i,o,s){if(!e)return e;n=n||{"!id":{}},null!=le&&null==t.dense&&(t.dense=le);var a,l,c=t.dense?[]:{},u={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",h="",p=e.match(yc),e=(p?(d=e.slice(0,p.index),h=e.slice(p.index+p[0].length)):d=h=e,d.match(Tc)),f=(e?Rc(e[0],0,i,r):(e=d.match(Sc))&&(a=e[0],e[1],e=c,l=i,r=r,Rc(a.slice(0,a.indexOf(">")),0,l,r)),(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index),r=(0<f&&(a=d.slice(f,f+50).match(bc))&&(e=c,(l=Ce(l=a[1])).s.r<=l.e.r)&&l.s.c<=l.e.c&&0<=l.s.r&&0<=l.s.c&&(e["!ref"]=we(l)),d.match(_c));if(r&&r[1]){var e=r[1],g=i;g.Views||(g.Views=[{}]),(e.match(Oc)||[]).forEach(function(e,t){e=pe(e);g.Views[t]||(g.Views[t]={}),+e.zoomScale&&(g.Views[t].zoom=+e.zoomScale),ge(e.rightToLeft)&&(g.Views[t].RTL=!0)})}r=[];if(t.cellStyles){i=d.match(wc);if(i)for(var m=r,y=i,v=!1,b=0;b!=y.length;++b){var w=pe(y[b],!0),C=(w.hidden&&(w.hidden=ge(w.hidden)),parseInt(w.min,10)-1),E=parseInt(w.max,10)-1;for(w.outlineLevel&&(w.level=+w.outlineLevel||0),delete w.min,delete w.max,w.width=+w.width,!v&&w.width&&(v=!0,_a(w.width)),xa(w);C<=E;)m[C++]=he(w)}}p&&Hc(p[1],c,t,u,o,s);var e=h.match(Cc),T=(e&&(c["!autofilter"]={ref:(e[0].match(/ref="([^"]*)"/)||[])[1]}),[]),S=h.match(mc);if(S)for(f=0;f!=S.length;++f)T[f]=Ce(S[f].slice(S[f].indexOf('"')+1));var _,x,d=h.match(vc),i=(d&&!function(e,t,r){for(var n=Array.isArray(e),i=0;i!=t.length;++i){var o=pe(me(t[i]),!0);if(!o.ref)return;for(var s=((r||{})["!id"]||[])[o.id],a=(s?(o.Target=s.Target,o.location&&(o.Target+="#"+fe(o.location))):(o.Target="#"+fe(o.location),s={Target:o.Target,TargetMode:"Internal"}),o.Rel=s,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip),Ce(o.ref)),l=a.s.r;l<=a.e.r;++l)for(var c=a.s.c;c<=a.e.c;++c){var u=se({c:c,r:l});n?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=o):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=o)}}}(c,d,n),h.match(Ec));return i&&(c["!margins"]=(_=pe(i[0]),x={},["left","right","top","bottom","header","footer"].forEach(function(e){_[e]&&(x[e]=parseFloat(_[e]))}),x)),!c["!ref"]&&u.e.c>=u.s.c&&u.e.r>=u.s.r&&(c["!ref"]=we(u)),0<t.sheetRows&&c["!ref"]&&(p=Ce(c["!ref"]),t.sheetRows<=+p.e.r)&&(p.e.r=t.sheetRows-1,p.e.r>u.e.r&&(p.e.r=u.e.r),p.e.r<p.s.r&&(p.s.r=p.e.r),p.e.c>u.e.c&&(p.e.c=u.e.c),p.e.c<p.s.c&&(p.s.c=p.e.c),c["!fullref"]=c["!ref"],c["!ref"]=we(p)),0<r.length&&(c["!cols"]=r),0<T.length&&(c["!merges"]=T),c}function Rc(e,t,r,n){e=pe(e);r.Sheets[n]||(r.Sheets[n]={}),e.codeName&&(r.Sheets[n].CodeName=fe(me(e.codeName)))}var Ac=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Nc=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];var Oc=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;Ic=/<(?:\w+:)?c[ \/>]/,Mc=/<\/(?:\w+:)?row>/,kc=/r=["']([^"']*)["']/,Dc=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,Pc=/ref=["']([^"']*)["']/,Lc=yr("v"),Fc=yr("f");var Ic,Mc,kc,Dc,Pc,Lc,Fc,Hc=function(L,e,t,r,F,n){for(var i,o,s,a,l=0,c="",u=[],d=[],h=0,p=0,f="",g=0,m=0,y=0,v=0,b=Array.isArray(n.CellXf),w=[],C=[],H=Array.isArray(e),E=[],T={},S=!1,_=!!t.sheetStubs,x=L.split(Mc),R=0,U=x.length;R!=U;++R){var V=(c=x[R].trim()).length;if(0!==V){var A=0;e:for(l=0;l<V;++l)switch(c[l]){case">":if("/"!=c[l-1]){++l;break e}if(t&&t.cellStyles){if(g=null!=(s=pe(c.slice(A,l),!0)).r?parseInt(s.r,10):g+1,m=-1,t.sheetRows&&t.sheetRows<g)continue;S=!(T={}),s.ht&&(S=!0,T.hpt=parseFloat(s.ht),T.hpx=Na(T.hpt)),"1"==s.hidden&&(T.hidden=S=!0),null!=s.outlineLevel&&(S=!0,T.level=+s.outlineLevel),S&&(E[g-1]=T)}break;case"<":A=l}if(l<=A)break;if(g=null!=(s=pe(c.slice(A,l),!0)).r?parseInt(s.r,10):g+1,m=-1,!(t.sheetRows&&t.sheetRows<g)){r.s.r>g-1&&(r.s.r=g-1),r.e.r<g-1&&(r.e.r=g-1),t&&t.cellStyles&&(S=!(T={}),s.ht&&(S=!0,T.hpt=parseFloat(s.ht),T.hpx=Na(T.hpt)),"1"==s.hidden&&(T.hidden=S=!0),null!=s.outlineLevel&&(S=!0,T.level=+s.outlineLevel),S)&&(E[g-1]=T);for(var u=c.slice(l).split(Ic),N=0;N!=u.length&&"<"==u[N].trim().charAt(0);++N);for(u=u.slice(N),l=0;l!=u.length;++l)if(0!==(c=u[l].trim()).length){if(d=c.match(kc),h=l,c="<c "+("<"==c.slice(p=0,1)?">":"")+c,null!=d&&2===d.length){for(f=d[1],p=h=0;p!=f.length&&!((i=f.charCodeAt(p)-64)<1||26<i);++p)h=26*h+i;m=--h}else++m;for(p=0;p!=c.length&&62!==c.charCodeAt(p);++p);if(++p,(s=pe(c.slice(0,p),!0)).r||(s.r=se({r:g-1,c:m})),o={t:""},null!=(d=(f=c.slice(p)).match(Lc))&&""!==d[1]&&(o.v=fe(d[1])),t.cellFormula){null!=(d=f.match(Fc))&&""!==d[1]?(o.f=fe(me(d[1])).replace(/\r\n/g,"\n"),t.xlfn||(o.f=Al(o.f)),-1<d[0].indexOf('t="array"')?(o.F=(f.match(Pc)||[])[1],-1<o.F.indexOf(":")&&w.push([Ce(o.F),o.F])):-1<d[0].indexOf('t="shared"')&&(O=pe(d[0]),I=fe(me(d[1])),t.xlfn||(I=Al(I)),C[parseInt(O.si,10)]=[O,I,s.r])):(d=f.match(/<f[^>]*\/>/))&&C[(O=pe(d[0])).si]&&(o.f=(I=C[O.si][1],k=C[O.si][2],P=s.r,k=En(k).s,P=W(P),Rl(I,{r:P.r-k.r,c:P.c-k.c})));for(var O,I,M=W(s.r),p=0;p<w.length;++p)M.r>=w[p][0].s.r&&M.r<=w[p][0].e.r&&M.c>=w[p][0].s.c&&M.c<=w[p][0].e.c&&(o.F=w[p][1])}if(null==s.t&&void 0===o.v)if(o.f||o.F)o.v=0,o.t="n";else{if(!_)continue;o.t="z"}else o.t=s.t||"n";switch(r.s.c>m&&(r.s.c=m),r.e.c<m&&(r.e.c=m),o.t){case"n":if(""==o.v||null==o.v){if(!_)continue;o.t="z"}else o.v=parseFloat(o.v);break;case"s":if(void 0===o.v){if(!_)continue;o.t="z"}else a=lc[parseInt(o.v,10)],o.v=a.t,o.r=a.r,t.cellHTML&&(o.h=a.h);break;case"str":o.t="s",o.v=null!=o.v?me(o.v):"",t.cellHTML&&(o.h=sr(o.v));break;case"inlineStr":d=f.match(Dc),o.t="s",null!=d&&(a=$s(d[1]))?(o.v=a.t,t.cellHTML&&(o.h=a.h)):o.v="";break;case"b":o.v=ge(o.v);break;case"d":t.cellDates?o.v=de(o.v,1):(o.v=_t(de(o.v,1)),o.t="n");break;case"e":t&&!1===t.cellText||(o.w=o.v),o.v=ai[o.v]}var k,D,P,y=v=0;b&&void 0!==s.s&&null!=(P=n.CellXf[s.s])&&(null!=P.numFmtId&&(y=P.numFmtId),t.cellStyles)&&null!=P.fillId&&(v=P.fillId),gc(o,y,v,t,F,n),t.cellDates&&b&&"n"==o.t&&Be(ue[y])&&(o.t="d",o.v=At(o.v)),s.cm&&t.xlmeta&&(k=(t.xlmeta.Cell||[])[+s.cm-1])&&"XLDAPR"==k.type&&(o.D=!0),H?(e[(D=W(s.r)).r]||(e[D.r]=[]),e[D.r][D.c]=o):e[s.r]=o}}}}0<E.length&&(e["!rows"]=E)};function Uc(e,t){for(var r,n,i=[],o=[],s=Ce(e["!ref"]),a=[],l=0,c=0,u=e["!rows"],d=Array.isArray(e),h={r:""},p=-1,c=s.s.c;c<=s.e.c;++c)a[c]=be(c);for(l=s.s.r;l<=s.e.r;++l){for(o=[],r=ve(l),c=s.s.c;c<=s.e.c;++c){var f=a[c]+r,g=d?(e[l]||[])[c]:e[f];void 0!==g&&null!=(g=function(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),void 0===e.v&&"string"!=typeof e.f||"z"===e.t&&!e.f)return"";var i="",o=e.t,s=e.v;if("z"!==e.t)switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=si[e.v];break;case"d":i=n&&n.cellDates?de(e.v,-1).toISOString():((e=he(e)).t="n",""+(e.v=_t(de(e.v)))),void 0===e.z&&(e.z=ue[14]);break;default:i=e.v}var a=Sr("v",E(i)),l={r:t},c=fc(n.cellXfs,e,n);switch(0!==c&&(l.s=c),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(null==e.v)delete e.t;else{if(32767<e.v.length)throw new Error("Text length must not exceed 32767 characters");n&&n.bookSST?(a=Sr("v",""+dc(n.Strings,e.v,n.revStrings)),l.t="s"):l.t="str"}}return e.t!=o&&(e.t=o,e.v=s),"string"==typeof e.f&&e.f&&(c=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null,a=T("f",E(e.f),c)+(null!=e.v?a:"")),e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),T("c",a,l)}(g,f,e,t))&&o.push(g)}(0<o.length||u&&u[l])&&(h={r:r},u&&u[l]&&((n=u[l]).hidden&&(h.hidden=1),p=-1,n.hpx?p=Aa(n.hpx):n.hpt&&(p=n.hpt),-1<p&&(h.ht=p,h.customHeight=1),n.level)&&(h.outlineLevel=n.level),i[i.length]=T("row",o.join(""),h))}if(u)for(;l<u.length;++l)u&&u[l]&&(h={r:l+1},(n=u[l]).hidden&&(h.hidden=1),p=-1,n.hpx?p=Aa(n.hpx):n.hpt&&(p=n.hpt),-1<p&&(h.ht=p,h.customHeight=1),n.level&&(h.outlineLevel=n.level),i[i.length]=T("row","",h));return i.join("")}function Vc(e,t,r,n){var i=[C,T("worksheet",null,{xmlns:Or[0],"xmlns:r":Nr.r})],o=r.SheetNames[e],o=r.Sheets[o],s=(o=null==o?{}:o)["!ref"]||"A1",a=Ce(s);if(16383<a.e.c||1048575<a.e.r){if(t.WTF)throw new Error("Range "+s+" exceeds format limit A1:XFD1048576");a.e.c=Math.min(a.e.c,16383),a.e.r=Math.min(a.e.c,1048575),s=we(a)}n=n||{},o["!comments"]=[];var l,c,a=[],u=o,d=r,h=e,p=t,f=i,g=!1,m={},y=null;if("xlsx"!==p.bookType&&d.vbaraw){p=d.SheetNames[h];try{d.Workbook&&(p=d.Workbook.Sheets[h].CodeName||p)}catch(e){}g=!0,m.codeName=mr(E(p))}u&&u["!outline"]&&(d={summaryBelow:1,summaryRight:1},u["!outline"].above&&(d.summaryBelow=0),u["!outline"].left&&(d.summaryRight=0),y=(y||"")+T("outlinePr",null,d)),(g||y)&&(f[f.length]=T("sheetPr",y,m)),i[i.length]=T("dimension",null,{ref:s}),i[i.length]=(h={workbookViewId:"0"},((((p=r)||{}).Workbook||{}).Views||[])[0]&&(h.rightToLeft=p.Workbook.Views[0].RTL?"1":"0"),T("sheetViews",T("sheetView",null,h),{})),t.sheetFormat&&(i[i.length]=T("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),null!=o["!cols"]&&0<o["!cols"].length&&(i[i.length]=function(e){for(var t,r=["<cols>"],n=0;n!=e.length;++n)(t=e[n])&&(r[r.length]=T("col",null,hc(n,t)));return r[r.length]="</cols>",r.join("")}(o["!cols"])),i[u=i.length]="<sheetData/>",o["!links"]=[],null!=o["!ref"]&&0<(d=Uc(o,t)).length&&(i[i.length]=d),i.length>u+1&&(i[i.length]="</sheetData>",i[u]=i[u].replace("/>",">")),o["!protect"]&&(i[i.length]=(l=o["!protect"],c={sheet:1},Ac.forEach(function(e){null!=l[e]&&l[e]&&(c[e]="1")}),Nc.forEach(function(e){null==l[e]||l[e]||(c[e]="0")}),l.password&&(c.password=na(l.password).toString(16).toUpperCase()),T("sheetProtection",null,c))),null!=o["!autofilter"]&&(i[i.length]=function(e,t,r,n){var i="string"==typeof e.ref?e.ref:we(e.ref),o=(r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]),r.Workbook.Names);(e=En(i)).s.r==e.e.r&&(e.e.r=En(t["!ref"]).e.r,i=we(e));for(var s=0;s<o.length;++s){var a=o[s];if("_xlnm._FilterDatabase"==a.Name&&a.Sheet==n){a.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return s==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),T("autoFilter",null,{ref:i})}(o["!autofilter"],o,r,e)),null!=o["!merges"]&&0<o["!merges"].length&&(i[i.length]=function(e){if(0===e.length)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+we(e[r])+'"/>';return t+"</mergeCells>"}(o["!merges"]));var v,b,w=-1;return 0<o["!links"].length&&(i[i.length]="<hyperlinks>",o["!links"].forEach(function(e){e[1].Target&&(b={ref:e[0]},"#"!=e[1].Target.charAt(0)&&(w=O(n,-1,E(e[1].Target).replace(/#.*$/,""),A.HLINK),b["r:id"]="rId"+w),-1<(v=e[1].Target.indexOf("#"))&&(b.location=E(e[1].Target.slice(v+1))),e[1].Tooltip&&(b.tooltip=E(e[1].Tooltip)),i[i.length]=T("hyperlink",null,b))}),i[i.length]="</hyperlinks>"),delete o["!links"],null!=o["!margins"]&&(i[i.length]=(pc(g=o["!margins"]),T("pageMargins",null,g))),t&&!t.ignoreEC&&null!=t.ignoreEC||(i[i.length]=Sr("ignoredErrors",T("ignoredError",null,{numberStoredAsText:1,sqref:s}))),0<a.length&&(w=O(n,-1,"../drawings/drawing"+(e+1)+".xml",A.DRAW),i[i.length]=T("drawing",null,{"r:id":"rId"+w}),o["!drawing"]=a),0<o["!comments"].length&&(w=O(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",A.VML),i[i.length]=T("legacyDrawing",null,{"r:id":"rId"+w}),o["!legacy"]=w),1<i.length&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function Wc(e,t,r,n){r=function(e,t,r){for(var n=ye(145),i=(r["!rows"]||[])[e]||{},o=(n._W(4,e),n._W(4,0),320),o=(i.hpx?o=20*Aa(i.hpx):i.hpt&&(o=20*i.hpt),n._W(2,o),n._W(1,0),0),s=(i.level&&(o|=i.level),i.hidden&&(o|=16),(i.hpx||i.hpt)&&(o|=32),n._W(1,o),n._W(1,0),0),i=n.l,a=(n.l+=4,{r:e,c:0}),l=0;l<16;++l)if(!(t.s.c>l+1<<10||t.e.c<l<<10)){for(var c=-1,u=-1,d=l<<10;d<l+1<<10;++d)a.c=d,(Array.isArray(r)?(r[a.r]||[])[a.c]:r[se(a)])&&(c<0&&(c=d),u=d);c<0||(++s,n._W(4,c),n._W(4,u))}return o=n.l,n.l=i,n._W(4,s),n.l=o,n.length>n.l?n.slice(0,n.l):n}(n,r,t);(17<r.length||(t["!rows"]||[])[n])&&N(e,0,r)}var $c=Gn,Bc=qn;function jc(e){return[Pn(e),Kn(e),"n"]}var zc=Gn,Yc=qn;var Gc=["left","right","top","bottom","header","footer"];function qc(e,t,r,n,i,o,s){if(void 0===t.v)return!1;var a="";switch(t.t){case"b":a=t.v?"1":"0";break;case"d":(t=he(t)).z=t.z||ue[14],t.v=_t(de(t.v)),t.t="n";break;case"n":case"e":a=""+t.v;break;default:a=t.v}var l,c,u,d,h,p,f,g,m,y,v,b,w,C,E,T,S,_,x,R,A={r:r,c:n};switch(A.s=fc(i.cellXfs,t,i),t.l&&o["!links"].push([se(A),t.l]),t.c&&o["!comments"].push([se(A),t.c]),t.t){case"s":case"str":return i.bookSST?(a=dc(i.Strings,t.v,i.revStrings),A.t="s",A.v=a,s?N(e,18,(Ln(S=A,_=null==_?ye(8):_),_._W(4,S.v),_)):N(e,7,(Dn(S=A,T=null==T?ye(12):T),T._W(4,S.v),T))):(A.t="str",s?N(e,17,(C=t,Ln(A,E=null==E?ye(8+4*C.v.length):E),On(C.v,E),E.length>E.l?E.slice(0,E.l):E)):N(e,6,(C=t,Dn(A,w=null==w?ye(12+4*C.v.length):w),On(C.v,w),w.length>w.l?w.slice(0,w.l):w))),!0;case"n":return t.v==(0|t.v)&&-1e3<t.v&&t.v<1e3?s?N(e,13,(v=t,Ln(A,b=null==b?ye(8):b),zn(v.v,b),b)):N(e,2,(v=t,Dn(A,y=null==y?ye(12):y),zn(v.v,y),y)):s?N(e,16,(g=t,Ln(A,m=null==m?ye(12):m),Xn(g.v,m),m)):N(e,5,(g=t,Dn(A,f=null==f?ye(16):f),Xn(g.v,f),f)),!0;case"b":return A.t="b",s?N(e,15,(h=t,Ln(A,p=null==p?ye(5):p),p._W(1,h.v?1:0),p)):N(e,4,(h=t,Dn(A,d=null==d?ye(9):d),d._W(1,h.v?1:0),d)),!0;case"e":return A.t="e",s?N(e,14,(c=t,Ln(A,u=null==u?ye(8):u),u._W(1,c.v),u._W(2,0),u._W(1,0),u)):N(e,3,(c=t,Dn(A,l=null==l?ye(9):l),l._W(1,c.v),l)),!0}return s?N(e,12,Ln(A,R=null==R?ye(4):R)):N(e,1,Dn(A,x=null==x?ye(8):x)),!0}function Kc(t,e){var r,n;e&&e["!merges"]&&(N(t,177,(r=e["!merges"].length,(n=null==n?ye(4):n)._W(4,r),n)),e["!merges"].forEach(function(e){N(t,176,Yc(e))}),N(t,178))}function Xc(i,e){e&&e["!cols"]&&(N(i,390),e["!cols"].forEach(function(e,t){var r,n;e&&N(i,60,(t=t,e=e,null==r&&(r=ye(18)),n=hc(t,e),r._W(-4,t),r._W(-4,t),r._W(4,256*(n.width||10)),r._W(4,0),t=0,e.hidden&&(t|=1),"number"==typeof n.width&&(t|=2),e.level&&(t|=e.level<<8),r._W(2,t),r))}),N(i,391))}function Jc(e,t){var r;t&&t["!ref"]&&(N(e,648),N(e,649,(t=Ce(t["!ref"]),(r=ye(24))._W(4,4),r._W(4,1),qn(t,r),r)),N(e,650))}function Zc(n,e,i){e["!links"].forEach(function(e){var t,r;e[1].Target&&(t=O(i,-1,e[1].Target.replace(/#.*$/,""),A.HLINK),N(n,494,(t=t,r=ye(50+4*((e=e)[1].Target.length+(e[1].Tooltip||"").length)),qn({s:W(e[0]),e:W(e[0])},r),Bn("rId"+t,r),On((-1==(t=e[1].Target.indexOf("#"))?"":e[1].Target.slice(t+1))||"",r),On(e[1].Tooltip||"",r),On("",r),r.slice(0,r.l))))}),delete e["!links"]}function Qc(e,t,r){var n,i;N(e,133),N(e,137,(r=r,null==n&&(n=ye(30)),i=924,(((r||{}).Views||[])[0]||{}).RTL&&(i|=32),n._W(2,i),n._W(4,0),n._W(4,0),n._W(4,0),n._W(1,0),n._W(1,0),n._W(2,0),n._W(2,100),n._W(2,0),n._W(2,0),n._W(2,0),n._W(4,0),n)),N(e,138),N(e,134)}function eu(e,t){var r,n;t["!protect"]&&N(e,535,(r=t["!protect"],(n=null==n?ye(66):n)._W(2,r.password?na(r.password):0),n._W(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(e){e[1]?n._W(4,null==r[e[0]]||r[e[0]]?0:1):n._W(4,null!=r[e[0]]&&r[e[0]]?0:1)}),n))}function tu(e,t,r,n){var i=gn(),o=r.SheetNames[e],s=r.Sheets[o]||{};try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch(e){}var a,l,c=Ce(s["!ref"]||"A1");if(16383<c.e.c||1048575<c.e.r){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}s["!links"]=[],s["!comments"]=[],N(i,129),(r.vbaraw||s["!outline"])&&N(i,147,function(e,t,r){null==r&&(r=ye(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left)&&(n&=-129),r._W(1,n);for(var i=1;i<3;++i)r._W(1,0);return Jn({auto:1},r),r._W(-4,-1),r._W(-4,-1),Hn(e,r),r.slice(0,r.l)}(o,s["!outline"])),N(i,148,Bc(c)),Qc(i,0,r.Workbook),Xc(i,s);var u,d=i,h=s,p=t,f=Ce(h["!ref"]||"A1"),g=[],m=(N(d,145),Array.isArray(h)),y=f.e.r;h["!rows"]&&(y=Math.max(f.e.r,h["!rows"].length-1));for(var v=f.s.r;v<=y;++v){u=ve(v),Wc(d,h,f,v);var b=!1;if(v<=f.e.r)for(var w=f.s.c;w<=f.e.c;++w){v===f.s.r&&(g[w]=be(w));var C=m?(h[v]||[])[w]:h[g[w]+u];C?b=qc(d,C,v,w,p,h,b):b=!1}}N(d,146),eu(i,s);var o=i,c=s,E=r,T=e;if(c["!autofilter"]){var r=c["!autofilter"],S="string"==typeof r.ref?r.ref:we(r.ref),_=(E.Workbook||(E.Workbook={Sheets:[]}),E.Workbook.Names||(E.Workbook.Names=[]),E.Workbook.Names),r=En(S);r.s.r==r.e.r&&(r.e.r=En(c["!ref"]).e.r,S=we(r));for(var x=0;x<_.length;++x){var R=_[x];if("_xlnm._FilterDatabase"==R.Name&&R.Sheet==T){R.Ref="'"+E.SheetNames[T]+"'!"+S;break}}x==_.length&&_.push({Name:"_xlnm._FilterDatabase",Sheet:T,Ref:"'"+E.SheetNames[T]+"'!"+S}),N(o,161,qn(Ce(S))),N(o,162)}return Kc(i,s),Zc(i,s,n),s["!margins"]&&N(i,476,(a=s["!margins"],null==l&&(l=ye(48)),pc(a),Gc.forEach(function(e){Xn(a[e],l)}),l)),t&&!t.ignoreEC&&null!=t.ignoreEC||Jc(i,s),c=i,r=e,o=n,0<(t=s)["!comments"].length&&(o=O(o,-1,"../drawings/vmlDrawing"+(r+1)+".vml",A.VML),N(c,551,Bn("rId"+o)),t["!legacy"]=o),N(i,130),i.end()}function ru(e,t,r,n,i,o){var s,a,l,c,u=o||{"!type":"chart"};return e?(l="A",c={s:{r:2e6,c:2e6},e:{r:a=s=0,c:0}},(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(e){r=[],n=(e=e).match(/^<c:numCache>/),(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach(function(e){e=e.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);e&&(r[+e[1]]=n?+e[2]:e[2])}),i=fe((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]),(e.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach(function(e){t=e.replace(/<.*?>/g,"")});var t,r,n,i,o=[r,i,t];c.s.r=c.s.c=0,c.e.c=s,l=be(s),o[0].forEach(function(e,t){u[l+ve(t)]={t:"n",v:e,z:o[1]},a=t}),c.e.r<a&&(c.e.r=a),++s}),0<s&&(u["!ref"]=we(c)),u):o}var nu=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],iu=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],ou=[],su=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function au(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],i=0;i!=t.length;++i){var o=t[i];if(null==n[o[0]])n[o[0]]=o[1];else switch(o[2]){case"bool":"string"==typeof n[o[0]]&&(n[o[0]]=ge(n[o[0]]));break;case"int":"string"==typeof n[o[0]]&&(n[o[0]]=parseInt(n[o[0]],10))}}}function lu(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(null==e[n[0]])e[n[0]]=n[1];else switch(n[2]){case"bool":"string"==typeof e[n[0]]&&(e[n[0]]=ge(e[n[0]]));break;case"int":"string"==typeof e[n[0]]&&(e[n[0]]=parseInt(e[n[0]],10))}}}function cu(e){lu(e.WBProps,nu),lu(e.CalcPr,su),au(e.WBView,iu),au(e.Sheets,ou),cc.date1904=ge(e.WBProps.date1904)}var uu="][*?/\\".split("");function du(t,r){if(31<t.length){if(r)return;throw new Error("Sheet names cannot exceed 31 chars")}uu.forEach(function(e){if(-1!=t.indexOf(e)){if(!r)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");0}})}function hu(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var i,o,s,t=e.Workbook&&e.Workbook.Sheets||[];i=e.SheetNames,o=t,s=!!e.vbaraw,i.forEach(function(e,t){du(e);for(var r=0;r<t;++r)if(e==i[r])throw new Error("Duplicate Sheet Name: "+e);if(s){var n=o&&o[t]&&o[t].CodeName||e;if(95==n.charCodeAt(0)&&22<n.length)throw new Error("Bad Code Name: Worksheet"+n)}});for(var r=0;r<e.SheetNames.length;++r){n=void 0;a=void 0;l=void 0;var n=e.Sheets[e.SheetNames[r]];e.SheetNames[r];var a=r;if(n&&n["!ref"]){var l=Ce(n["!ref"]);if(l.e.c<l.s.c||l.e.r<l.s.r)throw new Error("Bad range ("+a+"): "+n["!ref"])}}}var pu=/<\w+:workbook/;function fu(t){var r=[C],e=(r[r.length]=T("workbook",null,{xmlns:Or[0],"xmlns:r":Nr.r}),t.Workbook&&0<(t.Workbook.Names||[]).length),n={codeName:"ThisWorkbook"},i=(t.Workbook&&t.Workbook.WBProps&&(nu.forEach(function(e){null!=t.Workbook.WBProps[e[0]]&&t.Workbook.WBProps[e[0]]!=e[1]&&(n[e[0]]=t.Workbook.WBProps[e[0]])}),t.Workbook.WBProps.CodeName)&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName),r[r.length]=T("workbookPr",null,n),t.Workbook&&t.Workbook.Sheets||[]),o=0;if(i&&i[0]&&i[0].Hidden){for(r[r.length]="<bookViews>",o=0;o!=t.SheetNames.length&&i[o]&&i[o].Hidden;++o);o==t.SheetNames.length&&(o=0),r[r.length]='<workbookView firstSheet="'+o+'" activeTab="'+o+'"/>',r[r.length]="</bookViews>"}for(r[r.length]="<sheets>",o=0;o!=t.SheetNames.length;++o){var s={name:E(t.SheetNames[o].slice(0,31))};if(s.sheetId=""+(o+1),s["r:id"]="rId"+(o+1),i[o])switch(i[o].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden"}r[r.length]=T("sheet",null,s)}return r[r.length]="</sheets>",e&&(r[r.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(e){var t={name:e.Name};e.Comment&&(t.comment=e.Comment),null!=e.Sheet&&(t.localSheetId=""+e.Sheet),e.Hidden&&(t.hidden="1"),e.Ref&&(r[r.length]=T("definedName",E(e.Ref),t))}),r[r.length]="</definedNames>"),2<r.length&&(r[r.length]="</workbook>",r[1]=r[1].replace("/>",">")),r.join("")}function gu(e,t){var r={};return e._R(4),r.ArchID=e._R(4),e.l+=t-8,r}function mu(e,t){N(e,143);for(var r,n=0;n!=t.SheetNames.length;++n){var i={Hidden:t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[n]&&t.Workbook.Sheets[n].Hidden||0,iTabID:n+1,strRelID:"rId"+(n+1),name:t.SheetNames[n]};N(e,156,(i=i,(r=(r=void 0)||ye(127))._W(4,i.Hidden),r._W(4,i.iTabID),Bn(i.strRelID,r),On(i.name.slice(0,31),r),r.length>r.l?r.slice(0,r.l):r))}N(e,144)}function yu(e,t){if(t.Workbook&&t.Workbook.Sheets){for(var r,n=t.Workbook.Sheets,i=0,o=-1,s=-1;i<n.length;++i)!n[i]||!n[i].Hidden&&-1==o?o=i:1==n[i].Hidden&&-1==s&&(s=i);o<s||(N(e,135),N(e,158,(t=o,(r=r||ye(29))._W(-4,0),r._W(-4,460),r._W(4,28800),r._W(4,17600),r._W(4,500),r._W(4,t),r._W(4,t),r._W(1,120),r.length>r.l?r.slice(0,r.l):r)),N(e,136))}}function vu(e,t){var r,n,i,o=gn();return N(o,131),N(o,128,function(e){e=e||ye(127);for(var t=0;4!=t;++t)e._W(4,0);return On("SheetJS",e),On(s.version,e),On(s.version,e),On("7262",e),e.length>e.l?e.slice(0,e.l):e}()),N(o,153,(r=e.Workbook&&e.Workbook.WBProps||null,n=n||ye(72),i=0,r&&r.filterPrivacy&&(i|=8),n._W(4,i),n._W(4,0),Hn(r&&r.CodeName||"ThisWorkbook",n),n.slice(0,n.l))),yu(o,e),mu(o,e),N(o,132),o.end()}function bu(e,t,r){if(".bin"===t.slice(-4))return t=e,i={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},s=!(o=[]),(n=(n=r)||{}).biff=12,a=[],(l=[[]]).SheetNames=[],l.XTI=[],Ku[16]={n:"BrtFRTArchID$",f:gu},fn(t,function(e,t,r){switch(r){case 156:l.SheetNames.push(e.name),i.Sheets.push(e);break;case 153:i.WBProps=e;break;case 39:null!=e.Sheet&&(n.SID=e.Sheet),e.Ref=Kl(e.Ptg,0,null,l,n),delete n.SID,delete e.Ptg,a.push(e);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([r,e]):l[0]=[r,e],l[l.length-1].XTI=[];break;case 362:0===l.length&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(e),l.XTI=l.XTI.concat(e);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:o.push(r),s=!0;break;case 36:o.pop(),s=!1;break;case 37:o.push(r),s=!0;break;case 38:o.pop(),s=!1;break;case 16:break;default:if(!t.T&&(!s||n.WTF&&37!=o[o.length-1]&&35!=o[o.length-1]))throw new Error("Unexpected record 0x"+r.toString(16))}},n),cu(i),i.Names=a,i.supbooks=l,i;var n,i,o,s,a,l,c=e,u=r;if(!c)throw new Error("Could not find file");var d={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},h=!1,p="xmlns",f={},g=0;if(c.replace(qt,function(e,t){var r=pe(e);switch(Jt(r[0])){case"<?xml":break;case"<workbook":e.match(pu)&&(p="xmlns"+e.match(/<(\w+):/)[1]),d.xmlns=r[p];break;case"</workbook>":break;case"<fileVersion":delete r[0],d.AppVersion=r;break;case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":nu.forEach(function(e){if(null!=r[e[0]])switch(e[2]){case"bool":d.WBProps[e[0]]=ge(r[e[0]]);break;case"int":d.WBProps[e[0]]=parseInt(r[e[0]],10);break;default:d.WBProps[e[0]]=r[e[0]]}}),r.codeName&&(d.WBProps.CodeName=me(r.codeName));break;case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete r[0],d.WBView.push(r);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(r.state){case"hidden":r.Hidden=1;break;case"veryHidden":r.Hidden=2;break;default:r.Hidden=0}delete r.state,r.name=fe(me(r.name)),delete r[0],d.Sheets.push(r);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":break;case"<definedNames>":case"<definedNames":h=!0;break;case"</definedNames>":h=!1;break;case"<definedName":(f={}).Name=me(r.name),r.comment&&(f.Comment=r.comment),r.localSheetId&&(f.Sheet=+r.localSheetId),ge(r.hidden||"0")&&(f.Hidden=!0),g=t+e.length;break;case"</definedName>":f.Ref=fe(me(c.slice(g,t))),d.Names.push(f);break;case"<definedName/>":break;case"<calcPr":case"<calcPr/>":delete r[0],d.CalcPr=r;break;case"</calcPr>":case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":h=!0;break;case"</ext>":h=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":h=!0;break;case"</AlternateContent>":h=!1;break;case"<revisionPtr":break;default:if(!h&&u.WTF)throw new Error("unrecognized "+r[0]+" in workbook")}return e}),-1===Or.indexOf(d.xmlns))throw new Error("Unknown Namespace: "+d.xmlns);return cu(d),d}function wu(e,t,r,n,i,o,s,a){if(".bin"!==t.slice(-4))return xc(e,n,r,i,o,s,a);var t=e,e=n,l=r,c=i,u=o,L=s,d=a;if(!t)return t;var h,p,f,g,m,y,v,b,w,C,E=e||{},T=(c=c||{"!id":{}},null!=le&&null==E.dense&&(E.dense=le),E.dense?[]:{}),S={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=[],x=!1,F=!1,R=[],A=(E.biff=12,E["!row"]=0),N=!1,O=[],H={},I=E.supbooks||u.supbooks||[[]];if(I.sharedf=H,I.arrayf=O,I.SheetNames=u.SheetNames||u.Sheets.map(function(e){return e.name}),!E.supbooks&&(E.supbooks=I,u.Names))for(var M=0;M<u.Names.length;++M)I[0][M+1]=u.Names[M];var k,D=[],P=[],U=!1;return Ku[16]={n:"BrtShortReal",f:jc},fn(t,function(e,t,r){if(!F)switch(r){case 148:h=e;break;case 0:p=e,E.sheetRows&&E.sheetRows<=p.r&&(F=!0),w=ve(m=p.r),E["!row"]=p.r,(e.hidden||e.hpt||null!=e.level)&&(e.hpt&&(e.hpx=Na(e.hpt)),P[e.r]=e);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(f={t:e[2]},e[2]){case"n":f.v=e[1];break;case"s":b=lc[e[1]],f.v=b.t,f.r=b.r;break;case"b":f.v=!!e[1];break;case"e":f.v=e[1],!1!==E.cellText&&(f.w=si[f.v]);break;case"str":f.t="s",f.v=e[1];break;case"is":f.t="s",f.v=e[1].t}if((g=d.CellXf[e[0].iStyleRef])&&gc(f,g.numFmtId,null,E,L,d),y=-1==e[0].c?y+1:e[0].c,E.dense?(T[m]||(T[m]=[]),T[m][y]=f):T[be(y)+w]=f,E.cellFormula){for(N=!1,A=0;A<O.length;++A){var n=O[A];p.r>=n[0].s.r&&p.r<=n[0].e.r&&y>=n[0].s.c&&y<=n[0].e.c&&(f.F=we(n[0]),N=!0)}!N&&3<e.length&&(f.f=e[3])}S.s.r>p.r&&(S.s.r=p.r),S.s.c>y&&(S.s.c=y),S.e.r<p.r&&(S.e.r=p.r),S.e.c<y&&(S.e.c=y),E.cellDates&&g&&"n"==f.t&&Be(ue[g.numFmtId])&&(i=z(f.v))&&(f.t="d",f.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u)),k&&("XLDAPR"==k.type&&(f.D=!0),k=void 0),0;break;case 1:case 12:E.sheetStubs&&!x&&(f={t:"z",v:void 0},y=-1==e[0].c?y+1:e[0].c,E.dense?(T[m]||(T[m]=[]),T[m][y]=f):T[be(y)+w]=f,S.s.r>p.r&&(S.s.r=p.r),S.s.c>y&&(S.s.c=y),S.e.r<p.r&&(S.e.r=p.r),S.e.c<y&&(S.e.c=y),k&&("XLDAPR"==k.type&&(f.D=!0),k=void 0),0);break;case 176:R.push(e);break;case 49:k=((E.xlmeta||{}).Cell||[])[e-1];break;case 494:var i;for((i=c["!id"][e.relId])?(e.Target=i.Target,e.loc&&(e.Target+="#"+e.loc),e.Rel=i):""==e.relId&&(e.Target="#"+e.loc),m=e.rfx.s.r;m<=e.rfx.e.r;++m)for(y=e.rfx.s.c;y<=e.rfx.e.c;++y)E.dense?(T[m]||(T[m]=[]),T[m][y]||(T[m][y]={t:"z",v:void 0}),T[m][y].l=e):(v=se({c:y,r:m}),T[v]||(T[v]={t:"z",v:void 0}),T[v].l=e);break;case 426:E.cellFormula&&(O.push(e),(C=E.dense?T[m][y]:T[be(y)+w]).f=Kl(e[1],0,{r:p.r,c:y},I,E),C.F=we(e[0]));break;case 427:E.cellFormula&&(H[se(e[0].s)]=e[1],(C=E.dense?T[m][y]:T[be(y)+w]).f=Kl(e[1],0,{r:p.r,c:y},I,E));break;case 60:if(E.cellStyles)for(;e.e>=e.s;)D[e.e--]={width:e.w/256,hidden:!!(1&e.flags),level:e.level},U||(U=!0,_a(e.w/256)),xa(D[e.e+1]);break;case 161:T["!autofilter"]={ref:we(e)};break;case 476:T["!margins"]=e;break;case 147:u.Sheets[l]||(u.Sheets[l]={}),e.name&&(u.Sheets[l].CodeName=e.name),(e.above||e.left)&&(T["!outline"]={above:e.above,left:e.left});break;case 137:u.Views||(u.Views=[{}]),u.Views[0]||(u.Views[0]={}),e.RTL&&(u.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:x=!0;break;case 36:x=!1;break;case 37:_.push(r),x=!0;break;case 38:_.pop(),x=!1;break;default:if(!t.T&&(!x||E.WTF))throw new Error("Unexpected record 0x"+r.toString(16))}},E),delete E.supbooks,delete E["!row"],!T["!ref"]&&(S.s.r<2e6||h&&(0<h.e.r||0<h.e.c||0<h.s.r||0<h.s.c))&&(T["!ref"]=we(h||S)),E.sheetRows&&T["!ref"]&&(e=Ce(T["!ref"]),E.sheetRows<=+e.e.r)&&(e.e.r=E.sheetRows-1,e.e.r>S.e.r&&(e.e.r=S.e.r),e.e.r<e.s.r&&(e.s.r=e.e.r),e.e.c>S.e.c&&(e.e.c=S.e.c),e.e.c<e.s.c&&(e.s.c=e.e.c),T["!fullref"]=T["!ref"],T["!ref"]=we(e)),0<R.length&&(T["!merges"]=R),0<D.length&&(T["!cols"]=D),0<P.length&&(T["!rows"]=P),T}function Cu(e,t,r,n,i,o){if(".bin"===t.slice(-4)){var t=e,s=n,a=r,n=i,l=o;if(!t)return t;n=n||{"!id":{}};var c={"!type":"chart","!drawel":null,"!rel":""},u=[],d=!1;return fn(t,function(e,t,r){switch(r){case 550:c["!rel"]=e;break;case 651:l.Sheets[a]||(l.Sheets[a]={}),e.name&&(l.Sheets[a].CodeName=e.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:d=!0;break;case 36:d=!1;break;case 37:u.push(r);break;case 38:u.pop();break;default:if(0<t.T)u.push(r);else if(t.T<0)u.pop();else if(!d||s.WTF)throw new Error("Unexpected record 0x"+r.toString(16))}},s),n["!id"][c["!rel"]]&&(c["!drawel"]=n["!id"][c["!rel"]]),c}t=e,n=r,e=i,r=o;if(!t)return t;e=e||{"!id":{}};i={"!type":"chart","!drawel":null,"!rel":""},o=t.match(Tc);return o&&Rc(o[0],0,r,n),(o=t.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=o[1]),e["!id"][i["!rel"]]&&(i["!drawel"]=e["!id"][i["!rel"]]),i}function Eu(e,t,r,n){if(".bin"!==t.slice(-4))return Ha(e,r,n);var i,t=e,o=r,s=n,a={NumberFmt:[]};for(i in ue)a.NumberFmt[i]=ue[i];a.CellXf=[];var l=[],c=!(a.Fonts=[]);return fn(t,function(e,t,r){switch(r){case 44:a.NumberFmt[e[0]]=e[1],Ke(e[1],e[0]);break;case 43:a.Fonts.push(e),null!=e.color.theme&&o&&o.themeElements&&o.themeElements.clrScheme&&(e.color.rgb=ma(o.themeElements.clrScheme[e.color.theme].rgb,e.color.tint||0));break;case 1025:case 45:case 46:break;case 47:617==l[l.length-1]&&a.CellXf.push(e);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:l.push(r),c=!0;break;case 38:l.pop(),c=!1;break;default:if(0<t.T)l.push(r);else if(t.T<0)l.pop();else if(!c||s.WTF&&37!=l[l.length-1])throw new Error("Unexpected record 0x"+r.toString(16))}}),a}function Tu(e,t,r){if(".bin"===t.slice(-4))return n=r,o=!(i=[]),fn(e,function(e,t,r){switch(r){case 159:i.Count=e[0],i.Unique=e[1];break;case 19:i.push(e);break;case 160:return 1;case 35:o=!0;break;case 36:o=!1;break;default:if(t.T,!o||n.WTF)throw new Error("Unexpected record 0x"+r.toString(16))}}),i;var n,i,o,t=e,s=r,a=[],l="";if(t){t=t.match(Bs);if(t){for(var l=t[2].replace(js,"").split(zs),c=0;c!=l.length;++c){var u=$s(l[c].trim(),s);null!=u&&(a[a.length]=u)}t=pe(t[1]),a.Count=t.count,a.Unique=t.uniqueCount}}return a}function Su(e,t,r){var n,i,o,s,a,l,c,u;return".bin"===t.slice(-4)?(n=r,i=[],o=[],a=!(s={}),fn(e,function(e,t,r){switch(r){case 632:o.push(e);break;case 635:s=e;break;case 637:s.t=e.t,s.h=e.h,s.r=e.r;break;case 636:s.author=o[s.iauthor],delete s.iauthor,n.sheetRows&&s.rfx&&n.sheetRows<=s.rfx.r||(s.t||(s.t=""),delete s.rfx,i.push(s));break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:case 38:break;default:if(!t.T&&(!a||n.WTF))throw new Error("Unexpected record 0x"+r.toString(16))}}),i):(l=r,(t=e).match(/<(?:\w+:)?comments *\/>/)?[]:(c=[],u=[],(r=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/))&&r[1]&&r[1].split(/<\/\w*:?author>/).forEach(function(e){""!==e&&""!==e.trim()&&(e=e.match(/<(?:\w+:)?author[^>]*>(.*)/))&&c.push(e[1])}),(r=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/))&&r[1]&&r[1].split(/<\/\w*:?comment>/).forEach(function(e){var t,r;""!==e&&""!==e.trim()&&(r=e.match(/<(?:\w+:)?comment[^>]*>/))&&(t={author:(r=pe(r[0])).authorId&&c[r.authorId]||"sheetjsghost",ref:r.ref,guid:r.guid},r=W(r.ref),l.sheetRows&&l.sheetRows<=r.r||(e=!!(r=e.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/))&&!!r[1]&&$s(r[1])||{r:"",t:"",h:""},t.r=e.r,"<t></t>"==e.r&&(e.t=e.h=""),t.t=(e.t||"").replace(/\r\n/g,"\n").replace(/\r/g,"\n"),l.cellHTML&&(t.h=e.h),u.push(t)))}),u))}function _u(e,t){var n,r,i;return".bin"===t.slice(-4)?(n=[],fn(e,function(e,t,r){if(63===r)n.push(e);else if(!t.T)throw new Error("Unexpected record 0x"+r.toString(16))}),n):(i=[],(t=e)&&(r=1,(t.match(qt)||[]).forEach(function(e){var t=pe(e);switch(t[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete t[0],t.i?r=t.i:t.i=r,i.push(t)}})),i)}function xu(e,t,r,n){if(".bin"===r.slice(-4)){r=e,e=n;if(!r)return r;var i=e||{},o=!1;fn(r,function(e,t,r){switch(r){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!t.T&&(!o||i.WTF))throw new Error("Unexpected record 0x"+r.toString(16))}},i)}}function Ru(e,t,r){var n,i,o,s,a,l,c,u,d,h;return".bin"===t.slice(-4)?(n={Types:[],Cell:[],Value:[]},i=r||{},s=!(o=[]),a=2,fn(e,function(e,t,r){switch(r){case 335:n.Types.push({name:e.name});break;case 51:e.forEach(function(e){1==a?n.Cell.push({type:n.Types[e[0]-1].name,index:e[1]}):0==a&&n.Value.push({type:n.Types[e[0]-1].name,index:e[1]})});break;case 337:a=e?1:0;break;case 338:a=2;break;case 35:o.push(r),s=!0;break;case 36:o.pop(),s=!1;break;default:if(!t.T&&(!s||i.WTF&&35!=o[o.length-1]))throw new Error("Unexpected record 0x"+r.toString(16))}}),n):(l=r,h={Types:[],Cell:[],Value:[]},(t=e)&&(c=!1,u=2,t.replace(qt,function(e){var t=pe(e);switch(Jt(t[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":h.Types.push({name:t.name});break;case"</metadataType>":break;case"<futureMetadata":for(var r=0;r<h.Types.length;++r)h.Types[r].name==t.name&&(d=h.Types[r]);break;case"</futureMetadata>":case"<bk>":case"</bk>":break;case"<rc":1==u?h.Cell.push({type:h.Types[t.t-1].name,index:+t.v}):0==u&&h.Value.push({type:h.Types[t.t-1].name,index:+t.v});break;case"</rc>":break;case"<cellMetadata":u=1;break;case"</cellMetadata>":u=2;break;case"<valueMetadata":u=0;break;case"</valueMetadata>":u=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":c=!0;break;case"</ext>":c=!1;break;case"<rvb":d&&(d.offsets||(d.offsets=[]),d.offsets.push(+t.i));break;default:if(!c&&l.WTF)throw new Error("unrecognized "+t[0]+" in metadata")}return e})),h)}var Au,Nu=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Ou=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Iu(e,t){var r=e.split(/\s+/),n=[];if(t||(n[0]=r[0]),1!==r.length){var i,o,s,a=e.match(Nu);if(a)for(s=0;s!=a.length;++s)-1===(o=(i=a[s].match(Ou))[1].indexOf(":"))?n[i[1]]=i[2].slice(1,i[2].length-1):n["xmlns:"===i[1].slice(0,6)?"xmlns"+i[1].slice(6):i[1].slice(o+1)]=i[2].slice(1,i[2].length-1)}return n}function Mu(e,t,r){if("z"!==e.t){if(!r||!1!==r.cellText)try{"e"===e.t?e.w=e.w||si[e.v]:"General"===t?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=Ae(e.v):e.w=Ne(e.v):e.w=(n=t||"General",i=e.v,"General"===(n=Au[n]||fe(n))?Ne(i):qe(n,i))}catch(e){if(r.WTF)throw e}var n,i;try{var o,s=Au[t]||t||"General";r.cellNF&&(e.z=s),r.cellDates&&"n"==e.t&&Be(s)&&(o=z(e.v))&&(e.t="d",e.v=new Date(o.y,o.m-1,o.d,o.H,o.M,o.S,o.u))}catch(e){if(r.WTF)throw e}}}function ku(e,t){var r,n=t||{},i=(Je(),Se(Rr(e))),o=(i="binary"!=n.type&&"array"!=n.type&&"base64"!=n.type?i:void 0!==ae?ae.utils.decode(65001,Te(i)):me(i)).slice(0,1024).toLowerCase(),L=!1;if((1023&(o=o.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&o.indexOf(","),1023&o.indexOf(";")))return(t=he(n)).type="string",us.to_workbook(i,t);if(-1==o.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach(function(e){0<=o.indexOf("<"+e)&&(L=!0)}),L){var F,e=i,H=n;if((e=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi))&&0!=e.length)return 1==e.length?_n(ld(e[0],H),H):(F=Ah(),e.forEach(function(e,t){Nh(F,ld(e,H),"Sheet"+(t+1))}),F);throw new Error("Invalid HTML: could not find <table>")}Au={"General Number":"General","General Date":ue[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ue[15],"Short Date":ue[14],"Long Time":ue[19],"Medium Time":ue[18],"Short Time":ue[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ue[2],Standard:ue[4],Percent:ue[10],Scientific:ue[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};for(var s,a,l,c,u,d,h,p=[],U=(null!=le&&null==n.dense&&(n.dense=le),{}),V=[],f=n.dense?[]:{},g="",m={},y={},W=Iu('<Data ss:Type="String">'),$=0,v=0,b=0,w={s:{r:2e6,c:2e6},e:{r:0,c:0}},B={},C={},j="",z=0,E=[],Y={},G={},T=0,q=[],K=[],X={},S=[],J=!1,Z=[],_=[],x={},R=0,Q=0,A={Sheets:[],WBProps:{date1904:!1}},ee={},te=(Ar.lastIndex=0,i=i.replace(/<!--([\s\S]*?)-->/gm,""),"");r=Ar.exec(i);)switch(r[3]=(te=r[3]).toLowerCase()){case"data":if("data"==te)if("/"===r[1]){if((s=p.pop())[0]!==r[3])throw new Error("Bad state: "+s.join("|"))}else"/"!==r[0].charAt(r[0].length-2)&&p.push([r[3],!0]);else p[p.length-1][1]||("/"===r[1]?function(e,t,r,n,i,o,s,a,l,c){var u="General",d=n.StyleID,h={},p=(c=c||{},[]),f=0;for(void 0===(d=void 0===d&&a?a.StyleID:d)&&s&&(d=s.StyleID);void 0!==o[d]&&(o[d].nf&&(u=o[d].nf),o[d].Interior&&p.push(o[d].Interior),o[d].Parent);)d=o[d].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=ge(e);break;case"String":n.t="s",n.r=lr(fe(e)),n.v=-1<e.indexOf("<")?fe(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":"Z"!=e.slice(-1)&&(e+="Z"),n.v=(de(e)-new Date(Date.UTC(1899,11,30)))/864e5,n.v!=n.v?n.v=fe(e):n.v<60&&(n.v=n.v-1),u&&"General"!=u||(u="yyyy-mm-dd");case"Number":void 0===n.v&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=ai[e],!1!==c.cellText&&(n.w=e);break;default:""==e&&""==t?n.t="z":(n.t="s",n.v=lr(t||e))}if(Mu(n,u,c),!1!==c.cellFormula)if(n.Formula){a=fe(n.Formula);61==a.charCodeAt(0)&&(a=a.slice(1)),n.f=Tl(a,i),delete n.Formula,"RC"==n.ArrayRange?n.F=Tl("RC:RC",i):n.ArrayRange&&(n.F=Tl(n.ArrayRange,i),l.push([Ce(n.F),n.F]))}else for(f=0;f<l.length;++f)i.r>=l[f][0].s.r&&i.r<=l[f][0].e.r&&i.c>=l[f][0].s.c&&i.c<=l[f][0].e.c&&(n.F=l[f][1]);c.cellStyles&&(p.forEach(function(e){!h.patternType&&e.patternType&&(h.patternType=e.patternType)}),n.s=h),void 0!==n.StyleID&&(n.ixfe=n.StyleID)}(i.slice($,r.index),j,W,"comment"==p[p.length-1][0]?X:m,{c:v,r:b},B,S[v],y,Z,n):(j="",W=Iu(r[0]),$=r.index+r[0].length));break;case"cell":if("/"===r[1])if(0<K.length&&(m.c=K),(!n.sheetRows||n.sheetRows>b)&&void 0!==m.v&&(n.dense?(f[b]||(f[b]=[]),f[b][v]=m):f[be(v)+ve(b)]=m),m.HRef&&(m.l={Target:fe(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(R=v+(0|parseInt(m.MergeAcross,10)),Q=b+(0|parseInt(m.MergeDown,10)),E.push({s:{c:v,r:b},e:{c:R,r:Q}})),n.sheetStubs)if(m.MergeAcross||m.MergeDown){for(var N=v;N<=R;++N)for(var O=b;O<=Q;++O)(v<N||b<O)&&(n.dense?(f[O]||(f[O]=[]),f[O][N]={t:"z"}):f[be(N)+ve(O)]={t:"z"});v=R+1}else++v;else m.MergeAcross?v=R+1:++v;else(v=(m=function(e){var t=e.split(/\s+/),r={};if(1!==t.length){var n,i,o,s=e.match(Nu);if(s)for(o=0;o!=s.length;++o)-1===(i=(n=s[o].match(Ou))[1].indexOf(":"))?r[n[1]]=n[2].slice(1,n[2].length-1):r["xmlns:"===n[1].slice(0,6)?"xmlns"+n[1].slice(6):n[1].slice(i+1)]=n[2].slice(1,n[2].length-1)}return r}(r[0])).Index?+m.Index-1:v)<w.s.c&&(w.s.c=v),v>w.e.c&&(w.e.c=v),"/>"===r[0].slice(-2)&&++v,K=[];break;case"row":"/"===r[1]||"/>"===r[0].slice(-2)?(b<w.s.r&&(w.s.r=b),b>w.e.r&&(w.e.r=b),"/>"===r[0].slice(-2)&&(y=Iu(r[0])).Index&&(b=+y.Index-1),v=0,++b):((y=Iu(r[0])).Index&&(b=+y.Index-1),x={},"0"!=y.AutoFitHeight&&!y.Height||(x.hpx=parseInt(y.Height,10),x.hpt=Aa(x.hpx),_[b]=x),"1"==y.Hidden&&(x.hidden=!0,_[b]=x));break;case"worksheet":if("/"===r[1]){if((s=p.pop())[0]!==r[3])throw new Error("Bad state: "+s.join("|"));V.push(g),w.s.r<=w.e.r&&w.s.c<=w.e.c&&(f["!ref"]=we(w),n.sheetRows)&&n.sheetRows<=w.e.r&&(f["!fullref"]=f["!ref"],w.e.r=n.sheetRows-1,f["!ref"]=we(w)),E.length&&(f["!merges"]=E),0<S.length&&(f["!cols"]=S),0<_.length&&(f["!rows"]=_),U[g]=f}else b=v=0,p.push([r[3],!(w={s:{r:2e6,c:2e6},e:{r:0,c:0}})]),s=Iu(r[0]),g=fe(s.Name),f=n.dense?[]:{},E=[],Z=[],_=[],A.Sheets.push(ee={name:g,Hidden:0});break;case"table":if("/"===r[1]){if((s=p.pop())[0]!==r[3])throw new Error("Bad state: "+s.join("|"))}else{if("/>"==r[0].slice(-2))break;p.push([r[3],!1]),J=!(S=[])}break;case"style":"/"===r[1]?(u=B,d=C,(h=n).cellStyles&&d.Interior&&(h=d.Interior).Pattern&&(h.patternType=Oa[h.Pattern]||h.Pattern),u[d.ID]=d):C=Iu(r[0]);break;case"numberformat":C.nf=fe(Iu(r[0]).Format||"General"),Au[C.nf]&&(C.nf=Au[C.nf]);for(var I=0;392!=I&&ue[I]!=C.nf;++I);if(392==I)for(I=57;392!=I;++I)if(null==ue[I]){Ke(C.nf,I);break}break;case"column":if("table"===p[p.length-1][0]){if((a=Iu(r[0])).Hidden&&(a.hidden=!0,delete a.Hidden),a.Width&&(a.wpx=parseInt(a.Width,10)),!J&&10<a.wpx){J=!0,wa=ya;for(var re=0;re<S.length;++re)S[re]&&xa(S[re])}J&&xa(a),S[a.Index-1||S.length]=a;for(var ne=0;ne<+a.Span;++ne)S[S.length]=he(a)}break;case"namedrange":"/"!==r[1]&&(A.Names||(A.Names=[]),u={Name:(h=pe(r[0])).Name,Ref:Tl(h.RefersTo.slice(1),{r:0,c:0})},0<A.Sheets.length&&(u.Sheet=A.Sheets.length-1),A.Names.push(u));break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":break;case"font":"/>"!==r[0].slice(-2)&&("/"===r[1]?j+=i.slice(z,r.index):z=r.index+r[0].length);break;case"interior":n.cellStyles&&(C.Interior=Iu(r[0]));break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":"/>"!==r[0].slice(-2)&&("/"===r[1]?(d=Y,l=te,c=i.slice(T,r.index),d[l=(Ni=Ni||Et(Oi))[l]||l]=c):T=r.index+r[0].length);break;case"paragraphs":break;case"styles":case"workbook":if("/"===r[1]){if((s=p.pop())[0]!==r[3])throw new Error("Bad state: "+s.join("|"))}else p.push([r[3],!1]);break;case"comment":if("/"===r[1]){if((s=p.pop())[0]!==r[3])throw new Error("Bad state: "+s.join("|"));(l=X).t=l.v||"",l.t=l.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),l.v=l.w=l.ixfe=void 0,K.push(X)}else p.push([r[3],!1]),s=Iu(r[0]),X={a:s.Author};break;case"autofilter":if("/"===r[1]){if((s=p.pop())[0]!==r[3])throw new Error("Bad state: "+s.join("|"))}else"/"!==r[0].charAt(r[0].length-2)&&(c=Iu(r[0]),f["!autofilter"]={ref:Tl(c.Range).replace(/\$/g,"")},p.push([r[3],!0]));break;case"name":break;case"datavalidation":if("/"===r[1]){if((s=p.pop())[0]!==r[3])throw new Error("Bad state: "+s.join("|"))}else"/"!==r[0].charAt(r[0].length-2)&&p.push([r[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if("/"===r[1]){if((s=p.pop())[0]!==r[3])throw new Error("Bad state: "+s.join("|"))}else"/"!==r[0].charAt(r[0].length-2)&&p.push([r[3],!0]);break;case"null":break;default:if(0==p.length&&"document"==r[3])return wd(i,n);if(0==p.length&&"uof"==r[3])return wd(i,n);var M=!0;switch(p[p.length-1][0]){case"officedocumentsettings":switch(r[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:M=!1}break;case"componentoptions":switch(r[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:M=!1}break;case"excelworkbook":switch(r[3]){case"date1904":A.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:M=!1}break;case"workbookoptions":switch(r[3]){case"owcversion":case"height":case"width":break;default:M=!1}break;case"worksheetoptions":switch(r[3]){case"visible":if("/>"!==r[0].slice(-2))if("/"===r[1])switch(i.slice(T,r.index)){case"SheetHidden":ee.Hidden=1;break;case"SheetVeryHidden":ee.Hidden=2}else T=r.index+r[0].length;break;case"header":f["!margins"]||pc(f["!margins"]={},"xlml"),isNaN(+pe(r[0]).Margin)||(f["!margins"].header=+pe(r[0]).Margin);break;case"footer":f["!margins"]||pc(f["!margins"]={},"xlml"),isNaN(+pe(r[0]).Margin)||(f["!margins"].footer=+pe(r[0]).Margin);break;case"pagemargins":var k=pe(r[0]);f["!margins"]||pc(f["!margins"]={},"xlml"),isNaN(+k.Top)||(f["!margins"].top=+k.Top),isNaN(+k.Left)||(f["!margins"].left=+k.Left),isNaN(+k.Right)||(f["!margins"].right=+k.Right),isNaN(+k.Bottom)||(f["!margins"].bottom=+k.Bottom);break;case"displayrighttoleft":A.Views||(A.Views=[]),A.Views[0]||(A.Views[0]={}),A.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":break;case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;default:M=!1}break;case"pivottable":case"pivotcache":switch(r[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:M=!1}break;case"pagebreaks":switch(r[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:M=!1}break;case"autofilter":switch(r[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:M=!1}break;case"querytable":switch(r[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:M=!1}break;case"datavalidation":switch(r[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:M=!1}break;case"sorting":case"conditionalformatting":switch(r[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:M=!1}break;case"mapinfo":case"schema":case"data":switch(r[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:M=!1}break;case"smarttags":break;default:M=!1}if(!M&&!r[3].match(/!\[CDATA/)){if(!p[p.length-1][1])throw"Unrecognized tag: "+r[3]+"|"+p.join("|");if("customdocumentproperties"===p[p.length-1][0]){if("/>"!==r[0].slice(-2))if("/"===r[1]){P=D=se=oe=ie=void 0;var ie=G,oe=te,se=q,D=i.slice(T,r.index),P=D;switch((se[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":P=ge(D);break;case"i2":case"int":P=parseInt(D,10);break;case"r4":case"float":P=parseFloat(D);break;case"date":case"dateTime.tz":P=de(D);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+se[0])}ie[fe(oe)]=P}else T=(q=r).index+r[0].length}else if(n.WTF)throw"Unrecognized tag: "+r[3]+"|"+p.join("|")}}t={};return n.bookSheets||n.bookProps||(t.Sheets=U),t.SheetNames=V,t.Workbook=A,t.SSF=he(ue),t.Props=Y,t.Custprops=G,t}function Du(e,t){switch(Zd(t=t||{}),t.type||"base64"){case"base64":return ku(_e(e),t);case"binary":case"buffer":case"file":return ku(e,t);case"array":return ku(p(e),t)}}function Pu(e,t){var r,n,i,o,s,a,l,c=[];return e.Props&&c.push((r=e.Props,n=t,i=[],oe(Oi).map(function(e){for(var t=0;t<vi.length;++t)if(vi[t][1]==e)return vi[t];for(t=0;t<Ti.length;++t)if(Ti[t][1]==e)return Ti[t];throw e}).forEach(function(e){var t;null!=r[e[1]]&&(t=(n&&n.Props&&null!=n.Props[e[1]]?n.Props:r)[e[1]],"number"==typeof(t="date"===e[2]?new Date(t).toISOString().replace(/\.\d*Z/,"Z"):t)?t=String(t):!0===t||!1===t?t=t?"1":"0":t instanceof Date&&(t=new Date(t).toISOString().replace(/\.\d*Z/,"")),i.push(Sr(Oi[e[1]]||e[1],t)))}),T("DocumentProperties",i.join(""),{xmlns:Ir.o}))),e.Custprops&&c.push((o=e.Props,s=e.Custprops,a=["Worksheets","SheetNames"],t="CustomDocumentProperties",l=[],o&&oe(o).forEach(function(e){if(Object.prototype.hasOwnProperty.call(o,e)){for(var t=0;t<vi.length;++t)if(e==vi[t][1])return;for(t=0;t<Ti.length;++t)if(e==Ti[t][1])return;for(t=0;t<a.length;++t)if(e==a[t])return;var r="string",n="number"==typeof(n=o[e])?(r="float",String(n)):!0===n||!1===n?(r="boolean",n?"1":"0"):String(n);l.push(T(ir(e),n,{"dt:dt":r}))}}),s&&oe(s).forEach(function(e){var t,r;!Object.prototype.hasOwnProperty.call(s,e)||o&&Object.prototype.hasOwnProperty.call(o,e)||(t="string",r="number"==typeof(r=s[e])?(t="float",String(r)):!0===r||!1===r?(t="boolean",r?"1":"0"):r instanceof Date?(t="dateTime.tz",r.toISOString()):String(r),l.push(T(ir(e),r,{"dt:dt":t})))}),"<"+t+' xmlns="'+Ir.o+'">'+l.join("")+"</"+t+">")),c.join("")}function Lu(e){return T("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+xl(e.Ref,{r:0,c:0})})}function Fu(e,t,r,n,i,o,s){if(!e||null==e.v&&null==e.f)return"";var a={};if(e.f&&(a["ss:Formula"]="="+E(xl(e.f,s))),e.F&&e.F.slice(0,t.length)==t&&(t=W(e.F.slice(t.length+1)),a["ss:ArrayRange"]="RC:R"+(t.r==s.r?"":"["+(t.r-s.r)+"]")+"C"+(t.c==s.c?"":"["+(t.c-s.c)+"]")),e.l&&e.l.Target&&(a["ss:HRef"]=E(e.l.Target),e.l.Tooltip)&&(a["x:HRefScreenTip"]=E(e.l.Tooltip)),r["!merges"])for(var l=r["!merges"],c=0;c!=l.length;++c)l[c].s.c==s.c&&l[c].s.r==s.r&&(l[c].e.c>l[c].s.c&&(a["ss:MergeAcross"]=l[c].e.c-l[c].s.c),l[c].e.r>l[c].s.r)&&(a["ss:MergeDown"]=l[c].e.r-l[c].s.r);var u="",d="";switch(e.t){case"z":if(n.sheetStubs)break;return"";case"n":u="Number",d=String(e.v);break;case"b":u="Boolean",d=e.v?"1":"0";break;case"e":u="Error",d=si[e.v];break;case"d":u="DateTime",d=new Date(e.v).toISOString(),null==e.z&&(e.z=e.z||ue[14]);break;case"s":u="String",d=((e.v||"")+"").replace(rr,function(e){return tr[e]}).replace(or,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}t=fc(n.cellXfs,e,n),a["ss:StyleID"]="s"+(21+t),a["ss:Index"]=s.c+1,r=null!=e.v?d:"",t="z"==e.t?"":'<Data ss:Type="'+u+'">'+r+"</Data>";return 0<(e.c||[]).length&&(t+=e.c.map(function(e){var t=T("ss:Data",(e.t||"").replace(/(\r\n|[\r\n])/g,"&#10;"),{xmlns:"http://www.w3.org/TR/REC-html40"});return T("Comment",t,{"ss:Author":e.a})}).join("")),T("Cell",t,a)}function Hu(e,t){if(!e["!ref"])return"";for(var r,n,i=Ce(e["!ref"]),o=e["!merges"]||[],s=0,a=[],l=(e["!cols"]&&e["!cols"].forEach(function(e,t){xa(e);var r=!!e.width,n=hc(t,e),t={"ss:Index":t+1};r&&(t["ss:Width"]=Ca(n.width)),e.hidden&&(t["ss:Hidden"]="1"),a.push(T("Column",null,t))}),Array.isArray(e)),c=i.s.r;c<=i.e.r;++c){for(var u=[(r=c,n=(e["!rows"]||[])[c],r='<Row ss:Index="'+(r+1)+'"',n&&(n.hpt&&!n.hpx&&(n.hpx=Na(n.hpt)),n.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+n.hpx+'"'),n.hidden)&&(r+=' ss:Hidden="1"'),r+">")],d=i.s.c;d<=i.e.c;++d){for(var h,p,f,g=!1,s=0;s!=o.length;++s)if(!(o[s].s.c>d||o[s].s.r>c||o[s].e.c<d||o[s].e.r<c)){o[s].s.c==d&&o[s].s.r==c||(g=!0);break}g||(p=se(h={r:c,c:d}),f=l?(e[c]||[])[d]:e[p],u.push(Fu(f,p,e,t,0,0,h)))}u.push("</Row>"),2<u.length&&a.push(u.join(""))}return a.join("")}function Uu(e,t,r){var n=[],i=r.SheetNames[e],i=r.Sheets[i],o=i?function(e,t,r){if(!e)return"";if(!((r||{}).Workbook||{}).Names)return"";for(var n=r.Workbook.Names,i=[],o=0;o<n.length;++o){var s=n[o];s.Sheet!=t||s.Name.match(/^_xlfn\./)||i.push(Lu(s))}return i.join("")}(i,e,r):"";return 0<o.length&&n.push("<Names>"+o+"</Names>"),0<(o=i?Hu(i,t):"").length&&n.push("<Table>"+o+"</Table>"),n.push(function(t,e,r){if(!t)return"";var n=[];if(t["!margins"]&&(n.push("<PageSetup>"),t["!margins"].header&&n.push(T("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&n.push(T("Footer",null,{"x:Margin":t["!margins"].footer})),n.push(T("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),n.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[e])if(r.Workbook.Sheets[e].Hidden)n.push(T("Visible",1==r.Workbook.Sheets[e].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<e&&(!r.Workbook.Sheets[i]||r.Workbook.Sheets[i].Hidden);++i);i==e&&n.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),t["!protect"]&&(n.push(Sr("ProtectContents","True")),t["!protect"].objects&&n.push(Sr("ProtectObjects","True")),t["!protect"].scenarios&&n.push(Sr("ProtectScenarios","True")),null==t["!protect"].selectLockedCells||t["!protect"].selectLockedCells?null==t["!protect"].selectUnlockedCells||t["!protect"].selectUnlockedCells||n.push(Sr("EnableSelection","UnlockedCells")):n.push(Sr("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(e){t["!protect"][e[0]]&&n.push("<"+e[1]+"/>")})),0==n.length?"":T("WorksheetOptions",n.join(""),{xmlns:Ir.x})}(i,e,r)),n.join("")}function Vu(e,t){t=t||{},e.SSF||(e.SSF=he(ue)),e.SSF&&(Je(),Xe(e.SSF),t.revssf=Tt(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],fc(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Pu(e,t)),r.push(""),r.push(""),r.push("");for(var n,i=0;i<e.SheetNames.length;++i)r.push(T("Worksheet",Uu(i,t,e),{"ss:Name":E(e.SheetNames[i])}));return r[2]=(n=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'],t.cellXfs.forEach(function(e,t){var r=[],e=(r.push(T("NumberFormat",null,{"ss:Format":E(ue[e.numFmtId])})),{"ss:ID":"s"+(21+t)});n.push(T("Style",r.join(""),e))}),T("Styles",n.join(""))),r[3]=function(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var i=t[n];null!=i.Sheet||i.Name.match(/^_xlfn\./)||r.push(Lu(i))}return T("Names",r.join(""))}(e),C+T("Workbook",r.join(""),{xmlns:Ir.ss,"xmlns:o":Ir.o,"xmlns:x":Ir.x,"xmlns:ss":Ir.ss,"xmlns:dt":Ir.dt,"xmlns:html":Ir.html})}function Wu(e){var t,e=e.content;e.l=28,e._R(0,"lpstr-ansi"),Zn(e,1),e.length-e.l<=4||0==(t=e._R(4))||40<t||(e.l-=4,e._R(0,"lpstr-ansi"),e.length-e.l<=4)||1907505652!==(t=e._R(4))||(Zn(e,2),0==(t=e._R(4)))||40<t||(e.l-=4,e._R(0,"lpwstr"))}var $u=[60,1084,2066,2165,2175];function Bu(e,t,r){if("z"!==e.t&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=ue[n])}catch(e){if(t.WTF)throw e}if(!t||!1!==t.cellText)try{"e"===e.t?e.w=e.w||si[e.v]:0===n||"General"==n?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=Ae(e.v):e.w=Ne(e.v):e.w=qe(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(e){if(t.WTF)throw e}t.cellDates&&n&&"n"==e.t&&Be(ue[n]||String(n))&&(r=z(e.v))&&(e.t="d",e.v=new Date(r.y,r.m-1,r.d,r.H,r.M,r.S,r.u))}}function ju(e,t,r){return{v:e,ixfe:t,t:r}}function zu(e,t){function r(e,t,r){if(!(1<T||r.sheetRows&&e.r>=r.sheetRows)){var n,i,o;if(r.cellStyles&&t.XF&&t.XF.data&&(i=r,o=(n=t).XF.data)&&o.patternType&&i&&i.cellStyles&&(n.s={},n.s.patternType=o.patternType,(i=ga(j(o.icvFore)))&&(n.s.fgColor={rgb:i}),i=ga(j(o.icvBack)))&&(n.s.bgColor={rgb:i}),delete t.ixfe,delete t.XF,V=se(L=e),c&&c.s&&c.e||(c={s:{r:0,c:0},e:{r:0,c:0}}),e.r<c.s.r&&(c.s.r=e.r),e.c<c.s.c&&(c.s.c=e.c),e.r+1>c.e.r&&(c.e.r=e.r+1),e.c+1>c.e.c&&(c.e.c=e.c+1),r.cellFormula&&t.f)for(var s=0;s<f.length;++s)if(!(f[s][0].s.c>e.c||f[s][0].s.r>e.r||f[s][0].e.c<e.c||f[s][0].e.r<e.r)){t.F=we(f[s][0]),f[s][0].s.c==e.c&&f[s][0].s.r==e.r||delete t.f,t.f&&(t.f=""+Kl(f[s][1],0,e,E,y));break}r.dense?(a[e.r]||(a[e.r]=[]),a[e.r][e.c]=t):a[V]=t}}for(var L,n,i,F,H,o,s={opts:{}},U={},a=(null!=le&&null==t.dense&&(t.dense=le),t.dense?[]:{}),l={},c={},u=null,d=[],h="",p={},V="",W={},f=[],g=[],$=[],m={Sheets:[],WBProps:{date1904:!1},Views:[{}]},B={},j=function(e){return!(e<8)&&e<64&&$[e-8]||oi[e]},y={enc:!1,sbcch:0,snames:[],sharedf:W,arrayf:f,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf},v=(t.password&&(y.password=t.password),[]),b=[],w=[],C=[],z=!1,E=[],Y=(E.SheetNames=y.snames,E.sharedf=y.sharedf,E.arrayf=y.arrayf,E.names=[],E.XTI=[],0),T=0,S=0,_=[],G=[],q=(Ee(y.codepage=1200),!1);e.l<e.length-1;){var K=e.l,x=e._R(2);if(0===x&&10===Y)break;var R=e.l===e.length?0:e._R(2),A=Xu[x];if(A&&A.f){if(t.bookSheets&&133===Y&&133!==x)break;if(Y=x,2===A.r||12==A.r){var X=e._R(2);if(R-=2,!y.enc&&X!==x&&((255&X)<<8|X>>8)!==x)throw new Error("rt mismatch: "+X+"!="+x);12==A.r&&(e.l+=10,R-=10)}var N,J,O,I={},I=10===x?A.f(e,R,y):function(e,t,r,n,i){var o=n,s=[],a=r.slice(r.l,r.l+o);if(i&&i.enc&&i.enc.insitu&&0<a.length)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:i.enc.insitu(a)}s.push(a),r.l+=o;for(var l=en(r,r.l),c=Xu[l],u=0;null!=c&&-1<$u.indexOf(l);)o=en(r,r.l+2),u=r.l+4,2066==l?u+=4:2165!=l&&2175!=l||(u+=12),a=r.slice(u,r.l+4+o),s.push(a),r.l+=4+o,c=Xu[l=en(r,r.l)];var d=Re(s),h=(hn(d,0),0);d.lens=[];for(var p=0;p<s.length;++p)d.lens.push(h),h+=s[p].length;if(d.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+d.length+" < "+n;return t.f(d,d.length,i)}(x,A,e,R,y);if(0!=T||-1!==[9,521,1033,2057].indexOf(Y))switch(x){case 34:s.opts.Date1904=m.WBProps.date1904=I;break;case 134:s.opts.WriteProtect=!0;break;case 47:if(y.enc||(e.l=0),y.enc=I,!t.password)throw new Error("File is password-protected");if(null==I.valid)throw new Error("Encryption scheme unsupported");if(I.valid)break;throw new Error("Password is incorrect");case 92:y.lastuser=I;break;case 66:var M=Number(I);switch(M){case 21010:M=1200;break;case 32768:M=1e4;break;case 32769:M=1252}Ee(y.codepage=M),q=!0;break;case 317:y.rrtabid=I;break;case 25:y.winlocked=I;break;case 439:s.opts.RefreshAll=I;break;case 12:s.opts.CalcCount=I;break;case 16:s.opts.CalcDelta=I;break;case 17:s.opts.CalcIter=I;break;case 13:s.opts.CalcMode=I;break;case 14:s.opts.CalcPrecision=I;break;case 95:s.opts.CalcSaveRecalc=I;break;case 15:y.CalcRefMode=I;break;case 2211:s.opts.FullCalc=I;break;case 129:I.fDialog&&(a["!type"]="dialog"),I.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),I.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:g.push(I);break;case 430:E.push([I]),E[E.length-1].XTI=[];break;case 35:case 547:E[E.length-1].push(I);break;case 24:case 536:o={Name:I.Name,Ref:Kl(I.rgce,0,null,E,y)},0<I.itab&&(o.Sheet=I.itab-1),E.names.push(o),E[0]||(E[0]=[],E[0].XTI=[]),E[E.length-1].push(I),"_xlnm._FilterDatabase"==I.Name&&0<I.itab&&I.rgce&&I.rgce[0]&&I.rgce[0][0]&&"PtgArea3d"==I.rgce[0][0][0]&&(G[I.itab-1]={ref:we(I.rgce[0][0][1][2])});break;case 22:y.ExternCount=I;break;case 23:0==E.length&&(E[0]=[],E[0].XTI=[]),E[E.length-1].XTI=E[E.length-1].XTI.concat(I),E.XTI=E.XTI.concat(I);break;case 2196:y.biff<8||null!=o&&(o.Comment=I[1]);break;case 18:a["!protect"]=I;break;case 19:0!==I&&y.WTF&&console.error("Password verifier: "+I);break;case 133:l[I.pos]=I,y.snames.push(I.name);break;case 10:--T||(c.e&&(0<c.e.r&&0<c.e.c&&(c.e.r--,c.e.c--,a["!ref"]=we(c),t.sheetRows&&t.sheetRows<=c.e.r&&(N=c.e.r,c.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=we(c),c.e.r=N),c.e.r++,c.e.c++),0<v.length&&(a["!merges"]=v),0<b.length&&(a["!objects"]=b),0<w.length&&(a["!cols"]=w),0<C.length&&(a["!rows"]=C),m.Sheets.push(B)),""===h?p=a:U[h]=a,a=t.dense?[]:{});break;case 9:case 521:case 1033:case 2057:8===y.biff&&(y.biff={9:2,521:3,1033:4}[x]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[I.BIFFVer]||8),y.biffguess=0==I.BIFFVer,0==I.BIFFVer&&4096==I.dt&&(y.biff=5,q=!0,Ee(y.codepage=28591)),8==y.biff&&0==I.BIFFVer&&16==I.dt&&(y.biff=2),T++||(a=t.dense?[]:{},y.biff<8&&!q&&(q=!0,Ee(y.codepage=t.codepage||1252)),y.biff<5||0==I.BIFFVer&&4096==I.dt?(""===h&&(h="Sheet1"),c={s:{r:0,c:0},e:{r:0,c:0}},N={pos:e.l-R,name:h},l[N.pos]=N,y.snames.push(h)):h=(l[K]||{name:""}).name,32==I.dt&&(a["!type"]="chart"),64==I.dt&&(a["!type"]="macro"),v=[],b=[],y.arrayf=f=[],w=[],z=!(C=[]),B={Hidden:(l[K]||{hs:0}).hs,name:h});break;case 515:case 3:case 2:"chart"==a["!type"]&&(t.dense?(a[I.r]||[])[I.c]:a[se({c:I.c,r:I.r})])&&++I.c,D={ixfe:I.ixfe,XF:g[I.ixfe]||{},v:I.val,t:"n"},0<S&&(D.z=_[D.ixfe>>8&63]),Bu(D,t,s.opts.Date1904),r({c:I.c,r:I.r},D,t);break;case 5:case 517:D={ixfe:I.ixfe,XF:g[I.ixfe],v:I.val,t:I.t},0<S&&(D.z=_[D.ixfe>>8&63]),Bu(D,t,s.opts.Date1904),r({c:I.c,r:I.r},D,t);break;case 638:D={ixfe:I.ixfe,XF:g[I.ixfe],v:I.rknum,t:"n"},0<S&&(D.z=_[D.ixfe>>8&63]),Bu(D,t,s.opts.Date1904),r({c:I.c,r:I.r},D,t);break;case 189:for(var k=I.c;k<=I.C;++k){var Z=I.rkrec[k-I.c][0],D={ixfe:Z,XF:g[Z],v:I.rkrec[k-I.c][1],t:"n"};0<S&&(D.z=_[D.ixfe>>8&63]),Bu(D,t,s.opts.Date1904),r({c:k,r:I.r},D,t)}break;case 6:case 518:case 1030:"String"==I.val?u=I:((D=ju(I.val,I.cell.ixfe,I.tt)).XF=g[D.ixfe],t.cellFormula&&(!((O=I.formula)&&O[0]&&O[0][0]&&"PtgExp"==O[0][0][0])||W[J=se({r:Q=O[0][0][1][0],c:O=O[0][0][1][1]})]?D.f=""+Kl(I.formula,0,I.cell,E,y):D.F=((t.dense?(a[Q]||[])[O]:a[J])||{}).F),0<S&&(D.z=_[D.ixfe>>8&63]),Bu(D,t,s.opts.Date1904),r(I.cell,D,t),u=I);break;case 7:case 519:if(!u)throw new Error("String record expects Formula");(D=ju(u.val=I,u.cell.ixfe,"s")).XF=g[D.ixfe],t.cellFormula&&(D.f=""+Kl(u.formula,0,u.cell,E,y)),0<S&&(D.z=_[D.ixfe>>8&63]),Bu(D,t,s.opts.Date1904),r(u.cell,D,t),u=null;break;case 33:case 545:f.push(I);var Q=se(I[0].s),P=t.dense?(a[I[0].s.r]||[])[I[0].s.c]:a[Q];if(t.cellFormula&&P){if(!u)break;if(!Q||!P)break;P.f=""+Kl(I[1],0,I[0],E,y),P.F=we(I[0])}break;case 1212:if(t.cellFormula&&V){if(!u)break;W[se(u.cell)]=I[0],((P=t.dense?(a[u.cell.r]||[])[u.cell.c]:a[se(u.cell)])||{}).f=""+Kl(I[0],0,L,E,y)}break;case 253:D=ju(d[I.isst].t,I.ixfe,"s"),d[I.isst].h&&(D.h=d[I.isst].h),D.XF=g[D.ixfe],0<S&&(D.z=_[D.ixfe>>8&63]),Bu(D,t,s.opts.Date1904),r({c:I.c,r:I.r},D,t);break;case 513:t.sheetStubs&&(D={ixfe:I.ixfe,XF:g[I.ixfe],t:"z"},0<S&&(D.z=_[D.ixfe>>8&63]),Bu(D,t,s.opts.Date1904),r({c:I.c,r:I.r},D,t));break;case 190:if(t.sheetStubs)for(var ee=I.c;ee<=I.C;++ee){var te=I.ixfe[ee-I.c];D={ixfe:te,XF:g[te],t:"z"},0<S&&(D.z=_[D.ixfe>>8&63]),Bu(D,t,s.opts.Date1904),r({c:ee,r:I.r},D,t)}break;case 214:case 516:case 4:(D=ju(I.val,I.ixfe,"s")).XF=g[D.ixfe],0<S&&(D.z=_[D.ixfe>>8&63]),Bu(D,t,s.opts.Date1904),r({c:I.c,r:I.r},D,t);break;case 0:case 512:1===T&&(c=I);break;case 252:d=I;break;case 1054:if(4==y.biff){_[S++]=I[1];for(var re=0;re<S+163&&ue[re]!=I[1];++re);163<=re&&Ke(I[1],S+163)}else Ke(I[1],I[0]);break;case 30:_[S++]=I;for(var ne=0;ne<S+163&&ue[ne]!=I;++ne);163<=ne&&Ke(I,S+163);break;case 229:v=v.concat(I);break;case 93:b[I.cmo[0]]=y.lastobj=I;break;case 438:y.lastobj.TxO=I;break;case 127:y.lastobj.ImData=I;break;case 440:for(i=I[0].s.r;i<=I[0].e.r;++i)for(n=I[0].s.c;n<=I[0].e.c;++n)(P=t.dense?(a[i]||[])[n]:a[se({c:n,r:i})])&&(P.l=I[1]);break;case 2048:for(i=I[0].s.r;i<=I[0].e.r;++i)for(n=I[0].s.c;n<=I[0].e.c;++n)(P=t.dense?(a[i]||[])[n]:a[se({c:n,r:i})])&&P.l&&(P.l.Tooltip=I[1]);break;case 28:y.biff<=5&&2<=y.biff||(P=t.dense?(a[I[0].r]||[])[I[0].c]:a[se(I[0])],O=b[I[2]],P||(P=t.dense?(a[I[0].r]||(a[I[0].r]=[]),a[I[0].r][I[0].c]={t:"z"}):a[se(I[0])]={t:"z"},c.e.r=Math.max(c.e.r,I[0].r),c.s.r=Math.min(c.s.r,I[0].r),c.e.c=Math.max(c.e.c,I[0].c),c.s.c=Math.min(c.s.c,I[0].c)),P.c||(P.c=[]),J={a:I[1],t:O.TxO.t},P.c.push(J));break;case 2173:I.ixfe,I.ext.forEach(function(e){e[0]});break;case 125:if(y.cellStyles)for(;I.e>=I.s;)w[I.e--]={width:I.w/256,level:I.level||0,hidden:!!(1&I.flags)},z||(z=!0,_a(I.w/256)),xa(w[I.e+1]);break;case 520:var ie={};null!=I.level&&((C[I.r]=ie).level=I.level),I.hidden&&((C[I.r]=ie).hidden=!0),I.hpt&&((C[I.r]=ie).hpt=I.hpt,ie.hpx=Na(I.hpt));break;case 38:case 39:case 40:case 41:a["!margins"]||pc(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[x]]=I;break;case 161:a["!margins"]||pc(a["!margins"]={}),a["!margins"].header=I.header,a["!margins"].footer=I.footer;break;case 574:I.RTL&&(m.Views[0].RTL=!0);break;case 146:$=I;break;case 2198:H=I;break;case 140:F=I;break;case 442:h?B.CodeName=I||B.name:m.WBProps.CodeName=I||"ThisWorkbook"}}else A||console.error("Missing Info for XLS Record 0x"+x.toString(16)),e.l+=R}return s.SheetNames=oe(l).sort(function(e,t){return Number(e)-Number(t)}).map(function(e){return l[e].name}),t.bookSheets||(s.Sheets=U),!s.SheetNames.length&&p["!ref"]?(s.SheetNames.push("Sheet1"),s.Sheets&&(s.Sheets.Sheet1=p)):s.Preamble=p,s.Sheets&&G.forEach(function(e,t){s.Sheets[s.SheetNames[t]]["!autofilter"]=e}),s.Strings=d,s.SSF=he(ue),y.enc&&(s.Encryption=y.enc),H&&(s.Themes=H),s.Metadata={},void 0!==F&&(s.Metadata.Country=F),0<E.names.length&&(m.Names=E.names),s.Workbook=m,s}var Yu={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Gu(e,t){var r,n,i;if(Zd(t=t||{}),m(),t.codepage&&f(t.codepage),e.FullPaths){if(X.find(e,"/encryption"))throw new Error("File is password-protected");o=X.find(e,"!CompObj"),s=X.find(e,"/Workbook")||X.find(e,"/Book")}else{switch(t.type){case"base64":e=xe(_e(e));break;case"binary":e=xe(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e))}hn(e,0),s={content:e}}if(o&&Wu(o),t.bookProps&&!t.bookSheets)r={};else{var o=ce?"buffer":"array";if(s&&s.content)r=zu(s.content,t);else{if(!((s=X.find(e,"PerfectOffice_MAIN"))&&s.content||(s=X.find(e,"NativeContent_MAIN"))&&s.content))throw(s=X.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r=ws.to_workbook(s.content,(t.type=o,t))}t.bookVBA&&e.FullPaths&&X.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(r.vbaraw=(n=e,i=X.utils.cfb_new({root:"R"}),n.FullPaths.forEach(function(e,t){"/"!==e.slice(-1)&&e.match(/_VBA_PROJECT_CUR/)&&(e=e.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,""),X.utils.cfb_add(i,e,n.FileIndex[t].content))}),X.write(i)))}var s={};if(e.FullPaths){var o=e,a=s,l=t,c=X.find(o,"/!DocumentSummaryInformation");if(c&&0<c.size)try{var u,d=ji(c,ti,Yu.DSI);for(u in d)a[u]=d[u]}catch(e){if(l.WTF)throw e}if((c=X.find(o,"/!SummaryInformation"))&&0<c.size)try{var h,p=ji(c,ri,Yu.SI);for(h in p)null==a[h]&&(a[h]=p[h])}catch(e){if(l.WTF)throw e}a.HeadingPairs&&a.TitlesOfParts&&(_i(a.HeadingPairs,a.TitlesOfParts,a,l),delete a.HeadingPairs,delete a.TitlesOfParts)}return r.Props=r.Custprops=s,t.bookFiles&&(r.cfb=e),r}function qu(e,t){var r,n,i=t||{},t=X.utils.cfb_new({root:"R"}),o="/Workbook";switch(i.bookType||"xls"){case"xls":i.bookType="biff8";case"xla":i.bookType||(i.bookType="xla");case"biff8":o="/Workbook",i.biff=8;break;case"biff5":o="/Book",i.biff=5;break;default:throw new Error("invalid type "+i.bookType+" for XLS CFB")}if(X.utils.cfb_add(t,o,ad(e,i)),8==i.biff&&(e.Props||e.Custprops)){var s,a=e,l=t,c=[],u=[],d=[],h=0,p=Ct(ti,"n"),f=Ct(ri,"n");if(a.Props)for(s=oe(a.Props),h=0;h<s.length;++h)(Object.prototype.hasOwnProperty.call(p,s[h])?c:Object.prototype.hasOwnProperty.call(f,s[h])?u:d).push([s[h],a.Props[s[h]]]);if(a.Custprops)for(s=oe(a.Custprops),h=0;h<s.length;++h)Object.prototype.hasOwnProperty.call(a.Props||{},s[h])||(Object.prototype.hasOwnProperty.call(p,s[h])?c:Object.prototype.hasOwnProperty.call(f,s[h])?u:d).push([s[h],a.Custprops[s[h]]]);for(var g=[],h=0;h<d.length;++h)-1<$i.indexOf(d[h][0])||-1<Si.indexOf(d[h][0])||null!=d[h][1]&&g.push(d[h]);u.length&&X.utils.cfb_add(l,"/SummaryInformation",zi(u,Yu.SI,f,ri)),(c.length||g.length)&&X.utils.cfb_add(l,"/DocumentSummaryInformation",zi(c,Yu.DSI,p,ti,g.length?g:null,Yu.UDI))}return 8==i.biff&&e.vbaraw&&(r=t,(n=X.read(e.vbaraw,{type:"string"==typeof e.vbaraw?"binary":"buffer"})).FullPaths.forEach(function(e,t){0!=t&&"/"!==(e=e.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/")).slice(-1)&&X.utils.cfb_add(r,e,n.FileIndex[t].content)})),t}var Ku={0:{f:function(e,t){var r={},t=e.l+t,n=(r.r=e._R(4),e.l+=4,e._R(2)),i=(e.l+=1,e._R(1));return e.l=t,7&i&&(r.level=7&i),16&i&&(r.hidden=!0),32&i&&(r.hpt=n/20),r}},1:{f:function(e){return[kn(e)]}},2:{f:function(e){return[kn(e),jn(e),"n"]}},3:{f:function(e){return[kn(e),e._R(1),"e"]}},4:{f:function(e){return[kn(e),e._R(1),"b"]}},5:{f:function(e){return[kn(e),Kn(e),"n"]}},6:{f:function(e){return[kn(e),Nn(e),"str"]}},7:{f:function(e){return[kn(e),e._R(4),"s"]}},8:{f:function(e,t,r){var n,t=e.l+t,i=kn(e),o=(i.r=r["!row"],Nn(e)),o=[i,o,"str"];return r.cellFormula?(e.l+=2,n=ec(e,t-e.l,r),o[3]=Kl(n,0,i,r.supbooks,r)):e.l=t,o}},9:{f:function(e,t,r){var n,t=e.l+t,i=kn(e),o=(i.r=r["!row"],Kn(e)),o=[i,o,"n"];return r.cellFormula?(e.l+=2,n=ec(e,t-e.l,r),o[3]=Kl(n,0,i,r.supbooks,r)):e.l=t,o}},10:{f:function(e,t,r){var n,t=e.l+t,i=kn(e),o=(i.r=r["!row"],e._R(1)),o=[i,o,"b"];return r.cellFormula?(e.l+=2,n=ec(e,t-e.l,r),o[3]=Kl(n,0,i,r.supbooks,r)):e.l=t,o}},11:{f:function(e,t,r){var n,t=e.l+t,i=kn(e),o=(i.r=r["!row"],e._R(1)),o=[i,o,"e"];return r.cellFormula?(e.l+=2,n=ec(e,t-e.l,r),o[3]=Kl(n,0,i,r.supbooks,r)):e.l=t,o}},12:{f:function(e){return[Pn(e)]}},13:{f:function(e){return[Pn(e),jn(e),"n"]}},14:{f:function(e){return[Pn(e),e._R(1),"e"]}},15:{f:function(e){return[Pn(e),e._R(1),"b"]}},16:{f:jc},17:{f:function(e){return[Pn(e),Nn(e),"str"]}},18:{f:function(e){return[Pn(e),e._R(4),"s"]}},19:{f:In},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(e,t,r){var t=e.l+t,n=(e.l+=4,e.l+=1,e._R(4)),i=Wn(e),r=tc(e,0,r),o=Un(e),e=(e.l=t,{Name:i,Ptg:r});return n<268435455&&(e.Sheet=n),o&&(e.Comment=o),e}},40:{},42:{},43:{f:function(e,t,r){var n={};switch(n.sz=e._R(2)/20,o=(i=e)._R(1),i.l++,(i={fBold:1&o,fItalic:2&o,fUnderline:4&o,fStrikeout:8&o,fOutline:16&o,fShadow:32&o,fCondense:64&o,fExtend:128&o}).fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1),700===e._R(2)&&(n.bold=1),e._R(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript"}var i,o=e._R(1);switch(0!=o&&(n.underline=o),0<(i=e._R(1))&&(n.family=i),0<(o=e._R(1))&&(n.charset=o),e.l++,n.color=function(e){var t={},r=e._R(1)>>>1,n=e._R(1),i=e._R(2,"i"),o=e._R(1),s=e._R(1),a=e._R(1);switch(e.l++,r){case 0:t.auto=1;break;case 1:var l=oi[t.index=n];l&&(t.rgb=ga(l));break;case 2:t.rgb=ga([o,s,a]);break;case 3:t.theme=n}return 0!=i&&(t.tint=0<i?i/32767:i/32768),t}(e),e._R(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor"}return n.name=Nn(e),n}},44:{f:function(e,t){return[e._R(2),Nn(e)]}},45:{f:Ba},46:{f:Ga},47:{f:function(e,t){var t=e.l+t,r=e._R(2),n=e._R(2);return e.l=t,{ixfe:r,numFmtId:n}}},48:{},49:{f:function(e){return e._R(4,"i")}},50:{},51:{f:function(e){for(var t=[],r=e._R(4);0<r--;)t.push([e._R(4),e._R(4)]);return t}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:ko},62:{f:function(e){return[kn(e),In(e),"is"]}},63:{f:function(e){var t={},r=(t.i=e._R(4),{});return r.r=e._R(4),r.c=e._R(4),t.r=se(r),2&(r=e._R(1))&&(t.l="1"),8&r&&(t.a="1"),t}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:pn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(e){var t=e._R(2);return e.l+=28,{RTL:32&t}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(e,t){var r={},n=e[e.l];return++e.l,r.above=!(64&n),r.left=!(128&n),e.l+=18,r.name=Fn(e,t-19),r}},148:{f:$c,p:16},151:{f:function(){}},152:{},153:{f:function(e,t){var r={},n=e._R(4);return r.defaultThemeVersion=e._R(4),0<(t=8<t?Nn(e):"").length&&(r.CodeName=t),r.autoCompressPictures=!!(65536&n),r.backupFile=!!(64&n),r.checkCompatibility=!!(4096&n),r.date1904=!!(1&n),r.filterPrivacy=!!(8&n),r.hidePivotFieldList=!!(1024&n),r.promptedSolutions=!!(16&n),r.publishItems=!!(2048&n),r.refreshAllConnections=!!(262144&n),r.saveExternalLinkValues=!!(128&n),r.showBorderUnselectedTables=!!(4&n),r.showInkAnnotation=!!(32&n),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(32768&n),r.updateLinks=["userSet","never","always"][n>>8&3],r}},154:{},155:{},156:{f:function(e,t){var r={};return r.Hidden=e._R(4),r.iTabID=e._R(4),r.strRelID=$n(e,t-8),r.name=Nn(e),r}},157:{},158:{},159:{T:1,f:function(e){return[e._R(4),e._R(4)]}},160:{T:-1},161:{T:1,f:Gn},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:zc},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(e,t){return{flags:e._R(4),version:e._R(4),name:Nn(e)}}},336:{T:-1},337:{f:function(e){return e.l+=4,0!=e._R(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:$n},357:{},358:{},359:{},360:{T:1},361:{},362:{f:No},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(e,t,r){var t=e.l+t,n=Yn(e),i=e._R(1);return(n=[n])[2]=i,r.cellFormula?(i=Ql(e,t-e.l,r),n[1]=i):e.l=t,n}},427:{f:function(e,t,r){var t=e.l+t,n=[Gn(e,16)];return r.cellFormula&&(r=rc(e,t-e.l,r),n[1]=r),e.l=t,n}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(t){var r={};return Gc.forEach(function(e){r[e]=Kn(t)}),r}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(e,t){var t=e.l+t,r=Gn(e,16),n=Un(e),i=Nn(e),o=Nn(e),s=Nn(e),e=(e.l=t,{rfx:r,relId:n,loc:i,display:s});return o&&(e.Tooltip=o),e}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:$n},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:yl},633:{T:1},634:{T:-1},635:{T:1,f:function(e){var t={},r=(t.iauthor=e._R(4),Gn(e,16));return t.rfx=r.s,t.ref=se(r.s),e.l+=16,t}},636:{T:-1},637:{f:e},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(e,t){return e.l+=10,{name:Nn(e)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Xu={6:{f:Xl},10:{f:Yi},12:{f:d},13:{f:d},14:{f:y},15:{f:y},16:{f:Kn},17:{f:y},18:{f:y},19:{f:d},20:{f:_o},21:{f:_o},23:{f:No},24:{f:Ao},25:{f:y},26:{},27:{},28:{f:function(e,t,r){var n,i,o,s,a;if(!(r.biff<8))return n=e._R(2),i=e._R(2),o=e._R(2),s=e._R(2),a=eo(e,0,r),r.biff<8&&e._R(1),[{r:n,c:i},a,s,o]}},29:{},34:{f:y},35:{f:xo},38:{f:Kn},39:{f:Kn},40:{f:Kn},41:{f:Kn},42:{f:y},43:{f:y},47:{f:function(e,t,r){var n={Type:8<=r.biff?e._R(2):0};return n.Type?da(e,t-2,n):(t=e,r.biff,e=r,r=n,t={key:d(t),verificationBytes:d(t)},e.password&&(t.verifier=na(e.password)),r.valid=t.verificationBytes===t.verifier,r.valid&&(r.insitu=ua(e.password))),n}},49:{f:function(e,t,r){var n={dyHeight:e._R(2),fl:e._R(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10}return n.name=Ji(e,0,r),n}},51:{f:d},60:{},61:{f:function(e){return{Pos:[e._R(2),e._R(2)],Dim:[e._R(2),e._R(2)],Flags:e._R(2),CurTab:e._R(2),FirstTab:e._R(2),Selected:e._R(2),TabRatio:e._R(2)}}},64:{f:y},65:{f:function(){}},66:{f:d},77:{},80:{},81:{},82:{},85:{f:d},89:{},90:{},91:{},92:{f:function(e,t,r){var n;return r.enc?(e.l+=t,""):(n=e.l,r=eo(e,0,r),e._R(t+n-e.l),r)}},93:{f:function(e,t,r){var n,i,o,s,a,l;return r&&r.biff<8?(n=t,r=r,(l=e).l+=4,i=l._R(2),o=l._R(2),s=l._R(2),l.l+=2,l.l+=2,l.l+=2,l.l+=2,l.l+=2,l.l+=2,l.l+=2,l.l+=2,l.l+=2,l.l+=6,n-=36,(a=[]).push((Io[i]||pn)(l,n,r)),{cmo:[o,i,s],ft:a}):{cmo:l=go(e),ft:function(t,e){for(var r=t.l+e,n=[];t.l<r;){var i=t._R(2);t.l-=2;try{n.push(yo[i](t,r-t.l))}catch(e){return t.l=r,n}}return t.l!=r&&(t.l=r),n}(e,t-22,l[1])}}},94:{},95:{f:y},96:{},97:{},99:{f:y},125:{f:ko},128:{f:function(e){if(e.l+=4,0!==(e=[e._R(2),e._R(2)])[0]&&e[0]--,0!==e[1]&&e[1]--,7<e[0]||7<e[1])throw new Error("Bad Gutters: "+e.join("|"));return e}},129:{f:function(e,t,r){return{fDialog:16&(r=r&&8==r.biff||2==t?e._R(2):(e.l+=t,0)),fBelow:64&r,fRight:128&r}}},130:{f:d},131:{f:y},132:{f:y},133:{f:function(e,t,r){var n=e._R(4),i=3&e._R(1),o=e._R(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule"}return e=Ji(e,0,r),{pos:n,hs:i,dt:o,name:e=0===e.length?"Sheet1":e}}},134:{},140:{f:function(e){var t=[0,0],r=e._R(2);return t[0]=ni[r]||r,r=e._R(2),t[1]=ni[r]||r,t}},141:{f:d},144:{},146:{f:function(e){for(var t=e._R(2),r=[];0<t--;)r.push(so(e));return r}},151:{},152:{},153:{},154:{},155:{},156:{f:d},157:{},158:{},160:{f:Po},161:{f:function(e,t){var r={};return t<32||(e.l+=16,r.header=Kn(e),r.footer=Kn(e),e.l+=2),r}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function(e,t){for(var r=e.l+t-2,t=e._R(2),n=e._R(2),i=[];e.l<r;)i.push(co(e));if(e.l!==r)throw new Error("MulRK read error");var o=e._R(2);if(i.length!=o-n+1)throw new Error("MulRK length mismatch");return{r:t,c:n,C:o,rkrec:i}}},190:{f:function(e,t){for(var r=e.l+t-2,t=e._R(2),n=e._R(2),i=[];e.l<r;)i.push(e._R(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e._R(2);if(i.length!=o-n+1)throw new Error("MulBlank length mismatch");return{r:t,c:n,C:o,ixfe:i}}},193:{f:Yi},197:{},198:{},199:{},200:{},201:{},202:{f:y},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:d},220:{},221:{f:y},222:{},224:{f:function(e,t,r){var n,i,o,s,a={};return a.ifnt=e._R(2),a.numFmtId=e._R(2),a.flags=e._R(2),a.fStyle=a.flags>>2&1,a.data=(r=r,n={},i=(e=e)._R(4),o=e._R(4),s=e._R(4),e=e._R(2),n.patternType=ii[s>>26],r.cellStyles&&(n.alc=7&i,n.fWrap=i>>3&1,n.alcV=i>>4&7,n.fJustLast=i>>7&1,n.trot=i>>8&255,n.cIndent=i>>16&15,n.fShrinkToFit=i>>20&1,n.iReadOrder=i>>22&2,n.fAtrNum=i>>26&1,n.fAtrFnt=i>>27&1,n.fAtrAlc=i>>28&1,n.fAtrBdr=i>>29&1,n.fAtrPat=i>>30&1,n.fAtrProt=i>>31&1,n.dgLeft=15&o,n.dgRight=o>>4&15,n.dgTop=o>>8&15,n.dgBottom=o>>12&15,n.icvLeft=o>>16&127,n.icvRight=o>>23&127,n.grbitDiag=o>>30&3,n.icvTop=127&s,n.icvBottom=s>>7&127,n.icvDiag=s>>14&127,n.dgDiag=s>>21&15,n.icvFore=127&e,n.icvBack=e>>7&127,n.fsxButton=e>>14&1),n),a}},225:{f:function(e,t){return 0!==t&&e._R(2),1200}},226:{f:Yi},227:{},229:{f:function(e,t){for(var r=[],n=e._R(2);n--;)r.push(uo(e,t));return r}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function(e,t){for(var r,n,i,o,s,a,l,c,u,d=e.l+t,t=e._R(4),h=e._R(4),p=[],f=0;f!=h&&e.l<d;++f)p.push((o=l=u=c=l=a=s=o=i=n=void 0,i=g,g=1200,o=(r=e)._R(2),s=4&(l=r._R(1)),a=8&l,l=1+(1&l),c=0,u={},a&&(c=r._R(2)),s&&(n=r._R(4)),l=2==l?"dbcs-cont":"sbcs-cont",o=0===o?"":r._R(o,l),a&&(r.l+=4*c),s&&(r.l+=n),u.t=o,a||(u.raw="<t>"+u.t+"</t>",u.r=u.t),g=i,u));return p.Count=t,p.Unique=h,p}},253:{f:function(e){var t=ao(e);return t.isst=e._R(4),t}},255:{f:function(e,t){var r={};return r.dsst=e._R(2),e.l+=t-2,r}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Ki},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:y},353:{f:Yi},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function(e,t,r){var n=e.l+t,t=e._R(2),i=e._R(2);if(1025==(r.sbcch=i)||14849==i)return[i,t];if(i<1||255<i)throw new Error("Unexpected SupBook type: "+i);for(var r=Zi(e,i),o=[];n>e.l;)o.push(Qi(e));return[i,t,r,o]}},431:{f:y},432:{},433:{},434:{},437:{},438:{f:function(t,r,e){var n,i=t.l,o="";try{t.l+=4;var s=(e.lastobj||{cmo:[0,0]}).cmo[1],a=(-1==[0,5,7,11,12,14].indexOf(s)?t.l+=6:((n=t)._R(1),n.l++,n._R(2),n.l+=2,0),t._R(2)),l=(t._R(2),d(t),t._R(2));t.l+=l;for(var c=1;c<t.lens.length-1;++c){if(t.l-i!=t.lens[c])throw new Error("TxO: bad continue record");var u=t[t.l];if((o+=Zi(t,t.lens[c+1]-t.lens[c]-1)).length>=(u?a:2*a))break}if(o.length!==a&&o.length!==2*a)throw new Error("cchText: "+a+" != "+o.length);return t.l=i+r,{t:o}}catch(e){return t.l=i+r,{t:o}}}},439:{f:y},440:{f:function(e,t){var r=uo(e,8);return e.l+=16,[r,function(e,t){var t=e.l+t,r=e._R(4);if(2!==r)throw new Error("Unrecognized streamVersion: "+r);r=e._R(2),e.l+=2;var n,i,o,s,a,l,c="";16&r&&(n=no(e,e.l)),128&r&&(i=no(e,e.l)),257==(257&r)&&(o=no(e,e.l)),1==(257&r)&&(s=ro(e,e.l)),8&r&&(c=no(e,e.l)),32&r&&(a=e._R(16)),64&r&&(l=Ii(e)),e.l=t;(e=i||o||s||"")&&c&&(e+="#"+c),e=e||"#"+c,t={Target:e=2&r&&"/"==e.charAt(0)&&"/"!=e.charAt(1)?"file://"+e:e};return a&&(t.guid=a),l&&(t.time=l),n&&(t.Tooltip=n),t}(e,t-24)]}},441:{},442:{f:Qi},443:{},444:{f:d},445:{},446:{},448:{f:Yi},449:{f:function(e){return e._R(2),e._R(4)},r:2},450:{f:Yi},512:{f:Eo},513:{f:Do},515:{f:function(e,t,r){return r.biffguess&&2==r.biff&&(r.biff=5),r=ao(e),e=Kn(e),r.val=e,r}},516:{f:function(e,t,r){r.biffguess&&2==r.biff&&(r.biff=5),e.l;var n=ao(e),e=(2==r.biff&&e.l++,Qi(e,e.l,r));return n.val=e,n}},517:{f:So},519:{f:Lo},520:{f:function(e){var t={},r=(t.r=e._R(2),t.c=e._R(2),t.cnt=e._R(2)-t.c,e._R(2)),n=(e.l+=4,e._R(1));return e.l+=3,7&n&&(t.level=7&n),32&n&&(t.hidden=!0),64&n&&(t.hpt=r/20),t}},523:{},545:{f:Oo},549:{f:Co},566:{},574:{f:function(e,t,r){return r&&2<=r.biff&&r.biff<5?{}:{RTL:64&e._R(2)}}},638:{f:function(e){var t=e._R(2),r=e._R(2),e=co(e);return{r:t,c:r,ixfe:e[0],rknum:e[1]}}},659:{},1048:{},1054:{f:function(e,t,r){return[e._R(2),eo(e,0,r)]}},1084:{},1212:{f:function(e,t,r){var n=po(e),i=(e.l++,e._R(1));return[function(e,t,r){var n,i=e.l+t,o=e._R(2),s=zl(e,o,r);if(65535==o)return[[],pn(e,t-2)];t!==o+2&&(n=jl(e,i-o-2,s,r));return[s,n]}(e,t-=8,r),i,n]}},2048:{f:function(e,t){return e._R(2),[uo(e,8),e._R((t-10)/2,"dbcs-cont").replace(Q,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:vo},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Yi},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e._R(2),t.crc=e._R(4),t},r:12},2173:{f:function(e,t){e.l,e.l+=2;for(var r=e._R(2),n=(e.l+=2,e._R(2)),i=[];0<n--;)i.push(ul(e,e.l));return{ixfe:r,ext:i}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:y,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function(e,t,r){var n,i;if(!(r.biff<8))return n=e._R(2),i=e._R(2),[Zi(e,n,r),Zi(e,i,r)];e.l+=t},r:12},2197:{},2198:{f:function(e,t,r){var t=e.l+t,n=e._R(4);if(124226!==n)if(r.cellStyles){var i,n=e.slice(e.l);e.l=t;try{i=zt(n,{type:"array"})}catch(e){return}n=$t(i,"theme/theme/theme1.xml",!0);if(n)return al(n,r)}else e.l=t},r:12},2199:{},2200:{},2201:{},2202:{f:function(e){return[0!==e._R(4),0!==e._R(4),e._R(4)]},r:12},2203:{f:Yi},2204:{},2205:{},2206:{},2207:{},2211:{f:function(e){t=(n=e)._R(2),r=n._R(2),n.l+=8;var t,r,n={type:t,flags:r};if(2211!=n.type)throw new Error("Invalid Future Record "+n.type);return 0!==e._R(4)}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:d},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function(e,t,r){var n={area:!1};return 5!=r.biff?e.l+=t:(r=e._R(1),e.l+=3,16&r&&(n.area=!0)),n}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function(e){for(var t=e._R(2),r=[];0<t--;)r.push(so(e));return r}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Eo},1:{},2:{f:function(e){var t=ao(e),e=(++e.l,e._R(2));return t.t="n",t.val=e,t}},3:{f:function(e){var t=ao(e),e=(++e.l,Kn(e));return t.t="n",t.val=e,t}},4:{f:function(e,t,r){r.biffguess&&5==r.biff&&(r.biff=2);var n=ao(e),e=(++e.l,eo(e,0,r));return n.t="str",n.val=e,n}},5:{f:So},7:{f:function(e){var t=e._R(1);return 0===t?(e.l++,""):e._R(t,"sbcs-cont")}},8:{},9:{f:vo},11:{},22:{f:d},30:{f:Nt},31:{},32:{},33:{f:Oo},36:{},37:{f:Co},50:{f:function(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}},62:{},52:{},67:{},68:{f:d},69:{},86:{},126:{},127:{f:function(e){var t=e._R(2),r=e._R(2),n=e._R(4),t={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,t}},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function(e,t,r){var t=e.l+t,n=ao(e),i=e._R(2),i=Zi(e,i,r);return e.l=t,n.t="str",n.val=i,n}},223:{},234:{},354:{},421:{},518:{f:Xl},521:{f:vo},536:{f:Ao},547:{f:xo},561:{},579:{},1030:{f:Xl},1033:{f:vo},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function S(e,t,r,n){var i;isNaN(t)||(n=n||(r||[]).length||0,(i=e.next(4))._W(2,t),i._W(2,n),0<n&&Zr(r)&&e.push(r))}function Ju(e,t,r){return(e=e||ye(7))._W(2,t),e._W(2,r),e._W(2,0),e._W(1,0),e}function Zu(e,t,r,n){if(null!=t.v)switch(t.t){case"d":case"n":var i="d"==t.t?_t(de(t.v)):t.v;return void(i==(0|i)&&0<=i&&i<65536?S(e,2,(c=r,u=n,d=i,Ju(h=ye(9),c,u),h._W(2,d),h)):S(e,3,(c=r,u=n,d=i,Ju(h=ye(15),c,u),h._W(8,d,"f"),h)));case"b":case"e":return void S(e,5,(i=r,o=n,s=t.v,a=t.t,Ju(l=ye(9),i,o),Xi(s,a||"b",l),l));case"s":case"str":return void S(e,4,(o=r,s=n,a=(t.v||"").slice(0,255),Ju(l=ye(8+2*a.length),o,s),l._W(1,a.length),l._W(a.length,a,"sbcs"),l.l<l.length?l.slice(0,l.l):l))}var o,s,a,l,c,u,d,h;S(e,1,Ju(null,r,n))}function Qu(e,t){for(var r=t||{},t=(null!=le&&null==r.dense&&(r.dense=le),gn()),n=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(n=i);if(0==n&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);S(t,4==r.biff?1033:3==r.biff?521:9,bo(0,16,r));var o=t,s=e.Sheets[e.SheetNames[n]],a=r,l=Array.isArray(s),c=Ce(s["!ref"]||"A1"),u=[];if(255<c.e.c||16383<c.e.r){if(a.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");c.e.c=Math.min(c.e.c,255),c.e.r=Math.min(c.e.c,16383),f=we(c)}for(var d=c.s.r;d<=c.e.r;++d)for(var h=ve(d),p=c.s.c;p<=c.e.c;++p){d===c.s.r&&(u[p]=be(p));var f=u[p]+h,g=l?(s[d]||[])[p]:s[f];g&&Zu(o,g,d,p)}return S(t,10),t.end()}function ed(e,t,r){var n,i;S(e,49,(n=(e={sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"}).name||"Arial",(i=ye((r=(r=r)&&5==r.biff)?15+n.length:16+2*n.length))._W(2,20*(e.sz||12)),i._W(4,0),i._W(2,400),i._W(4,0),i._W(2,0),i._W(1,n.length),r||i._W(1,1),i._W((r?1:2)*n.length,n,r?"sbcs":"utf16le"),i))}function td(s,a,l){a&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var t,r,n,i,o=e[0];o<=e[1];++o)null!=a[o]&&S(s,1054,(r=a[t=o],i=void 0,n=(n=l)&&5==n.biff,(i=i||ye(n?3+r.length:5+2*r.length))._W(2,t),i._W(n?1:2,r.length),n||i._W(1,1),i._W((n?1:2)*r.length,r,n?"sbcs":"utf16le"),null==(t=i.length>i.l?i.slice(0,i.l):i).l&&(t.l=t.length),t))})}function rd(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];S(e,440,Mo(n)),n[1].Tooltip&&S(e,2048,function(e){var t=e[1].Tooltip,r=ye(10+2*(t.length+1)),e=(r._W(2,2048),W(e[0]));r._W(2,e.r),r._W(2,e.r),r._W(2,e.c),r._W(2,e.c);for(var n=0;n<t.length;++n)r._W(2,t.charCodeAt(n));return r._W(2,0),r}(n))}delete t["!links"]}function nd(n,e){var i;e&&(i=0,e.forEach(function(e,t){var r;++i<=256&&e&&S(n,125,(e=hc(t,e),t=t,(r=ye(12))._W(2,t),r._W(2,t),r._W(2,256*e.width),r._W(2,0),t=0,e.hidden&&(t|=1),r._W(1,t),t=e.level||0,r._W(1,t),r._W(2,0),r))}))}function id(e,t,r,n,i){var o,s,a,l,c,u,d,h,p,f,g,m=16+fc(i.cellXfs,t,i);if(null!=t.v||t.bf)if(t.bf)S(e,6,Jl(t,r,n,0,m));else switch(t.t){case"d":case"n":var y="d"==t.t?_t(de(t.v)):t.v;S(e,515,(d=r,h=n,y=y,p=m,f=ye(14),lo(d,h,p,f),Xn(y,f),f));break;case"b":case"e":S(e,517,(d=r,h=n,p=t.v,y=m,f=t.t,g=ye(8),lo(d,h,y,g),Xi(p,f,g),g));break;case"s":case"str":i.bookSST?(g=dc(i.Strings,t.v,i.revStrings),S(e,253,(s=r,a=n,l=g,c=m,u=ye(10),lo(s,a,c,u),u._W(4,l),u))):S(e,516,(s=r,a=n,c=(t.v||"").slice(0,255),l=m,o=ye(+(u=!(u=i)||8==u.biff)+8+(1+u)*c.length),lo(s,a,l,o),o._W(2,c.length),u&&o._W(1,1),o._W((1+u)*c.length,c,u?"utf16le":"sbcs"),o));break;default:S(e,513,lo(r,n,m))}else S(e,513,lo(r,n,m))}function od(e,t,r){var n=gn(),i=r.SheetNames[e],o=r.Sheets[i]||{},r=(r||{}).Workbook||{},e=(r.Sheets||[])[e]||{},s=Array.isArray(o),a=8==t.biff,l=[],c=Ce(o["!ref"]||"A1"),u=a?65536:16384;if(255<c.e.c||c.e.r>=u){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:IV16384");c.e.c=Math.min(c.e.c,255),c.e.r=Math.min(c.e.c,u-1)}S(n,2057,bo(0,16,t)),S(n,13,qi(1)),S(n,12,qi(100)),S(n,15,Gi(!0)),S(n,17,Gi(!1)),S(n,16,Xn(.001)),S(n,95,Gi(!0)),S(n,42,Gi(!1)),S(n,43,Gi(!1)),S(n,130,qi(1)),S(n,128,(u=[0,0],(y=ye(8))._W(4,0),y._W(2,u[0]?u[0]+1:0),y._W(2,u[1]?u[1]+1:0),y)),S(n,131,Gi(!1)),S(n,132,Gi(!1)),a&&nd(n,o["!cols"]),S(n,512,(u=c,(m=ye(2*(y=8!=(y=t).biff&&y.biff?2:4)+6))._W(y,u.s.r),m._W(y,u.e.r+1),m._W(2,u.s.c),m._W(2,u.e.c+1),m._W(2,0),m)),a&&(o["!links"]=[]);for(var d=c.s.r;d<=c.e.r;++d)for(var h=ve(d),p=c.s.c;p<=c.e.c;++p){d===c.s.r&&(l[p]=be(p));var f=l[p]+h,g=s?(o[d]||[])[p]:o[f];g&&(id(n,g,d,p,t),a)&&g.l&&o["!links"].push([f,g.l])}var m,y=e.CodeName||e.name||i;return a&&S(n,574,(u=(r.Views||[])[0],m=ye(18),e=1718,u&&u.RTL&&(e|=64),m._W(2,e),m._W(4,0),m._W(4,64),m._W(4,0),m._W(4,0),m)),a&&(o["!merges"]||[]).length&&S(n,229,function(e){var t=ye(2+8*e.length);t._W(2,e.length);for(var r=0;r<e.length;++r)ho(e[r],t);return t}(o["!merges"])),a&&rd(n,o),S(n,442,to(y)),a&&(i=n,r=o,(u=ye(19))._W(4,2151),u._W(4,0),u._W(4,0),u._W(2,3),u._W(1,1),u._W(4,0),S(i,2151,u),(u=ye(39))._W(4,2152),u._W(4,0),u._W(4,0),u._W(2,3),u._W(1,0),u._W(4,0),u._W(2,1),u._W(4,4),u._W(2,0),ho(Ce(r["!ref"]||"A1"),u),u._W(4,4),S(i,2152,u)),S(n,10),n.end()}function sd(e,t,r){for(var n=gn(),i=(e||{}).Workbook||{},o=i.Sheets||[],i=i.WBProps||{},s=8==r.biff,a=5==r.biff,l=(S(n,2057,bo(0,5,r)),"xla"==r.bookType&&S(n,135),S(n,225,s?qi(1200):null),S(n,193,function(e,t){t=t||ye(e);for(var r=0;r<e;++r)t._W(1,0);return t}(2)),a&&S(n,191),a&&S(n,192),S(n,226),S(n,92,function(e){var t=!e||8==e.biff,r=ye(t?112:54);for(r._W(8==e.biff?2:1,7),t&&r._W(1,0),r._W(4,859007059),r._W(4,5458548|(t?0:536870912));r.l<r.length;)r._W(1,t?0:32);return r}(r)),S(n,66,qi(s?1200:1252)),s&&S(n,353,qi(0)),s&&S(n,448),S(n,317,function(e){for(var t=ye(2*e),r=0;r<e;++r)t._W(2,r+1);return t}(e.SheetNames.length)),s&&e.vbaraw&&S(n,211),s&&e.vbaraw&&S(n,442,to(i.CodeName||"ThisWorkbook")),S(n,156,qi(17)),S(n,25,Gi(!1)),S(n,18,Gi(!1)),S(n,19,qi(0)),s&&S(n,431,Gi(!1)),s&&S(n,444,qi(0)),S(n,61,((a=ye(18))._W(2,0),a._W(2,0),a._W(2,29280),a._W(2,17600),a._W(2,56),a._W(2,0),a._W(2,0),a._W(2,1),a._W(2,500),a)),S(n,64,Gi(!1)),S(n,141,qi(0)),S(n,34,Gi("true"==((i=e).Workbook&&i.Workbook.WBProps&&ge(i.Workbook.WBProps.date1904)?"true":"false"))),S(n,14,Gi(!0)),s&&S(n,439,Gi(!1)),S(n,218,qi(0)),ed(n,0,r),td(n,e.SSF,r),n),c=r,u=0;u<16;++u)S(l,224,To({numFmtId:0,style:!0},0,c));c.cellXfs.forEach(function(e){S(l,224,To(e,0,c))}),s&&S(n,352,Gi(!1));for(var a=n.end(),i=gn(),n=(s&&S(i,140,((b=b||ye(4))._W(2,1),b._W(2,1),b)),s&&r.Strings&&!function(e,t,r,n){var i=n||(r||[]).length||0;if(i<=8224)return S(e,t,r,i);if(n=t,!isNaN(n)){for(var o=r.parts||[],s=0,a=0,l=0;l+(o[s]||8224)<=8224;)l+=o[s]||8224,s++;var c=e.next(4);for(c._W(2,n),c._W(2,l),e.push(r.slice(a,a+l)),a+=l;a<i;){for((c=e.next(4))._W(2,60),l=0;l+(o[s]||8224)<=8224;)l+=o[s]||8224,s++;c._W(2,l),e.push(r.slice(a,a+l)),a+=l}}}(i,252,wo(r.Strings)),S(i,10),i.end()),d=gn(),h=0,p=0,p=0;p<e.SheetNames.length;++p)h+=(s?12:11)+(s?2:1)*e.SheetNames[p].length;var f,g,m,y=a.length+h+n.length;for(p=0;p<e.SheetNames.length;++p){var v=o[p]||{};S(d,133,(v={pos:y,hs:v.Hidden||0,dt:0,name:e.SheetNames[p]},m=g=void 0,g=!(f=r)||8<=f.biff?2:1,(m=ye(8+g*v.name.length))._W(4,v.pos),m._W(1,v.hs||0),m._W(1,v.dt),m._W(1,v.name.length),8<=f.biff&&m._W(1,1),m._W(g*v.name.length,v.name,f.biff<8?"sbcs":"utf16le"),(g=m.slice(0,m.l)).l=m.l,g)),y+=t[p].length}var b=d.end();if(h!=b.length)throw new Error("BS8 "+h+" != "+b.length);i=[];return a.length&&i.push(a),b.length&&i.push(b),n.length&&i.push(n),Re(i)}function ad(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];n&&n["!ref"]&&255<En(n["!ref"]).e.c&&"undefined"!=typeof console&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}var i=t||{};switch(i.biff||2){case 8:case 5:var o=e,s=t||{},a=[];o&&!o.SSF&&(o.SSF=he(ue)),o&&o.SSF&&(Je(),Xe(o.SSF),s.revssf=Tt(o.SSF),s.revssf[o.SSF[65535]]=0,s.ssf=o.SSF),s.Strings=[],s.Strings.Count=0,s.Strings.Unique=0,Qd(s),s.cellXfs=[],fc(s.cellXfs,{},{revssf:{General:0}}),o.Props||(o.Props={});for(var l=0;l<o.SheetNames.length;++l)a[a.length]=od(l,s,o);return a.unshift(sd(o,a,s)),Re(a);case 4:case 3:case 2:return Qu(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function ld(e,t){var r=t||{},n=(null!=le&&null==r.dense&&(r.dense=le),r.dense?[]:{}),t=(e=e.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!t)throw new Error("Invalid HTML: could not find <table>");for(var i=e.match(/<\/table/i),o=t.index,s=i&&i.index||e.length,a=Ft(e.slice(o,s),/(:?<tr[^>]*>)/i,"<tr>"),l=-1,c=0,u={s:{r:1e7,c:1e7},e:{r:0,c:0}},d=[],o=0;o<a.length;++o){var h=a[o].trim(),p=h.slice(0,3).toLowerCase();if("<tr"==p){if(++l,r.sheetRows&&r.sheetRows<=l){--l;break}c=0}else if("<td"==p||"<th"==p)for(var f=h.split(/<\/t[dh]>/i),s=0;s<f.length;++s){var g=f[s].trim();if(g.match(/<t[dh]/i)){for(var m=g,y=0;"<"==m.charAt(0)&&-1<(y=m.indexOf(">"));)m=m.slice(y+1);for(var v=0;v<d.length;++v){var b=d[v];b.s.c==c&&b.s.r<l&&l<=b.e.r&&(c=b.e.c+1,v=-1)}var g=pe(g.slice(0,g.indexOf(">"))),w=g.colspan?+g.colspan:1,C=((1<(C=+g.rowspan)||1<w)&&d.push({s:{r:l,c:c},e:{r:l+(C||1)-1,c:c+w-1}}),g.t||g["data-t"]||"");m.length&&(m=vr(m),u.s.r>l&&(u.s.r=l),u.e.r<l&&(u.e.r=l),u.s.c>c&&(u.s.c=c),u.e.c<c&&(u.e.c=c),m.length)&&(g={t:"s",v:m},!r.raw&&m.trim().length&&"s"!=C&&("TRUE"===m?g={t:"b",v:!0}:"FALSE"===m?g={t:"b",v:!1}:isNaN(kt(m))?isNaN(Pt(m).getDate())||(g={t:"d",v:de(m)},(g=r.cellDates?g:{t:"n",v:_t(g.v)}).z=r.dateNF||ue[14]):g={t:"n",v:kt(m)}),r.dense?(n[l]||(n[l]=[]),n[l][c]=g):n[se({r:l,c:c})]=g),c+=w}}}return n["!ref"]=we(u),d.length&&(n["!merges"]=d),n}function cd(e,t,r,n){for(var i=e["!merges"]||[],o=[],s=t.s.c;s<=t.e.c;++s){for(var a,l,c,u,d=0,h=0,p=0;p<i.length;++p)if(!(i[p].s.r>r||i[p].s.c>s||i[p].e.r<r||i[p].e.c<s)){if(i[p].s.r<r||i[p].s.c<s){d=-1;break}d=i[p].e.r-i[p].s.r+1,h=i[p].e.c-i[p].s.c+1;break}d<0||(a=se({r:r,c:s}),c=(l=n.dense?(e[r]||[])[s]:e[a])&&null!=l.v&&(l.h||sr(l.w||(Sn(l),l.w)||""))||"",u={},1<d&&(u.rowspan=d),1<h&&(u.colspan=h),n.editable?c='<span contenteditable="true">'+c+"</span>":l&&(u["data-t"]=l&&l.t||"z",null!=l.v&&(u["data-v"]=l.v),null!=l.z&&(u["data-z"]=l.z),l.l)&&"#"!=(l.l.Target||"#").charAt(0)&&(c='<a href="'+l.l.Target+'">'+c+"</a>"),u.id=(n.id||"sjs")+"-"+a,o.push(T("td",c,u)))}return"<tr>"+o.join("")+"</tr>"}var ud='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',dd="</body></html>";function hd(e,t,r){return[].join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function pd(e,t){var r=t||{},t=null!=r.header?r.header:ud,n=null!=r.footer?r.footer:dd,i=[t],o=En(e["!ref"]);r.dense=Array.isArray(e),i.push(hd(0,0,r));for(var s=o.s.r;s<=o.e.r;++s)i.push(cd(e,o,s,r));return i.push("</table>"+n),i.join("")}function fd(e,t,r){var n,i=r||{},o=(null!=le&&(i.dense=le),0),s=0,a=(null!=i.origin&&("number"==typeof i.origin?o=i.origin:(o=(r="string"==typeof i.origin?W(i.origin):i.origin).r,s=r.c)),t.getElementsByTagName("tr")),l=Math.min(i.sheetRows||1e7,a.length),c={s:{r:0,c:0},e:{r:o,c:s}},u=(e["!ref"]&&(r=En(e["!ref"]),c.s.r=Math.min(c.s.r,r.s.r),c.s.c=Math.min(c.s.c,r.s.c),c.e.r=Math.max(c.e.r,r.e.r),c.e.c=Math.max(c.e.c,r.e.c),-1==o)&&(c.e.r=o=r.e.r+1),[]),d=0,h=e["!rows"]||(e["!rows"]=[]),p=0,f=0,g=0,m=0;for(e["!cols"]||(e["!cols"]=[]);p<a.length&&f<l;++p){var y=a[p];if(md(y)){if(i.display)continue;h[f]={hidden:!0}}for(var v=y.children,g=m=0;g<v.length;++g){var b=v[g];if(!i.display||!md(b)){for(var w=b.hasAttribute("data-v")?b.getAttribute("data-v"):b.hasAttribute("v")?b.getAttribute("v"):vr(b.innerHTML),C=b.getAttribute("data-z")||b.getAttribute("z"),d=0;d<u.length;++d){var E=u[d];E.s.c==m+s&&E.s.r<f+o&&f+o<=E.e.r&&(m=E.e.c+1-s,d=-1)}n=+b.getAttribute("colspan")||1,(1<(T=+b.getAttribute("rowspan")||1)||1<n)&&u.push({s:{r:f+o,c:m+s},e:{r:f+o+(T||1)-1,c:m+s+(n||1)-1}});var T={t:"s",v:w},S=b.getAttribute("data-t")||b.getAttribute("t")||"",_=(null!=w&&(0==w.length?T.t=S||"z":i.raw||0==w.trim().length||"s"==S||("TRUE"===w?T={t:"b",v:!0}:"FALSE"===w?T={t:"b",v:!1}:isNaN(kt(w))?isNaN(Pt(w).getDate())||(T={t:"d",v:de(w)},(T=i.cellDates?T:{t:"n",v:_t(T.v)}).z=i.dateNF||ue[14]):T={t:"n",v:kt(w)})),void 0===T.z&&null!=C&&(T.z=C),""),x=b.getElementsByTagName("A");if(x&&x.length)for(var R=0;R<x.length&&(!x[R].hasAttribute("href")||"#"==(_=x[R].getAttribute("href")).charAt(0));++R);_&&"#"!=_.charAt(0)&&(T.l={Target:_}),i.dense?(e[f+o]||(e[f+o]=[]),e[f+o][m+s]=T):e[se({c:m+s,r:f+o})]=T,c.e.c<m+s&&(c.e.c=m+s),m+=n}}++f}return u.length&&(e["!merges"]=(e["!merges"]||[]).concat(u)),c.e.r=Math.max(c.e.r,f-1+o),e["!ref"]=we(c),l<=f&&(e["!fullref"]=we((c.e.r=a.length-p+f-1+o,c))),e}function gd(e,t){return fd((t||{}).dense?[]:{},e,t)}function md(e){var t="",r=(r=e).ownerDocument.defaultView&&"function"==typeof r.ownerDocument.defaultView.getComputedStyle?r.ownerDocument.defaultView.getComputedStyle:"function"==typeof getComputedStyle?getComputedStyle:null;return"none"===(t=(t=r?r(e).getPropertyValue("display"):t)||e.style&&e.style.display)}var yd={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function vd(L,e){var t,r,n,i,F,o=e||{},s=(null!=le&&null==o.dense&&(o.dense=le),Rr(L)),a=[],H={name:""},U=0,l={},c=[],u=o.dense?[]:{},d={value:""},h="",p=0,f=[],g=-1,m=-1,y={s:{r:1e6,c:1e7},e:{r:0,c:0}},v=0,b=[],V={},w=0,C=0,E=[],T=1,S=1,_=[],W={Names:[]},x={},R=["",""],A=[],N={},$="",B=0,O=!1,j=!1,I=0;for(Ar.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");n=Ar.exec(s);)switch(n[3]=n[3].replace(/_.*$/,"")){case"table":case"工作表":"/"===n[1]?(y.e.c>=y.s.c&&y.e.r>=y.s.r?u["!ref"]=we(y):u["!ref"]="A1:A1",0<o.sheetRows&&o.sheetRows<=y.e.r&&(u["!fullref"]=u["!ref"],y.e.r=o.sheetRows-1,u["!ref"]=we(y)),b.length&&(u["!merges"]=b),E.length&&(u["!rows"]=E),r.name=r["名称"]||r.name,"undefined"!=typeof JSON&&JSON.stringify(r),c.push(r.name),l[r.name]=u,j=!1):"/"!==n[0].charAt(n[0].length-2)&&(r=pe(n[0],!1),g=m=-1,y.s.r=y.s.c=1e7,y.e.r=y.e.c=0,u=o.dense?[]:{},b=[],E=[],j=!0);break;case"table-row-group":"/"===n[1]?--v:++v;break;case"table-row":case"行":if("/"===n[1])g+=T,T=1;else{if((M=pe(n[0],!1))["行号"]?g=M["行号"]-1:-1==g&&(g=0),(T=+M["number-rows-repeated"]||1)<10)for(I=0;I<T;++I)0<v&&(E[g+I]={level:v});m=-1}break;case"covered-table-cell":"/"!==n[1]&&++m,o.sheetStubs&&(o.dense?(u[g]||(u[g]=[]),u[g][m]={t:"z"}):u[se({r:g,c:m})]={t:"z"}),h="",f=[];break;case"table-cell":case"数据":if("/"===n[0].charAt(n[0].length-2))++m,d=pe(n[0],!1),S=parseInt(d["number-columns-repeated"]||"1",10),i={t:"z",v:null},d.formula&&0!=o.cellFormula&&(i.f=sc(fe(d.formula))),"string"==(d["数据类型"]||d["value-type"])&&(i.t="s",i.v=fe(d["string-value"]||""),o.dense?(u[g]||(u[g]=[]),u[g][m]=i):u[se({r:g,c:m})]=i),m+=S-1;else if("/"!==n[1]){var h="",p=0,f=[],S=1,M=T?g+T-1:g;if(++m>y.e.c&&(y.e.c=m),m<y.s.c&&(y.s.c=m),g<y.s.r&&(y.s.r=g),M>y.e.r&&(y.e.r=M),A=[],i={t:(d=pe(n[0],!(N={})))["数据类型"]||d["value-type"],v:null},o.cellFormula)if(d.formula&&(d.formula=fe(d.formula)),d["number-matrix-columns-spanned"]&&d["number-matrix-rows-spanned"]&&(w=parseInt(d["number-matrix-rows-spanned"],10)||0,C=parseInt(d["number-matrix-columns-spanned"],10)||0,i.F=we(V={s:{r:g,c:m},e:{r:g+w-1,c:m+C-1}}),_.push([V,i.F])),d.formula)i.f=sc(d.formula);else for(I=0;I<_.length;++I)g>=_[I][0].s.r&&g<=_[I][0].e.r&&m>=_[I][0].s.c&&m<=_[I][0].e.c&&(i.F=_[I][1]);switch((d["number-columns-spanned"]||d["number-rows-spanned"])&&(w=parseInt(d["number-rows-spanned"],10)||0,C=parseInt(d["number-columns-spanned"],10)||0,b.push(V={s:{r:g,c:m},e:{r:g+w-1,c:m+C-1}})),d["number-columns-repeated"]&&(S=parseInt(d["number-columns-repeated"],10)),i.t){case"boolean":i.t="b",i.v=ge(d["boolean-value"]);break;case"float":case"percentage":case"currency":i.t="n",i.v=parseFloat(d.value);break;case"date":i.t="d",i.v=de(d["date-value"]),o.cellDates||(i.t="n",i.v=_t(i.v)),i.z="m/d/yy";break;case"time":i.t="n",i.v=function(e){var t=0,r=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var o=1;o!=i.length;++o)if(i[o]){switch(3<o&&(n=!0),i[o].slice(i[o].length-(r=1))){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[o].slice(i[o].length-1));case"D":r*=24;case"H":r*=60;case"M":if(!n)throw new Error("Unsupported ISO Duration Field: M");r*=60}t+=r*parseInt(i[o],10)}return t}(d["time-value"])/86400,o.cellDates&&(i.t="d",i.v=At(i.v)),i.z="HH:MM:SS";break;case"number":i.t="n",i.v=parseFloat(d["数据数值"]);break;default:if("string"!==i.t&&"text"!==i.t&&i.t)throw new Error("Unsupported value type "+i.t);i.t="s",null!=d["string-value"]&&(h=fe(d["string-value"]),f=[])}}else{if(O=!1,"s"===i.t&&(i.v=h||"",f.length&&(i.R=f),O=0==p),x.Target&&(i.l=x),0<A.length&&(i.c=A,A=[]),h&&!1!==o.cellText&&(i.w=h),O&&(i.t="z",delete i.v),(!O||o.sheetStubs)&&!(o.sheetRows&&o.sheetRows<=g))for(var k=0;k<T;++k){if(S=parseInt(d["number-columns-repeated"]||"1",10),o.dense)for(u[g+k]||(u[g+k]=[]),u[g+k][m]=0==k?i:he(i);0<--S;)u[g+k][m+S]=he(i);else for(u[se({r:g+k,c:m})]=i;0<--S;)u[se({r:g+k,c:m+S})]=he(i);y.e.c<=m&&(y.e.c=m)}m+=(S=parseInt(d["number-columns-repeated"]||"1",10))-1,S=0,i={},h="",f=[]}x={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if("/"===n[1]){if((t=a.pop())[0]!==n[3])throw"Bad state: "+t}else"/"!==n[0].charAt(n[0].length-2)&&a.push([n[3],!0]);break;case"annotation":if("/"===n[1]){if((t=a.pop())[0]!==n[3])throw"Bad state: "+t;N.t=h,f.length&&(N.R=f),N.a=$,A.push(N)}else"/"!==n[0].charAt(n[0].length-2)&&a.push([n[3],!1]);h=$="",p=B=0,f=[];break;case"creator":"/"===n[1]?$=s.slice(B,n.index):B=n.index+n[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===n[1]){if((t=a.pop())[0]!==n[3])throw"Bad state: "+t}else"/"!==n[0].charAt(n[0].length-2)&&a.push([n[3],!1]);h="",p=0,f=[];break;case"scientific-number":case"currency-symbol":case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if("/"===n[1]){if(H.name,(t=a.pop())[0]!==n[3])throw"Bad state: "+t}else"/"!==n[0].charAt(n[0].length-2)&&(H=pe(n[0],!1),a.push([n[3],!0]));break;case"script":case"libraries":case"automatic-styles":break;case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":D=pe(n[0],!1),yd[n[3]]["long"===D.style?1:0]}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":D=pe(n[0],!1),yd[n[3]]["long"===D.style?1:0]}break;case"boolean-style":case"boolean":case"text-style":break;case"text":if("/>"!==n[0].slice(-2))if("/"===n[1])switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":s.slice(U,n.index)}else U=n.index+n[0].length;break;case"named-range":var D,R=ac((D=pe(n[0],!1))["cell-range-address"]),P={Name:D.name,Ref:R[0]+"!"+R[1]};j&&(P.Sheet=c.length),W.Names.push(P);break;case"text-content":case"text-properties":case"embedded-text":break;case"body":case"电子表格":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":break;case"p":case"文本串":-1<["master-styles"].indexOf(a[a.length-1][0])||("/"!==n[1]||d&&d["string-value"]?(pe(n[0],!1),p=n.index+n[0].length):(P=(P=s.slice(p,n.index)).replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(e,t){return Array(parseInt(t,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n"),F=[fe(P.replace(/<[^>]*>/g,""))],h=(0<h.length?h+"\n":"")+F[0]));break;case"s":break;case"database-range":if("/"!==n[1])try{l[(R=ac(pe(n[0])["target-range-address"]))[0]]["!autofilter"]={ref:R[1]}}catch(e){}break;case"date":case"object":break;case"title":case"标题":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":break;case"a":if("/"!==n[1]){if(!(x=pe(n[0],!1)).href)break;x.Target=fe(x.href),delete x.href,"#"==x.Target.charAt(0)&&-1<x.Target.indexOf(".")?(R=ac(x.Target.slice(1)),x.Target="#"+R[0]+"!"+R[1]):x.Target.match(/^\.\.[\\\/]/)&&(x.Target=x.Target.slice(3))}break;case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;default:switch(n[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(o.WTF)throw new Error(n)}}e={Sheets:l,SheetNames:c,Workbook:W};return o.bookSheets&&delete e.Sheets,e}function bd(e,t){if(t=t||{},Vt(e,"META-INF/manifest.xml"))for(var r,n,i=D(e,"META-INF/manifest.xml"),o=t,s=Rr(i);r=Ar.exec(s);)switch(r[3]){case"manifest":break;case"file-entry":if("/"==(n=pe(r[0],!1)).path&&n.type!==gi)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(o&&o.WTF)throw r}i=$t(e,"content.xml");if(i)return t=vd(me(i),t),Vt(e,"meta.xml")&&(t.Props=wi(D(e,"meta.xml"))),t;throw new Error("Missing content.xml in ODS / UOF file")}function wd(e,t){return vd(e,t)}Ba=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),Cd="<office:document-styles "+_r({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+Ba+"</office:document-styles>";var Cd,Ed,Td,Sd,_d=function(){return C+Cd},xd=(Ed=function(e){return E(e).replace(/  +/g,function(e){return'<text:s text:c="'+e.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},Td="          <table:table-cell />\n",Sd="          <table:covered-table-cell/>\n",function(e,t){var n,r,i,o,s=[C],a=_r({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),l=_r({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==t.bookType?(s.push("<office:document"+a+l+">\n"),s.push(yi().replace(/office:document-meta/g,"office:meta"))):s.push("<office:document-content"+a+">\n"),r=e,(n=s).push(" <office:automatic-styles>\n"),n.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),n.push('   <number:month number:style="long"/>\n'),n.push("   <number:text>/</number:text>\n"),n.push('   <number:day number:style="long"/>\n'),n.push("   <number:text>/</number:text>\n"),n.push("   <number:year/>\n"),n.push("  </number:date-style>\n"),i=0,r.SheetNames.map(function(e){return r.Sheets[e]}).forEach(function(e){if(e&&e["!cols"])for(var t=0;t<e["!cols"].length;++t)if(e["!cols"][t]){var r=e["!cols"][t];if(null==r.width&&null==r.wpx&&null==r.wch)continue;xa(r),r.ods=i;r=e["!cols"][t].wpx+"px";n.push('  <style:style style:name="co'+i+'" style:family="table-column">\n'),n.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+r+'"/>\n'),n.push("  </style:style>\n"),++i}}),o=0,r.SheetNames.map(function(e){return r.Sheets[e]}).forEach(function(e){if(e&&e["!rows"])for(var t,r=0;r<e["!rows"].length;++r)e["!rows"][r]&&(e["!rows"][r].ods=o,t=e["!rows"][r].hpx+"px",n.push('  <style:style style:name="ro'+o+'" style:family="table-row">\n'),n.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+t+'"/>\n'),n.push("  </style:style>\n"),++o)}),n.push('  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">\n'),n.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'),n.push("  </style:style>\n"),n.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),n.push(" </office:automatic-styles>\n"),s.push("  <office:body>\n"),s.push("    <office:spreadsheet>\n");for(var c=0;c!=e.SheetNames.length;++c)s.push(Rd(e.Sheets[e.SheetNames[c]],e,c));return s.push("    </office:spreadsheet>\n"),s.push("  </office:body>\n"),"fods"==t.bookType?s.push("</office:document>"):s.push("</office:document-content>"),s.join("")});function Rd(e,t,r){var n=[],i=(n.push('      <table:table table:name="'+E(t.SheetNames[r])+'" table:style-name="ta1">\n'),0),o=0,s=En(e["!ref"]||"A1"),a=e["!merges"]||[],l=0,c=Array.isArray(e);if(e["!cols"])for(o=0;o<=s.e.c;++o)n.push("        <table:table-column"+(e["!cols"][o]?' table:style-name="co'+e["!cols"][o].ods+'"':"")+"></table:table-column>\n");for(var u="",d=e["!rows"]||[],i=0;i<s.s.r;++i)u=d[i]?' table:style-name="ro'+d[i].ods+'"':"",n.push("        <table:table-row"+u+"></table:table-row>\n");for(;i<=s.e.r;++i){for(u=d[i]?' table:style-name="ro'+d[i].ods+'"':"",n.push("        <table:table-row"+u+">\n"),o=0;o<s.s.c;++o)n.push(Td);for(;o<=s.e.c;++o){for(var h=!1,p={},f="",l=0;l!=a.length;++l)if(!(a[l].s.c>o||a[l].s.r>i||a[l].e.c<o||a[l].e.r<i)){a[l].s.c==o&&a[l].s.r==i||(h=!0),p["table:number-columns-spanned"]=a[l].e.c-a[l].s.c+1,p["table:number-rows-spanned"]=a[l].e.r-a[l].s.r+1;break}if(h)n.push(Sd);else{var g=se({r:i,c:o}),m=c?(e[i]||[])[o]:e[g];if(m&&m.f&&(p["table:formula"]=E(("of:="+m.f.replace(_l,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")),m.F)&&m.F.slice(0,g.length)==g&&(g=En(m.F),p["table:number-matrix-columns-spanned"]=g.e.c-g.s.c+1,p["table:number-matrix-rows-spanned"]=g.e.r-g.s.r+1),m){switch(m.t){case"b":f=m.v?"TRUE":"FALSE",p["office:value-type"]="boolean",p["office:boolean-value"]=m.v?"true":"false";break;case"n":f=m.w||String(m.v||0),p["office:value-type"]="float",p["office:value"]=m.v||0;break;case"s":case"str":f=null==m.v?"":m.v,p["office:value-type"]="string";break;case"d":f=m.w||de(m.v).toISOString(),p["office:value-type"]="date",p["office:date-value"]=de(m.v).toISOString(),p["table:style-name"]="ce1";break;default:n.push(Td);continue}var y,g=Ed(f);m.l&&m.l.Target&&(g=T("text:a",g,{"xlink:href":(y="#"==(y="#"==(y=m.l.Target).charAt(0)?"#"+y.slice(1).replace(/\./,"!"):y).charAt(0)||y.match(/^\w+:/)?y:"../"+y).replace(/&/g,"&amp;")})),n.push("          "+T("table:table-cell",T("text:p",g,{}),p)+"\n")}else n.push(Td)}}n.push("        </table:table-row>\n")}return n.push("      </table:table>\n"),n.join("")}function Ad(e,t){var r,n,i,o;return"fods"==t.bookType?xd(e,t):(o="",n=[],i=[],P(r=jt(),o="mimetype","application/vnd.oasis.opendocument.spreadsheet"),P(r,o="content.xml",xd(e,t)),n.push([o,"text/xml"]),i.push([o,"ContentFile"]),P(r,o="styles.xml",_d(e,t)),n.push([o,"text/xml"]),i.push([o,"StylesFile"]),P(r,o="meta.xml",C+yi()),n.push([o,"text/xml"]),i.push([o,"MetadataFile"]),P(r,o="manifest.rdf",function(e){var t=[C];t.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var r=0;r!=e.length;++r)t.push(mi(e[r][0],e[r][1])),t.push(['  <rdf:Description rdf:about="">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e[r][0]+'"/>\n',"  </rdf:Description>\n"].join(""));return t.push(mi("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}(i)),n.push([o,"application/rdf+xml"]),P(r,o="META-INF/manifest.xml",function(e){var t=[C];t.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),t.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+'"/>\n');return t.push("</manifest:manifest>"),t.join("")}(n)),r)}function Nd(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Od(e){return"undefined"!=typeof TextDecoder?(new TextDecoder).decode(e):me(p(e))}function Id(e){var t=e.reduce(function(e,t){return e+t.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(e){r.set(e,n),n+=e.length}),r}function Md(e){return 16843009*((e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135)>>>24}function kd(e,t){var r=t?t[0]:0,n=127&e[r];return 128<=e[r++]&&(n|=(127&e[r])<<7,e[r++]<128||(n|=(127&e[r])<<14,e[r++]<128)||(n|=(127&e[r])<<21,e[r++]<128)||(n+=(127&e[r])*Math.pow(2,28),++r,e[r++]<128)||(n+=(127&e[r])*Math.pow(2,35),++r,e[r++]<128)||(n+=(127&e[r])*Math.pow(2,42),++r,e[r++])),t&&(t[0]=r),n}function Y(e){var t=new Uint8Array(7),r=(t[0]=127&e,1);return 127<e&&(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103)||(t[r-1]|=128,t[r]=e/16777216>>>21&127,++r)),t.slice(0,r)}function G(e){var t=0,r=127&e[0];return 128<=e[t++]&&(r|=(127&e[1])<<7,e[t++]<128||(r|=(127&e[2])<<14,e[t++]<128)||(r|=(127&e[3])<<21,e[+t]<128)||(r|=(127&e[4])<<28)),r}function q(e){for(var t=[],r=[0];r[0]<e.length;){var n,i=r[0],o=kd(e,r),s=7&o,a=0;if(0==(o=Math.floor(o/8)))break;switch(s){case 0:for(var l=r[0];128<=e[r[0]++];);n=e.slice(l,r[0]);break;case 5:n=e.slice(r[0],r[0]+(a=4)),r[0]+=a;break;case 1:n=e.slice(r[0],r[0]+(a=8)),r[0]+=a;break;case 2:a=kd(e,r),n=e.slice(r[0],r[0]+a),r[0]+=a;break;default:throw new Error("PB Type ".concat(s," for Field ").concat(o," at offset ").concat(i))}var c={data:n,type:s};null==t[o]?t[o]=[c]:t[o].push(c)}return t}function Dd(e){var r=[];return e.forEach(function(e,t){e.forEach(function(e){e.data&&(r.push(Y(8*t+e.type)),2==e.type&&r.push(Y(e.data.length)),r.push(e.data))})}),Id(r)}function Pd(e,t){return(null==e?void 0:e.map(function(e){return t(e.data)}))||[]}function Ld(r){for(var e=[],n=[0];n[0]<r.length;){var t=kd(r,n),i=q(r.slice(n[0],n[0]+t)),o=(n[0]+=t,{id:G(i[1][0].data),messages:[]});i[2].forEach(function(e){var e=q(e.data),t=G(e[3][0].data);o.messages.push({meta:e,data:r.slice(n[0],n[0]+t)}),n[0]+=t}),null!=(t=i[3])&&t[0]&&(o.merge=0<G(i[3][0].data)>>>0),e.push(o)}return e}function Fd(e){var n=[];return e.forEach(function(e){var t=[],r=(t[1]=[{data:Y(e.id),type:0}],t[2]=[],null!=e.merge&&(t[3]=[{data:Y(+!!e.merge),type:0}]),[]),e=(e.messages.forEach(function(e){r.push(e.data),e.meta[3]=[{type:0,data:Y(e.data.length)}],t[2].push({data:Dd(e.meta),type:2})}),Dd(t));n.push(Y(e.length)),n.push(e),r.forEach(function(e){return n.push(e)})}),Id(n)}function Hd(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(function(e,t){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],e=kd(t,r),n=[];r[0]<t.length;){var i=3&t[r[0]];if(0==i){var o=t[r[0]++]>>2;o<60?++o:(s=o-59,o=t[r[0]],1<s&&(o|=t[r[0]+1]<<8),2<s&&(o|=t[r[0]+2]<<16),3<s&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=s),n.push(t.slice(r[0],r[0]+o)),r[0]+=o}else{var s=0,a=0;if(1==i?(a=4+(t[r[0]]>>2&7),s=(224&t[r[0]++])<<3,s|=t[r[0]++]):(a=1+(t[r[0]++]>>2),2==i?(s=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(s=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),n=[Id(n)],0==s)throw new Error("Invalid offset 0");if(s>n[0].length)throw new Error("Invalid offset beyond length");if(s<=a)for(n.push(n[0].slice(-s)),a-=s;a>=n[n.length-1].length;)n.push(n[n.length-1]),a-=n[n.length-1].length;n.push(n[0].slice(-s,-s+a))}}var l=Id(n);if(l.length!=e)throw new Error("Unexpected length: ".concat(l.length," != ").concat(e));return l}(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Id(t)}function Ud(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),i=new Uint8Array(4),o=(t.push(i),Y(n)),s=o.length;t.push(o),n<=60?(s++,t.push(new Uint8Array([n-1<<2]))):n<=256?(s+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(s+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(s+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(s+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),s+=n,i[0]=0,i[1]=255&s,i[2]=s>>8&255,i[3]=s>>16&255,r+=n}return Id(t)}function Vd(e,t,r){var n,i=Nd(e),o=i.getUint32(8,!0),s=12,a=-1,l=-1,c=NaN,u=NaN,d=new Date(2001,0,1);switch(1&o&&(c=function(e,t){for(var r=(127&e[t+15])<<7|e[t+14]>>1,n=1&e[t+14],i=t+13;t<=i;--i)n=256*n+e[i];return(128&e[t+15]?-n:n)*Math.pow(10,r-6176)}(e,s),s+=16),2&o&&(u=i.getFloat64(s,!0),s+=8),4&o&&(d.setTime(d.getTime()+1e3*i.getFloat64(s,!0)),s+=8),8&o&&(l=i.getUint32(s,!0),s+=4),16&o&&(a=i.getUint32(s,!0),s+=4),e[1]){case 0:break;case 2:n={t:"n",v:c};break;case 3:n={t:"s",v:t[l]};break;case 5:n={t:"d",v:d};break;case 6:n={t:"b",v:0<u};break;case 7:n={t:"n",v:u/86400};break;case 8:n={t:"e",v:0};break;case 9:if(!(-1<a))throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&o," : ").concat(e.slice(0,4)));n={t:"s",v:r[a]};break;case 10:n={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&o," : ").concat(e.slice(0,4)))}return n}function Wd(e,t){var r=new Uint8Array(32),n=Nd(r),i=12,o=0;switch(r[0]=5,e.t){case"n":r[1]=2;var s=r,a=i,l=e.v,c=Math.floor(0==l?0:Math.LOG10E*Math.log(Math.abs(l)))+6176-20,u=l/Math.pow(10,c-6176);s[a+15]|=c>>7,s[a+14]|=(127&c)<<1;for(var d=0;1<=u;++d,u/=256)s[a+d]=255&u;s[a+15]|=0<=l?0:128,o|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,e.v?1:0,!0),o|=2,i+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(i,t.indexOf(e.v),!0),o|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,o,!0),r.slice(0,i)}function $d(e,t){var r=new Uint8Array(32),n=Nd(r),i=12,o=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(i,e.v,!0),o|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,e.v?1:0,!0),o|=32,i+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(i,t.indexOf(e.v),!0),o|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,o,!0),r.slice(0,i)}function Bd(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:var n,i=e,o=t,s=r,a=e[0],l=Nd(i),c=l.getUint32(4,!0),u=(1<a?12:8)+4*Md(c&(1<a?3470:398)),d=-1,h=-1,p=NaN,f=new Date(2001,0,1);switch(512&c&&(d=l.getUint32(u,!0),u+=4),u+=4*Md(c&(1<a?12288:4096)),16&c&&(h=l.getUint32(u,!0),u+=4),32&c&&(p=l.getFloat64(u,!0),u+=8),64&c&&(f.setTime(f.getTime()+1e3*l.getFloat64(u,!0)),u+=8),i[2]){case 0:break;case 2:n={t:"n",v:p};break;case 3:n={t:"s",v:o[h]};break;case 5:n={t:"d",v:f};break;case 6:n={t:"b",v:0<p};break;case 7:n={t:"n",v:p/86400};break;case 8:n={t:"e",v:0};break;case 9:if(-1<d)n={t:"s",v:s[d]};else if(-1<h)n={t:"s",v:o[h]};else{if(isNaN(p))throw new Error("Unsupported cell type ".concat(i.slice(0,4)));n={t:"n",v:p}}break;default:throw new Error("Unsupported cell type ".concat(i.slice(0,4)))}return n;case 5:return Vd(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function jd(e){return kd(q(e)[1][0].data)}function zd(o,e){var e=q(e.data),s=G(e[1][0].data),e=e[3],a=[];return(e||[]).forEach(function(e){var t=q(e.data),r=G(t[1][0].data)>>>0;switch(s){case 1:a[r]=Od(t[3][0].data);break;case 8:var n=q(o[jd(t[9][0].data)][0].data),n=o[jd(n[1][0].data)][0],i=G(n.meta[1][0].data);if(2001!=i)throw new Error("2000 unexpected reference to ".concat(i));i=q(n.data);a[r]=i[3].map(function(e){return Od(e.data)}).join("")}}),a}function Yd(e,t){var t=q(t.data),f=null!=(r=null==t?void 0:t[7])&&r[0]?0<G(t[7][0].data)>>>0?1:0:-1,r=Pd(t[5],function(e){var t,r,n,i=f,o=G((e=q(e))[1][0].data)>>>0,s=G(e[2][0].data)>>>0,a=(null==(a=null==(a=e[8])?void 0:a[0])?void 0:a.data)&&0<G(e[8][0].data)||!1;if(null!=(t=null==(t=e[7])?void 0:t[0])&&t.data&&0!=i)r=null==(t=null==(t=e[7])?void 0:t[0])?void 0:t.data,n=null==(t=null==(t=e[6])?void 0:t[0])?void 0:t.data;else{if(null==(t=null==(t=e[4])?void 0:t[0])||!t.data||1==i)throw"NUMBERS Tile missing ".concat(i," cell storage");r=null==(i=null==(t=e[4])?void 0:t[0])?void 0:i.data,n=null==(i=null==(t=e[3])?void 0:t[0])?void 0:i.data}for(var l=a?4:1,c=Nd(r),u=[],d=0;d<r.length/2;++d){var h=c.getUint16(2*d,!0);h<65535&&u.push([d,h])}if(u.length!=s)throw"Expected ".concat(s," cells, found ").concat(u.length);for(var p=[],d=0;d<u.length-1;++d)p[u[d][0]]=n.subarray(u[d][1]*l,u[d+1][1]*l);return 1<=u.length&&(p[u[u.length-1][0]]=n.subarray(u[u.length-1][1]*l)),{R:o,cells:p}});return{nrows:G(t[4][0].data)>>>0,data:r.reduce(function(r,n){return r[n.R]||(r[n.R]=[]),n.cells.forEach(function(e,t){if(r[n.R][t])throw new Error("Duplicate cell r=".concat(n.R," c=").concat(t));r[n.R][t]=e}),r},[])}}function Gd(e,t){var r={"!ref":"A1"},t=e[jd(q(t.data)[2][0].data)],n=G(t[0].meta[1][0].data);if(6001!=n)throw new Error("6000 unexpected reference to ".concat(n));var i=e,n=t[0],o=r,n=q(n.data);if((e={s:{r:0,c:0},e:{r:0,c:0}}).e.r=(G(n[6][0].data)>>>0)-1,e.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(e.e.c=(G(n[7][0].data)>>>0)-1,e.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));o["!ref"]=we(e);var e=q(n[4][0].data),s=zd(i,i[jd(e[4][0].data)][0]),a=null!=(n=e[17])&&n[0]?zd(i,i[jd(e[17][0].data)][0]):[],n=q(e[3][0].data),l=0;return n[1].forEach(function(e){var e=q(e.data),e=i[jd(e[2][0].data)][0],t=G(e.meta[1][0].data);if(6002!=t)throw new Error("6001 unexpected reference to ".concat(t));t=Yd(0,e);t.data.forEach(function(e,r){e.forEach(function(e,t){t=se({r:l+r,c:t}),e=Bd(e,s,a);e&&(o[t]=e)})}),l+=t.nrows}),r}function qd(o,e){var s=Ah();if(Pd(q(e.data)[1],jd).forEach(function(e){o[e].forEach(function(e){var r,t,n,i;2==G(e.meta[1][0].data)&&(t=o,e=q((e=e).data),i={name:null!=(n=e[1])&&n[0]?Od(e[1][0].data):"",sheets:[]},Pd(e[2],jd).forEach(function(e){t[e].forEach(function(e){6e3==G(e.meta[1][0].data)&&i.sheets.push(Gd(t,e))})}),(r=i).sheets.forEach(function(e,t){Nh(s,e,0==t?r.name:r.name+"_"+t,!0)}))})}),0==s.SheetNames.length)throw new Error("Empty NUMBERS file");return s}function Kd(e){var n={},i=[];if(e.FullPaths.forEach(function(e){if(e.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(t){if(t.name.match(/\.iwa$/)){var e,r;try{e=Hd(t.content)}catch(e){return console.log("?? "+t.content.length+" "+(e.message||e))}try{r=Ld(e)}catch(e){return console.log("## "+(e.message||e))}r.forEach(function(e){n[e.id]=e.messages,i.push(e.id)})}}),!i.length)throw new Error("File has no messages");var t=(null==(e=null==(e=null==(e=null==(e=null==n?void 0:n[1])?void 0:e[0])?void 0:e.meta)?void 0:e[1])?void 0:e[0].data)&&1==G(n[1][0].meta[1][0].data)&&n[1][0];if(t||i.forEach(function(e){n[e].forEach(function(e){if(1==G(e.meta[1][0].data)>>>0){if(t)throw new Error("Document has multiple roots");t=e}})}),t)return qd(n,t);throw new Error("Cannot find Document root")}function Xd(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]],n=(1<e.SheetNames.length&&console.error("The Numbers writer currently writes only the first table"),En(r["!ref"])),e=(n.s.r=n.s.c=0,!1),i=(9<n.e.c&&(e=!0,n.e.c=9),49<n.e.r&&(e=!0,n.e.r=49),e&&console.error("The Numbers writer is currently limited to ".concat(we(n))),Ch(r,{range:n,header:1})),o=["~Sh33tJ5~"],s=(i.forEach(function(e){return e.forEach(function(e){"string"==typeof e&&o.push(e)})}),{}),a=[],l=X.read(t.numbers,{type:"base64"}),L=(l.FileIndex.map(function(e,t){return[e,l.FullPaths[t]]}).forEach(function(e){var t=e[0],r=e[1];2==t.type&&t.name.match(/\.iwa/)&&Ld(Hd(t.content)).forEach(function(e){a.push(e.id),s[e.id]={deps:[],location:r,type:G(e.messages[0].meta[1][0].data)}})}),a.sort(function(e,t){return e-t}),a.filter(function(e){return 1<e}).map(function(e){return[e,Y(e)]}));l.FileIndex.map(function(e,t){return[e,l.FullPaths[t]]}).forEach(function(e){var t=e[0];e[1];t.name.match(/\.iwa/)&&Ld(Hd(t.content)).forEach(function(r){r.messages.forEach(function(e){L.forEach(function(t){r.messages.some(function(e){return 11006!=G(e.meta[1][0].data)&&function(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}(e.data,t[1])})&&s[t[0]].deps.push(r.id)})})})});for(var c,e=X.find(l,s[1].location),u=Ld(Hd(e.content)),d=0;d<u.length;++d){var h=u[d];1==h.id&&(c=h)}for(var p=jd(q(c.messages[0].data)[1][0].data),u=Ld(Hd((e=X.find(l,s[p].location)).content)),d=0;d<u.length;++d)(h=u[d]).id==p&&(c=h);for(p=jd(q(c.messages[0].data)[2][0].data),u=Ld(Hd((e=X.find(l,s[p].location)).content)),d=0;d<u.length;++d)(h=u[d]).id==p&&(c=h);for(p=jd(q(c.messages[0].data)[2][0].data),u=Ld(Hd((e=X.find(l,s[p].location)).content)),d=0;d<u.length;++d)(h=u[d]).id==p&&(c=h);r=q(c.messages[0].data);r[6][0].data=Y(n.e.r+1),r[7][0].data=Y(n.e.c+1);for(var f=jd(r[46][0].data),t=X.find(l,s[f].location),g=Ld(Hd(t.content)),m=0;m<g.length&&g[m].id!=f;++m);if(g[m].id!=f)throw"Bad ColumnRowUIDMapArchive";var y=q(g[m].messages[0].data);y[1]=[],y[2]=[],y[3]=[];for(var v=0;v<=n.e.c;++v){var b=[];b[1]=b[2]=[{type:0,data:Y(v+420690)}],y[1].push({type:2,data:Dd(b)}),y[2].push({type:0,data:Y(v)}),y[3].push({type:0,data:Y(v)})}y[4]=[],y[5]=[],y[6]=[];for(var w=0;w<=n.e.r;++w)(b=[])[1]=b[2]=[{type:0,data:Y(w+726270)}],y[4].push({type:2,data:Dd(b)}),y[5].push({type:0,data:Y(w)}),y[6].push({type:0,data:Y(w)});g[m].messages[0].data=Dd(y),t.content=Ud(Fd(g)),t.size=t.content.length,delete r[46];var C=q(r[4][0].data);C[7][0].data=Y(n.e.r+1);var E=jd(q(C[1][0].data)[2][0].data);if((g=Ld(Hd((t=X.find(l,s[E].location)).content)))[0].id!=E)throw"Bad HeaderStorageBucket";for(var T=q(g[0].messages[0].data),w=0;w<i.length;++w){var S=q(T[2][0].data);S[1][0].data=Y(w),S[4][0].data=Y(i[w].length),T[2][w]={type:T[2][0].type,data:Dd(S)}}g[0].messages[0].data=Dd(T),t.content=Ud(Fd(g)),t.size=t.content.length;E=jd(C[2][0].data);if((g=Ld(Hd((t=X.find(l,s[E].location)).content)))[0].id!=E)throw"Bad HeaderStorageBucket";for(T=q(g[0].messages[0].data),v=0;v<=n.e.c;++v)(S=q(T[2][0].data))[1][0].data=Y(v),S[4][0].data=Y(n.e.r+1),T[2][v]={type:T[2][0].type,data:Dd(S)};g[0].messages[0].data=Dd(T),t.content=Ud(Fd(g)),t.size=t.content.length;for(var _,F=jd(C[4][0].data),E=X.find(l,s[F].location),x=Ld(Hd(E.content)),R=0;R<x.length;++R){var H=x[R];H.id==F&&(_=H)}var A=q(_.messages[0].data),N=(A[3]=[],[]),t=(o.forEach(function(e,t){N[1]=[{type:0,data:Y(t)}],N[2]=[{type:0,data:Y(1)}],N[3]=[{type:2,data:(t=e,"undefined"!=typeof TextEncoder?(new TextEncoder).encode(t):xe(mr(t)))}],A[3].push({type:2,data:Dd(N)})}),_.messages[0].data=Dd(A),Ud(Fd(x)));E.content=t,E.size=E.content.length;for(var O,t=q(C[3][0].data),E=t[1][0],U=(delete t[2],q(E.data)),V=jd(U[2][0].data),I=X.find(l,s[V].location),M=Ld(Hd(I.content)),k=0;k<M.length;++k){var W=M[k];W.id==V&&(O=W)}var D=q(O.messages[0].data);delete D[6],delete t[7];for(var $=new Uint8Array(D[5][0].data),B=(D[5]=[],0),P=0;P<=n.e.r;++P){var j=q($);B+=function(e,t,r){var n;if(null==(n=e[6])||!n[0]||null==(n=e[7])||!n[0])throw"Mutation only works on post-BNC storages!";if((null==(n=null==(n=e[8])?void 0:n[0])?void 0:n.data)&&0<G(e[8][0].data)||!1)throw"Math only works with normal offsets";for(var i,o,s=0,a=Nd(e[7][0].data),l=0,c=[],u=Nd(e[4][0].data),d=0,h=[],p=0;p<t.length;++p)if(null==t[p])a.setUint16(2*p,65535,!0),u.setUint16(2*p,65535);else{switch(a.setUint16(2*p,l,!0),u.setUint16(2*p,d,!0),typeof t[p]){case"string":i=Wd({t:"s",v:t[p]},r),o=$d({t:"s",v:t[p]},r);break;case"number":i=Wd({t:"n",v:t[p]},r),o=$d({t:"n",v:t[p]},r);break;case"boolean":i=Wd({t:"b",v:t[p]},r),o=$d({t:"b",v:t[p]},r);break;default:throw new Error("Unsupported value "+t[p])}c.push(i),l+=i.length,h.push(o),d+=o.length,++s}for(e[2][0].data=Y(s);p<e[7][0].data.length/2;++p)a.setUint16(2*p,65535,!0),u.setUint16(2*p,65535,!0);return e[6][0].data=Id(c),e[3][0].data=Id(h),s}(j,i[P],o),j[1][0].data=Y(P),D[5].push({data:Dd(j),type:2})}D[1]=[{type:0,data:Y(n.e.c+1)}],D[2]=[{type:0,data:Y(n.e.r+1)}],D[3]=[{type:0,data:Y(B)}],D[4]=[{type:0,data:Y(n.e.r+1)}],O.messages[0].data=Dd(D);var z=Ud(Fd(M));I.content=z,I.size=I.content.length,E.data=Dd(U),C[3][0].data=Dd(t),r[4][0].data=Dd(C),c.messages[0].data=Dd(r);z=Ud(Fd(u));return e.content=z,e.size=e.content.length,l}function Jd(n){return function(e){for(var t=0;t!=n.length;++t){var r=n[t];void 0===e[r[0]]&&(e[r[0]]=r[1]),"n"===r[2]&&(e[r[0]]=Number(e[r[0]]))}}}function Zd(e){Jd([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Qd(e){Jd([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function eh(t,e){if(!t)return 0;try{t=e.map(function(e){return e.id||(e.id=e.strRelID),[e.name,t["!id"][e.id].Target,(e=t["!id"][e.id].Type,-1<A.WS.indexOf(e)?"sheet":A.CS&&e==A.CS?"chart":A.DS&&e==A.DS?"dialog":A.MS&&e==A.MS?"macro":e&&e.length?e:"sheet")]})}catch(e){return null}return t&&0!==t.length?t:null}function th(c,u,e,d,t,h,r,n,p,i,o,s){try{h[d]=pi($t(c,e,!0),u);var a,l,f,g,m,y=D(c,u);switch(n){case"sheet":m=wu(y,u,t,p,h[d],i,o,s);break;case"chart":(m=Cu(y,u,t,p,h[d],i))&&m["!drawel"]&&(l=hi(a=Yt(m["!drawel"].Target,u)),b=$t(c,a,!0),w=pi($t(c,l,!0),a),g=hi(f=Yt(b?(b=(b.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1],w["!id"][b].Target):"??",a)),m=ru($t(c,f,!0),0,0,pi($t(c,g,!0),f),0,m));break;case"macro":h[d],u.slice(-4),m={"!type":"macro"};break;case"dialog":h[d],u.slice(-4),m={"!type":"dialog"};break;default:throw new Error("Unrecognized sheet type "+n)}r[d]=m;var v=[];h&&h[d]&&oe(h[d]).forEach(function(e){var n,i,o,s,a,l,t="";if(h[d][e].Type==A.CMNT){var t=Yt(h[d][e].Target,u),r=Su(D(c,t,!0),t,p);if(!r||!r.length)return;gl(m,r,!1)}h[d][e].Type==A.TCMNT&&(t=Yt(h[d][e].Target,u),v=v.concat((n=D(c,t,!0),i=p,s=!(o=[]),a={},l=0,n.replace(qt,function(e,t){var r=pe(e);switch(Jt(r[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":break;case"<threadedComment":a={author:r.personId,guid:r.id,ref:r.ref,T:1};break;case"</threadedComment>":null!=a.t&&o.push(a);break;case"<text>":case"<text":l=t+e.length;break;case"</text>":a.t=n.slice(l,t).replace(/\r\n/g,"\n").replace(/\r/g,"\n");break;case"<mentions":case"<mentions>":s=!0;break;case"</mentions>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&i.WTF)throw new Error("unrecognized "+r[0]+" in threaded comments")}return e}),o)))}),v&&v.length&&gl(m,v,!0,p.people||[])}catch(e){if(p.WTF)throw e}var b,w}function rh(e){return"/"==e.charAt(0)?e.slice(1):e}function nh(r,t){if(Je(),Zd(t=t||{}),Vt(r,"META-INF/manifest.xml"))return bd(r,t);if(Vt(r,"objectdata.xml"))return bd(r,t);if(Vt(r,"Index/Document.iwa")){if("undefined"==typeof Uint8Array)throw new Error("NUMBERS file parsing requires Uint8Array support");var n;return r.FileIndex?Kd(r):(n=X.utils.cfb_new(),Bt(r).forEach(function(e){P(n,e,function e(t,r,n){if(!n)return Ut(Wt(t,r));if(!r)return null;try{return e(t,r)}catch(e){return null}}(r,e))}),Kd(n))}if(!Vt(r,"[Content_Types].xml")){if(Vt(r,"index.xml.gz"))throw new Error("Unsupported NUMBERS 08 file");if(Vt(r,"index.xml"))throw new Error("Unsupported NUMBERS 09 file");throw new Error("Unsupported ZIP file")}var e=Bt(r),i=function(e){var r=ui();if(e&&e.match){var n={};if((e.match(qt)||[]).forEach(function(e){var t=pe(e);switch(t[0].replace(Kt,"<")){case"<?xml":break;case"<Types":r.xmlns=t["xmlns"+(t[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":n[t.Extension]=t.ContentType;break;case"<Override":void 0!==r[li[t.ContentType]]&&r[li[t.ContentType]].push(t.PartName)}}),r.xmlns!==Nr.CT)throw new Error("Unknown Namespace: "+r.xmlns);r.calcchain=0<r.calcchains.length?r.calcchains[0]:"",r.sst=0<r.strs.length?r.strs[0]:"",r.style=0<r.styles.length?r.styles[0]:"",r.defaults=n,delete r.calcchains}return r}($t(r,"[Content_Types].xml")),o=!1;if(0===i.workbooks.length&&D(r,s="xl/workbook.xml",!0)&&i.workbooks.push(s),0===i.workbooks.length){if(!D(r,s="xl/workbook.bin",!0))throw new Error("Could not find workbook");i.workbooks.push(s),o=!0}"bin"==i.workbooks[0].slice(-3)&&(o=!0);var s,a={},l={};if(!t.bookSheets&&!t.bookProps){if(lc=[],i.sst)try{lc=Tu(D(r,rh(i.sst)),i.sst,t)}catch(e){if(t.WTF)throw e}t.cellStyles&&i.themes.length&&(s=$t(r,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],a=al(s,t)),i.style&&(l=Eu(D(r,rh(i.style)),i.style,a,t))}i.links.map(function(e){try{pi($t(r,hi(rh(e))),e);return xu(D(r,rh(e)),0,e,t)}catch(e){}});var c,u,d,h=bu(D(r,rh(i.workbooks[0])),i.workbooks[0],t),p={},f="",g=(i.coreprops.length&&((f=D(r,rh(i.coreprops[0]),!0))&&(p=wi(f)),0!==i.extprops.length)&&(f=D(r,rh(i.extprops[0]),!0))&&(g=t,d={},u=(u=p)||{},c=me(c=f),Ti.forEach(function(e){var t=(c.match(yr(e[0]))||[])[1];switch(e[2]){case"string":t&&(u[e[1]]=fe(t));break;case"bool":u[e[1]]="true"===t;break;case"raw":var r=c.match(new RegExp("<"+e[0]+"[^>]*>([\\s\\S]*?)</"+e[0]+">"));r&&0<r.length&&(d[e[1]]=r[1])}}),d.HeadingPairs)&&d.TitlesOfParts&&_i(d.HeadingPairs,d.TitlesOfParts,u,g),{}),m=(t.bookSheets&&!t.bookProps||0!==i.custprops.length&&(f=$t(r,rh(i.custprops[0]),!0))&&(g=function(e,t){var r={},n="",i=e.match(Ri);if(i)for(var o=0;o!=i.length;++o){var s=i[o],a=pe(s);switch(a[0]){case"<?xml":case"<Properties":break;case"<property":n=fe(a.name);break;case"</property>":n=null;break;default:if(0===s.indexOf("<vt:")){var l=s.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=fe(u);break;case"bool":r[n]=ge(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=de(u);break;case"cy":case"error":r[n]=fe(u);break;default:"/"!=c.slice(-1)&&t.WTF&&"undefined"!=typeof console&&console.warn("Unexpected",s,c,l)}}else if("</"!==s.slice(0,2)&&t.WTF)throw new Error(s)}}return r}(f,t)),{});if(!t.bookSheets&&!t.bookProps||(h.Sheets?b=h.Sheets.map(function(e){return e.name}):p.Worksheets&&0<p.SheetNames.length&&(b=p.SheetNames),t.bookProps&&(m.Props=p,m.Custprops=g),t.bookSheets&&void 0!==b&&(m.SheetNames=b),t.bookSheets?!m.SheetNames:!t.bookProps)){var y,v,b={},f={},w=(t.bookDeps&&i.calcchain&&(f=_u(D(r,rh(i.calcchain)),i.calcchain)),0),C={},E=h.Sheets;p.Worksheets=E.length,p.SheetNames=[];for(var T=0;T!=E.length;++T)p.SheetNames[T]=E[T].name;for(var S,_,x,R=o?"bin":"xml",o=i.workbooks[0].lastIndexOf("/"),A=(i.workbooks[0].slice(0,o+1)+"_rels/"+i.workbooks[0].slice(o+1)+".rels").replace(/^\//,""),N=(Vt(r,A)||(A="xl/_rels/workbook."+R+".rels"),pi($t(r,A,!0),A.replace(/_rels.*/,"s5s"))),O=(1<=(i.metadata||[]).length&&(t.xlmeta=Ru(D(r,rh(i.metadata[0])),i.metadata[0],t)),1<=(i.people||[]).length&&(t.people=(o=D(r,rh(i.people[0])),S=t,x=!(_=[]),o.replace(qt,function(e){var t;switch(Jt((t=pe(e))[0])){case"<?xml":case"<personList":case"</personList>":break;case"<person":_.push({name:t.displayname,id:t.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":x=!0;break;case"</ext>":x=!1;break;default:if(!x&&S.WTF)throw new Error("unrecognized "+t[0]+" in threaded comments")}return e}),_)),N=N&&eh(N,h.Sheets),D(r,"xl/worksheets/sheet.xml",!0)?1:0),w=0;w!=p.Worksheets;++w){var I="sheet";if(N&&N[w]?(y="xl/"+N[w][1].replace(/[\/]?xl\//,""),Vt(r,y)||(y=N[w][1]),Vt(r,y)||(y=A.replace(/_rels\/.*$/,"")+N[w][1]),I=N[w][2]):y=(y="xl/worksheets/sheet"+(w+1-O)+"."+R).replace(/sheet0\./,"sheet."),v=y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&null!=t.sheets)switch(typeof t.sheets){case"number":if(w!=t.sheets)continue;break;case"string":if(p.SheetNames[w].toLowerCase()!=t.sheets.toLowerCase())continue;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var M=!1,k=0;k!=t.sheets.length;++k)"number"==typeof t.sheets[k]&&t.sheets[k]==w&&(M=1),"string"==typeof t.sheets[k]&&t.sheets[k].toLowerCase()==p.SheetNames[w].toLowerCase()&&(M=1);if(!M)continue}}th(r,y,v,p.SheetNames[w],w,C,b,I,t,h,a,l)}m={Directory:i,Workbook:h,Props:p,Custprops:g,Deps:f,Sheets:b,SheetNames:p.SheetNames,Strings:lc,Styles:l,Themes:a,SSF:he(ue)},t&&t.bookFiles&&(r.files?(m.keys=e,m.files=r.files):(m.keys=[],m.files={},r.FullPaths.forEach(function(e,t){e=e.replace(/^Root Entry[\/]/,""),m.keys.push(e),m.files[e]=r.FileIndex[t]}))),t&&t.bookVBA&&(0<i.vba.length?m.vbaraw=D(r,rh(i.vba[0]),!0):i.defaults&&i.defaults.bin===bl&&(m.vbaraw=D(r,"xl/vbaProject.bin",!0)))}return m}function ih(e,t){var t=t||{},r="Workbook",n=X.find(e,r);try{if(r="/!DataSpaces/Version",!(n=X.find(e,r))||!n.content)throw new Error("ECMA-376 Encrypted file missing "+r);if((s=n.content)._R(0,"lpp4"),Js(s,4),Js(s,4),Js(s,4),r="/!DataSpaces/DataSpaceMap",!(n=X.find(e,r))||!n.content)throw new Error("ECMA-376 Encrypted file missing "+r);var i=Zs(n.content);if(1!==i.length||1!==i[0].comps.length||0!==i[0].comps[0].t||"StrongEncryptionDataSpace"!==i[0].name||"EncryptedPackage"!==i[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(n=X.find(e,r))||!n.content)throw new Error("ECMA-376 Encrypted file missing "+r);var o=function(e){for(var t=[],r=(e.l+=4,e._R(4));0<r--;)t.push(e._R(0,"lpp4"));return t}(n.content);if(1!=o.length||"StrongEncryptionTransform"!=o[0])throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(n=X.find(e,r))||!n.content)throw new Error("ECMA-376 Encrypted file missing "+r);Qs(n.content)}catch(e){}if(!(n=X.find(e,r="/EncryptionInfo"))||!n.content)throw new Error("ECMA-376 Encrypted file missing "+r);var s=ra(n.content),r="/EncryptedPackage";if(!(n=X.find(e,r))||!n.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(4==s[0]&&"undefined"!=typeof decrypt_agile)return decrypt_agile(s[1],n.content,t.password||"",t);if(2==s[0]&&"undefined"!=typeof decrypt_std76)return decrypt_std76(s[1],n.content,t.password||"",t);throw new Error("File is password-protected")}function oh(e,t){return("ods"==t.bookType?Ad:"numbers"==t.bookType?Xd:"xlsb"==t.bookType?function(e,t){pl=1024,e&&!e.SSF&&(e.SSF=he(ue));e&&e.SSF&&(Je(),Xe(e.SSF),t.revssf=Tt(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF);t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,uc?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xlsb"==t.bookType?"bin":"xml",n=-1<wl.indexOf(t.bookType),i=ui(),o=(Qd(t=t||{}),jt()),s="",a=0;t.cellXfs=[],fc(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});if(P(o,s="docProps/core.xml",Ei(e.Props,t)),i.coreprops.push(s),O(t.rels,2,s,A.CORE_PROPS),s="docProps/app.xml",!e.Props||!e.Props.SheetNames)if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,P(o,s,xi(e.Props)),i.extprops.push(s),O(t.rels,3,s,A.EXT_PROPS),e.Custprops!==e.Props&&0<oe(e.Custprops||{}).length&&(P(o,s="docProps/custom.xml",Ai(e.Custprops)),i.custprops.push(s),O(t.rels,4,s,A.CUST_PROPS));for(a=1;a<=e.SheetNames.length;++a){var u,d,h,p={"!id":{}},f=e.Sheets[e.SheetNames[a-1]];(f||{})["!type"];P(o,s="xl/worksheets/sheet"+a+"."+r,function(e,t,r,n,i){return(".bin"===t.slice(-4)?tu:Vc)(e,r,n,i)}(a-1,s,t,e,p)),i.sheets.push(s),O(t.wbrels,-1,"worksheets/sheet"+a+"."+r,A.WS[0]),f&&(u=f["!comments"],d=!1,h="",u&&0<u.length&&(P(o,h="xl/comments"+a+"."+r,function(e,t,r){return(".bin"===t.slice(-4)?vl:ml)(e,r)}(u,h,t)),i.comments.push(h),O(p,-1,"../comments"+a+"."+r,A.CMNT),d=!0),f["!legacy"]&&d&&P(o,"xl/drawings/vmlDrawing"+a+".vml",fl(a,f["!comments"])),delete f["!comments"],delete f["!legacy"]),p["!id"].rId1&&P(o,hi(s),fi(p))}null!=t.Strings&&0<t.Strings.length&&(P(o,s="xl/sharedStrings."+r,function(e,t,r){return(".bin"===t.slice(-4)?Ks:Gs)(e,r)}(t.Strings,s,t)),i.strs.push(s),O(t.wbrels,-1,"sharedStrings."+r,A.SST));P(o,s="xl/workbook."+r,function(e,t,r){return(".bin"===t.slice(-4)?vu:fu)(e,r)}(e,s,t)),i.workbooks.push(s),O(t.rels,1,s,A.WB),P(o,s="xl/theme/theme1.xml",ll(e.Themes,t)),i.themes.push(s),O(t.wbrels,-1,"theme/theme1.xml",A.THEME),P(o,s="xl/styles."+r,function(e,t,r){return(".bin"===t.slice(-4)?Za:Ua)(e,r)}(e,s,t)),i.styles.push(s),O(t.wbrels,-1,"styles."+r,A.STY),e.vbaraw&&n&&(P(o,s="xl/vbaProject.bin",e.vbaraw),i.vba.push(s),O(t.wbrels,-1,"vbaProject.bin",A.VBA));return P(o,s="xl/metadata."+r,function(e){return(".bin"===e.slice(-4)?dl:hl)()}(s)),i.metadata.push(s),O(t.wbrels,-1,"metadata."+r,A.XLMETA),P(o,"[Content_Types].xml",di(i,t)),P(o,"_rels/.rels",fi(t.rels)),P(o,"xl/_rels/workbook."+r+".rels",fi(t.wbrels)),delete t.revssf,delete t.ssf,o}:sh)(e,t)}function sh(e,t){pl=1024,e&&!e.SSF&&(e.SSF=he(ue)),e&&e.SSF&&(Je(),Xe(e.SSF),t.revssf=Tt(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,uc?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=-1<wl.indexOf(t.bookType),i=ui(),o=(Qd(t=t||{}),jt()),s="",a=0;if(t.cellXfs=[],fc(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),P(o,s="docProps/core.xml",Ei(e.Props,t)),i.coreprops.push(s),O(t.rels,2,s,A.CORE_PROPS),s="docProps/app.xml",!e.Props||!e.Props.SheetNames)if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,P(o,s,xi(e.Props)),i.extprops.push(s),O(t.rels,3,s,A.EXT_PROPS),e.Custprops!==e.Props&&0<oe(e.Custprops||{}).length&&(P(o,s="docProps/custom.xml",Ai(e.Custprops)),i.custprops.push(s),O(t.rels,4,s,A.CUST_PROPS));var u,d=["SheetJ5"];for(t.tcid=0,a=1;a<=e.SheetNames.length;++a){var h,p,f,g,m={"!id":{}},y=e.Sheets[e.SheetNames[a-1]];(y||{})["!type"];P(o,s="xl/worksheets/sheet"+a+"."+r,Vc(a-1,t,e,m)),i.sheets.push(s),O(t.wbrels,-1,"worksheets/sheet"+a+"."+r,A.WS[0]),y&&(p=!1,f="",(h=y["!comments"])&&0<h.length&&(g=!1,h.forEach(function(e){e[1].forEach(function(e){1==e.T&&(g=!0)})}),g&&(P(o,f="xl/threadedComments/threadedComment"+a+"."+r,function(e,o,s){var a=[C,T("ThreadedComments",null,{xmlns:Nr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(n){var i="";(n[1]||[]).forEach(function(e,t){var r;e.T?(e.a&&-1==o.indexOf(e.a)&&o.push(e.a),r={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+s.tcid++).slice(-12)+"}"},0==t?i=r.id:r.parentId=i,e.ID=r.id,e.a&&(r.personId="{54EE7950-7262-4200-6969-"+("000000000000"+o.indexOf(e.a)).slice(-12)+"}"),a.push(T("threadedComment",Sr("text",e.t||""),r))):delete e.ID})}),a.push("</ThreadedComments>"),a.join("")}(h,d,t)),i.threadedcomments.push(f),O(m,-1,"../threadedComments/threadedComment"+a+"."+r,A.TCMNT)),P(o,f="xl/comments"+a+"."+r,ml(h)),i.comments.push(f),O(m,-1,"../comments"+a+"."+r,A.CMNT),p=!0),y["!legacy"]&&p&&P(o,"xl/drawings/vmlDrawing"+a+".vml",fl(a,y["!comments"])),delete y["!comments"],delete y["!legacy"]),m["!id"].rId1&&P(o,hi(s),fi(m))}return null!=t.Strings&&0<t.Strings.length&&(P(o,s="xl/sharedStrings.xml",Gs(t.Strings,t)),i.strs.push(s),O(t.wbrels,-1,"sharedStrings.xml",A.SST)),P(o,s="xl/workbook.xml",fu(e)),i.workbooks.push(s),O(t.rels,1,s,A.WB),P(o,s="xl/theme/theme1.xml",ll(e.Themes,t)),i.themes.push(s),O(t.wbrels,-1,"theme/theme1.xml",A.THEME),P(o,s="xl/styles.xml",Ua(e,t)),i.styles.push(s),O(t.wbrels,-1,"styles.xml",A.STY),e.vbaraw&&n&&(P(o,s="xl/vbaProject.bin",e.vbaraw),i.vba.push(s),O(t.wbrels,-1,"vbaProject.bin",A.VBA)),P(o,s="xl/metadata.xml",hl()),i.metadata.push(s),O(t.wbrels,-1,"metadata.xml",A.XLMETA),1<d.length&&(P(o,s="xl/persons/person.xml",(n=d,u=[C,T("personList",null,{xmlns:Nr.TCMNT,"xmlns:x":Or[0]}).replace(/[\/]>/,">")],n.forEach(function(e,t){u.push(T("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+t).slice(-12)+"}",userId:e,providerId:"None"}))}),u.push("</personList>"),u.join(""))),i.people.push(s),O(t.wbrels,-1,"persons/person.xml",A.PEOPLE)),P(o,"[Content_Types].xml",di(i,t)),P(o,"_rels/.rels",fi(t.rels)),P(o,"xl/_rels/workbook.xml.rels",fi(t.wbrels)),delete t.revssf,delete t.ssf,o}function ah(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=_e(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function lh(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Du(e.slice(r),t);default:break e}return us.to_workbook(e,t)}function ch(e,t,r,n){return n?(r.type="string",us.to_workbook(e,r)):us.to_workbook(t,r)}function uh(e,t){m();var r=t||{};if("undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer)return uh(new Uint8Array(e),((r=he(r)).type="array",r));"undefined"!=typeof Uint8Array&&e instanceof Uint8Array&&!r.type&&(r.type="undefined"!=typeof Deno?"buffer":"array");var n,i,o=e,s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),cc={},r.dateNF&&(cc.dateNF=r.dateNF),r.type||(r.type=ce&&Buffer.isBuffer(e)?"buffer":"base64"),"file"==r.type&&(r.type=ce?"buffer":"binary",o=function(e){if(void 0!==yt)return yt.readFileSync(e);if("undefined"!=typeof Deno)return Deno.readFileSync(e);if("undefined"!=typeof $&&"undefined"!=typeof File&&"undefined"!=typeof Folder)try{var t=File(e),r=(t.open("r"),t.encoding="binary",t.read());return t.close(),r}catch(e){if(!e.message||!e.message.match(/onstruct/))throw e}throw new Error("Cannot access file "+e)}(e),"undefined"==typeof Uint8Array||ce||(r.type="array")),"string"==r.type&&(s=!0,r.type="binary",r.codepage=65001,o=(t=e).match(/[^\x00-\x7F]/)?mr(t):t),"array"==r.type&&"undefined"!=typeof Uint8Array&&e instanceof Uint8Array&&"undefined"!=typeof ArrayBuffer){t=new ArrayBuffer(3),t=new Uint8Array(t);if(t.foo="bar",!t.foo)return(r=he(r)).type="array",uh(v(o),r)}switch((n=ah(o,r))[0]){case 208:if(207===n[1]&&17===n[2]&&224===n[3]&&161===n[4]&&177===n[5]&&26===n[6]&&225===n[7])return a=X.read(o,r),l=r,(X.find(a,"EncryptedPackage")?ih:Gu)(a,l);break;case 9:if(n[1]<=8)return Gu(o,r);break;case 60:return Du(o,r);case 73:if(73===n[1]&&42===n[2]&&0===n[3])throw new Error("TIFF Image File is not a spreadsheet");if(68!==n[1])break;var a=o,l=r,c=l||{},u=!!c.WTF;c.WTF=!0;try{var d=Go.to_workbook(a,c);return c.WTF=u,d}catch(e){if(c.WTF=u,!e.message.match(/SYLK bad record ID/)&&u)throw e;return us.to_workbook(a,l)}return;case 84:if(65===n[1]&&66===n[2]&&76===n[3])return Xo.to_workbook(o,r);break;case 80:return 75===n[1]&&n[2]<9&&n[3]<9?(c=d=o,(u=(u=r)||{}).type||(u.type=ce&&Buffer.isBuffer(d)?"buffer":"base64"),nh(zt(c,u),u)):ch(e,o,r,s);case 239:return 60===n[3]?Du(o,r):ch(e,o,r,s);case 255:if(254===n[1])return g=o,"base64"==(i=r).type&&(g=_e(g)),g=ae.utils.decode(1200,g.slice(2),"str"),i.type="binary",lh(g,i);if(0===n[1]&&2===n[2]&&0===n[3])return ws.to_workbook(o,r);break;case 0:if(0===n[1]){if(2<=n[2]&&0===n[3])return ws.to_workbook(o,r);if(0===n[2]&&(8===n[3]||9===n[3]))return ws.to_workbook(o,r)}break;case 3:case 131:case 139:case 140:return Wo.to_workbook(o,r);case 123:if(92===n[1]&&114===n[2]&&116===n[3])return ha.to_workbook(o,r);break;case 10:case 13:case 32:var h=o,p=r,f="",g=ah(h,p);switch(p.type){case"base64":f=_e(h);break;case"binary":f=h;break;case"buffer":f=h.toString("binary");break;case"array":f=Mt(h);break;default:throw new Error("Unrecognized type "+p.type)}return 239==g[0]&&187==g[1]&&191==g[2]&&(f=me(f)),p.type="binary",lh(f,p);case 137:if(80===n[1]&&78===n[2]&&71===n[3])throw new Error("PNG Image File is not a spreadsheet")}return-1<Vo.indexOf(n[0])&&n[2]<=12&&n[3]<=31?Wo.to_workbook(o,r):ch(e,o,r,s)}function dh(e,t){t=t||{};return t.type="file",uh(e,t)}function hh(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return wt(t.file,X.write(e,{type:ce?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return X.write(e,t)}function ph(e,t){var r={},n=ce?"nodebuffer":"undefined"!=typeof Uint8Array?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}e=e.FullPaths?X.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if("undefined"!=typeof Deno&&"string"==typeof e){if("binary"==t.type||"base64"==t.type)return e;e=new Uint8Array(l(e))}return t.password&&"undefined"!=typeof encrypt_agile?hh(encrypt_agile(e,t.password),t):"file"===t.type?wt(t.file,e):"string"==t.type?me(e):e}function fh(e,t,r){var n=(r=r||"")+e;switch(t.type){case"base64":return J(mr(n));case"binary":return mr(n);case"string":return e;case"file":return wt(t.file,n,"utf8");case"buffer":return ce?w(n,"utf8"):"undefined"!=typeof TextEncoder?(new TextEncoder).encode(n):fh(n,{type:"binary"}).split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function gh(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return"base64"==t.type?J(r):"string"==t.type?me(r):r;case"file":return wt(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function mh(e,t){m(),hu(e);var r,t=he(t||{});return t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),"array"==t.type?(t.type="binary",r=mh(e,t),t.type="array",l(r)):(r=e,e=he((e=t)||{}),ph(sh(r,e),e))}function yh(e,t){m(),hu(e);var r=he(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),"array"==r.type)return r.type="binary",t=yh(e,r),r.type="array",l(t);var n,i,o=0;if(r.sheet&&(o="number"==typeof r.sheet?r.sheet:e.SheetNames.indexOf(r.sheet),!e.SheetNames[o]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return fh(Vu(e,r),r);case"slk":case"sylk":return fh(Go.from_sheet(e.Sheets[e.SheetNames[o]],r),r);case"htm":case"html":return fh(pd(e.Sheets[e.SheetNames[o]],r),r);case"txt":var s=_h(e.Sheets[e.SheetNames[o]],r),a=r;switch(a.type){case"base64":return J(s);case"binary":case"string":return s;case"file":return wt(a.file,s,"binary");case"buffer":return ce?w(s,"binary"):s.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+a.type);case"csv":return fh(Sh(e.Sheets[e.SheetNames[o]],r),r,"\ufeff");case"dif":return fh(Xo.from_sheet(e.Sheets[e.SheetNames[o]],r),r);case"dbf":return gh(Wo.from_sheet(e.Sheets[e.SheetNames[o]],r),r);case"prn":return fh(us.from_sheet(e.Sheets[e.SheetNames[o]],r),r);case"rtf":return fh(ha.from_sheet(e.Sheets[e.SheetNames[o]],r),r);case"eth":return fh(os.from_sheet(e.Sheets[e.SheetNames[o]],r),r);case"fods":return fh(Ad(e,r),r);case"wk1":return gh(ws.sheet_to_wk1(e.Sheets[e.SheetNames[o]],r),r);case"wk3":return gh(ws.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),gh(ad(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),hh(qu(e,i=(i=r)||{}),i);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return i=e,n=he((n=r)||{}),ph(oh(i,n),n);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function vh(e){var t;e.bookType||((t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase()).match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[e.bookType]||e.bookType)}function bh(e,t,r){r=r||{};return r.type="file",r.file=t,vh(r),yh(e,r)}function wh(e,t,r,n,i,o,s,a){var l=ve(r),c=a.defval,u=a.raw||!Object.prototype.hasOwnProperty.call(a,"raw"),d=!0,h=1===i?[]:{};if(1!==i)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch(e){h.__rowNum__=r}else h.__rowNum__=r;if(!s||e[r])for(var p=t.s.c;p<=t.e.c;++p){var f=s?e[r][p]:e[n[p]+l];if(void 0===f||void 0===f.t)void 0!==c&&null!=o[p]&&(h[o[p]]=c);else{var g=f.v;switch(f.t){case"z":if(null==g)break;continue;case"e":g=0==g?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+f.t)}if(null!=o[p]){if(null==g)if("e"==f.t&&null===g)h[o[p]]=null;else if(void 0!==c)h[o[p]]=c;else{if(!u||null!==g)continue;h[o[p]]=null}else h[o[p]]=u&&("n"!==f.t||"n"===f.t&&!1!==a.rawNumbers)?g:Sn(f,g,a);null!=g&&(d=!1)}}}return{row:h,isempty:d}}function Ch(e,t){if(null==e||null==e["!ref"])return[];var r,n={t:"n",v:0},i=0,o=1,s=[],a="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=null!=c.range?c.range:e["!ref"];switch(1===c.header?i=1:"A"===c.header?i=2:Array.isArray(c.header)?i=3:null==c.header&&(i=0),typeof u){case"string":l=Ce(u);break;case"number":(l=Ce(e["!ref"])).s.r=u;break;default:l=u}0<i&&(o=0);for(var d,h=ve(l.s.r),p=[],f=[],g=0,m=0,y=Array.isArray(e),v=l.s.r,b=0,w={},C=(y&&!e[v]&&(e[v]=[]),c.skipHidden&&e["!cols"]||[]),E=c.skipHidden&&e["!rows"]||[],b=l.s.c;b<=l.e.c;++b)if(!(C[b]||{}).hidden)switch(p[b]=be(b),n=y?e[v][b]:e[p[b]+h],i){case 1:s[b]=b-l.s.c;break;case 2:s[b]=p[b];break;case 3:s[b]=c.header[b-l.s.c];break;default:if(a=r=Sn(n=null==n?{w:"__EMPTY",t:"s"}:n,null,c),m=w[r]||0){for(;w[a=r+"_"+m++];);w[r]=m,w[a]=1}else w[r]=1;s[b]=a}for(v=l.s.r+o;v<=l.e.r;++v)!(E[v]||{}).hidden&&(!1===(d=wh(e,l,v,p,i,s,y,c)).isempty||(1===i?!1!==c.blankrows:c.blankrows))&&(f[g++]=d.row);return f.length=g,f}var Eh=/"/g;function Th(e,t,r,n,i,o,s,a){for(var l=!0,c=[],u="",d=ve(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var p=a.dense?(e[r]||[])[h]:e[n[h]+d];if(null==p)u="";else if(null!=p.v){for(var f,l=!1,u=""+(a.rawNumbers&&"n"==p.t?p.v:Sn(p,null,a)),g=0;g!==u.length;++g)if((f=u.charCodeAt(g))===i||f===o||34===f||a.forceQuotes){u='"'+u.replace(Eh,'""')+'"';break}"ID"==u&&(u='"ID"')}else null==p.f||p.F?u="":(l=!1,0<=(u="="+p.f).indexOf(",")&&(u='"'+u.replace(Eh,'""')+'"'));c.push(u)}return!1===a.blankrows&&l?null:c.join(s)}function Sh(e,t){var r=[],n=null==t?{}:t;if(null==e||null==e["!ref"])return"";for(var i=Ce(e["!ref"]),o=void 0!==n.FS?n.FS:",",s=o.charCodeAt(0),a=void 0!==n.RS?n.RS:"\n",l=a.charCodeAt(0),c=new RegExp(("|"==o?"\\|":o)+"+$"),u="",d=[],h=(n.dense=Array.isArray(e),n.skipHidden&&e["!cols"]||[]),p=n.skipHidden&&e["!rows"]||[],f=i.s.c;f<=i.e.c;++f)(h[f]||{}).hidden||(d[f]=be(f));for(var g=0,m=i.s.r;m<=i.e.r;++m)(p[m]||{}).hidden||null==(u=Th(e,i,m,d,s,l,o,n))||!(u=n.strip?u.replace(c,""):u)&&!1===n.blankrows||r.push((g++?a:"")+u);return delete n.dense,r.join("")}function _h(e,t){(t=t||{}).FS="\t",t.RS="\n";e=Sh(e,t);return void 0===ae||"string"==t.type?e:(t=ae.utils.encode(1200,e,"str"),String.fromCharCode(255)+String.fromCharCode(254)+t)}function xh(e,t,r){var s,a=r||{},l=+!a.skipHeader,c=e||{},u=0,d=0,e=(c&&null!=a.origin&&("number"==typeof a.origin?u=a.origin:(r="string"==typeof a.origin?W(a.origin):a.origin,u=r.r,d=r.c)),{s:{c:0,r:0},e:{c:d,r:u+t.length-1+l}}),h=(c["!ref"]?(r=Ce(c["!ref"]),e.e.c=Math.max(e.e.c,r.e.c),e.e.r=Math.max(e.e.r,r.e.r),-1==u&&(u=r.e.r+1,e.e.r=u+t.length-1+l)):-1==u&&(u=0,e.e.r=t.length-1+l),a.header||[]),p=0,n=(t.forEach(function(i,o){oe(i).forEach(function(e){-1==(p=h.indexOf(e))&&(h[p=h.length]=e);var e=i[e],t="z",r="",n=se({c:d+p,r:u+o+l});s=Rh(c,n),!e||"object"!=typeof e||e instanceof Date?("number"==typeof e?t="n":"boolean"==typeof e?t="b":"string"==typeof e?t="s":e instanceof Date?(t="d",a.cellDates||(t="n",e=_t(e)),r=a.dateNF||ue[14]):null===e&&a.nullError&&(t="e",e=0),s?(s.t=t,s.v=e,delete s.w,delete s.R,r&&(s.z=r)):c[n]=s={t:t,v:e},r&&(s.z=r)):c[n]=e})}),e.e.c=Math.max(e.e.c,d+h.length-1),ve(u));if(l)for(p=0;p<h.length;++p)c[be(p+d)+n]={t:"s",v:h[p]};return c["!ref"]=we(e),c}function Rh(e,t,r){var n;return"string"==typeof t?Array.isArray(e)?(e[(n=W(t)).r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})):e[t]||(e[t]={t:"z"}):Rh(e,se("number"!=typeof t?t:{r:t,c:r||0}))}function Ah(){return{SheetNames:[],Sheets:{}}}function Nh(e,t,r,n){var i=1;if(!r)for(;i<=65535&&-1!=e.SheetNames.indexOf(r="Sheet"+i);++i,r=void 0);if(!r||65535<=e.SheetNames.length)throw new Error("Too many worksheets");if(n&&0<=e.SheetNames.indexOf(r)){var n=r.match(/(^.*?)(\d+)$/),i=n&&+n[2]||0,o=n&&n[1]||r;for(++i;i<=65535&&-1!=e.SheetNames.indexOf(r=o+i);++i);}if(du(r),0<=e.SheetNames.indexOf(r))throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function Oh(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}var Ih,Ga={encode_col:be,encode_row:ve,encode_cell:se,encode_range:we,decode_col:Cn,decode_row:wn,split_cell:function(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:W,decode_range:En,format_cell:Sn,sheet_add_aoa:xn,sheet_add_json:xh,sheet_add_dom:fd,aoa_to_sheet:Rn,json_to_sheet:function(e,t){return xh(null,e,t)},table_to_sheet:gd,table_to_book:function(e,t){return _n(gd(e,t),t)},sheet_to_csv:Sh,sheet_to_txt:_h,sheet_to_json:Ch,sheet_to_html:pd,sheet_to_formulae:function(e){var t,r="",n="";if(null==e||null==e["!ref"])return[];for(var i,o=Ce(e["!ref"]),s=[],a=[],l=Array.isArray(e),c=o.s.c;c<=o.e.c;++c)s[c]=be(c);for(var u=o.s.r;u<=o.e.r;++u)for(i=ve(u),c=o.s.c;c<=o.e.c;++c)if(r=s[c]+i,n="",void 0!==(t=l?(e[u]||[])[c]:e[r])){if(null!=t.F){if(r=t.F,!t.f)continue;n=t.f,-1==r.indexOf(":")&&(r=r+":"+r)}if(null!=t.f)n=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)n=""+t.v;else if("b"==t.t)n=t.v?"TRUE":"FALSE";else if(void 0!==t.w)n="'"+t.w;else{if(void 0===t.v)continue;n="s"==t.t?"'"+t.v:""+t.v}}a[a.length]=r+"="+n}return a},sheet_to_row_object_array:Ch,sheet_get_cell:Rh,book_new:Ah,book_append_sheet:Nh,book_set_sheet_visibility:function(e,t,r){switch(e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]),t=function(e,t){if("number"==typeof t){if(0<=t&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"!=typeof t)throw new Error("Cannot find sheet |"+t+"|");if(-1<(e=e.SheetNames.indexOf(t)))return e;throw new Error("Cannot find sheet name |"+t+"|")}(e,t),e.Workbook.Sheets[t]||(e.Workbook.Sheets[t]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[t].Hidden=r},cell_set_number_format:function(e,t){return e.z=t,e},cell_set_hyperlink:Oh,cell_set_internal_link:function(e,t,r){return Oh(e,"#"+t,r)},cell_add_comment:function(e,t,r){e.c||(e.c=[]),e.c.push({t:t,a:r||"SheetJS"})},sheet_set_array_formula:function(e,t,r,n){for(var i="string"!=typeof t?t:Ce(t),o="string"==typeof t?t:we(t),s=i.s.r;s<=i.e.r;++s)for(var a=i.s.c;a<=i.e.c;++a){var l=Rh(e,s,a);l.t="n",l.F=o,delete l.v,s==i.s.r&&a==i.s.c&&(l.f=r,n)&&(l.D=!0)}return e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function Mh(e){Ih=e}$c={to_json:function(t,e){var r=Ih({objectMode:!0});if(null==t||null==t["!ref"])r.push(null);else{var n,i={t:"n",v:0},o=0,s=1,a=[],l="",c={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},d=null!=u.range?u.range:t["!ref"];switch(1===u.header?o=1:"A"===u.header?o=2:Array.isArray(u.header)&&(o=3),typeof d){case"string":c=Ce(d);break;case"number":(c=Ce(t["!ref"])).s.r=d;break;default:c=d}0<o&&(s=0);for(var h=ve(c.s.r),p=[],f=0,g=Array.isArray(t),m=c.s.r,y=0,v={},b=(g&&!t[m]&&(t[m]=[]),u.skipHidden&&t["!cols"]||[]),w=u.skipHidden&&t["!rows"]||[],y=c.s.c;y<=c.e.c;++y)if(!(b[y]||{}).hidden)switch(p[y]=be(y),i=g?t[m][y]:t[p[y]+h],o){case 1:a[y]=y-c.s.c;break;case 2:a[y]=p[y];break;case 3:a[y]=u.header[y-c.s.c];break;default:if(l=n=Sn(i=null==i?{w:"__EMPTY",t:"s"}:i,null,u),f=v[n]||0){for(;v[l=n+"_"+f++];);v[n]=f,v[l]=1}else v[n]=1;a[y]=l}m=c.s.r+s,r._read=function(){for(;m<=c.e.r;)if(!(w[m-1]||{}).hidden){var e=wh(t,c,m,p,o,a,g,u);if(++m,!1===e.isempty||(1===o?!1!==u.blankrows:u.blankrows))return void r.push(e.row)}return r.push(null)}}return r},to_html:function(e,t){var r=Ih(),n=t||{},t=null!=n.header?n.header:ud,i=null!=n.footer?n.footer:dd,o=(r.push(t),En(e["!ref"])),s=(n.dense=Array.isArray(e),r.push(hd(0,0,n)),o.s.r),a=!1;return r._read=function(){if(s>o.e.r)return a||(a=!0,r.push("</table>"+i)),r.push(null);for(;s<=o.e.r;){r.push(cd(e,o,s,n)),++s;break}},r},to_csv:function(e,t){var r=Ih(),n=null==t?{}:t;if(null==e||null==e["!ref"])r.push(null);else{for(var i=Ce(e["!ref"]),o=void 0!==n.FS?n.FS:",",s=o.charCodeAt(0),a=void 0!==n.RS?n.RS:"\n",l=a.charCodeAt(0),c=new RegExp(("|"==o?"\\|":o)+"+$"),u="",d=[],h=(n.dense=Array.isArray(e),n.skipHidden&&e["!cols"]||[]),p=n.skipHidden&&e["!rows"]||[],f=i.s.c;f<=i.e.c;++f)(h[f]||{}).hidden||(d[f]=be(f));var g=i.s.r,m=!1,y=0;r._read=function(){if(!m)return m=!0,r.push("\ufeff");for(;g<=i.e.r;)if(!(p[++g-1]||{}).hidden&&null!=(u=Th(e,i,g-1,d,s,l,o,n))&&((u=n.strip?u.replace(c,""):u)||!1!==n.blankrows))return r.push((y++?a:"")+u);return r.push(null)}}return r},set_readable:Mh};s.parse_xlscfb=Gu,s.parse_zip=nh,s.read=uh,s.readFile=dh,s.readFileSync=dh,s.write=yh,s.writeFile=bh,s.writeFileSync=bh,s.writeFileAsync=function(e,t,r,n){var i=r||{};return i.type="file",i.file=e,vh(i),i.type="buffer",n instanceof Function||(n=r),yt.writeFile(e,yh(t,i),n)},s.utils=Ga,s.writeXLSX=mh,s.writeFileXLSX=function(e,t,r){return(r=r||{}).type="file",r.file=t,vh(r),mh(e,r)},s.SSF=Ze,void 0!==$c&&(s.stream=$c),void 0!==X&&(s.CFB=X),"undefined"!=typeof require&&{}.Readable&&Mh((void 0).Readable)}if("undefined"!=typeof exports?make_xlsx_lib(exports):"undefined"!=typeof module&&module.exports?make_xlsx_lib(module.exports):"function"==typeof define&&define.amd?define("xlsx",function(){return XLSX.version||make_xlsx_lib(XLSX),XLSX}):make_xlsx_lib(XLSX),"undefined"!=typeof window&&!window.XLSX)try{window.XLSX=XLSX}catch(e){}!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Handsontable",[],t):"object"==typeof exports?exports.Handsontable=t():e.Handsontable=t()}("undefined"!=typeof self?self:this,()=>(()=>{var r=[(e,t,r)=>{"use strict";r.r(t),r.d(t,{AlwaysDense:()=>s.AlwaysDense,AlwaysSparse:()=>s.AlwaysSparse,ArraySize:()=>n.ArraySize,CellError:()=>i.CellError,CellType:()=>i.CellType,CellValueDetailedType:()=>i.CellValueDetailedType,CellValueType:()=>i.CellValueType,ConfigValueTooBigError:()=>a.ConfigValueTooBigError,ConfigValueTooSmallError:()=>a.ConfigValueTooSmallError,DenseSparseChooseBasedOnThreshold:()=>s.DenseSparseChooseBasedOnThreshold,DetailedCellError:()=>o.DetailedCellError,EmptyValue:()=>d.EmptyValue,ErrorType:()=>i.ErrorType,EvaluationSuspendedError:()=>a.EvaluationSuspendedError,ExpectedOneOfValuesError:()=>a.ExpectedOneOfValuesError,ExpectedValueOfTypeError:()=>a.ExpectedValueOfTypeError,ExportedCellChange:()=>l.ExportedCellChange,ExportedNamedExpressionChange:()=>l.ExportedNamedExpressionChange,FunctionArgumentType:()=>d.FunctionArgumentType,FunctionPlugin:()=>d.FunctionPlugin,FunctionPluginValidationError:()=>a.FunctionPluginValidationError,HyperFormula:()=>c.HyperFormula,InvalidAddressError:()=>a.InvalidAddressError,InvalidArgumentsError:()=>a.InvalidArgumentsError,LanguageAlreadyRegisteredError:()=>a.LanguageAlreadyRegisteredError,LanguageNotRegisteredError:()=>a.LanguageNotRegisteredError,MissingTranslationError:()=>a.MissingTranslationError,NamedExpressionDoesNotExistError:()=>a.NamedExpressionDoesNotExistError,NamedExpressionNameIsAlreadyTakenError:()=>a.NamedExpressionNameIsAlreadyTakenError,NamedExpressionNameIsInvalidError:()=>a.NamedExpressionNameIsInvalidError,NoOperationToRedoError:()=>a.NoOperationToRedoError,NoOperationToUndoError:()=>a.NoOperationToUndoError,NoRelativeAddressesAllowedError:()=>a.NoRelativeAddressesAllowedError,NoSheetWithIdError:()=>a.NoSheetWithIdError,NoSheetWithNameError:()=>a.NoSheetWithNameError,NotAFormulaError:()=>a.NotAFormulaError,NothingToPasteError:()=>a.NothingToPasteError,ProtectedFunctionTranslationError:()=>a.ProtectedFunctionTranslationError,SheetNameAlreadyTakenError:()=>a.SheetNameAlreadyTakenError,SheetSizeLimitExceededError:()=>a.SheetSizeLimitExceededError,SimpleRangeValue:()=>p.SimpleRangeValue,SourceLocationHasArrayError:()=>a.SourceLocationHasArrayError,TargetLocationHasArrayError:()=>a.TargetLocationHasArrayError,UnableToParseError:()=>a.UnableToParseError,default:()=>g});var n=r(1),i=r(3),o=r(100),t=r(101),s=r(105),a=r(77),l=r(128),c=r(110),u=r(146),d=r(96),h=r(147),p=r(69);class f extends c.HyperFormula{}f.HyperFormula=c.HyperFormula,f.ErrorType=i.ErrorType,f.CellError=i.CellError,f.CellType=i.CellType,f.CellValueType=i.CellValueType,f.CellValueDetailedType=i.CellValueDetailedType,f.DetailedCellError=o.DetailedCellError,f.ExportedCellChange=l.ExportedCellChange,f.ExportedNamedExpressionChange=l.ExportedNamedExpressionChange,f.ConfigValueTooBigError=a.ConfigValueTooBigError,f.ConfigValueTooSmallError=a.ConfigValueTooSmallError,f.EvaluationSuspendedError=a.EvaluationSuspendedError,f.ExpectedOneOfValuesError=a.ExpectedOneOfValuesError,f.ExpectedValueOfTypeError=a.ExpectedValueOfTypeError,f.ArraySize=n.ArraySize,f.SimpleRangeValue=p.SimpleRangeValue,f.EmptyValue=d.EmptyValue,f.FunctionPlugin=d.FunctionPlugin,f.FunctionArgumentType=d.FunctionArgumentType,f.FunctionPluginValidationError=a.FunctionPluginValidationError,f.InvalidAddressError=a.InvalidAddressError,f.InvalidArgumentsError=a.InvalidArgumentsError,f.LanguageNotRegisteredError=a.LanguageNotRegisteredError,f.LanguageAlreadyRegisteredError=a.LanguageAlreadyRegisteredError,f.MissingTranslationError=a.MissingTranslationError,f.NamedExpressionDoesNotExistError=a.NamedExpressionDoesNotExistError,f.NamedExpressionNameIsAlreadyTakenError=a.NamedExpressionNameIsAlreadyTakenError,f.NamedExpressionNameIsInvalidError=a.NamedExpressionNameIsInvalidError,f.NoOperationToRedoError=a.NoOperationToRedoError,f.NoOperationToUndoError=a.NoOperationToUndoError,f.NoRelativeAddressesAllowedError=a.NoRelativeAddressesAllowedError,f.NoSheetWithIdError=a.NoSheetWithIdError,f.NoSheetWithNameError=a.NoSheetWithNameError,f.NotAFormulaError=a.NotAFormulaError,f.NothingToPasteError=a.NothingToPasteError,f.ProtectedFunctionTranslationError=a.ProtectedFunctionTranslationError,f.SheetNameAlreadyTakenError=a.SheetNameAlreadyTakenError,f.SheetSizeLimitExceededError=a.SheetSizeLimitExceededError,f.SourceLocationHasArrayError=a.SourceLocationHasArrayError,f.TargetLocationHasArrayError=a.TargetLocationHasArrayError,f.UnableToParseError=a.UnableToParseError;t=t.Config.defaultConfig.language;c.HyperFormula.registerLanguage(t,u.default),c.HyperFormula.languages[u.default.langCode]=u.default;for(const m of Object.getOwnPropertyNames(h))m.startsWith("_")||c.HyperFormula.registerFunctionPlugin(h[m]);const g=f;window.HyperFormula=r(0).default},(e,t,r)=>{"use strict";r.r(t),r.d(t,{ArraySize:()=>h,ArraySizePredictor:()=>n});var u=r(2),l=r(95),c=r(96),d=r(7);class h{constructor(e,t,r=!1){this.width=e,this.height=t,this.isRef=r}static error(){return new h(1,1,!0)}static scalar(){return new h(1,1,!1)}isScalar(){return 1===this.width&&1===this.height||this.isRef}}class n{constructor(e,t){this.config=e,this.functionRegistry=t}checkArraySize(e,t){return this.checkArraySizeForAst(e,{formulaAddress:t,arraysFlag:this.config.useArrayArithmetic})}checkArraySizeForAst(e,t){switch(e.type){case d.AstNodeType.FUNCTION_CALL:return this.checkArraySizeForFunction(e,t);case d.AstNodeType.COLUMN_RANGE:case d.AstNodeType.ROW_RANGE:case d.AstNodeType.CELL_RANGE:var r=u.AbsoluteCellRange.fromAstOrUndef(e,t.formulaAddress);return void 0===r?h.error():new h(r.width(),r.height(),!0);case d.AstNodeType.ARRAY:var n=[],i=[];for(const c of e.args){var o=c.map(e=>this.checkArraySizeForAst(e,t)),s=Math.min(...o.map(e=>e.height)),o=o.reduce((e,t)=>e+t.width,0);n.push(s),i.push(o)}var r=n.reduce((e,t)=>e+t,0),a=Math.min(...i);return new h(a,r);case d.AstNodeType.STRING:case d.AstNodeType.NUMBER:return h.scalar();case d.AstNodeType.CELL_REFERENCE:return new h(1,1,!0);case d.AstNodeType.DIV_OP:case d.AstNodeType.CONCATENATE_OP:case d.AstNodeType.EQUALS_OP:case d.AstNodeType.GREATER_THAN_OP:case d.AstNodeType.GREATER_THAN_OR_EQUAL_OP:case d.AstNodeType.LESS_THAN_OP:case d.AstNodeType.LESS_THAN_OR_EQUAL_OP:case d.AstNodeType.MINUS_OP:case d.AstNodeType.NOT_EQUAL_OP:case d.AstNodeType.PLUS_OP:case d.AstNodeType.POWER_OP:case d.AstNodeType.TIMES_OP:a=this.checkArraySizeForAst(e.left,t),r=this.checkArraySizeForAst(e.right,t);return!t.arraysFlag&&(1<a.height||1<a.width||1<r.height||1<r.width)?h.error():(a=a,r=r,new h(Math.max(a.width,r.width),Math.max(a.height,r.height)));case d.AstNodeType.MINUS_UNARY_OP:case d.AstNodeType.PLUS_UNARY_OP:case d.AstNodeType.PERCENT_OP:var l=this.checkArraySizeForAst(e.value,t);return!t.arraysFlag&&(1<l.height||1<l.width)?h.error():(l=l,new h(l.width,l.height));case d.AstNodeType.PARENTHESIS:return this.checkArraySizeForAst(e.expression,t);default:d.AstNodeType.EMPTY;return h.error()}}checkArraySizeForFunction(e,t){var r=this.functionRegistry.getArraySizeFunction(e.procedureName);if(void 0!==r)return r(e,t);const n=this.functionRegistry.getMetadata(e.procedureName);if(void 0===n||n.expandRanges||!t.arraysFlag||n.vectorizationForbidden||void 0===n.parameters)return new h(1,1);var i=e.args.map(e=>{return this.checkArraySizeForAst(e,new l.InterpreterState(t.formulaAddress,t.arraysFlag||null!=(e=null===n||void 0===n?void 0:n.arrayFunction)&&e))}),o=[...n.parameters];if(void 0!==n.repeatLastArgs&&o.length<i.length&&(i.length-o.length)%n.repeatLastArgs!=0)return h.error();for(;o.length<i.length;){if(void 0===n.repeatLastArgs)return h.error();o.push(...o.slice(o.length-n.repeatLastArgs))}let s=1,a=1;for(let e=0;e<i.length;e++)o[e].argumentType!==c.FunctionArgumentType.RANGE&&o[e].argumentType!==c.FunctionArgumentType.ANY&&(a=Math.max(a,i[e].height),s=Math.max(s,i[e].width));return new h(s,a)}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{AbsoluteCellRange:()=>c,AbsoluteColumnRange:()=>u,AbsoluteRowRange:()=>d,WRONG_RANGE_SIZE:()=>a,isSimpleCellRange:()=>function(e){return!(!e||"object"!=typeof e&&"function"!=typeof e)&&"start"in e&&(0,s.isSimpleCellAddress)(e.start)&&"end"in e&&(0,s.isSimpleCellAddress)(e.end)},simpleCellRange:()=>l});var s=r(3),i=r(77),n=r(7),o=r(71);const a="AbsoluteCellRange: Wrong range size";const l=(e,t)=>({start:e,end:t});class c{constructor(e,t){if(e.sheet!==t.sheet)throw new i.SheetsNotEqual(e.sheet,t.sheet);this.start=(0,s.simpleCellAddress)(e.sheet,e.col,e.row),this.end=(0,s.simpleCellAddress)(t.sheet,t.col,t.row)}get sheet(){return this.start.sheet}static fromSimpleCellAddresses(e,t){if(e.sheet!==t.sheet)throw new i.SheetsNotEqual(e.sheet,t.sheet);var r=t.col-e.col,n=t.row-e.row;return Number.isFinite(n)&&Number.isFinite(r)?new c(e,t):Number.isFinite(n)?new d(e.sheet,e.row,t.row):new u(e.sheet,e.col,t.col)}static fromAst(e,t){return e.type===n.AstNodeType.CELL_RANGE?c.fromCellRange(e,t):e.type===n.AstNodeType.COLUMN_RANGE?u.fromColumnRange(e,t):d.fromRowRangeAst(e,t)}static fromAstOrUndef(e,t){try{return c.fromAst(e,t)}catch(e){}}static fromCellRange(e,t){return new c(e.start.toSimpleCellAddress(t),e.end.toSimpleCellAddress(t))}static spanFrom(e,t,r){e=c.spanFromOrUndef(e,t,r);if(void 0===e)throw new Error(a);return e}static spanFromOrUndef(e,t,r){return!Number.isFinite(t)&&Number.isFinite(r)?0!==e.col?void 0:new d(e.sheet,e.row,e.row+r-1):!Number.isFinite(r)&&Number.isFinite(t)?0!==e.row?void 0:new u(e.sheet,e.col,e.col+t-1):Number.isFinite(r)&&Number.isFinite(t)?new c(e,(0,s.simpleCellAddress)(e.sheet,e.col+t-1,e.row+r-1)):void 0}static fromCoordinates(e,t,r,n,i){return new c((0,s.simpleCellAddress)(e,t,r),(0,s.simpleCellAddress)(e,n,i))}isFinite(){return Number.isFinite(this.size())}doesOverlap(e){return this.start.sheet==e.start.sheet&&!(this.end.row<e.start.row||this.start.row>e.end.row||this.end.col<e.start.col||this.start.col>e.end.col)}addressInRange(e){return this.sheet===e.sheet&&this.start.row<=e.row&&this.end.row>=e.row&&this.start.col<=e.col&&this.end.col>=e.col}columnInRange(e){return this.sheet===e.sheet&&this.start.col<=e.col&&this.end.col>=e.col}rowInRange(e){return this.sheet===e.sheet&&this.start.row<=e.row&&this.end.row>=e.row}containsRange(e){return this.addressInRange(e.start)&&this.addressInRange(e.end)}intersectionWith(e){if(this.sheet===e.start.sheet){var t=Math.max(this.start.row,e.start.row),r=Math.min(this.end.row,e.end.row),n=Math.max(this.start.col,e.start.col),e=Math.min(this.end.col,e.end.col);if(!(r<t||e<n))return new c((0,s.simpleCellAddress)(this.sheet,n,t),(0,s.simpleCellAddress)(this.sheet,e,r))}}includesRow(e){return this.start.row<e&&this.end.row>=e}includesColumn(e){return this.start.col<e&&this.end.col>=e}shiftByRows(e){this.start.row+=e,this.end.row+=e}expandByRows(e){this.end.row+=e}shiftByColumns(e){this.start.col+=e,this.end.col+=e}shifted(e,t){return c.spanFrom((0,s.simpleCellAddress)(this.sheet,this.start.col+e,this.start.row+t),this.width(),this.height())}expandByColumns(e){this.end.col+=e}moveToSheet(e){this.start.sheet=e,this.end.sheet=e}removeSpan(e){e instanceof o.RowsSpan?this.removeRows(e.start,e.end):this.removeColumns(e.start,e.end)}shouldBeRemoved(){return this.width()<=0||this.height()<=0}rangeWithSameWidth(e,t){return c.spanFrom((0,s.simpleCellAddress)(this.sheet,this.start.col,e),this.width(),t)}rangeWithSameHeight(e,t){return c.spanFrom((0,s.simpleCellAddress)(this.sheet,e,this.start.row),t,this.height())}toString(){return`${this.start.sheet},${this.start.col},${this.start.row},${this.end.col},`+this.end.row}width(){return this.end.col-this.start.col+1}height(){return this.end.row-this.start.row+1}size(){return this.height()*this.width()}arrayOfAddressesInRange(){var r=[];for(let t=0;t<this.height();++t){r[t]=[];for(let e=0;e<this.width();++e){var n=(0,s.simpleCellAddress)(this.sheet,this.start.col+e,this.start.row+t);r[t].push(n)}}return r}withStart(e){return new c(e,this.end)}sameDimensionsAs(e){return this.width()===e.width()&&this.height()===e.height()}sameAs(e){return(0,s.equalSimpleCellAddress)(this.start,e.start)&&(0,s.equalSimpleCellAddress)(this.end,e.end)}addressesArrayMap(t,r){var n=[];let i=this.start.row;for(;i<=this.effectiveEndRow(t);){let e=this.start.col;for(var o=[];e<=this.effectiveEndColumn(t);)o.push(r((0,s.simpleCellAddress)(this.start.sheet,e,i))),e++;n.push(o),i++}return n}addresses(e){var t=[];let r=this.start.row;for(var n=this.effectiveEndRow(e),i=this.effectiveEndColumn(e);r<=n;){let e=this.start.col;for(;e<=i;)t.push((0,s.simpleCellAddress)(this.start.sheet,e,r)),e++;r++}return t}*addressesWithDirection(e,t,r){if(0<e)if(0<t){let t=this.effectiveEndRow(r);for(;t>=this.start.row;){let e=this.effectiveEndColumn(r);for(;e>=this.start.col;)yield(0,s.simpleCellAddress)(this.start.sheet,e,t),--e;--t}}else{let t=this.start.row;for(;t<=this.effectiveEndRow(r);){let e=this.effectiveEndColumn(r);for(;e>=this.start.col;)yield(0,s.simpleCellAddress)(this.start.sheet,e,t),--e;t+=1}}else if(0<t){let t=this.effectiveEndRow(r);for(;t>=this.start.row;){let e=this.start.col;for(;e<=this.effectiveEndColumn(r);)yield(0,s.simpleCellAddress)(this.start.sheet,e,t),e+=1;--t}}else{let t=this.start.row;for(;t<=this.effectiveEndRow(r);){let e=this.start.col;for(;e<=this.effectiveEndColumn(r);)yield(0,s.simpleCellAddress)(this.start.sheet,e,t),e+=1;t+=1}}}getAddress(e,t){if(e<0||t<0||t>this.height()-1||e>this.width()-1)throw Error("Index out of bound");return(0,s.simpleCellAddress)(this.start.sheet,this.start.col+e,this.start.row+t)}exceedsSheetSizeLimits(e,t){return this.end.col>=e||this.end.row>=t}effectiveEndColumn(e){return this.end.col}effectiveEndRow(e){return this.end.row}effectiveWidth(e){return this.width()}effectiveHeight(e){return this.height()}removeRows(e,t){if(!(e>this.end.row)){if(t<this.start.row)return this.shiftByRows(-(t-e+1));e<=this.start.row&&(this.start.row=e),this.end.row-=Math.min(t,this.end.row)-e+1}}removeColumns(e,t){if(!(e>this.end.col)){if(t<this.start.col)return this.shiftByColumns(-(t-e+1));e<=this.start.col&&(this.start.col=e),this.end.col-=Math.min(t,this.end.col)-e+1}}}class u extends c{constructor(e,t,r){super((0,s.simpleCellAddress)(e,t,0),(0,s.simpleCellAddress)(e,r,Number.POSITIVE_INFINITY))}static fromColumnRange(e,t){var r=e.start.toSimpleColumnAddress(t),e=e.end.toSimpleColumnAddress(t);if(r.sheet!==e.sheet)throw new i.SheetsNotEqual(r.sheet,e.sheet);return new u(r.sheet,r.col,e.col)}shouldBeRemoved(){return this.width()<=0}shiftByRows(e){}expandByRows(e){}shifted(e,t){return new u(this.sheet,this.start.col+e,this.end.col+e)}rangeWithSameHeight(e,t){return new u(this.sheet,e,e+t-1)}exceedsSheetSizeLimits(e,t){return this.end.col>=e}effectiveEndRow(e){return this.effectiveHeight(e)-1}effectiveHeight(e){return e.getSheetHeight(this.sheet)}removeRows(e,t){}}class d extends c{constructor(e,t,r){super((0,s.simpleCellAddress)(e,0,t),(0,s.simpleCellAddress)(e,Number.POSITIVE_INFINITY,r))}static fromRowRangeAst(e,t){var r=e.start.toSimpleRowAddress(t),e=e.end.toSimpleRowAddress(t);if(r.sheet!==e.sheet)throw new i.SheetsNotEqual(r.sheet,e.sheet);return new d(r.sheet,r.row,e.row)}shouldBeRemoved(){return this.height()<=0}shiftByColumns(e){}expandByColumns(e){}shifted(e,t){return new d(this.sheet,this.start.row+t,this.end.row+t)}rangeWithSameWidth(e,t){return new d(this.sheet,e,e+t-1)}exceedsSheetSizeLimits(e,t){return this.end.row>=t}effectiveEndColumn(e){return this.effectiveWidth(e)-1}effectiveWidth(e){return e.getSheetWidth(this.sheet)}removeColumns(e,t){}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{CellError:()=>v,CellType:()=>i,CellValueDetailedType:()=>p,CellValueJustNumber:()=>s,CellValueNoNumber:()=>o,CellValueType:()=>h,CellValueTypeOrd:()=>f,ErrorType:()=>n,absoluteSheetReference:()=>R,addressKey:()=>x,equalSimpleCellAddress:()=>A,getCellType:()=>d,getCellValueDetailedType:()=>m,getCellValueFormat:()=>y,getCellValueType:()=>g,invalidSimpleCellAddress:()=>S,invalidSimpleColumnAddress:()=>E,invalidSimpleRowAddress:()=>w,isSimpleCellAddress:()=>function(e){var t;return e&&("object"==typeof e||"function"==typeof e)&&"number"==typeof(null==(t=e)?void 0:t.sheet)&&"number"==typeof(null==(t=e)?void 0:t.col)&&"number"==typeof(null==(t=e)?void 0:t.row)},movedSimpleCellAddress:()=>_,simpleCellAddress:()=>T,simpleColumnAddress:()=>C,simpleRowAddress:()=>b});var n,i,o,s,a=r(4),l=r(61),c=r(70),u=r(69);(t=n=n||{}).DIV_BY_ZERO="DIV_BY_ZERO",t.NAME="NAME",t.VALUE="VALUE",t.NUM="NUM",t.NA="NA",t.CYCLE="CYCLE",t.REF="REF",t.SPILL="SPILL",t.LIC="LIC",t.ERROR="ERROR",(r=i=i||{}).FORMULA="FORMULA",r.VALUE="VALUE",r.ARRAY="ARRAY",r.EMPTY="EMPTY",r.ARRAYFORMULA="ARRAYFORMULA";const d=(e,t)=>e instanceof a.ArrayVertex?e.isLeftCorner(t)?i.ARRAYFORMULA:i.ARRAY:e instanceof a.FormulaCellVertex||e instanceof a.ParsingErrorVertex?i.FORMULA:e instanceof a.ValueCellVertex?i.VALUE:i.EMPTY,h=((t=o=o||{}).EMPTY="EMPTY",t.NUMBER="NUMBER",t.STRING="STRING",t.BOOLEAN="BOOLEAN",t.ERROR="ERROR",(s=s||{}).NUMBER="NUMBER",Object.assign(Object.assign({},o),s)),p=Object.assign(Object.assign({},o),c.NumberType),f=e=>{switch(e){case h.EMPTY:return 0;case h.NUMBER:return 1;case h.STRING:return 2;case h.BOOLEAN:return 3;case h.ERROR:return 4}throw new Error("Cell value not computed")},g=e=>{if(e===c.EmptyValue)return h.EMPTY;if(e instanceof v||e instanceof u.SimpleRangeValue)return h.ERROR;if("string"==typeof e)return h.STRING;if((0,c.isExtendedNumber)(e))return h.NUMBER;if("boolean"==typeof e)return h.BOOLEAN;throw new Error("Cell value not computed")},m=e=>((0,c.isExtendedNumber)(e)?(0,c.getTypeOfExtendedNumber):g)(e),y=e=>{if((0,c.isExtendedNumber)(e))return(0,c.getFormatOfExtendedNumber)(e)};class v{constructor(e,t,r){this.type=e,this.message=t,this.root=r}static parsingError(e){return new v(n.ERROR,l.ErrorMessage.ParseError+(e?" "+e:""))}attachRootVertex(e){return void 0===this.root?new v(this.type,this.message,e):this}}const b=(e,t)=>({sheet:e,row:t}),w=e=>e.row<0,C=(e,t)=>({sheet:e,col:t}),E=e=>e.col<0,T=(e,t,r)=>({sheet:e,col:t,row:r}),S=e=>e.col<0||e.row<0,_=(e,t,r,n)=>T(t,e.col+r,e.row+n),x=e=>`${e.sheet},${e.row},`+e.col;const R=(e,t)=>{return null!=(e=e.sheet)?e:t.sheet},A=(e,t)=>e.sheet===t.sheet&&e.col===t.col&&e.row===t.row},(e,t,r)=>{"use strict";r.r(t),r.d(t,{AddressMapping:()=>i.AddressMapping,ArrayMapping:()=>c.ArrayMapping,ArrayVertex:()=>u.ArrayVertex,DenseStrategy:()=>m.DenseStrategy,DependencyGraph:()=>n.DependencyGraph,EmptyCellVertex:()=>d.EmptyCellVertex,FormulaCellVertex:()=>u.FormulaCellVertex,Graph:()=>o.Graph,ParsingErrorVertex:()=>p.ParsingErrorVertex,RangeMapping:()=>a.RangeMapping,RangeVertex:()=>f.RangeVertex,SheetMapping:()=>l.SheetMapping,SparseStrategy:()=>g.SparseStrategy,TopSort:()=>s.TopSort,ValueCellVertex:()=>h.ValueCellVertex});var n=r(5),i=r(76),o=r(83),s=r(84),a=r(86),l=r(87),c=r(78),u=r(80),d=r(90),h=r(91),p=r(92),f=r(82),g=r(93),m=r(94)},(e,t,r)=>{"use strict";r.r(t),r.d(t,{DependencyGraph:()=>C});var h=r(2),l=r(6),f=r(3),c=r(68),n=r(61),u=r(70),i=r(69),p=r(7),d=r(71),o=r(72),g=r(4),s=r(76),a=r(78),m=r(79),y=r(80),v=r(83),b=r(86),w=r(87);class C{constructor(e,t,r,n,i,o,s,a){this.addressMapping=e,this.rangeMapping=t,this.sheetMapping=r,this.arrayMapping=n,this.stats=i,this.lazilyTransformingAstService=o,this.functionRegistry=s,this.namedExpressions=a,this.changes=c.ContentChanges.empty(),this.dependencyQueryAddresses=e=>{if(e instanceof g.RangeVertex)return this.rangeDependencyQuery(e).map(([e])=>e);e=this.formulaDependencyQuery(e);if(void 0===e)return[];{const[t,r]=e;return r.map(e=>e instanceof p.NamedExpressionDependency?this.namedExpressions.namedExpressionOrPlaceholder(e.name,t.sheet).address:(0,f.isSimpleCellAddress)(e)?e:(0,h.simpleCellRange)(e.start,e.end))}},this.dependencyQueryVertices=e=>{if(e instanceof g.RangeVertex)return this.rangeDependencyQuery(e);e=this.formulaDependencyQuery(e);if(void 0===e)return[];{const[r,t]=e;return t.map(e=>{var t;return e instanceof h.AbsoluteCellRange?[e.start,this.rangeMapping.fetchRange(e.start,e.end)]:e instanceof p.NamedExpressionDependency?[(t=this.namedExpressions.namedExpressionOrPlaceholder(e.name,r.sheet)).address,this.addressMapping.fetchCell(t.address)]:[e,this.addressMapping.fetchCell(e)]})}},this.rangeDependencyQuery=e=>{var t=[],{smallerRangeVertex:r,restRange:n}=this.rangeMapping.findSmallerRange(e.range);let i;void 0!==r&&this.graph.adjacentNodes(r).has(e)?(i=n,t.push([new h.AbsoluteCellRange(r.start,r.end),r])):i=e.range;for(const s of i.addresses(this)){var o=this.addressMapping.getCell(s);void 0!==o&&t.push([s,o])}return t},this.formulaDependencyQuery=e=>{let t,r;if(e instanceof y.FormulaVertex)return r=e.getAddress(this.lazilyTransformingAstService),t=e.getFormula(this.lazilyTransformingAstService),e=(0,p.collectDependencies)(t,this.functionRegistry),[r,(0,l.absolutizeDependencies)(e,r)]},this.graph=new v.Graph(this.dependencyQueryVertices)}static buildEmpty(e,t,r,n,i){return new C(new s.AddressMapping(t.chooseAddressMappingPolicy),new b.RangeMapping,new w.SheetMapping(t.translationPackage),new a.ArrayMapping,i,e,r,n)}setFormulaToCell(e,t,r,n,i,o){t=y.FormulaVertex.fromAst(t,e,n,this.lazilyTransformingAstService.version());return this.exchangeOrAddFormulaVertex(t),this.processCellDependencies(r,t),this.graph.markNodeAsDirty(t),i&&this.markAsVolatile(t),o&&this.markAsDependentOnStructureChange(t),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setParsingErrorToCell(e,t){var r=this.shrinkPossibleArrayAndGetCell(e);return this.exchangeOrAddGraphNode(r,t),this.addressMapping.setCell(e,t),this.graph.markNodeAsDirty(t),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setValueToCell(e,t){var r=this.shrinkPossibleArrayAndGetCell(e);return r instanceof g.ArrayVertex&&this.arrayMapping.removeArray(r.getRange()),r instanceof g.ValueCellVertex?r.getValues().rawValue!==t.rawValue&&(r.setValues(t),this.graph.markNodeAsDirty(r)):(t=new g.ValueCellVertex(t.parsedValue,t.rawValue),this.exchangeOrAddGraphNode(r,t),this.addressMapping.setCell(e,t),this.graph.markNodeAsDirty(t)),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setCellEmpty(e){var t,r=this.shrinkPossibleArrayAndGetCell(e);return void 0===r?c.ContentChanges.empty():(0<this.graph.adjacentNodes(r).size?(t=new g.EmptyCellVertex,this.exchangeGraphNode(r,t),0===this.graph.adjacentNodesCount(t)?(this.removeVertex(t),this.addressMapping.removeCell(e)):(this.graph.markNodeAsDirty(t),this.addressMapping.setCell(e,t))):(this.removeVertex(r),this.addressMapping.removeCell(e)),this.getAndClearContentChanges())}clearDirtyVertices(){this.graph.clearDirtyNodes()}verticesToRecompute(){return this.graph.getDirtyAndVolatileNodes()}processCellDependencies(e,u){const d=this.graph.getNodeId(u);e.forEach(t=>{if(t instanceof h.AbsoluteCellRange){var r=t;let e=this.getRange(r.start,r.end);void 0===e&&(e=new g.RangeVertex(r),this.rangeMapping.setRange(e)),this.graph.addNodeAndReturnId(e);var n=this.graph.getNodeId(e),{smallerRangeVertex:i,restRange:o}=(r.isFinite()||this.graph.markNodeAsInfiniteRange(n),this.rangeMapping.findSmallerRange(r));if(void 0!==i){if(this.graph.addEdge(i,n),e.bruteForce){e.bruteForce=!1;for(const l of r.addresses(this))this.graph.removeEdge(this.fetchCell(l),n)}}else e.bruteForce=!0;i=this.arrayMapping.getArray(o);if(void 0!==i)this.graph.addEdge(i,n);else for(const c of o.addresses(this)){var{vertex:s,id:a}=this.fetchCellOrCreateEmpty(c);this.graph.addEdge(null!=a?a:s,n)}this.graph.addEdge(n,d),r.isFinite()&&this.correctInfiniteRangesDependenciesByRangeVertex(e)}else t instanceof p.NamedExpressionDependency?(i=u.getAddress(this.lazilyTransformingAstService).sheet,{vertex:o,id:r}=this.fetchNamedExpressionVertex(t.name,i),this.graph.addEdge(null!=r?r:o,d)):({vertex:i,id:r}=this.fetchCellOrCreateEmpty(t),this.graph.addEdge(null!=r?r:i,d))})}fetchNamedExpressionVertex(e,t){e=this.namedExpressions.namedExpressionOrPlaceholder(e,t);return this.fetchCellOrCreateEmpty(e.address)}exchangeNode(e,t){var r=this.fetchCellOrCreateEmpty(e).vertex,t=this.fetchCellOrCreateEmpty(t).vertex;this.addressMapping.removeCell(e),this.exchangeGraphNode(r,t)}fetchCellOrCreateEmpty(e){var t,r=this.addressMapping.getCell(e);return void 0!==r?{vertex:r,id:void 0}:(r=new g.EmptyCellVertex,t=this.graph.addNodeAndReturnId(r),this.addressMapping.setCell(e,r),{vertex:r,id:t})}removeRows(n){this.stats.measure(o.StatType.ADJUSTING_GRAPH,()=>{for(var[e,t]of this.addressMapping.entriesFromRowsSpan(n)){for(const r of this.graph.adjacentNodes(t))this.graph.markNodeAsDirty(r);if(t instanceof g.ArrayVertex){if(!t.isLeftCorner(e))continue;this.shrinkArrayToCorner(t),this.arrayMapping.removeArray(t.getRange())}this.removeVertex(t)}}),this.stats.measure(o.StatType.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeRows(n)});var e=this.stats.measure(o.StatType.ADJUSTING_RANGES,()=>{var e=this.truncateRanges(n,e=>e.row);return this.getArrayVerticesRelatedToRanges(e)});return this.stats.measure(o.StatType.ADJUSTING_ARRAY_MAPPING,()=>{this.fixArraysAfterRemovingRows(n.sheet,n.rowStart,n.numberOfRows)}),this.addStructuralNodesToChangeSet(),{affectedArrays:e,contentChanges:this.getAndClearContentChanges()}}removeSheet(t){this.clearSheet(t);for(var[e,r]of this.addressMapping.sheetEntries(t)){for(const n of this.graph.adjacentNodes(r))this.graph.markNodeAsDirty(n);this.removeVertex(r),this.addressMapping.removeCell(e)}this.stats.measure(o.StatType.ADJUSTING_RANGES,()=>{for(const e of this.rangeMapping.removeRangesInSheet(t))this.removeVertex(e);this.stats.measure(o.StatType.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeSheet(t)})})}clearSheet(e){var t,r,n=new Set;for([t,r]of this.addressMapping.sheetEntries(e))r instanceof g.ArrayVertex?n.add(r):this.setCellEmpty(t);for(const i of n.values())this.setArrayEmpty(i);this.addStructuralNodesToChangeSet()}removeColumns(n){this.stats.measure(o.StatType.ADJUSTING_GRAPH,()=>{for(var[e,t]of this.addressMapping.entriesFromColumnsSpan(n)){for(const r of this.graph.adjacentNodes(t))this.graph.markNodeAsDirty(r);if(t instanceof g.ArrayVertex){if(!t.isLeftCorner(e))continue;this.shrinkArrayToCorner(t),this.arrayMapping.removeArray(t.getRange())}this.removeVertex(t)}}),this.stats.measure(o.StatType.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeColumns(n)});var e=this.stats.measure(o.StatType.ADJUSTING_RANGES,()=>{var e=this.truncateRanges(n,e=>e.col);return this.getArrayVerticesRelatedToRanges(e)});return this.stats.measure(o.StatType.ADJUSTING_ARRAY_MAPPING,()=>this.fixArraysAfterRemovingColumns(n.sheet,n.columnStart,n.numberOfColumns)),this.addStructuralNodesToChangeSet(),{affectedArrays:e,contentChanges:this.getAndClearContentChanges()}}addRows(t){this.stats.measure(o.StatType.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.addRows(t.sheet,t.rowStart,t.numberOfRows)});var e=this.stats.measure(o.StatType.ADJUSTING_RANGES,()=>{var e=this.rangeMapping.moveAllRangesInSheetAfterRowByRows(t.sheet,t.rowStart,t.numberOfRows);return this.fixRangesWhenAddingRows(t.sheet,t.rowStart,t.numberOfRows),this.getArrayVerticesRelatedToRanges(e.verticesWithChangedSize)});this.stats.measure(o.StatType.ADJUSTING_ARRAY_MAPPING,()=>{this.fixArraysAfterAddingRow(t.sheet,t.rowStart,t.numberOfRows)});for(const r of this.addressMapping.verticesFromRowsSpan(t))this.graph.markNodeAsDirty(r);return this.addStructuralNodesToChangeSet(),{affectedArrays:e}}addColumns(t){this.stats.measure(o.StatType.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.addColumns(t.sheet,t.columnStart,t.numberOfColumns)});var e=this.stats.measure(o.StatType.ADJUSTING_RANGES,()=>{var e=this.rangeMapping.moveAllRangesInSheetAfterColumnByColumns(t.sheet,t.columnStart,t.numberOfColumns);return this.fixRangesWhenAddingColumns(t.sheet,t.columnStart,t.numberOfColumns),this.getArrayVerticesRelatedToRanges(e.verticesWithChangedSize)});this.stats.measure(o.StatType.ADJUSTING_ARRAY_MAPPING,()=>this.fixArraysAfterAddingColumn(t.sheet,t.columnStart,t.numberOfColumns));for(const r of this.addressMapping.verticesFromColumnsSpan(t))this.graph.markNodeAsDirty(r);return this.addStructuralNodesToChangeSet(),{affectedArrays:e,contentChanges:this.getAndClearContentChanges()}}isThereSpaceForArray(e){var t=e.getRangeOrUndef();if(void 0===t)return!1;for(const n of t.addresses(this)){var r=this.addressMapping.getCell(n);if(void 0!==r&&!(r instanceof g.EmptyCellVertex)&&r!==e)return!1}return!0}moveCells(r,e,n,i){for(const l of r.addressesWithDirection(e,n,this)){var o=(0,f.simpleCellAddress)(i,l.col+e,l.row+n);let t=this.addressMapping.getCell(l);var s=this.addressMapping.getCell(o);if(this.addressMapping.removeCell(l),void 0!==t){this.graph.markNodeAsDirty(t),this.addressMapping.setCell(o,t);let e=void 0;for(const c of this.graph.adjacentNodes(t))c instanceof g.RangeVertex&&!r.containsRange(c.range)&&(e=null!==e&&void 0!==e?e:this.fetchCellOrCreateEmpty(l).vertex,this.graph.addEdge(e,c),this.graph.removeEdge(t,c));e&&(this.graph.markNodeAsDirty(e),this.addressMapping.setCell(l,e))}if(void 0!==s){void 0===t&&this.addressMapping.removeCell(o);for(const u of this.graph.adjacentNodes(s))t=null!==t&&void 0!==t?t:this.fetchCellOrCreateEmpty(o).vertex,this.graph.addEdge(t,u),this.graph.markNodeAsDirty(t);this.removeVertex(s)}}for(const d of this.rangeMapping.rangeVerticesContainedInRange(r))for(const h of this.graph.adjacentNodes(d))if(h instanceof g.RangeVertex&&!r.containsRange(h.range)){this.graph.removeEdge(d,h);for(const p of d.range.addresses(this)){var{vertex:t,id:a}=this.fetchCellOrCreateEmpty(p);this.graph.addEdge(null!=a?a:t,h),this.addressMapping.setCell(p,t),this.graph.markNodeAsDirty(t)}}this.rangeMapping.moveRangesInsideSourceRange(r,e,n,i)}setArrayEmpty(e){var t=h.AbsoluteCellRange.spanFrom(e.getAddress(this.lazilyTransformingAstService),e.width,e.height),r=this.graph.adjacentNodes(e);for(const s of t.addresses(this))this.addressMapping.removeCell(s);for(const a of r.values()){var n=(0,m.collectAddressesDependentToRange)(this.functionRegistry,a,e.getRange(),this.lazilyTransformingAstService,this);for(const l of n){var{vertex:i,id:o}=this.fetchCellOrCreateEmpty(l);this.graph.addEdge(null!=o?o:i,a)}0<n.length&&this.graph.markNodeAsDirty(a)}this.removeVertex(e),this.arrayMapping.removeArray(e.getRange())}addVertex(e,t){this.graph.addNodeAndReturnId(t),this.addressMapping.setCell(e,t)}addArrayVertex(e,t){this.graph.addNodeAndReturnId(t),this.setAddressMappingForArrayVertex(t,e)}*arrayFormulaNodes(){for(const e of this.graph.getNodes())e instanceof g.ArrayVertex&&(yield e)}*entriesFromRowsSpan(e){yield*this.addressMapping.entriesFromRowsSpan(e)}*entriesFromColumnsSpan(e){yield*this.addressMapping.entriesFromColumnsSpan(e)}fetchCell(e){return this.addressMapping.fetchCell(e)}getCell(e){return this.addressMapping.getCell(e)}getCellValue(e){return this.addressMapping.getCellValue(e)}getRawValue(e){return this.addressMapping.getRawValue(e)}getScalarValue(e){e=this.addressMapping.getCellValue(e);return e instanceof i.SimpleRangeValue?new f.CellError(f.ErrorType.VALUE,n.ErrorMessage.ScalarExpected):e}existsEdge(e,t){return this.graph.existsEdge(e,t)}getSheetId(e){return this.sheetMapping.fetch(e)}getSheetHeight(e){return this.addressMapping.getHeight(e)}getSheetWidth(e){return this.addressMapping.getWidth(e)}getArray(e){return this.arrayMapping.getArray(e)}getRange(e,t){return this.rangeMapping.getRange(e,t)}topSortWithScc(){return this.graph.topSortWithScc()}markAsVolatile(e){this.graph.markNodeAsVolatile(e)}markAsDependentOnStructureChange(e){this.graph.markNodeAsChangingWithStructure(e)}forceApplyPostponedTransformations(){for(const e of this.graph.getNodes())e instanceof g.FormulaCellVertex&&e.ensureRecentData(this.lazilyTransformingAstService)}*rawValuesFromRange(e){for(const r of e.addresses(this)){var t=this.getScalarValue(r);t!==u.EmptyValue&&(yield[(0,u.getRawValue)(t),r])}}computeListOfValuesInRange(e){var t=[];for(const n of e.addresses(this)){var r=this.getScalarValue(n);t.push(r)}return t}shrinkArrayToCorner(r){this.cleanAddressMappingUnderArray(r);for(const o of this.adjacentArrayVertices(r)){let e,t=!1;for(var[n,i]of e=o instanceof y.FormulaVertex?this.formulaDirectDependenciesToArray(o,r):this.rangeDirectDependenciesToArray(o,r))r.isLeftCorner(n)&&(t=!0),this.graph.addEdge(i,o),this.graph.markNodeAsDirty(i);t||this.graph.removeEdge(r,o)}this.graph.markNodeAsDirty(r)}isArrayInternalCell(e){var t=this.getCell(e);return t instanceof g.ArrayVertex&&!t.isLeftCorner(e)}getAndClearContentChanges(){var e=this.changes;return this.changes=c.ContentChanges.empty(),e}getAdjacentNodesAddresses(e){e=this.graph.adjacentNodes(e);const t=[];return e.forEach(e=>{e instanceof g.RangeVertex?t.push((0,h.simpleCellRange)(e.start,e.end)):t.push(e.getAddress(this.lazilyTransformingAstService))}),t}exchangeGraphNode(e,t){this.graph.addNodeAndReturnId(t);var r=this.graph.adjacentNodes(e);this.removeVertex(e),r.forEach(e=>{this.graph.hasNode(e)&&this.graph.addEdge(t,e)})}setArray(e,t){this.arrayMapping.setArray(e,t)}correctInfiniteRangesDependency(t){var e=this.graph.getInfiniteRanges().filter(({node:e})=>e.range.addressInRange(t));if(!(e.length<=0)){var{vertex:r,id:n}=this.fetchCellOrCreateEmpty(t);const i=null!=n?n:this.graph.getNodeId(r);e.forEach(({id:e})=>{this.graph.addEdge(i,e)})}}exchangeOrAddGraphNode(e,t){e?this.exchangeGraphNode(e,t):this.graph.addNodeAndReturnId(t)}getArrayVerticesRelatedToRanges(e){const t=new Set;return e.forEach(e=>{this.graph.hasNode(e)&&this.graph.adjacentNodes(e).forEach(e=>{e instanceof g.ArrayVertex&&t.add(e)})}),t}correctInfiniteRangesDependenciesByRangeVertex(t){this.graph.getInfiniteRanges().forEach(({id:r,node:e})=>{e=t.range.intersectionWith(e.range);void 0!==e&&e.addresses(this).forEach(e=>{var{vertex:e,id:t}=this.fetchCellOrCreateEmpty(e);this.graph.addEdge(null!=t?t:e,r)})})}cleanAddressMappingUnderArray(e){for(const r of e.getRange().addresses(this)){var t=e.getArrayCellValue(r);this.getCell(r)===e?e.isLeftCorner(r)?this.changes.addChange(new f.CellError(f.ErrorType.REF),r,t):(this.addressMapping.removeCell(r),this.changes.addChange(u.EmptyValue,r,t)):this.changes.addChange(u.EmptyValue,r,t)}}*formulaDirectDependenciesToArray(e,t){var[,e]=null!=(e=this.formulaDependencyQuery(e))?e:[];if(void 0!==e)for(const r of e)if(!(r instanceof p.NamedExpressionDependency||r instanceof h.AbsoluteCellRange)&&t.getRange().addressInRange(r)){const e=this.fetchCellOrCreateEmpty(r).vertex;yield[r,e]}}*rangeDirectDependenciesToArray(e,t){var r,e=this.rangeMapping.findSmallerRange(e.range)["restRange"];for(const n of e.addresses(this))t.getRange().addressInRange(n)&&(r=this.fetchCellOrCreateEmpty(n).vertex,yield[n,r])}*adjacentArrayVertices(e){for(const t of this.graph.adjacentNodes(e))(t instanceof y.FormulaVertex||t instanceof g.RangeVertex)&&(yield t)}addStructuralNodesToChangeSet(){this.graph.markChangingWithStructureNodesAsDirty()}fixRangesWhenAddingRows(e,t,r){for(const a of Array.from(this.rangeMapping.rangesInSheet(e)))if(a.range.includesRow(t+r))if(a.bruteForce)for(const l of a.range.rangeWithSameWidth(t,r).addresses(this)){var{vertex:n,id:i}=this.fetchCellOrCreateEmpty(l);this.graph.addEdge(null!=i?i:n,a)}else{let e=a,t=this.rangeMapping.findSmallerRange(e.range);if(void 0===t.smallerRangeVertex){for(;void 0===t.smallerRangeVertex;){var o=new g.RangeVertex(h.AbsoluteCellRange.spanFrom(e.range.start,e.range.width(),e.range.height()-1)),s=(this.rangeMapping.setRange(o),this.graph.addNodeAndReturnId(o),new h.AbsoluteCellRange((0,f.simpleCellAddress)(e.range.start.sheet,e.range.start.col,e.range.end.row),e.range.end));this.addAllFromRange(s,e),this.graph.addEdge(o,e),e=o,t=this.rangeMapping.findSmallerRange(e.range)}this.graph.addEdge(t.smallerRangeVertex,e),this.addAllFromRange(t.restRange,e),this.graph.removeEdge(t.smallerRangeVertex,a)}}}addAllFromRange(e,t){for(const i of e.addresses(this)){var{vertex:r,id:n}=this.fetchCellOrCreateEmpty(i);this.graph.addEdge(null!=n?n:r,t)}}fixRangesWhenAddingColumns(t,r,n){for(const s of this.rangeMapping.rangesInSheet(t))if(s.range.includesColumn(r+n)){let e;for(const a of(e=s.bruteForce?s.range.rangeWithSameHeight(r,n):h.AbsoluteCellRange.spanFrom((0,f.simpleCellAddress)(t,r,s.range.end.row),n,1)).addresses(this)){var{vertex:i,id:o}=this.fetchCellOrCreateEmpty(a);this.graph.addEdge(null!=o?o:i,s)}}}exchangeOrAddFormulaVertex(e){var t,r=e.getAddress(this.lazilyTransformingAstService),n=h.AbsoluteCellRange.spanFrom(r,e.width,e.height),i=this.shrinkPossibleArrayAndGetCell(r);if(e instanceof g.ArrayVertex&&this.setArray(n,e),this.exchangeOrAddGraphNode(i,e),this.addressMapping.setCell(r,e),e instanceof g.ArrayVertex){if(!this.isThereSpaceForArray(e))return;for(const o of n.addresses(this))e.isLeftCorner(o)||(t=this.getCell(o),this.exchangeOrAddGraphNode(t,e))}for(const s of n.addresses(this))this.addressMapping.setCell(s,e)}setAddressMappingForArrayVertex(e,t){if(this.addressMapping.setCell(t,e),e instanceof g.ArrayVertex){t=h.AbsoluteCellRange.spanFromOrUndef(t,e.width,e.height);if(void 0!==t&&(this.setArray(t,e),this.isThereSpaceForArray(e)))for(const r of t.addresses(this))this.addressMapping.setCell(r,e)}}truncateRanges(e,t){var r,n,{verticesToRemove:e,verticesToMerge:t,verticesWithChangedSize:i}=this.rangeMapping.truncateRanges(e,t);for([r,n]of t)this.mergeRangeVertices(r,n);for(const o of e)this.removeVertexAndCleanupDependencies(o);return i}fixArraysAfterAddingRow(r,n,i){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(r,n,i),!(n<=0))for(var[,o]of this.arrayMapping.arraysInRows(d.RowsSpan.fromRowStartAndEnd(r,n-1,n-1))){var s=o.getRange();for(let t=s.start.col;t<=s.end.col;++t)for(let e=n;e<=s.end.row;++e){var a=(0,f.simpleCellAddress)(r,t,e),l=(0,f.simpleCellAddress)(r,t,e+i),c=o.getArrayCellValue(a);this.addressMapping.moveCell(l,a),this.changes.addChange(u.EmptyValue,l,c)}}}fixArraysAfterRemovingRows(e,t,r){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,t,-r),!(t<=0))for(var[,n]of this.arrayMapping.arraysInRows(d.RowsSpan.fromRowStartAndEnd(e,t-1,t-1)))if(this.isThereSpaceForArray(n))for(const i of n.getRange().addresses(this))this.addressMapping.setCell(i,n);else this.setNoSpaceIfArray(n)}fixArraysAfterAddingColumn(r,n,i){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(r,n,i),!(n<=0))for(var[,o]of this.arrayMapping.arraysInCols(d.ColumnsSpan.fromColumnStartAndEnd(r,n-1,n-1))){var s=o.getRange();for(let t=s.start.row;t<=s.end.row;++t)for(let e=n;e<=s.end.col;++e){var a=(0,f.simpleCellAddress)(r,e,t),l=(0,f.simpleCellAddress)(r,e+i,t),c=o.getArrayCellValue(a);this.addressMapping.moveCell(l,a),this.changes.addChange(u.EmptyValue,l,c)}}}fixArraysAfterRemovingColumns(e,t,r){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,t,-r),!(t<=0))for(var[,n]of this.arrayMapping.arraysInCols(d.ColumnsSpan.fromColumnStartAndEnd(e,t-1,t-1)))if(this.isThereSpaceForArray(n))for(const i of n.getRange().addresses(this))this.addressMapping.setCell(i,n);else this.setNoSpaceIfArray(n)}shrinkPossibleArrayAndGetCell(e){var t=this.getCell(e);return t instanceof g.ArrayVertex?(this.setNoSpaceIfArray(t),this.getCell(e)):t}setNoSpaceIfArray(e){e instanceof g.ArrayVertex&&(this.shrinkArrayToCorner(e),e.setNoSpace())}removeVertex(e){this.removeVertexAndCleanupDependencies(e),e instanceof g.RangeVertex&&this.rangeMapping.removeRange(e)}mergeRangeVertices(t,e){var r=this.graph.adjacentNodes(e);this.removeVertexAndCleanupDependencies(e),this.graph.removeEdgeIfExists(t,e),r.forEach(e=>{this.graph.hasNode(e)&&this.graph.addEdge(t,e)})}removeVertexAndCleanupDependencies(e){const t=new Set(this.graph.removeNode(e));for(;0<t.size;){var r=t.values().next().value,[r,n]=(t.delete(r),r);this.graph.hasNode(n)&&0===this.graph.adjacentNodesCount(n)&&((n instanceof g.RangeVertex||n instanceof g.EmptyCellVertex)&&this.graph.removeNode(n).forEach(e=>t.add(e)),n instanceof g.RangeVertex?this.rangeMapping.removeRange(n):n instanceof g.EmptyCellVertex&&this.addressMapping.removeCell(r))}}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{absolutizeDependencies:()=>s,filterDependenciesOutOfScope:()=>a});var n=r(2),i=r(3),o=r(7);const s=(e,t)=>e.map(e=>e.absolutize(t)),a=e=>e.filter(e=>e instanceof o.NamedExpressionDependency||(e instanceof n.AbsoluteCellRange?!((0,i.invalidSimpleCellAddress)(e.start)||(0,i.invalidSimpleCellAddress)(e.end)):!(0,i.invalidSimpleCellAddress)(e)))},(e,t,r)=>{"use strict";r.r(t),r.d(t,{AddressDependency:()=>d.AddressDependency,AstNodeType:()=>c.AstNodeType,CellAddress:()=>i.CellAddress,CellRangeDependency:()=>d.CellRangeDependency,ColumnRangeDependency:()=>d.ColumnRangeDependency,FormulaLexer:()=>l.FormulaLexer,NamedExpressionDependency:()=>d.NamedExpressionDependency,ParserWithCaching:()=>o.ParserWithCaching,ParsingErrorType:()=>c.ParsingErrorType,RowRangeDependency:()=>d.RowRangeDependency,Unparser:()=>u.Unparser,buildCellErrorAst:()=>c.buildCellErrorAst,buildCellRangeAst:()=>c.buildCellRangeAst,buildLexerConfig:()=>a.buildLexerConfig,buildParsingErrorAst:()=>c.buildParsingErrorAst,buildProcedureAst:()=>c.buildProcedureAst,cellAddressFromString:()=>n.cellAddressFromString,collectDependencies:()=>s.collectDependencies,simpleCellAddressFromString:()=>n.simpleCellAddressFromString,simpleCellAddressToString:()=>n.simpleCellAddressToString,simpleCellRangeFromString:()=>n.simpleCellRangeFromString,simpleCellRangeToString:()=>n.simpleCellRangeToString});var n=r(8),i=r(9),o=r(13),s=r(66),a=r(62),l=r(60),c=r(57),u=r(65),d=r(67)},(e,t,r)=>{"use strict";r.r(t),r.d(t,{cellAddressFromString:()=>p,columnAddressFromString:()=>f,columnIndexToLabel:()=>C,rowAddressFromString:()=>g,sheetIndexToString:()=>E,simpleCellAddressFromString:()=>m,simpleCellAddressToString:()=>v,simpleCellRangeFromString:()=>y,simpleCellRangeToString:()=>b});var i=r(2),o=r(3),s=r(9),a=r(10),l=r(12),c=r(11);const u=new RegExp(`^(${l.SHEET_NAME_PATTERN})?(\\${l.ABSOLUTE_OPERATOR}?)([A-Za-z]+)(\\${l.ABSOLUTE_OPERATOR}?)([0-9]+)$`),d=new RegExp(`^(${l.SHEET_NAME_PATTERN})?(\\${l.ABSOLUTE_OPERATOR}?)([A-Za-z]+)$`),h=new RegExp(`^(${l.SHEET_NAME_PATTERN})?(\\${l.ABSOLUTE_OPERATOR}?)([0-9]+)$`),n=new RegExp(`^${l.UNQUOTED_SHEET_NAME_PATTERN}$`),p=(e,t,r)=>{var t=u.exec(t),n=w(t[6]);let i=T(t,e);if(void 0!==i)return null===i&&(i=void 0),e=Number(t[8])-1,t[5]===l.ABSOLUTE_OPERATOR&&t[7]===l.ABSOLUTE_OPERATOR?s.CellAddress.absolute(n,e,i):t[5]===l.ABSOLUTE_OPERATOR?s.CellAddress.absoluteCol(n,e-r.row,i):t[7]===l.ABSOLUTE_OPERATOR?s.CellAddress.absoluteRow(n-r.col,e,i):s.CellAddress.relative(n-r.col,e-r.row,i)},f=(e,t,r)=>{t=d.exec(t);let n=T(t,e);if(void 0!==n)return null===n&&(n=void 0),e=w(t[6]),t[5]===l.ABSOLUTE_OPERATOR?a.ColumnAddress.absolute(e,n):a.ColumnAddress.relative(e-r.col,n)},g=(e,t,r)=>{t=h.exec(t);let n=T(t,e);if(void 0!==n)return null===n&&(n=void 0),e=Number(t[6])-1,t[5]===l.ABSOLUTE_OPERATOR?c.RowAddress.absolute(e,n):c.RowAddress.relative(e-r.row,n)},m=(t,r,n)=>{r=u.exec(r);if(r){var i=w(r[6]);let e=T(r,t);if(void 0!==e)return null===e&&(e=n),t=Number(r[8])-1,(0,o.simpleCellAddress)(e,i,t)}},y=(e,t,r)=>{t=t.split(l.RANGE_OPERATOR);if(2===t.length){var[t,n]=t,t=m(e,t,r);if(void 0!==t){r=m(e,n,t.sheet);if(void 0!==r&&t.sheet===r.sheet)return(0,i.simpleCellRange)(t,r)}}},v=(e,t,r)=>{var n=C(t.col),e=E(t.sheet,e);if(void 0!==e)return r!==t.sheet?e+"!"+n+(t.row+1):""+n+(t.row+1)},b=(e,t,r)=>{r=v(e,t.start,r),e=v(e,t.end,t.start.sheet);if(void 0!==r&&void 0!==e)return""+r+l.RANGE_OPERATOR+e};function w(e){return 1===e.length?e.toUpperCase().charCodeAt(0)-65:e.split("").reduce((e,t)=>26*e+(t.toUpperCase().charCodeAt(0)-64),0)-1}function C(e){let t="";for(;0<=e;)t=String.fromCharCode(e%26+97)+t,e=Math.floor(e/26)-1;return t.toUpperCase()}function E(e,t){let r=t(e);if(void 0!==r)return n.test(r)?r:`'${r=r.replace(/'/g,"''")}'`}function T(e,t){var r;let n=null!=(r=e[3])?r:e[2];return n?t(n=n.replace(/''/g,"'")):null}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{CellAddress:()=>l,CellReferenceType:()=>n});var n,i=r(3),o=r(8),s=r(10),a=r(11);(t=n=n||{}).CELL_REFERENCE_RELATIVE="CELL_REFERENCE",t.CELL_REFERENCE_ABSOLUTE="CELL_REFERENCE_ABSOLUTE",t.CELL_REFERENCE_ABSOLUTE_COL="CELL_REFERENCE_ABSOLUTE_COL",t.CELL_REFERENCE_ABSOLUTE_ROW="CELL_REFERENCE_ABSOLUTE_ROW";class l{constructor(e,t,r,n){this.col=e,this.row=t,this.type=r,this.sheet=n}static fromColAndRow(e,t,r){return(e.isColumnAbsolute()&&t.isRowAbsolute()?l.absolute:e.isColumnAbsolute()?l.absoluteCol:t.isRowAbsolute()?l.absoluteRow:l.relative).bind(this)(e.col,t.row,r)}static relative(e,t,r){return new l(e,t,n.CELL_REFERENCE_RELATIVE,r)}static absolute(e,t,r){return new l(e,t,n.CELL_REFERENCE_ABSOLUTE,r)}static absoluteCol(e,t,r){return new l(e,t,n.CELL_REFERENCE_ABSOLUTE_COL,r)}static absoluteRow(e,t,r){return new l(e,t,n.CELL_REFERENCE_ABSOLUTE_ROW,r)}toSimpleCellAddress(e){var t=(0,i.absoluteSheetReference)(this,e);return this.type===n.CELL_REFERENCE_ABSOLUTE?(0,i.simpleCellAddress)(t,this.col,this.row):this.type===n.CELL_REFERENCE_ABSOLUTE_ROW?(0,i.simpleCellAddress)(t,e.col+this.col,this.row):this.type===n.CELL_REFERENCE_ABSOLUTE_COL?(0,i.simpleCellAddress)(t,this.col,e.row+this.row):(0,i.simpleCellAddress)(t,e.col+this.col,e.row+this.row)}toColumnAddress(){var e=this.isColumnRelative()?s.ReferenceType.RELATIVE:s.ReferenceType.ABSOLUTE;return new s.ColumnAddress(e,this.col,this.sheet)}toRowAddress(){var e=this.isRowRelative()?s.ReferenceType.RELATIVE:s.ReferenceType.ABSOLUTE;return new a.RowAddress(e,this.row,this.sheet)}toSimpleColumnAddress(e){var t=(0,i.absoluteSheetReference)(this,e);let r=this.col;return this.isColumnRelative()&&(r+=e.col),(0,i.simpleColumnAddress)(t,r)}toSimpleRowAddress(e){var t=(0,i.absoluteSheetReference)(this,e);let r=this.row;return this.isRowRelative()&&(r+=e.row),(0,i.simpleRowAddress)(t,r)}isRowAbsolute(){return this.type===n.CELL_REFERENCE_ABSOLUTE||this.type===n.CELL_REFERENCE_ABSOLUTE_ROW}isColumnAbsolute(){return this.type===n.CELL_REFERENCE_ABSOLUTE||this.type===n.CELL_REFERENCE_ABSOLUTE_COL}isColumnRelative(){return this.type===n.CELL_REFERENCE_RELATIVE||this.type===n.CELL_REFERENCE_ABSOLUTE_ROW}isRowRelative(){return this.type===n.CELL_REFERENCE_RELATIVE||this.type===n.CELL_REFERENCE_ABSOLUTE_COL}isAbsolute(){return this.type===n.CELL_REFERENCE_ABSOLUTE&&void 0!==this.sheet}shiftedByRows(e){return new l(this.col,this.row+e,this.type,this.sheet)}shiftedByColumns(e){return new l(this.col+e,this.row,this.type,this.sheet)}moved(e,t,r){e=void 0===this.sheet?void 0:e;return new l(this.col+t,this.row+r,this.type,e)}withSheet(e){return new l(this.col,this.row,this.type,e)}isInvalid(e){return(0,i.invalidSimpleCellAddress)(this.toSimpleCellAddress(e))}shiftRelativeDimensions(e,t){e=this.isColumnAbsolute()?this.col:this.col+e,t=this.isRowAbsolute()?this.row:this.row+t;return new l(e,t,this.type,this.sheet)}shiftAbsoluteDimensions(e,t){e=this.isColumnRelative()?this.col:this.col+e,t=this.isRowRelative()?this.row:this.row+t;return new l(e,t,this.type,this.sheet)}hash(e){var t=e&&void 0!==this.sheet?"#"+this.sheet:"";switch(this.type){case n.CELL_REFERENCE_RELATIVE:return t+`#${this.row}R`+this.col;case n.CELL_REFERENCE_ABSOLUTE:return t+`#${this.row}A`+this.col;case n.CELL_REFERENCE_ABSOLUTE_COL:return t+`#${this.row}AC`+this.col;case n.CELL_REFERENCE_ABSOLUTE_ROW:return t+`#${this.row}AR`+this.col}}unparse(e){var t,r,e=this.toSimpleCellAddress(e);if(!(0,i.invalidSimpleCellAddress)(e))return t=(0,o.columnIndexToLabel)(e.col),r=this.type===n.CELL_REFERENCE_ABSOLUTE||this.type===n.CELL_REFERENCE_ABSOLUTE_ROW?"$":"",(this.type===n.CELL_REFERENCE_ABSOLUTE||this.type===n.CELL_REFERENCE_ABSOLUTE_COL?"$":"")+t+r+(e.row+1)}exceedsSheetSizeLimits(e,t){return this.row>=t||this.col>=e}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{ColumnAddress:()=>s,ReferenceType:()=>n});var n,i=r(3),o=r(8);(t=n=n||{}).RELATIVE="RELATIVE",t.ABSOLUTE="ABSOLUTE";class s{constructor(e,t,r){this.type=e,this.col=t,this.sheet=r}static absolute(e,t){return new s(n.ABSOLUTE,e,t)}static relative(e,t){return new s(n.RELATIVE,e,t)}static compareByAbsoluteAddress(r){return(e,t)=>e.toSimpleColumnAddress(r).col-t.toSimpleColumnAddress(r).col}isColumnAbsolute(){return this.type===n.ABSOLUTE}isColumnRelative(){return this.type===n.RELATIVE}isAbsolute(){return this.type===n.ABSOLUTE&&void 0!==this.sheet}moved(e,t,r){e=void 0===this.sheet?void 0:e;return new s(this.type,this.col+t,e)}shiftedByColumns(e){return new s(this.type,this.col+e,this.sheet)}toSimpleColumnAddress(e){var t=(0,i.absoluteSheetReference)(this,e);let r=this.col;return this.isColumnRelative()&&(r=e.col+this.col),(0,i.simpleColumnAddress)(t,r)}shiftRelativeDimensions(e,t){e=this.isColumnRelative()?this.col+e:this.col;return new s(this.type,e,this.sheet)}shiftAbsoluteDimensions(e,t){e=this.isColumnAbsolute()?this.col+e:this.col;return new s(this.type,e,this.sheet)}withSheet(e){return new s(this.type,this.col,e)}isInvalid(e){return this.toSimpleColumnAddress(e).col<0}hash(e){var t=e&&void 0!==this.sheet?"#"+this.sheet:"";switch(this.type){case n.RELATIVE:return t+"#COLR"+this.col;case n.ABSOLUTE:return t+"#COLA"+this.col}}unparse(e){var e=this.toSimpleColumnAddress(e);if(!(0,i.invalidSimpleColumnAddress)(e))return e=(0,o.columnIndexToLabel)(e.col),(this.type===n.ABSOLUTE?"$":"")+e}exceedsSheetSizeLimits(e){return this.col>=e}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{RowAddress:()=>o});var n=r(3),i=r(10);class o{constructor(e,t,r){this.type=e,this.row=t,this.sheet=r}static absolute(e,t){return new o(i.ReferenceType.ABSOLUTE,e,t)}static relative(e,t){return new o(i.ReferenceType.RELATIVE,e,t)}static compareByAbsoluteAddress(r){return(e,t)=>e.toSimpleRowAddress(r).row-t.toSimpleRowAddress(r).row}isRowAbsolute(){return this.type===i.ReferenceType.ABSOLUTE}isRowRelative(){return this.type===i.ReferenceType.RELATIVE}isAbsolute(){return this.type===i.ReferenceType.ABSOLUTE&&void 0!==this.sheet}moved(e,t,r){e=void 0===this.sheet?void 0:e;return new o(this.type,this.row+r,e)}shiftedByRows(e){return new o(this.type,this.row+e,this.sheet)}toSimpleRowAddress(e){var t=(0,n.absoluteSheetReference)(this,e);let r=this.row;return this.isRowRelative()&&(r=e.row+this.row),(0,n.simpleRowAddress)(t,r)}shiftRelativeDimensions(e,t){t=this.isRowRelative()?this.row+t:this.row;return new o(this.type,t,this.sheet)}shiftAbsoluteDimensions(e,t){t=this.isRowAbsolute()?this.row+t:this.row;return new o(this.type,t,this.sheet)}withSheet(e){return new o(this.type,this.row,e)}isInvalid(e){return this.toSimpleRowAddress(e).row<0}hash(e){var t=e&&void 0!==this.sheet?"#"+this.sheet:"";switch(this.type){case i.ReferenceType.RELATIVE:return t+"#ROWR"+this.row;case i.ReferenceType.ABSOLUTE:return t+"#ROWA"+this.row}}unparse(e){e=this.toSimpleRowAddress(e);if(!(0,n.invalidSimpleRowAddress)(e))return(this.type===i.ReferenceType.ABSOLUTE?"$":"")+(e.row+1)}exceedsSheetSizeLimits(e){return this.row>=e}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{ABSOLUTE_OPERATOR:()=>i,ALL_DIGITS_ARRAY:()=>v,ALL_UNICODE_LETTERS_ARRAY:()=>b,ALL_WHITESPACE_PATTERN:()=>o,CELL_REFERENCE_PATTERN:()=>h,CELL_REFERENCE_WITH_NEXT_CHARACTER_PATTERN:()=>m,COLUMN_REFERENCE_PATTERN:()=>p,NAMED_EXPRESSION_PATTERN:()=>y,NON_RESERVED_CHARACTER_PATTERN:()=>l,ODFF_WHITESPACE_PATTERN:()=>s,QUOTED_SHEET_NAME_PATTERN:()=>u,R1C1_CELL_REFERENCE_PATTERN:()=>g,RANGE_OPERATOR:()=>n,ROW_REFERENCE_PATTERN:()=>f,SHEET_NAME_PATTERN:()=>d,UNICODE_LETTER_PATTERN:()=>a,UNQUOTED_SHEET_NAME_PATTERN:()=>c});const n=":",i="$",o="\\s+",s="[ \\t\\n\\r]+",a="A-Za-zÀ-ʯ",l=a+"0-9_.",c=`[${a}0-9_]+`,u="'(((?!').|'')*)'",d=`(${c}|${u})!`,h=`(${d})?\\${i}?[A-Za-z]+\\${i}?[0-9]+`,p=`(${d})?\\${i}?[A-Za-z]+`,f=`(${d})?\\${i}?[0-9]+`,g="[rR][0-9]*[cC][0-9]*",m=`(${h})[^${l}]`,y=`[${a}_][${l}]*`,v=["0","1","2","3","4","5","6","7","8","9"],b=[...Array.from(Array(26)).map((e,t)=>t+"A".charCodeAt(0)),...Array.from(Array(26)).map((e,t)=>t+"a".charCodeAt(0)),...Array.from(Array(496)).map((e,t)=>t+192)].map(e=>String.fromCharCode(e))},(e,t,r)=>{"use strict";r.r(t),r.d(t,{ParserWithCaching:()=>g});var d=r(14),n=r(3),s=r(7),h=r(8),i=r(57),o=r(58),a=r(59),l=r(60),p=r(62),c=r(65),u=r(10),f=r(11);class g{constructor(e,t,r){this.config=e,this.functionRegistry=t,this.sheetMapping=r,this.statsCacheUsed=0,this.lexerConfig=(0,p.buildLexerConfig)(e),this.lexer=new l.FormulaLexer(this.lexerConfig),this.formulaParser=new l.FormulaParser(this.lexerConfig,this.sheetMapping),this.cache=new a.Cache(this.functionRegistry)}parse(e,t){this.formulaAddress=t;e=this.tokenizeFormula(e);if(0<e.errors.length)return r=e.errors.map(e=>({type:i.ParsingErrorType.LexingError,message:e.message})),{ast:(0,s.buildParsingErrorAst)(),errors:r,hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]};var r=this.computeHashFromTokens(e.tokens,t);let n=this.cache.get(r);if(void 0!==n)++this.statsCacheUsed;else{e=this.bindWhitespacesToTokens(e.tokens),e=this.formulaParser.parseFromTokens(e,t);if(0<e.errors.length)return Object.assign(Object.assign({},e),{hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]});n=this.cache.set(r,e.ast)}var{ast:t,hasVolatileFunction:r,hasStructuralChangeFunction:e}=n,t=this.convertReversedRangesToRegularRanges(t);return{ast:t,errors:[],hasVolatileFunction:r,hasStructuralChangeFunction:e,dependencies:(0,s.collectDependencies)(t,this.functionRegistry)}}convertReversedRangesToRegularRanges(e){switch(e.type){case s.AstNodeType.EMPTY:case s.AstNodeType.NUMBER:case s.AstNodeType.STRING:case s.AstNodeType.ERROR:case s.AstNodeType.ERROR_WITH_RAW_INPUT:case s.AstNodeType.CELL_REFERENCE:case s.AstNodeType.NAMED_EXPRESSION:return e;case s.AstNodeType.CELL_RANGE:var{start:t,end:r}=e,t=this.orderCellRangeEnds(t,r);return Object.assign(Object.assign({},e),{start:t.start,end:t.end});case s.AstNodeType.COLUMN_RANGE:var{start:r,end:t}=e,r=this.orderColumnRangeEnds(r,t);return Object.assign(Object.assign({},e),{start:r.start,end:r.end});case s.AstNodeType.ROW_RANGE:var{start:t,end:r}=e,t=this.orderRowRangeEnds(t,r);return Object.assign(Object.assign({},e),{start:t.start,end:t.end});case s.AstNodeType.PERCENT_OP:case s.AstNodeType.PLUS_UNARY_OP:case s.AstNodeType.MINUS_UNARY_OP:r=this.convertReversedRangesToRegularRanges(e.value);return Object.assign(Object.assign({},e),{value:r});case s.AstNodeType.CONCATENATE_OP:case s.AstNodeType.EQUALS_OP:case s.AstNodeType.NOT_EQUAL_OP:case s.AstNodeType.LESS_THAN_OP:case s.AstNodeType.GREATER_THAN_OP:case s.AstNodeType.LESS_THAN_OR_EQUAL_OP:case s.AstNodeType.GREATER_THAN_OR_EQUAL_OP:case s.AstNodeType.MINUS_OP:case s.AstNodeType.PLUS_OP:case s.AstNodeType.TIMES_OP:case s.AstNodeType.DIV_OP:case s.AstNodeType.POWER_OP:t=this.convertReversedRangesToRegularRanges(e.left),r=this.convertReversedRangesToRegularRanges(e.right);return Object.assign(Object.assign({},e),{left:t,right:r});case s.AstNodeType.PARENTHESIS:t=this.convertReversedRangesToRegularRanges(e.expression);return Object.assign(Object.assign({},e),{expression:t});case s.AstNodeType.FUNCTION_CALL:r=e.args.map(e=>this.convertReversedRangesToRegularRanges(e));return Object.assign(Object.assign({},e),{args:r});case s.AstNodeType.ARRAY:t=e.args.map(e=>e.map(e=>this.convertReversedRangesToRegularRanges(e)));return Object.assign(Object.assign({},e),{args:t})}}orderCellRangeEnds(e,t){var e=[e,t],[t,r]=e.map(e=>e.toColumnAddress()).sort(u.ColumnAddress.compareByAbsoluteAddress(this.formulaAddress)),[n,i]=e.map(e=>e.toRowAddress()).sort(f.RowAddress.compareByAbsoluteAddress(this.formulaAddress)),[e,o]=e.map(e=>e.sheet).sort(g.compareSheetIds.bind(this));return{start:s.CellAddress.fromColAndRow(t,n,e),end:s.CellAddress.fromColAndRow(r,i,o)}}orderColumnRangeEnds(e,t){var e=[e,t],[t,r]=e.sort(u.ColumnAddress.compareByAbsoluteAddress(this.formulaAddress)),[e,n]=e.map(e=>e.sheet).sort(g.compareSheetIds.bind(this));return{start:new u.ColumnAddress(t.type,t.col,e),end:new u.ColumnAddress(r.type,r.col,n)}}orderRowRangeEnds(e,t){var e=[e,t],[t,r]=e.sort(f.RowAddress.compareByAbsoluteAddress(this.formulaAddress)),[e,n]=e.map(e=>e.sheet).sort(g.compareSheetIds.bind(this));return{start:new f.RowAddress(t.type,t.row,e),end:new f.RowAddress(r.type,r.row,n)}}static compareSheetIds(e,t){return(e=null!=e?e:1/0)-(t=null!=t?t:1/0)}fetchCachedResultForAst(e){e=this.computeHashFromAst(e);return this.fetchCachedResult(e)}fetchCachedResult(e){var t,r,n,e=this.cache.get(e);if(void 0===e)throw new Error("There is no AST with such key in the cache");return{ast:e,hasVolatileFunction:t,hasStructuralChangeFunction:r,relativeDependencies:n}=e,{ast:e,errors:[],hasVolatileFunction:t,hasStructuralChangeFunction:r,dependencies:n}}computeHashFromTokens(e,t){let r="",n=0;for(;n<e.length;){var i,o,s,a,l,c,u=e[n];r=(0,d.tokenMatcher)(u,p.CellReference)?void 0===(i=(0,h.cellAddressFromString)(this.sheetMapping,u.image,t))?r.concat(u.image):r.concat(i.hash(!0)):(0,d.tokenMatcher)(u,p.ProcedureName)?(i=u.image.toUpperCase().slice(0,-1),o=null!=(o=this.lexerConfig.functionMapping[i])?o:i,r.concat(o,"(")):(0,d.tokenMatcher)(u,p.ColumnRange)?([o,a]=u.image.split(":"),s=(0,h.columnAddressFromString)(this.sheetMapping,o,t),a=(0,h.columnAddressFromString)(this.sheetMapping,a,t),void 0===s||void 0===a?r.concat("!REF"):r.concat(s.hash(!0),":",a.hash(!0))):(0,d.tokenMatcher)(u,p.RowRange)?([s,a]=u.image.split(":"),l=(0,h.rowAddressFromString)(this.sheetMapping,s,t),c=(0,h.rowAddressFromString)(this.sheetMapping,a,t),void 0===l||void 0===c?r.concat("!REF"):r.concat(l.hash(!0),":",c.hash(!0))):r.concat(u.image),n++}return r}rememberNewAst(e){var t=this.computeHashFromAst(e);return this.cache.maybeSetAndThenGet(t,e)}computeHashFromAst(e){return"="+this.computeHashOfAstNode(e)}computeHashOfAstNode(e){switch(e.type){case s.AstNodeType.EMPTY:return e.leadingWhitespace||"";case s.AstNodeType.NUMBER:return(0,i.imageWithWhitespace)((0,c.formatNumber)(e.value,this.config.decimalSeparator),e.leadingWhitespace);case s.AstNodeType.STRING:return(0,i.imageWithWhitespace)('"'+e.value+'"',e.leadingWhitespace);case s.AstNodeType.NAMED_EXPRESSION:return(0,i.imageWithWhitespace)(e.expressionName,e.leadingWhitespace);case s.AstNodeType.FUNCTION_CALL:var t=e.args.map(e=>this.computeHashOfAstNode(e)).join(this.config.functionArgSeparator),t=e.procedureName+"("+t+(0,i.imageWithWhitespace)(")",e.internalWhitespace);return(0,i.imageWithWhitespace)(t,e.leadingWhitespace);case s.AstNodeType.CELL_REFERENCE:return(0,i.imageWithWhitespace)(e.reference.hash(!0),e.leadingWhitespace);case s.AstNodeType.COLUMN_RANGE:case s.AstNodeType.ROW_RANGE:case s.AstNodeType.CELL_RANGE:var t=e.start.hash(e.sheetReferenceType!==i.RangeSheetReferenceType.RELATIVE),r=e.end.hash(e.sheetReferenceType===i.RangeSheetReferenceType.BOTH_ABSOLUTE);return(0,i.imageWithWhitespace)(t+":"+r,e.leadingWhitespace);case s.AstNodeType.MINUS_UNARY_OP:return(0,i.imageWithWhitespace)("-"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case s.AstNodeType.PLUS_UNARY_OP:return(0,i.imageWithWhitespace)("+"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case s.AstNodeType.PERCENT_OP:return this.computeHashOfAstNode(e.value)+(0,i.imageWithWhitespace)("%",e.leadingWhitespace);case s.AstNodeType.ERROR:t=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:n.ErrorType.ERROR);return(0,i.imageWithWhitespace)(t,e.leadingWhitespace);case s.AstNodeType.ERROR_WITH_RAW_INPUT:return(0,i.imageWithWhitespace)(e.rawInput,e.leadingWhitespace);case s.AstNodeType.ARRAY:r=e.args.map(e=>e.map(e=>this.computeHashOfAstNode(e)).join(",")).join(";");return(0,i.imageWithWhitespace)("{"+r+(0,i.imageWithWhitespace)("}",e.internalWhitespace),e.leadingWhitespace);case s.AstNodeType.PARENTHESIS:t="("+this.computeHashOfAstNode(e.expression)+(0,i.imageWithWhitespace)(")",e.internalWhitespace);return(0,i.imageWithWhitespace)(t,e.leadingWhitespace);default:return this.computeHashOfAstNode(e.left)+(0,i.imageWithWhitespace)(o.binaryOpTokenMap[e.type],e.leadingWhitespace)+this.computeHashOfAstNode(e.right)}}bindWhitespacesToTokens(t){var r=[],e=t[0];(0,d.tokenMatcher)(e,this.lexerConfig.WhiteSpace)||r.push(e);for(let e=1;e<t.length;++e){var n,i=t[e];(0,d.tokenMatcher)(i,this.lexerConfig.WhiteSpace)||(n=t[e-1],(0,d.tokenMatcher)(n,this.lexerConfig.WhiteSpace)&&(i.leadingWhitespace=n),r.push(i))}return r}tokenizeFormula(e){return this.lexer.tokenizeFormula(e)}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{Alternation:()=>u.Alternation,CstParser:()=>i.CstParser,EMPTY_ALT:()=>i.EMPTY_ALT,EOF:()=>s.EOF,EarlyExitException:()=>l.EarlyExitException,EmbeddedActionsParser:()=>i.EmbeddedActionsParser,Flat:()=>u.Flat,GAstVisitor:()=>d.GAstVisitor,Lexer:()=>o.Lexer,LexerDefinitionErrorType:()=>o.LexerDefinitionErrorType,MismatchedTokenException:()=>l.MismatchedTokenException,NoViableAltException:()=>l.NoViableAltException,NonTerminal:()=>u.NonTerminal,NotAllInputParsedException:()=>l.NotAllInputParsedException,Option:()=>u.Option,Parser:()=>i.Parser,ParserDefinitionErrorType:()=>i.ParserDefinitionErrorType,Repetition:()=>u.Repetition,RepetitionMandatory:()=>u.RepetitionMandatory,RepetitionMandatoryWithSeparator:()=>u.RepetitionMandatoryWithSeparator,RepetitionWithSeparator:()=>u.RepetitionWithSeparator,Rule:()=>u.Rule,Terminal:()=>u.Terminal,VERSION:()=>n.VERSION,assignOccurrenceIndices:()=>h.assignOccurrenceIndices,clearCache:()=>function(){console.warn("The clearCache function was 'soft' removed from the Chevrotain API.\n\t It performs no action other than printing this message.\n\t Please avoid using it as it will be completely removed in the future")},createSyntaxDiagramsCode:()=>p.createSyntaxDiagramsCode,createToken:()=>s.createToken,createTokenInstance:()=>s.createTokenInstance,defaultGrammarResolverErrorProvider:()=>a.defaultGrammarResolverErrorProvider,defaultGrammarValidatorErrorProvider:()=>a.defaultGrammarValidatorErrorProvider,defaultLexerErrorProvider:()=>c.defaultLexerErrorProvider,defaultParserErrorProvider:()=>a.defaultParserErrorProvider,generateParserFactory:()=>f.generateParserFactory,generateParserModule:()=>f.generateParserModule,isRecognitionException:()=>l.isRecognitionException,resolveGrammar:()=>h.resolveGrammar,serializeGrammar:()=>u.serializeGrammar,serializeProduction:()=>u.serializeProduction,tokenLabel:()=>s.tokenLabel,tokenMatcher:()=>s.tokenMatcher,tokenName:()=>s.tokenName,validateGrammar:()=>h.validateGrammar});var n=r(15),i=r(16),o=r(22),s=r(21),a=r(35),l=r(42),c=r(28),u=r(20),d=r(31),h=r(39),p=r(54),f=r(55)},(e,t,r)=>{"use strict";r.r(t),r.d(t,{VERSION:()=>n});var n="6.5.0"},(e,t,r)=>{"use strict";r.r(t),r.d(t,{CstParser:()=>x,DEFAULT_PARSER_CONFIG:()=>C,DEFAULT_RULE_CONFIG:()=>E,EMPTY_ALT:()=>function(e){void 0===e&&(e=void 0);return function(){return e}},END_OF_FILE:()=>w,EmbeddedActionsParser:()=>N,Parser:()=>T,ParserDefinitionErrorType:()=>i});var n,i,o=r(17),s=r(18),t=r(21),a=r(33),l=r(35),c=r(39),u=r(41),d=r(43),h=r(44),p=r(47),f=r(48),g=r(49),m=r(50),y=r(51),v=r(52),r=r(53),b=(n=function(e,t){return(n=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])}))(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),w=(0,t.createTokenInstance)(t.EOF,"",NaN,NaN,NaN,NaN,NaN,NaN),C=(Object.freeze(w),Object.freeze({recoveryEnabled:!1,maxLookahead:4,ignoredIssues:{},dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:l.defaultParserErrorProvider,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1})),E=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0});(t=i=i||{})[t.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",t[t.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",t[t.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",t[t.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",t[t.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",t[t.LEFT_RECURSION=5]="LEFT_RECURSION",t[t.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",t[t.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",t[t.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",t[t.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",t[t.INVALID_NESTED_RULE_NAME=10]="INVALID_NESTED_RULE_NAME",t[t.DUPLICATE_NESTED_NAME=11]="DUPLICATE_NESTED_NAME",t[t.NO_NON_EMPTY_LOOKAHEAD=12]="NO_NON_EMPTY_LOOKAHEAD",t[t.AMBIGUOUS_PREFIX_ALTS=13]="AMBIGUOUS_PREFIX_ALTS",t[t.TOO_MANY_ALTS=14]="TOO_MANY_ALTS";S.performSelfAnalysis=function(e){e.performSelfAnalysis()},S.prototype.performSelfAnalysis=function(){var n=this;this.TRACE_INIT("performSelfAnalysis",function(){n.selfAnalysisDone=!0;var e,t=n.className,r=(n.TRACE_INIT("toFastProps",function(){(0,o.toFastProperties)(n)}),n.TRACE_INIT("Grammar Recording",function(){try{n.enableRecording(),(0,o.forEach)(n.definedRulesNames,function(e){var t=n[e].originalGrammarAction,r=void 0;n.TRACE_INIT(e+" Rule",function(){r=n.topLevelRuleRecord(e,t)}),n.gastProductionsCache[e]=r})}finally{n.disableRecording()}}),[]);if(n.TRACE_INIT("Grammar Resolving",function(){r=(0,c.resolveGrammar)({rules:(0,o.values)(n.gastProductionsCache)}),n.definitionErrors.push.apply(n.definitionErrors,r)}),n.TRACE_INIT("Grammar Validations",function(){var e;(0,o.isEmpty)(r)&&!1===n.skipValidations&&(e=(0,c.validateGrammar)({rules:(0,o.values)(n.gastProductionsCache),maxLookahead:n.maxLookahead,tokenTypes:(0,o.values)(n.tokensMap),ignoredIssues:n.ignoredIssues,errMsgProvider:l.defaultGrammarValidatorErrorProvider,grammarName:t}),n.definitionErrors.push.apply(n.definitionErrors,e))}),(0,o.isEmpty)(n.definitionErrors)&&(n.recoveryEnabled&&n.TRACE_INIT("computeAllProdsFollows",function(){var e=(0,s.computeAllProdsFollows)((0,o.values)(n.gastProductionsCache));n.resyncFollows=e}),n.TRACE_INIT("ComputeLookaheadFunctions",function(){n.preComputeLookaheadFunctions((0,o.values)(n.gastProductionsCache))})),n.TRACE_INIT("expandAllNestedRuleNames",function(){var e=(0,a.expandAllNestedRuleNames)((0,o.values)(n.gastProductionsCache),n.fullRuleNameToShort);n.allRuleNames=e.allRuleNames}),!S.DEFER_DEFINITION_ERRORS_HANDLING&&!(0,o.isEmpty)(n.definitionErrors))throw e=(0,o.map)(n.definitionErrors,function(e){return e.message}),new Error("Parser Definition Errors detected:\n "+e.join("\n-------------------------------\n"))})},S.DEFER_DEFINITION_ERRORS_HANDLING=!1;var T=S;function S(e,t){void 0===t&&(t=C),this.ignoredIssues=C.ignoredIssues,this.definitionErrors=[],this.selfAnalysisDone=!1;this.initErrorHandler(t),this.initLexerAdapter(),this.initLooksAhead(t),this.initRecognizerEngine(e,t),this.initRecoverable(t),this.initTreeBuilder(t),this.initContentAssist(),this.initGastRecorder(t),this.initPerformanceTracer(t),(0,o.has)(t,"ignoredIssues")&&t.ignoredIssues!==C.ignoredIssues&&(0,o.PRINT_WARNING)("The <ignoredIssues> IParserConfig property is soft-deprecated and will be removed in future versions.\n\tPlease use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead."),this.ignoredIssues=((0,o.has)(t,"ignoredIssues")?t:C).ignoredIssues,this.skipValidations=((0,o.has)(t,"skipValidations")?t:C).skipValidations}(0,o.applyMixins)(T,[u.Recoverable,d.LooksAhead,h.TreeBuilder,p.LexerAdapter,g.RecognizerEngine,f.RecognizerApi,m.ErrorHandler,y.ContentAssist,v.GastRecorder,r.PerformanceTracer]);b(R,_=T);var _,x=R;function R(e,t){t=(0,o.cloneObj)(t=void 0===t?C:t);return t.outputCst=!0,_.call(this,e,t)||this}b(O,A=T);var A,N=O;function O(e,t){t=(0,o.cloneObj)(t=void 0===t?C:t);return t.outputCst=!1,A.call(this,e,t)||this}},(L,e,t)=>{"use strict";function r(e){return e&&0===e.length}function l(e){return null==e?[]:Object.keys(e)}function c(e){for(var t=[],r=Object.keys(e),n=0;n<r.length;n++)t.push(e[r[n]]);return t}function n(e,t){for(var r=[],n=l(e),i=0;i<n.length;i++){var o=n[i];r.push(t.call(null,e[o],o))}return r}function i(e,t){for(var r=[],n=0;n<e.length;n++)r.push(t.call(null,e[n],n));return r}function o(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];Array.isArray(n)?t=t.concat(o(n)):t.push(n)}return t}function s(e){return r(e)?void 0:e[0]}function a(e){var t=e&&e.length;return t?e[t-1]:void 0}function u(e,t){if(Array.isArray(e))for(var r=0;r<e.length;r++)t.call(null,e[r],r);else{if(!I(e))throw Error("non exhaustive match");for(var n=l(e),r=0;r<n.length;r++){var i=n[r],o=e[i];t.call(null,o,i)}}}function d(e){return"string"==typeof e}function h(e){return void 0===e}function p(e){return e instanceof Function}function f(e,t){return e.slice(t=void 0===t?1:t,e.length)}function g(e,t){return e.slice(0,e.length-(t=void 0===t?1:t))}function m(e,t){var r=[];if(Array.isArray(e))for(var n=0;n<e.length;n++){var i=e[n];t.call(null,i)&&r.push(i)}return r}function y(e,t){return m(e,function(e){return!t(e)})}function v(e,t){for(var r=Object.keys(e),n={},i=0;i<r.length;i++){var o=r[i],s=e[o];t(s)&&(n[o]=s)}return n}function b(e,t){return!!I(e)&&e.hasOwnProperty(t)}function w(e,t){return void 0!==T(e,function(e){return e===t})}function C(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r]);return t}function E(e){var t,r={};for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r}function T(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(t.call(null,n))return n}}function S(e,t){for(var r=[],n=0;n<e.length;n++){var i=e[n];t.call(null,i)&&r.push(i)}return r}function _(e,t,r){for(var n=Array.isArray(e),i=n?e:c(e),o=n?[]:l(e),s=r,a=0;a<i.length;a++)s=t.call(null,s,i[a],n?a:o[a]);return s}function x(e){return y(e,function(e){return null==e})}function R(e,n){void 0===n&&(n=function(e){return e});var i=[];return _(e,function(e,t){var r=n(t);return w(i,r)?e:(i.push(r),e.concat(t))},[])}function A(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=[null].concat(t);return Function.bind.apply(e,n)}function N(e){return Array.isArray(e)}function O(e){return e instanceof RegExp}function I(e){return e instanceof Object}function M(e,t){for(var r=0;r<e.length;r++)if(!t(e[r],r))return!1;return!0}function k(e,t){return y(e,function(e){return w(t,e)})}function D(e,t){for(var r=0;r<e.length;r++)if(t(e[r]))return!0;return!1}function F(e,t){for(var r=0;r<e.length;r++)if(e[r]===t)return r;return-1}function H(e,r){e=C(e);return e.sort(function(e,t){return r(e)-r(t)}),e}function U(e,t){if(e.length!==t.length)throw Error("can't zipObject with different number of keys and values!");for(var r={},n=0;n<e.length;n++)r[e[n]]=t[n];return r}function V(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n=0;n<t.length;n++)for(var i=t[n],o=l(i),s=0;s<o.length;s++){var a=o[s];e[a]=i[a]}return e}function P(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n=0;n<t.length;n++){var i=t[n];if(!h(i))for(var o=l(i),s=0;s<o.length;s++){var a=o[s];b(e,a)||(e[a]=i[a])}}return e}function W(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return P.apply(null,[{}].concat(e))}function $(e,n){var i={};return u(e,function(e){var t=n(e),r=i[t];r?r.push(e):i[t]=[e]}),i}function B(e,t){for(var r=E(e),n=l(t),i=0;i<n.length;i++){var o=n[i],s=t[o];r[o]=s}return r}function j(){}function z(e){return e}function Y(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];t.push(void 0!==n?n:void 0)}return t}function G(e){console&&console.error&&console.error("Error: "+e)}function q(e){console&&console.warn&&console.warn("Warning: "+e)}function K(){return"function"==typeof Map}function X(i,e){e.forEach(function(r){var n=r.prototype;Object.getOwnPropertyNames(n).forEach(function(e){var t;"constructor"!==e&&((t=Object.getOwnPropertyDescriptor(n,e))&&(t.get||t.set)?Object.defineProperty(i.prototype,e,t):i.prototype[e]=r.prototype[e])})})}function J(e){function t(){}t.prototype=e;var r=new t;function n(){r.bar}return n(),n(),e}function Z(e){return e[e.length-1]}function Q(e){var t=(new Date).getTime(),e=e();return{time:(new Date).getTime()-t,value:e}}t.r(e),t.d(e,{IDENTITY:()=>z,NOOP:()=>j,PRINT_ERROR:()=>G,PRINT_WARNING:()=>q,applyMixins:()=>X,assign:()=>V,assignNoOverwrite:()=>P,cloneArr:()=>C,cloneObj:()=>E,compact:()=>x,contains:()=>w,defaults:()=>W,difference:()=>k,drop:()=>f,dropRight:()=>g,every:()=>M,filter:()=>m,find:()=>T,findAll:()=>S,first:()=>s,flatten:()=>o,forEach:()=>u,groupBy:()=>$,has:()=>b,indexOf:()=>F,isArray:()=>N,isES2015MapSupported:()=>K,isEmpty:()=>r,isFunction:()=>p,isObject:()=>I,isRegExp:()=>O,isString:()=>d,isUndefined:()=>h,keys:()=>l,last:()=>a,map:()=>i,mapValues:()=>n,merge:()=>B,packArray:()=>Y,partial:()=>A,peek:()=>Z,pick:()=>v,reduce:()=>_,reject:()=>y,some:()=>D,sortBy:()=>H,timer:()=>Q,toFastProperties:()=>J,uniq:()=>R,values:()=>c,zipObject:()=>U})},(e,t,r)=>{"use strict";r.r(t),r.d(t,{ResyncFollowsWalker:()=>c,buildBetweenProdsFollowPrefix:()=>d,buildInProdFollowPrefix:()=>function(e){return e.terminalType.name+e.idx+a.IN},computeAllProdsFollows:()=>function(e){var t={};return(0,s.forEach)(e,function(e){e=new c(e).startWalking();(0,s.assign)(t,e)}),t}});var n,i,t=r(19),o=r(29),s=r(17),a=r(32),l=r(20),r=(n=function(e,t){return(n=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])}))(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),c=(i=t.RestWalker,r(u,i),u.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},u.prototype.walkTerminal=function(e,t,r){},u.prototype.walkProdRef=function(e,t,r){e=d(e.referencedRule,e.idx)+this.topProd.name,t=t.concat(r),r=new l.Flat({definition:t}),t=(0,o.first)(r);this.follows[e]=t},u);function u(e){var t=i.call(this)||this;return t.topProd=e,t.follows={},t}function d(e,t){return e.name+t+a.IN}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{RestWalker:()=>n});var o=r(17),s=r(20),n=(i.prototype.walk=function(r,n){var i=this;void 0===n&&(n=[]),(0,o.forEach)(r.definition,function(e,t){t=(0,o.drop)(r.definition,t+1);if(e instanceof s.NonTerminal)i.walkProdRef(e,t,n);else if(e instanceof s.Terminal)i.walkTerminal(e,t,n);else if(e instanceof s.Flat)i.walkFlat(e,t,n);else if(e instanceof s.Option)i.walkOption(e,t,n);else if(e instanceof s.RepetitionMandatory)i.walkAtLeastOne(e,t,n);else if(e instanceof s.RepetitionMandatoryWithSeparator)i.walkAtLeastOneSep(e,t,n);else if(e instanceof s.RepetitionWithSeparator)i.walkManySep(e,t,n);else if(e instanceof s.Repetition)i.walkMany(e,t,n);else{if(!(e instanceof s.Alternation))throw Error("non exhaustive match");i.walkOr(e,t,n)}})},i.prototype.walkTerminal=function(e,t,r){},i.prototype.walkProdRef=function(e,t,r){},i.prototype.walkFlat=function(e,t,r){t=t.concat(r);this.walk(e,t)},i.prototype.walkOption=function(e,t,r){t=t.concat(r);this.walk(e,t)},i.prototype.walkAtLeastOne=function(e,t,r){t=[new s.Option({definition:e.definition})].concat(t,r);this.walk(e,t)},i.prototype.walkAtLeastOneSep=function(e,t,r){t=a(e,t,r);this.walk(e,t)},i.prototype.walkMany=function(e,t,r){t=[new s.Option({definition:e.definition})].concat(t,r);this.walk(e,t)},i.prototype.walkManySep=function(e,t,r){t=a(e,t,r);this.walk(e,t)},i.prototype.walkOr=function(e,t,r){var n=this,i=t.concat(r);(0,o.forEach)(e.definition,function(e){e=new s.Flat({definition:[e]});n.walk(e,i)})},i);function i(){}function a(e,t,r){return[new s.Option({definition:[new s.Terminal({terminalType:e.separator})].concat(e.definition)})].concat(t,r)}},(L,e,t)=>{"use strict";t.r(e),t.d(e,{AbstractProduction:()=>r,Alternation:()=>I,Flat:()=>p,NonTerminal:()=>a,Option:()=>m,Repetition:()=>_,RepetitionMandatory:()=>b,RepetitionMandatoryWithSeparator:()=>E,RepetitionWithSeparator:()=>A,Rule:()=>u,Terminal:()=>k,serializeGrammar:()=>function(e){return(0,i.map)(e,P)},serializeProduction:()=>P});var n,i=t(17),F=t(21),e=(n=function(e,t){return(n=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])}))(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),r=(o.prototype.accept=function(t){t.visit(this),(0,i.forEach)(this.definition,function(e){e.accept(t)})},o);function o(e){this.definition=e}e(l,s=r),Object.defineProperty(l.prototype,"definition",{get:function(){return void 0!==this.referencedRule?this.referencedRule.definition:[]},set:function(e){},enumerable:!0,configurable:!0}),l.prototype.accept=function(e){e.visit(this)};var s,a=l;function l(e){var t=s.call(this,[])||this;return t.idx=1,(0,i.assign)(t,(0,i.pick)(e,function(e){return void 0!==e})),t}e(d,c=r);var c,u=d;function d(e){var t=c.call(this,e.definition)||this;return(t.orgText="",i.assign)(t,(0,i.pick)(e,function(e){return void 0!==e})),t}e(f,h=r);var h,p=f;function f(e){var t=h.call(this,e.definition)||this;return(t.ignoreAmbiguities=!1,i.assign)(t,(0,i.pick)(e,function(e){return void 0!==e})),t}e(y,g=r);var g,m=y;function y(e){var t=g.call(this,e.definition)||this;return t.idx=1,(0,i.assign)(t,(0,i.pick)(e,function(e){return void 0!==e})),t}e(w,v=r);var v,b=w;function w(e){var t=v.call(this,e.definition)||this;return t.idx=1,(0,i.assign)(t,(0,i.pick)(e,function(e){return void 0!==e})),t}e(T,C=r);var C,E=T;function T(e){var t=C.call(this,e.definition)||this;return t.idx=1,(0,i.assign)(t,(0,i.pick)(e,function(e){return void 0!==e})),t}e(x,S=r);var S,_=x;function x(e){var t=S.call(this,e.definition)||this;return t.idx=1,(0,i.assign)(t,(0,i.pick)(e,function(e){return void 0!==e})),t}e(N,R=r);var R,A=N;function N(e){var t=R.call(this,e.definition)||this;return t.idx=1,(0,i.assign)(t,(0,i.pick)(e,function(e){return void 0!==e})),t}e(M,O=r);var O,I=M;function M(e){var t=O.call(this,e.definition)||this;return t.idx=1,t.ignoreAmbiguities=!1,(t.hasPredicates=!1,i.assign)(t,(0,i.pick)(e,function(e){return void 0!==e})),t}D.prototype.accept=function(e){e.visit(this)};var k=D;function D(e){this.idx=1,(0,i.assign)(this,(0,i.pick)(e,function(e){return void 0!==e}))}function P(e){function t(e){return(0,i.map)(e,P)}if(e instanceof a)return{type:"NonTerminal",name:e.nonTerminalName,idx:e.idx};if(e instanceof p)return{type:"Flat",definition:t(e.definition)};if(e instanceof m)return{type:"Option",idx:e.idx,definition:t(e.definition)};if(e instanceof b)return{type:"RepetitionMandatory",name:e.name,idx:e.idx,definition:t(e.definition)};if(e instanceof E)return{type:"RepetitionMandatoryWithSeparator",name:e.name,idx:e.idx,separator:P(new k({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof A)return{type:"RepetitionWithSeparator",name:e.name,idx:e.idx,separator:P(new k({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof _)return{type:"Repetition",name:e.name,idx:e.idx,definition:t(e.definition)};if(e instanceof I)return{type:"Alternation",name:e.name,idx:e.idx,definition:t(e.definition)};var r,n;if(e instanceof k)return r={type:"Terminal",name:e.terminalType.name,label:(0,F.tokenLabel)(e.terminalType),idx:e.idx},n=e.terminalType.PATTERN,e.terminalType.PATTERN&&(r.pattern=(0,i.isRegExp)(n)?n.source:n),r;if(e instanceof u)return{type:"Rule",name:e.name,orgText:e.orgText,definition:t(e.definition)};throw Error("non exhaustive match")}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{EOF:()=>m,createToken:()=>g,createTokenInstance:()=>function(e,t,r,n,i,o,s,a){return{image:t,startOffset:r,endOffset:n,startLine:i,endLine:o,startColumn:s,endColumn:a,tokenTypeIdx:e.tokenTypeIdx,tokenType:e}},hasTokenLabel:()=>o,tokenLabel:()=>function(e){return o(e)?e.LABEL:e.name},tokenMatcher:()=>function(e,t){return(0,i.tokenStructuredMatcher)(e,t)},tokenName:()=>function(e){return e.name}});var n=r(17),t=r(22),i=r(27);function o(e){return(0,n.isString)(e.LABEL)&&""!==e.LABEL}var s="parent",a="categories",l="label",c="group",u="push_mode",d="pop_mode",h="longer_alt",p="line_breaks",f="start_chars_hint";function g(e){var t=e.pattern,r={};if(r.name=e.name,(0,n.isUndefined)(t)||(r.PATTERN=t),(0,n.has)(e,s))throw"The parent property is no longer supported.\nSee: https://github.com/SAP/chevrotain/issues/564#issuecomment-349062346 for details.";return(0,n.has)(e,a)&&(r.CATEGORIES=e[a]),(0,i.augmentTokenTypes)([r]),(0,n.has)(e,l)&&(r.LABEL=e[l]),(0,n.has)(e,c)&&(r.GROUP=e[c]),(0,n.has)(e,d)&&(r.POP_MODE=e[d]),(0,n.has)(e,u)&&(r.PUSH_MODE=e[u]),(0,n.has)(e,h)&&(r.LONGER_ALT=e[h]),(0,n.has)(e,p)&&(r.LINE_BREAKS=e[p]),(0,n.has)(e,f)&&(r.START_CHARS_HINT=e[f]),r}var m=g({name:"EOF",pattern:t.Lexer.NA});(0,i.augmentTokenTypes)([m])},(e,t,r)=>{"use strict";r.r(t),r.d(t,{Lexer:()=>i,LexerDefinitionErrorType:()=>n});var n,J=r(23),Z=r(17),a=r(27),t=r(28),l=r(26),c=((r=n=n||{})[r.MISSING_PATTERN=0]="MISSING_PATTERN",r[r.INVALID_PATTERN=1]="INVALID_PATTERN",r[r.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",r[r.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",r[r.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",r[r.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",r[r.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",r[r.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",r[r.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",r[r.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",r[r.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",r[r.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",r[r.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",r[r.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",r[r.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",r[r.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",{deferDefinitionErrorsHandling:!(r[r.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK"),positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:["\n","\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:t.defaultLexerErrorProvider,traceInitPerf:!1,skipValidations:!1}),i=(Object.freeze(c),o.prototype.tokenize=function(e,t){if(void 0===t&&(t=this.defaultMode),(0,Z.isEmpty)(this.lexerDefinitionErrors))return this.tokenizeInternal(e,t);throw e=(0,Z.map)(this.lexerDefinitionErrors,function(e){return e.message}).join("-----------------------\n"),new Error("Unable to Tokenize because Errors detected in definition of Lexer:\n"+e)},o.prototype.tokenizeInternal=function(e,L){var t,r,n,i,F,o,s=this,a=e,H=a.length,l=0,c=0,U=this.hasCustom?0:Math.floor(e.length/10),u=new Array(U),d=[],h=this.trackStartLines?1:void 0,p=this.trackStartLines?1:void 0,f=(0,J.cloneEmptyGroups)(this.emptyGroups),V=this.trackStartLines,g=this.config.lineTerminatorsPattern,m=0,y=[],v=[],b=[],W=[],w=(Object.freeze(W),void 0);function $(){return y}function B(e){e=(0,J.charCodeToOptimizedIndex)(e),e=v[e];return void 0===e?W:e}function j(e){var t;1===b.length&&void 0===e.tokenType.PUSH_MODE?(t=s.config.errorMessageProvider.buildUnableToPopLexerModeMessage(e),d.push({offset:e.startOffset,line:void 0!==e.startLine?e.startLine:void 0,column:void 0!==e.startColumn?e.startColumn:void 0,length:e.image.length,message:t})):(b.pop(),e=(0,Z.last)(b),y=s.patternIdxToConfig[e],v=s.charCodeToPatternIdxToConfig[e],m=y.length,t=s.canModeBeOptimized[e]&&!1===s.config.safeMode,w=v&&t?B:$)}function z(e){b.push(e),v=this.charCodeToPatternIdxToConfig[e],y=this.patternIdxToConfig[e],m=y.length,m=y.length;e=this.canModeBeOptimized[e]&&!1===this.config.safeMode;w=v&&e?B:$}for(z.call(this,L);l<H;){for(var C=null,Y=a.charCodeAt(l),G=w(Y),q=G.length,E=0;E<q;E++){var T,S,_,x,R=(T=G[E]).pattern,A=null;if(!1!==(D=T.short)?Y===D&&(C=R):!0===T.isCustom?null!==(o=R.exec(a,l,u,f))?(C=o[0],void 0!==o.payload&&(A=o.payload)):C=null:(this.updateLastIndex(R,l),C=this.match(R,e,l)),null!==C){void 0!==(x=T.longerAlt)&&(S=(x=y[x]).pattern,!(_=null)===x.isCustom?null!==(o=S.exec(a,l,u,f))?(r=o[0],void 0!==o.payload&&(_=o.payload)):r=null:(this.updateLastIndex(S,l),r=this.match(S,e,l)),r)&&r.length>C.length&&(C=r,A=_,T=x);break}}if(null!==C){if(M=C.length,void 0!==(I=T.group)&&(n=T.tokenTypeIdx,n=this.createTokenInstance(C,l,n,T.tokenType,h,p,M),this.handlePayload(n,A),!1===I?c=this.addToken(u,c,n):f[I].push(n)),e=this.chopInput(e,M),l+=M,p=this.computeNewColumn(p,M),!0===V&&!0===T.canLineTerminator){var K,N=0,O=void 0;for(g.lastIndex=0;!0===(K=g.test(C))&&(O=g.lastIndex-1,N++),!0===K;);0!==N&&(h+=N,this.updateTokenEndLineColumnLocation(n,I,O,N,h,p=M-O,M))}this.handleModes(T,j,z,n)}else{for(var I=l,M=h,X=p,k=!1;!k&&l<H;)for(a.charCodeAt(l),e=this.chopInput(e,1),l++,t=0;t<m;t++){var D,P=y[t],R=P.pattern;if(!1!==(D=P.short)?a.charCodeAt(l)===D&&(k=!0):k=!0===P.isCustom?null!==R.exec(a,l,u,f):(this.updateLastIndex(R,l),null!==R.exec(e)),!0===k)break}F=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(a,I,i=l-I,M,X),d.push({offset:I,line:M,column:X,length:i,message:F})}}return this.hasCustom||(u.length=c),{tokens:u,groups:f,errors:d}},o.prototype.handleModes=function(e,t,r,n){var i;!0===e.pop?(i=e.push,t(n),void 0!==i&&r.call(this,i)):void 0!==e.push&&r.call(this,e.push)},o.prototype.chopInput=function(e,t){return e.substring(t)},o.prototype.updateLastIndex=function(e,t){e.lastIndex=t},o.prototype.updateTokenEndLineColumnLocation=function(e,t,r,n,i,o,s){void 0!==t&&(r=(t=r===s-1)?-1:0,1===n&&!0==t||(e.endLine=i+r,e.endColumn=o-1-r))},o.prototype.computeNewColumn=function(e,t){return e+t},o.prototype.createTokenInstance=function(){for(var e=0;e<arguments.length;e++)e,0;return null},o.prototype.createOffsetOnlyToken=function(e,t,r,n){return{image:e,startOffset:t,tokenTypeIdx:r,tokenType:n}},o.prototype.createStartOnlyToken=function(e,t,r,n,i,o){return{image:e,startOffset:t,startLine:i,startColumn:o,tokenTypeIdx:r,tokenType:n}},o.prototype.createFullToken=function(e,t,r,n,i,o,s){return{image:e,startOffset:t,endOffset:t+s-1,startLine:i,endLine:i,startColumn:o,endColumn:o+s-1,tokenTypeIdx:r,tokenType:n}},o.prototype.addToken=function(e,t,r){return 666},o.prototype.addTokenUsingPush=function(e,t,r){return e.push(r),t},o.prototype.addTokenUsingMemberAccess=function(e,t,r){return e[t]=r,++t},o.prototype.handlePayload=function(e,t){},o.prototype.handlePayloadNoCustom=function(e,t){},o.prototype.handlePayloadWithCustom=function(e,t){null!==t&&(e.payload=t)},o.prototype.match=function(e,t,r){return null},o.prototype.matchWithTest=function(e,t,r){return!0===e.test(t)?t.substring(r,e.lastIndex):null},o.prototype.matchWithExec=function(e,t){e=e.exec(t);return null!==e?e[0]:e},o.prototype.TRACE_INIT=function(e,t){var r,n,i,o;return!0===this.traceInitPerf?(this.traceInitIndent++,r=new Array(this.traceInitIndent+1).join("\t"),this.traceInitIndent<this.traceInitMaxIdent&&console.log(r+"--\x3e <"+e+">"),n=(i=(0,Z.timer)(t)).time,i=i.value,o=10<n?console.warn:console.log,this.traceInitIndent<this.traceInitMaxIdent&&o(r+"<-- <"+e+"> time: "+n+"ms"),this.traceInitIndent--,i):t()},o.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",o.NA=/NOT_APPLICABLE/,o);function o(i,o){var s=this;if(void 0===o&&(o=c),this.lexerDefinition=i,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.config=void 0,this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},"boolean"==typeof o)throw Error("The second argument to the Lexer constructor is now an ILexerConfig Object.\na boolean 2nd argument is no longer supported");this.config=(0,Z.merge)(c,o);var e=this.config.traceInitPerf;!0===e?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):"number"==typeof e&&(this.traceInitMaxIdent=e,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",function(){var r,e,t=!0,n=(s.TRACE_INIT("Lexer Config handling",function(){if(s.config.lineTerminatorsPattern===c.lineTerminatorsPattern)s.config.lineTerminatorsPattern=J.LineTerminatorOptimizedTester;else if(s.config.lineTerminatorCharacters===c.lineTerminatorCharacters)throw Error("Error: Missing <lineTerminatorCharacters> property on the Lexer config.\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS");if(o.safeMode&&o.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');s.trackStartLines=/full|onlyStart/i.test(s.config.positionTracking),s.trackEndLines=/full/i.test(s.config.positionTracking),(0,Z.isArray)(i)?((r={modes:{}}).modes[J.DEFAULT_MODE]=(0,Z.cloneArr)(i),r[J.DEFAULT_MODE]=J.DEFAULT_MODE):r=(t=!1,Z.cloneObj)(i)}),!1===s.config.skipValidations&&(s.TRACE_INIT("performRuntimeChecks",function(){s.lexerDefinitionErrors=s.lexerDefinitionErrors.concat((0,J.performRuntimeChecks)(r,s.trackStartLines,s.config.lineTerminatorCharacters))}),s.TRACE_INIT("performWarningRuntimeChecks",function(){s.lexerDefinitionWarning=s.lexerDefinitionWarning.concat((0,J.performWarningRuntimeChecks)(r,s.trackStartLines,s.config.lineTerminatorCharacters))})),r.modes=r.modes||{},(0,Z.forEach)(r.modes,function(e,t){r.modes[t]=(0,Z.reject)(e,function(e){return(0,Z.isUndefined)(e)})}),(0,Z.keys)(r.modes));if((0,Z.forEach)(r.modes,function(t,r){s.TRACE_INIT("Mode: <"+r+"> processing",function(){var e;s.modes.push(r),!1===s.config.skipValidations&&s.TRACE_INIT("validatePatterns",function(){s.lexerDefinitionErrors=s.lexerDefinitionErrors.concat((0,J.validatePatterns)(t,n))}),(0,Z.isEmpty)(s.lexerDefinitionErrors)&&((0,a.augmentTokenTypes)(t),s.TRACE_INIT("analyzeTokenTypes",function(){e=(0,J.analyzeTokenTypes)(t,{lineTerminatorCharacters:s.config.lineTerminatorCharacters,positionTracking:o.positionTracking,ensureOptimizations:o.ensureOptimizations,safeMode:o.safeMode,tracer:s.TRACE_INIT.bind(s)})}),s.patternIdxToConfig[r]=e.patternIdxToConfig,s.charCodeToPatternIdxToConfig[r]=e.charCodeToPatternIdxToConfig,s.emptyGroups=(0,Z.merge)(s.emptyGroups,e.emptyGroups),s.hasCustom=e.hasCustom||s.hasCustom,s.canModeBeOptimized[r]=e.canBeOptimized)})}),s.defaultMode=r.defaultMode,!(0,Z.isEmpty)(s.lexerDefinitionErrors)&&!s.config.deferDefinitionErrorsHandling)throw e=(0,Z.map)(s.lexerDefinitionErrors,function(e){return e.message}).join("-----------------------\n"),new Error("Errors detected in definition of Lexer:\n"+e);(0,Z.forEach)(s.lexerDefinitionWarning,function(e){(0,Z.PRINT_WARNING)(e.message)}),s.TRACE_INIT("Choosing sub-methods implementations",function(){if(J.SUPPORT_STICKY?(s.chopInput=Z.IDENTITY,s.match=s.matchWithTest):(s.updateLastIndex=Z.NOOP,s.match=s.matchWithExec),t&&(s.handleModes=Z.NOOP),!1===s.trackStartLines&&(s.computeNewColumn=Z.IDENTITY),!1===s.trackEndLines&&(s.updateTokenEndLineColumnLocation=Z.NOOP),/full/i.test(s.config.positionTracking))s.createTokenInstance=s.createFullToken;else if(/onlyStart/i.test(s.config.positionTracking))s.createTokenInstance=s.createStartOnlyToken;else{if(!/onlyOffset/i.test(s.config.positionTracking))throw Error('Invalid <positionTracking> config option: "'+s.config.positionTracking+'"');s.createTokenInstance=s.createOffsetOnlyToken}s.hasCustom?(s.addToken=s.addTokenUsingPush,s.handlePayload=s.handlePayloadWithCustom):(s.addToken=s.addTokenUsingMemberAccess,s.handlePayload=s.handlePayloadNoCustom)}),s.TRACE_INIT("Failed Optimization Warnings",function(){var e=(0,Z.reduce)(s.canModeBeOptimized,function(e,t,r){return!1===t&&e.push(r),e},[]);if(o.ensureOptimizations&&!(0,Z.isEmpty)(e))throw Error("Lexer Modes: < "+e.join(", ")+' > cannot be optimized.\n\t Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.\n\t Or inspect the console log for details on how to resolve these issues.')}),s.TRACE_INIT("clearRegExpParserCache",function(){(0,l.clearRegExpParserCache)()}),s.TRACE_INIT("toFastProperties",function(){(0,Z.toFastProperties)(s)})})}},(L,e,t)=>{"use strict";t.r(e),t.d(e,{DEFAULT_MODE:()=>a,LineTerminatorOptimizedTester:()=>F,MODES:()=>l,SUPPORT_STICKY:()=>E,addStartOfInput:()=>x,addStickyFlag:()=>R,analyzeTokenTypes:()=>function(e,o){var r,n,i,s,a,l,c,u,d,h,t,p,f=(o=(0,b.defaults)(o,{useSticky:E,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r","\n"],tracer:function(e,t){return t()}})).tracer,g=(f("initCharCodeToOptimizedIndexMap",function(){if((0,b.isEmpty)(P)){P=new Array(65536);for(var e=0;e<65536;e++)P[e]=255<e?255+~~(e/255):e}}),f("Reject Lexer.NA",function(){r=(0,b.reject)(e,function(e){return e[C]===v.Lexer.NA})}),!1),m=(f("Transform Patterns",function(){n=(g=!1,b.map)(r,function(e){var t,e=e[C];if((0,b.isRegExp)(e))return 1===(t=e.source).length&&"^"!==t&&"$"!==t&&"."!==t?t:2!==t.length||"\\"!==t[0]||(0,b.contains)(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],t[1])?(o.useSticky?R:x)(e):t[1];if((0,b.isFunction)(e))return g=!0,{exec:e};if((0,b.has)(e,"exec"))return g=!0,e;if("string"==typeof e)return 1===e.length?e:(t=e.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),e=new RegExp(t),(o.useSticky?R:x)(e));throw Error("non exhaustive match")})}),f("misc mapping",function(){i=(0,b.map)(r,function(e){return e.tokenTypeIdx}),s=(0,b.map)(r,function(e){e=e.GROUP;if(e!==v.Lexer.SKIPPED){if((0,b.isString)(e))return e;if((0,b.isUndefined)(e))return!1;throw Error("non exhaustive match")}}),a=(0,b.map)(r,function(e){e=e.LONGER_ALT;if(e)return(0,b.indexOf)(r,e)}),l=(0,b.map)(r,function(e){return e.PUSH_MODE}),c=(0,b.map)(r,function(e){return(0,b.has)(e,"POP_MODE")})}),f("Line Terminator Handling",function(){var t=M(o.lineTerminatorCharacters);u=(0,b.map)(r,function(e){return!1}),"onlyOffset"!==o.positionTracking&&(u=(0,b.map)(r,function(e){return(0,b.has)(e,"LINE_BREAKS")?e.LINE_BREAKS:!1===O(e,t)?(0,w.canMatchCharCode)(t,e.PATTERN):void 0}))}),f("Misc Mapping #2",function(){d=(0,b.map)(r,A),h=(0,b.map)(n,N),t=(0,b.reduce)(r,function(e,t){t=t.GROUP;return(0,b.isString)(t)&&t!==v.Lexer.SKIPPED&&(e[t]=[]),e},{}),p=(0,b.map)(n,function(e,t){return{pattern:n[t],longerAlt:a[t],canLineTerminator:u[t],isCustom:d[t],short:h[t],group:s[t],push:l[t],pop:c[t],tokenTypeIdx:i[t],tokenType:r[t]}})}),!0),y=[];o.safeMode||f("First Char Optimization",function(){y=(0,b.reduce)(r,function(t,e,r){var n,i;return"string"==typeof e.PATTERN?(i=D(e.PATTERN.charCodeAt(0)),k(t,i,p[r])):(0,b.isArray)(e.START_CHARS_HINT)?(0,b.forEach)(e.START_CHARS_HINT,function(e){e=D("string"==typeof e?e.charCodeAt(0):e);n!==e&&k(t,n=e,p[r])}):(0,b.isRegExp)(e.PATTERN)?e.PATTERN.unicode?(m=!1,o.ensureOptimizations&&(0,b.PRINT_ERROR)(w.failedOptimizationPrefixMsg+"\tUnable to analyze < "+e.PATTERN.toString()+" > pattern.\n\tThe regexp unicode flag is not currently supported by the regexp-to-ast library.\n\tThis will disable the lexer's first char optimizations.\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE")):(i=(0,w.getOptimizedStartCodesIndices)(e.PATTERN,o.ensureOptimizations),(0,b.isEmpty)(i)&&(m=!1),(0,b.forEach)(i,function(e){k(t,e,p[r])})):(o.ensureOptimizations&&(0,b.PRINT_ERROR)(w.failedOptimizationPrefixMsg+"\tTokenType: <"+e.name+"> is using a custom token pattern without providing <start_chars_hint> parameter.\n\tThis will disable the lexer's first char optimizations.\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE"),m=!1),t},[])});return f("ArrayPacking",function(){y=(0,b.packArray)(y)}),{emptyGroups:t,patternIdxToConfig:p,charCodeToPatternIdxToConfig:y,hasCustom:g,canBeOptimized:m}},buildLineBreakIssueMessage:()=>I,charCodeToOptimizedIndex:()=>D,cloneEmptyGroups:()=>function(r){var n={},e=(0,b.keys)(r);return(0,b.forEach)(e,function(e){var t=r[e];if(!(0,b.isArray)(t))throw Error("non exhaustive match");n[e]=[]}),n},disableSticky:()=>function(){E=!1},enableSticky:()=>function(){E=!0},findDuplicatePatterns:()=>y,findEmptyMatchRegExps:()=>p,findEndOfInputAnchor:()=>h,findInvalidGroupType:()=>T,findInvalidPatterns:()=>u,findMissingPatterns:()=>c,findModesThatDoNotExist:()=>S,findStartOfInputAnchor:()=>g,findUnreachablePatterns:()=>_,findUnsupportedFlags:()=>m,isCustomPattern:()=>A,isShortPattern:()=>N,minOptimizationVal:()=>r,performRuntimeChecks:()=>function(e,t,r){var n=[];(0,b.has)(e,a)||n.push({message:"A MultiMode Lexer cannot be initialized without a <"+a+"> property in its definition\n",type:v.LexerDefinitionErrorType.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE});(0,b.has)(e,l)||n.push({message:"A MultiMode Lexer cannot be initialized without a <"+l+"> property in its definition\n",type:v.LexerDefinitionErrorType.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY});(0,b.has)(e,l)&&(0,b.has)(e,a)&&!(0,b.has)(e.modes,e.defaultMode)&&n.push({message:"A MultiMode Lexer cannot be initialized with a "+a+": <"+e.defaultMode+">which does not exist\n",type:v.LexerDefinitionErrorType.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST});(0,b.has)(e,l)&&(0,b.forEach)(e.modes,function(e,r){(0,b.forEach)(e,function(e,t){(0,b.isUndefined)(e)&&n.push({message:"A Lexer cannot be initialized using an undefined Token Type. Mode:<"+r+"> at index: <"+t+">\n",type:v.LexerDefinitionErrorType.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})})});return n},performWarningRuntimeChecks:()=>function(e,t,r){var n=[],i=!1,e=(0,b.compact)((0,b.flatten)((0,b.mapValues)(e.modes,function(e){return e}))),e=(0,b.reject)(e,function(e){return e[C]===v.Lexer.NA}),o=M(r);t&&(0,b.forEach)(e,function(e){var t=O(e,o);!1!==t?(t={message:I(e,t),type:t.issue,tokenType:e},n.push(t)):(0,b.has)(e,"LINE_BREAKS")?!0===e.LINE_BREAKS&&(i=!0):(0,w.canMatchCharCode)(o,e.PATTERN)&&(i=!0)});t&&!i&&n.push({message:"Warning: No LINE_BREAKS Found.\n\tThis Lexer has been defined to track line and column information,\n\tBut none of the Token Types can be identified as matching a line terminator.\n\tSee https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#LINE_BREAKS \n\tfor details.",type:v.LexerDefinitionErrorType.NO_LINE_BREAKS_FLAGS});return n},validatePatterns:()=>function(e,t){var r=[],e=c(e),e=(r=r.concat(e.errors),u(e.valid)),n=e.valid;return r=(r=(r=(r=(r=r.concat(e.errors)).concat(function(e){var t=[],e=(0,b.filter)(e,function(e){return(0,b.isRegExp)(e[C])});return t=(t=(t=(t=(t=t.concat(h(e))).concat(g(e))).concat(m(e))).concat(y(e))).concat(p(e))}(n))).concat(T(n))).concat(S(n,t))).concat(_(n))}});var n,i=t(24),v=t(22),b=t(17),w=t(25),o=t(26),s=(n=function(e,t){return(n=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])}))(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),C="PATTERN",a="defaultMode",l="modes",E="boolean"==typeof new RegExp("(?:)").sticky;function c(e){var t=(0,b.filter)(e,function(e){return!(0,b.has)(e,C)});return{errors:(0,b.map)(t,function(e){return{message:"Token Type: ->"+e.name+"<- missing static 'PATTERN' property",type:v.LexerDefinitionErrorType.MISSING_PATTERN,tokenTypes:[e]}}),valid:(0,b.difference)(e,t)}}function u(e){var t=(0,b.filter)(e,function(e){e=e[C];return!((0,b.isRegExp)(e)||(0,b.isFunction)(e)||(0,b.has)(e,"exec")||(0,b.isString)(e))});return{errors:(0,b.map)(t,function(e){return{message:"Token Type: ->"+e.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:v.LexerDefinitionErrorType.INVALID_PATTERN,tokenTypes:[e]}}),valid:(0,b.difference)(e,t)}}var d=/[^\\][\$]/;function h(e){t=i.BaseRegExpVisitor,s(r,t),r.prototype.visitEndAnchor=function(e){this.found=!0};var t,n=r;function r(){var e=null!==t&&t.apply(this,arguments)||this;return e.found=!1,e}e=(0,b.filter)(e,function(t){t=t[C];try{var e=(0,o.getRegExpAst)(t),r=new n;return r.visit(e),r.found}catch(e){return d.test(t.source)}});return(0,b.map)(e,function(e){return{message:"Unexpected RegExp Anchor Error:\n\tToken Type: ->"+e.name+"<- static 'PATTERN' cannot contain end of input anchor '$'\n\tSee sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS\tfor details.",type:v.LexerDefinitionErrorType.EOI_ANCHOR_FOUND,tokenTypes:[e]}})}function p(e){e=(0,b.filter)(e,function(e){return e[C].test("")});return(0,b.map)(e,function(e){return{message:"Token Type: ->"+e.name+"<- static 'PATTERN' must not match an empty string",type:v.LexerDefinitionErrorType.EMPTY_MATCH_PATTERN,tokenTypes:[e]}})}var f=/[^\\[][\^]|^\^/;function g(e){t=i.BaseRegExpVisitor,s(r,t),r.prototype.visitStartAnchor=function(e){this.found=!0};var t,n=r;function r(){var e=null!==t&&t.apply(this,arguments)||this;return e.found=!1,e}e=(0,b.filter)(e,function(t){t=t[C];try{var e=(0,o.getRegExpAst)(t),r=new n;return r.visit(e),r.found}catch(e){return f.test(t.source)}});return(0,b.map)(e,function(e){return{message:"Unexpected RegExp Anchor Error:\n\tToken Type: ->"+e.name+"<- static 'PATTERN' cannot contain start of input anchor '^'\n\tSee https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS\tfor details.",type:v.LexerDefinitionErrorType.SOI_ANCHOR_FOUND,tokenTypes:[e]}})}function m(e){e=(0,b.filter)(e,function(e){e=e[C];return e instanceof RegExp&&(e.multiline||e.global)});return(0,b.map)(e,function(e){return{message:"Token Type: ->"+e.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:v.LexerDefinitionErrorType.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[e]}})}function y(e){var n=[],t=(0,b.map)(e,function(r){return(0,b.reduce)(e,function(e,t){return r.PATTERN.source!==t.PATTERN.source||(0,b.contains)(n,t)||t.PATTERN===v.Lexer.NA||(n.push(t),e.push(t)),e},[])}),t=(0,b.compact)(t),t=(0,b.filter)(t,function(e){return 1<e.length});return(0,b.map)(t,function(e){var t=(0,b.map)(e,function(e){return e.name});return{message:"The same RegExp pattern ->"+(0,b.first)(e).PATTERN+"<-has been used in all of the following Token Types: "+t.join(", ")+" <-",type:v.LexerDefinitionErrorType.DUPLICATE_PATTERNS_FOUND,tokenTypes:e}})}function T(e){e=(0,b.filter)(e,function(e){return!!(0,b.has)(e,"GROUP")&&(e=e.GROUP)!==v.Lexer.SKIPPED&&e!==v.Lexer.NA&&!(0,b.isString)(e)});return(0,b.map)(e,function(e){return{message:"Token Type: ->"+e.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:v.LexerDefinitionErrorType.INVALID_GROUP_TYPE_FOUND,tokenTypes:[e]}})}function S(e,t){e=(0,b.filter)(e,function(e){return void 0!==e.PUSH_MODE&&!(0,b.contains)(t,e.PUSH_MODE)});return(0,b.map)(e,function(e){return{message:"Token Type: ->"+e.name+"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->"+e.PUSH_MODE+"<-which does not exist",type:v.LexerDefinitionErrorType.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[e]}})}function _(e){var o=[],t=(0,b.reduce)(e,function(e,t,r){var n,i=t.PATTERN;return i!==v.Lexer.NA&&((0,b.isString)(i)?e.push({str:i,idx:r,tokenType:t}):(0,b.isRegExp)(i)&&(n=i,void 0===(0,b.find)([".","\\","[","]","|","^","$","(",")","?","*","+","{"],function(e){return-1!==n.source.indexOf(e)}))&&e.push({str:i.source,idx:r,tokenType:t})),e},[]);return(0,b.forEach)(e,function(n,i){(0,b.forEach)(t,function(e){var t=e.str,r=e.idx,e=e.tokenType;i<r&&function(e,t){{var r;if((0,b.isRegExp)(t))return null!==(r=t.exec(e))&&0===r.index;if((0,b.isFunction)(t))return t(e,0,[],{});if((0,b.has)(t,"exec"))return t.exec(e,0,[],{});if("string"==typeof t)return t===e;throw Error("non exhaustive match")}}(t,n.PATTERN)&&(r="Token: ->"+e.name+"<- can never be matched.\nBecause it appears AFTER the Token Type ->"+n.name+"<-in the lexer's definition.\nSee https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNREACHABLE",o.push({message:r,type:v.LexerDefinitionErrorType.UNREACHABLE_PATTERN,tokenTypes:[n,e]}))})}),o}function x(e){var t=e.ignoreCase?"i":"";return new RegExp("^(?:"+e.source+")",t)}function R(e){var t=e.ignoreCase?"iy":"y";return new RegExp(""+e.source,t)}function A(e){e=e.PATTERN;if((0,b.isRegExp)(e))return!1;if((0,b.isFunction)(e))return!0;if((0,b.has)(e,"exec"))return!0;if((0,b.isString)(e))return!1;throw Error("non exhaustive match")}function N(e){return!(!(0,b.isString)(e)||1!==e.length)&&e.charCodeAt(0)}var F={test:function(e){for(var t=e.length,r=this.lastIndex;r<t;r++){var n=e.charCodeAt(r);if(10===n)return this.lastIndex=r+1,!0;if(13===n)return 10===e.charCodeAt(r+1)?this.lastIndex=r+2:this.lastIndex=r+1,!0}return!1},lastIndex:0};function O(e,t){if((0,b.has)(e,"LINE_BREAKS"))return!1;if((0,b.isRegExp)(e.PATTERN)){try{(0,w.canMatchCharCode)(t,e.PATTERN)}catch(e){return{issue:v.LexerDefinitionErrorType.IDENTIFY_TERMINATOR,errMsg:e.message}}return!1}if((0,b.isString)(e.PATTERN))return!1;if(A(e))return{issue:v.LexerDefinitionErrorType.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}function I(e,t){if(t.issue===v.LexerDefinitionErrorType.IDENTIFY_TERMINATOR)return"Warning: unable to identify line terminator usage in pattern.\n\tThe problem is in the <"+e.name+"> Token Type\n\t Root cause: "+t.errMsg+".\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR";if(t.issue===v.LexerDefinitionErrorType.CUSTOM_LINE_BREAK)return"Warning: A Custom Token Pattern should specify the <line_breaks> option.\n\tThe problem is in the <"+e.name+"> Token Type\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK";throw Error("non exhaustive match")}function M(e){return(0,b.map)(e,function(e){return(0,b.isString)(e)&&0<e.length?e.charCodeAt(0):e})}function k(e,t,r){void 0===e[t]?e[t]=[r]:e[t].push(r)}var r=256;function D(e){return e<r?e:P[e]}var P=[]},function(e,t){var r;void 0!==(t="function"==typeof(r=function(){function e(){}e.prototype.saveState=function(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}},e.prototype.restoreState=function(e){this.idx=e.idx;this.input=e.input;this.groupIdx=e.groupIdx},e.prototype.pattern=function(e){this.idx=0;this.input=e;this.groupIdx=0;this.consumeChar("/");var t=this.disjunction();this.consumeChar("/");var r={type:"Flags",global:false,ignoreCase:false,multiLine:false,unicode:false,sticky:false};while(this.isRegExpFlag())switch(this.popChar()){case"g":i(r,"global");break;case"i":i(r,"ignoreCase");break;case"m":i(r,"multiLine");break;case"u":i(r,"unicode");break;case"y":i(r,"sticky");break}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:r,value:t}},e.prototype.disjunction=function(){var e=[];e.push(this.alternative());while(this.peekChar()==="|"){this.consumeChar("|");e.push(this.alternative())}return{type:"Disjunction",value:e}},e.prototype.alternative=function(){var e=[];while(this.isTerm())e.push(this.term());return{type:"Alternative",value:e}},e.prototype.term=function(){if(this.isAssertion())return this.assertion();else return this.atom()},e.prototype.assertion=function(){switch(this.popChar()){case"^":return{type:"StartAnchor"};case"$":return{type:"EndAnchor"};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary"};case"B":return{type:"NonWordBoundary"}}throw Error("Invalid Assertion Escape");case"(":this.consumeChar("?");var e;switch(this.popChar()){case"=":e="Lookahead";break;case"!":e="NegativeLookahead";break}l(e);var t=this.disjunction();this.consumeChar(")");return{type:e,value:t}}c()},e.prototype.quantifier=function(e){var t;switch(this.popChar()){case"*":t={atLeast:0,atMost:Infinity};break;case"+":t={atLeast:1,atMost:Infinity};break;case"?":t={atLeast:0,atMost:1};break;case"{":var r=this.integerIncludingZero();switch(this.popChar()){case"}":t={atLeast:r,atMost:r};break;case",":var n;if(this.isDigit()){n=this.integerIncludingZero();t={atLeast:r,atMost:n}}else t={atLeast:r,atMost:Infinity};this.consumeChar("}");break}if(e===true&&t===undefined)return undefined;l(t);break}if(e===true&&t===undefined)return undefined;l(t);if(this.peekChar(0)==="?"){this.consumeChar("?");t.greedy=false}else t.greedy=true;t.type="Quantifier";return t},e.prototype.atom=function(){var e;switch(this.peekChar()){case".":e=this.dotAll();break;case"\\":e=this.atomEscape();break;case"[":e=this.characterClass();break;case"(":e=this.group();break}if(e===undefined&&this.isPatternCharacter())e=this.patternCharacter();l(e);if(this.isQuantifier())e.quantifier=this.quantifier();return e},e.prototype.dotAll=function(){this.consumeChar(".");return{type:"Set",complement:true,value:[s("\n"),s("\r"),s("\u2028"),s("\u2029")]}},e.prototype.atomEscape=function(){this.consumeChar("\\");switch(this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.decimalEscapeAtom=function(){var e=this.positiveInteger();return{type:"GroupBackReference",value:e}},e.prototype.characterClassEscape=function(){var e;var t=false;switch(this.popChar()){case"d":e=u;break;case"D":e=u;t=true;break;case"s":e=h;break;case"S":e=h;t=true;break;case"w":e=d;break;case"W":e=d;t=true;break}l(e);return{type:"Set",value:e,complement:t}},e.prototype.controlEscapeAtom=function(){var e;switch(this.popChar()){case"f":e=s("\f");break;case"n":e=s("\n");break;case"r":e=s("\r");break;case"t":e=s("\t");break;case"v":e=s("\v");break}l(e);return{type:"Character",value:e}},e.prototype.controlLetterEscapeAtom=function(){this.consumeChar("c");var e=this.popChar();if(/[a-zA-Z]/.test(e)===false)throw Error("Invalid ");var t=e.toUpperCase().charCodeAt(0)-64;return{type:"Character",value:t}},e.prototype.nulCharacterAtom=function(){this.consumeChar("0");return{type:"Character",value:s("\0")}},e.prototype.hexEscapeSequenceAtom=function(){this.consumeChar("x");return this.parseHexDigits(2)},e.prototype.regExpUnicodeEscapeSequenceAtom=function(){this.consumeChar("u");return this.parseHexDigits(4)},e.prototype.identityEscapeAtom=function(){var e=this.popChar();return{type:"Character",value:s(e)}},e.prototype.classPatternCharacterAtom=function(){switch(this.peekChar()){case"\n":case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:var e=this.popChar();return{type:"Character",value:s(e)}}},e.prototype.characterClass=function(){var e=[];var t=false;this.consumeChar("[");if(this.peekChar(0)==="^"){this.consumeChar("^");t=true}while(this.isClassAtom()){var r=this.classAtom();var n=r.type==="Character";if(n&&this.isRangeDash()){this.consumeChar("-");var i=this.classAtom();var o=i.type==="Character";if(o){if(i.value<r.value)throw Error("Range out of order in character class");e.push({from:r.value,to:i.value})}else{a(r.value,e);e.push(s("-"));a(i.value,e)}}else a(r.value,e)}this.consumeChar("]");return{type:"Set",complement:t,value:e}},e.prototype.classAtom=function(){switch(this.peekChar()){case"]":case"\n":case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}},e.prototype.classEscape=function(){this.consumeChar("\\");switch(this.peekChar()){case"b":this.consumeChar("b");return{type:"Character",value:s("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.group=function(){var e=true;this.consumeChar("(");switch(this.peekChar(0)){case"?":this.consumeChar("?");this.consumeChar(":");e=false;break;default:this.groupIdx++;break}var t=this.disjunction();this.consumeChar(")");var r={type:"Group",capturing:e,value:t};if(e)r.idx=this.groupIdx;return r},e.prototype.positiveInteger=function(){var e=this.popChar();if(r.test(e)===false)throw Error("Expecting a positive integer");while(t.test(this.peekChar(0)))e+=this.popChar();return parseInt(e,10)},e.prototype.integerIncludingZero=function(){var e=this.popChar();if(t.test(e)===false)throw Error("Expecting an integer");while(t.test(this.peekChar(0)))e+=this.popChar();return parseInt(e,10)},e.prototype.patternCharacter=function(){var e=this.popChar();switch(e){case"\n":case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:s(e)}}},e.prototype.isRegExpFlag=function(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return true;default:return false}},e.prototype.isRangeDash=function(){return this.peekChar()==="-"&&this.isClassAtom(1)},e.prototype.isDigit=function(){return t.test(this.peekChar(0))},e.prototype.isClassAtom=function(e){if(e===undefined)e=0;switch(this.peekChar(e)){case"]":case"\n":case"\r":case"\u2028":case"\u2029":return false;default:return true}},e.prototype.isTerm=function(){return this.isAtom()||this.isAssertion()},e.prototype.isAtom=function(){if(this.isPatternCharacter())return true;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return true;default:return false}},e.prototype.isAssertion=function(){switch(this.peekChar(0)){case"^":case"$":return true;case"\\":switch(this.peekChar(1)){case"b":case"B":return true;default:return false}case"(":return this.peekChar(1)==="?"&&(this.peekChar(2)==="="||this.peekChar(2)==="!");default:return false}},e.prototype.isQuantifier=function(){var e=this.saveState();try{return this.quantifier(true)!==undefined}catch(e){return false}finally{this.restoreState(e)}},e.prototype.isPatternCharacter=function(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case"\n":case"\r":case"\u2028":case"\u2029":return false;default:return true}},e.prototype.parseHexDigits=function(e){var t="";for(var r=0;r<e;r++){var n=this.popChar();if(o.test(n)===false)throw Error("Expecting a HexDecimal digits");t+=n}var i=parseInt(t,16);return{type:"Character",value:i}},e.prototype.peekChar=function(e){if(e===undefined)e=0;return this.input[this.idx+e]},e.prototype.popChar=function(){var e=this.peekChar(0);this.consumeChar();return e},e.prototype.consumeChar=function(e){if(e!==undefined&&this.input[this.idx]!==e)throw Error("Expected: '"+e+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++};var o=/[0-9a-fA-F]/,t=/[0-9]/,r=/[1-9]/,n;function s(e){return e.charCodeAt(0)}function a(e,t){if(e.length!==undefined)e.forEach(function(e){t.push(e)});else t.push(e)}function i(e,t){if(e[t]===true)throw"duplicate flag "+t;e[t]=true}function l(e){if(e===undefined)throw Error("Internal Error - Should never get here!")}function c(){throw Error("Internal Error - Should never get here!")}for(var u=[],n=s("0");n<=s("9");n++)u.push(n);var d=[s("_")].concat(u);for(n=s("a");n<=s("z");n++)d.push(n);for(n=s("A");n<=s("Z");n++)d.push(n);var h=[s(" "),s("\f"),s("\n"),s("\r"),s("\t"),s("\v"),s("\t"),s(" "),s(" "),s(" "),s(" "),s(" "),s(" "),s(" "),s(" "),s(" "),s(" "),s(" "),s(" "),s(" "),s("\u2028"),s("\u2029"),s(" "),s(" "),s("　"),s("\ufeff")];function p(){}return p.prototype.visitChildren=function(e){for(var t in e){var r=e[t];if(e.hasOwnProperty(t))if(r.type!==undefined)this.visit(r);else if(Array.isArray(r))r.forEach(function(e){this.visit(e)},this)}},p.prototype.visit=function(e){switch(e.type){case"Pattern":this.visitPattern(e);break;case"Flags":this.visitFlags(e);break;case"Disjunction":this.visitDisjunction(e);break;case"Alternative":this.visitAlternative(e);break;case"StartAnchor":this.visitStartAnchor(e);break;case"EndAnchor":this.visitEndAnchor(e);break;case"WordBoundary":this.visitWordBoundary(e);break;case"NonWordBoundary":this.visitNonWordBoundary(e);break;case"Lookahead":this.visitLookahead(e);break;case"NegativeLookahead":this.visitNegativeLookahead(e);break;case"Character":this.visitCharacter(e);break;case"Set":this.visitSet(e);break;case"Group":this.visitGroup(e);break;case"GroupBackReference":this.visitGroupBackReference(e);break;case"Quantifier":this.visitQuantifier(e);break}this.visitChildren(e)},p.prototype.visitPattern=function(e){},p.prototype.visitFlags=function(e){},p.prototype.visitDisjunction=function(e){},p.prototype.visitAlternative=function(e){},p.prototype.visitStartAnchor=function(e){},p.prototype.visitEndAnchor=function(e){},p.prototype.visitWordBoundary=function(e){},p.prototype.visitNonWordBoundary=function(e){},p.prototype.visitLookahead=function(e){},p.prototype.visitNegativeLookahead=function(e){},p.prototype.visitCharacter=function(e){},p.prototype.visitSet=function(e){},p.prototype.visitGroup=function(e){},p.prototype.visitGroupBackReference=function(e){},p.prototype.visitQuantifier=function(e){},{RegExpParser:e,BaseRegExpVisitor:p,VERSION:"0.4.0"}})?r.apply(t,[]):r)&&(e.exports=t)},(e,t,r)=>{"use strict";r.r(t),r.d(t,{canMatchCharCode:()=>function(t,e){{var r,n;return e instanceof RegExp?(r=(0,s.getRegExpAst)(e),(n=new g(t)).visit(r),n.found):void 0!==(0,o.find)(e,function(e){return(0,o.contains)(t,e.charCodeAt(0))})}},failedOptimizationPrefixMsg:()=>a,firstCharOptimizedIndices:()=>u,getOptimizedStartCodesIndices:()=>function(t,r){void 0===r&&(r=!1);try{var n=(0,s.getRegExpAst)(t);return u(n.value,{},n.flags.ignoreCase)}catch(e){e.message===c?r&&(0,o.PRINT_WARNING)(a+"\tUnable to optimize: < "+t.toString()+" >\n\tComplement Sets cannot be automatically optimized.\n\tThis will disable the lexer's first char optimizations.\n\tSee: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details."):(n=r?"\n\tThis will disable the lexer's first char optimizations.\n\tSee: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details.":"",(0,o.PRINT_ERROR)(a+"\n\tFailed parsing: < "+t.toString()+" >\n\tUsing the regexp-to-ast library version: "+i.VERSION+"\n\tPlease open an issue at: https://github.com/bd82/regexp-to-ast/issues"+n))}return[]}});var n,i=r(24),o=r(17),s=r(26),l=r(23),t=(n=function(e,t){return(n=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])}))(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),c="Complement Sets are not supported for first char optimization",a='Unable to use "first char" lexer optimizations:\n';function u(e,s,a){switch(e.type){case"Disjunction":for(var t=0;t<e.value.length;t++)u(e.value[t],s,a);break;case"Alternative":for(var r=e.value,t=0;t<r.length;t++){var n=r[t];switch(n.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}var i=n;switch(i.type){case"Character":d(i.value,s,a);break;case"Set":if(!0===i.complement)throw Error(c);(0,o.forEach)(i.value,function(e){if("number"==typeof e)d(e,s,a);else{var t=e;if(!0===a)for(var r=t.from;r<=t.to;r++)d(r,s,a);else{for(r=t.from;r<=t.to&&r<l.minOptimizationVal;r++)d(r,s,a);if(t.to>=l.minOptimizationVal)for(var e=t.from>=l.minOptimizationVal?t.from:l.minOptimizationVal,n=t.to,e=(0,l.charCodeToOptimizedIndex)(e),i=(0,l.charCodeToOptimizedIndex)(n),o=e;o<=i;o++)s[o]=o}}});break;case"Group":u(i.value,s,a);break;default:throw Error("Non Exhaustive Match")}n=void 0!==i.quantifier&&0===i.quantifier.atLeast;if("Group"===i.type&&!1===p(i)||"Group"!==i.type&&!1==n)break}break;default:throw Error("non exhaustive match!")}return(0,o.values)(s)}function d(e,t,r){var n,i=(0,l.charCodeToOptimizedIndex)(e);t[i]=i,!0===r&&(i=e,r=t,(e=(i=String.fromCharCode(i)).toUpperCase())!==i?(n=(0,l.charCodeToOptimizedIndex)(e.charCodeAt(0)),r[n]=n):(e=i.toLowerCase())!==i&&(n=(0,l.charCodeToOptimizedIndex)(e.charCodeAt(0)),r[n]=n))}function h(e,r){return(0,o.find)(e.value,function(e){var t;return"number"==typeof e?(0,o.contains)(r,e):(t=e,void 0!==(0,o.find)(r,function(e){return t.from<=e&&e<=t.to}))})}function p(e){return!(!e.quantifier||0!==e.quantifier.atLeast)||!!e.value&&((0,o.isArray)(e.value)?(0,o.every)(e.value,p):p(e.value))}f=i.BaseRegExpVisitor,t(m,f),m.prototype.visitChildren=function(e){if(!0!==this.found){switch(e.type){case"Lookahead":return void this.visitLookahead(e);case"NegativeLookahead":return void this.visitNegativeLookahead(e)}f.prototype.visitChildren.call(this,e)}},m.prototype.visitCharacter=function(e){(0,o.contains)(this.targetCharCodes,e.value)&&(this.found=!0)},m.prototype.visitSet=function(e){e.complement?void 0===h(e,this.targetCharCodes)&&(this.found=!0):void 0!==h(e,this.targetCharCodes)&&(this.found=!0)};var f,g=m;function m(e){var t=f.call(this)||this;return t.targetCharCodes=e,t.found=!1,t}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{clearRegExpParserCache:()=>function(){n={}},getRegExpAst:()=>function(e){e=e.toString();{var t;return n.hasOwnProperty(e)?n[e]:(t=i.pattern(e),n[e]=t)}}});var t=r(24),n={},i=new t.RegExpParser},(e,t,r)=>{"use strict";r.r(t),r.d(t,{assignCategoriesMapProp:()=>c,assignCategoriesTokensProp:()=>l,assignTokenDefaultProps:()=>a,augmentTokenTypes:()=>function(e){e=s(e);a(e),c(e),l(e),(0,o.forEach)(e,function(e){e.isParent=0<e.categoryMatches.length})},expandCategories:()=>s,hasCategoriesProperty:()=>h,hasExtendingTokensTypesMapProperty:()=>f,hasExtendingTokensTypesProperty:()=>p,hasShortKeyProperty:()=>d,isTokenType:()=>function(e){return(0,o.has)(e,"tokenTypeIdx")},singleAssignCategoriesToksMap:()=>u,tokenIdxToClass:()=>i,tokenShortNameIdx:()=>n,tokenStructuredMatcher:()=>function(e,t){e=e.tokenTypeIdx;return e===t.tokenTypeIdx||!0===t.isParent&&!0===t.categoryMatchesMap[e]},tokenStructuredMatcherNoCategories:()=>function(e,t){return e.tokenTypeIdx===t.tokenTypeIdx}});var o=r(17);var n=1,i={};function s(e){for(var t=(0,o.cloneArr)(e),r=e,n=!0;n;){var r=(0,o.compact)((0,o.flatten)((0,o.map)(r,function(e){return e.CATEGORIES}))),i=(0,o.difference)(r,t),t=t.concat(i);(0,o.isEmpty)(i)?n=!1:r=i}return t}function a(e){(0,o.forEach)(e,function(e){d(e)||((i[n]=e).tokenTypeIdx=n++),h(e)&&!(0,o.isArray)(e.CATEGORIES)&&(e.CATEGORIES=[e.CATEGORIES]),h(e)||(e.CATEGORIES=[]),p(e)||(e.categoryMatches=[]),f(e)||(e.categoryMatchesMap={})})}function l(e){(0,o.forEach)(e,function(r){r.categoryMatches=[],(0,o.forEach)(r.categoryMatchesMap,function(e,t){r.categoryMatches.push(i[t].tokenTypeIdx)})})}function c(e){(0,o.forEach)(e,function(e){u([],e)})}function u(r,n){(0,o.forEach)(r,function(e){n.categoryMatchesMap[e.tokenTypeIdx]=!0}),(0,o.forEach)(n.CATEGORIES,function(e){var t=r.concat(n);(0,o.contains)(t,e)||u(t,e)})}function d(e){return(0,o.has)(e,"tokenTypeIdx")}function h(e){return(0,o.has)(e,"CATEGORIES")}function p(e){return(0,o.has)(e,"categoryMatches")}function f(e){return(0,o.has)(e,"categoryMatchesMap")}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{defaultLexerErrorProvider:()=>n});var n={buildUnableToPopLexerModeMessage:function(e){return"Unable to pop Lexer Mode after encountering Token ->"+e.image+"<- The Mode Stack is empty"},buildUnexpectedCharactersMessage:function(e,t,r,n,i){return"unexpected character: ->"+e.charAt(t)+"<- at offset: "+t+", skipped "+r+" characters."}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{first:()=>c,firstForBranching:()=>o,firstForSequence:()=>i,firstForTerminal:()=>s});var a=r(17),n=r(20),l=r(30);function c(e){if(e instanceof n.NonTerminal)return c(e.referencedRule);if(e instanceof n.Terminal)return s(e);if((0,l.isSequenceProd)(e))return i(e);if((0,l.isBranchingProd)(e))return o(e);throw Error("non exhaustive match")}function i(e){for(var t,r=[],n=e.definition,i=0,o=n.length>i,s=!0;o&&s;)t=n[i],s=(0,l.isOptionalProd)(t),r=r.concat(c(t)),o=n.length>(i+=1);return(0,a.uniq)(r)}function o(e){e=(0,a.map)(e.definition,c);return(0,a.uniq)((0,a.flatten)(e))}function s(e){return[e.terminalType]}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{DslMethodsCollectorVisitor:()=>a,collectMethods:()=>function(e){c.reset(),e.accept(c);e=c.dslMethods;return c.reset(),e},getProductionDslName:()=>function(e){{if(e instanceof o.NonTerminal)return"SUBRULE";if(e instanceof o.Option)return"OPTION";if(e instanceof o.Alternation)return"OR";if(e instanceof o.RepetitionMandatory)return"AT_LEAST_ONE";if(e instanceof o.RepetitionMandatoryWithSeparator)return"AT_LEAST_ONE_SEP";if(e instanceof o.RepetitionWithSeparator)return"MANY_SEP";if(e instanceof o.Repetition)return"MANY";if(e instanceof o.Terminal)return"CONSUME";throw Error("non exhaustive match")}},isBranchingProd:()=>function(e){return e instanceof o.Alternation},isOptionalProd:()=>function t(e,r){void 0===r&&(r=[]);var n=e instanceof o.Option||e instanceof o.Repetition||e instanceof o.RepetitionWithSeparator;if(n)return!0;return e instanceof o.Alternation?(0,i.some)(e.definition,function(e){return t(e,r)}):!(e instanceof o.NonTerminal&&(0,i.contains)(r,e))&&e instanceof o.AbstractProduction&&(e instanceof o.NonTerminal&&r.push(e),(0,i.every)(e.definition,function(e){return t(e,r)}))},isSequenceProd:()=>function(e){return e instanceof o.Flat||e instanceof o.Option||e instanceof o.Repetition||e instanceof o.RepetitionMandatory||e instanceof o.RepetitionMandatoryWithSeparator||e instanceof o.RepetitionWithSeparator||e instanceof o.Terminal||e instanceof o.Rule}});var n,i=r(17),o=r(20),t=r(31),r=(n=function(e,t){return(n=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])}))(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});s=t.GAstVisitor,r(l,s),l.prototype.reset=function(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}},l.prototype.visitTerminal=function(e){var t=e.terminalType.name+this.separator+"Terminal";(0,i.has)(this.dslMethods,t)||(this.dslMethods[t]=[]),this.dslMethods[t].push(e)},l.prototype.visitNonTerminal=function(e){var t=e.nonTerminalName+this.separator+"Terminal";(0,i.has)(this.dslMethods,t)||(this.dslMethods[t]=[]),this.dslMethods[t].push(e)},l.prototype.visitOption=function(e){this.dslMethods.option.push(e)},l.prototype.visitRepetitionWithSeparator=function(e){this.dslMethods.repetitionWithSeparator.push(e)},l.prototype.visitRepetitionMandatory=function(e){this.dslMethods.repetitionMandatory.push(e)},l.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.dslMethods.repetitionMandatoryWithSeparator.push(e)},l.prototype.visitRepetition=function(e){this.dslMethods.repetition.push(e)},l.prototype.visitAlternation=function(e){this.dslMethods.alternation.push(e)};var s,a=l;function l(){var e=null!==s&&s.apply(this,arguments)||this;return e.separator="-",e.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]},e}var c=new a},(e,t,r)=>{"use strict";r.r(t),r.d(t,{GAstVisitor:()=>i});var n=r(20),i=(o.prototype.visit=function(e){var t=e;switch(t.constructor){case n.NonTerminal:return this.visitNonTerminal(t);case n.Flat:return this.visitFlat(t);case n.Option:return this.visitOption(t);case n.RepetitionMandatory:return this.visitRepetitionMandatory(t);case n.RepetitionMandatoryWithSeparator:return this.visitRepetitionMandatoryWithSeparator(t);case n.RepetitionWithSeparator:return this.visitRepetitionWithSeparator(t);case n.Repetition:return this.visitRepetition(t);case n.Alternation:return this.visitAlternation(t);case n.Terminal:return this.visitTerminal(t);case n.Rule:return this.visitRule(t);default:throw Error("non exhaustive match")}},o.prototype.visitNonTerminal=function(e){},o.prototype.visitFlat=function(e){},o.prototype.visitOption=function(e){},o.prototype.visitRepetition=function(e){},o.prototype.visitRepetitionMandatory=function(e){},o.prototype.visitRepetitionMandatoryWithSeparator=function(e){},o.prototype.visitRepetitionWithSeparator=function(e){},o.prototype.visitAlternation=function(e){},o.prototype.visitTerminal=function(e){},o.prototype.visitRule=function(e){},o);function o(){}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{IN:()=>n});var n="_~IN~_"},(e,t,r)=>{"use strict";r.r(t),r.d(t,{NamedDSLMethodsCollectorVisitor:()=>o,addNoneTerminalToCst:()=>function(e,t,r){void 0===e.children[t]?e.children[t]=[r]:e.children[t].push(r)},addTerminalToCst:()=>function(e,t,r){void 0===e.children[r]?e.children[r]=[t]:e.children[r].push(t)},expandAllNestedRuleNames:()=>function(e,r){var n={allRuleNames:[]};return(0,s.forEach)(e,function(t){var e=r[t.name],e=(n.allRuleNames.push(t.name),new o(e));t.accept(e),(0,s.forEach)(e.result,function(e){e.def,e.key;e=e.name;n.allRuleNames.push(t.name+e)})}),n},setNodeLocationFull:()=>function(e,t){!0===isNaN(e.startOffset)?(e.startOffset=t.startOffset,e.startColumn=t.startColumn,e.startLine=t.startLine,e.endOffset=t.endOffset,e.endColumn=t.endColumn,e.endLine=t.endLine):e.endOffset<t.endOffset==!0&&(e.endOffset=t.endOffset,e.endColumn=t.endColumn,e.endLine=t.endLine)},setNodeLocationOnlyOffset:()=>function(e,t){!0===isNaN(e.startOffset)?(e.startOffset=t.startOffset,e.endOffset=t.endOffset):e.endOffset<t.endOffset==!0&&(e.endOffset=t.endOffset)}});var n,s=r(17),a=r(34),l=r(20),t=r(31),r=(n=function(e,t){return(n=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])}))(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});i=t.GAstVisitor,r(c,i),c.prototype.collectNamedDSLMethod=function(e,t,r){if(!(0,s.isUndefined)(e.name)){var n=void 0;if(e instanceof l.Option||e instanceof l.Repetition||e instanceof l.RepetitionMandatory||e instanceof l.Alternation)n=new t({definition:e.definition,idx:e.idx});else{if(!(e instanceof l.RepetitionMandatoryWithSeparator||e instanceof l.RepetitionWithSeparator))throw Error("non exhaustive match");n=new t({definition:e.definition,idx:e.idx,separator:e.separator})}t=[n],n=(0,a.getKeyForAutomaticLookahead)(this.ruleIdx,r,e.idx);this.result.push({def:t,key:n,name:e.name,orgProd:e})}},c.prototype.visitOption=function(e){this.collectNamedDSLMethod(e,l.Option,a.OPTION_IDX)},c.prototype.visitRepetition=function(e){this.collectNamedDSLMethod(e,l.Repetition,a.MANY_IDX)},c.prototype.visitRepetitionMandatory=function(e){this.collectNamedDSLMethod(e,l.RepetitionMandatory,a.AT_LEAST_ONE_IDX)},c.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.collectNamedDSLMethod(e,l.RepetitionMandatoryWithSeparator,a.AT_LEAST_ONE_SEP_IDX)},c.prototype.visitRepetitionWithSeparator=function(e){this.collectNamedDSLMethod(e,l.RepetitionWithSeparator,a.MANY_SEP_IDX)},c.prototype.visitAlternation=function(n){var i=this,o=(this.collectNamedDSLMethod(n,l.Alternation,a.OR_IDX),1<n.definition.length);(0,s.forEach)(n.definition,function(e,t){var r;(0,s.isUndefined)(e.name)||(r=e.definition,r=o?[new l.Option({definition:e.definition})]:e.definition,t=(0,a.getKeyForAltIndex)(i.ruleIdx,a.OR_IDX,n.idx,t),i.result.push({def:r,key:t,name:e.name,orgProd:e}))})};var i,o=c;function c(e){var t=i.call(this)||this;return t.result=[],t.ruleIdx=e,t}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{AT_LEAST_ONE_IDX:()=>u,AT_LEAST_ONE_SEP_IDX:()=>h,BITS_FOR_ALT_IDX:()=>s,BITS_FOR_METHOD_TYPE:()=>n,BITS_FOR_OCCURRENCE_IDX:()=>i,BITS_FOR_RULE_IDX:()=>o,MANY_IDX:()=>c,MANY_SEP_IDX:()=>d,OPTION_IDX:()=>l,OR_IDX:()=>a,getKeyForAltIndex:()=>function(e,t,r,n){return r|t|e|n+1<<f},getKeyForAutomaticLookahead:()=>p});var n=4,i=8,o=12,s=8,a=1<<i,l=2<<i,c=3<<i,u=4<<i,d=5<<i,h=6<<i;function p(e,t,r){return r|t|e}var f=32-s},(e,t,r)=>{"use strict";r.r(t),r.d(t,{defaultGrammarResolverErrorProvider:()=>c,defaultGrammarValidatorErrorProvider:()=>u,defaultParserErrorProvider:()=>l});var i=r(21),o=r(17),s=r(20),a=r(30),n=r(36),l={buildMismatchTokenMessage:function(e){var t=e.expected,r=e.actual;e.previous,e.ruleName;return"Expecting "+((0,i.hasTokenLabel)(t)?"--\x3e "+(0,i.tokenLabel)(t)+" <--":"token of type --\x3e "+t.name+" <--")+" but found --\x3e '"+r.image+"' <--"},buildNotAllInputParsedMessage:function(e){var t=e.firstRedundant;e.ruleName;return"Redundant input, expecting EOF but found: "+t.image},buildNoViableAltMessage:function(e){var t=e.expectedPathsPerAlt,r=e.actual,n=(e.previous,e.customUserDescription),e=(e.ruleName,"Expecting: "),r="\nbut found: '"+(0,o.first)(r).image+"'";return n?e+n+r:(n=(0,o.reduce)(t,function(e,t){return e.concat(t)},[]),t=(0,o.map)(n,function(e){return"["+(0,o.map)(e,function(e){return(0,i.tokenLabel)(e)}).join(", ")+"]"}),e+("one of these possible Token sequences:\n"+(0,o.map)(t,function(e,t){return"  "+(t+1)+". "+e}).join("\n"))+r)},buildEarlyExitMessage:function(e){var t=e.expectedIterationPaths,r=e.actual,n=e.customUserDescription,e=(e.ruleName,"Expecting: "),r="\nbut found: '"+(0,o.first)(r).image+"'";return n?e+n+r:e+("expecting at least one iteration which starts with one of these possible Token sequences::\n  <"+(0,o.map)(t,function(e){return"["+(0,o.map)(e,function(e){return(0,i.tokenLabel)(e)}).join(",")+"]"}).join(" ,")+">")+r}},c=(Object.freeze(l),{buildRuleNotFoundError:function(e,t){return"Invalid grammar, reference to a rule which is not defined: ->"+t.nonTerminalName+"<-\ninside top level rule: ->"+e.name+"<-"}}),u={buildDuplicateFoundError:function(e,t){var e=e.name,r=(0,o.first)(t),n=r.idx,i=(0,a.getProductionDslName)(r),r=(r=r)instanceof s.Terminal?r.terminalType.name:r instanceof s.NonTerminal?r.nonTerminalName:"",i="->"+i+(0<n?n:"")+"<- "+(r?"with argument: ->"+r+"<-":"")+"\n                  appears more than once ("+t.length+" times) in the top level rule: ->"+e+"<-.                  \n                  For further details see: https://sap.github.io/chevrotain/docs/FAQ.html#NUMERICAL_SUFFIXES \n                  ";return i=(i=i.replace(/[ \t]+/g," ")).replace(/\s\s+/g,"\n")},buildInvalidNestedRuleNameError:function(e,t){return"Invalid nested rule name: ->"+t.name+"<- inside rule: ->"+e.name+"<-\nit must match the pattern: ->"+n.validNestedRuleName.toString()+"<-.\nNote that this means a nested rule name must start with the '$'(dollar) sign."},buildDuplicateNestedRuleNameError:function(e,t){return"Duplicate nested rule name: ->"+(0,o.first)(t).name+"<- inside rule: ->"+e.name+"<-\nA nested name must be unique in the scope of a top level grammar rule."},buildNamespaceConflictError:function(e){return"Namespace conflict found in grammar.\nThe grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <"+e.name+">.\nTo resolve this make sure each Terminal and Non-Terminal names are unique\nThis is easy to accomplish by using the convention that Terminal names start with an uppercase letter\nand Non-Terminal names start with a lower case letter."},buildAlternationPrefixAmbiguityError:function(e){var t=(0,o.map)(e.prefixPath,function(e){return(0,i.tokenLabel)(e)}).join(", "),r=0===e.alternation.idx?"":e.alternation.idx;return"Ambiguous alternatives: <"+e.ambiguityIndices.join(" ,")+"> due to common lookahead prefix\nin <OR"+r+"> inside <"+e.topLevelRule.name+"> Rule,\n<"+t+"> may appears as a prefix path in all these alternatives.\nSee: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX\nFor Further details."},buildAlternationAmbiguityError:function(e){var t=(0,o.map)(e.prefixPath,function(e){return(0,i.tokenLabel)(e)}).join(", "),r=0===e.alternation.idx?"":e.alternation.idx,r="Ambiguous Alternatives Detected: <"+e.ambiguityIndices.join(" ,")+"> in <OR"+r+"> inside <"+e.topLevelRule.name+"> Rule,\n<"+t+"> may appears as a prefix path in all these alternatives.\n";return r+="See: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES\nFor Further details."},buildEmptyRepetitionError:function(e){var t=(0,a.getProductionDslName)(e.repetition);return 0!==e.repetition.idx&&(t+=e.repetition.idx),"The repetition <"+t+"> within Rule <"+e.topLevelRule.name+"> can never consume any tokens.\nThis could lead to an infinite loop."},buildTokenNameError:function(e){return"Invalid Grammar Token name: ->"+e.tokenType.name+"<- it must match the pattern: ->"+e.expectedPattern.toString()+"<-"},buildEmptyAlternationError:function(e){return"Ambiguous empty alternative: <"+(e.emptyChoiceIdx+1)+"> in <OR"+e.alternation.idx+"> inside <"+e.topLevelRule.name+"> Rule.\nOnly the last alternative may be an empty alternative."},buildTooManyAlternativesError:function(e){return"An Alternation cannot have more than 256 alternatives:\n<OR"+e.alternation.idx+"> inside <"+e.topLevelRule.name+"> Rule.\n has "+(e.alternation.definition.length+1)+" alternatives."},buildLeftRecursionError:function(e){var t=e.topLevelRule.name;return"Left Recursion found in grammar.\nrule: <"+t+"> can be invoked from itself (directly or indirectly)\nwithout consuming any Tokens. The grammar path that causes this is: \n "+(t+" --\x3e "+o.map(e.leftRecursionPath,function(e){return e.name}).concat([t]).join(" --\x3e "))+"\n To fix this refactor your grammar to remove the left recursion.\nsee: https://en.wikipedia.org/wiki/LL_parser#Left_Factoring."},buildInvalidRuleNameError:function(e){return"Invalid grammar rule name: ->"+e.topLevelRule.name+"<- it must match the pattern: ->"+e.expectedPattern.toString()+"<-"},buildDuplicateRuleNameError:function(e){var t=e.topLevelRule instanceof s.Rule?e.topLevelRule.name:e.topLevelRule;return"Duplicate definition, rule: ->"+t+"<- is already defined in the grammar: ->"+e.grammarName+"<-"}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{OccurrenceValidationCollector:()=>T,RepetionCollector:()=>m,checkPrefixAlternativesAmbiguities:()=>D,getFirstNoneTerminal:()=>u,identifyProductionForDuplicates:()=>C,validNestedRuleName:()=>c,validTermsPattern:()=>l,validateAmbiguousAlternationAlternatives:()=>O,validateEmptyOrAlternative:()=>N,validateGrammar:()=>function(t,r,e,n,o,i){var s=y.map(t,function(e){return n=e,i=o,e=new T,n.accept(e),e=e.allProductions,e=y.groupBy(e,C),e=y.pick(e,function(e){return 1<e.length}),y.map(y.values(e),function(e){var t=y.first(e),e=i.buildDuplicateFoundError(n,e),r=(0,b.getProductionDslName)(t),e={message:e,type:v.ParserDefinitionErrorType.DUPLICATE_PRODUCTIONS,ruleName:n.name,dslName:r,occurrence:t.idx},r=E(t);return r&&(e.parameter=r),e});var n,i}),a=y.map(t,function(e){return A(e,e,o)}),l=[],c=[],u=[];(0,y.every)(a,y.isEmpty)&&(l=(0,y.map)(t,function(e){return N(e,o)}),c=(0,y.map)(t,function(e){return O(e,r,n,o)}),u=k(t,r,o));var d=function(e,t,r){var n=[],i=(0,y.map)(t,function(e){return e.name});return(0,y.forEach)(e,function(e){var t=e.name;(0,y.contains)(i,t)&&(e=r.buildNamespaceConflictError(e),n.push({message:e,type:v.ParserDefinitionErrorType.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:t}))}),n}(t,e,o),e=y.map(e,function(e){return x(e,o)}),h=function(e,r){var n=[];return(0,y.forEach)(e,function(t){var e=new w.NamedDSLMethodsCollectorVisitor(""),e=(t.accept(e),(0,y.map)(e.result,function(e){return e.orgProd}));n.push((0,y.map)(e,function(e){return _(t,e,r)}))}),(0,y.flatten)(n)}(t,o),p=function(e,r){var n=[];return(0,y.forEach)(e,function(t){var e=new w.NamedDSLMethodsCollectorVisitor(""),e=(t.accept(e),(0,y.groupBy)(e.result,function(e){return e.name})),e=(0,y.pick)(e,function(e){return 1<e.length});(0,y.forEach)((0,y.values)(e),function(e){e=(0,y.map)(e,function(e){return e.orgProd}),e=r.buildDuplicateNestedRuleNameError(t,e);n.push({message:e,type:v.ParserDefinitionErrorType.DUPLICATE_NESTED_NAME,ruleName:t.name})})}),n}(t,o),f=(0,y.map)(t,function(e){return M(e,o)}),g=(0,y.map)(t,function(e){return S(e,o)}),m=(0,y.map)(t,function(e){return R(e,t,i,o)});return y.flatten(s.concat(e,h,p,u,a,l,c,d,f,g,m))},validateNestedRuleName:()=>_,validateNoLeftRecursion:()=>A,validateRuleDoesNotAlreadyExist:()=>R,validateRuleIsOverridden:()=>function(e,t,r){var n=[];y.contains(t,e)||n.push({message:"Invalid rule override, rule: ->"+e+"<- cannot be overridden in the grammar: ->"+r+"<-as it is not defined in any of the super grammars ",type:v.ParserDefinitionErrorType.INVALID_RULE_OVERRIDE,ruleName:e});return n},validateRuleName:()=>S,validateSomeNonEmptyLookaheadPath:()=>k,validateTokenName:()=>x,validateTooManyAlts:()=>M});var n,y=r(17),v=r(16),b=r(30),h=r(37),w=r(33),o=r(38),i=r(20),t=r(31),r=(n=function(e,t){return(n=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])}))(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function C(e){return(0,b.getProductionDslName)(e)+"_#_"+e.idx+"_#_"+E(e)}function E(e){return e instanceof i.Terminal?e.terminalType.name:e instanceof i.NonTerminal?e.nonTerminalName:""}s=t.GAstVisitor,r(a,s),a.prototype.visitNonTerminal=function(e){this.allProductions.push(e)},a.prototype.visitOption=function(e){this.allProductions.push(e)},a.prototype.visitRepetitionWithSeparator=function(e){this.allProductions.push(e)},a.prototype.visitRepetitionMandatory=function(e){this.allProductions.push(e)},a.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.allProductions.push(e)},a.prototype.visitRepetition=function(e){this.allProductions.push(e)},a.prototype.visitAlternation=function(e){this.allProductions.push(e)},a.prototype.visitTerminal=function(e){this.allProductions.push(e)};var s,T=a;function a(){var e=null!==s&&s.apply(this,arguments)||this;return e.allProductions=[],e}var l=/^[a-zA-Z_]\w*$/,c=new RegExp(l.source.replace("^","^\\$"));function S(e,t){var r=[],n=e.name;return n.match(l)||r.push({message:t.buildInvalidRuleNameError({topLevelRule:e,expectedPattern:l}),type:v.ParserDefinitionErrorType.INVALID_RULE_NAME,ruleName:n}),r}function _(e,t,r){var n=[];return t.name.match(c)||(r=r.buildInvalidNestedRuleNameError(e,t),n.push({message:r,type:v.ParserDefinitionErrorType.INVALID_NESTED_RULE_NAME,ruleName:e.name})),n}function x(e,t){var r=[];return e.name.match(l)||r.push({message:t.buildTokenNameError({tokenType:e,expectedPattern:l}),type:v.ParserDefinitionErrorType.INVALID_TOKEN_NAME}),r}function R(r,e,t,n){var i=[];return 1<(0,y.reduce)(e,function(e,t){return t.name===r.name?e+1:e},0)&&(e=n.buildDuplicateRuleNameError({topLevelRule:r,grammarName:t}),i.push({message:e,type:v.ParserDefinitionErrorType.DUPLICATE_RULE_NAME,ruleName:r.name})),i}function A(r,e,n,i){void 0===i&&(i=[]);var t,o=[],e=u(e.definition);return y.isEmpty(e)?[]:(t=r.name,y.contains(e,r)&&o.push({message:n.buildLeftRecursionError({topLevelRule:r,leftRecursionPath:i}),type:v.ParserDefinitionErrorType.LEFT_RECURSION,ruleName:t}),t=y.difference(e,i.concat([r])),e=y.map(t,function(e){var t=y.cloneArr(i);return t.push(e),A(r,e,n,t)}),o.concat(y.flatten(e)))}function u(e){var t=[];if(y.isEmpty(e))return t;var r=y.first(e);if(r instanceof i.NonTerminal)t.push(r.referencedRule);else if(r instanceof i.Flat||r instanceof i.Option||r instanceof i.RepetitionMandatory||r instanceof i.RepetitionMandatoryWithSeparator||r instanceof i.RepetitionWithSeparator||r instanceof i.Repetition)t=t.concat(u(r.definition));else if(r instanceof i.Alternation)t=y.flatten(y.map(r.definition,function(e){return u(e.definition)}));else if(!(r instanceof i.Terminal))throw Error("non exhaustive match");var r=(0,b.isOptionalProd)(r),n=1<e.length;return r&&n?(r=y.drop(e),t.concat(u(r))):t}d=t.GAstVisitor,r(f,d),f.prototype.visitAlternation=function(e){this.alternations.push(e)};var d,p=f;function f(){var e=null!==d&&d.apply(this,arguments)||this;return e.alternations=[],e}function N(n,i){var e=new p,e=(n.accept(e),e.alternations);return y.reduce(e,function(e,r){var t=y.dropRight(r.definition),t=y.map(t,function(e,t){e=(0,o.nextPossibleTokensAfter)([e],[],null,1);return y.isEmpty(e)?{message:i.buildEmptyAlternationError({topLevelRule:n,alternation:r,emptyChoiceIdx:t}),type:v.ParserDefinitionErrorType.NONE_LAST_EMPTY_ALT,ruleName:n.name,occurrence:r.idx,alternative:t+1}:null});return e.concat(y.compact(t))},[])}function O(c,u,e,d){var t=new p,t=(c.accept(t),t.alternations),r=e[c.name];return r&&(t=(0,y.reject)(t,function(e){return r[(0,b.getProductionDslName)(e)+(0===e.idx?"":e.idx)]})),t=(0,y.reject)(t,function(e){return!0===e.ignoreAmbiguities}),y.reduce(t,function(e,t){var o,s,r,n,a,i=t.idx,l=t.maxLookahead||u,i=(0,h.getLookaheadPathsForOr)(i,c,l,t),l=(o=i,s=t,r=c,n=d,a=[],l=(0,y.reduce)(o,function(e,t,i){return!0!==s.definition[i].ignoreAmbiguities&&(0,y.forEach)(t,function(r){var n=[i];(0,y.forEach)(o,function(e,t){i!==t&&(0,h.containsPath)(e,r)&&!0!==s.definition[t].ignoreAmbiguities&&n.push(t)}),1<n.length&&!(0,h.containsPath)(a,r)&&(a.push(r),e.push({alts:n,path:r}))}),e},[]),y.map(l,function(e){var t=(0,y.map)(e.alts,function(e){return e+1});return{message:n.buildAlternationAmbiguityError({topLevelRule:r,alternation:s,ambiguityIndices:t,prefixPath:e.path}),type:v.ParserDefinitionErrorType.AMBIGUOUS_ALTS,ruleName:r.name,occurrence:s.idx,alternatives:[e.alts]}})),i=D(i,t,c,d);return e.concat(l,i)},[])}g=t.GAstVisitor,r(I,g),I.prototype.visitRepetitionWithSeparator=function(e){this.allProductions.push(e)},I.prototype.visitRepetitionMandatory=function(e){this.allProductions.push(e)},I.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.allProductions.push(e)},I.prototype.visitRepetition=function(e){this.allProductions.push(e)};var g,m=I;function I(){var e=null!==g&&g.apply(this,arguments)||this;return e.allProductions=[],e}function M(r,n){var e=new p,e=(r.accept(e),e.alternations);return y.reduce(e,function(e,t){return 255<t.definition.length&&e.push({message:n.buildTooManyAlternativesError({topLevelRule:r,alternation:t}),type:v.ParserDefinitionErrorType.TOO_MANY_ALTS,ruleName:r.name,occurrence:t.idx}),e},[])}function k(e,o,s){var a=[];return(0,y.forEach)(e,function(i){var e=new m,e=(i.accept(e),e.allProductions);(0,y.forEach)(e,function(e){var t=(0,h.getProdType)(e),r=e.maxLookahead||o,n=e.idx,n=(0,h.getLookaheadPathsForOptionalProd)(n,i,t,r)[0];(0,y.isEmpty)((0,y.flatten)(n))&&(t=s.buildEmptyRepetitionError({topLevelRule:i,repetition:e}),a.push({message:t,type:v.ParserDefinitionErrorType.NO_NON_EMPTY_LOOKAHEAD,ruleName:i.name}))})}),a}function D(e,i,o,s){var r=[],a=(0,y.reduce)(e,function(e,t,r){t=(0,y.map)(t,function(e){return{idx:r,path:e}});return e.concat(t)},[]);return(0,y.forEach)(a,function(e){var n,t;!0!==i.definition[e.idx].ignoreAmbiguities&&(n=e.idx,t=e.path,e=(0,y.findAll)(a,function(e){return!0!==i.definition[e.idx].ignoreAmbiguities&&e.idx<n&&(0,h.isStrictPrefixOfPath)(e.path,t)}),e=(0,y.map)(e,function(e){var t=[e.idx+1,n+1],r=0===i.idx?"":i.idx;return{message:s.buildAlternationPrefixAmbiguityError({topLevelRule:o,alternation:i,ambiguityIndices:t,prefixPath:e.path}),type:v.ParserDefinitionErrorType.AMBIGUOUS_PREFIX_ALTS,ruleName:o.name,occurrence:r,alternatives:t}}),r=r.concat(e))}),r}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{PROD_TYPE:()=>i,areTokenCategoriesNotUsed:()=>T,buildAlternativesLookAheadFunc:()=>function(d,e,h,t){var p=d.length,r=(0,g.every)(d,function(e){return(0,g.every)(e,function(e){return 1===e.length})});{var n;return e?function(e){for(var t=(0,g.map)(e,function(e){return e.GATE}),r=0;r<p;r++){var n=d[r],i=n.length,o=t[r];if(void 0===o||!1!==o.call(this))e:for(var s=0;s<i;s++){for(var a=n[s],l=a.length,c=0;c<l;c++){var u=this.LA(c+1);if(!1===h(u,a[c]))continue e}return r}}}:r&&!t?(e=(0,g.map)(d,function(e){return(0,g.flatten)(e)}),n=(0,g.reduce)(e,function(t,e,r){return(0,g.forEach)(e,function(e){(0,g.has)(t,e.tokenTypeIdx)||(t[e.tokenTypeIdx]=r),(0,g.forEach)(e.categoryMatches,function(e){(0,g.has)(t,e)||(t[e]=r)})}),t},[]),function(){var e=this.LA(1);return n[e.tokenTypeIdx]}):function(){for(var e=0;e<p;e++){var t=d[e],r=t.length;e:for(var n=0;n<r;n++){for(var i=t[n],o=i.length,s=0;s<o;s++){var a=this.LA(s+1);if(!1===h(a,i[s]))continue e}return e}}}}},buildLookaheadFuncForOptionalProd:()=>function(e,t,r,n,i,o){e=C(e,t,i,r),t=T(e)?s.tokenStructuredMatcherNoCategories:s.tokenStructuredMatcher;return o(e[0],t,n)},buildLookaheadFuncForOr:()=>function(e,t,r,n,i,o){e=w(e,t,r),t=T(e)?s.tokenStructuredMatcherNoCategories:s.tokenStructuredMatcher;return o(e,n,t,i)},buildSingleAlternativeLookaheadFunction:()=>function(o,s,e){var t=(0,g.every)(o,function(e){return 1===e.length}),a=o.length;{var r,n;return t&&!e?1===(t=(0,g.flatten)(o)).length&&(0,g.isEmpty)(t[0].categoryMatches)?(r=t[0].tokenTypeIdx,function(){return this.LA(1).tokenTypeIdx===r}):(n=(0,g.reduce)(t,function(t,e,r){return t[e.tokenTypeIdx]=!0,(0,g.forEach)(e.categoryMatches,function(e){t[e]=!0}),t},[]),function(){var e=this.LA(1);return!0===n[e.tokenTypeIdx]}):function(){e:for(var e=0;e<a;e++){for(var t=o[e],r=t.length,n=0;n<r;n++){var i=this.LA(n+1);if(!1===s(i,t[n]))continue e}return!0}return!1}}},containsPath:()=>E,getLookaheadPathsForOptionalProd:()=>C,getLookaheadPathsForOr:()=>w,getProdType:()=>function(e){{if(e instanceof a.Option)return i.OPTION;if(e instanceof a.Repetition)return i.REPETITION;if(e instanceof a.RepetitionMandatory)return i.REPETITION_MANDATORY;if(e instanceof a.RepetitionMandatoryWithSeparator)return i.REPETITION_MANDATORY_WITH_SEPARATOR;if(e instanceof a.RepetitionWithSeparator)return i.REPETITION_WITH_SEPARATOR;if(e instanceof a.Alternation)return i.ALTERNATION;throw Error("non exhaustive match")}},isStrictPrefixOfPath:()=>function(e,r){return e.length<r.length&&(0,g.every)(e,function(e,t){t=r[t];return e===t||t.categoryMatchesMap[e.tokenTypeIdx]})},lookAheadSequenceFromAlternatives:()=>b});var n,i,o,g=r(17),m=r(38),t=r(19),s=r(27),a=r(20),r=r(31),l=(n=function(e,t){return(n=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])}))(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});(o=i=i||{})[o.OPTION=0]="OPTION",o[o.REPETITION=1]="REPETITION",o[o.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",o[o.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",o[o.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",o[o.ALTERNATION=5]="ALTERNATION";c=t.RestWalker,l(d,c),d.prototype.startWalking=function(){return this.walk(this.topProd),this.restDef},d.prototype.checkIsTarget=function(e,t,r,n){return e.idx===this.targetOccurrence&&this.targetProdType===t&&(this.restDef=r.concat(n),!0)},d.prototype.walkOption=function(e,t,r){this.checkIsTarget(e,i.OPTION,t,r)||c.prototype.walkOption.call(this,e,t,r)},d.prototype.walkAtLeastOne=function(e,t,r){this.checkIsTarget(e,i.REPETITION_MANDATORY,t,r)||c.prototype.walkOption.call(this,e,t,r)},d.prototype.walkAtLeastOneSep=function(e,t,r){this.checkIsTarget(e,i.REPETITION_MANDATORY_WITH_SEPARATOR,t,r)||c.prototype.walkOption.call(this,e,t,r)},d.prototype.walkMany=function(e,t,r){this.checkIsTarget(e,i.REPETITION,t,r)||c.prototype.walkOption.call(this,e,t,r)},d.prototype.walkManySep=function(e,t,r){this.checkIsTarget(e,i.REPETITION_WITH_SEPARATOR,t,r)||c.prototype.walkOption.call(this,e,t,r)};var c,u=d;function d(e,t,r){var n=c.call(this)||this;return n.topProd=e,n.targetOccurrence=t,n.targetProdType=r,n}h=r.GAstVisitor,l(f,h),f.prototype.checkIsTarget=function(e,t){e.idx!==this.targetOccurrence||this.targetProdType!==t||void 0!==this.targetRef&&e!==this.targetRef||(this.result=e.definition)},f.prototype.visitOption=function(e){this.checkIsTarget(e,i.OPTION)},f.prototype.visitRepetition=function(e){this.checkIsTarget(e,i.REPETITION)},f.prototype.visitRepetitionMandatory=function(e){this.checkIsTarget(e,i.REPETITION_MANDATORY)},f.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.checkIsTarget(e,i.REPETITION_MANDATORY_WITH_SEPARATOR)},f.prototype.visitRepetitionWithSeparator=function(e){this.checkIsTarget(e,i.REPETITION_WITH_SEPARATOR)},f.prototype.visitAlternation=function(e){this.checkIsTarget(e,i.ALTERNATION)};var h,p=f;function f(e,t,r){var n=h.call(this)||this;return n.targetOccurrence=e,n.targetProdType=t,n.targetRef=r,n.result=[],n}function y(e){for(var t=new Array(e),r=0;r<e;r++)t[r]=[];return t}function v(e){for(var t=[""],r=0;r<e.length;r++){for(var n=e[r],i=[],o=0;o<t.length;o++){var s=t[o];i.push(s+"_"+n.tokenTypeIdx);for(var a=0;a<n.categoryMatches.length;a++){var l="_"+n.categoryMatches[a];i.push(s+l)}}t=i}return t}function b(e,c){for(var e=(0,g.map)(e,function(e){return(0,m.possiblePathsFrom)([e],1)}),u=y(e.length),d=(0,g.map)(e,function(e){var t={};return(0,g.forEach)(e,function(e){e=v(e.partialPath);(0,g.forEach)(e,function(e){t[e]=!0})}),t}),h=e,p=1;p<=c;p++)for(var f=h,h=y(f.length),t=function(t){for(var e=f[t],r=0;r<e.length;r++){var n=e[r].partialPath,i=e[r].suffixDef,o=v(n);if(function(e,t,r){for(var n=0;n<e.length;n++)if(n!==r)for(var i=e[n],o=0;o<t.length;o++)if(!0===i[t[o]])return!1;return!0}(d,o,t)||(0,g.isEmpty)(i)||n.length===c){var s=u[t];if(!1===E(s,n)){s.push(n);for(var a=0;a<o.length;a++){var l=o[a];d[t][l]=!0}}}else{s=(0,m.possiblePathsFrom)(i,p+1,n);h[t]=h[t].concat(s),(0,g.forEach)(s,function(e){e=v(e.partialPath);(0,g.forEach)(e,function(e){d[t][e]=!0})})}}},r=0;r<f.length;r++)t(r);return u}function w(e,t,r,n){e=new p(e,i.ALTERNATION,n);return t.accept(e),b(e.result,r)}function C(e,t,r,n){var i=new p(e,r),i=(t.accept(i),i.result),t=new u(t,e,r).startWalking();return b([new a.Flat({definition:i}),new a.Flat({definition:t})],n)}function E(e,t){e:for(var r=0;r<e.length;r++){var n=e[r];if(n.length===t.length){for(var i=0;i<n.length;i++){var o=t[i],s=n[i];if(!1==(o===s||void 0!==s.categoryMatchesMap[o.tokenTypeIdx]))continue e}return!0}}return!1}function T(e){return(0,g.every)(e,function(e){return(0,g.every)(e,function(e){return(0,g.every)(e,function(e){return(0,g.isEmpty)(e.categoryMatches)})})})}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{AbstractNextPossibleTokensWalker:()=>s,AbstractNextTerminalAfterProductionWalker:()=>h,NextAfterTokenWalker:()=>c,NextTerminalAfterAtLeastOneSepWalker:()=>S,NextTerminalAfterAtLeastOneWalker:()=>C,NextTerminalAfterManySepWalker:()=>v,NextTerminalAfterManyWalker:()=>g,nextPossibleTokensAfter:()=>function(e,t,r,n){var i="EXIT_NONE_TERMINAL",o=[i],s="EXIT_ALTERNATIVE",a=!1,l=t.length,c=l-n-1,u=[],d=[];d.push({idx:-1,def:e,ruleStack:[],occurrenceStack:[]});for(;!(0,A.isEmpty)(d);){var h=d.pop();if(h===s)a&&(0,A.last)(d).idx<=c&&d.pop();else{var p=h.def,f=h.idx,g=h.ruleStack,m=h.occurrenceStack;if(!(0,A.isEmpty)(p)){var y=p[0];if(y===i){var v={idx:f,def:(0,A.drop)(p),ruleStack:(0,A.dropRight)(g),occurrenceStack:(0,A.dropRight)(m)};d.push(v)}else if(y instanceof N.Terminal)if(f<l-1){var h=f+1,b=t[h];r(b,y.terminalType)&&(v={idx:h,def:(0,A.drop)(p),ruleStack:g,occurrenceStack:m},d.push(v))}else{if(f!==l-1)throw Error("non exhaustive match");u.push({nextTokenType:y.terminalType,nextTokenOccurrence:y.idx,ruleStack:g,occurrenceStack:m}),a=!0}else if(y instanceof N.NonTerminal){b=(0,A.cloneArr)(g),h=(b.push(y.nonTerminalName),(0,A.cloneArr)(m)),v=(h.push(y.idx),{idx:f,def:y.definition.concat(o,(0,A.drop)(p)),ruleStack:b,occurrenceStack:h});d.push(v)}else if(y instanceof N.Option){var w={idx:f,def:(0,A.drop)(p),ruleStack:g,occurrenceStack:m},C=(d.push(w),d.push(s),{idx:f,def:y.definition.concat((0,A.drop)(p)),ruleStack:g,occurrenceStack:m});d.push(C)}else if(y instanceof N.RepetitionMandatory){var E=new N.Repetition({definition:y.definition,idx:y.idx}),T=y.definition.concat([E],(0,A.drop)(p)),v={idx:f,def:T,ruleStack:g,occurrenceStack:m};d.push(v)}else if(y instanceof N.RepetitionMandatoryWithSeparator){var S=new N.Terminal({terminalType:y.separator}),E=new N.Repetition({definition:[S].concat(y.definition),idx:y.idx}),T=y.definition.concat([E],(0,A.drop)(p)),v={idx:f,def:T,ruleStack:g,occurrenceStack:m};d.push(v)}else if(y instanceof N.RepetitionWithSeparator){var w={idx:f,def:(0,A.drop)(p),ruleStack:g,occurrenceStack:m},S=(d.push(w),d.push(s),new N.Terminal({terminalType:y.separator})),_=new N.Repetition({definition:[S].concat(y.definition),idx:y.idx}),T=y.definition.concat([_],(0,A.drop)(p)),C={idx:f,def:T,ruleStack:g,occurrenceStack:m};d.push(C)}else if(y instanceof N.Repetition){w={idx:f,def:(0,A.drop)(p),ruleStack:g,occurrenceStack:m},_=(d.push(w),d.push(s),new N.Repetition({definition:y.definition,idx:y.idx})),T=y.definition.concat([_],(0,A.drop)(p)),C={idx:f,def:T,ruleStack:g,occurrenceStack:m};d.push(C)}else if(y instanceof N.Alternation)for(var x=y.definition.length-1;0<=x;x--){var R=y.definition[x],R={idx:f,def:R.definition.concat((0,A.drop)(p)),ruleStack:g,occurrenceStack:m};d.push(R),d.push(s)}else if(y instanceof N.Flat)d.push({idx:f,def:y.definition.concat((0,A.drop)(p)),ruleStack:g,occurrenceStack:m});else{if(!(y instanceof N.Rule))throw Error("non exhaustive match");d.push(function(e,t,r,n){r=(0,A.cloneArr)(r),r.push(e.name),n=(0,A.cloneArr)(n);return n.push(1),{idx:t,def:e.definition,ruleStack:r,occurrenceStack:n}}(y,f,g,m))}}}}return u},possiblePathsFrom:()=>function t(r,n,i){void 0===i&&(i=[]);i=(0,A.cloneArr)(i);var o=[];var s=0;function a(e){return e.concat((0,A.drop)(r,s+1))}function l(e){e=t(a(e),n,i);return o.concat(e)}for(;i.length<n&&s<r.length;){var e=r[s];if(e instanceof N.Flat)return l(e.definition);if(e instanceof N.NonTerminal)return l(e.definition);if(e instanceof N.Option)o=l(e.definition);else{if(e instanceof N.RepetitionMandatory)return c=e.definition.concat([new N.Repetition({definition:e.definition})]),l(c);if(e instanceof N.RepetitionMandatoryWithSeparator)return c=[new N.Flat({definition:e.definition}),new N.Repetition({definition:[new N.Terminal({terminalType:e.separator})].concat(e.definition)})],l(c);if(e instanceof N.RepetitionWithSeparator){var c=e.definition.concat([new N.Repetition({definition:[new N.Terminal({terminalType:e.separator})].concat(e.definition)})]);o=l(c)}else if(e instanceof N.Repetition){c=e.definition.concat([new N.Repetition({definition:e.definition})]);o=l(c)}else{if(e instanceof N.Alternation)return(0,A.forEach)(e.definition,function(e){o=l(e.definition)}),o;if(!(e instanceof N.Terminal))throw Error("non exhaustive match");i.push(e.terminalType)}}s++}o.push({partialPath:i,suffixDef:(0,A.drop)(r,s)});return o}});var n,i,t=r(19),A=r(17),o=r(29),N=r(20),r=(n=function(e,t){return(n=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])}))(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),s=(i=t.RestWalker,r(a,i),a.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=(0,A.cloneArr)(this.path.ruleStack).reverse(),this.occurrenceStack=(0,A.cloneArr)(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},a.prototype.walk=function(e,t){void 0===t&&(t=[]),this.found||i.prototype.walk.call(this,e,t)},a.prototype.walkProdRef=function(e,t,r){e.referencedRule.name===this.nextProductionName&&e.idx===this.nextProductionOccurrence&&(t=t.concat(r),this.updateExpectedNext(),this.walk(e.referencedRule,t))},a.prototype.updateExpectedNext=function(){(0,A.isEmpty)(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},a);function a(e,t){var r=i.call(this)||this;return r.topProd=e,r.path=t,r.possibleTokTypes=[],r.nextProductionName="",r.nextProductionOccurrence=0,r.found=!1,r.isAtEndOfPath=!1,r}r(u,l=s),u.prototype.walkTerminal=function(e,t,r){this.isAtEndOfPath&&e.terminalType.name===this.nextTerminalName&&e.idx===this.nextTerminalOccurrence&&!this.found&&(e=t.concat(r),t=new N.Flat({definition:e}),this.possibleTokTypes=(0,o.first)(t),this.found=!0)};var l,c=u;function u(e,t){e=l.call(this,e,t)||this;return e.path=t,e.nextTerminalName="",e.nextTerminalOccurrence=0,e.nextTerminalName=e.path.lastTok.name,e.nextTerminalOccurrence=e.path.lastTokOccurrence,e}d=t.RestWalker,r(p,d),p.prototype.startWalking=function(){return this.walk(this.topRule),this.result};var d,h=p;function p(e,t){var r=d.call(this)||this;return r.topRule=e,r.occurrence=t,r.result={token:void 0,occurrence:void 0,isEndOfRule:void 0},r}r(m,f=h),m.prototype.walkMany=function(e,t,r){var n;e.idx===this.occurrence?(n=(0,A.first)(t.concat(r)),this.result.isEndOfRule=void 0===n,n instanceof N.Terminal&&(this.result.token=n.terminalType,this.result.occurrence=n.idx)):f.prototype.walkMany.call(this,e,t,r)};var f,g=m;function m(){return null!==f&&f.apply(this,arguments)||this}r(b,y=h),b.prototype.walkManySep=function(e,t,r){var n;e.idx===this.occurrence?(n=(0,A.first)(t.concat(r)),this.result.isEndOfRule=void 0===n,n instanceof N.Terminal&&(this.result.token=n.terminalType,this.result.occurrence=n.idx)):y.prototype.walkManySep.call(this,e,t,r)};var y,v=b;function b(){return null!==y&&y.apply(this,arguments)||this}r(E,w=h),E.prototype.walkAtLeastOne=function(e,t,r){var n;e.idx===this.occurrence?(n=(0,A.first)(t.concat(r)),this.result.isEndOfRule=void 0===n,n instanceof N.Terminal&&(this.result.token=n.terminalType,this.result.occurrence=n.idx)):w.prototype.walkAtLeastOne.call(this,e,t,r)};var w,C=E;function E(){return null!==w&&w.apply(this,arguments)||this}r(_,T=h),_.prototype.walkAtLeastOneSep=function(e,t,r){var n;e.idx===this.occurrence?(n=(0,A.first)(t.concat(r)),this.result.isEndOfRule=void 0===n,n instanceof N.Terminal&&(this.result.token=n.terminalType,this.result.occurrence=n.idx)):T.prototype.walkAtLeastOneSep.call(this,e,t,r)};var T,S=_;function _(){return null!==T&&T.apply(this,arguments)||this}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{assignOccurrenceIndices:()=>function(e){(0,n.forEach)(e.rules,function(e){var t=new a.DslMethodsCollectorVisitor;e.accept(t),(0,n.forEach)(t.dslMethods,function(e){(0,n.forEach)(e,function(e,t){e.idx=t+1})})})},resolveGrammar:()=>function(e){e=(0,n.defaults)(e,{errMsgProvider:s.defaultGrammarResolverErrorProvider});var t={};return(0,n.forEach)(e.rules,function(e){t[e.name]=e}),(0,i.resolveGrammar)(t,e.errMsgProvider)},validateGrammar:()=>function(e){return e=(0,n.defaults)(e,{errMsgProvider:s.defaultGrammarValidatorErrorProvider,ignoredIssues:{}}),(0,o.validateGrammar)(e.rules,e.maxLookahead,e.tokenTypes,e.ignoredIssues,e.errMsgProvider,e.grammarName)}});var n=r(17),i=r(40),o=r(36),s=r(35),a=r(30)},(e,t,r)=>{"use strict";r.r(t),r.d(t,{GastRefResolverVisitor:()=>a,resolveGrammar:()=>function(e,t){e=new a(e,t);return e.resolveRefs(),e.errors}});var n,i=r(16),o=r(17),t=r(31),r=(n=function(e,t){return(n=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])}))(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});s=t.GAstVisitor,r(l,s),l.prototype.resolveRefs=function(){var t=this;(0,o.forEach)((0,o.values)(this.nameToTopRule),function(e){(t.currTopLevel=e).accept(t)})},l.prototype.visitNonTerminal=function(e){var t=this.nameToTopRule[e.nonTerminalName];t?e.referencedRule=t:(t=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,e),this.errors.push({message:t,type:i.ParserDefinitionErrorType.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:e.nonTerminalName}))};var s,a=l;function l(e,t){var r=s.call(this)||this;return r.nameToTopRule=e,r.errMsgProvider=t,r.errors=[],r}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{EOF_FOLLOW_KEY:()=>o,IN_RULE_RECOVERY_EXCEPTION:()=>s,InRuleRecoveryException:()=>a,Recoverable:()=>l,attemptInRepetitionRecovery:()=>d});var c=r(21),h=r(17),p=r(42),n=r(32),i=r(16),o={},s="InRuleRecoveryException";function a(e){this.name=s,this.message=e}a.prototype=Error.prototype;u.prototype.initRecoverable=function(e){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=((0,h.has)(e,"recoveryEnabled")?e:i.DEFAULT_PARSER_CONFIG).recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=d)},u.prototype.getTokenToInsert=function(e){e=(0,c.createTokenInstance)(e,"",NaN,NaN,NaN,NaN,NaN,NaN);return e.isInsertedInRecovery=!0,e},u.prototype.canTokenTypeBeInsertedInRecovery=function(e){return!0},u.prototype.tryInRepetitionRecovery=function(e,t,r,n){for(var i=this,o=this.findReSyncTokenType(),s=this.exportLexerState(),a=[],l=!1,c=this.LA(1),u=this.LA(1),d=function(){var e=i.LA(0),e=i.errorMessageProvider.buildMismatchTokenMessage({expected:n,actual:c,previous:e,ruleName:i.getCurrRuleFullName()}),e=new p.MismatchedTokenException(e,c,i.LA(0));e.resyncedTokens=(0,h.dropRight)(a),i.SAVE_ERROR(e)};!l;){if(this.tokenMatcher(u,n))return void d();if(r.call(this))return d(),void e.apply(this,t);this.tokenMatcher(u,o)?l=!0:(u=this.SKIP_TOKEN(),this.addToResyncTokens(u,a))}this.importLexerState(s)},u.prototype.shouldInRepetitionRecoveryBeTried=function(e,t,r){return!1!==r&&void 0!==e&&void 0!==t&&!this.tokenMatcher(this.LA(1),e)&&!this.isBackTracking()&&!this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,t))},u.prototype.getFollowsForInRuleRecovery=function(e,t){e=this.getCurrentGrammarPath(e,t);return this.getNextPossibleTokenTypes(e)},u.prototype.tryInRuleRecovery=function(e,t){if(this.canRecoverWithSingleTokenInsertion(e,t))return this.getTokenToInsert(e);if(this.canRecoverWithSingleTokenDeletion(e))return t=this.SKIP_TOKEN(),this.consumeToken(),t;throw new a("sad sad panda")},u.prototype.canPerformInRuleRecovery=function(e,t){return this.canRecoverWithSingleTokenInsertion(e,t)||this.canRecoverWithSingleTokenDeletion(e)},u.prototype.canRecoverWithSingleTokenInsertion=function(e,t){var r,n=this;return!!this.canTokenTypeBeInsertedInRecovery(e)&&!(0,h.isEmpty)(t)&&(r=this.LA(1),void 0!==(0,h.find)(t,function(e){return n.tokenMatcher(r,e)}))},u.prototype.canRecoverWithSingleTokenDeletion=function(e){return this.tokenMatcher(this.LA(2),e)},u.prototype.isInCurrentRuleReSyncSet=function(e){var t=this.getCurrFollowKey(),t=this.getFollowSetFromFollowKey(t);return(0,h.contains)(t,e)},u.prototype.findReSyncTokenType=function(){for(var e=this.flattenFollowSet(),t=this.LA(1),r=2;;){var n=t.tokenType;if((0,h.contains)(e,n))return n;t=this.LA(r),r++}},u.prototype.getCurrFollowKey=function(){var e,t,r;return 1===this.RULE_STACK.length?o:(e=this.getLastExplicitRuleShortName(),t=this.getLastExplicitRuleOccurrenceIndex(),r=this.getPreviousExplicitRuleShortName(),{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:t,inRule:this.shortRuleNameToFullName(r)})},u.prototype.buildFullFollowKeyStack=function(){var r=this,n=this.RULE_STACK,i=this.RULE_OCCURRENCE_STACK;return(0,h.isEmpty)(this.LAST_EXPLICIT_RULE_STACK)||(n=(0,h.map)(this.LAST_EXPLICIT_RULE_STACK,function(e){return r.RULE_STACK[e]}),i=(0,h.map)(this.LAST_EXPLICIT_RULE_STACK,function(e){return r.RULE_OCCURRENCE_STACK[e]})),(0,h.map)(n,function(e,t){return 0===t?o:{ruleName:r.shortRuleNameToFullName(e),idxInCallingRule:i[t],inRule:r.shortRuleNameToFullName(n[t-1])}})},u.prototype.flattenFollowSet=function(){var t=this,e=(0,h.map)(this.buildFullFollowKeyStack(),function(e){return t.getFollowSetFromFollowKey(e)});return(0,h.flatten)(e)},u.prototype.getFollowSetFromFollowKey=function(e){return e===o?[c.EOF]:(e=e.ruleName+e.idxInCallingRule+n.IN+e.inRule,this.resyncFollows[e])},u.prototype.addToResyncTokens=function(e,t){return this.tokenMatcher(e,c.EOF)||t.push(e),t},u.prototype.reSyncTo=function(e){for(var t=[],r=this.LA(1);!1===this.tokenMatcher(r,e);)r=this.SKIP_TOKEN(),this.addToResyncTokens(r,t);return(0,h.dropRight)(t)},u.prototype.attemptInRepetitionRecovery=function(e,t,r,n,i,o,s){},u.prototype.getCurrentGrammarPath=function(e,t){return{ruleStack:this.getHumanReadableRuleStack(),occurrenceStack:(0,h.cloneArr)(this.RULE_OCCURRENCE_STACK),lastTok:e,lastTokOccurrence:t}},u.prototype.getHumanReadableRuleStack=function(){var t=this;return(0,h.isEmpty)(this.LAST_EXPLICIT_RULE_STACK)?(0,h.map)(this.RULE_STACK,function(e){return t.shortRuleNameToFullName(e)}):(0,h.map)(this.LAST_EXPLICIT_RULE_STACK,function(e){return t.shortRuleNameToFullName(t.RULE_STACK[e])})};var l=u;function u(){}function d(e,t,r,n,i,o,s){var n=this.getKeyForAutomaticLookahead(n,i),a=this.firstAfterRepMap[n],o=(void 0===a&&(l=this.getCurrRuleFullName(),a=new o(this.getGAstProductions()[l],i).startWalking(),this.firstAfterRepMap[n]=a),a.token),l=a.occurrence,i=a.isEndOfRule;1===this.RULE_STACK.length&&i&&void 0===o&&(o=c.EOF,l=1),this.shouldInRepetitionRecoveryBeTried(o,l,s)&&this.tryInRepetitionRecovery(e,t,r,o)}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{EarlyExitException:()=>h,MismatchedTokenException:()=>c,NoViableAltException:()=>u,NotAllInputParsedException:()=>d,isRecognitionException:()=>function(e){return(0,n.contains)(l,e.name)}});var n=r(17),i="MismatchedTokenException",o="NoViableAltException",s="EarlyExitException",a="NotAllInputParsedException",l=[i,o,s,a];function c(e,t,r){this.name=i,this.message=e,this.token=t,this.previousToken=r,this.resyncedTokens=[]}function u(e,t,r){this.name=o,this.message=e,this.token=t,this.previousToken=r,this.resyncedTokens=[]}function d(e,t){this.name=a,this.message=e,this.token=t,this.resyncedTokens=[]}function h(e,t,r){this.name=s,this.message=e,this.token=t,this.previousToken=r,this.resyncedTokens=[]}Object.freeze(l),c.prototype=Error.prototype,u.prototype=Error.prototype,d.prototype=Error.prototype,h.prototype=Error.prototype},(e,t,r)=>{"use strict";r.r(t),r.d(t,{LooksAhead:()=>i});var l=r(37),c=r(17),n=r(16),u=r(34),d=r(30),i=(o.prototype.initLooksAhead=function(e){this.dynamicTokensEnabled=((0,c.has)(e,"dynamicTokensEnabled")?e:n.DEFAULT_PARSER_CONFIG).dynamicTokensEnabled,this.maxLookahead=((0,c.has)(e,"maxLookahead")?e:n.DEFAULT_PARSER_CONFIG).maxLookahead,this.lookAheadFuncsCache=(0,c.isES2015MapSupported)()?new Map:[],(0,c.isES2015MapSupported)()?(this.getLaFuncFromCache=this.getLaFuncFromMap,this.setLaFuncCache=this.setLaFuncCacheUsingMap):(this.getLaFuncFromCache=this.getLaFuncFromObj,this.setLaFuncCache=this.setLaFuncUsingObj)},o.prototype.preComputeLookaheadFunctions=function(e){var a=this;(0,c.forEach)(e,function(s){a.TRACE_INIT(s.name+" Rule Lookahead",function(){var e=(0,d.collectMethods)(s),t=e.alternation,r=e.repetition,n=e.option,i=e.repetitionMandatory,o=e.repetitionMandatoryWithSeparator,e=e.repetitionWithSeparator;(0,c.forEach)(t,function(r){var e=0===r.idx?"":r.idx;a.TRACE_INIT(""+(0,d.getProductionDslName)(r)+e,function(){var e=(0,l.buildLookaheadFuncForOr)(r.idx,s,r.maxLookahead||a.maxLookahead,r.hasPredicates,a.dynamicTokensEnabled,a.lookAheadBuilderForAlternatives),t=(0,u.getKeyForAutomaticLookahead)(a.fullRuleNameToShort[s.name],u.OR_IDX,r.idx);a.setLaFuncCache(t,e)})}),(0,c.forEach)(r,function(e){a.computeLookaheadFunc(s,e.idx,u.MANY_IDX,l.PROD_TYPE.REPETITION,e.maxLookahead,(0,d.getProductionDslName)(e))}),(0,c.forEach)(n,function(e){a.computeLookaheadFunc(s,e.idx,u.OPTION_IDX,l.PROD_TYPE.OPTION,e.maxLookahead,(0,d.getProductionDslName)(e))}),(0,c.forEach)(i,function(e){a.computeLookaheadFunc(s,e.idx,u.AT_LEAST_ONE_IDX,l.PROD_TYPE.REPETITION_MANDATORY,e.maxLookahead,(0,d.getProductionDslName)(e))}),(0,c.forEach)(o,function(e){a.computeLookaheadFunc(s,e.idx,u.AT_LEAST_ONE_SEP_IDX,l.PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR,e.maxLookahead,(0,d.getProductionDslName)(e))}),(0,c.forEach)(e,function(e){a.computeLookaheadFunc(s,e.idx,u.MANY_SEP_IDX,l.PROD_TYPE.REPETITION_WITH_SEPARATOR,e.maxLookahead,(0,d.getProductionDslName)(e))})})})},o.prototype.computeLookaheadFunc=function(r,n,i,o,s,e){var a=this;this.TRACE_INIT(""+e+(0===n?"":n),function(){var e=(0,l.buildLookaheadFuncForOptionalProd)(n,r,s||a.maxLookahead,a.dynamicTokensEnabled,o,a.lookAheadBuilderForOptional),t=(0,u.getKeyForAutomaticLookahead)(a.fullRuleNameToShort[r.name],i,n);a.setLaFuncCache(t,e)})},o.prototype.lookAheadBuilderForOptional=function(e,t,r){return(0,l.buildSingleAlternativeLookaheadFunction)(e,t,r)},o.prototype.lookAheadBuilderForAlternatives=function(e,t,r,n){return(0,l.buildAlternativesLookAheadFunc)(e,t,r,n)},o.prototype.getKeyForAutomaticLookahead=function(e,t){var r=this.getLastExplicitRuleShortName();return(0,u.getKeyForAutomaticLookahead)(r,e,t)},o.prototype.getLaFuncFromCache=function(e){},o.prototype.getLaFuncFromMap=function(e){return this.lookAheadFuncsCache.get(e)},o.prototype.getLaFuncFromObj=function(e){return this.lookAheadFuncsCache[e]},o.prototype.setLaFuncCache=function(e,t){},o.prototype.setLaFuncCacheUsingMap=function(e,t){this.lookAheadFuncsCache.set(e,t)},o.prototype.setLaFuncUsingObj=function(e,t){this.lookAheadFuncsCache[e]=t},o);function o(){}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{TreeBuilder:()=>l});var i=r(33),n=r(17),o=r(45),s=r(34),a=r(16),l=(c.prototype.initTreeBuilder=function(e){if(this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.outputCst=((0,n.has)(e,"outputCst")?e:a.DEFAULT_PARSER_CONFIG).outputCst,this.nodeLocationTracking=((0,n.has)(e,"nodeLocationTracking")?e:a.DEFAULT_PARSER_CONFIG).nodeLocationTracking,this.outputCst)if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=i.setNodeLocationFull,this.setNodeLocationFromNode=i.setNodeLocationFull,this.cstPostRule=n.NOOP,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=n.NOOP,this.setNodeLocationFromNode=n.NOOP,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=i.setNodeLocationOnlyOffset,this.setNodeLocationFromNode=i.setNodeLocationOnlyOffset,this.cstPostRule=n.NOOP,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=n.NOOP,this.setNodeLocationFromNode=n.NOOP,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else{if(!/none/i.test(this.nodeLocationTracking))throw Error('Invalid <nodeLocationTracking> config option: "'+e.nodeLocationTracking+'"');this.setNodeLocationFromToken=n.NOOP,this.setNodeLocationFromNode=n.NOOP,this.cstPostRule=n.NOOP,this.setInitialNodeLocation=n.NOOP}else this.cstInvocationStateUpdate=n.NOOP,this.cstFinallyStateUpdate=n.NOOP,this.cstPostTerminal=n.NOOP,this.cstPostNonTerminal=n.NOOP,this.cstPostRule=n.NOOP,this.getLastExplicitRuleShortName=this.getLastExplicitRuleShortNameNoCst,this.getPreviousExplicitRuleShortName=this.getPreviousExplicitRuleShortNameNoCst,this.getLastExplicitRuleOccurrenceIndex=this.getLastExplicitRuleOccurrenceIndexNoCst,this.manyInternal=this.manyInternalNoCst,this.orInternal=this.orInternalNoCst,this.optionInternal=this.optionInternalNoCst,this.atLeastOneInternal=this.atLeastOneInternalNoCst,this.manySepFirstInternal=this.manySepFirstInternalNoCst,this.atLeastOneSepFirstInternal=this.atLeastOneSepFirstInternalNoCst},c.prototype.setInitialNodeLocationOnlyOffsetRecovery=function(e){e.location={startOffset:NaN,endOffset:NaN}},c.prototype.setInitialNodeLocationOnlyOffsetRegular=function(e){e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}},c.prototype.setInitialNodeLocationFullRecovery=function(e){e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}},c.prototype.setInitialNodeLocationFullRegular=function(e){var t=this.LA(1);e.location={startOffset:t.startOffset,startLine:t.startLine,startColumn:t.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}},c.prototype.cstNestedInvocationStateUpdate=function(e,t){e={name:e,fullName:this.shortRuleNameToFull[this.getLastExplicitRuleShortName()]+e,children:{}};this.setInitialNodeLocation(e),this.CST_STACK.push(e)},c.prototype.cstInvocationStateUpdate=function(e,t){this.LAST_EXPLICIT_RULE_STACK.push(this.RULE_STACK.length-1);e={name:e,children:{}};this.setInitialNodeLocation(e),this.CST_STACK.push(e)},c.prototype.cstFinallyStateUpdate=function(){this.LAST_EXPLICIT_RULE_STACK.pop(),this.CST_STACK.pop()},c.prototype.cstNestedFinallyStateUpdate=function(){var e=this.CST_STACK.pop();this.cstPostRule(e)},c.prototype.cstPostRuleFull=function(e){var t=this.LA(0),e=e.location;e.startOffset<=t.startOffset==!0?(e.endOffset=t.endOffset,e.endLine=t.endLine,e.endColumn=t.endColumn):(e.startOffset=NaN,e.startLine=NaN,e.startColumn=NaN)},c.prototype.cstPostRuleOnlyOffset=function(e){var t=this.LA(0),e=e.location;e.startOffset<=t.startOffset==!0?e.endOffset=t.endOffset:e.startOffset=NaN},c.prototype.cstPostTerminal=function(e,t){var r=this.CST_STACK[this.CST_STACK.length-1];(0,i.addTerminalToCst)(r,t,e),this.setNodeLocationFromToken(r.location,t)},c.prototype.cstPostNonTerminal=function(e,t){var r;!0!==this.isBackTracking()&&(r=this.CST_STACK[this.CST_STACK.length-1],(0,i.addNoneTerminalToCst)(r,t,e),this.setNodeLocationFromNode(r.location,e.location))},c.prototype.getBaseCstVisitorConstructor=function(){var e;return(0,n.isUndefined)(this.baseCstVisitorConstructor)?(e=(0,o.createBaseSemanticVisitorConstructor)(this.className,this.allRuleNames),this.baseCstVisitorConstructor=e):this.baseCstVisitorConstructor},c.prototype.getBaseCstVisitorConstructorWithDefaults=function(){var e;return(0,n.isUndefined)(this.baseCstVisitorWithDefaultsConstructor)?(e=(0,o.createBaseVisitorConstructorWithDefaults)(this.className,this.allRuleNames,this.getBaseCstVisitorConstructor()),this.baseCstVisitorWithDefaultsConstructor=e):this.baseCstVisitorWithDefaultsConstructor},c.prototype.nestedRuleBeforeClause=function(e,t){if(void 0!==e.NAME)return e=e.NAME,this.nestedRuleInvocationStateUpdate(e,t),e},c.prototype.nestedAltBeforeClause=function(e,t,r,n){var i=this.getLastExplicitRuleShortName(),i=(0,s.getKeyForAltIndex)(i,r,t,n);if(void 0!==e.NAME)return r=e.NAME,this.nestedRuleInvocationStateUpdate(r,i),{shortName:i,nestedName:r}},c.prototype.nestedRuleFinallyClause=function(e,t){var r=this.CST_STACK,n=r[r.length-1],r=(this.nestedRuleFinallyStateUpdate(),r[r.length-1]);(0,i.addNoneTerminalToCst)(r,t,n),this.setNodeLocationFromNode(r.location,n.location)},c.prototype.getLastExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_STACK[e]},c.prototype.getLastExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-1]},c.prototype.getPreviousExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-2];return this.RULE_STACK[e]},c.prototype.getPreviousExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-2]},c.prototype.getLastExplicitRuleOccurrenceIndex=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_OCCURRENCE_STACK[e]},c.prototype.getLastExplicitRuleOccurrenceIndexNoCst=function(){var e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]},c.prototype.nestedRuleInvocationStateUpdate=function(e,t){this.RULE_OCCURRENCE_STACK.push(1),this.RULE_STACK.push(t),this.cstNestedInvocationStateUpdate(e,t)},c.prototype.nestedRuleFinallyStateUpdate=function(){this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstNestedFinallyStateUpdate()},c);function c(){}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{CstVisitorDefinitionError:()=>i,createBaseSemanticVisitorConstructor:()=>function(e,t){function r(){}return(0,o.defineNameProp)(r,e+"BaseSemantics"),((r.prototype={visit:function(e,t){if((0,c.isArray)(e)&&(e=e[0]),!(0,c.isUndefined)(e))return void 0!==e.fullName?this[e.fullName](e.children,t):this[e.name](e.children,t)},validateVisitor:function(){var e=n(this,t);if(!(0,c.isEmpty)(e))throw e=(0,c.map)(e,function(e){return e.msg}),Error("Errors Detected in CST Visitor <"+(0,o.functionName)(this.constructor)+">:\n\t"+e.join("\n\n").replace(/\n/g,"\n\t"))}}).constructor=r)._RULE_NAMES=t,r},createBaseVisitorConstructorWithDefaults:()=>function(e,t,r){function n(){}(0,o.defineNameProp)(n,e+"BaseSemanticsWithDefaults");var i=Object.create(r.prototype);return(0,c.forEach)(t,function(e){i[e]=a}),(n.prototype=i).constructor=n},defaultVisit:()=>a,validateMissingCstMethods:()=>l,validateRedundantMethods:()=>d,validateVisitor:()=>n});var i,c=r(17),o=r(46),s=r(36);function a(e,t){for(var r=(0,c.keys)(e),n=r.length,i=0;i<n;i++)for(var o=e[r[i]],s=o.length,a=0;a<s;a++){var l=o[a];void 0===l.tokenTypeIdx&&(void 0!==l.fullName?this[l.fullName](l.children,t):this[l.name](l.children,t))}}function n(e,t){var r=l(e,t),e=d(e,t);return r.concat(e)}function l(t,e){e=(0,c.map)(e,function(e){if(!(0,c.isFunction)(t[e]))return{msg:"Missing visitor method: <"+e+"> on "+(0,o.functionName)(t.constructor)+" CST Visitor.",type:i.MISSING_METHOD,methodName:e}});return(0,c.compact)(e)}(t=i=i||{})[t.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",t[t.MISSING_METHOD=1]="MISSING_METHOD";var u=["constructor","visit","validateVisitor"];function d(e,t){var r,n=[];for(r in e)s.validTermsPattern.test(r)&&(0,c.isFunction)(e[r])&&!(0,c.contains)(u,r)&&!(0,c.contains)(t,r)&&n.push({msg:"Redundant visitor method: <"+r+"> on "+(0,o.functionName)(e.constructor)+" CST Visitor\nThere is no Grammar Rule corresponding to this method's name.\nFor utility methods on visitor classes use methods names that do not match /"+s.validTermsPattern.source+"/.",type:i.REDUNDANT_METHOD,methodName:r});return n}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{classNameFromInstance:()=>function(e){return s(e.constructor)},defineNameProp:()=>function(e,t){var r=Object.getOwnPropertyDescriptor(e,o);if((0,n.isUndefined)(r)||r.configurable)return Object.defineProperty(e,o,{enumerable:!1,configurable:!0,writable:!1,value:t}),!0;return!1},functionName:()=>s});var n=r(17);var i=/^\s*function\s*(\S*)\s*\(/,o="name";function s(e){var t=e.name;return t||e.toString().match(i)[1]}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{LexerAdapter:()=>i});var n=r(16),i=(o.prototype.initLexerAdapter=function(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1},Object.defineProperty(o.prototype,"input",{get:function(){return this.tokVector},set:function(e){if(!0!==this.selfAnalysisDone)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=e,this.tokVectorLength=e.length},enumerable:!0,configurable:!0}),o.prototype.SKIP_TOKEN=function(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):n.END_OF_FILE},o.prototype.LA=function(e){e=this.currIdx+e;return e<0||this.tokVectorLength<=e?n.END_OF_FILE:this.tokVector[e]},o.prototype.consumeToken=function(){this.currIdx++},o.prototype.exportLexerState=function(){return this.currIdx},o.prototype.importLexerState=function(e){this.currIdx=e},o.prototype.resetLexerState=function(){this.currIdx=-1},o.prototype.moveToTerminatedState=function(){this.currIdx=this.tokVector.length-1},o.prototype.getLexerPosition=function(){return this.exportLexerState()},o);function o(){}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{RecognizerApi:()=>c});var i=r(17),n=r(42),o=r(16),s=r(35),a=r(36),l=r(20),c=(u.prototype.ACTION=function(e){return e.call(this)},u.prototype.consume=function(e,t,r){return this.consumeInternal(t,e,r)},u.prototype.subrule=function(e,t,r){return this.subruleInternal(t,e,r)},u.prototype.option=function(e,t){return this.optionInternal(t,e)},u.prototype.or=function(e,t){return this.orInternal(t,e)},u.prototype.many=function(e,t){return this.manyInternal(e,t)},u.prototype.atLeastOne=function(e,t){return this.atLeastOneInternal(e,t)},u.prototype.CONSUME=function(e,t){return this.consumeInternal(e,0,t)},u.prototype.CONSUME1=function(e,t){return this.consumeInternal(e,1,t)},u.prototype.CONSUME2=function(e,t){return this.consumeInternal(e,2,t)},u.prototype.CONSUME3=function(e,t){return this.consumeInternal(e,3,t)},u.prototype.CONSUME4=function(e,t){return this.consumeInternal(e,4,t)},u.prototype.CONSUME5=function(e,t){return this.consumeInternal(e,5,t)},u.prototype.CONSUME6=function(e,t){return this.consumeInternal(e,6,t)},u.prototype.CONSUME7=function(e,t){return this.consumeInternal(e,7,t)},u.prototype.CONSUME8=function(e,t){return this.consumeInternal(e,8,t)},u.prototype.CONSUME9=function(e,t){return this.consumeInternal(e,9,t)},u.prototype.SUBRULE=function(e,t){return this.subruleInternal(e,0,t)},u.prototype.SUBRULE1=function(e,t){return this.subruleInternal(e,1,t)},u.prototype.SUBRULE2=function(e,t){return this.subruleInternal(e,2,t)},u.prototype.SUBRULE3=function(e,t){return this.subruleInternal(e,3,t)},u.prototype.SUBRULE4=function(e,t){return this.subruleInternal(e,4,t)},u.prototype.SUBRULE5=function(e,t){return this.subruleInternal(e,5,t)},u.prototype.SUBRULE6=function(e,t){return this.subruleInternal(e,6,t)},u.prototype.SUBRULE7=function(e,t){return this.subruleInternal(e,7,t)},u.prototype.SUBRULE8=function(e,t){return this.subruleInternal(e,8,t)},u.prototype.SUBRULE9=function(e,t){return this.subruleInternal(e,9,t)},u.prototype.OPTION=function(e){return this.optionInternal(e,0)},u.prototype.OPTION1=function(e){return this.optionInternal(e,1)},u.prototype.OPTION2=function(e){return this.optionInternal(e,2)},u.prototype.OPTION3=function(e){return this.optionInternal(e,3)},u.prototype.OPTION4=function(e){return this.optionInternal(e,4)},u.prototype.OPTION5=function(e){return this.optionInternal(e,5)},u.prototype.OPTION6=function(e){return this.optionInternal(e,6)},u.prototype.OPTION7=function(e){return this.optionInternal(e,7)},u.prototype.OPTION8=function(e){return this.optionInternal(e,8)},u.prototype.OPTION9=function(e){return this.optionInternal(e,9)},u.prototype.OR=function(e){return this.orInternal(e,0)},u.prototype.OR1=function(e){return this.orInternal(e,1)},u.prototype.OR2=function(e){return this.orInternal(e,2)},u.prototype.OR3=function(e){return this.orInternal(e,3)},u.prototype.OR4=function(e){return this.orInternal(e,4)},u.prototype.OR5=function(e){return this.orInternal(e,5)},u.prototype.OR6=function(e){return this.orInternal(e,6)},u.prototype.OR7=function(e){return this.orInternal(e,7)},u.prototype.OR8=function(e){return this.orInternal(e,8)},u.prototype.OR9=function(e){return this.orInternal(e,9)},u.prototype.MANY=function(e){this.manyInternal(0,e)},u.prototype.MANY1=function(e){this.manyInternal(1,e)},u.prototype.MANY2=function(e){this.manyInternal(2,e)},u.prototype.MANY3=function(e){this.manyInternal(3,e)},u.prototype.MANY4=function(e){this.manyInternal(4,e)},u.prototype.MANY5=function(e){this.manyInternal(5,e)},u.prototype.MANY6=function(e){this.manyInternal(6,e)},u.prototype.MANY7=function(e){this.manyInternal(7,e)},u.prototype.MANY8=function(e){this.manyInternal(8,e)},u.prototype.MANY9=function(e){this.manyInternal(9,e)},u.prototype.MANY_SEP=function(e){this.manySepFirstInternal(0,e)},u.prototype.MANY_SEP1=function(e){this.manySepFirstInternal(1,e)},u.prototype.MANY_SEP2=function(e){this.manySepFirstInternal(2,e)},u.prototype.MANY_SEP3=function(e){this.manySepFirstInternal(3,e)},u.prototype.MANY_SEP4=function(e){this.manySepFirstInternal(4,e)},u.prototype.MANY_SEP5=function(e){this.manySepFirstInternal(5,e)},u.prototype.MANY_SEP6=function(e){this.manySepFirstInternal(6,e)},u.prototype.MANY_SEP7=function(e){this.manySepFirstInternal(7,e)},u.prototype.MANY_SEP8=function(e){this.manySepFirstInternal(8,e)},u.prototype.MANY_SEP9=function(e){this.manySepFirstInternal(9,e)},u.prototype.AT_LEAST_ONE=function(e){this.atLeastOneInternal(0,e)},u.prototype.AT_LEAST_ONE1=function(e){return this.atLeastOneInternal(1,e)},u.prototype.AT_LEAST_ONE2=function(e){this.atLeastOneInternal(2,e)},u.prototype.AT_LEAST_ONE3=function(e){this.atLeastOneInternal(3,e)},u.prototype.AT_LEAST_ONE4=function(e){this.atLeastOneInternal(4,e)},u.prototype.AT_LEAST_ONE5=function(e){this.atLeastOneInternal(5,e)},u.prototype.AT_LEAST_ONE6=function(e){this.atLeastOneInternal(6,e)},u.prototype.AT_LEAST_ONE7=function(e){this.atLeastOneInternal(7,e)},u.prototype.AT_LEAST_ONE8=function(e){this.atLeastOneInternal(8,e)},u.prototype.AT_LEAST_ONE9=function(e){this.atLeastOneInternal(9,e)},u.prototype.AT_LEAST_ONE_SEP=function(e){this.atLeastOneSepFirstInternal(0,e)},u.prototype.AT_LEAST_ONE_SEP1=function(e){this.atLeastOneSepFirstInternal(1,e)},u.prototype.AT_LEAST_ONE_SEP2=function(e){this.atLeastOneSepFirstInternal(2,e)},u.prototype.AT_LEAST_ONE_SEP3=function(e){this.atLeastOneSepFirstInternal(3,e)},u.prototype.AT_LEAST_ONE_SEP4=function(e){this.atLeastOneSepFirstInternal(4,e)},u.prototype.AT_LEAST_ONE_SEP5=function(e){this.atLeastOneSepFirstInternal(5,e)},u.prototype.AT_LEAST_ONE_SEP6=function(e){this.atLeastOneSepFirstInternal(6,e)},u.prototype.AT_LEAST_ONE_SEP7=function(e){this.atLeastOneSepFirstInternal(7,e)},u.prototype.AT_LEAST_ONE_SEP8=function(e){this.atLeastOneSepFirstInternal(8,e)},u.prototype.AT_LEAST_ONE_SEP9=function(e){this.atLeastOneSepFirstInternal(9,e)},u.prototype.RULE=function(e,t,r){void 0===r&&(r=o.DEFAULT_RULE_CONFIG),(0,i.contains)(this.definedRulesNames,e)&&(n={message:s.defaultGrammarValidatorErrorProvider.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className}),type:o.ParserDefinitionErrorType.DUPLICATE_RULE_NAME,ruleName:e},this.definitionErrors.push(n)),this.definedRulesNames.push(e);var n=this.defineRule(e,t,r);return this[e]=n},u.prototype.OVERRIDE_RULE=function(e,t,r){void 0===r&&(r=o.DEFAULT_RULE_CONFIG);var n=(n=[]).concat((0,a.validateRuleIsOverridden)(e,this.definedRulesNames,this.className)),n=(this.definitionErrors.push.apply(this.definitionErrors,n),this.defineRule(e,t,r));return this[e]=n},u.prototype.BACKTRACK=function(t,r){return function(){this.isBackTrackingStack.push(1);var e=this.saveRecogState();try{return t.apply(this,r),!0}catch(e){if((0,n.isRecognitionException)(e))return!1;throw e}finally{this.reloadRecogState(e),this.isBackTrackingStack.pop()}}},u.prototype.getGAstProductions=function(){return this.gastProductionsCache},u.prototype.getSerializedGastProductions=function(){return(0,l.serializeGrammar)((0,i.values)(this.gastProductionsCache))},u);function u(){}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{RecognizerEngine:()=>p});var l=r(17),c=r(34),s=r(42),u=r(37),d=r(38),a=r(16),n=r(41),i=r(21),o=r(27),h=r(46),p=(f.prototype.initRecognizerEngine=function(e,t){if(this.className=(0,h.classNameFromInstance)(this),this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=o.tokenStructuredMatcherNoCategories,this.definedRulesNames=[],this.tokensMap={},this.allRuleNames=[],this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},(0,l.has)(t,"serializedGrammar"))throw Error("The Parser's configuration can no longer contain a <serializedGrammar> property.\n\tSee: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_6-0-0\n\tFor Further details.");if((0,l.isArray)(e)){if((0,l.isEmpty)(e))throw Error("A Token Vocabulary cannot be empty.\n\tNote that the first argument for the parser constructor\n\tis no longer a Token vector (since v4.0).");if("number"==typeof e[0].startOffset)throw Error("The Parser constructor no longer accepts a token vector as the first argument.\n\tSee: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_4-0-0\n\tFor Further details.")}if((0,l.isArray)(e))this.tokensMap=(0,l.reduce)(e,function(e,t){return e[t.name]=t,e},{});else if((0,l.has)(e,"modes")&&(0,l.every)((0,l.flatten)((0,l.values)(e.modes)),o.isTokenType)){t=(0,l.flatten)((0,l.values)(e.modes)),t=(0,l.uniq)(t);this.tokensMap=(0,l.reduce)(t,function(e,t){return e[t.name]=t,e},{})}else{if(!(0,l.isObject)(e))throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap=(0,l.cloneObj)(e)}this.tokensMap.EOF=i.EOF;t=(0,l.every)((0,l.values)(e),function(e){return(0,l.isEmpty)(e.categoryMatches)});this.tokenMatcher=t?o.tokenStructuredMatcherNoCategories:o.tokenStructuredMatcher,(0,o.augmentTokenTypes)((0,l.values)(this.tokensMap))},f.prototype.defineRule=function(r,n,e){if(this.selfAnalysisDone)throw Error("Grammar rule <"+r+"> may not be defined after the 'performSelfAnalysis' method has been called'\nMake sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.");var i=((0,l.has)(e,"resyncEnabled")?e:a.DEFAULT_RULE_CONFIG).resyncEnabled,o=((0,l.has)(e,"recoveryValueFunc")?e:a.DEFAULT_RULE_CONFIG).recoveryValueFunc,s=this.ruleShortNameIdx<<c.BITS_FOR_METHOD_TYPE+c.BITS_FOR_OCCURRENCE_IDX;this.ruleShortNameIdx++,this.shortRuleNameToFull[s]=r,this.fullRuleNameToShort[r]=s;return(e=function(e,t){return this.ruleInvocationStateUpdate(s,r,e=void 0===e?0:e),function(e){try{var t;return!0===this.outputCst?(n.apply(this,e),t=this.CST_STACK[this.CST_STACK.length-1],this.cstPostRule(t),t):n.apply(this,e)}catch(e){return this.invokeRuleCatch(e,i,o)}finally{this.ruleFinallyStateUpdate()}}.call(this,t)}).ruleName=r,e.originalGrammarAction=n,e},f.prototype.invokeRuleCatch=function(e,t,r){var n=1===this.RULE_STACK.length,t=t&&!this.isBackTracking()&&this.recoveryEnabled;if((0,s.isRecognitionException)(e)){var i=e;if(t){var o,t=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(t))return i.resyncedTokens=this.reSyncTo(t),this.outputCst?((o=this.CST_STACK[this.CST_STACK.length-1]).recoveredNode=!0,o):r();this.outputCst&&((o=this.CST_STACK[this.CST_STACK.length-1]).recoveredNode=!0,i.partialCstResult=o)}else if(n)return this.moveToTerminatedState(),r();throw i}throw e},f.prototype.optionInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(c.OPTION_IDX,t),n=this.nestedRuleBeforeClause(e,r);try{return this.optionInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},f.prototype.optionInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(c.OPTION_IDX,t);return this.optionInternalLogic(e,t,r)},f.prototype.optionInternalLogic=function(e,t,r){var n,i,o,s=this,r=this.getLaFuncFromCache(r);if(void 0!==e.DEF?(i=e.DEF,void 0!==(o=e.GATE)&&(n=r,r=function(){return o.call(s)&&n.call(s)})):i=e,!0===r.call(this))return i.call(this)},f.prototype.atLeastOneInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(c.AT_LEAST_ONE_IDX,e),n=this.nestedRuleBeforeClause(t,r);try{return this.atLeastOneInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},f.prototype.atLeastOneInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(c.AT_LEAST_ONE_IDX,e);this.atLeastOneInternalLogic(e,t,r)},f.prototype.atLeastOneInternalLogic=function(e,t,r){var n,i,o,s=this,a=this.getLaFuncFromCache(r);if(void 0!==t.DEF?(i=t.DEF,void 0!==(o=t.GATE)&&(n=a,a=function(){return o.call(s)&&n.call(s)})):i=t,!0!==a.call(this))throw this.raiseEarlyExitException(e,u.PROD_TYPE.REPETITION_MANDATORY,t.ERR_MSG);for(var l=this.doSingleRepetition(i);!0===a.call(this)&&!0===l;)l=this.doSingleRepetition(i);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,t],a,c.AT_LEAST_ONE_IDX,e,d.NextTerminalAfterAtLeastOneWalker)},f.prototype.atLeastOneSepFirstInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(c.AT_LEAST_ONE_SEP_IDX,e),n=this.nestedRuleBeforeClause(t,r);try{this.atLeastOneSepFirstInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},f.prototype.atLeastOneSepFirstInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(c.AT_LEAST_ONE_SEP_IDX,e);this.atLeastOneSepFirstInternalLogic(e,t,r)},f.prototype.atLeastOneSepFirstInternalLogic=function(e,t,r){var n=this,i=t.DEF,o=t.SEP;if(!0!==this.getLaFuncFromCache(r).call(this))throw this.raiseEarlyExitException(e,u.PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR,t.ERR_MSG);i.call(this);for(r=function(){return n.tokenMatcher(n.LA(1),o)};!0===this.tokenMatcher(this.LA(1),o);)this.CONSUME(o),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,o,r,i,d.NextTerminalAfterAtLeastOneSepWalker],r,c.AT_LEAST_ONE_SEP_IDX,e,d.NextTerminalAfterAtLeastOneSepWalker)},f.prototype.manyInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(c.MANY_IDX,e),n=this.nestedRuleBeforeClause(t,r);try{return this.manyInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},f.prototype.manyInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(c.MANY_IDX,e);return this.manyInternalLogic(e,t,r)},f.prototype.manyInternalLogic=function(e,t,r){for(var n,i,o,s=this,a=this.getLaFuncFromCache(r),l=(void 0!==t.DEF?(i=t.DEF,void 0!==(o=t.GATE)&&(n=a,a=function(){return o.call(s)&&n.call(s)})):i=t,!0);!0===a.call(this)&&!0===l;)l=this.doSingleRepetition(i);this.attemptInRepetitionRecovery(this.manyInternal,[e,t],a,c.MANY_IDX,e,d.NextTerminalAfterManyWalker,l)},f.prototype.manySepFirstInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(c.MANY_SEP_IDX,e),n=this.nestedRuleBeforeClause(t,r);try{this.manySepFirstInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},f.prototype.manySepFirstInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(c.MANY_SEP_IDX,e);this.manySepFirstInternalLogic(e,t,r)},f.prototype.manySepFirstInternalLogic=function(e,t,r){var n=this,i=t.DEF,o=t.SEP;if(!0===this.getLaFuncFromCache(r).call(this)){i.call(this);for(t=function(){return n.tokenMatcher(n.LA(1),o)};!0===this.tokenMatcher(this.LA(1),o);)this.CONSUME(o),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,o,t,i,d.NextTerminalAfterManySepWalker],t,c.MANY_SEP_IDX,e,d.NextTerminalAfterManySepWalker)}},f.prototype.repetitionSepSecondInternal=function(e,t,r,n,i){for(;r();)this.CONSUME(t),n.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,t,r,n,i],r,c.AT_LEAST_ONE_SEP_IDX,e,i)},f.prototype.doSingleRepetition=function(e){var t=this.getLexerPosition();return e.call(this),t<this.getLexerPosition()},f.prototype.orInternalNoCst=function(e,t){var r=(0,l.isArray)(e)?e:e.DEF,n=this.getKeyForAutomaticLookahead(c.OR_IDX,t),n=this.getLaFuncFromCache(n).call(this,r);if(void 0!==n)return r[n].ALT.call(this);this.raiseNoAltException(t,e.ERR_MSG)},f.prototype.orInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(c.OR_IDX,t),n=this.nestedRuleBeforeClause(e,r);try{var i=(0,l.isArray)(e)?e:e.DEF,o=this.getLaFuncFromCache(r).call(this,i);if(void 0!==o){var s=i[o],a=this.nestedAltBeforeClause(s,t,c.OR_IDX,o);try{return s.ALT.call(this)}finally{void 0!==a&&this.nestedRuleFinallyClause(a.shortName,a.nestedName)}}this.raiseNoAltException(t,e.ERR_MSG)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},f.prototype.ruleFinallyStateUpdate=function(){var e,t;this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),0===this.RULE_STACK.length&&!1===this.isAtEndOfInput()&&(e=this.LA(1),t=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new s.NotAllInputParsedException(t,e)))},f.prototype.subruleInternal=function(t,e,r){try{var n=void 0!==r?r.ARGS:void 0,i=t.call(this,e,n);return this.cstPostNonTerminal(i,void 0!==r&&void 0!==r.LABEL?r.LABEL:t.ruleName),i}catch(e){this.subruleInternalError(e,r,t.ruleName)}},f.prototype.subruleInternalError=function(e,t,r){throw(0,s.isRecognitionException)(e)&&void 0!==e.partialCstResult&&(this.cstPostNonTerminal(e.partialCstResult,void 0!==t&&void 0!==t.LABEL?t.LABEL:r),delete e.partialCstResult),e},f.prototype.consumeInternal=function(t,r,e){var n;try{var i=this.LA(1);!0===this.tokenMatcher(i,t)?(this.consumeToken(),n=i):this.consumeInternalError(t,i,e)}catch(e){n=this.consumeInternalRecovery(t,r,e)}return this.cstPostTerminal(void 0!==e&&void 0!==e.LABEL?e.LABEL:t.name,n),n},f.prototype.consumeInternalError=function(e,t,r){var n=this.LA(0),r=void 0!==r&&r.ERR_MSG?r.ERR_MSG:this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:t,previous:n,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new s.MismatchedTokenException(r,t,n))},f.prototype.consumeInternalRecovery=function(e,t,r){if(!this.recoveryEnabled||"MismatchedTokenException"!==r.name||this.isBackTracking())throw r;t=this.getFollowsForInRuleRecovery(e,t);try{return this.tryInRuleRecovery(e,t)}catch(e){throw e.name===n.IN_RULE_RECOVERY_EXCEPTION?r:e}},f.prototype.saveRecogState=function(){var e=this.errors,t=(0,l.cloneArr)(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:t,CST_STACK:this.CST_STACK,LAST_EXPLICIT_RULE_STACK:this.LAST_EXPLICIT_RULE_STACK}},f.prototype.reloadRecogState=function(e){this.errors=e.errors,this.importLexerState(e.lexerState),this.RULE_STACK=e.RULE_STACK},f.prototype.ruleInvocationStateUpdate=function(e,t,r){this.RULE_OCCURRENCE_STACK.push(r),this.RULE_STACK.push(e),this.cstInvocationStateUpdate(t,e)},f.prototype.isBackTracking=function(){return 0!==this.isBackTrackingStack.length},f.prototype.getCurrRuleFullName=function(){var e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[e]},f.prototype.shortRuleNameToFullName=function(e){return this.shortRuleNameToFull[e]},f.prototype.isAtEndOfInput=function(){return this.tokenMatcher(this.LA(1),i.EOF)},f.prototype.reset=function(){this.resetLexerState(),this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]},f);function f(){}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{ErrorHandler:()=>o});var a=r(42),n=r(17),l=r(37),i=r(16),o=(s.prototype.initErrorHandler=function(e){this._errors=[],this.errorMessageProvider=(0,n.defaults)(e.errorMessageProvider,i.DEFAULT_PARSER_CONFIG.errorMessageProvider)},s.prototype.SAVE_ERROR=function(e){if((0,a.isRecognitionException)(e))return e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:(0,n.cloneArr)(this.RULE_OCCURRENCE_STACK)},this._errors.push(e),e;throw Error("Trying to save an Error which is not a RecognitionException")},Object.defineProperty(s.prototype,"errors",{get:function(){return(0,n.cloneArr)(this._errors)},set:function(e){this._errors=e},enumerable:!0,configurable:!0}),s.prototype.raiseEarlyExitException=function(e,t,r){for(var n=this.getCurrRuleFullName(),i=this.getGAstProductions()[n],e=(0,l.getLookaheadPathsForOptionalProd)(e,i,t,this.maxLookahead)[0],o=[],s=1;s<=this.maxLookahead;s++)o.push(this.LA(s));i=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:e,actual:o,previous:this.LA(0),customUserDescription:r,ruleName:n});throw this.SAVE_ERROR(new a.EarlyExitException(i,this.LA(1),this.LA(0)))},s.prototype.raiseNoAltException=function(e,t){for(var r=this.getCurrRuleFullName(),r=this.getGAstProductions()[r],e=(0,l.getLookaheadPathsForOr)(e,r,this.maxLookahead),n=[],i=1;i<=this.maxLookahead;i++)n.push(this.LA(i));r=this.LA(0),e=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:e,actual:n,previous:r,customUserDescription:t,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new a.NoViableAltException(e,this.LA(1),r))},s);function s(){}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{ContentAssist:()=>o});var n=r(38),i=r(17),o=(s.prototype.initContentAssist=function(){},s.prototype.computeContentAssist=function(e,t){var r=this.gastProductionsCache[e];if((0,i.isUndefined)(r))throw Error("Rule ->"+e+"<- does not exist in this grammar.");return(0,n.nextPossibleTokensAfter)([r],t,this.tokenMatcher,this.maxLookahead)},s.prototype.getNextPossibleTokenTypes=function(e){var t=(0,i.first)(e.ruleStack),t=this.getGAstProductions()[t];return new n.NextAfterTokenWalker(t,e).startWalking()},s);function s(){}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{GastRecorder:()=>h});var a=r(17),l=r(20),t=r(22),o=r(27),n=r(21),i=r(16),r=r(34),c={description:"This Object indicates the Parser is during Recording Phase"},s=(Object.freeze(c),Math.pow(2,r.BITS_FOR_OCCURRENCE_IDX)-1),r=(0,n.createToken)({name:"RECORDING_PHASE_TOKEN",pattern:t.Lexer.NA}),u=((0,o.augmentTokenTypes)([r]),(0,n.createTokenInstance)(r,"This IToken indicates the Parser is in Recording Phase\n\tSee: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details",-1,-1,-1,-1,-1,-1)),d=(Object.freeze(u),{name:"This CSTNode indicates the Parser is in Recording Phase\n\tSee: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details",children:{}}),h=(p.prototype.initGastRecorder=function(e){this.recordingProdStack=[],this.RECORDING_PHASE=!1},p.prototype.enableRecording=function(){var t=this;this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",function(){for(var e=0;e<10;e++)!function(r){var e=0<r?r:"";t["CONSUME"+e]=function(e,t){return this.consumeInternalRecord(e,r,t)},t["SUBRULE"+e]=function(e,t){return this.subruleInternalRecord(e,r,t)},t["OPTION"+e]=function(e){return this.optionInternalRecord(e,r)},t["OR"+e]=function(e){return this.orInternalRecord(e,r)},t["MANY"+e]=function(e){this.manyInternalRecord(r,e)},t["MANY_SEP"+e]=function(e){this.manySepFirstInternalRecord(r,e)},t["AT_LEAST_ONE"+e]=function(e){this.atLeastOneInternalRecord(r,e)},t["AT_LEAST_ONE_SEP"+e]=function(e){this.atLeastOneSepFirstInternalRecord(r,e)}}(e);t.consume=function(e,t,r){return this.consumeInternalRecord(t,e,r)},t.subrule=function(e,t,r){return this.subruleInternalRecord(t,e,r)},t.option=function(e,t){return this.optionInternalRecord(t,e)},t.or=function(e,t){return this.orInternalRecord(t,e)},t.many=function(e,t){this.manyInternalRecord(e,t)},t.atLeastOne=function(e,t){this.atLeastOneInternalRecord(e,t)},t.ACTION=t.ACTION_RECORD,t.BACKTRACK=t.BACKTRACK_RECORD,t.LA=t.LA_RECORD})},p.prototype.disableRecording=function(){var r=this;this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",function(){for(var e=0;e<10;e++){var t=0<e?e:"";delete r["CONSUME"+t],delete r["SUBRULE"+t],delete r["OPTION"+t],delete r["OR"+t],delete r["MANY"+t],delete r["MANY_SEP"+t],delete r["AT_LEAST_ONE"+t],delete r["AT_LEAST_ONE_SEP"+t]}delete r.consume,delete r.subrule,delete r.option,delete r.or,delete r.many,delete r.atLeastOne,delete r.ACTION,delete r.BACKTRACK,delete r.LA})},p.prototype.ACTION_RECORD=function(e){},p.prototype.BACKTRACK_RECORD=function(e,t){return function(){return!0}},p.prototype.LA_RECORD=function(e){return i.END_OF_FILE},p.prototype.topLevelRuleRecord=function(e,t){try{var r=new l.Rule({definition:[],name:e});return r.name=e,this.recordingProdStack.push(r),t.call(this),this.recordingProdStack.pop(),r}catch(e){if(!0!==e.KNOWN_RECORDER_ERROR)try{e.message=e.message+'\n\t This error was thrown during the "grammar recording phase" For more info see:\n\thttps://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording'}catch(e){}throw e}},p.prototype.optionInternalRecord=function(e,t){return f.call(this,l.Option,e,t)},p.prototype.atLeastOneInternalRecord=function(e,t){f.call(this,l.RepetitionMandatory,t,e)},p.prototype.atLeastOneSepFirstInternalRecord=function(e,t){f.call(this,l.RepetitionMandatoryWithSeparator,t,e,!0)},p.prototype.manyInternalRecord=function(e,t){f.call(this,l.Repetition,t,e)},p.prototype.manySepFirstInternalRecord=function(e,t){f.call(this,l.RepetitionWithSeparator,t,e,!0)},p.prototype.orInternalRecord=function(e,t){return function(e,t){var r=this,n=(m(t),(0,a.peek)(this.recordingProdStack)),i=!1===(0,a.isArray)(e),o=!1==i?e:e.DEF,s=new l.Alternation({definition:[],idx:t,ignoreAmbiguities:i&&!0===e.IGNORE_AMBIGUITIES});(0,a.has)(e,"NAME")&&(s.name=e.NAME);(0,a.has)(e,"MAX_LOOKAHEAD")&&(s.maxLookahead=e.MAX_LOOKAHEAD);t=(0,a.some)(o,function(e){return(0,a.isFunction)(e.GATE)});return s.hasPredicates=t,n.definition.push(s),(0,a.forEach)(o,function(e){var t=new l.Flat({definition:[]});s.definition.push(t),(0,a.has)(e,"NAME")&&(t.name=e.NAME),(0,a.has)(e,"IGNORE_AMBIGUITIES")?t.ignoreAmbiguities=e.IGNORE_AMBIGUITIES:(0,a.has)(e,"GATE")&&(t.ignoreAmbiguities=!0),r.recordingProdStack.push(t),e.ALT.call(r),r.recordingProdStack.pop()}),c}.call(this,e,t)},p.prototype.subruleInternalRecord=function(e,t,r){var n,i;if(m(t),e&&!1!==(0,a.has)(e,"ruleName"))return n=(0,a.peek)(this.recordingProdStack),i=e.ruleName,i=new l.NonTerminal({idx:t,nonTerminalName:i,referencedRule:void 0}),n.definition.push(i),this.outputCst?d:c;throw(n=new Error("<SUBRULE"+g(t)+"> argument is invalid expecting a Parser method reference but got: <"+JSON.stringify(e)+">\n inside top level rule: <"+this.recordingProdStack[0].name+">")).KNOWN_RECORDER_ERROR=!0,n},p.prototype.consumeInternalRecord=function(e,t,r){var n,i;if(m(t),(0,o.hasShortKeyProperty)(e))return n=(0,a.peek)(this.recordingProdStack),i=new l.Terminal({idx:t,terminalType:e}),n.definition.push(i),u;throw(n=new Error("<CONSUME"+g(t)+"> argument is invalid expecting a TokenType reference but got: <"+JSON.stringify(e)+">\n inside top level rule: <"+this.recordingProdStack[0].name+">")).KNOWN_RECORDER_ERROR=!0,n},p);function p(){}function f(e,t,r,n){void 0===n&&(n=!1),m(r);var i=(0,a.peek)(this.recordingProdStack),o=(0,a.isFunction)(t)?t:t.DEF,e=new e({definition:[],idx:r});return(0,a.has)(t,"NAME")&&(e.name=t.NAME),n&&(e.separator=t.SEP),(0,a.has)(t,"MAX_LOOKAHEAD")&&(e.maxLookahead=t.MAX_LOOKAHEAD),this.recordingProdStack.push(e),o.call(this),i.definition.push(e),this.recordingProdStack.pop(),c}function g(e){return 0===e?"":""+e}function m(e){if(e<0||s<e)throw(e=new Error("Invalid DSL Method idx value: <"+e+">\n\tIdx value must be a none negative value smaller than "+(s+1))).KNOWN_RECORDER_ERROR=!0,e}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{PerformanceTracer:()=>i});var s=r(17),n=r(16),i=(o.prototype.initPerformanceTracer=function(e){var t;(0,s.has)(e,"traceInitPerf")?(e=e.traceInitPerf,this.traceInitMaxIdent=(t="number"==typeof e)?e:1/0,this.traceInitPerf=t?0<e:e):(this.traceInitMaxIdent=0,this.traceInitPerf=n.DEFAULT_PARSER_CONFIG.traceInitPerf),this.traceInitIndent=-1},o.prototype.TRACE_INIT=function(e,t){var r,n,i,o;return!0===this.traceInitPerf?(this.traceInitIndent++,r=new Array(this.traceInitIndent+1).join("\t"),this.traceInitIndent<this.traceInitMaxIdent&&console.log(r+"--\x3e <"+e+">"),n=(i=(0,s.timer)(t)).time,i=i.value,o=10<n?console.warn:console.log,this.traceInitIndent<this.traceInitMaxIdent&&o(r+"<-- <"+e+"> time: "+n+"ms"),this.traceInitIndent--,i):t()},o);function o(){}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{createSyntaxDiagramsCode:()=>function(e,t){var t=void 0===t?{}:t,r=t.resourceBase,r=void 0===r?"https://unpkg.com/chevrotain@"+n.VERSION+"/diagrams/":r,t=t.css,t=void 0===t?"https://unpkg.com/chevrotain@"+n.VERSION+"/diagrams/diagrams.css":t,t="\n<link rel='stylesheet' href='"+t+"'>\n",r="\n<script src='"+r+"vendor/railroad-diagrams.js'><\/script>\n<script src='"+r+"src/diagrams_builder.js'><\/script>\n<script src='"+r+"src/diagrams_behavior.js'><\/script>\n<script src='"+r+"src/main.js'><\/script>\n",e="\n<script>\n    window.serializedGrammar = "+JSON.stringify(e,null,"  ")+";\n<\/script>\n";return'\n\x3c!-- This is a generated file --\x3e\n<!DOCTYPE html>\n<meta charset="utf-8">\n<style>\n  body {\n    background-color: hsl(30, 20%, 95%)\n  }\n</style>\n\n'+t+r+'\n<div id="diagrams" align="center"></div>    \n'+e+'\n<script>\n    var diagramsDiv = document.getElementById("diagrams");\n    main.drawDiagramsFromSerializedGrammar(serializedGrammar, diagramsDiv);\n<\/script>\n'}});var n=r(15)},(e,t,n)=>{"use strict";n.r(t),n.d(t,{generateParserFactory:()=>function(t){var e=(0,i.genWrapperFunction)({name:t.name,rules:t.rules}),r=new Function("tokenVocabulary","config","chevrotain",e);return function(e){return r(t.tokenVocabulary,e,n(14))}},generateParserModule:()=>function(e){return(0,i.genUmdModule)({name:e.name,rules:e.rules})}});var i=n(56)},(e,t,r)=>{"use strict";r.r(t),r.d(t,{genAllRules:()=>a,genAlternation:()=>d,genClass:()=>s,genNonTerminal:()=>u,genRule:()=>l,genSingleAlt:()=>h,genTerminal:()=>c,genUmdModule:()=>function(e){return"\n(function (root, factory) {\n    if (typeof define === 'function' && define.amd) {\n        // AMD. Register as an anonymous module.\n        define(['chevrotain'], factory);\n    } else if (typeof module === 'object' && module.exports) {\n        // Node. Does not work with strict CommonJS, but\n        // only CommonJS-like environments that support module.exports,\n        // like Node.\n        module.exports = factory(require('chevrotain'));\n    } else {\n        // Browser globals (root is window)\n        root.returnExports = factory(root.b);\n    }\n}(typeof self !== 'undefined' ? self : this, function (chevrotain) {\n\n"+s(e)+"\n    \nreturn {\n    "+e.name+": "+e.name+" \n}\n}));\n"},genWrapperFunction:()=>function(e){return"    \n"+s(e)+"\nreturn new "+e.name+"(tokenVocabulary, config)    \n"}});var n=r(17),i=r(20),o="\n";function s(e){return"\nfunction "+e.name+"(tokenVocabulary, config) {\n    // invoke super constructor\n    // No support for embedded actions currently, so we can 'hardcode'\n    // The use of CstParser.\n    chevrotain.CstParser.call(this, tokenVocabulary, config)\n\n    const $ = this\n\n    "+a(e.rules)+"\n\n    // very important to call this after all the rules have been defined.\n    // otherwise the parser may not work correctly as it will lack information\n    // derived during the self analysis phase.\n    this.performSelfAnalysis(this)\n}\n\n// inheritance as implemented in javascript in the previous decade... :(\n"+e.name+".prototype = Object.create(chevrotain.CstParser.prototype)\n"+e.name+".prototype.constructor = "+e.name+"    \n    "}function a(e){return(0,n.map)(e,function(e){return l(e,1)}).join("\n")}function l(e,t){var r=m(t,'$.RULE("'+e.name+'", function() {')+o;return(r+=g(e.definition,t+1))+(m(t+1,"})")+o)}function c(e,t){var r=e.terminalType.name;return m(t,"$.CONSUME"+e.idx+"(this.tokensMap."+r+")"+o)}function u(e,t){return m(t,"$.SUBRULE"+e.idx+"($."+e.nonTerminalName+")"+o)}function d(e,t){var r=m(t,"$.OR"+e.idx+"([")+o;return(r+=(0,n.map)(e.definition,function(e){return h(e,t+1)}).join(","+o))+(o+m(t,"])"+o))}function h(e,t){var r=m(t,"{")+o;return e.name&&(r+=m(t+1,'NAME: "'+e.name+'",')+o),r=(r=(r=(r+=m(t+1,"ALT: function() {")+o)+g(e.definition,t+1))+(m(t+1,"}")+o))+m(t,"}")}function p(e,t,r){e=m(r,"$."+(e+t.idx)+"(");return t.name||t.separator?(e+="{"+o,t.name&&(e+=m(r+1,'NAME: "'+t.name+'"')+","+o),t.separator&&(e+=m(r+1,"SEP: this.tokensMap."+t.separator.name)+","+o),e=(e+="DEF: "+f(t.definition,r+2)+o)+(m(r,"}")+o)):e+=f(t.definition,r+1),e+=m(r,")")+o}function f(e,t){var r="function() {"+o;return(r+=g(e,t))+(m(t,"}")+o)}function g(e,t){var r="";return(0,n.forEach)(e,function(e){r+=function(e,t){if(e instanceof i.NonTerminal)return u(e,t);if(e instanceof i.Option)return p("OPTION",e,t);if(e instanceof i.RepetitionMandatory)return p("AT_LEAST_ONE",e,t);if(e instanceof i.RepetitionMandatoryWithSeparator)return p("AT_LEAST_ONE_SEP",e,t);if(e instanceof i.RepetitionWithSeparator)return p("MANY_SEP",e,t);if(e instanceof i.Repetition)return p("MANY",e,t);if(e instanceof i.Alternation)return d(e,t);if(e instanceof i.Terminal)return c(e,t);if(e instanceof i.Flat)return g(e.definition,t);throw Error("non exhaustive match")}(e,t+1)}),r}function m(e,t){return Array(4*e+1).join(" ")+t}},(L,e,t)=>{"use strict";t.r(e),t.d(e,{AstNodeType:()=>o,ParsingErrorType:()=>r,RangeSheetReferenceType:()=>n,buildArrayAst:()=>O,buildCellErrorAst:()=>k,buildCellRangeAst:()=>d,buildCellReferenceAst:()=>u,buildColumnRangeAst:()=>h,buildConcatenateOpAst:()=>f,buildDivOpAst:()=>S,buildEmptyArgAst:()=>a,buildEqualsOpAst:()=>g,buildErrorWithRawInputAst:()=>D,buildGreaterThanOpAst:()=>y,buildGreaterThanOrEqualOpAst:()=>b,buildLessThanOpAst:()=>v,buildLessThanOrEqualOpAst:()=>w,buildMinusOpAst:()=>E,buildMinusUnaryOpAst:()=>x,buildNamedExpressionAst:()=>I,buildNotEqualOpAst:()=>m,buildNumberAst:()=>l,buildParenthesisAst:()=>M,buildParsingErrorAst:()=>F,buildPercentOpAst:()=>A,buildPlusOpAst:()=>C,buildPlusUnaryOpAst:()=>R,buildPowerOpAst:()=>_,buildProcedureAst:()=>N,buildRowRangeAst:()=>p,buildStringAst:()=>c,buildTimesOpAst:()=>T,imageWithWhitespace:()=>function(e,t){return(null!=t?t:"")+e},parsingError:()=>s});var r,o,n,i=t(3);const s=(e,t)=>({type:e,message:t}),a=((e=r=r||{}).LexingError="LexingError",e.ParserError="ParsingError",e.StaticOffsetError="StaticOffsetError",e.StaticOffsetOutOfRangeError="StaticOffsetOutOfRangeError",e.RangeOffsetNotAllowed="RangeOffsetNotAllowed",e.InvalidRangeSize="InvalidRangeSize",(t=o=o||{}).EMPTY="EMPTY",t.NUMBER="NUMBER",t.STRING="STRING",t.MINUS_UNARY_OP="MINUS_UNARY_OP",t.PLUS_UNARY_OP="PLUS_UNARY_OP",t.PERCENT_OP="PERCENT_OP",t.CONCATENATE_OP="CONCATENATE_OP",t.EQUALS_OP="EQUALS_OP",t.NOT_EQUAL_OP="NOT_EQUAL_OP",t.GREATER_THAN_OP="GREATER_THAN_OP",t.LESS_THAN_OP="LESS_THAN_OP",t.GREATER_THAN_OR_EQUAL_OP="GREATER_THAN_OR_EQUAL_OP",t.LESS_THAN_OR_EQUAL_OP="LESS_THAN_OR_EQUAL_OP",t.PLUS_OP="PLUS_OP",t.MINUS_OP="MINUS_OP",t.TIMES_OP="TIMES_OP",t.DIV_OP="DIV_OP",t.POWER_OP="POWER_OP",t.FUNCTION_CALL="FUNCTION_CALL",t.NAMED_EXPRESSION="NAMED_EXPRESSION",t.PARENTHESIS="PARENTHESES",t.CELL_REFERENCE="CELL_REFERENCE",t.CELL_RANGE="CELL_RANGE",t.COLUMN_RANGE="COLUMN_RANGE",t.ROW_RANGE="ROW_RANGE",t.ERROR="ERROR",t.ERROR_WITH_RAW_INPUT="ERROR_WITH_RAW_INPUT",t.ARRAY="ARRAY",(e=n=n||{})[e.RELATIVE=0]="RELATIVE",e[e.START_ABSOLUTE=1]="START_ABSOLUTE",e[e.BOTH_ABSOLUTE=2]="BOTH_ABSOLUTE",e=>({type:o.EMPTY,leadingWhitespace:null==e?void 0:e.image})),l=(e,t)=>({type:o.NUMBER,value:e,leadingWhitespace:null==t?void 0:t.image}),c=e=>{return{type:o.STRING,value:e.image.slice(1,-1),leadingWhitespace:null==(e=e.leadingWhitespace)?void 0:e.image}},u=(e,t)=>({type:o.CELL_REFERENCE,reference:e,leadingWhitespace:null==t?void 0:t.image}),d=(e,t,r,n)=>(P(e,t,r),{type:o.CELL_RANGE,start:e,end:t,sheetReferenceType:r,leadingWhitespace:n}),h=(e,t,r,n)=>(P(e,t,r),{type:o.COLUMN_RANGE,start:e,end:t,sheetReferenceType:r,leadingWhitespace:null==n?void 0:n.image}),p=(e,t,r,n)=>(P(e,t,r),{type:o.ROW_RANGE,start:e,end:t,sheetReferenceType:r,leadingWhitespace:null==n?void 0:n.image}),f=(e,t,r)=>({type:o.CONCATENATE_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}),g=(e,t,r)=>({type:o.EQUALS_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}),m=(e,t,r)=>({type:o.NOT_EQUAL_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}),y=(e,t,r)=>({type:o.GREATER_THAN_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}),v=(e,t,r)=>({type:o.LESS_THAN_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}),b=(e,t,r)=>({type:o.GREATER_THAN_OR_EQUAL_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}),w=(e,t,r)=>({type:o.LESS_THAN_OR_EQUAL_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}),C=(e,t,r)=>({type:o.PLUS_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}),E=(e,t,r)=>({type:o.MINUS_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}),T=(e,t,r)=>({type:o.TIMES_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}),S=(e,t,r)=>({type:o.DIV_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}),_=(e,t,r)=>({type:o.POWER_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}),x=(e,t)=>({type:o.MINUS_UNARY_OP,value:e,leadingWhitespace:null==t?void 0:t.image}),R=(e,t)=>({type:o.PLUS_UNARY_OP,value:e,leadingWhitespace:null==t?void 0:t.image}),A=(e,t)=>({type:o.PERCENT_OP,value:e,leadingWhitespace:null==t?void 0:t.image}),N=(e,t,r,n,i)=>({type:o.FUNCTION_CALL,procedureName:e,args:t,leadingWhitespace:null==r?void 0:r.image,internalWhitespace:null==n?void 0:n.image,hyperlink:i}),O=(e,t,r)=>({type:o.ARRAY,args:e,leadingWhitespace:null==t?void 0:t.image,internalWhitespace:null==r?void 0:r.image}),I=(e,t)=>({type:o.NAMED_EXPRESSION,expressionName:e,leadingWhitespace:null==t?void 0:t.image}),M=(e,t,r)=>({type:o.PARENTHESIS,expression:e,leadingWhitespace:null==t?void 0:t.image,internalWhitespace:null==r?void 0:r.image}),k=(e,t)=>({type:o.ERROR,error:e,leadingWhitespace:null==t?void 0:t.image}),D=(e,t,r)=>({type:o.ERROR_WITH_RAW_INPUT,error:t,rawInput:e,leadingWhitespace:null==r?void 0:r.image}),F=()=>({type:o.ERROR,error:i.CellError.parsingError()});function P(e,t,r){if(void 0!==e.sheet&&void 0===t.sheet||void 0===e.sheet&&void 0!==t.sheet)throw new Error("Start address inconsistent with end address");if(void 0===e.sheet&&r!==n.RELATIVE||void 0!==e.sheet&&r===n.RELATIVE)throw new Error("Sheet address inconsistent with sheet reference type")}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{binaryOpTokenMap:()=>n});t=r(57);const n={[t.AstNodeType.PLUS_OP]:"+",[t.AstNodeType.MINUS_OP]:"-",[t.AstNodeType.TIMES_OP]:"*",[t.AstNodeType.DIV_OP]:"/",[t.AstNodeType.CONCATENATE_OP]:"&",[t.AstNodeType.POWER_OP]:"^",[t.AstNodeType.EQUALS_OP]:"=",[t.AstNodeType.NOT_EQUAL_OP]:"<>",[t.AstNodeType.GREATER_THAN_OP]:">",[t.AstNodeType.GREATER_THAN_OR_EQUAL_OP]:">=",[t.AstNodeType.LESS_THAN_OP]:"<",[t.AstNodeType.LESS_THAN_OR_EQUAL_OP]:"<="}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{Cache:()=>i,doesContainFunctions:()=>o});var n=r(7);class i{constructor(e){this.functionRegistry=e,this.cache=new Map}set(e,t){t={ast:t,relativeDependencies:(0,n.collectDependencies)(t,this.functionRegistry),hasVolatileFunction:o(t,this.functionRegistry.isFunctionVolatile),hasStructuralChangeFunction:o(t,this.functionRegistry.isFunctionDependentOnSheetStructureChange)};return this.cache.set(e,t),t}get(e){return this.cache.get(e)}maybeSetAndThenGet(e,t){var r=this.cache.get(e);return void 0!==r?r.ast:(this.set(e,t),t)}}const o=(e,t)=>{switch(e.type){case n.AstNodeType.EMPTY:case n.AstNodeType.NUMBER:case n.AstNodeType.STRING:case n.AstNodeType.ERROR:case n.AstNodeType.ERROR_WITH_RAW_INPUT:case n.AstNodeType.CELL_REFERENCE:case n.AstNodeType.CELL_RANGE:case n.AstNodeType.COLUMN_RANGE:case n.AstNodeType.ROW_RANGE:case n.AstNodeType.NAMED_EXPRESSION:return!1;case n.AstNodeType.PERCENT_OP:case n.AstNodeType.PLUS_UNARY_OP:case n.AstNodeType.MINUS_UNARY_OP:return o(e.value,t);case n.AstNodeType.CONCATENATE_OP:case n.AstNodeType.EQUALS_OP:case n.AstNodeType.NOT_EQUAL_OP:case n.AstNodeType.LESS_THAN_OP:case n.AstNodeType.GREATER_THAN_OP:case n.AstNodeType.LESS_THAN_OR_EQUAL_OP:case n.AstNodeType.GREATER_THAN_OR_EQUAL_OP:case n.AstNodeType.MINUS_OP:case n.AstNodeType.PLUS_OP:case n.AstNodeType.TIMES_OP:case n.AstNodeType.DIV_OP:case n.AstNodeType.POWER_OP:return o(e.left,t)||o(e.right,t);case n.AstNodeType.PARENTHESIS:return o(e.expression,t);case n.AstNodeType.FUNCTION_CALL:return!!t(e.procedureName)||e.args.some(e=>o(e,t));case n.AstNodeType.ARRAY:return e.args.some(e=>e.some(e=>o(e,t)))}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{FormulaLexer:()=>i,FormulaParser:()=>l});var n=r(14),c=r(3),u=r(61),s=r(8),d=r(57),h=r(9),a=r(62);class l extends n.EmbeddedActionsParser{constructor(e,t){super(e.allTokens,{outputCst:!1,maxLookahead:7}),this.booleanExpressionOrEmpty=this.RULE("booleanExpressionOrEmpty",()=>this.OR([{ALT:()=>this.SUBRULE(this.booleanExpression)},{ALT:(0,n.EMPTY_ALT)((0,d.buildEmptyArgAst)())}])),this.procedureExpression=this.RULE("procedureExpression",()=>{var e=this.CONSUME(a.ProcedureName),t=e.image.toUpperCase().slice(0,-1),r=null!=(r=this.lexerConfig.functionMapping[t])?r:t;const n=[];let i=this.SUBRULE(this.booleanExpressionOrEmpty);this.MANY(()=>{var e=this.CONSUME(this.lexerConfig.ArgSeparator);i.type===d.AstNodeType.EMPTY&&(i.leadingWhitespace=null==(e=e.leadingWhitespace)?void 0:e.image),n.push(i),i=this.SUBRULE2(this.booleanExpressionOrEmpty)}),n.push(i),1===n.length&&n[0].type===d.AstNodeType.EMPTY&&(n.length=0);t=this.CONSUME(a.RParen);return(0,d.buildProcedureAst)(r,n,e.leadingWhitespace,t.leadingWhitespace)}),this.namedExpressionExpression=this.RULE("namedExpressionExpression",()=>{var e=this.CONSUME(a.NamedExpression);return(0,d.buildNamedExpressionAst)(e.image,e.leadingWhitespace)}),this.offsetProcedureExpression=this.RULE("offsetProcedureExpression",()=>{const e=[];return this.CONSUME(this.lexerConfig.OffsetProcedureName),this.CONSUME(a.LParen),this.MANY_SEP({SEP:this.lexerConfig.ArgSeparator,DEF:()=>{e.push(this.SUBRULE(this.booleanExpression))}}),this.CONSUME(a.RParen),this.handleOffsetHeuristic(e)}),this.columnRangeExpression=this.RULE("columnRangeExpression",()=>{var e=this.CONSUME(a.ColumnRange);const[t,r]=e.image.split(":");var n,i=this.ACTION(()=>(0,s.columnAddressFromString)(this.sheetMapping,t,this.formulaAddress)),o=this.ACTION(()=>(0,s.columnAddressFromString)(this.sheetMapping,r,this.formulaAddress));return void 0===i||void 0===o?(0,d.buildCellErrorAst)(new c.CellError(c.ErrorType.REF)):i.exceedsSheetSizeLimits(this.lexerConfig.maxColumns)||o.exceedsSheetSizeLimits(this.lexerConfig.maxColumns)?(0,d.buildErrorWithRawInputAst)(e.image,new c.CellError(c.ErrorType.NAME),e.leadingWhitespace):void 0===i.sheet&&void 0!==o.sheet?this.parsingError(d.ParsingErrorType.ParserError,"Malformed range expression"):({firstEnd:i,secondEnd:o,sheetRefType:n}=l.fixSheetIdsForRangeEnds(i,o),(0,d.buildColumnRangeAst)(i,o,n,e.leadingWhitespace))}),this.rowRangeExpression=this.RULE("rowRangeExpression",()=>{var e=this.CONSUME(a.RowRange);const[t,r]=e.image.split(":");var n,i=this.ACTION(()=>(0,s.rowAddressFromString)(this.sheetMapping,t,this.formulaAddress)),o=this.ACTION(()=>(0,s.rowAddressFromString)(this.sheetMapping,r,this.formulaAddress));return void 0===i||void 0===o?(0,d.buildCellErrorAst)(new c.CellError(c.ErrorType.REF)):i.exceedsSheetSizeLimits(this.lexerConfig.maxRows)||o.exceedsSheetSizeLimits(this.lexerConfig.maxRows)?(0,d.buildErrorWithRawInputAst)(e.image,new c.CellError(c.ErrorType.NAME),e.leadingWhitespace):void 0===i.sheet&&void 0!==o.sheet?this.parsingError(d.ParsingErrorType.ParserError,"Malformed range expression"):({firstEnd:i,secondEnd:o,sheetRefType:n}=l.fixSheetIdsForRangeEnds(i,o),(0,d.buildRowRangeAst)(i,o,n,e.leadingWhitespace))}),this.cellReference=this.RULE("cellReference",()=>{const e=this.CONSUME(a.CellReference);var t=this.ACTION(()=>(0,s.cellAddressFromString)(this.sheetMapping,e.image,this.formulaAddress));return void 0===t?(0,d.buildErrorWithRawInputAst)(e.image,new c.CellError(c.ErrorType.REF),e.leadingWhitespace):t.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)?(0,d.buildErrorWithRawInputAst)(e.image,new c.CellError(c.ErrorType.NAME),e.leadingWhitespace):(0,d.buildCellReferenceAst)(t,e.leadingWhitespace)}),this.endRangeReference=this.RULE("endRangeReference",e=>{const t=this.CONSUME(a.CellReference);var r=this.ACTION(()=>(0,s.cellAddressFromString)(this.sheetMapping,e.image,this.formulaAddress)),n=this.ACTION(()=>(0,s.cellAddressFromString)(this.sheetMapping,t.image,this.formulaAddress));return void 0===r||void 0===n?this.ACTION(()=>(0,d.buildErrorWithRawInputAst)(e.image+":"+t.image,new c.CellError(c.ErrorType.REF),e.leadingWhitespace)):r.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)||n.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)?this.ACTION(()=>(0,d.buildErrorWithRawInputAst)(e.image+":"+t.image,new c.CellError(c.ErrorType.NAME),e.leadingWhitespace)):this.buildCellRange(r,n,null==(r=e.leadingWhitespace)?void 0:r.image)}),this.endOfRangeExpression=this.RULE("endOfRangeExpression",r=>this.OR([{ALT:()=>this.SUBRULE(this.endRangeReference,{ARGS:[r]})},{ALT:()=>{var e=this.SUBRULE(this.offsetProcedureExpression),t=this.ACTION(()=>(0,s.cellAddressFromString)(this.sheetMapping,r.image,this.formulaAddress));return void 0===t?(0,d.buildCellErrorAst)(new c.CellError(c.ErrorType.REF)):e.type===d.AstNodeType.CELL_REFERENCE?this.buildCellRange(t,e.reference,null==(t=r.leadingWhitespace)?void 0:t.image):this.parsingError(d.ParsingErrorType.RangeOffsetNotAllowed,"Range offset not allowed here")}}])),this.cellRangeExpression=this.RULE("cellRangeExpression",()=>{var e=this.CONSUME(a.CellReference);return this.CONSUME2(a.RangeSeparator),this.SUBRULE(this.endOfRangeExpression,{ARGS:[e]})}),this.endRangeWithOffsetStartReference=this.RULE("endRangeWithOffsetStartReference",e=>{const t=this.CONSUME(a.CellReference);var r=this.ACTION(()=>(0,s.cellAddressFromString)(this.sheetMapping,t.image,this.formulaAddress));return void 0===r?this.ACTION(()=>(0,d.buildCellErrorAst)(new c.CellError(c.ErrorType.REF))):this.buildCellRange(e.reference,r,e.leadingWhitespace)}),this.endOfRangeWithOffsetStartExpression=this.RULE("endOfRangeWithOffsetStartExpression",t=>this.OR([{ALT:()=>this.SUBRULE(this.endRangeWithOffsetStartReference,{ARGS:[t]})},{ALT:()=>{var e=this.SUBRULE(this.offsetProcedureExpression);return e.type===d.AstNodeType.CELL_REFERENCE?this.buildCellRange(t.reference,e.reference,t.leadingWhitespace):this.parsingError(d.ParsingErrorType.RangeOffsetNotAllowed,"Range offset not allowed here")}}])),this.offsetExpression=this.RULE("offsetExpression",()=>{const e=this.SUBRULE(this.offsetProcedureExpression);let t;return this.OPTION(()=>{this.CONSUME(a.RangeSeparator),t=e.type===d.AstNodeType.CELL_RANGE?this.parsingError(d.ParsingErrorType.RangeOffsetNotAllowed,"Range offset not allowed here"):this.SUBRULE(this.endOfRangeWithOffsetStartExpression,{ARGS:[e]})}),void 0!==t?t:e}),this.insideArrayExpression=this.RULE("insideArrayExpression",()=>{const e=[[]];return e[e.length-1].push(this.SUBRULE(this.booleanExpression)),this.MANY(()=>{this.OR([{ALT:()=>{this.CONSUME(this.lexerConfig.ArrayColSeparator),e[e.length-1].push(this.SUBRULE2(this.booleanExpression))}},{ALT:()=>{this.CONSUME(this.lexerConfig.ArrayRowSeparator),e.push([]),e[e.length-1].push(this.SUBRULE3(this.booleanExpression))}}])}),(0,d.buildArrayAst)(e)}),this.parenthesisExpression=this.RULE("parenthesisExpression",()=>{var e=this.CONSUME(a.LParen),t=this.SUBRULE(this.booleanExpression),r=this.CONSUME(a.RParen);return(0,d.buildParenthesisAst)(t,e.leadingWhitespace,r.leadingWhitespace)}),this.arrayExpression=this.RULE("arrayExpression",()=>this.OR([{ALT:()=>{var e=this.CONSUME(a.ArrayLParen),t=this.SUBRULE(this.insideArrayExpression),r=this.CONSUME(a.ArrayRParen);return(0,d.buildArrayAst)(t.args,e.leadingWhitespace,r.leadingWhitespace)}},{ALT:()=>this.SUBRULE(this.parenthesisExpression)}])),this.numericStringToNumber=e=>{e=e.replace(this.lexerConfig.decimalSeparator,".");return Number(e)},this.positiveAtomicExpression=this.RULE("positiveAtomicExpression",()=>{var e;return this.OR(null!=(e=this.atomicExpCache)?e:this.atomicExpCache=[{ALT:()=>this.SUBRULE(this.arrayExpression)},{ALT:()=>this.SUBRULE(this.cellRangeExpression)},{ALT:()=>this.SUBRULE(this.columnRangeExpression)},{ALT:()=>this.SUBRULE(this.rowRangeExpression)},{ALT:()=>this.SUBRULE(this.offsetExpression)},{ALT:()=>this.SUBRULE(this.cellReference)},{ALT:()=>this.SUBRULE(this.procedureExpression)},{ALT:()=>this.SUBRULE(this.namedExpressionExpression)},{ALT:()=>{var e=this.CONSUME(this.lexerConfig.NumberLiteral);return(0,d.buildNumberAst)(this.numericStringToNumber(e.image),e.leadingWhitespace)}},{ALT:()=>{var e=this.CONSUME(a.StringLiteral);return(0,d.buildStringAst)(e)}},{ALT:()=>{var e=this.CONSUME(a.ErrorLiteral),t=e.image.toUpperCase(),t=this.lexerConfig.errorMapping[t];return t?(0,d.buildCellErrorAst)(new c.CellError(t),e.leadingWhitespace):this.parsingError(d.ParsingErrorType.ParserError,"Unknown error literal")}}])}),this.rightUnaryOpAtomicExpression=this.RULE("rightUnaryOpAtomicExpression",()=>{var e=this.SUBRULE(this.positiveAtomicExpression),t=this.OPTION(()=>this.CONSUME(a.PercentOp));return t?(0,d.buildPercentOpAst)(e,t.leadingWhitespace):e}),this.atomicExpression=this.RULE("atomicExpression",()=>this.OR([{ALT:()=>{var e=this.CONSUME(a.AdditionOp),t=this.SUBRULE(this.atomicExpression);return(0,n.tokenMatcher)(e,a.PlusOp)?(0,d.buildPlusUnaryOpAst)(t,e.leadingWhitespace):(0,n.tokenMatcher)(e,a.MinusOp)?(0,d.buildMinusUnaryOpAst)(t,e.leadingWhitespace):(this.customParsingError=(0,d.parsingError)(d.ParsingErrorType.ParserError,"Mismatched token type"),this.customParsingError)}},{ALT:()=>this.SUBRULE2(this.rightUnaryOpAtomicExpression)}])),this.powerExpression=this.RULE("powerExpression",()=>{let r=this.SUBRULE(this.atomicExpression);return this.MANY(()=>{var e=this.CONSUME(a.PowerOp),t=this.SUBRULE2(this.atomicExpression);(0,n.tokenMatcher)(e,a.PowerOp)?r=(0,d.buildPowerOpAst)(r,t,e.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),r}),this.multiplicationExpression=this.RULE("multiplicationExpression",()=>{let r=this.SUBRULE(this.powerExpression);return this.MANY(()=>{var e=this.CONSUME(a.MultiplicationOp),t=this.SUBRULE2(this.powerExpression);(0,n.tokenMatcher)(e,a.TimesOp)?r=(0,d.buildTimesOpAst)(r,t,e.leadingWhitespace):(0,n.tokenMatcher)(e,a.DivOp)?r=(0,d.buildDivOpAst)(r,t,e.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),r}),this.additionExpression=this.RULE("additionExpression",()=>{let r=this.SUBRULE(this.multiplicationExpression);return this.MANY(()=>{var e=this.CONSUME(a.AdditionOp),t=this.SUBRULE2(this.multiplicationExpression);(0,n.tokenMatcher)(e,a.PlusOp)?r=(0,d.buildPlusOpAst)(r,t,e.leadingWhitespace):(0,n.tokenMatcher)(e,a.MinusOp)?r=(0,d.buildMinusOpAst)(r,t,e.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),r}),this.concatenateExpression=this.RULE("concatenateExpression",()=>{let r=this.SUBRULE(this.additionExpression);return this.MANY(()=>{var e=this.CONSUME(a.ConcatenateOp),t=this.SUBRULE2(this.additionExpression);r=(0,d.buildConcatenateOpAst)(r,t,e.leadingWhitespace)}),r}),this.booleanExpression=this.RULE("booleanExpression",()=>{let r=this.SUBRULE(this.concatenateExpression);return this.MANY(()=>{var e=this.CONSUME(a.BooleanOp),t=this.SUBRULE2(this.concatenateExpression);(0,n.tokenMatcher)(e,a.EqualsOp)?r=(0,d.buildEqualsOpAst)(r,t,e.leadingWhitespace):(0,n.tokenMatcher)(e,a.NotEqualOp)?r=(0,d.buildNotEqualOpAst)(r,t,e.leadingWhitespace):(0,n.tokenMatcher)(e,a.GreaterThanOp)?r=(0,d.buildGreaterThanOpAst)(r,t,e.leadingWhitespace):(0,n.tokenMatcher)(e,a.LessThanOp)?r=(0,d.buildLessThanOpAst)(r,t,e.leadingWhitespace):(0,n.tokenMatcher)(e,a.GreaterThanOrEqualOp)?r=(0,d.buildGreaterThanOrEqualOpAst)(r,t,e.leadingWhitespace):(0,n.tokenMatcher)(e,a.LessThanOrEqualOp)?r=(0,d.buildLessThanOrEqualOpAst)(r,t,e.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),r}),this.formula=this.RULE("formula",()=>(this.CONSUME(a.EqualsOp),this.SUBRULE(this.booleanExpression))),this.lexerConfig=e,this.sheetMapping=t,this.formulaAddress=(0,c.simpleCellAddress)(0,0,0),this.performSelfAnalysis()}parseFromTokens(e,t){this.input=e;let r=this.formulaWithContext(t),n=[];return this.customParsingError&&n.push(this.customParsingError),n=n.concat(this.errors.map(e=>({type:d.ParsingErrorType.ParserError,message:e.message}))),{ast:r=0<n.length?(0,d.buildParsingErrorAst)():r,errors:n}}reset(){super.reset(),this.customParsingError=void 0}formulaWithContext(e){return this.formulaAddress=e,this.formula()}buildCellRange(e,t,r){var n;return void 0===e.sheet&&void 0!==t.sheet?this.parsingError(d.ParsingErrorType.ParserError,"Malformed range expression"):({firstEnd:e,secondEnd:t,sheetRefType:n}=l.fixSheetIdsForRangeEnds(e,t),(0,d.buildCellRangeAst)(e,t,n,r))}static fixSheetIdsForRangeEnds(e,t){var r=l.rangeSheetReferenceType(e.sheet,t.sheet);return{firstEnd:e,secondEnd:void 0!==e.sheet&&void 0===t.sheet?t.withSheet(e.sheet):t,sheetRefType:r}}handleOffsetHeuristic(e){var t=e[0];if(t.type!==d.AstNodeType.CELL_REFERENCE)return this.parsingError(d.ParsingErrorType.StaticOffsetError,"First argument to OFFSET is not a reference");var r=e[1];let n;if(r.type===d.AstNodeType.NUMBER&&Number.isInteger(r.value))n=r.value;else if(r.type===d.AstNodeType.PLUS_UNARY_OP&&r.value.type===d.AstNodeType.NUMBER&&Number.isInteger(r.value.value))n=r.value.value;else{if(r.type!==d.AstNodeType.MINUS_UNARY_OP||r.value.type!==d.AstNodeType.NUMBER||!Number.isInteger(r.value.value))return this.parsingError(d.ParsingErrorType.StaticOffsetError,"Second argument to OFFSET is not a static number");n=-r.value.value}r=e[2];let i;if(r.type===d.AstNodeType.NUMBER&&Number.isInteger(r.value))i=r.value;else if(r.type===d.AstNodeType.PLUS_UNARY_OP&&r.value.type===d.AstNodeType.NUMBER&&Number.isInteger(r.value.value))i=r.value.value;else{if(r.type!==d.AstNodeType.MINUS_UNARY_OP||r.value.type!==d.AstNodeType.NUMBER||!Number.isInteger(r.value.value))return this.parsingError(d.ParsingErrorType.StaticOffsetError,"Third argument to OFFSET is not a static number");i=-r.value.value}r=e[3];let o;if(void 0===r)o=1;else{if(r.type!==d.AstNodeType.NUMBER)return this.parsingError(d.ParsingErrorType.StaticOffsetError,"Fourth argument to OFFSET is not a static number");if((o=r.value)<1)return this.parsingError(d.ParsingErrorType.StaticOffsetError,"Fourth argument to OFFSET is too small number");if(!Number.isInteger(o))return this.parsingError(d.ParsingErrorType.StaticOffsetError,"Fourth argument to OFFSET is not integer")}r=e[4];let s;if(void 0===r)s=1;else{if(r.type!==d.AstNodeType.NUMBER)return this.parsingError(d.ParsingErrorType.StaticOffsetError,"Fifth argument to OFFSET is not a static number");if((s=r.value)<1)return this.parsingError(d.ParsingErrorType.StaticOffsetError,"Fifth argument to OFFSET is too small number");if(!Number.isInteger(s))return this.parsingError(d.ParsingErrorType.StaticOffsetError,"Fifth argument to OFFSET is not integer")}e=new h.CellAddress(t.reference.col+i,t.reference.row+n,t.reference.type);let a=e.col,l=e.row;return t.reference.type!==h.CellReferenceType.CELL_REFERENCE_RELATIVE&&t.reference.type!==h.CellReferenceType.CELL_REFERENCE_ABSOLUTE_COL||(l+=this.formulaAddress.row),t.reference.type!==h.CellReferenceType.CELL_REFERENCE_RELATIVE&&t.reference.type!==h.CellReferenceType.CELL_REFERENCE_ABSOLUTE_ROW||(a+=this.formulaAddress.col),a<0||l<0?(0,d.buildCellErrorAst)(new c.CellError(c.ErrorType.REF,u.ErrorMessage.OutOfSheet)):1===s&&1===o?(0,d.buildCellReferenceAst)(e):(r=new h.CellAddress(e.col+s-1,e.row+o-1,e.type),(0,d.buildCellRangeAst)(e,r,d.RangeSheetReferenceType.RELATIVE))}parsingError(e,t){return this.customParsingError=(0,d.parsingError)(e,t),(0,d.buildParsingErrorAst)()}static rangeSheetReferenceType(e,t){return void 0===e?d.RangeSheetReferenceType.RELATIVE:void 0===t?d.RangeSheetReferenceType.START_ABSOLUTE:d.RangeSheetReferenceType.BOTH_ABSOLUTE}}class i{constructor(e){this.lexerConfig=e,this.lexer=new n.Lexer(e.allTokens,{ensureOptimizations:!0})}tokenizeFormula(e){var e=this.lexer.tokenize(e),t=e.tokens,t=this.trimTrailingWhitespaces(t);return t=this.skipWhitespacesInsideRanges(t),t=this.skipWhitespacesBeforeArgSeparators(t),e.tokens=t,e}skipWhitespacesInsideRanges(e){return i.filterTokensByNeighbors(e,(e,t,r)=>((0,n.tokenMatcher)(e,a.CellReference)||(0,n.tokenMatcher)(e,a.RangeSeparator))&&(0,n.tokenMatcher)(t,this.lexerConfig.WhiteSpace)&&((0,n.tokenMatcher)(r,a.CellReference)||(0,n.tokenMatcher)(r,a.RangeSeparator)))}skipWhitespacesBeforeArgSeparators(e){return i.filterTokensByNeighbors(e,(e,t,r)=>!(0,n.tokenMatcher)(e,this.lexerConfig.ArgSeparator)&&(0,n.tokenMatcher)(t,this.lexerConfig.WhiteSpace)&&(0,n.tokenMatcher)(r,this.lexerConfig.ArgSeparator))}static filterTokensByNeighbors(e,t){if(e.length<3)return e;let r=0;for(var n=[e[r++]];r<e.length-1;)t(e[r-1],e[r],e[r+1])||n.push(e[r]),++r;return n.push(e[r]),n}trimTrailingWhitespaces(e){return 0<e.length&&(0,n.tokenMatcher)(e[e.length-1],this.lexerConfig.WhiteSpace)&&e.pop(),e}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{ErrorMessage:()=>n});class n{}n.DistinctSigns="Distinct signs.",n.WrongArgNumber="Wrong number of arguments.",n.EmptyArg="Empty function argument.",n.EmptyArray="Empty array not allowed.",n.ArrayDimensions="Array dimensions are not compatible.",n.NoSpaceForArrayResult="No space for array result.",n.ValueSmall="Value too small.",n.ValueLarge="Value too large.",n.BadCriterion="Incorrect criterion.",n.RangeManySheets="Range spans more than one sheet.",n.CellRangeExpected="Cell range expected.",n.WrongDimension="Wrong range dimension.",n.ScalarExpected="Cell range not allowed.",n.NumberCoercion="Value cannot be coerced to number.",n.NumberExpected="Number argument expected.",n.IntegerExpected="Value needs to be an integer.",n.BadMode="Mode not recognized.",n.DateBounds="Date outside of bounds.",n.OutOfSheet="Resulting reference is out of the sheet.",n.WrongType="Wrong type of argument.",n.NaN="NaN or infinite value encountered.",n.EqualLength="Ranges need to be of equal length.",n.Negative="Value cannot be negative.",n.NotBinary="String does not represent a binary number.",n.NotOctal="String does not represent an octal number.",n.NotHex="String does not represent a hexadecimal number.",n.EndStartPeriod="End period needs to be at least start period.",n.CellRefExpected="Cell reference expected.",n.EmptyRange="Empty range not allowed.",n.BadRef="Address is not correct.",n.NumberRange="Number-only range expected.",n.ValueNotFound="Value not found.",n.ValueBaseLarge="Value in base too large.",n.ValueBaseSmall="Value in base too small.",n.ValueBaseLong="Value in base too long.",n.NegativeLength="Length cannot be negative.",n.PatternNotFound="Pattern not found.",n.OneValue="Needs at least one value.",n.TwoValues="Range needs to contain at least two elements.",n.ThreeValues="Range needs to contain at least three elements.",n.IndexBounds="Index out of bounds.",n.IndexLarge="Index too large.",n.Formula="Expected formula.",n.NegativeCount="Count cannot be negative.",n.ParseError="Parsing error.",n.SheetRef="Sheet does not exist.",n.PeriodLong="Period number cannot exceed life length.",n.InvalidDate="Invalid date.",n.BitshiftLong="Result of bitshift is too long.",n.EmptyString="Empty-string argument not allowed.",n.LengthBounds="Length out of bounds.",n.NegativeTime="Time cannot be negative.",n.NoDefault="No default option.",n.NoConditionMet="None of the conditions were met.",n.Selector="Selector cannot exceed the number of arguments.",n.StartEndDate="Start date needs to be earlier than end date.",n.IncorrectDateTime="String does not represent correct DateTime.",n.CharacterCodeBounds="Character code out of bounds.",n.NonZero="Argument cannot be 0.",n.LessThanOne="Argument cannot be less than 1.",n.WeekendString="Incorrect weekend bitmask string.",n.InvalidRoman="Invalid roman numeral.",n.WrongOrder="Wrong order of values.",n.ComplexNumberExpected="Complex number expected.",n.ShouldBeIorJ="Should be 'i' or 'j'.",n.SizeMismatch="Array dimensions mismatched.",n.FunctionName=e=>`Function name ${e} not recognized.`,n.NamedExpressionName=e=>`Named expression ${e} not recognized.`,n.LicenseKey=e=>`License key is ${e}.`},(e,t,r)=>{"use strict";r.r(t),r.d(t,{AdditionOp:()=>p,ArrayLParen:()=>I,ArrayRParen:()=>M,BooleanOp:()=>C,CellReference:()=>U,ColumnRange:()=>L,ConcatenateOp:()=>A,DivOp:()=>v,EqualsOp:()=>E,ErrorLiteral:()=>D,GreaterThanOp:()=>S,GreaterThanOrEqualOp:()=>x,LParen:()=>N,LessThanOp:()=>_,LessThanOrEqualOp:()=>R,MinusOp:()=>g,MultiplicationOp:()=>m,NamedExpression:()=>V,NotEqualOp:()=>T,PercentOp:()=>w,PlusOp:()=>f,PowerOp:()=>b,ProcedureName:()=>H,RParen:()=>O,RangeSeparator:()=>P,RowRange:()=>F,StringLiteral:()=>k,TimesOp:()=>y,buildLexerConfig:()=>n});var d=r(14),h=r(12),t=r(63),r=r(64);const p=(0,d.createToken)({name:"AdditionOp",pattern:d.Lexer.NA}),f=(0,d.createToken)({name:"PlusOp",pattern:/\+/,categories:p}),g=(0,d.createToken)({name:"MinusOp",pattern:/-/,categories:p}),m=(0,d.createToken)({name:"MultiplicationOp",pattern:d.Lexer.NA}),y=(0,d.createToken)({name:"TimesOp",pattern:/\*/,categories:m}),v=(0,d.createToken)({name:"DivOp",pattern:/\//,categories:m}),b=(0,d.createToken)({name:"PowerOp",pattern:/\^/}),w=(0,d.createToken)({name:"PercentOp",pattern:/%/}),C=(0,d.createToken)({name:"BooleanOp",pattern:d.Lexer.NA}),E=(0,d.createToken)({name:"EqualsOp",pattern:/=/,categories:C}),T=(0,d.createToken)({name:"NotEqualOp",pattern:/<>/,categories:C}),S=(0,d.createToken)({name:"GreaterThanOp",pattern:/>/,categories:C}),_=(0,d.createToken)({name:"LessThanOp",pattern:/</,categories:C}),x=(0,d.createToken)({name:"GreaterThanOrEqualOp",pattern:/>=/,categories:C}),R=(0,d.createToken)({name:"LessThanOrEqualOp",pattern:/<=/,categories:C}),A=(0,d.createToken)({name:"ConcatenateOp",pattern:/&/}),N=(0,d.createToken)({name:"LParen",pattern:/\(/}),O=(0,d.createToken)({name:"RParen",pattern:/\)/}),I=(0,d.createToken)({name:"ArrayLParen",pattern:/{/}),M=(0,d.createToken)({name:"ArrayRParen",pattern:/}/}),k=(0,d.createToken)({name:"StringLiteral",pattern:/"([^"\\]*(\\.[^"\\]*)*)"/}),D=(0,d.createToken)({name:"ErrorLiteral",pattern:/#[A-Za-z0-9\/]+[?!]?/}),P=(0,d.createToken)({name:"RangeSeparator",pattern:new RegExp(h.RANGE_OPERATOR)}),L=(0,d.createToken)({name:"ColumnRange",pattern:new RegExp(""+h.COLUMN_REFERENCE_PATTERN+h.RANGE_OPERATOR+h.COLUMN_REFERENCE_PATTERN)}),F=(0,d.createToken)({name:"RowRange",pattern:new RegExp(""+h.ROW_REFERENCE_PATTERN+h.RANGE_OPERATOR+h.ROW_REFERENCE_PATTERN)}),H=(0,d.createToken)({name:"ProcedureName",pattern:new RegExp(`([${h.UNICODE_LETTER_PATTERN}][${h.NON_RESERVED_CHARACTER_PATTERN}]*)\\(`)});t=new t.CellReferenceMatcher;const U=(0,d.createToken)({name:"CellReference",pattern:t.match.bind(t),start_chars_hint:t.POSSIBLE_START_CHARACTERS,line_breaks:!1});t=new r.NamedExpressionMatcher;const V=(0,d.createToken)({name:"NamedExpression",pattern:t.match.bind(t),start_chars_hint:t.POSSIBLE_START_CHARACTERS,line_breaks:!1}),n=e=>{var t=e.translationPackage.getFunctionTranslation("OFFSET"),r=e.errorMapping,n=e.translationPackage.buildFunctionMapping(),i=new RegExp("standard"===e.ignoreWhiteSpace?h.ODFF_WHITESPACE_PATTERN:h.ALL_WHITESPACE_PATTERN),i=(0,d.createToken)({name:"WhiteSpace",pattern:i}),o=(0,d.createToken)({name:"ArrayRowSep",pattern:e.arrayRowSeparator}),s=(0,d.createToken)({name:"ArrayColSep",pattern:e.arrayColumnSeparator}),a=(0,d.createToken)({name:"NumberLiteral",pattern:new RegExp(`(([${e.decimalSeparator}]\\d+)|(\\d+([${e.decimalSeparator}]\\d*)?))(e[+-]?\\d+)?`)}),t=(0,d.createToken)({name:"OffsetProcedureName",pattern:new RegExp(t,"i")});let l,c;c=e.functionArgSeparator===e.arrayColumnSeparator?(l=s,[]):e.functionArgSeparator===e.arrayRowSeparator?(l=o,[]):[l=(0,d.createToken)({name:"ArgSeparator",pattern:e.functionArgSeparator})];var u=[i,f,g,y,v,b,E,T,w,x,R,S,_,N,O,I,M,t,H,P,...c,L,F,a,k,D,A,C,p,m,U,V,o,s];return{ArgSeparator:l,NumberLiteral:a,OffsetProcedureName:t,ArrayRowSeparator:o,ArrayColSeparator:s,WhiteSpace:i,allTokens:u,errorMapping:r,functionMapping:n,decimalSeparator:e.decimalSeparator,maxColumns:e.maxColumns,maxRows:e.maxRows}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{CellReferenceMatcher:()=>i});var n=r(12);class i{constructor(){this.POSSIBLE_START_CHARACTERS=[...n.ALL_UNICODE_LETTERS_ARRAY,...n.ALL_DIGITS_ARRAY,n.ABSOLUTE_OPERATOR,"'","_"],this.cellReferenceRegexp=new RegExp(n.CELL_REFERENCE_WITH_NEXT_CHARACTER_PATTERN,"y")}match(e,t){this.cellReferenceRegexp.lastIndex=t;t=this.cellReferenceRegexp.exec(e+"@");return null==t||null==t[1]?null:(t[0]=t[1],t)}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{NamedExpressionMatcher:()=>i});var n=r(12);class i{constructor(){this.POSSIBLE_START_CHARACTERS=[...n.ALL_UNICODE_LETTERS_ARRAY,"_"],this.namedExpressionRegexp=new RegExp(n.NAMED_EXPRESSION_PATTERN,"y"),this.r1c1CellRefRegexp=new RegExp(`^${n.R1C1_CELL_REFERENCE_PATTERN}$`)}match(e,t){this.namedExpressionRegexp.lastIndex=t;t=this.namedExpressionRegexp.exec(e);return null==t||null==t[0]||this.r1c1CellRefRegexp.test(t[0])?null:t}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{Unparser:()=>l,formatNumber:()=>c});var o=r(3),n=r(0),i=r(8),s=r(57),a=r(58);class l{constructor(e,t,r,n){this.config=e,this.lexerConfig=t,this.sheetMappingFn=r,this.namedExpressions=n}unparse(e,t){return"="+this.unparseAst(e,t)}unparseAst(t,r){switch(t.type){case s.AstNodeType.EMPTY:return(0,s.imageWithWhitespace)("",t.leadingWhitespace);case s.AstNodeType.NUMBER:return(0,s.imageWithWhitespace)(c(t.value,this.config.decimalSeparator),t.leadingWhitespace);case s.AstNodeType.STRING:return(0,s.imageWithWhitespace)('"'+t.value+'"',t.leadingWhitespace);case s.AstNodeType.FUNCTION_CALL:var n=t.args.map(e=>void 0!==e?this.unparseAst(e,r):"").join(this.config.functionArgSeparator),n=(this.config.translationPackage.isFunctionTranslated(t.procedureName)?this.config.translationPackage.getFunctionTranslation(t.procedureName):t.procedureName)+"("+n+(0,s.imageWithWhitespace)(")",t.internalWhitespace);return(0,s.imageWithWhitespace)(n,t.leadingWhitespace);case s.AstNodeType.NAMED_EXPRESSION:n=null==(n=this.namedExpressions.nearestNamedExpression(t.expressionName,r.sheet))?void 0:n.displayName;return(0,s.imageWithWhitespace)(n||t.expressionName,t.leadingWhitespace);case s.AstNodeType.CELL_REFERENCE:{let e;return e=void 0!==t.reference.sheet?this.unparseSheetName(t.reference.sheet)+"!":"",e+=null!=(n=t.reference.unparse(r))?n:this.config.translationPackage.getErrorTranslation(o.ErrorType.REF),(0,s.imageWithWhitespace)(e,t.leadingWhitespace)}case s.AstNodeType.COLUMN_RANGE:case s.AstNodeType.ROW_RANGE:case s.AstNodeType.CELL_RANGE:return(0,s.imageWithWhitespace)(this.formatRange(t,r),t.leadingWhitespace);case s.AstNodeType.PLUS_UNARY_OP:n=this.unparseAst(t.value,r);return(0,s.imageWithWhitespace)("+",t.leadingWhitespace)+n;case s.AstNodeType.MINUS_UNARY_OP:n=this.unparseAst(t.value,r);return(0,s.imageWithWhitespace)("-",t.leadingWhitespace)+n;case s.AstNodeType.PERCENT_OP:return this.unparseAst(t.value,r)+(0,s.imageWithWhitespace)("%",t.leadingWhitespace);case s.AstNodeType.ERROR:n=this.config.translationPackage.getErrorTranslation(t.error?t.error.type:o.ErrorType.ERROR);return(0,s.imageWithWhitespace)(n,t.leadingWhitespace);case s.AstNodeType.ERROR_WITH_RAW_INPUT:return(0,s.imageWithWhitespace)(t.rawInput,t.leadingWhitespace);case s.AstNodeType.PARENTHESIS:n="("+this.unparseAst(t.expression,r)+(0,s.imageWithWhitespace)(")",t.internalWhitespace);return(0,s.imageWithWhitespace)(n,t.leadingWhitespace);case s.AstNodeType.ARRAY:n="{"+t.args.map(e=>e.map(e=>this.unparseAst(e,r)).join(this.config.arrayColumnSeparator)).join(this.config.arrayRowSeparator)+(0,s.imageWithWhitespace)("}",t.internalWhitespace);return(0,s.imageWithWhitespace)(n,t.leadingWhitespace);default:var n=this.unparseAst(t.left,r),e=this.unparseAst(t.right,r);return n+(0,s.imageWithWhitespace)(a.binaryOpTokenMap[t.type],t.leadingWhitespace)+e}}unparseSheetName(e){var t=(0,i.sheetIndexToString)(e,this.sheetMappingFn);if(void 0===t)throw new n.NoSheetWithIdError(e);return t}formatRange(e,t){let r="",n="";void 0!==e.start.sheet&&e.sheetReferenceType!==s.RangeSheetReferenceType.RELATIVE&&(r=this.unparseSheetName(e.start.sheet)+"!"),void 0!==e.end.sheet&&e.sheetReferenceType===s.RangeSheetReferenceType.BOTH_ABSOLUTE&&(n=this.unparseSheetName(e.end.sheet)+"!");var i=e.start.unparse(t),e=e.end.unparse(t);return void 0===i||void 0===e?this.config.translationPackage.getErrorTranslation(o.ErrorType.REF):""+r+i+":"+n+e}}function c(e,t){return e.toString().replace(".",t)}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{collectDependencies:()=>n});var o=r(7);const s=(e,t,r,n)=>{switch(e.type){case o.AstNodeType.EMPTY:case o.AstNodeType.NUMBER:case o.AstNodeType.STRING:case o.AstNodeType.ERROR:return;case o.AstNodeType.NAMED_EXPRESSION:return void(n&&r.push(new o.NamedExpressionDependency(e.expressionName)));case o.AstNodeType.CELL_REFERENCE:return void(n&&r.push(new o.AddressDependency(e.reference)));case o.AstNodeType.CELL_RANGE:return void(n&&e.start.sheet===e.end.sheet&&r.push(new o.CellRangeDependency(e.start,e.end)));case o.AstNodeType.COLUMN_RANGE:return void(n&&e.start.sheet===e.end.sheet&&r.push(new o.ColumnRangeDependency(e.start,e.end)));case o.AstNodeType.ROW_RANGE:return void(n&&e.start.sheet===e.end.sheet&&r.push(new o.RowRangeDependency(e.start,e.end)));case o.AstNodeType.PERCENT_OP:case o.AstNodeType.PLUS_UNARY_OP:case o.AstNodeType.MINUS_UNARY_OP:return void s(e.value,t,r,!0);case o.AstNodeType.CONCATENATE_OP:case o.AstNodeType.EQUALS_OP:case o.AstNodeType.NOT_EQUAL_OP:case o.AstNodeType.LESS_THAN_OP:case o.AstNodeType.GREATER_THAN_OP:case o.AstNodeType.LESS_THAN_OR_EQUAL_OP:case o.AstNodeType.GREATER_THAN_OR_EQUAL_OP:case o.AstNodeType.MINUS_OP:case o.AstNodeType.PLUS_OP:case o.AstNodeType.TIMES_OP:case o.AstNodeType.DIV_OP:case o.AstNodeType.POWER_OP:return s(e.left,t,r,!0),void s(e.right,t,r,!0);case o.AstNodeType.PARENTHESIS:return void s(e.expression,t,r,n);case o.AstNodeType.FUNCTION_CALL:{const i=!t.doesFunctionNeedArgumentToBeComputed(e.procedureName);e.args.forEach(e=>s(e,t,r,i))}}},n=(e,t)=>{var r=new Array;return s(e,t,r,!0),r}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{AddressDependency:()=>i,CellRangeDependency:()=>o,ColumnRangeDependency:()=>s,NamedExpressionDependency:()=>l,RowRangeDependency:()=>a});var n=r(2);class i{constructor(e){this.dependency=e}absolutize(e){return this.dependency.toSimpleCellAddress(e)}}class o{constructor(e,t){this.start=e,this.end=t}absolutize(e){return new n.AbsoluteCellRange(this.start.toSimpleCellAddress(e),this.end.toSimpleCellAddress(e))}}class s{constructor(e,t){this.start=e,this.end=t}absolutize(e){var t=this.start.toSimpleColumnAddress(e),e=this.end.toSimpleColumnAddress(e);return new n.AbsoluteColumnRange(t.sheet,t.col,e.col)}}class a{constructor(e,t){this.start=e,this.end=t}absolutize(e){var t=this.start.toSimpleRowAddress(e),e=this.end.toSimpleRowAddress(e);return new n.AbsoluteRowRange(t.sheet,t.row,e.row)}}class l{constructor(e){this.name=e}absolutize(e){return this}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{ContentChanges:()=>n});var i=r(3),o=r(69);class n{constructor(){this.changes=new Map}static empty(){return new n}addAll(e){for(const t of e.changes.values())this.add(t.address,t);return this}addChange(e,t,r){this.addInterpreterValue(e,t,r)}exportChanges(t){let r=[];return this.changes.forEach(e=>{e=t.exportChange(e);Array.isArray(e)?r=r.concat(e):r.push(e)}),r}getChanges(){return Array.from(this.changes.values())}isEmpty(){return 0===this.changes.size}add(e,t){var r=t.value;if(r instanceof o.SimpleRangeValue)for(const n of r.effectiveAddressesFromData(e))this.changes.delete((0,i.addressKey)(n));this.changes.set((0,i.addressKey)(e),t)}addInterpreterValue(e,t,r){this.add(t,{address:t,value:e,oldValue:r})}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{SimpleRangeValue:()=>a});var i=r(1),o=r(3),n=r(61),s=r(70);class a{constructor(e,t,r,n){this._data=e,this.range=t,this.dependencyGraph=r,this._hasOnlyNumbers=n,this.size=void 0===e?new i.ArraySize(t.effectiveWidth(r),t.effectiveHeight(r)):new i.ArraySize(e[0].length,e.length)}get data(){return this.ensureThatComputed(),this._data}static fromRange(e,t,r){return new a(e,t,r,!0)}static onlyNumbers(e){return new a(e,void 0,void 0,!0)}static onlyValues(e){return new a(e,void 0,void 0,void 0)}static onlyRange(e,t){return new a(void 0,e,t,void 0)}static fromScalar(e){return new a([[e]],void 0,void 0,void 0)}isAdHoc(){return void 0===this.range}width(){return this.size.width}height(){return this.size.height}valuesFromTopLeftCorner(){this.ensureThatComputed();var r=[];for(let t=0;t<this._data.length;t++)for(let e=0;e<this._data[0].length;e++)r.push(this._data[t][e]);return r}*effectiveAddressesFromData(r){for(let t=0;t<this.data.length;++t){var n=this.data[t];for(let e=0;e<n.length;++e)yield(0,o.simpleCellAddress)(r.sheet,r.col+e,r.row+t)}}*entriesFromTopLeftCorner(r){this.ensureThatComputed();for(let t=0;t<this.size.height;++t)for(let e=0;e<this.size.width;++e)yield[this._data[t][e],(0,o.simpleCellAddress)(r.sheet,r.col+e,r.row+t)]}*iterateValuesFromTopLeftCorner(){yield*this.valuesFromTopLeftCorner()}numberOfElements(){return this.size.width*this.size.height}hasOnlyNumbers(){if(void 0===this._hasOnlyNumbers){this._hasOnlyNumbers=!0;for(const e of this.data)for(const t of e)if("number"!=typeof t)return this._hasOnlyNumbers=!1}return this._hasOnlyNumbers}rawNumbers(){return this._data}rawData(){var e;return this.ensureThatComputed(),null!=(e=this._data)?e:[]}sameDimensionsAs(e){return this.width()===e.width()&&this.height()===e.height()}ensureThatComputed(){void 0===this._data&&(this._hasOnlyNumbers=!0,this._data=this.range.addressesArrayMap(this.dependencyGraph,e=>{e=this.dependencyGraph.getCellValue(e);return e instanceof a?(this._hasOnlyNumbers=!1,new o.CellError(o.ErrorType.VALUE,n.ErrorMessage.ScalarExpected)):((0,s.isExtendedNumber)(e)||(this._hasOnlyNumbers=!1),e)}))}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{CurrencyNumber:()=>s,DateNumber:()=>o,DateTimeNumber:()=>l,EmptyValue:()=>n,NumberType:()=>u,PercentNumber:()=>c,RichNumber:()=>i,TimeNumber:()=>a,cloneNumber:()=>function(e,t){return"number"==typeof e?t:((t=e.fromNumber(t)).format=e.format,t)},getFormatOfExtendedNumber:()=>function(e){if(e instanceof i)return e.format},getRawValue:()=>function(e){return e instanceof i?e.val:e},getTypeFormatOfExtendedNumber:()=>function(e){return e instanceof i?{type:e.getDetailedType(),format:e.format}:{type:u.NUMBER_RAW}},getTypeOfExtendedNumber:()=>function(e){return e instanceof i?e.getDetailedType():u.NUMBER_RAW},isExtendedNumber:()=>function(e){return"number"==typeof e||e instanceof i}});const n=Symbol("Empty value");class i{constructor(e,t){this.val=e,this.format=t}fromNumber(e){return new this.constructor(e)}}class o extends i{getDetailedType(){return u.NUMBER_DATE}}class s extends i{getDetailedType(){return u.NUMBER_CURRENCY}}class a extends i{getDetailedType(){return u.NUMBER_TIME}}class l extends i{getDetailedType(){return u.NUMBER_DATETIME}}class c extends i{getDetailedType(){return u.NUMBER_PERCENT}}var u;(r=u=u||{}).NUMBER_RAW="NUMBER_RAW",r.NUMBER_DATE="NUMBER_DATE",r.NUMBER_TIME="NUMBER_TIME",r.NUMBER_DATETIME="NUMBER_DATETIME",r.NUMBER_CURRENCY="NUMBER_CURRENCY",r.NUMBER_PERCENT="NUMBER_PERCENT"},(e,t,r)=>{"use strict";r.r(t),r.d(t,{ColumnsSpan:()=>i,RowsSpan:()=>n});class n{constructor(e,t,r){if(this.sheet=e,this.rowStart=t,this.rowEnd=r,t<0)throw Error("Starting row cant be less than 0");if(r<t)throw Error("Row span cant end before start")}get numberOfRows(){return this.rowEnd-this.rowStart+1}get start(){return this.rowStart}get end(){return this.rowEnd}static fromNumberOfRows(e,t,r){return new n(e,t,t+r-1)}static fromRowStartAndEnd(e,t,r){return new n(e,t,r)}*rows(){for(let e=this.rowStart;e<=this.rowEnd;++e)yield e}intersect(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");var t=Math.max(this.rowStart,e.rowStart),e=Math.min(this.rowEnd,e.rowEnd);return e<t?null:new n(this.sheet,t,e)}firstRow(){return new n(this.sheet,this.rowStart,this.rowStart)}}class i{constructor(e,t,r){if(this.sheet=e,this.columnStart=t,this.columnEnd=r,t<0)throw Error("Starting column cant be less than 0");if(r<t)throw Error("Column span cant end before start")}get numberOfColumns(){return this.columnEnd-this.columnStart+1}get start(){return this.columnStart}get end(){return this.columnEnd}static fromNumberOfColumns(e,t,r){return new i(e,t,t+r-1)}static fromColumnStartAndEnd(e,t,r){return new i(e,t,r)}*columns(){for(let e=this.columnStart;e<=this.columnEnd;++e)yield e}intersect(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");var t=Math.max(this.columnStart,e.columnStart),e=Math.min(this.columnEnd,e.columnEnd);return e<t?null:new i(this.sheet,t,e)}firstColumn(){return new i(this.sheet,this.columnStart,this.columnStart)}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{EmptyStatistics:()=>n.EmptyStatistics,StatType:()=>o.StatType,Statistics:()=>i.Statistics});var n=r(73),i=r(74),o=r(75)},(e,t,r)=>{"use strict";r.r(t),r.d(t,{EmptyStatistics:()=>n});class n extends r(74).Statistics{incrementCriterionFunctionFullCacheUsed(){}incrementCriterionFunctionPartialCacheUsed(){}start(e){}end(e){}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{Statistics:()=>i});var n=r(75);class i{constructor(){this.stats=new Map([[n.StatType.CRITERION_FUNCTION_FULL_CACHE_USED,0],[n.StatType.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0]]),this.startTimes=new Map}incrementCriterionFunctionFullCacheUsed(){var e=(null!=(e=this.stats.get(n.StatType.CRITERION_FUNCTION_FULL_CACHE_USED))?e:0)+1;this.stats.set(n.StatType.CRITERION_FUNCTION_FULL_CACHE_USED,e)}incrementCriterionFunctionPartialCacheUsed(){var e=(null!=(e=this.stats.get(n.StatType.CRITERION_FUNCTION_PARTIAL_CACHE_USED))?e:0)+1;this.stats.set(n.StatType.CRITERION_FUNCTION_PARTIAL_CACHE_USED,e)}reset(){this.stats.clear(),this.startTimes.clear(),this.stats.set(n.StatType.CRITERION_FUNCTION_FULL_CACHE_USED,0),this.stats.set(n.StatType.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0)}start(e){if(this.startTimes.get(e))throw Error(`Statistics ${e} already started`);this.startTimes.set(e,Date.now())}end(e){var t=Date.now(),r=this.startTimes.get(e);if(!r)throw Error(`Statistics ${e} not started`);var n=null!=(n=this.stats.get(e))?n:0;this.stats.set(e,n+=t-r),this.startTimes.delete(e)}measure(e,t){this.start(e);t=t();return this.end(e),t}snapshot(){return new Map(this.stats)}}},(e,t,r)=>{"use strict";var n;r.r(t),r.d(t,{StatType:()=>n}),(r=n=n||{}).BUILD_ENGINE_TOTAL="BUILD_ENGINE_TOTAL",r.PARSER="PARSER",r.GRAPH_BUILD="GRAPH_BUILD",r.COLLECT_DEPENDENCIES="COLLECT_DEPENDENCIES",r.PROCESS_DEPENDENCIES="PROCESS_DEPENDENCIES",r.TOP_SORT="TOP_SORT",r.BUILD_COLUMN_INDEX="BUILD_COLUMN_INDEX",r.EVALUATION="EVALUATION",r.VLOOKUP="VLOOKUP",r.TRANSFORM_ASTS="TRANSFORM_ASTS",r.TRANSFORM_ASTS_POSTPONED="TRANSFORM_ASTS_POSTPONED",r.ADJUSTING_ADDRESS_MAPPING="ADJUSTING_ADDRESS_MAPPING",r.ADJUSTING_ARRAY_MAPPING="ADJUSTING_ARRAY_MAPPING",r.ADJUSTING_RANGES="ADJUSTING_RANGES",r.ADJUSTING_GRAPH="ADJUSTING_GRAPH",r.CRITERION_FUNCTION_FULL_CACHE_USED="CRITERION_FUNCTION_FULL_CACHE_USED",r.CRITERION_FUNCTION_PARTIAL_CACHE_USED="CRITERION_FUNCTION_PARTIAL_CACHE_USED"},(e,t,r)=>{"use strict";r.r(t),r.d(t,{AddressMapping:()=>s});var i=r(77),n=r(70),o=r(4);class s{constructor(e){this.policy=e,this.mapping=new Map}getCell(e){var t=this.mapping.get(e.sheet);if(void 0===t)throw new i.NoSheetWithIdError(e.sheet);return t.getCell(e)}fetchCell(e){var t=this.mapping.get(e.sheet);if(void 0===t)throw new i.NoSheetWithIdError(e.sheet);t=t.getCell(e);if(t)return t;throw Error("Vertex for address missing in AddressMapping")}strategyFor(e){var t=this.mapping.get(e);if(void 0===t)throw new i.NoSheetWithIdError(e);return t}addSheet(e,t){if(this.mapping.has(e))throw Error("Sheet already added");this.mapping.set(e,t)}autoAddSheet(e,t){var{height:t,width:r,fill:n}=t,n=this.policy.call(n);this.addSheet(e,new n(r,t))}getCellValue(e){var t=this.getCell(e);return void 0===t?n.EmptyValue:t instanceof o.ArrayVertex?t.getArrayCellValue(e):t.getCellValue()}getRawValue(e){var t=this.getCell(e);return t instanceof o.ValueCellVertex?t.getValues().rawValue:t instanceof o.ArrayVertex?t.getArrayCellRawValue(e):null}setCell(e,t){var r=this.mapping.get(e.sheet);if(!r)throw Error("Sheet not initialized");r.setCell(e,t)}moveCell(e,t){var r=this.mapping.get(e.sheet);if(!r)throw Error("Sheet not initialized.");if(e.sheet!==t.sheet)throw Error("Cannot move cells between sheets.");if(r.has(t))throw new Error("Cannot move cell. Destination already occupied.");r=r.getCell(e);if(void 0===r)throw new Error("Cannot move cell. No cell with such address.");this.setCell(t,r),this.removeCell(e)}removeCell(e){var t=this.mapping.get(e.sheet);if(!t)throw Error("Sheet not initialized");t.removeCell(e)}has(e){var t=this.mapping.get(e.sheet);return void 0!==t&&t.has(e)}getHeight(e){var t=this.mapping.get(e);if(void 0===t)throw new i.NoSheetWithIdError(e);return t.getHeight()}getWidth(e){var t=this.mapping.get(e);if(t)return t.getWidth();throw new i.NoSheetWithIdError(e)}addRows(e,t,r){var n=this.mapping.get(e);if(void 0===n)throw new i.NoSheetWithIdError(e);n.addRows(t,r)}removeRows(e){var t=this.mapping.get(e.sheet);if(void 0===t)throw new i.NoSheetWithIdError(e.sheet);t.removeRows(e)}removeSheet(e){this.mapping.delete(e)}addColumns(e,t,r){var n=this.mapping.get(e);if(void 0===n)throw new i.NoSheetWithIdError(e);n.addColumns(t,r)}removeColumns(e){var t=this.mapping.get(e.sheet);if(void 0===t)throw new i.NoSheetWithIdError(e.sheet);t.removeColumns(e)}*verticesFromRowsSpan(e){yield*this.mapping.get(e.sheet).verticesFromRowsSpan(e)}*verticesFromColumnsSpan(e){yield*this.mapping.get(e.sheet).verticesFromColumnsSpan(e)}*entriesFromRowsSpan(e){yield*this.mapping.get(e.sheet).entriesFromRowsSpan(e)}*entriesFromColumnsSpan(e){yield*this.mapping.get(e.sheet).entriesFromColumnsSpan(e)}*entries(){for(var[e,t]of this.mapping.entries())yield*t.getEntries(e)}*sheetEntries(e){var t=this.mapping.get(e);if(void 0===t)throw new i.NoSheetWithIdError(e);yield*t.getEntries(e)}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{AliasAlreadyExisting:()=>D,ConfigValueEmpty:()=>w,ConfigValueTooBigError:()=>E,ConfigValueTooSmallError:()=>C,EvaluationSuspendedError:()=>S,ExpectedOneOfValuesError:()=>T,ExpectedValueOfTypeError:()=>b,FunctionPluginValidationError:()=>N,InvalidAddressError:()=>l,InvalidArgumentsError:()=>c,LanguageAlreadyRegisteredError:()=>A,LanguageNotRegisteredError:()=>R,MissingTranslationError:()=>_,NamedExpressionDoesNotExistError:()=>p,NamedExpressionNameIsAlreadyTakenError:()=>d,NamedExpressionNameIsInvalidError:()=>h,NoOperationToRedoError:()=>g,NoOperationToUndoError:()=>f,NoRelativeAddressesAllowedError:()=>k,NoSheetWithIdError:()=>n,NoSheetWithNameError:()=>i,NotAFormulaError:()=>a,NothingToPasteError:()=>m,ProtectedFunctionError:()=>O,ProtectedFunctionTranslationError:()=>x,SheetNameAlreadyTakenError:()=>o,SheetSizeLimitExceededError:()=>s,SheetsNotEqual:()=>u,SourceLocationHasArrayError:()=>I,TargetLocationHasArrayError:()=>M,UnableToParseError:()=>v});class n extends Error{constructor(e){super("There's no sheet with id = "+e)}}class i extends Error{constructor(e){super(`There's no sheet with name '${e}'`)}}class o extends Error{constructor(e){super(`Sheet with name ${e} already exists`)}}class s extends Error{constructor(){super("Sheet size limit exceeded")}}class a extends Error{constructor(){super("This is not a formula")}}class l extends Error{constructor(e){super(`Address (row = ${e.row}, col = ${e.col}) is invalid`)}}class c extends Error{constructor(e){super("Invalid arguments, expected "+e)}}class u extends Error{constructor(e,t){super(`Sheets ${e} and ${t} are not equal.`)}}class d extends Error{constructor(e){super(`Name of Named Expression '${e}' is already present`)}}class h extends Error{constructor(e){super(`Name of Named Expression '${e}' is invalid`)}}class p extends Error{constructor(e){super(`Named Expression '${e}' does not exist`)}}class f extends Error{constructor(){super("There is no operation to undo")}}class g extends Error{constructor(){super("There is no operation to redo")}}class m extends Error{constructor(){super("There is nothing to paste")}}function y(e,t){switch(typeof t){case"function":case"symbol":return t.toString();case"bigint":return"BigInt("+t.toString()+")";default:return t instanceof RegExp?"RegExp("+t.toString()+")":t}}class v extends Error{constructor(e){super("Unable to parse value: "+JSON.stringify(e,y,4))}}class b extends Error{constructor(e,t){super(`Expected value of type: ${e} for config parameter: `+t)}}class w extends Error{constructor(e){super(`Config parameter ${e} cannot be empty.`)}}class C extends Error{constructor(e,t){super(`Config parameter ${e} should be at least `+t)}}class E extends Error{constructor(e,t){super(`Config parameter ${e} should be at most `+t)}}class T extends Error{constructor(e,t){super(`Expected one of ${e} for config parameter: `+t)}}class S extends Error{constructor(){super("Computations are suspended")}}class _ extends Error{constructor(e){super(`Translation for ${e} is missing in the translation package you're using.`)}}class x extends Error{constructor(e){super("Cannot register translation for function with id: "+e)}}class R extends Error{constructor(){super("Language not registered.")}}class A extends Error{constructor(){super("Language already registered.")}}class N extends Error{static functionNotDeclaredInPlugin(e,t){return new N(`Function with id ${e} not declared in plugin `+t)}static functionMethodNotFound(e,t){return new N(`Function method ${e} not found in plugin `+t)}}class O extends Error{static cannotRegisterFunctionWithId(e){return new O("Cannot register function with id "+e)}static cannotUnregisterFunctionWithId(e){return new O("Cannot unregister function with id "+e)}static cannotUnregisterProtectedPlugin(){return new O("Cannot unregister protected plugin")}}class I extends Error{constructor(){super("Cannot perform this operation, source location has an array inside.")}}class M extends Error{constructor(){super("Cannot perform this operation, target location has an array inside.")}}class k extends Error{constructor(){super("Relative addresses not allowed in named expressions.")}}class D extends Error{constructor(e,t){super(`Alias id ${e} in plugin ${t} already defined as a function or alias.`)}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{ArrayMapping:()=>i});var n=r(3);class i{constructor(){this.arrayMapping=new Map}getArray(e){var t=this.getArrayByCorner(e.start);if(null!=t&&t.getRange().sameAs(e))return t}getArrayByCorner(e){return this.arrayMapping.get((0,n.addressKey)(e))}setArray(e,t){this.arrayMapping.set((0,n.addressKey)(e.start),t)}removeArray(e){"string"==typeof e?this.arrayMapping.delete(e):this.arrayMapping.delete((0,n.addressKey)(e.start))}count(){return this.arrayMapping.size}*arraysInRows(e){for(var[t,r]of this.arrayMapping.entries())r.spansThroughSheetRows(e.sheet,e.rowStart,e.rowEnd)&&(yield[t,r])}*arraysInCols(e){for(var[t,r]of this.arrayMapping.entries())r.spansThroughSheetColumn(e.sheet,e.columnStart,e.columnEnd)&&(yield[t,r])}isFormulaArrayInRow(e,t){for(const r of this.arrayMapping.values())if(r.spansThroughSheetRows(e,t))return!0;return!1}isFormulaArrayInAllRows(e){let t=!0;for(const r of e.rows())this.isFormulaArrayInRow(e.sheet,r)||(t=!1);return t}isFormulaArrayInColumn(e,t){for(const r of this.arrayMapping.values())if(r.spansThroughSheetColumn(e,t))return!0;return!1}isFormulaArrayInAllColumns(e){let t=!0;for(const r of e.columns())this.isFormulaArrayInColumn(e.sheet,r)||(t=!1);return t}isFormulaArrayInRange(e){for(const t of this.arrayMapping.values())if(t.getRange().doesOverlap(e))return!0;return!1}isFormulaArrayAtAddress(e){for(const t of this.arrayMapping.values())if(t.getRange().addressInRange(e))return!0;return!1}moveArrayVerticesAfterRowByRows(e,n,i){this.updateArrayVerticesInSheet(e,(e,t)=>{var r=t.getRange();return n<=r.start.row?[r.shifted(0,i),t]:void 0})}moveArrayVerticesAfterColumnByColumns(e,n,i){this.updateArrayVerticesInSheet(e,(e,t)=>{var r=t.getRange();return n<=r.start.col?[r.shifted(i,0),t]:void 0})}updateArrayVerticesInSheet(e,t){var r,n,i,o=Array();for([r,n]of this.arrayMapping.entries())n.sheet===e&&void 0!==(i=t(r,n))&&(this.removeArray(r),o.push(i));o.forEach(([e,t])=>{this.setArray(e,t)})}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{collectAddressesDependentToRange:()=>n});var l=r(7),c=r(80),u=r(82);const n=(e,t,r,n,i)=>{var o;if(t instanceof u.RangeVertex)return void 0!==(o=t.range.intersectionWith(r))?Array.from(o.addresses(i)):[];let s,a;return t instanceof c.FormulaVertex?(s=t.getFormula(n),a=t.getAddress(n),(0,l.collectDependencies)(s,e).filter(e=>e instanceof l.AddressDependency).map(e=>e.dependency.toSimpleCellAddress(a)).filter(e=>r.addressInRange(e))):[]}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{ArrayVertex:()=>d,FormulaCellVertex:()=>h,FormulaVertex:()=>u});var n=r(2),i=r(1),o=r(81),s=r(3),a=r(61),l=r(70),c=r(71);class u{constructor(e,t,r){this.formula=e,this.cellAddress=t,this.version=r}get width(){return 1}get height(){return 1}static fromAst(e,t,r,n){return r.isScalar()?new h(e,t,n):new d(e,t,r,n)}getFormula(e){return this.ensureRecentData(e),this.formula}ensureRecentData(e){var t,r;this.version!=e.version()&&([e,t,r]=e.applyTransformations(this.formula,this.cellAddress,this.version),this.formula=e,this.cellAddress=t,this.version=r)}getAddress(e){return this.ensureRecentData(e),this.cellAddress}}class d extends u{constructor(e,t,r,n=0){super(e,t,n),r.isRef?this.array=new o.ErroredArray(new s.CellError(s.ErrorType.REF,a.ErrorMessage.NoSpaceForArrayResult),i.ArraySize.error()):this.array=new o.NotComputedArray(r)}get width(){return this.array.width()}get height(){return this.array.height()}get sheet(){return this.cellAddress.sheet}get leftCorner(){return this.cellAddress}setCellValue(e){var t;return e instanceof s.CellError?this.setErrorValue(e):((t=o.ArrayValue.fromInterpreterValue(e)).resize(this.array.size),this.array=t),e}getCellValue(){if(this.array instanceof o.NotComputedArray)throw Error("Array not computed yet.");return this.array.simpleRangeValue()}valueOrUndef(){if(!(this.array instanceof o.NotComputedArray))return this.array.simpleRangeValue()}getArrayCellValue(e){var t=e.col-this.cellAddress.col,e=e.row-this.cellAddress.row;try{return this.array.get(t,e)}catch(e){return new s.CellError(s.ErrorType.REF)}}getArrayCellRawValue(e){e=this.getArrayCellValue(e);if(!(e instanceof s.CellError||e===l.EmptyValue))return(0,l.getRawValue)(e)}setArrayCellValue(e,t){var r=e.col-this.cellAddress.col,e=e.row-this.cellAddress.row;this.array instanceof o.ArrayValue&&this.array.set(r,e,t)}setNoSpace(){return this.array=new o.ErroredArray(new s.CellError(s.ErrorType.SPILL,a.ErrorMessage.NoSpaceForArrayResult),i.ArraySize.error()),this.getCellValue()}getRange(){return n.AbsoluteCellRange.spanFrom(this.cellAddress,this.width,this.height)}getRangeOrUndef(){return n.AbsoluteCellRange.spanFromOrUndef(this.cellAddress,this.width,this.height)}setAddress(e){this.cellAddress=e}setFormula(e){this.formula=e}spansThroughSheetRows(e,t,r=t){return this.cellAddress.sheet===e&&this.cellAddress.row<=r&&t<this.cellAddress.row+this.height}spansThroughSheetColumn(e,t,r=t){return this.cellAddress.sheet===e&&this.cellAddress.col<=r&&t<this.cellAddress.col+this.width}isComputed(){return!(this.array instanceof o.NotComputedArray)}columnsFromArray(){return c.ColumnsSpan.fromNumberOfColumns(this.cellAddress.sheet,this.cellAddress.col,this.width)}rowsFromArray(){return c.RowsSpan.fromNumberOfRows(this.cellAddress.sheet,this.cellAddress.row,this.height)}ensureRecentData(e){}isLeftCorner(e){return(0,s.equalSimpleCellAddress)(this.cellAddress,e)}setErrorValue(e){this.array=new o.ErroredArray(e,this.array.size)}}class h extends u{constructor(e,t,r){super(e,t,r)}valueOrUndef(){return this.cachedCellValue}setCellValue(e){return this.cachedCellValue=e,this.cachedCellValue}getCellValue(){if(void 0!==this.cachedCellValue)return this.cachedCellValue;throw Error("Value of the formula cell is not computed.")}isComputed(){return void 0!==this.cachedCellValue}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{ArrayValue:()=>a,ErroredArray:()=>l,NotComputedArray:()=>s});var n=r(1),i=r(70),o=r(69);class s{constructor(e){this.size=e}width(){return this.size.width}height(){return this.size.height}get(e,t){throw Error("Array not computed yet.")}simpleRangeValue(){throw Error("Array not computed yet.")}}class a{constructor(e){if(this.size=new n.ArraySize(0<e.length?e[0].length:0,e.length),this.array=e,this.size.width<=0||this.size.height<=0)throw Error("Incorrect array size")}static fromInterpreterValue(e){return e instanceof o.SimpleRangeValue?new a(e.data):new a([[e]])}simpleRangeValue(){return o.SimpleRangeValue.onlyValues(this.array)}addRows(e,t){this.array.splice(e,0,...this.nullArrays(t,this.width())),this.size.height+=t}addColumns(t,r){for(let e=0;e<this.height();e++)this.array[e].splice(t,0,...new Array(r).fill(i.EmptyValue));this.size.width+=r}removeRows(e,t){if(this.outOfBound(0,e)||this.outOfBound(0,t))throw Error("Array index out of bound");t=t-e+1;this.array.splice(e,t),this.size.height-=t}removeColumns(e,t){if(this.outOfBound(e,0)||this.outOfBound(t,0))throw Error("Array index out of bound");var r=t-e+1;for(const n of this.array)n.splice(e,r);this.size.width-=r}nullArrays(t,r){var n=[];for(let e=0;e<t;++e)n.push(new Array(r).fill(i.EmptyValue));return n}get(e,t){if(this.outOfBound(e,t))throw Error("Array index out of bound");return this.array[t][e]}set(e,t,r){if(this.outOfBound(e,t))throw Error("Array index out of bound");this.array[t][e]=r}width(){return this.size.width}height(){return this.size.height}raw(){return this.array}resize(e){if(this.height()<e.height&&isFinite(e.height)&&this.addRows(this.height(),e.height-this.height()),this.height()>e.height)throw Error("Resizing to smaller array");if(this.width()<e.width&&isFinite(e.width)&&this.addColumns(this.width(),e.width-this.width()),this.width()>e.width)throw Error("Resizing to smaller array")}outOfBound(e,t){return e<0||t<0||t>this.size.height-1||e>this.size.width-1}}class l{constructor(e,t){this.error=e,this.size=t}get(e,t){return this.error}width(){return this.size.width}height(){return this.size.height}simpleRangeValue(){return this.error}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{RangeVertex:()=>n});class n{constructor(e){this.range=e,this.functionCache=new Map,this.criterionFunctionCache=new Map,this.dependentCacheRanges=new Set,this.bruteForce=!1}get start(){return this.range.start}get end(){return this.range.end}get sheet(){return this.range.start.sheet}getFunctionValue(e){return this.functionCache.get(e)}setFunctionValue(e,t){this.functionCache.set(e,t)}getCriterionFunctionValue(e,t){return null==(e=this.getCriterionFunctionValues(e).get(t))?void 0:e[0]}getCriterionFunctionValues(e){return null!=(e=this.criterionFunctionCache.get(e))?e:new Map}setCriterionFunctionValues(e,t){this.criterionFunctionCache.set(e,t)}addDependentCacheRange(e){e!==this&&this.dependentCacheRanges.add(e)}clearCache(){this.functionCache.clear(),this.criterionFunctionCache.clear(),this.dependentCacheRanges.forEach(e=>e.criterionFunctionCache.clear()),this.dependentCacheRanges.clear()}getStart(){return this.start}getEnd(){return this.end}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{Graph:()=>o});var i=r(84),n=r(85);class o{constructor(e){this.dependencyQuery=e,this.nodesSparseArray=[],this.edgesSparseArray=[],this.nodesIds=new Map,this.dirtyAndVolatileNodeIds=new n.ProcessableValue({dirty:[],volatile:[]},e=>this.processDirtyAndVolatileNodeIds(e)),this.infiniteRangeIds=new Set,this.changingWithStructureNodeIds=[],this.nextId=0}getNodes(){return this.nodesSparseArray.filter(e=>void 0!==e)}hasNode(e){return this.nodesIds.has(e)}existsEdge(e,t){e=this.getNodeId(e),t=this.getNodeId(t);return void 0!==e&&void 0!==t&&this.edgesSparseArray[e].includes(t)}adjacentNodes(e){var t=this.getNodeId(e);if(void 0===t)throw this.missingNodeError(e);return new Set(this.edgesSparseArray[t].filter(e=>void 0!==e).map(e=>this.nodesSparseArray[e]))}adjacentNodesCount(e){var t=this.getNodeId(e);if(void 0===t)throw this.missingNodeError(e);return this.fixEdgesArrayForNode(t).length}addNodeAndReturnId(e){var t=this.nodesIds.get(e);return void 0!==t||(t=this.nextId,this.nextId++,this.nodesSparseArray[t]=e,this.edgesSparseArray[t]=[],this.nodesIds.set(e,t)),t}addEdge(e,t){var r=this.getNodeIdIfNotNumber(e),n=this.getNodeIdIfNotNumber(t);if(void 0===r)throw this.missingNodeError(e);if(void 0===n)throw this.missingNodeError(t);this.edgesSparseArray[r].includes(n)||this.edgesSparseArray[r].push(n)}removeNode(e){var t=this.getNodeId(e);if(void 0===t)throw this.missingNodeError(e);0<this.edgesSparseArray[t].length&&(this.edgesSparseArray[t].forEach(e=>this.dirtyAndVolatileNodeIds.rawValue.dirty.push(e)),this.dirtyAndVolatileNodeIds.markAsModified());var r=this.removeDependencies(e);return delete this.nodesSparseArray[t],delete this.edgesSparseArray[t],this.infiniteRangeIds.delete(t),this.nodesIds.delete(e),r}removeEdge(e,t){var r=this.getNodeIdIfNotNumber(e),n=this.getNodeIdIfNotNumber(t);if(void 0===r)throw this.missingNodeError(e);if(void 0===n)throw this.missingNodeError(t);e=this.edgesSparseArray[r].indexOf(n);if(-1===e)throw new Error("Edge does not exist");delete this.edgesSparseArray[r][e]}removeEdgeIfExists(e,t){var e=this.getNodeId(e),t=this.getNodeId(t);void 0!==e&&void 0!==t&&-1!==(t=this.edgesSparseArray[e].indexOf(t))&&delete this.edgesSparseArray[e][t]}topSortWithScc(){return this.getTopSortedWithSccSubgraphFrom(this.getNodes(),()=>!0,()=>{})}getTopSortedWithSccSubgraphFrom(e,t,r){var n=new i.TopSort(this.nodesSparseArray,this.edgesSparseArray),e=e.map(e=>this.getNodeId(e)).filter(e=>void 0!==e);return n.getTopSortedWithSccSubgraphFrom(e,t,r)}markNodeAsVolatile(e){e=this.getNodeId(e);void 0!==e&&(this.dirtyAndVolatileNodeIds.rawValue.volatile.push(e),this.dirtyAndVolatileNodeIds.markAsModified())}markNodeAsDirty(e){e=this.getNodeId(e);void 0!==e&&(this.dirtyAndVolatileNodeIds.rawValue.dirty.push(e),this.dirtyAndVolatileNodeIds.markAsModified())}getDirtyAndVolatileNodes(){return this.dirtyAndVolatileNodeIds.getProcessedValue()}clearDirtyNodes(){this.dirtyAndVolatileNodeIds.rawValue.dirty=[],this.dirtyAndVolatileNodeIds.markAsModified()}markNodeAsChangingWithStructure(e){e=this.getNodeId(e);void 0!==e&&this.changingWithStructureNodeIds.push(e)}markChangingWithStructureNodesAsDirty(){this.changingWithStructureNodeIds.length<=0||(this.dirtyAndVolatileNodeIds.rawValue.dirty=[...this.dirtyAndVolatileNodeIds.rawValue.dirty,...this.changingWithStructureNodeIds],this.dirtyAndVolatileNodeIds.markAsModified())}markNodeAsInfiniteRange(e){e=this.getNodeIdIfNotNumber(e);void 0!==e&&this.infiniteRangeIds.add(e)}getInfiniteRanges(){return[...this.infiniteRangeIds].map(e=>({node:this.nodesSparseArray[e],id:e}))}getNodeId(e){return this.nodesIds.get(e)}getNodeIdIfNotNumber(e){return"number"==typeof e?e:this.nodesIds.get(e)}fixEdgesArrayForNode(e){var t=this.edgesSparseArray[e];return this.edgesSparseArray[e]=t.filter(e=>void 0!==e&&this.nodesSparseArray[e]),this.edgesSparseArray[e]}removeDependencies(t){var e=this.dependencyQuery(t);return e.forEach(([,e])=>{this.removeEdgeIfExists(e,t)}),e}processDirtyAndVolatileNodeIds({dirty:e,volatile:t}){return[...new Set([...e,...t])].map(e=>this.nodesSparseArray[e]).filter(e=>void 0!==e)}missingNodeError(e){return new Error("Unknown node "+e)}}},(e,t,r)=>{"use strict";var o;r.r(t),r.d(t,{TopSort:()=>n}),(r=o=o||{})[r.ON_STACK=0]="ON_STACK",r[r.PROCESSED=1]="PROCESSED",r[r.POPPED=2]="POPPED";class n{constructor(e=[],t=[]){this.nodesSparseArray=e,this.edgesSparseArray=t,this.entranceTime=[],this.low=[],this.parent=[],this.inSCC=[],this.nodeStatus=[],this.order=[],this.sccNonSingletons=[],this.timeCounter=0}getTopSortedWithSccSubgraphFrom(e,t,r){e=e.reverse();return e.forEach(e=>this.runDFS(e)),this.postprocess(e,r,t)}getAdjacentNodeIds(e){return this.edgesSparseArray[e].filter(e=>void 0!==e&&this.nodesSparseArray[e])}runDFS(e){if(void 0===this.nodeStatus[e]){this.nodeStatus[e]=o.ON_STACK;for(var t=[e],r=[];0<t.length;){var n=t[t.length-1];switch(this.nodeStatus[n]){case o.ON_STACK:this.handleOnStack(n,r,t);break;case o.PROCESSED:this.handleProcessed(n,r,t);break;case o.POPPED:t.pop()}}}}handleOnStack(t,e,r){this.entranceTime[t]=this.timeCounter,this.low[t]=this.timeCounter,this.timeCounter++,e.push(t),this.getAdjacentNodeIds(t).forEach(e=>{void 0===this.entranceTime[e]&&(r.push(e),this.parent[e]=t,this.nodeStatus[e]=o.ON_STACK)}),this.nodeStatus[t]=o.PROCESSED}handleProcessed(t,e,r){let n=this.entranceTime[t];if(this.getAdjacentNodeIds(t).forEach(e=>{this.inSCC[e]||(n=this.parent[e]===t?Math.min(n,this.low[e]):Math.min(n,this.entranceTime[e]))}),(this.low[t]=n)===this.entranceTime[t]){for(var i=[];i.push(e[e.length-1]),e.pop(),i[i.length-1]!==t;);i.forEach(e=>{this.inSCC[e]=!0}),this.order.push(...i),1<i.length&&i.forEach(e=>{this.sccNonSingletons[e]=!0})}r.pop(),this.nodeStatus[t]=o.POPPED}postprocess(e,r,n){const i=[],o=(e.forEach(e=>{i[e]=!0}),[]),s=[];return this.order.reverse(),this.order.forEach(e=>{var t=this.getAdjacentNodeIds(e);this.sccNonSingletons[e]||t.includes(e)?(s.push(this.nodesSparseArray[e]),r(this.nodesSparseArray[e]),t.forEach(e=>i[e]=!0)):(o.push(this.nodesSparseArray[e]),i[e]&&n(this.nodesSparseArray[e])&&t.forEach(e=>i[e]=!0))}),{sorted:o,cycled:s}}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{ProcessableValue:()=>n});class n{constructor(e,t){this.rawValue=e,this.processFn=t,this.processedValue=null}getProcessedValue(){return null===this.processedValue&&(this.processedValue=this.processFn(this.rawValue)),this.processedValue}markAsModified(){this.processedValue=null}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{RangeMapping:()=>o});var n=r(2),i=r(3);class o{constructor(){this.rangeMapping=new Map}getMappingSize(e){return null!=(e=null==(e=this.rangeMapping.get(e))?void 0:e.size)?e:0}setRange(e){let t=this.rangeMapping.get(e.getStart().sheet);void 0===t&&(t=new Map,this.rangeMapping.set(e.getStart().sheet,t));var r=p(e.getStart(),e.getEnd());t.set(r,e)}removeRange(e){var t=e.getStart().sheet,r=this.rangeMapping.get(t);void 0!==r&&(e=p(e.getStart(),e.getEnd()),r.delete(e),0===r.size)&&this.rangeMapping.delete(t)}getRange(e,t){var r=this.rangeMapping.get(e.sheet),e=p(e,t);return null==r?void 0:r.get(e)}fetchRange(e,t){e=this.getRange(e,t);if(e)return e;throw Error("Range does not exist")}truncateRanges(e,r){var t,n,i=Array(),o=Array(),s=Array(),a=e.sheet;for([t,n]of this.entriesFromSheet(e.sheet)){var l=n.range;e.start<=r(n.range.end)&&(l.removeSpan(e),l.shouldBeRemoved()?(this.removeByKey(a,t),i.push(n)):o.push([t,n]),s.push(n))}var c=[];o.sort((e,t)=>f(e[1],t[1],r));for(const[d,h]of o){var u=p((u=h.range).start,u.end);u!==d&&(u=this.getByKey(a,u),this.removeByKey(a,d),void 0!==u&&h!=u?c.push([u,h]):this.setRange(h))}return{verticesToRemove:i,verticesToMerge:c,verticesWithChangedSize:s}}moveAllRangesInSheetAfterRowByRows(e,r,n){return this.updateVerticesFromSheet(e,(e,t)=>r<=t.start.row?(t.range.shiftByRows(n),{changedSize:!1,vertex:t}):r>t.start.row&&r<=t.end.row?(t.range.expandByRows(n),{changedSize:!0,vertex:t}):void 0)}moveAllRangesInSheetAfterColumnByColumns(e,r,n){return this.updateVerticesFromSheet(e,(e,t)=>r<=t.start.col?(t.range.shiftByColumns(n),{changedSize:!1,vertex:t}):r>t.start.col&&r<=t.end.col?(t.range.expandByColumns(n),{changedSize:!0,vertex:t}):void 0)}moveRangesInsideSourceRange(r,n,i,o){this.updateVerticesFromSheet(r.sheet,(e,t)=>{if(r.containsRange(t.range))return t.range.shiftByColumns(n),t.range.shiftByRows(i),t.range.moveToSheet(o),{changedSize:!1,vertex:t}})}removeRangesInSheet(e){var t;return this.rangeMapping.has(e)?(t=this.rangeMapping.get(e).values(),this.rangeMapping.delete(e),t):[][Symbol.iterator]()}*rangesInSheet(e){e=this.rangeMapping.get(e);e&&(yield*e.values())}*rangeVerticesContainedInRange(e){for(const t of this.rangesInSheet(e.sheet))e.containsRange(t.range)&&(yield t)}findSmallerRange(e){if(1<e.height()&&Number.isFinite(e.height())){var t=(0,i.simpleCellAddress)(e.end.sheet,e.end.col,e.end.row-1),t=this.getRange(e.start,t);if(void 0!==t)return{smallerRangeVertex:t,restRange:n.AbsoluteCellRange.fromSimpleCellAddresses((0,i.simpleCellAddress)(e.start.sheet,e.start.col,e.end.row),e.end)}}return{restRange:e}}*entriesFromSheet(e){e=this.rangeMapping.get(e);e&&(yield*e.entries())}removeByKey(e,t){this.rangeMapping.get(e).delete(t)}getByKey(e,t){return null==(e=this.rangeMapping.get(e))?void 0:e.get(t)}updateVerticesFromSheet(e,t){var r,n,i=Array();for([r,n]of this.entriesFromSheet(e)){var o=t(r,n);void 0!==o&&(this.removeByKey(e,r),i.push(o))}return i.forEach(e=>{this.setRange(e.vertex)}),{verticesWithChangedSize:i.filter(e=>e.changedSize).map(e=>e.vertex)}}}function p(e,t){return`${e.col},${e.row},${t.col},`+t.row}const f=(e,t,r)=>{var n=r(e.range.start),i=r(e.range.start);return n===i?r(e.range.end)-r(t.range.end):n-i}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{SheetMapping:()=>a});var i=r(77),n=r(88);function o(e){return e.toLowerCase()}class s{constructor(e,t){this.id=e,this.displayName=t}get canonicalName(){return o(this.displayName)}}class a{constructor(e){this.languages=e,this.mappingFromCanonicalName=new Map,this.mappingFromId=new Map,this.lastSheetId=-1,this.fetch=e=>{var t=this.mappingFromCanonicalName.get(o(e));if(void 0===t)throw new i.NoSheetWithNameError(e);return t.id},this.get=e=>{return null==(e=this.mappingFromCanonicalName.get(o(e)))?void 0:e.id},this.fetchDisplayName=e=>this.fetchSheetById(e).displayName,this.sheetNamePrefix=e.getUITranslation(n.UIElement.NEW_SHEET_PREFIX)}addSheet(e=""+this.sheetNamePrefix+(this.lastSheetId+2)){var t=o(e);if(this.mappingFromCanonicalName.has(t))throw new i.SheetNameAlreadyTakenError(e);this.lastSheetId++;t=new s(this.lastSheetId,e);return this.store(t),t.id}removeSheet(e){var t=this.fetchSheetById(e);e==this.lastSheetId&&--this.lastSheetId,this.mappingFromCanonicalName.delete(t.canonicalName),this.mappingFromId.delete(t.id)}getDisplayName(e){return null==(e=this.mappingFromId.get(e))?void 0:e.displayName}*displayNames(){for(const e of this.mappingFromCanonicalName.values())yield e.displayName}numberOfSheets(){return this.mappingFromCanonicalName.size}hasSheetWithId(e){return this.mappingFromId.has(e)}hasSheetWithName(e){return this.mappingFromCanonicalName.has(o(e))}renameSheet(e,t){var e=this.fetchSheetById(e),r=e.displayName;if(r!==t){var n=this.mappingFromCanonicalName.get(o(t));if(void 0!==n&&n.id!==e.id)throw new i.SheetNameAlreadyTakenError(t);n=e.canonicalName;return this.mappingFromCanonicalName.delete(n),e.displayName=t,this.store(e),r}}sheetNames(){return Array.from(this.mappingFromId.values()).map(e=>e.displayName)}store(e){this.mappingFromId.set(e.id,e),this.mappingFromCanonicalName.set(e.canonicalName,e)}fetchSheetById(e){var t=this.mappingFromId.get(e);if(void 0===t)throw new i.NoSheetWithIdError(e);return t}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{TranslationPackage:()=>i.TranslationPackage,UIElement:()=>n,buildTranslationPackage:()=>i.buildTranslationPackage});var n,i=r(89);(n=n||{}).NEW_SHEET_PREFIX="NEW_SHEET_PREFIX"},(e,t,r)=>{"use strict";r.r(t),r.d(t,{TranslationPackage:()=>s,buildTranslationPackage:()=>function(e){return new s(Object.assign({},e.functions),Object.assign({},e.errors),Object.assign({},e.ui))}});var n=r(3),i=r(77),o=r(88);class s{constructor(e,t,r){this.functions=e,this.errors=t,this.ui=r,this._protectedTranslations={VERSION:"VERSION"},this.checkUI(),this.checkErrors(),this.checkFunctionTranslations(this.functions),Object.assign(this.functions,this._protectedTranslations)}extendFunctions(e){this.checkFunctionTranslations(e),Object.assign(this.functions,e)}buildFunctionMapping(){return Object.keys(this.functions).reduce((e,t)=>(e[this.functions[t]]=t,e),{})}buildErrorMapping(){return Object.keys(this.errors).reduce((e,t)=>(e[this.errors[t]]=t,e),{})}isFunctionTranslated(e){return void 0!==this.functions[e]}getFunctionTranslations(e){var t=[];for(const r of e)this.isFunctionTranslated(r)&&t.push(this.functions[r]);return t}getFunctionTranslation(e){var t=this.functions[e];if(void 0===t)throw new i.MissingTranslationError("functions."+e);return t}getMaybeFunctionTranslation(e){return this.functions[e]}getErrorTranslation(e){if(e===n.ErrorType.LIC)return`#${n.ErrorType.LIC}!`;var t=this.errors[e];if(void 0===t)throw new i.MissingTranslationError("errors."+e);return t}getUITranslation(e){var t=this.ui[e];if(void 0===t)throw new i.MissingTranslationError("ui."+e);return t}checkUI(){for(const e of Object.values(o.UIElement))if(!(e in this.ui))throw new i.MissingTranslationError("ui."+e)}checkErrors(){for(const e of Object.values(n.ErrorType))if(!(e in this.errors)&&e!==n.ErrorType.LIC)throw new i.MissingTranslationError("errors."+e)}checkFunctionTranslations(e){var t=new Set(Object.getOwnPropertyNames(e));for(const r of Object.getOwnPropertyNames(this._protectedTranslations))if(t.has(r))throw new i.ProtectedFunctionTranslationError(r)}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{EmptyCellVertex:()=>i});var n=r(70);class i{constructor(){}getCellValue(){return n.EmptyValue}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{ValueCellVertex:()=>n});class n{constructor(e,t){this.parsedValue=e,this.rawValue=t}getValues(){return{parsedValue:this.parsedValue,rawValue:this.rawValue}}setValues(e){this.parsedValue=e.parsedValue,this.rawValue=e.rawValue}getCellValue(){return this.parsedValue}setCellValue(e){throw Error("SetCellValue is deprecated for ValueCellVertex")}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{ParsingErrorVertex:()=>i});var n=r(3);class i{constructor(e,t){this.errors=e,this.rawInput=t}getCellValue(){var e=this.errors.map(e=>e.message).find(e=>e);return n.CellError.parsingError(e)}getFormula(){return this.rawInput}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{SparseStrategy:()=>n});var o=r(3);class n{constructor(e,t){this.width=e,this.height=t,this.mapping=new Map}getCell(e){var t;return null==(t=this.mapping.get(e.col))?void 0:t.get(e.row)}setCell(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1);let r=this.mapping.get(e.col);r||(r=new Map,this.mapping.set(e.col,r)),r.set(e.row,t)}has(e){var t;return!(null==(t=this.mapping.get(e.col))||!t.get(e.row))}getHeight(){return this.height}getWidth(){return this.width}removeCell(e){var t;null!=(t=this.mapping.get(e.col))&&t.delete(e.row)}addRows(i,o){this.mapping.forEach(r=>{const n=new Map;r.forEach((e,t)=>{i<=t&&(n.set(t+o,e),r.delete(t))}),n.forEach((e,t)=>{r.set(t,e)})}),this.height+=o}addColumns(r,n){const i=new Map;this.mapping.forEach((e,t)=>{r<=t&&(i.set(t+n,e),this.mapping.delete(t))}),i.forEach((e,t)=>{this.mapping.set(t,e)}),this.width+=n}removeRows(i){this.mapping.forEach(r=>{const n=new Map;r.forEach((e,t)=>{t>=i.rowStart&&(r.delete(t),t>i.rowEnd)&&n.set(t-i.numberOfRows,e)}),n.forEach((e,t)=>{r.set(t,e)})});var e=Math.min(this.height-1,i.rowEnd),e=Math.max(0,e-i.rowStart+1);this.height=Math.max(0,this.height-e)}removeColumns(r){const n=new Map;this.mapping.forEach((e,t)=>{t>=r.columnStart&&(this.mapping.delete(t),t>r.columnEnd)&&n.set(t-r.numberOfColumns,e)}),n.forEach((e,t)=>{this.mapping.set(t,e)});var e=Math.min(this.width-1,r.columnEnd),e=Math.max(0,e-r.columnStart+1);this.width=Math.max(0,this.width-e)}*getEntries(e){for(var[t,r]of this.mapping)for(var[n,i]of r)yield[(0,o.simpleCellAddress)(e,t,n),i]}*verticesFromColumn(e){e=this.mapping.get(e);if(void 0!==e)for(var[t,r]of e)yield r}*verticesFromRow(e){for(const r of this.mapping.values()){var t=r.get(e);void 0!==t&&(yield t)}}*verticesFromColumnsSpan(e){for(const i of e.columns()){var t=this.mapping.get(i);if(void 0!==t)for(var[r,n]of t)yield n}}*verticesFromRowsSpan(e){for(const r of this.mapping.values())for(const n of e.rows()){var t=r.get(n);void 0!==t&&(yield t)}}*entriesFromRowsSpan(e){for(var[t,r]of this.mapping.entries())for(const i of e.rows()){var n=r.get(i);void 0!==n&&(yield[(0,o.simpleCellAddress)(e.sheet,t,i),n])}}*entriesFromColumnsSpan(e){for(const i of e.columns()){var t=this.mapping.get(i);if(void 0!==t)for(var[r,n]of t.entries())yield[(0,o.simpleCellAddress)(e.sheet,i,r),n]}}*vertices(){for(var[e,t]of this.mapping)for(var[r,n]of t)void 0!==n&&(yield n)}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{DenseStrategy:()=>n});var i=r(3);class n{constructor(t,r){this.width=t,this.height=r,this.mapping=new Array(r);for(let e=0;e<r;e++)this.mapping[e]=new Array(t)}getCell(e){return this.getCellVertex(e.col,e.row)}setCell(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1),this.mapping[e.row]||(this.mapping[e.row]=new Array(this.width)),this.mapping[e.row][e.col]=t}has(e){var t=this.mapping[e.row];return!!t&&!!t[e.col]}getHeight(){return this.height}getWidth(){return this.width}removeCell(e){void 0!==this.mapping[e.row]&&delete this.mapping[e.row][e.col]}addRows(e,t){var r=[];for(let e=0;e<t;e++)r.push(new Array(this.width));this.mapping.splice(e,0,...r),this.height+=t}addColumns(t,r){for(let e=0;e<this.height;e++)this.mapping[e].splice(t,0,...new Array(r));this.width+=r}removeRows(e){this.mapping.splice(e.rowStart,e.numberOfRows);var t=Math.min(this.height-1,e.rowEnd),t=Math.max(0,t-e.rowStart+1);this.height=Math.max(0,this.height-t)}removeColumns(t){for(let e=0;e<this.height;e++)this.mapping[e].splice(t.columnStart,t.numberOfColumns);var e=Math.min(this.width-1,t.columnEnd),e=Math.max(0,e-t.columnStart+1);this.width=Math.max(0,this.width-e)}*getEntries(r){for(let t=0;t<this.height;++t)for(let e=0;e<this.width;++e){var n=this.getCellVertex(e,t);n&&(yield[(0,i.simpleCellAddress)(r,e,t),n])}}*verticesFromColumn(t){for(let e=0;e<this.height;++e){var r=this.getCellVertex(t,e);r&&(yield r)}}*verticesFromRow(t){for(let e=0;e<this.width;++e){var r=this.getCellVertex(e,t);r&&(yield r)}}*verticesFromColumnsSpan(e){for(let t=e.columnStart;t<=e.columnEnd;++t)for(let e=0;e<this.height;++e){var r=this.getCellVertex(t,e);r&&(yield r)}}*verticesFromRowsSpan(r){for(let t=0;t<this.width;++t)for(let e=r.rowStart;e<=r.rowEnd;++e){var n=this.getCellVertex(t,e);n&&(yield n)}}*entriesFromRowsSpan(r){for(let t=0;t<this.width;++t)for(let e=r.rowStart;e<=r.rowEnd;++e){var n=this.getCellVertex(t,e);n&&(yield[(0,i.simpleCellAddress)(r.sheet,t,e),n])}}*entriesFromColumnsSpan(r){for(let t=r.columnStart;t<=r.columnEnd;++t)for(let e=0;e<this.height;++e){var n=this.getCellVertex(t,e);n&&(yield[(0,i.simpleCellAddress)(r.sheet,t,e),n])}}*vertices(){for(let t=0;t<this.height;++t)for(let e=0;e<this.width;++e){var r=this.getCellVertex(e,t);r&&(yield r)}}getCellVertex(e,t){return null==(t=this.mapping[t])?void 0:t[e]}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{InterpreterState:()=>n});class n{constructor(e,t,r){this.formulaAddress=e,this.arraysFlag=t,this.formulaVertex=r}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{EmptyValue:()=>i.EmptyValue,FunctionArgumentType:()=>n.FunctionArgumentType,FunctionPlugin:()=>n.FunctionPlugin});var n=r(97),i=r(70)},(e,t,r)=>{"use strict";r.r(t),r.d(t,{FunctionArgumentType:()=>l,FunctionPlugin:()=>n});var l,c=r(2),u=r(3),d=r(61),h=r(7),a=r(98),p=r(70),f=r(69);(t=l=l||{}).STRING="STRING",t.NUMBER="NUMBER",t.BOOLEAN="BOOLEAN",t.SCALAR="SCALAR",t.NOERROR="NOERROR",t.RANGE="RANGE",t.INTEGER="INTEGER",t.COMPLEX="COMPLEX",t.ANY="ANY";class n{constructor(e){this.coerceScalarToNumberOrError=e=>this.arithmeticHelper.coerceScalarToNumberOrError(e),this.runFunction=(e,r,n,i)=>{var e=this.evaluateArguments(e,r,n);const o=e.map(([e])=>e),s=e.map(([,e])=>e),a=this.buildMetadataForEachArgumentValue(o.length,n),l=r.arraysFlag&&!n.vectorizationForbidden;if(!this.isNumberOfArgumentValuesValid(a,o.length))return new u.CellError(u.ErrorType.NA,d.ErrorMessage.WrongArgNumber);const[t,c]=l?this.calculateSizeOfVectorizedResultArray(o,a):[1,1];return 1===t&&1===c?(e=this.vectorizeAndBroadcastArgumentsIfNecessary(l,o,a,0,0),this.calculateSingleCellOfResultArray(r,e,a,s,i,n.returnNumberType)):(e=[...Array(t).keys()].map(t=>[...Array(c).keys()].map(e=>{e=this.vectorizeAndBroadcastArgumentsIfNecessary(l,o,a,t,e),e=this.calculateSingleCellOfResultArray(r,e,a,s,i,n.returnNumberType);if(e instanceof f.SimpleRangeValue)throw new Error("Function returning array cannot be vectorized.");return e})),f.SimpleRangeValue.onlyValues(e))},this.runFunctionWithReferenceArgument=(e,t,r,n,i,o=()=>new u.CellError(u.ErrorType.NA,d.ErrorMessage.CellRefExpected))=>{if(0===e.length)return this.returnNumberWrapper(n(),r.returnNumberType);if(1<e.length)return new u.CellError(u.ErrorType.NA,d.ErrorMessage.WrongArgNumber);let s=e[0];for(;s.type===h.AstNodeType.PARENTHESIS;)s=s.expression;let a;if(s.type===h.AstNodeType.CELL_REFERENCE)a=s.reference.toSimpleCellAddress(t.formulaAddress);else if(s.type===h.AstNodeType.CELL_RANGE||s.type===h.AstNodeType.COLUMN_RANGE||s.type===h.AstNodeType.ROW_RANGE)try{a=c.AbsoluteCellRange.fromAst(s,t.formulaAddress).start}catch(e){return new u.CellError(u.ErrorType.REF,d.ErrorMessage.CellRefExpected)}return void 0!==a?this.returnNumberWrapper(i(a),r.returnNumberType):this.runFunction(e,t,r,o)},this.interpreter=e,this.dependencyGraph=e.dependencyGraph,this.columnSearch=e.columnSearch,this.config=e.config,this.serialization=e.serialization,this.arraySizePredictor=e.arraySizePredictor,this.dateTimeHelper=e.dateTimeHelper,this.arithmeticHelper=e.arithmeticHelper}evaluateAst(e,t){return this.interpreter.evaluateAst(e,t)}arraySizeForAst(e,t){return this.arraySizePredictor.checkArraySizeForAst(e,t)}listOfScalarValues(e,t){var r=[];for(const i of e){var n=this.evaluateAst(i,t);if(n instanceof f.SimpleRangeValue)for(const o of n.valuesFromTopLeftCorner())r.push([o,!0]);else r.push([n,!1])}return r}coerceToType(e,t,r){let n;if(e instanceof f.SimpleRangeValue)switch(t.argumentType){case l.RANGE:case l.ANY:n=e;break;default:var i=(0,a.coerceRangeToScalar)(e,r);if(void 0===i)return;e=i}if(!(e instanceof f.SimpleRangeValue))switch(t.argumentType){case l.INTEGER:case l.NUMBER:var o=this.coerceScalarToNumberOrError(e);if((0,p.isExtendedNumber)(o)){var s=(0,p.getRawValue)(o);if(void 0!==t.maxValue&&s>t.maxValue)return new u.CellError(u.ErrorType.NUM,d.ErrorMessage.ValueLarge);if(void 0!==t.minValue&&s<t.minValue)return new u.CellError(u.ErrorType.NUM,d.ErrorMessage.ValueSmall);if(void 0!==t.lessThan&&s>=t.lessThan)return new u.CellError(u.ErrorType.NUM,d.ErrorMessage.ValueLarge);if(void 0!==t.greaterThan&&s<=t.greaterThan)return new u.CellError(u.ErrorType.NUM,d.ErrorMessage.ValueSmall);if(t.argumentType===l.INTEGER&&!Number.isInteger(s))return new u.CellError(u.ErrorType.NUM,d.ErrorMessage.IntegerExpected)}n=o;break;case l.STRING:n=(0,a.coerceScalarToString)(e);break;case l.BOOLEAN:n=(0,a.coerceScalarToBoolean)(e);break;case l.SCALAR:case l.NOERROR:case l.ANY:n=e;break;case l.RANGE:if(e instanceof u.CellError)return e;n=(0,a.coerceToRange)(e);break;case l.COMPLEX:return this.arithmeticHelper.coerceScalarToComplex((0,p.getRawValue)(e))}return t.passSubtype||void 0===n?n:(0,p.getRawValue)(n)}calculateSingleCellOfResultArray(e,t,r,n,i,o){e=this.coerceArgumentsToRequiredTypes(e,t,r,n);return e instanceof u.CellError?e:(t=i(...e),this.returnNumberWrapper(t,o))}coerceArgumentsToRequiredTypes(t,r,n,i){var o=[];for(let e=0;e<n.length;e++){var s=n[e],a=void 0!==r[e]?r[e]:null==s?void 0:s.defaultValue;if(void 0===a)o.push(void 0);else{a=this.coerceToType(a,s,t);if(void 0===a&&!i[e])return new u.CellError(u.ErrorType.VALUE,d.ErrorMessage.WrongType);if(a instanceof u.CellError&&s.argumentType!==l.SCALAR)return a;o.push(a)}}return o}vectorizeAndBroadcastArgumentsIfNecessary(r,e,n,i,o){return e.map((e,t)=>r&&this.isRangePassedAsAScalarArgument(e,n[t])?this.vectorizeAndBroadcastRangeArgument(e,i,o):e)}vectorizeAndBroadcastRangeArgument(e,t,r){t=1===e.height()?0:t,r=1===e.width()?0:r;return null==(e=e.data[t])?void 0:e[r]}evaluateArguments(e,t,r){return r.expandRanges?this.listOfScalarValues(e,t):e.map(e=>[this.evaluateAst(e,t),!1])}buildMetadataForEachArgumentValue(e,t){var r=t.parameters?[...t.parameters]:[];if(void 0!==t.repeatLastArgs&&Number.isInteger(t.repeatLastArgs)&&0<t.repeatLastArgs)for(;e>r.length;)r.push(...r.slice(r.length-t.repeatLastArgs));return r}isNumberOfArgumentValuesValid(e,t){return!(t>e.length)&&(!(t<e.length)||e.slice(t).every(e=>(null==e?void 0:e.optionalArg)||void 0!==(null==e?void 0:e.defaultValue)))}calculateSizeOfVectorizedResultArray(e,r){e=e.filter((e,t)=>this.isRangePassedAsAScalarArgument(e,r[t]));return[Math.max(1,...e.map(e=>e.height())),Math.max(1,...e.map(e=>e.width()))]}isRangePassedAsAScalarArgument(e,t){return null!=e&&null!=t&&e instanceof f.SimpleRangeValue&&![l.RANGE,l.ANY].includes(t.argumentType)}metadata(e){var t=this.constructor.implementedFunctions[e];if(void 0!==t)return t;throw new Error(`No metadata for function ${e}.`)}returnNumberWrapper(e,t,r){return void 0!==t&&(0,p.isExtendedNumber)(e)?this.arithmeticHelper.ExtendedNumberFactory((0,p.getRawValue)(e),{type:t,format:r}):e}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{ArithmeticHelper:()=>a,coerceBooleanToNumber:()=>d,coerceComplexToString:()=>function([e,t],r){if(!isFinite(e)||!isFinite(t))return new l.CellError(l.ErrorType.NUM,n.ErrorMessage.NaN);if(r=null!=r?r:o,0===t)return""+e;r=""+(-1===t||1===t?"":Math.abs(t))+r;return 0!==e?e+(t<0?"-":"+")+r:(t<0?"-":"")+r},coerceEmptyToValue:()=>h,coerceRangeToScalar:()=>function(e,t){if(e.isAdHoc())return null==(r=e.data[0])?void 0:r[0];var r=e.range;if(t.formulaAddress.sheet===r.sheet)if(1===r.width()){var n=t.formulaAddress.row-r.start.row;if(0<=n&&n<r.height())return e.data[n][0]}else if(1===r.height()){n=t.formulaAddress.col-r.start.col;if(0<=n&&n<r.width())return e.data[0][n]}return},coerceScalarToBoolean:()=>function(e){return e instanceof l.CellError||"boolean"==typeof e?e:e!==c.EmptyValue&&((0,c.isExtendedNumber)(e)?0!==(0,c.getRawValue)(e):"TRUE"===(e=e.toUpperCase())||"FALSE"!==e&&""!==e&&void 0)},coerceScalarToString:()=>function(e){return e instanceof l.CellError||"string"==typeof e?e:e===c.EmptyValue?"":(0,c.isExtendedNumber)(e)?(0,c.getRawValue)(e).toString():e?"TRUE":"FALSE"},coerceToRange:()=>function(e){return e instanceof u.SimpleRangeValue?e:u.SimpleRangeValue.fromScalar(e)},coerceToRangeNumbersOrError:()=>function(e){return e instanceof u.SimpleRangeValue&&e.hasOnlyNumbers()||e instanceof l.CellError?e:(0,c.isExtendedNumber)(e)?u.SimpleRangeValue.fromScalar(e):null},fixNegativeZero:()=>function(e){return 0===e?0:e},forceNormalizeString:()=>function(e){return b(e.toLowerCase(),"nfd").replace(/[\u0300-\u036f]/g,"")},isNumberOverflow:()=>function(e){return isNaN(e)||e===1/0||e===-1/0},normalizeString:()=>b,numberCmp:()=>p,zeroIfEmpty:()=>function(e){return e===c.EmptyValue?0:e}});var l=r(3),n=r(61),i=r(99),c=r(70),u=r(69);const o="i",s=/^\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij]))\s*(([+-])\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij])))?$/;class a{constructor(e,t,r){this.config=e,this.dateTimeHelper=t,this.numberLiteralsHelper=r,this.lt=(e,t)=>this.compare(e,t)<0,this.leq=(e,t)=>this.compare(e,t)<=0,this.gt=(e,t)=>0<this.compare(e,t),this.geq=(e,t)=>0<=this.compare(e,t),this.eq=(e,t)=>0===this.compare(e,t),this.neq=(e,t)=>0!==this.compare(e,t),this.pow=(e,t)=>Math.pow((0,c.getRawValue)(e),(0,c.getRawValue)(t)),this.addWithEpsilonRaw=(e,t)=>{t=e+t;return Math.abs(t)<this.actualEps*Math.abs(e)?0:t},this.addWithEpsilon=(e,t)=>{var r=y(e,t);return this.ExtendedNumberFactory(this.addWithEpsilonRaw((0,c.getRawValue)(e),(0,c.getRawValue)(t)),r)},this.unaryMinus=e=>(0,c.cloneNumber)(e,-(0,c.getRawValue)(e)),this.unaryPlus=e=>e,this.unaryPercent=e=>new c.PercentNumber((0,c.getRawValue)(e)/100),this.concat=(e,t)=>e.concat(t),this.nonstrictadd=(e,t)=>e instanceof l.CellError?e:t instanceof l.CellError?t:"number"==typeof e?"number"==typeof t?this.addWithEpsilonRaw(e,t):e:"number"==typeof t?t:0,this.subtract=(e,t)=>{var r=y(e,t),e=(0,c.getRawValue)(e);let n=e-(0,c.getRawValue)(t);return Math.abs(n)<this.actualEps*Math.abs(e)&&(n=0),this.ExtendedNumberFactory(n,r)},this.divide=(e,t)=>{var r=(0,c.getRawValue)(e),n=(0,c.getRawValue)(t);return 0===n?new l.CellError(l.ErrorType.DIV_BY_ZERO):(e=v(e,t),this.ExtendedNumberFactory(r/n,e))},this.multiply=(e,t)=>{var r=v(e,t);return this.ExtendedNumberFactory((0,c.getRawValue)(e)*(0,c.getRawValue)(t),r)},this.manyToExactComplex=e=>{var t,r=[];for(const n of e){if(n instanceof l.CellError)return n;!(0,c.isExtendedNumber)(n)&&"string"!=typeof n||(t=this.coerceScalarToComplex(n))instanceof l.CellError||r.push(t)}return r},this.coerceNumbersExactRanges=e=>this.manyToNumbers(e,this.manyToExactNumbers),this.coerceNumbersCoerceRangesDropNulls=e=>this.manyToNumbers(e,this.manyToCoercedNumbersDropNulls),this.manyToExactNumbers=e=>{var t=[];for(const r of e){if(r instanceof l.CellError)return r;(0,c.isExtendedNumber)(r)&&t.push((0,c.getRawValue)(r))}return t},this.manyToOnlyNumbersDropNulls=e=>{var t=[];for(const r of e){if(r instanceof l.CellError)return r;if((0,c.isExtendedNumber)(r))t.push((0,c.getRawValue)(r));else if(r!==c.EmptyValue)return new l.CellError(l.ErrorType.VALUE,n.ErrorMessage.NumberExpected)}return t},this.manyToCoercedNumbersDropNulls=e=>{var t,r=[];for(const n of e){if(n instanceof l.CellError)return n;n!==c.EmptyValue&&(t=this.coerceScalarToNumberOrError(n),(0,c.isExtendedNumber)(t))&&r.push((0,c.getRawValue)(t))}return r},this.collator=(0,i.collatorFromConfig)(e),this.actualEps=e.smartRounding?e.precisionEpsilon:0}eqMatcherFunction(e){const t=this.buildRegex(e);return e=>"string"==typeof e&&t.test(this.normalizeString(e))}neqMatcherFunction(e){const t=this.buildRegex(e);return e=>!("string"==typeof e&&t.test(this.normalizeString(e)))}searchString(e,t){e=this.buildRegex(e,!1).exec(t);return null!=(t=null==e?void 0:e.index)?t:-1}requiresRegex(t){if(!this.config.useRegularExpressions&&!this.config.useWildcards)return!this.config.matchWholeCell;for(let e=0;e<t.length;e++){var r=t.charAt(e);if(f(r)||this.config.useRegularExpressions&&m(r))return!0}return!1}floatCmp(e,t){var e=(0,c.getRawValue)(e),t=(0,c.getRawValue)(t),r=1+this.actualEps;return 0<=t&&t<=e*r&&e<=t*r||t<=0&&e*r<=t&&t*r<=e?0:t<e?1:-1}coerceScalarToNumberOrError(e){return e instanceof l.CellError||null!=(e=this.coerceToMaybeNumber(e))?e:new l.CellError(l.ErrorType.VALUE,n.ErrorMessage.NumberCoercion)}coerceToMaybeNumber(e){var t;return null!=(t=this.coerceNonDateScalarToMaybeNumber(e))?t:"string"==typeof e?this.dateTimeHelper.dateStringToDateNumber(e):void 0}coerceNonDateScalarToMaybeNumber(e){var t;return e===c.EmptyValue?0:"string"==typeof e?""===e?0:void 0!==(t=this.coerceStringToMaybePercentNumber(e))?t:void 0!==(t=this.coerceStringToMaybeCurrencyNumber(e))?t:this.numberLiteralsHelper.numericStringToMaybeNumber(e.trim()):(0,c.isExtendedNumber)(e)?e:"boolean"==typeof e?Number(e):void 0}coerceStringToMaybePercentNumber(e){e=e.trim();if(e.endsWith("%")){e=e.slice(0,e.length-1).trim(),e=this.numberLiteralsHelper.numericStringToMaybeNumber(e);if(void 0!==e)return new c.PercentNumber(e/100)}}coerceStringToMaybeCurrencyNumber(e){e=this.currencyMatcher(e.trim());if(void 0!==e){var[e,t]=e,t=this.numberLiteralsHelper.numericStringToMaybeNumber(t);if(void 0!==t)return new c.CurrencyNumber(t,e)}}currencyMatcher(e){for(const t of this.config.currencySymbol){if(e.startsWith(t))return[t,e.slice(t.length).trim()];if(e.endsWith(t))return[t,e.slice(0,e.length-t.length).trim()]}}coerceComplexExactRanges(e){var t=[];for(const o of e)if(o instanceof u.SimpleRangeValue)t.push(o);else if(o!==c.EmptyValue){var r=this.coerceScalarToComplex(o);if(r instanceof l.CellError)return r;t.push(r)}var n=[];for(const s of t)if(s instanceof u.SimpleRangeValue){var i=this.manyToExactComplex(s.valuesFromTopLeftCorner());if(i instanceof l.CellError)return i;n.push(...i)}else n.push(s);return n}coerceScalarToComplex(e){return e instanceof l.CellError?e:e===c.EmptyValue?[0,0]:(0,c.isExtendedNumber)(e)?[(0,c.getRawValue)(e),0]:"string"==typeof e?this.coerceStringToComplex(e):new l.CellError(l.ErrorType.NUM,n.ErrorMessage.ComplexNumberExpected)}ExtendedNumberFactory(e,t){var{type:t,format:r}=t;switch(t){case c.NumberType.NUMBER_RAW:return e;case c.NumberType.NUMBER_CURRENCY:return new c.CurrencyNumber(e,null!=r?r:this.config.currencySymbol[0]);case c.NumberType.NUMBER_DATE:return new c.DateNumber(e,r);case c.NumberType.NUMBER_DATETIME:return new c.DateTimeNumber(e,r);case c.NumberType.NUMBER_TIME:return new c.TimeNumber(e,r);case c.NumberType.NUMBER_PERCENT:return new c.PercentNumber(e,r)}}buildRegex(e,t=!0){e=this.normalizeString(e);let r,n=this.config.useWildcards,i=this.config.useRegularExpressions;if(i)try{RegExp(e)}catch(e){i=!1,n=!1}return r=(i?function(t,r){let n="";for(let e=0;e<t.length;e++){var i=t.charAt(e);f(i)||m(i)?n+=i:n+=r?i:i.toLowerCase()}return n}:n?function(t,r){let n="";for(let e=0;e<t.length;e++){var i,o=t.charAt(e);"~"===o?e==t.length-1?n+="~":(f(i=t.charAt(e+1))||m(i)?n+="\\"+i:n+=i,e++):f(o)?n+="."+o:m(o)?n+="\\"+o:n+=r?o:o.toLowerCase()}return n}:function(t,r){let n="";for(let e=0;e<t.length;e++){var i=t.charAt(e);f(i)||m(i)?n+="\\"+i:n+=r?i:i.toLowerCase()}return n})(e,this.config.caseSensitive),this.config.matchWholeCell&&t?RegExp("^("+r+")$"):RegExp(r)}normalizeString(e){return this.config.caseSensitive||(e=e.toLowerCase()),e=this.config.accentSensitive?e:b(e,"nfd").replace(/[\u0300-\u036f]/g,"")}compare(e,t){if("string"==typeof e||"string"==typeof t){var r="string"==typeof e?this.dateTimeHelper.dateStringToDateNumber(e):e,n="string"==typeof t?this.dateTimeHelper.dateStringToDateNumber(t):t;if((0,c.isExtendedNumber)(r)&&(0,c.isExtendedNumber)(n))return this.floatCmp(r,n)}return e===c.EmptyValue?e=h(t):t===c.EmptyValue&&(t=h(e)),"string"==typeof e&&"string"==typeof t?this.stringCmp(e,t):"boolean"==typeof e&&"boolean"==typeof t?p(d(e),d(t)):(0,c.isExtendedNumber)(e)&&(0,c.isExtendedNumber)(t)?this.floatCmp(e,t):e===c.EmptyValue&&t===c.EmptyValue?0:p((0,l.CellValueTypeOrd)((0,l.getCellValueType)(e)),(0,l.CellValueTypeOrd)((0,l.getCellValueType)(t)))}stringCmp(e,t){return this.collator.compare(e,t)}manyToNumbers(e,t){var r=[];for(const s of e)if(s instanceof u.SimpleRangeValue)r.push(s);else{var n=(0,c.getRawValue)(this.coerceScalarToNumberOrError(s));if(n instanceof l.CellError)return n;r.push(n)}var i=[];for(const a of r)if(a instanceof u.SimpleRangeValue){var o=t(a.valuesFromTopLeftCorner());if(o instanceof l.CellError)return o;i.push(...o)}else i.push(a);return i}coerceStringToComplex(e){e=s.exec(e);if(null===e)return new l.CellError(l.ErrorType.NUM,n.ErrorMessage.ComplexNumberExpected);let t;if((t=void 0!==e[6]?"-"===e[1]?[0,-1]:[0,1]:this.parseComplexToken(e[1]+e[3],e[5]))instanceof l.CellError)return t;if(void 0===e[8])return t;let r;return(r=void 0!==e[14]?"-"===e[9]?[0,-1]:[0,1]:this.parseComplexToken(e[9]+e[11],e[13]))instanceof l.CellError?r:""!==e[5]||""===e[13]?new l.CellError(l.ErrorType.NUM,n.ErrorMessage.ComplexNumberExpected):"+"===e[8]?[t[0]+r[0],t[1]+r[1]]:[t[0]-r[0],t[1]-r[1]]}parseComplexToken(e,t){e=(0,c.getRawValue)(this.coerceNonDateScalarToMaybeNumber(e));return void 0===e?new l.CellError(l.ErrorType.NUM,n.ErrorMessage.ComplexNumberExpected):""===t?[e,0]:[0,e]}}function d(e){return Number(e)}function h(e){return"string"==typeof e?"":(0,c.isExtendedNumber)(e)?0:"boolean"!=typeof e&&c.EmptyValue}function p(e,t){e=(0,c.getRawValue)(e),t=(0,c.getRawValue)(t);return t<e?1:e<t?-1:0}function f(e){return["*","?"].includes(e)}const g=["{","}","[","]","(",")","<",">","=",".","+","-",",","\\","$","^","!"];function m(e){return g.includes(e)}function y(e,t){var{type:e,format:r}=(0,c.getTypeFormatOfExtendedNumber)(e),{type:t,format:n}=(0,c.getTypeFormatOfExtendedNumber)(t);if(e===c.NumberType.NUMBER_RAW)return{type:t,format:n};if(t!==c.NumberType.NUMBER_RAW){if(!(e!==c.NumberType.NUMBER_DATETIME&&e!==c.NumberType.NUMBER_DATE||t!==c.NumberType.NUMBER_DATETIME&&t!==c.NumberType.NUMBER_DATE))return{type:c.NumberType.NUMBER_RAW};if(e===c.NumberType.NUMBER_TIME){if(t===c.NumberType.NUMBER_DATE)return{type:c.NumberType.NUMBER_DATETIME,format:n+" "+r};if(t===c.NumberType.NUMBER_DATETIME)return{type:c.NumberType.NUMBER_DATETIME,format:n}}if(t===c.NumberType.NUMBER_TIME){if(e===c.NumberType.NUMBER_DATE)return{type:c.NumberType.NUMBER_DATETIME,format:r+" "+n};if(e===c.NumberType.NUMBER_DATETIME)return{type:c.NumberType.NUMBER_DATETIME,format:r}}}return{type:e,format:r}}function v(e,t){let{type:r,format:n}=(0,c.getTypeFormatOfExtendedNumber)(e),{type:i,format:o}=(0,c.getTypeFormatOfExtendedNumber)(t);return r===c.NumberType.NUMBER_PERCENT&&(r=c.NumberType.NUMBER_RAW,n=void 0),i===c.NumberType.NUMBER_PERCENT&&(i=c.NumberType.NUMBER_RAW,o=void 0),r===c.NumberType.NUMBER_RAW?{type:i,format:o}:i===c.NumberType.NUMBER_RAW?{type:r,format:n}:{type:c.NumberType.NUMBER_RAW}}function b(e,t){return e.normalize(t.toUpperCase())}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{collatorFromConfig:()=>function(e){var t=e.caseSensitive?e.accentSensitive?"variant":"case":e.accentSensitive?"accent":"base",r=e.caseFirst,n=e.ignorePunctuation;return new Intl.Collator(e.localeLang,{sensitivity:t,caseFirst:r,ignorePunctuation:n})}})},(e,t,r)=>{"use strict";r.r(t),r.d(t,{DetailedCellError:()=>n});class n{constructor(e,t,r){this.value=t,this.address=r,this.type=e.type,this.message=null!=(t=e.message)?t:""}toString(){return this.value}valueOf(){return this.value}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{Config:()=>Y,getDefaultConfig:()=>function(){return s({})}});var W=r(102),t=r(103),$=r(104),n=r(105),i=r(77),o=r(106),B=r(108),j=r(110);const z=new WeakMap;class Y{constructor(e={},t=!0){var{accentSensitive:r,binarySearchThreshold:n,caseSensitive:i,caseFirst:o,chooseAddressMappingPolicy:s,context:a,currencySymbol:l,dateFormats:c,decimalSeparator:u,evaluateNullToZero:d,functionArgSeparator:h,functionPlugins:p,ignorePunctuation:f,leapYear1900:g,localeLang:m,language:y,ignoreWhiteSpace:v,licenseKey:b,matchWholeCell:w,arrayColumnSeparator:C,arrayRowSeparator:E,maxRows:T,maxColumns:S,nullYear:_,nullDate:x,parseDateTime:R,precisionEpsilon:A,precisionRounding:N,stringifyDateTime:O,stringifyDuration:I,smartRounding:M,timeFormats:k,thousandSeparator:D,useArrayArithmetic:P,useStats:L,undoLimit:F,useColumnIndex:H,useRegularExpressions:U,useWildcards:V}=e;t&&Y.warnDeprecatedOptions(e),this.useArrayArithmetic=(0,W.configValueFromParam)(P,"boolean","useArrayArithmetic"),this.accentSensitive=(0,W.configValueFromParam)(r,"boolean","accentSensitive"),this.caseSensitive=(0,W.configValueFromParam)(i,"boolean","caseSensitive"),this.caseFirst=(0,W.configValueFromParam)(o,["upper","lower","false"],"caseFirst"),this.ignorePunctuation=(0,W.configValueFromParam)(f,"boolean","ignorePunctuation"),this.chooseAddressMappingPolicy=null!=s?s:Y.defaultConfig.chooseAddressMappingPolicy,this.dateFormats=[...(0,W.configValueFromParamCheck)(c,Array.isArray,"array","dateFormats")],this.timeFormats=[...(0,W.configValueFromParamCheck)(k,Array.isArray,"array","timeFormats")],this.functionArgSeparator=(0,W.configValueFromParam)(h,"string","functionArgSeparator"),this.decimalSeparator=(0,W.configValueFromParam)(u,[".",","],"decimalSeparator"),this.language=(0,W.configValueFromParam)(y,"string","language"),this.ignoreWhiteSpace=(0,W.configValueFromParam)(v,["standard","any"],"ignoreWhiteSpace"),this.licenseKey=(0,W.configValueFromParam)(b,"string","licenseKey"),this.thousandSeparator=(0,W.configValueFromParam)(D,["",","," ","."],"thousandSeparator"),this.arrayColumnSeparator=(0,W.configValueFromParam)(C,[",",";"],"arrayColumnSeparator"),this.arrayRowSeparator=(0,W.configValueFromParam)(E,[";","|"],"arrayRowSeparator"),this.localeLang=(0,W.configValueFromParam)(m,"string","localeLang"),this.functionPlugins=[...null!=p?p:Y.defaultConfig.functionPlugins],this.smartRounding=(0,W.configValueFromParam)(M,"boolean","smartRounding"),this.evaluateNullToZero=(0,W.configValueFromParam)(d,"boolean","evaluateNullToZero"),this.nullYear=(0,W.configValueFromParam)(_,"number","nullYear"),(0,W.validateNumberToBeAtLeast)(this.nullYear,"nullYear",0),(0,W.validateNumberToBeAtMost)(this.nullYear,"nullYear",100),this.precisionRounding=(0,W.configValueFromParam)(N,"number","precisionRounding"),(0,W.validateNumberToBeAtLeast)(this.precisionRounding,"precisionRounding",0),this.precisionEpsilon=(0,W.configValueFromParam)(A,"number","precisionEpsilon"),(0,W.validateNumberToBeAtLeast)(this.precisionEpsilon,"precisionEpsilon",0),this.useColumnIndex=(0,W.configValueFromParam)(H,"boolean","useColumnIndex"),this.useStats=(0,W.configValueFromParam)(L,"boolean","useStats"),this.binarySearchThreshold=null!=n?n:Y.defaultConfig.binarySearchThreshold,this.parseDateTime=(0,W.configValueFromParam)(R,"function","parseDateTime"),this.stringifyDateTime=(0,W.configValueFromParam)(O,"function","stringifyDateTime"),this.stringifyDuration=(0,W.configValueFromParam)(I,"function","stringifyDuration"),this.translationPackage=j.HyperFormula.getLanguage(this.language),this.errorMapping=this.translationPackage.buildErrorMapping(),this.nullDate=(0,W.configValueFromParamCheck)(x,$.instanceOfSimpleDate,"IDate","nullDate"),this.leapYear1900=(0,W.configValueFromParam)(g,"boolean","leapYear1900"),this.undoLimit=(0,W.configValueFromParam)(F,"number","undoLimit"),this.useRegularExpressions=(0,W.configValueFromParam)(U,"boolean","useRegularExpressions"),this.useWildcards=(0,W.configValueFromParam)(V,"boolean","useWildcards"),this.matchWholeCell=(0,W.configValueFromParam)(w,"boolean","matchWholeCell"),(0,W.validateNumberToBeAtLeast)(this.undoLimit,"undoLimit",0),this.maxRows=(0,W.configValueFromParam)(T,"number","maxRows"),(0,W.validateNumberToBeAtLeast)(this.maxRows,"maxRows",1),this.maxColumns=(0,W.configValueFromParam)(S,"number","maxColumns"),this.currencySymbol=this.setupCurrencySymbol(l),(0,W.validateNumberToBeAtLeast)(this.maxColumns,"maxColumns",1),this.context=a,z.set(this,{licenseKeyValidityState:(0,B.checkLicenseKeyValidity)(this.licenseKey)}),(0,W.configCheckIfParametersNotInConflict)({value:this.decimalSeparator,name:"decimalSeparator"},{value:this.functionArgSeparator,name:"functionArgSeparator"},{value:this.thousandSeparator,name:"thousandSeparator"}),(0,W.configCheckIfParametersNotInConflict)({value:this.arrayRowSeparator,name:"arrayRowSeparator"},{value:this.arrayColumnSeparator,name:"arrayColumnSeparator"})}setupCurrencySymbol(e){e=[...(0,W.configValueFromParamCheck)(e,Array.isArray,"array","currencySymbol")];return e.forEach(e=>{if("string"!=typeof e)throw new i.ExpectedValueOfTypeError("string[]","currencySymbol");if(""===e)throw new i.ConfigValueEmpty("currencySymbol")}),e}get licenseKeyValidityState(){return z.get(this).licenseKeyValidityState}getConfig(){return s(this)}mergeConfig(e){var t=Object.assign({},this.getConfig(),e);return Y.warnDeprecatedOptions(e),new Y(t,!1)}static warnDeprecatedOptions(e){Y.warnDeprecatedIfUsed(e.binarySearchThreshold,"binarySearchThreshold","1.1")}static warnDeprecatedIfUsed(e,t,r,n){void 0!==e&&(void 0===n?console.warn(t+" option is deprecated since "+r):console.warn(t+` option is deprecated since ${r}, please use `+n))}}function s(e){var t={};for(const n in Y.defaultConfig){var r=null!=(r=e[n])?r:Y.defaultConfig[n];Array.isArray(r)?t[n]=[...r]:t[n]=r}return t}Y.defaultConfig={accentSensitive:!1,binarySearchThreshold:20,currencySymbol:["$"],caseSensitive:!1,caseFirst:"lower",context:void 0,chooseAddressMappingPolicy:new n.AlwaysDense,dateFormats:["DD/MM/YYYY","DD/MM/YY"],decimalSeparator:".",evaluateNullToZero:!1,functionArgSeparator:",",functionPlugins:[],ignorePunctuation:!1,language:"enGB",ignoreWhiteSpace:"standard",licenseKey:"",leapYear1900:!1,localeLang:"en",matchWholeCell:!0,arrayColumnSeparator:",",arrayRowSeparator:";",maxRows:4e4,maxColumns:18278,nullYear:30,nullDate:{year:1899,month:12,day:30},parseDateTime:t.defaultParseToDateTime,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,stringifyDateTime:o.defaultStringifyDateTime,stringifyDuration:o.defaultStringifyDuration,timeFormats:["hh:mm","hh:mm:ss.sss"],thousandSeparator:"",undoLimit:20,useRegularExpressions:!1,useWildcards:!0,useColumnIndex:!1,useStats:!1,useArrayArithmetic:!1}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{configCheckIfParametersNotInConflict:()=>function(...e){const r=new Map,t=(e.forEach(e=>{var t=r.get(e.value)||[];t.push(e.name),r.set(e.value,t)}),[]);for(const n of r.values())1<n.length&&t.push(n);if(0<t.length)throw t.forEach(e=>e.sort()),e=t.map(e=>`[${e}]`).join("; "),new Error("Config initialization failed. Parameters in conflict: "+e)},configValueFromParam:()=>function(e,t,r){{if(void 0===e)return i.Config.defaultConfig[r];if("string"==typeof t){if(typeof e===t)return e;throw new o.ExpectedValueOfTypeError(t,r)}if(t.includes(e))return e;throw new o.ExpectedOneOfValuesError(t.map(e=>`'${e}'`).join(" "),r)}},configValueFromParamCheck:()=>function(e,t,r,n){{if(t(e))return e;if(void 0===e)return i.Config.defaultConfig[n];throw new o.ExpectedValueOfTypeError(r,n)}},validateArgToType:()=>function(e,t,r){if(typeof e!==t)throw new o.ExpectedValueOfTypeError(t,r)},validateNumberToBeAtLeast:()=>function(e,t,r){if(e<r)throw new o.ConfigValueTooSmallError(t,r)},validateNumberToBeAtMost:()=>function(e,t,r){if(r<e)throw new o.ConfigValueTooBigError(t,r)}});var i=r(101),o=r(77)},(e,t,r)=>{"use strict";r.r(t),r.d(t,{TIME_FORMAT_SECONDS_ITEM_REGEXP:()=>n,defaultParseToDateTime:()=>function(e,t,r){if(void 0===t&&void 0===r)return;let n=e.replace(a," ").trim().toLowerCase();if(!function(e){return s.test(e)}(n))return;let i=n.substring(n.length-2);"am"===i||"pm"===i?n=n.substring(0,n.length-2).trim():"a"===(i=n.substring(n.length-1))||"p"===i?n=n.substring(0,n.length-1).trim():i=void 0;e=n.split(l);2<=e.length&&e[e.length-2].includes(c)&&(e[e.length-2]=e[e.length-2]+"."+e[e.length-1],e.pop());var o=e[e.length-1].split(c);void 0!==i&&o.push(i);if(1===e.length)return p(o,r);if(1===o.length)return f(e,t);e=f(e.slice(0,e.length-1),t),t=p(o,r);if(void 0!==e&&void 0!==t)return Object.assign(Object.assign({},e),t)}});const n=new RegExp("^ss(\\.(s+|0+))?$"),s=new RegExp("^[0-9/.\\-: ]+[ap]?m?$"),a=new RegExp("\\s+"),l=new RegExp("[ /.-]"),c=":",u=1e3,d=i(function(e){var t=e.toLowerCase().trim(),e=t.endsWith("am/pm")?t.substring(0,t.length-5):t.endsWith("a/p")?t.substring(0,e.length-3):t,t=e.trim().split(c);return{itemsCount:t.length,hourItem:t.indexOf("hh"),minuteItem:t.indexOf("mm"),secondItem:t.findIndex(e=>n.test(e))}}),h=i(function(e){e=e.toLowerCase().trim().split(l);return{itemsCount:e.length,dayItem:e.indexOf("dd"),monthItem:e.indexOf("mm"),shortYearItem:e.indexOf("yy"),longYearItem:e.indexOf("yyyy")}});function p(t,r){if(void 0!==r){var{itemsCount:r,hourItem:n,minuteItem:i,secondItem:o}=d(r);let e=void 0;if("am"===t[t.length-1]||"a"===t[t.length-1]?(e=!1,t.pop()):"pm"!==t[t.length-1]&&"p"!==t[t.length-1]||(e=!0,t.pop()),t.length===r){var o=Number(null!=(r=t[o])?r:"0");if(Number.isFinite(o)){r=Math.round(o*u)/u,i=Number(null!=(o=t[i])?o:"0");if(Number.isFinite(i)&&Number.isInteger(i)){t=Number(null!=(o=t[n])?o:"0");if(Number.isFinite(t)&&Number.isInteger(t))if(void 0===e||!(t<0||12<t))return{hours:void 0!==e?t%12+(e?12:0):t,minutes:i,seconds:r}}}}}}function f(e,t){if(void 0!==t){var{itemsCount:t,dayItem:r,monthItem:n,shortYearItem:i,longYearItem:o}=h(t);if(e.length===t){t=Number(e[r]);if(Number.isFinite(t)&&Number.isInteger(t)){r=Number(e[n]);if(Number.isFinite(r)&&Number.isInteger(r)&&(!e[o]||!e[i])){n=Number(null!=(n=e[o])?n:e[i]);if(Number.isFinite(n)&&Number.isInteger(n)&&!(e[o]&&(n<1e3||9999<n)||e[i]&&(n<0||99<n)))return{year:n,month:r,day:t}}}}}}function i(r){const n={};return e=>{var t=n[e];return void 0!==t?t:(t=r(e),n[e]=t)}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{DateTimeHelper:()=>h,instanceOfSimpleDate:()=>c,instanceOfSimpleTime:()=>u,maxDate:()=>d,numberToSimpleTime:()=>p,offsetMonth:()=>function(e,t){t=12*e.year+e.month-1+t;return{year:Math.floor(t/12),month:t%12+1,day:e.day}},roundToNearestSecond:()=>function(e){return Math.round(3600*e*24)/86400},timeToNumber:()=>f,toBasisEU:()=>function(e){return{year:e.year,month:e.month,day:Math.min(30,e.day)}},truncateDayInMonth:()=>function(e){return{year:e.year,month:e.month,day:Math.min(e.day,i[e.month-1])}}});var n=r(70);const i=[31,28,31,30,31,30,31,31,30,31,30,31],o=[0,31,59,90,120,151,181,212,243,273,304,334],s=60,a=60,l=24;function c(e){return!(!e||"object"!=typeof e&&"function"!=typeof e)&&"year"in e&&"number"==typeof e.year&&"month"in e&&"number"==typeof e.month&&"day"in e&&"number"==typeof e.day}function u(e){return!(!e||"object"!=typeof e&&"function"!=typeof e)&&"hours"in e&&"number"==typeof e.hours&&"minutes"in e&&"number"==typeof e.minutes&&"seconds"in e&&"number"==typeof e.seconds}const d={year:9999,month:12,day:31};class h{constructor(e){this.config=e,this.minDateAbsoluteValue=this.dateToNumberFromZero(e.nullDate),this.maxDateValue=this.dateToNumber(d),this.leapYear1900=e.leapYear1900,!this.leapYear1900&&0<=this.dateToNumber({year:1900,month:2,day:28})?this.epochYearZero=this.numberToSimpleDate(2).year:this.epochYearZero=this.numberToSimpleDate(1).year,this.parseDateTime=e.parseDateTime}getWithinBounds(e){return e<=this.maxDateValue&&0<=e?e:void 0}dateStringToDateNumber(e){var{dateTime:e,dateFormat:t="",timeFormat:r=""}=this.parseDateTimeFromConfigFormats(e);if(void 0!==e)return u(e)?c(e)?new n.DateTimeNumber(f(e)+this.dateToNumber(e),t+" "+r):new n.TimeNumber(f(e),r):c(e)?new n.DateNumber(this.dateToNumber(e),t):0}parseDateTimeFromConfigFormats(e){return this.parseDateTimeFromFormats(e,this.config.dateFormats,this.config.timeFormats)}getNullYear(){return this.config.nullYear}getEpochYearZero(){return this.epochYearZero}isValidDate(e){return!(isNaN(e.year)||isNaN(e.month)||isNaN(e.day)||e.day!==Math.round(e.day)||e.month!==Math.round(e.month)||e.year!==Math.round(e.year)||e.year<1582||e.month<1||12<e.month||e.day<1||!(this.isLeapYear(e.year)&&2===e.month?e.day<=29:e.day<=i[e.month-1]))}dateToNumber(e){return this.dateToNumberFromZero(e)-this.minDateAbsoluteValue}relativeNumberToAbsoluteNumber(e){return e+this.minDateAbsoluteValue-(this.leapYear1900?1:0)}numberToSimpleDate(e){e=Math.floor(e)+this.minDateAbsoluteValue;let t=Math.floor(e/365.2425);this.dateToNumberFromZero({year:t+1,month:1,day:1})<=e?t++:this.dateToNumberFromZero({year:t-1,month:1,day:1})>e&&t--;var e=e-this.dateToNumberFromZero({year:t,month:1,day:1}),r=function(e){let t=0;o[t+6]<=e&&(t+=6);o[t+3]<=e&&(t+=3);o[t+2]<=e?t+=2:o[t+1]<=e&&(t+=1);return t}(e-(this.isLeapYear(t)&&59<=e?1:0)),e=e-o[r]-(this.isLeapYear(t)&&1<r?1:0);return{year:t,month:r+1,day:1+e}}numberToSimpleDateTime(e){var t=p(e%1),r=Math.floor(t.hours/l),e=(t.hours=t.hours%l,this.numberToSimpleDate(Math.floor(e)+r));return Object.assign(Object.assign({},e),t)}leapYearsCount(e){return Math.floor(e/4)-Math.floor(e/100)+Math.floor(e/400)+(this.config.leapYear1900&&1900<=e?1:0)}daysInMonth(e,t){return this.isLeapYear(e)&&2===t?29:i[t-1]}endOfMonth(e){return{year:e.year,month:e.month,day:this.daysInMonth(e.year,e.month)}}toBasisUS(e,t){return 31===e.day&&(e.day=30),30===e.day&&31===t.day&&(t.day=30),2===e.month&&e.day===this.daysInMonth(e.year,e.month)&&(e.day=30,2===t.month)&&t.day===this.daysInMonth(t.year,t.month)&&(t.day=30),[e,t]}yearLengthForBasis(e,t){return e.year!==t.year?e.year+1!==t.year||e.month<t.month||e.month===t.month&&e.day<t.day?(this.leapYearsCount(t.year)-this.leapYearsCount(e.year-1))/(t.year-e.year+1)+365:this.countLeapDays(t)!==this.countLeapDays({year:e.year,month:e.month,day:e.day-1})?366:365:this.isLeapYear(e.year)?366:365}parseSingleFormat(e,t,r){e=this.parseDateTime(e,t,r);if(!c(e)||(0<=e.year&&e.year<100&&(e.year<this.getNullYear()?e.year+=2e3:e.year+=1900),this.isValidDate(e)))return e}parseDateTimeFromFormats(e,t,r){var t=0===t.length?[void 0]:t,n=0===r.length?[void 0]:r;for(const o of t)for(const s of n){var i=this.parseSingleFormat(e,o,s);if(void 0!==i)return{dateTime:i,timeFormat:s,dateFormat:o}}return{}}countLeapDays(e){return 2<e.month||2===e.month&&29<=e.day?this.leapYearsCount(e.year):this.leapYearsCount(e.year-1)}dateToNumberFromZero(e){return 365*e.year+o[e.month-1]+e.day-1+(e.month<=2?this.leapYearsCount(e.year-1):this.leapYearsCount(e.year))}isLeapYear(e){return!(e%4)&&(!(!(e%100)&&e%400)||1900===e&&this.config.leapYear1900)}}function p(e){var e=e*l*a*s,t=(t=e%s,r=1e5,Math.round(t*r)/r%s),r=(e-t)/s,e=Math.round(r%a)%a,r=(r-e)/a;return{hours:Math.round(r),minutes:e,seconds:t}}function f(e){return((e.seconds/60+e.minutes)/60+e.hours)/24}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{AlwaysDense:()=>a,AlwaysSparse:()=>s,DenseSparseChooseBasedOnThreshold:()=>o});var n=r(94),i=r(93);class o{constructor(e){this.threshold=e}call(e){return e>this.threshold?n.DenseStrategy:i.SparseStrategy}}class s{call(){return i.SparseStrategy}}class a{call(){return n.DenseStrategy}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{defaultStringifyDateTime:()=>function(t,e){e=(0,d.parseForDateTimeFormat)(e);if(void 0===e)return;var r=e.tokens;let n="",i=!1;var o=r.some(e=>e.type===d.TokenType.FORMAT&&("a/p"===e.value||"A/P"===e.value||"am/pm"===e.value||"AM/PM"===e.value));for(let e=0;e<r.length;e++){var s=r[e];if(s.type===d.TokenType.FREE_TEXT)n+=s.value;else switch(s.value.toLowerCase()){case"h":case"hh":i=!0,n+=h(o?(t.hours+11)%12+1:t.hours,s.value.length);break;case"d":case"dd":n+=h(t.day,s.value.length);break;case"s":case"ss":n+=h(Math.floor(t.seconds),s.value.length);break;case"m":case"mm":(i=e+1<r.length&&r[e+1].value.startsWith(":")?!0:i)?n+=h(t.minutes,s.value.length):n+=h(t.month,s.value.length),i=!0;break;case"yy":n+=h(t.year%100,s.value.length);break;case"yyyy":n+=t.year;break;case"am/pm":case"a/p":var[a,l]=s.value.split("/");n+=t.hours<12?a:l;break;default:if(!c.TIME_FORMAT_SECONDS_ITEM_REGEXP.test(s.value))return;a=s.value.length-3;n+=(t.seconds<10?"0":"")+Math.floor(t.seconds*Math.pow(10,a))/Math.pow(10,a)}}return n},defaultStringifyDuration:()=>function(e,t){t=(0,d.parseForDateTimeFormat)(t);if(void 0===t)return;t=t.tokens;let r="";for(const i of t)if(i.type===d.TokenType.FREE_TEXT)r+=i.value;else switch(i.value.toLowerCase()){case"h":case"hh":r+=h(e.hours,i.value.length),e.hours=0;break;case"[hh]":r+=h(e.hours,i.value.length-2),e.hours=0;break;case"m":case"mm":r+=h(e.minutes,i.value.length),e.minutes=0;break;case"[mm]":r+=h(e.minutes+60*e.hours,i.value.length-2),e.minutes=0,e.hours=0;break;case"s":case"ss":r+=h(Math.floor(e.seconds),i.value.length);break;default:if(!c.TIME_FORMAT_SECONDS_ITEM_REGEXP.test(i.value))return;var n=Math.max(i.value.length-3,0);r+=(e.seconds<10?"0":"")+Math.floor(e.seconds*Math.pow(10,n))/Math.pow(10,n)}return r},format:()=>function(e,t,r,n){n=r.stringifyDateTime(n.numberToSimpleDateTime(e),t);if(void 0!==n)return n;n=r.stringifyDuration((0,u.numberToSimpleTime)(e),t);if(void 0!==n)return n;r=(0,d.parseForNumberFormat)(t);if(void 0===r)return t;{var i=r.tokens,o=e;let t="";for(let e=0;e<i.length;++e){var s=i[e];if(s.type===d.TokenType.FREE_TEXT)t+=s.value;else{var s=s.value.split("."),a=s[0],l=s[1]||"",s=s[1]?".":"",c=Number(o.toFixed(l.length)).toString().split(".");let e=c[0]||"";c=c[1]||"",a=(a.length>e.length&&(a=f(a.substr(0,a.length-e.length),"0"),e=h(e,a+e.length)),f(l.substr(c.length,l.length-c.length),"0"));c=p(c,a+c.length),t+=e+s+c}}return t}},padLeft:()=>h,padRight:()=>p});var c=r(103),u=r(104),d=r(107);function h(e,t){let r=""+e;for(;r.length<t;)r="0"+r;return r}function p(e,t){let r=""+e;for(;r.length<t;)r+="0";return r}function f(e,t){return e.split(t).length-1}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{FormatExpressionType:()=>o,TokenType:()=>a,formatToken:()=>l,isEscapeToken:()=>d,parse:()=>function(e){var t;return null!=(t=null!=(t=c(e))?t:u(e))?t:{type:o.STRING,tokens:[{type:a.FREE_TEXT,value:e}]}},parseForDateTimeFormat:()=>c,parseForNumberFormat:()=>u});const n=/(\\.|dd|DD|d|D|mm|MM|m|M|YYYY|YY|yyyy|yy|HH|hh|H|h|ss(\.(0+|s+))?|s|AM\/PM|am\/pm|A\/P|a\/p|\[mm]|\[MM]|\[hh]|\[HH])/g,i=/(\\.|[#0]+(\.[#0]*)?)/g;var a,o;function l(e,t){return{type:e,value:t}}function s(t,r){var n=[];let i=0;for(let e=0;e<t.length;++e){var o,s=t[e];s.index!==i&&(o=r.substr(i,s.index-i),n.push(l(a.FREE_TEXT,o))),s[0].startsWith("\\")?n.push(l(a.FREE_TEXT,s[0])):n.push(l(a.FORMAT,s[0])),i=s.index+s[0].length}var e=t[t.length-1];return e.index+e[0].length<r.length&&(e=r.substr(e.index+e[0].length,r.length),n.push(l(a.FREE_TEXT,e))),n}function c(e){var t=function(e){n.lastIndex=0;for(var t,r=[];null!==(t=n.exec(e))&&r.push(t),t;);return r}(e);if(!t.every(e=>d(e)))return{type:o.DATE,tokens:s(t,e)}}function u(e){t=e,i.lastIndex=0;var t=null!==(t=i.exec(t))?[t]:[];if(!t.every(e=>d(e)))return{type:o.NUMBER,tokens:s(t,e)}}function d(e){return e[0].startsWith("\\")}(r=a=a||{}).FORMAT="FORMAT",r.FREE_TEXT="FREE_TEXT",(t=o=o||{}).DATE="DATE",t.NUMBER="NUMBER",t.STRING="STRING"},(e,t,r)=>{"use strict";r.r(t),r.d(t,{checkLicenseKeyValidity:()=>function(e){var t={template:"missing",vars:{}};{var r,n,i;"gpl-v3"===e||"internal-use-in-handsontable"===e?t.template="valid":"string"==typeof e&&(0,o.checkKeySchema)(e)?([i,n,r]="10/04/2024".split("/"),n=Math.floor(new Date(n+`/${i}/`+r).getTime()/864e5),i=(0,o.extractTime)(e),t.vars.keyValidityDate=function(e){var t=["January","February","March","April","May","June","July","August","September","October","November","December"][e.getMonth()],r=e.getDate(),e=e.getFullYear();return t+` ${r}, `+e}(new Date(864e5*(i+1))),t.template=i<n?"expired":"valid"):""!==e&&(t.template="invalid")}a||"valid"===t.template||(console.warn(s[t.template](t.vars)),a=!0);return t.template}});var o=r(109);const s={invalid:()=>"The license key for HyperFormula is invalid.",expired:({keyValidityDate:e})=>"The license key for HyperFormula expired"+` on ${e}, and is not valid for the installed version.`,missing:()=>"The license key for HyperFormula is missing."};let a=!1},(e,t,r)=>{"use strict";r.r(t),r.d(t,{checkKeySchema:()=>function(i){if((i=(i+"").replace(/\-/g,""))[n]!==c("Z"))return!1;let o=0;return[[0,c("G")+1],[c("H"),c("H")-1],[c("G")+c("H"),c("G")]].reduce((e,[t,r],n)=>(e|=(a(""+a(s(l(i,o+t-(0===n?0:2),r+(n?2:0)))+(s(l(i,o+t+r,2))+[]).padStart(2,"0")))%97||2)>>1,o+=2,e),c("A"))===[]+1>>1},extractTime:()=>function(e){return 25===i(e)[n]?s(l(i(e),s("12"),c("F")))/(s(l(i(e),c("C"),c("Y")>>4))||1+(~~![][n]<<3)):0}});const n="length",s=e=>parseInt(e,16),a=e=>parseInt(e,10),i=e=>(e+"").replace(/\-/g,""),l=(e,t,r)=>e.substr(t,r),c=e=>e.codePointAt(0)-65},(e,t,r)=>{"use strict";r.r(t),r.d(t,{HyperFormula:()=>y});var a=r(2),i=r(102),n=r(111),o=r(3),s=r(112),l=r(101),c=r(104),u=r(143),f=r(144),d=r(77),h=r(88),p=r(130),g=r(116),m=r(7);class y{constructor(e,t,r,n,i,o,s,a,l,c,u,d,h,p){this._config=e,this._stats=t,this._dependencyGraph=r,this._columnSearch=n,this._parser=i,this._unparser=o,this._cellContentParser=s,this._evaluator=a,this._lazilyTransformingAstService=l,this._crudOperations=c,this._exporter=u,this._namedExpressions=d,this._serialization=h,this._functionRegistry=p,this._emitter=new f.Emitter,this._evaluationSuspended=!1}static get defaultConfig(){return(0,l.getDefaultConfig)()}get graph(){return this.dependencyGraph.graph}get rangeMapping(){return this.dependencyGraph.rangeMapping}get arrayMapping(){return this.dependencyGraph.arrayMapping}get sheetMapping(){return this.dependencyGraph.sheetMapping}get addressMapping(){return this.dependencyGraph.addressMapping}get dependencyGraph(){return this._dependencyGraph}get evaluator(){return this._evaluator}get columnSearch(){return this._columnSearch}get lazilyTransformingAstService(){return this._lazilyTransformingAstService}get licenseKeyValidityState(){return this._config.licenseKeyValidityState}static buildFromArray(e,t={},r=[]){return this.buildFromEngineState(n.BuildEngineFactory.buildFromSheet(e,t,r))}static buildFromSheets(e,t={},r=[]){return this.buildFromEngineState(n.BuildEngineFactory.buildFromSheets(e,t,r))}static buildEmpty(e={},t=[]){return this.buildFromEngineState(n.BuildEngineFactory.buildEmpty(e,t))}static getLanguage(e){(0,i.validateArgToType)(e,"string","languageCode");e=this.registeredLanguages.get(e);if(void 0===e)throw new d.LanguageNotRegisteredError;return e}static registerLanguage(e,t){if((0,i.validateArgToType)(e,"string","languageCode"),this.registeredLanguages.has(e))throw new d.LanguageAlreadyRegisteredError;this.registeredLanguages.set(e,(0,h.buildTranslationPackage)(t))}static unregisterLanguage(e){if((0,i.validateArgToType)(e,"string","languageCode"),!this.registeredLanguages.has(e))throw new d.LanguageNotRegisteredError;this.registeredLanguages.delete(e)}static getRegisteredLanguagesCodes(){return Array.from(this.registeredLanguages.keys())}static registerFunctionPlugin(e,t){p.FunctionRegistry.registerFunctionPlugin(e,t)}static unregisterFunctionPlugin(e){p.FunctionRegistry.unregisterFunctionPlugin(e)}static registerFunction(e,t,r){(0,i.validateArgToType)(e,"string","functionId"),p.FunctionRegistry.registerFunction(e,t,r)}static unregisterFunction(e){(0,i.validateArgToType)(e,"string","functionId"),p.FunctionRegistry.unregisterFunction(e)}static unregisterAllFunctions(){p.FunctionRegistry.unregisterAll()}static getRegisteredFunctionNames(e){(0,i.validateArgToType)(e,"string","code");var t=p.FunctionRegistry.getRegisteredFunctionIds();return this.getLanguage(e).getFunctionTranslations(t)}static getFunctionPlugin(e){return(0,i.validateArgToType)(e,"string","functionId"),p.FunctionRegistry.getFunctionPlugin(e)}static getAllFunctionPlugins(){return p.FunctionRegistry.getPlugins()}static buildFromEngineState(e){return new y(e.config,e.stats,e.dependencyGraph,e.columnSearch,e.parser,e.unparser,e.cellContentParser,e.evaluator,e.lazilyTransformingAstService,e.crudOperations,e.exporter,e.namedExpressions,e.serialization,e.functionRegistry)}getCellValue(e){if((0,o.isSimpleCellAddress)(e))return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellValue(e);throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress")}getCellFormula(e){if((0,o.isSimpleCellAddress)(e))return this._serialization.getCellFormula(e);throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress")}getCellHyperlink(e){if((0,o.isSimpleCellAddress)(e))return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellHyperlink(e);throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress")}getCellSerialized(e){if((0,o.isSimpleCellAddress)(e))return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellSerialized(e);throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress")}getSheetValues(e){return(0,i.validateArgToType)(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetValues(e)}getSheetFormulas(e){return(0,i.validateArgToType)(e,"number","sheetId"),this._serialization.getSheetFormulas(e)}getSheetSerialized(e){return(0,i.validateArgToType)(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetSerialized(e)}getAllSheetsDimensions(){return this._serialization.genericAllSheetsGetter(e=>this.getSheetDimensions(e))}getSheetDimensions(e){return(0,i.validateArgToType)(e,"number","sheetId"),{width:this.dependencyGraph.getSheetWidth(e),height:this.dependencyGraph.getSheetHeight(e)}}getAllSheetsValues(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsValues()}getAllSheetsFormulas(){return this._serialization.getAllSheetsFormulas()}getAllSheetsSerialized(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsSerialized()}updateConfig(e){Object.entries(e).every(([e,t])=>this._config[e]===t)||this.rebuildWithConfig(e)}getConfig(){return this._config.getConfig()}rebuildAndRecalculate(){this.rebuildWithConfig({})}getStats(){return this._stats.snapshot()}undo(){return this._crudOperations.undo(),this.recomputeIfDependencyGraphNeedsIt()}redo(){return this._crudOperations.redo(),this.recomputeIfDependencyGraphNeedsIt()}isThereSomethingToUndo(){return this._crudOperations.isThereSomethingToUndo()}isThereSomethingToRedo(){return this._crudOperations.isThereSomethingToRedo()}isItPossibleToSetCellContents(e){let t;if((0,o.isSimpleCellAddress)(e))t=new a.AbsoluteCellRange(e,e);else{if(!(0,a.isSimpleCellRange)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress | SimpleCellRange","address");t=new a.AbsoluteCellRange(e.start,e.end)}try{this._crudOperations.ensureRangeInSizeLimits(t);for(const r of t.addresses(this._dependencyGraph))this._crudOperations.ensureItIsPossibleToChangeContent(r)}catch(e){return!1}return!0}setCellContents(e,t){return this._crudOperations.setCellContents(e,t),this.recomputeIfDependencyGraphNeedsIt()}swapRowIndexes(e,t){return(0,i.validateArgToType)(e,"number","sheetId"),this._crudOperations.setRowOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToSwapRowIndexes(e,t){(0,i.validateArgToType)(e,"number","sheetId");try{return this._crudOperations.validateSwapRowIndexes(e,t),this._crudOperations.testRowOrderForArrays(e,t),!0}catch(e){return!1}}setRowOrder(e,t){(0,i.validateArgToType)(e,"number","sheetId");t=this._crudOperations.mappingFromOrder(e,t,"row");return this.swapRowIndexes(e,t)}isItPossibleToSetRowOrder(e,t){(0,i.validateArgToType)(e,"number","sheetId");try{var r=this._crudOperations.mappingFromOrder(e,t,"row");return this._crudOperations.validateSwapRowIndexes(e,r),this._crudOperations.testRowOrderForArrays(e,r),!0}catch(e){return!1}}swapColumnIndexes(e,t){return(0,i.validateArgToType)(e,"number","sheetId"),this._crudOperations.setColumnOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToSwapColumnIndexes(e,t){(0,i.validateArgToType)(e,"number","sheetId");try{return this._crudOperations.validateSwapColumnIndexes(e,t),this._crudOperations.testColumnOrderForArrays(e,t),!0}catch(e){return!1}}setColumnOrder(e,t){(0,i.validateArgToType)(e,"number","sheetId");t=this._crudOperations.mappingFromOrder(e,t,"column");return this.swapColumnIndexes(e,t)}isItPossibleToSetColumnOrder(e,t){(0,i.validateArgToType)(e,"number","sheetId");try{var r=this._crudOperations.mappingFromOrder(e,t,"column");return this._crudOperations.validateSwapColumnIndexes(e,r),this._crudOperations.testColumnOrderForArrays(e,r),!0}catch(e){return!1}}isItPossibleToAddRows(e,...t){(0,i.validateArgToType)(e,"number","sheetId");t=(0,g.normalizeAddedIndexes)(t);try{return this._crudOperations.ensureItIsPossibleToAddRows(e,...t),!0}catch(e){return!1}}addRows(e,...t){return(0,i.validateArgToType)(e,"number","sheetId"),this._crudOperations.addRows(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveRows(e,...t){(0,i.validateArgToType)(e,"number","sheetId");t=(0,g.normalizeRemovedIndexes)(t);try{return this._crudOperations.ensureItIsPossibleToRemoveRows(e,...t),!0}catch(e){return!1}}removeRows(e,...t){return(0,i.validateArgToType)(e,"number","sheetId"),this._crudOperations.removeRows(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToAddColumns(e,...t){(0,i.validateArgToType)(e,"number","sheetId");t=(0,g.normalizeAddedIndexes)(t);try{return this._crudOperations.ensureItIsPossibleToAddColumns(e,...t),!0}catch(e){return!1}}addColumns(e,...t){return(0,i.validateArgToType)(e,"number","sheetId"),this._crudOperations.addColumns(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveColumns(e,...t){(0,i.validateArgToType)(e,"number","sheetId");t=(0,g.normalizeRemovedIndexes)(t);try{return this._crudOperations.ensureItIsPossibleToRemoveColumns(e,...t),!0}catch(e){return!1}}removeColumns(e,...t){return(0,i.validateArgToType)(e,"number","sheetId"),this._crudOperations.removeColumns(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveCells(e,t){if(!(0,o.isSimpleCellAddress)(t))throw new d.ExpectedValueOfTypeError("SimpleCellAddress","destinationLeftCorner");if(!(0,a.isSimpleCellRange)(e))throw new d.ExpectedValueOfTypeError("SimpleCellRange","source");try{var r=new a.AbsoluteCellRange(e.start,e.end);return this._crudOperations.operations.ensureItIsPossibleToMoveCells(r.start,r.width(),r.height(),t),!0}catch(e){return!1}}moveCells(e,t){if(!(0,o.isSimpleCellAddress)(t))throw new d.ExpectedValueOfTypeError("SimpleCellAddress","destinationLeftCorner");if((0,a.isSimpleCellRange)(e))return e=new a.AbsoluteCellRange(e.start,e.end),this._crudOperations.moveCells(e.start,e.width(),e.height(),t),this.recomputeIfDependencyGraphNeedsIt();throw new d.ExpectedValueOfTypeError("SimpleCellRange","source")}isItPossibleToMoveRows(e,t,r,n){(0,i.validateArgToType)(e,"number","sheetId"),(0,i.validateArgToType)(t,"number","startRow"),(0,i.validateArgToType)(r,"number","numberOfRows"),(0,i.validateArgToType)(n,"number","targetRow");try{return this._crudOperations.ensureItIsPossibleToMoveRows(e,t,r,n),!0}catch(e){return!1}}moveRows(e,t,r,n){return(0,i.validateArgToType)(e,"number","sheetId"),(0,i.validateArgToType)(t,"number","startRow"),(0,i.validateArgToType)(r,"number","numberOfRows"),(0,i.validateArgToType)(n,"number","targetRow"),this._crudOperations.moveRows(e,t,r,n),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveColumns(e,t,r,n){(0,i.validateArgToType)(e,"number","sheetId"),(0,i.validateArgToType)(t,"number","startColumn"),(0,i.validateArgToType)(r,"number","numberOfColumns"),(0,i.validateArgToType)(n,"number","targetColumn");try{return this._crudOperations.ensureItIsPossibleToMoveColumns(e,t,r,n),!0}catch(e){return!1}}moveColumns(e,t,r,n){return(0,i.validateArgToType)(e,"number","sheetId"),(0,i.validateArgToType)(t,"number","startColumn"),(0,i.validateArgToType)(r,"number","numberOfColumns"),(0,i.validateArgToType)(n,"number","targetColumn"),this._crudOperations.moveColumns(e,t,r,n),this.recomputeIfDependencyGraphNeedsIt()}copy(e){var t;if((0,a.isSimpleCellRange)(e))return t=new a.AbsoluteCellRange(e.start,e.end),this._crudOperations.copy(t.start,t.width(),t.height()),this.getRangeValues(e);throw new d.ExpectedValueOfTypeError("SimpleCellRange","source")}cut(e){var t;if((0,a.isSimpleCellRange)(e))return t=new a.AbsoluteCellRange(e.start,e.end),this._crudOperations.cut(t.start,t.width(),t.height()),this.getRangeValues(e);throw new d.ExpectedValueOfTypeError("SimpleCellRange","source")}paste(e){if((0,o.isSimpleCellAddress)(e))return this.ensureEvaluationIsNotSuspended(),this._crudOperations.paste(e),this.recomputeIfDependencyGraphNeedsIt();throw new d.ExpectedValueOfTypeError("SimpleCellAddress","targetLeftCorner")}isClipboardEmpty(){return this._crudOperations.isClipboardEmpty()}clearClipboard(){this._crudOperations.clearClipboard()}clearRedoStack(){this._crudOperations.undoRedo.clearRedoStack()}clearUndoStack(){this._crudOperations.undoRedo.clearUndoStack()}getRangeValues(e){if((0,a.isSimpleCellRange)(e))return new a.AbsoluteCellRange(e.start,e.end).arrayOfAddressesInRange().map(e=>e.map(e=>this.getCellValue(e)));throw new d.ExpectedValueOfTypeError("SimpleCellRange","source")}getRangeFormulas(e){if((0,a.isSimpleCellRange)(e))return new a.AbsoluteCellRange(e.start,e.end).arrayOfAddressesInRange().map(e=>e.map(e=>this.getCellFormula(e)));throw new d.ExpectedValueOfTypeError("SimpleCellRange","source")}getRangeSerialized(e){if((0,a.isSimpleCellRange)(e))return new a.AbsoluteCellRange(e.start,e.end).arrayOfAddressesInRange().map(e=>e.map(e=>this.getCellSerialized(e)));throw new d.ExpectedValueOfTypeError("SimpleCellRange","source")}getFillRangeData(n,i,o=!1){if(!(0,a.isSimpleCellRange)(n))throw new d.ExpectedValueOfTypeError("SimpleCellRange","source");if(!(0,a.isSimpleCellRange)(i))throw new d.ExpectedValueOfTypeError("SimpleCellRange","target");const s=new a.AbsoluteCellRange(n.start,n.end);var e=new a.AbsoluteCellRange(i.start,i.end);return this.ensureEvaluationIsNotSuspended(),e.arrayOfAddressesInRange().map(e=>e.map(e=>{var t=((e.row-(o?i:n).start.row)%s.height()+s.height())%s.height()+n.start.row,r=((e.col-(o?i:n).start.col)%s.width()+s.width())%s.width()+n.start.col;return this._serialization.getCellSerialized({row:t,col:r,sheet:s.sheet},e)}))}isItPossibleToAddSheet(e){(0,i.validateArgToType)(e,"string","sheetName");try{return this._crudOperations.ensureItIsPossibleToAddSheet(e),!0}catch(e){return!1}}addSheet(e){void 0!==e&&(0,i.validateArgToType)(e,"string","sheetName");e=this._crudOperations.addSheet(e);return this._emitter.emit(f.Events.SheetAdded,e),e}isItPossibleToRemoveSheet(e){(0,i.validateArgToType)(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch(e){return!1}}removeSheet(e){(0,i.validateArgToType)(e,"number","sheetId");var t=this.sheetMapping.getDisplayName(e),e=(this._crudOperations.removeSheet(e),this.recomputeIfDependencyGraphNeedsIt());return this._emitter.emit(f.Events.SheetRemoved,t,e),e}isItPossibleToClearSheet(e){(0,i.validateArgToType)(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch(e){return!1}}clearSheet(e){return(0,i.validateArgToType)(e,"number","sheetId"),this._crudOperations.clearSheet(e),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToReplaceSheetContent(e,t){(0,i.validateArgToType)(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),this._crudOperations.ensureItIsPossibleToChangeSheetContents(e,t),!0}catch(e){return!1}}setSheetContent(e,t){return(0,i.validateArgToType)(e,"number","sheetId"),this._crudOperations.setSheetContent(e,t),this.recomputeIfDependencyGraphNeedsIt()}simpleCellAddressFromString(e,t){return(0,i.validateArgToType)(e,"string","cellAddress"),(0,i.validateArgToType)(t,"number","sheetId"),(0,m.simpleCellAddressFromString)(this.sheetMapping.get,e,t)}simpleCellRangeFromString(e,t){return(0,i.validateArgToType)(e,"string","cellRange"),(0,i.validateArgToType)(t,"number","sheetId"),(0,m.simpleCellRangeFromString)(this.sheetMapping.get,e,t)}simpleCellAddressToString(e,t){if((0,o.isSimpleCellAddress)(e))return(0,i.validateArgToType)(t,"number","sheetId"),(0,m.simpleCellAddressToString)(this.sheetMapping.fetchDisplayName,e,t);throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress")}simpleCellRangeToString(e,t){if((0,a.isSimpleCellRange)(e))return(0,i.validateArgToType)(t,"number","sheetId"),(0,m.simpleCellRangeToString)(this.sheetMapping.fetchDisplayName,e,t);throw new d.ExpectedValueOfTypeError("SimpleCellRange","cellRange")}getCellDependents(e){let t;if((0,o.isSimpleCellAddress)(e))t=this._dependencyGraph.addressMapping.getCell(e);else{if(!(0,a.isSimpleCellRange)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress | SimpleCellRange",e);t=this._dependencyGraph.rangeMapping.getRange(e.start,e.end)}return void 0===t?[]:this._dependencyGraph.getAdjacentNodesAddresses(t)}getCellPrecedents(e){let t;if((0,o.isSimpleCellAddress)(e))t=this._dependencyGraph.addressMapping.getCell(e);else{if(!(0,a.isSimpleCellRange)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress | SimpleCellRange",e);t=this._dependencyGraph.rangeMapping.getRange(e.start,e.end)}return void 0===t?[]:this._dependencyGraph.dependencyQueryAddresses(t)}getSheetName(e){return(0,i.validateArgToType)(e,"number","sheetId"),this.sheetMapping.getDisplayName(e)}getSheetNames(){return this.sheetMapping.sheetNames()}getSheetId(e){return(0,i.validateArgToType)(e,"string","sheetName"),this.sheetMapping.get(e)}doesSheetExist(e){return(0,i.validateArgToType)(e,"string","sheetName"),this.sheetMapping.hasSheetWithName(e)}getCellType(e){var t;if((0,o.isSimpleCellAddress)(e))return t=this.dependencyGraph.getCell(e),(0,o.getCellType)(t,e);throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress")}doesCellHaveSimpleValue(e){if((0,o.isSimpleCellAddress)(e))return this.getCellType(e)===o.CellType.VALUE;throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress")}doesCellHaveFormula(e){if((0,o.isSimpleCellAddress)(e))return(e=this.getCellType(e))===o.CellType.FORMULA||e===o.CellType.ARRAYFORMULA;throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress")}isCellEmpty(e){if((0,o.isSimpleCellAddress)(e))return this.getCellType(e)===o.CellType.EMPTY;throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress")}isCellPartOfArray(e){if((0,o.isSimpleCellAddress)(e))return(e=this.getCellType(e))===o.CellType.ARRAY||e===o.CellType.ARRAYFORMULA;throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress")}getCellValueType(e){if(!(0,o.isSimpleCellAddress)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();e=this.dependencyGraph.getCellValue(e);return(0,o.getCellValueType)(e)}getCellValueDetailedType(e){if(!(0,o.isSimpleCellAddress)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();e=this.dependencyGraph.getCellValue(e);return(0,o.getCellValueDetailedType)(e)}getCellValueFormat(e){if(!(0,o.isSimpleCellAddress)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();e=this.dependencyGraph.getCellValue(e);return(0,o.getCellValueFormat)(e)}countSheets(){return this.sheetMapping.numberOfSheets()}isItPossibleToRenameSheet(e,t){(0,i.validateArgToType)(e,"number","sheetId"),(0,i.validateArgToType)(t,"string","newName");try{return this._crudOperations.ensureItIsPossibleToRenameSheet(e,t),!0}catch(e){return!1}}renameSheet(e,t){(0,i.validateArgToType)(e,"number","sheetId"),(0,i.validateArgToType)(t,"string","newName");e=this._crudOperations.renameSheet(e,t);void 0!==e&&this._emitter.emit(f.Events.SheetRenamed,e,t)}batch(e){this.suspendEvaluation(),this._crudOperations.beginUndoRedoBatchMode();try{e()}catch(e){throw this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation(),e}return this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation()}suspendEvaluation(){this._evaluationSuspended=!0,this._emitter.emit(f.Events.EvaluationSuspended)}resumeEvaluation(){this._evaluationSuspended=!1;var e=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(f.Events.EvaluationResumed,e),e}isEvaluationSuspended(){return this._evaluationSuspended}isItPossibleToAddNamedExpression(e,t,r){(0,i.validateArgToType)(e,"string","expressionName"),void 0!==r&&(0,i.validateArgToType)(r,"number","scope");try{return this._crudOperations.ensureItIsPossibleToAddNamedExpression(e,t,r),!0}catch(e){return!1}}addNamedExpression(e,t,r,n){(0,i.validateArgToType)(e,"string","expressionName"),void 0!==r&&(0,i.validateArgToType)(r,"number","scope"),this._crudOperations.addNamedExpression(e,t,r,n);t=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(f.Events.NamedExpressionAdded,e,t),t}getNamedExpressionValue(e,t){(0,i.validateArgToType)(e,"string","expressionName"),void 0!==t&&(0,i.validateArgToType)(t,"number","scope"),this.ensureEvaluationIsNotSuspended(),this._crudOperations.ensureScopeIdIsValid(t);e=this._namedExpressions.namedExpressionForScope(e,t);if(e)return this._serialization.getCellValue(e.address)}getNamedExpressionFormula(e,t){(0,i.validateArgToType)(e,"string","expressionName"),void 0!==t&&(0,i.validateArgToType)(t,"number","scope"),this._crudOperations.ensureScopeIdIsValid(t);e=this._namedExpressions.namedExpressionForScope(e,t);if(void 0!==e)return this._serialization.getCellFormula(e.address)}getNamedExpression(e,t){(0,i.validateArgToType)(e,"string","expressionName"),void 0!==t&&(0,i.validateArgToType)(t,"number","scope");var r=this._namedExpressions.namedExpressionForScope(e,t);if(void 0!==r)return{name:e,scope:t,expression:this._serialization.getCellFormula(r.address),options:r.options}}isItPossibleToChangeNamedExpression(e,t,r){(0,i.validateArgToType)(e,"string","expressionName"),void 0!==r&&(0,i.validateArgToType)(r,"number","scope");try{return this._crudOperations.ensureItIsPossibleToChangeNamedExpression(e,t,r),!0}catch(e){return!1}}changeNamedExpression(e,t,r,n){return(0,i.validateArgToType)(e,"string","expressionName"),void 0!==r&&(0,i.validateArgToType)(r,"number","scope"),this._crudOperations.changeNamedExpressionExpression(e,r,t,n),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveNamedExpression(e,t){(0,i.validateArgToType)(e,"string","expressionName"),void 0!==t&&(0,i.validateArgToType)(t,"number","scope");try{return this._crudOperations.isItPossibleToRemoveNamedExpression(e,t),!0}catch(e){return!1}}removeNamedExpression(e,t){(0,i.validateArgToType)(e,"string","expressionName"),void 0!==t&&(0,i.validateArgToType)(t,"number","scope");e=this._crudOperations.removeNamedExpression(e,t);return e?(t=this.recomputeIfDependencyGraphNeedsIt(),this._emitter.emit(f.Events.NamedExpressionRemoved,e.displayName,t),t):[]}listNamedExpressions(e){return void 0!==e&&(0,i.validateArgToType)(e,"number","scope"),this._crudOperations.ensureScopeIdIsValid(e),this._namedExpressions.getAllNamedExpressionsNamesInScope(e)}getAllNamedExpressionsSerialized(){return this._serialization.getAllNamedExpressionsSerialized()}normalizeFormula(e){(0,i.validateArgToType)(e,"string","formulaString");var{ast:e,address:t}=this.extractTemporaryFormula(e);if(void 0===e)throw new d.NotAFormulaError;return this._unparser.unparse(e,t)}calculateFormula(e,t){(0,i.validateArgToType)(e,"string","formulaString"),(0,i.validateArgToType)(t,"number","sheetId"),this._crudOperations.ensureScopeIdIsValid(t);var{ast:e,address:t,dependencies:r}=this.extractTemporaryFormula(e,t);if(void 0===e)throw new d.NotAFormulaError;e=this.evaluator.runAndForget(e,t,r);return this._exporter.exportScalarOrRange(e)}getNamedExpressionsFromFormula(e){(0,i.validateArgToType)(e,"string","formulaString");var{ast:e,dependencies:t}=this.extractTemporaryFormula(e);if(void 0===e)throw new d.NotAFormulaError;e=t.filter(e=>e instanceof m.NamedExpressionDependency).map(e=>e.name);return[...new Set(e)]}validateFormula(e){(0,i.validateArgToType)(e,"string","formulaString");e=this.extractTemporaryFormula(e).ast;return void 0!==e}getRegisteredFunctionNames(){return y.getLanguage(this._config.language).getFunctionTranslations(this._functionRegistry.getRegisteredFunctionIds())}getFunctionPlugin(e){return(0,i.validateArgToType)(e,"string","functionId"),this._functionRegistry.getFunctionPlugin(e)}getAllFunctionPlugins(){return this._functionRegistry.getPlugins()}numberToDateTime(e){return(0,i.validateArgToType)(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDateTime(e)}numberToDate(e){return(0,i.validateArgToType)(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDate(e)}numberToTime(e){return(0,i.validateArgToType)(e,"number","val"),(0,c.numberToSimpleTime)(e)}on(e,t){this._emitter.on(e,t)}once(e,t){this._emitter.once(e,t)}off(e,t){this._emitter.off(e,t)}destroy(){(0,u.objectDestroy)(this)}ensureEvaluationIsNotSuspended(){if(this._evaluationSuspended)throw new d.EvaluationSuspendedError}extractTemporaryFormula(e,t=1){var r,n,e=this._cellContentParser.parse(e),t={sheet:t,col:0,row:0};return!(e instanceof s.CellContent.Formula)||({ast:e,errors:r,dependencies:n}=this._parser.parse(e.formula,t),0<r.length)?{address:t,dependencies:[]}:{ast:e,address:t,dependencies:n}}rebuildWithConfig(e){var t=this._config.mergeConfig(e),e=this._config.mergeConfig({language:e.language}),e=this._serialization.withNewConfig(e,this._namedExpressions).getAllSheetsSerialized(),r=this._serialization.getAllNamedExpressionsSerialized(),t=n.BuildEngineFactory.rebuildWithConfig(t,e,r,this._stats);this._config=t.config,this._stats=t.stats,this._dependencyGraph=t.dependencyGraph,this._columnSearch=t.columnSearch,this._parser=t.parser,this._unparser=t.unparser,this._cellContentParser=t.cellContentParser,this._evaluator=t.evaluator,this._lazilyTransformingAstService=t.lazilyTransformingAstService,this._crudOperations=t.crudOperations,this._exporter=t.exporter,this._namedExpressions=t.namedExpressions,this._serialization=t.serialization,this._functionRegistry=t.functionRegistry}recomputeIfDependencyGraphNeedsIt(){var e,t;return this._evaluationSuspended?[]:(e=this._crudOperations.getAndClearContentChanges(),t=this.dependencyGraph.verticesToRecompute(),this.dependencyGraph.clearDirtyVertices(),0<t.length&&e.addAll(this.evaluator.partialRun(t)),t=e.exportChanges(this._exporter),e.isEmpty()||this._emitter.emit(f.Events.ValuesUpdated,t),t)}}y.version="2.7.0",y.buildDate="10/04/2024 11:28:07",y.releaseDate="10/04/2024",y.languages={},y.registeredLanguages=new Map},(e,t,r)=>{"use strict";r.r(t),r.d(t,{BuildEngineFactory:()=>n});var S=r(1),_=r(112),x=r(113),i=r(101),R=r(114),A=r(104),N=r(4),O=r(77),I=r(127),M=r(128),k=r(129),o=r(88),D=r(98),P=r(130),L=r(132),F=r(134),H=r(136),U=r(115),V=r(141),W=r(116),$=r(7),B=r(142),j=r(125),z=r(72),Y=r(126);class n{static buildFromSheets(e,t={},r=[]){t=new i.Config(t);return this.buildEngine(t,e,r)}static buildFromSheet(e,t={},r=[]){var t=new i.Config(t),n=t.translationPackage.getUITranslation(o.UIElement.NEW_SHEET_PREFIX)+"1";return this.buildEngine(t,{[n]:e},r)}static buildEmpty(e={},t=[]){return this.buildEngine(new i.Config(e),{},t)}static rebuildWithConfig(e,t,r,n){return this.buildEngine(e,t,r,n)}static buildEngine(e,t={},r=[],n=new(e.useStats?z.Statistics:z.EmptyStatistics)){n.start(z.StatType.BUILD_ENGINE_TOTAL);var i=new U.NamedExpressions,o=new P.FunctionRegistry(e),s=new F.LazilyTransformingAstService(n);const a=N.DependencyGraph.buildEmpty(s,e,o,i,n),l=(0,H.buildColumnSearchStrategy)(a,e,n);var c=a.sheetMapping,u=a.addressMapping;for(const T in t)if(Object.prototype.hasOwnProperty.call(t,T)){var d=t[T],d=((0,j.validateAsSheet)(d),(0,j.findBoundaries)(d));if(d.height>e.maxRows||d.width>e.maxColumns)throw new O.SheetSizeLimitExceededError;var h=c.addSheet(T);u.autoAddSheet(h,d)}const p=new $.ParserWithCaching(e,o,c.get);s.parser=p;var f=new $.Unparser(e,(0,$.buildLexerConfig)(e),c.fetchDisplayName,i),g=new A.DateTimeHelper(e),m=new V.NumberLiteralHelper(e),y=new D.ArithmeticHelper(e,g,m);const v=new _.CellContentParser(e,g,m),b=new S.ArraySizePredictor(e,o);var m=new W.Operations(e,a,l,v,p,n,s,i,b),w=new Y.UndoRedo(e,m),C=(s.undoRedo=w,new x.ClipboardOperations(e,a,m));const E=new R.CrudOperations(e,m,w,C,a,l,p,v,s,i);r.forEach(e=>{E.ensureItIsPossibleToAddNamedExpression(e.name,e.expression,e.scope),E.operations.addNamedExpression(e.name,e.expression,e.scope,e.options)});m=new M.Exporter(e,i,c.fetchDisplayName,s),w=new B.Serialization(a,f,m),C=new L.Interpreter(e,a,l,n,y,o,i,w,b,g),n.measure(z.StatType.GRAPH_BUILD,()=>{new k.GraphBuilder(a,l,p,v,n,b).buildGraph(t,n)}),r=new I.Evaluator(e,n,C,s,a,l);return r.run(),n.end(z.StatType.BUILD_ENGINE_TOTAL),{config:e,stats:n,dependencyGraph:a,columnSearch:l,parser:p,unparser:f,cellContentParser:v,evaluator:r,lazilyTransformingAstService:s,crudOperations:E,exporter:m,namedExpressions:i,serialization:w,functionRegistry:o}}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{CellContent:()=>o,CellContentParser:()=>n,isBoolean:()=>p,isError:()=>f,isFormula:()=>h});var o,s=r(3),a=r(104),l=r(61),c=r(77),u=r(98),d=r(70);{(t=o=o||{}).Number=class{constructor(e){this.value=e,this.value=(0,d.cloneNumber)(this.value,(0,u.fixNegativeZero)((0,d.getRawValue)(this.value)))}},t.String=class{constructor(e){this.value=e}},t.Boolean=class{constructor(e){this.value=e}};class i{static getSingletonInstance(){return i.instance||(i.instance=new i),i.instance}}t.Empty=i,t.Formula=class{constructor(e){this.formula=e}},t.Error=class{constructor(e,t){this.value=new s.CellError(e,t)}}}function h(e){return e.startsWith("=")}function p(e){e=e.toLowerCase();return"true"===e||"false"===e}function f(e,t){e=e.toUpperCase();return/#[A-Za-z0-9\/]+[?!]?/.test(e)&&Object.prototype.hasOwnProperty.call(t,e)}class n{constructor(e,t,r){this.config=e,this.dateHelper=t,this.numberLiteralsHelper=r}parse(n){if(null==n)return o.Empty.getSingletonInstance();if("number"==typeof n)return(0,u.isNumberOverflow)(n)?new o.Error(s.ErrorType.NUM,l.ErrorMessage.ValueLarge):new o.Number(n);if("boolean"==typeof n)return new o.Boolean(n);if(n instanceof Date)return(i=this.dateHelper.dateToNumber({day:n.getDate(),month:n.getMonth()+1,year:n.getFullYear()})+(0,a.timeToNumber)({hours:n.getHours(),minutes:n.getMinutes(),seconds:n.getSeconds()+n.getMilliseconds()/1e3}))<0?new o.Error(s.ErrorType.NUM,l.ErrorMessage.DateBounds):i%1==0?new o.Number(new d.DateNumber(i,"Date()")):i<1?new o.Number(new d.TimeNumber(i,"Date()")):new o.Number(new d.DateTimeNumber(i,"Date()"));if("string"!=typeof n)throw new c.UnableToParseError(n);if(p(n))return new o.Boolean("true"===n.toLowerCase());if(h(n))return new o.Formula(n);if(f(n,this.config.errorMapping))return new o.Error(this.config.errorMapping[n.toUpperCase()]);{let e=n.trim(),t=0,r;e.endsWith("%")?(t=1,e=e.slice(0,e.length-1)):void 0!==(i=this.currencyMatcher(e))&&(t=2,[r,e]=i);var i=this.numberLiteralsHelper.numericStringToMaybeNumber(e);if(void 0!==i){let e;return e=1===t?new d.PercentNumber(i/100):2===t?new d.CurrencyNumber(i,r):i,new o.Number(e)}i=this.dateHelper.dateStringToDateNumber(e);return void 0!==i?new o.Number(i):new o.String(n.startsWith("'")?n.slice(1):n)}}currencyMatcher(e){for(const t of this.config.currencySymbol){if(e.startsWith(t))return[t,e.slice(t.length)];if(e.endsWith(t))return[t,e.slice(0,e.length-t.length)]}}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{ClipboardCellType:()=>n,ClipboardOperations:()=>c});var s,n,i=r(2),a=r(3),o=r(77);(t=s=s||{})[t.COPY=0]="COPY",t[t.CUT=1]="CUT",(r=n=n||{})[r.VALUE=0]="VALUE",r[r.EMPTY=1]="EMPTY",r[r.FORMULA=2]="FORMULA",r[r.PARSING_ERROR=3]="PARSING_ERROR";class l{constructor(e,t,r,n,i){this.sourceLeftCorner=e,this.width=t,this.height=r,this.type=n,this.content=i}*getContent(r){if(void 0!==this.content)for(let t=0;t<this.height;++t)for(let e=0;e<this.width;++e)yield[(0,a.simpleCellAddress)(r.sheet,r.col+e,r.row+t),this.content[t][e]]}}class c{constructor(e,t,r){this.dependencyGraph=t,this.operations=r,this.maxRows=e.maxRows,this.maxColumns=e.maxColumns}cut(e,t,r){this.clipboard=new l(e,t,r,s.CUT)}copy(r,n,e){var i=[];for(let t=0;t<e;++t){i[t]=[];for(let e=0;e<n;++e){var o=this.operations.getClipboardCell((0,a.simpleCellAddress)(r.sheet,r.col+e,r.row+t));i[t].push(o)}}this.clipboard=new l(r,n,e,s.COPY,i)}abortCut(){this.clipboard&&this.clipboard.type===s.CUT&&this.clear()}clear(){this.clipboard=void 0}ensureItIsPossibleToCopyPaste(e){if(void 0!==this.clipboard){if((0,a.invalidSimpleCellAddress)(e)||!this.dependencyGraph.sheetMapping.hasSheetWithId(e.sheet))throw new o.InvalidArgumentsError("a valid target address.");e=i.AbsoluteCellRange.spanFrom(e,this.clipboard.width,this.clipboard.height);if(e.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new o.SheetSizeLimitExceededError;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(e))throw new Error("It is not possible to paste onto an array")}}isCutClipboard(){return void 0!==this.clipboard&&this.clipboard.type===s.CUT}isCopyClipboard(){return void 0!==this.clipboard&&this.clipboard.type===s.COPY}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{CrudOperations:()=>h});var s=r(2),a=r(3),n=r(112),l=r(77),i=r(115),o=r(116),c=r(125),u=r(71),d=r(126);class h{constructor(e,t,r,n,i,o,s,a,l,c){this.operations=t,this.undoRedo=r,this.clipboardOperations=n,this.dependencyGraph=i,this.columnSearch=o,this.parser=s,this.cellContentParser=a,this.lazilyTransformingAstService=l,this.namedExpressions=c,this.maxRows=e.maxRows,this.maxColumns=e.maxColumns}get sheetMapping(){return this.dependencyGraph.sheetMapping}addRows(e,...t){var r=new o.AddRowsCommand(e,t);this.ensureItIsPossibleToAddRows(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addRows(r),this.undoRedo.saveOperation(new d.AddRowsUndoEntry(r))}removeRows(e,...t){var r=new o.RemoveRowsCommand(e,t),e=(this.ensureItIsPossibleToRemoveRows(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.removeRows(r));this.undoRedo.saveOperation(new d.RemoveRowsUndoEntry(r,e))}addColumns(e,...t){var r=new o.AddColumnsCommand(e,t);this.ensureItIsPossibleToAddColumns(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addColumns(r),this.undoRedo.saveOperation(new d.AddColumnsUndoEntry(r))}removeColumns(e,...t){var r=new o.RemoveColumnsCommand(e,t),e=(this.ensureItIsPossibleToRemoveColumns(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.removeColumns(r));this.undoRedo.saveOperation(new d.RemoveColumnsUndoEntry(r,e))}moveCells(e,t,r,n){this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var{version:i,overwrittenCellsData:o,addedGlobalNamedExpressions:s}=this.operations.moveCells(e,t,r,n);this.undoRedo.saveOperation(new d.MoveCellsUndoEntry(e,t,r,n,o,s,i))}moveRows(e,t,r,n){this.ensureItIsPossibleToMoveRows(e,t,r,n),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var i=this.operations.moveRows(e,t,r,n);this.undoRedo.saveOperation(new d.MoveRowsUndoEntry(e,t,r,n,i))}moveColumns(e,t,r,n){this.ensureItIsPossibleToMoveColumns(e,t,r,n),this.undoRedo.clearRedoStack();var i=this.operations.moveColumns(e,t,r,n);this.undoRedo.saveOperation(new d.MoveColumnsUndoEntry(e,t,r,n,i))}cut(e,t,r){this.clipboardOperations.cut(e,t,r)}ensureItIsPossibleToCopy(e,t,r){if(!p(t))throw new l.InvalidArgumentsError("width to be positive integer.");if(!p(r))throw new l.InvalidArgumentsError("height to be positive integer.")}copy(e,t,r){this.ensureItIsPossibleToCopy(e,t,r),this.clipboardOperations.copy(e,t,r)}paste(e){var t,r,n=this.clipboardOperations.clipboard;if(void 0===n)throw new l.NothingToPasteError;this.clipboardOperations.isCutClipboard()?this.moveCells(n.sourceLeftCorner,n.width,n.height,e):this.clipboardOperations.isCopyClipboard()&&(this.clipboardOperations.ensureItIsPossibleToCopyPaste(e),t=s.AbsoluteCellRange.spanFrom(e,n.width,n.height),t=this.operations.getRangeClipboardCells(t),this.undoRedo.clearRedoStack(),r=this.operations.restoreClipboardCells(n.sourceLeftCorner.sheet,n.getContent(e)),this.undoRedo.saveOperation(new d.PasteUndoEntry(e,t,n.content,r)))}beginUndoRedoBatchMode(){this.undoRedo.beginBatchMode()}commitUndoRedoBatchMode(){this.undoRedo.commitBatchMode()}isClipboardEmpty(){return void 0===this.clipboardOperations.clipboard}clearClipboard(){this.clipboardOperations.clear()}addSheet(e){void 0!==e&&this.ensureItIsPossibleToAddSheet(e),this.undoRedo.clearRedoStack();e=this.operations.addSheet(e);return this.undoRedo.saveOperation(new d.AddSheetUndoEntry(e)),e}removeSheet(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var t=this.sheetMapping.fetchDisplayName(e),r=this.operations.getSheetClipboardCells(e),{version:n,scopedNamedExpressions:i}=this.operations.removeSheet(e);this.undoRedo.saveOperation(new d.RemoveSheetUndoEntry(t,e,r,i,n))}renameSheet(e,t){this.ensureItIsPossibleToRenameSheet(e,t);var r=this.operations.renameSheet(e,t);return void 0!==r&&(this.undoRedo.clearRedoStack(),this.undoRedo.saveOperation(new d.RenameSheetUndoEntry(e,r,t))),r}clearSheet(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var t=this.operations.getSheetClipboardCells(e);this.operations.clearSheet(e),this.undoRedo.saveOperation(new d.ClearSheetUndoEntry(e,t))}setCellContents(r,n){if(n instanceof Array){for(let e=0;e<n.length;e++)if(!(n[e]instanceof Array))throw new l.InvalidArgumentsError("an array of arrays or a raw cell value.")}else n=[[n]];this.ensureItIsPossibleToChangeCellContents(r,n),this.undoRedo.clearRedoStack();var i=[];for(let t=0;t<n.length;t++)for(let e=0;e<n[t].length;e++){var o={sheet:r.sheet,row:r.row+t,col:r.col+e},s=n[t][e],a=(this.clipboardOperations.abortCut(),this.operations.setCellContent(o,s));i.push({address:o,newContent:s,oldContent:a})}this.undoRedo.saveOperation(new d.SetCellContentsUndoEntry(i))}setSheetContent(e,t){this.ensureScopeIdIsValid(e),this.ensureItIsPossibleToChangeSheetContents(e,t),(0,c.validateAsSheet)(t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var r=this.operations.getSheetClipboardCells(e);this.operations.setSheetContent(e,t),this.undoRedo.saveOperation(new d.SetSheetContentUndoEntry(e,r,t))}setRowOrder(e,t){this.validateSwapRowIndexes(e,t),this.testRowOrderForArrays(e,t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var r=this.operations.setRowOrder(e,t);this.undoRedo.saveOperation(new d.SetRowOrderUndoEntry(e,t,r))}validateSwapRowIndexes(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new l.NoSheetWithIdError(e);this.validateRowOrColumnMapping(e,t,"row")}testColumnOrderForArrays(e,t){for(var[r,n]of t)if(r!==n){n=s.AbsoluteCellRange.spanFrom({sheet:e,col:r,row:0},1,1/0);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(n))throw new l.SourceLocationHasArrayError}}setColumnOrder(e,t){this.validateSwapColumnIndexes(e,t),this.testColumnOrderForArrays(e,t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var r=this.operations.setColumnOrder(e,t);this.undoRedo.saveOperation(new d.SetColumnOrderUndoEntry(e,t,r))}validateSwapColumnIndexes(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new l.NoSheetWithIdError(e);this.validateRowOrColumnMapping(e,t,"column")}testRowOrderForArrays(e,t){for(var[r,n]of t)if(r!==n){n=s.AbsoluteCellRange.spanFrom({sheet:e,col:0,row:r},1/0,1);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(n))throw new l.SourceLocationHasArrayError}}mappingFromOrder(e,t,r){if(!this.sheetMapping.hasSheetWithId(e))throw new l.NoSheetWithIdError(e);var n="row"===r?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e);if(t.length!==n)throw new l.InvalidArgumentsError(`number of ${r}s provided to be sheet ${"row"===r?"height":"width"}.`);var i=[];for(let e=0;e<n;e++)t[e]!==e&&i.push([e,t[e]]);return i}undo(){if(this.undoRedo.isUndoStackEmpty())throw new l.NoOperationToUndoError;this.clipboardOperations.abortCut(),this.undoRedo.undo()}redo(){if(this.undoRedo.isRedoStackEmpty())throw new l.NoOperationToRedoError;this.clipboardOperations.abortCut(),this.undoRedo.redo()}addNamedExpression(e,t,r,n){this.ensureItIsPossibleToAddNamedExpression(e,t,r),this.operations.addNamedExpression(e,t,r,n),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new d.AddNamedExpressionUndoEntry(e,t,r,n))}changeNamedExpressionExpression(e,t,r,n){this.ensureItIsPossibleToChangeNamedExpression(e,r,t);var[e,i]=this.operations.changeNamedExpressionExpression(e,r,t,n);this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new d.ChangeNamedExpressionUndoEntry(e,r,i,t,n))}removeNamedExpression(e,t){this.ensureScopeIdIsValid(t);var[e,r]=this.operations.removeNamedExpression(e,t);return this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new d.RemoveNamedExpressionUndoEntry(e,r,t)),e}ensureItIsPossibleToAddNamedExpression(e,t,r){this.ensureScopeIdIsValid(r),this.ensureNamedExpressionNameIsValid(e,r),this.ensureNamedExpressionIsValid(t)}ensureItIsPossibleToChangeNamedExpression(e,t,r){if(this.ensureScopeIdIsValid(r),void 0===this.namedExpressions.namedExpressionForScope(e,r))throw new l.NamedExpressionDoesNotExistError(e);this.ensureNamedExpressionIsValid(t)}isItPossibleToRemoveNamedExpression(e,t){if(this.ensureScopeIdIsValid(t),void 0===this.namedExpressions.namedExpressionForScope(e,t))throw new l.NamedExpressionDoesNotExistError(e)}ensureItIsPossibleToAddRows(e,...t){if(!this.sheetMapping.hasSheetWithId(e))throw new l.NoSheetWithIdError(e);var r,n;if(this.dependencyGraph.getSheetHeight(e)+t.map(e=>e[1]).reduce((e,t)=>e+t,0)>this.maxRows)throw new l.SheetSizeLimitExceededError;for([r,n]of t)if(!f(r)||!p(n))throw new l.InvalidArgumentsError("row number to be nonnegative and number of rows to add to be positive.")}ensureItIsPossibleToRemoveRows(e,...t){for(var[r,n]of t){n=r+n-1;if(!f(r)||!f(n))throw new l.InvalidArgumentsError("starting and ending row to be nonnegative.");if(n<r)throw new l.InvalidArgumentsError("starting row to be smaller than the ending row.");if(!this.sheetMapping.hasSheetWithId(e))throw new l.NoSheetWithIdError(e)}}ensureItIsPossibleToAddColumns(e,...t){if(!this.sheetMapping.hasSheetWithId(e))throw new l.NoSheetWithIdError(e);var r,n;if(this.dependencyGraph.getSheetWidth(e)+t.map(e=>e[1]).reduce((e,t)=>e+t,0)>this.maxColumns)throw new l.SheetSizeLimitExceededError;for([r,n]of t)if(!f(r)||!p(n))throw new l.InvalidArgumentsError("column number to be nonnegative and number of columns to add to be positive.")}ensureItIsPossibleToRemoveColumns(e,...t){for(var[r,n]of t){n=r+n-1;if(!f(r)||!f(n))throw new l.InvalidArgumentsError("starting and ending column to be nonnegative.");if(n<r)throw new l.InvalidArgumentsError("starting column to be smaller than the ending column.");if(!this.sheetMapping.hasSheetWithId(e))throw new l.NoSheetWithIdError(e)}}ensureItIsPossibleToMoveRows(e,t,r,n){this.ensureItIsPossibleToAddRows(e,[n,r]);var i=(0,a.simpleCellAddress)(e,0,t),o=(0,a.simpleCellAddress)(e,0,n);if(!this.sheetMapping.hasSheetWithId(e)||(0,a.invalidSimpleCellAddress)(i)||(0,a.invalidSimpleCellAddress)(o)||!p(r)||n<=t+r&&t<=n)throw new l.InvalidArgumentsError("a valid range of rows to move.");o=this.dependencyGraph.getSheetWidth(e),t=s.AbsoluteCellRange.spanFrom(i,o,r);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(t))throw new l.SourceLocationHasArrayError;if(0<n&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllRows(u.RowsSpan.fromNumberOfRows(e,n-1,2)))throw new l.TargetLocationHasArrayError}ensureItIsPossibleToMoveColumns(e,t,r,n){this.ensureItIsPossibleToAddColumns(e,[n,r]);var i=(0,a.simpleCellAddress)(e,t,0),o=(0,a.simpleCellAddress)(e,n,0);if(!this.sheetMapping.hasSheetWithId(e)||(0,a.invalidSimpleCellAddress)(i)||(0,a.invalidSimpleCellAddress)(o)||!p(r)||n<=t+r&&t<=n)throw new l.InvalidArgumentsError("a valid range of columns to move.");o=this.dependencyGraph.getSheetHeight(e),t=s.AbsoluteCellRange.spanFrom(i,r,o);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(t))throw new l.SourceLocationHasArrayError;if(0<n&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllColumns(u.ColumnsSpan.fromNumberOfColumns(e,n-1,2)))throw new l.TargetLocationHasArrayError}ensureItIsPossibleToAddSheet(e){if(this.sheetMapping.hasSheetWithName(e))throw new l.SheetNameAlreadyTakenError(e)}ensureItIsPossibleToRenameSheet(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new l.NoSheetWithIdError(e);var r=this.sheetMapping.get(t);if(void 0!==r&&r!==e)throw new l.SheetNameAlreadyTakenError(t)}ensureItIsPossibleToChangeContent(e){if((0,a.invalidSimpleCellAddress)(e))throw new l.InvalidAddressError(e);if(!this.sheetMapping.hasSheetWithId(e.sheet))throw new l.NoSheetWithIdError(e.sheet)}ensureItIsPossibleToChangeCellContents(e,t){t=(0,c.findBoundaries)(t),e=s.AbsoluteCellRange.spanFrom(e,t.width,t.height);this.ensureRangeInSizeLimits(e);for(const r of e.addresses(this.dependencyGraph))this.ensureItIsPossibleToChangeContent(r)}ensureItIsPossibleToChangeSheetContents(e,t){t=(0,c.findBoundaries)(t),e=s.AbsoluteCellRange.spanFrom((0,a.simpleCellAddress)(e,0,0),t.width,t.height);this.ensureRangeInSizeLimits(e)}ensureRangeInSizeLimits(e){if(e.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new l.SheetSizeLimitExceededError}isThereSomethingToUndo(){return!this.undoRedo.isUndoStackEmpty()}isThereSomethingToRedo(){return!this.undoRedo.isRedoStackEmpty()}getAndClearContentChanges(){return this.operations.getAndClearContentChanges()}ensureScopeIdIsValid(e){if(void 0!==e&&!this.sheetMapping.hasSheetWithId(e))throw new l.NoSheetWithIdError(e)}validateRowOrColumnMapping(e,t,r){var n="row"===r?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e),i=t.map(([e])=>e).sort((e,t)=>e-t),o=t.map(([,e])=>e).sort((e,t)=>e-t);for(let e=0;e<i.length;e++){if(!f(i[e])||i[e]>=n)throw new l.InvalidArgumentsError(r+` numbers to be nonnegative integers and less than sheet ${"row"===r?"height":"width"}.`);if(i[e]===i[e+1])throw new l.InvalidArgumentsError(`source ${r} numbers to be unique.`);if(i[e]!==o[e])throw new l.InvalidArgumentsError(`target ${r} numbers to be permutation of source ${r} numbers.`)}}ensureNamedExpressionNameIsValid(e,t){if(!this.namedExpressions.isNameValid(e))throw new l.NamedExpressionNameIsInvalidError(e);if(!this.namedExpressions.isNameAvailable(e,t))throw new l.NamedExpressionNameIsAlreadyTakenError(e)}ensureNamedExpressionIsValid(e){e=this.cellContentParser.parse(e);if(e instanceof n.CellContent.Formula){e=this.parser.parse(e.formula,(0,a.simpleCellAddress)(-1,0,0));if((0,i.doesContainRelativeReferences)(e.ast))throw new l.NoRelativeAddressesAllowedError}}}function p(e){return Number.isInteger(e)&&0<e}function f(e){return Number.isInteger(e)&&0<=e}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{InternalNamedExpression:()=>s,NamedExpressions:()=>c,doesContainRelativeReferences:()=>u});var n=r(3),i=r(7),o=r(12);class s{constructor(e,t,r,n){this.displayName=e,this.address=t,this.added=r,this.options=n}normalizeExpressionName(){return this.displayName.toLowerCase()}copy(){return new s(this.displayName,this.address,this.added,this.options)}}class a{constructor(){this.mapping=new Map}has(e){return this.mapping.has(this.normalizeExpressionName(e))}isNameAvailable(e){e=this.normalizeExpressionName(e),e=this.mapping.get(e);return!(e&&e.added)}add(e){this.mapping.set(e.normalizeExpressionName(),e)}get(e){return this.mapping.get(this.normalizeExpressionName(e))}getExisting(e){e=this.mapping.get(this.normalizeExpressionName(e));if(e&&e.added)return e}remove(e){e=this.normalizeExpressionName(e),e=this.mapping.get(e);e&&(e.added=!1)}getAllNamedExpressions(){return Array.from(this.mapping.values()).filter(e=>e.added)}normalizeExpressionName(e){return e.toLowerCase()}}class l{constructor(){this.mapping=new Map}add(e){this.mapping.set(this.normalizeExpressionName(e.displayName),e)}get(e){return this.mapping.get(this.normalizeExpressionName(e))}has(e){return this.mapping.has(this.normalizeExpressionName(e))}getAllNamedExpressions(){return Array.from(this.mapping.values()).filter(e=>e.added)}isNameAvailable(e){e=this.normalizeExpressionName(e);return!this.mapping.has(e)}remove(e){e=this.normalizeExpressionName(e);this.mapping.get(e)&&this.mapping.delete(e)}normalizeExpressionName(e){return e.toLowerCase()}}class c{constructor(){this.nextNamedExpressionRow=0,this.workbookStore=new a,this.worksheetStores=new Map,this.addressCache=new Map}isNameAvailable(e,t){return void 0===t?this.workbookStore.isNameAvailable(e):null==(t=null==(t=this.worksheetStore(t))?void 0:t.isNameAvailable(e))||t}namedExpressionInAddress(e){e=this.addressCache.get(e);if(e&&e.added)return e}namedExpressionForScope(e,t){return void 0===t?this.workbookStore.getExisting(e):null==(t=this.worksheetStore(t))?void 0:t.get(e)}nearestNamedExpression(e,t){return null!=(t=null==(t=this.worksheetStore(t))?void 0:t.get(e))?t:this.workbookStore.getExisting(e)}isExpressionInScope(e,t){return null!=(t=null==(t=this.worksheetStore(t))?void 0:t.has(e))&&t}isNameValid(e){var t=new RegExp(`^${o.CELL_REFERENCE_PATTERN}$`),r=new RegExp(`^${o.R1C1_CELL_REFERENCE_PATTERN}$`),n=new RegExp(`^${o.NAMED_EXPRESSION_PATTERN}$`);return!t.test(e)&&!r.test(e)&&n.test(e)}addNamedExpression(e,t,r){t=void 0===t?this.workbookStore:this.worksheetStoreOrCreate(t);let n=t.get(e);return void 0!==n?(n.added=!0,n.displayName=e,n.options=r):(n=new s(e,this.nextAddress(),!0,r),t.add(n)),this.addressCache.set(n.address.row,n),n}restoreNamedExpression(e,t){t=void 0===t?this.workbookStore:this.worksheetStoreOrCreate(t);return e.added=!0,t.add(e),this.addressCache.set(e.address.row,e),e}namedExpressionOrPlaceholder(e,t){return null!=(t=this.worksheetStoreOrCreate(t).get(e))?t:this.workbookNamedExpressionOrPlaceholder(e)}workbookNamedExpressionOrPlaceholder(e){let t=this.workbookStore.get(e);return void 0===t&&(t=new s(e,this.nextAddress(),!1),this.workbookStore.add(t)),t}remove(e,t){let r;var n=null===(r=void 0===t?this.workbookStore:this.worksheetStore(t))||void 0===r?void 0:r.get(e);if(void 0===r||void 0===n||!n.added)throw Error("Named expression does not exist");r.remove(e),r instanceof l&&0===r.mapping.size&&this.worksheetStores.delete(t),this.addressCache.delete(n.address.row)}getAllNamedExpressionsNamesInScope(t){return this.getAllNamedExpressions().filter(({scope:e})=>e===t).map(e=>e.expression.displayName)}getAllNamedExpressionsNames(){return this.getAllNamedExpressions().map(e=>e.expression.displayName)}getAllNamedExpressions(){const r=[];return this.workbookStore.getAllNamedExpressions().forEach(e=>{r.push({expression:e,scope:void 0})}),this.worksheetStores.forEach((e,t)=>{e.getAllNamedExpressions().forEach(e=>{r.push({expression:e,scope:t})})}),r}getAllNamedExpressionsForScope(e){return void 0===e?this.workbookStore.getAllNamedExpressions():null!=(e=null==(e=this.worksheetStores.get(e))?void 0:e.getAllNamedExpressions())?e:[]}worksheetStoreOrCreate(e){let t=this.worksheetStores.get(e);return t||(t=new l,this.worksheetStores.set(e,t)),t}worksheetStore(e){return this.worksheetStores.get(e)}nextAddress(){return(0,n.simpleCellAddress)(c.SHEET_FOR_WORKBOOK_EXPRESSIONS,0,this.nextNamedExpressionRow++)}}c.SHEET_FOR_WORKBOOK_EXPRESSIONS=-1;const u=e=>{switch(e.type){case i.AstNodeType.EMPTY:case i.AstNodeType.NUMBER:case i.AstNodeType.STRING:case i.AstNodeType.ERROR:case i.AstNodeType.ERROR_WITH_RAW_INPUT:return!1;case i.AstNodeType.CELL_REFERENCE:return!e.reference.isAbsolute();case i.AstNodeType.CELL_RANGE:case i.AstNodeType.COLUMN_RANGE:case i.AstNodeType.ROW_RANGE:return!e.start.isAbsolute();case i.AstNodeType.NAMED_EXPRESSION:return!1;case i.AstNodeType.PERCENT_OP:case i.AstNodeType.PLUS_UNARY_OP:case i.AstNodeType.MINUS_UNARY_OP:return u(e.value);case i.AstNodeType.CONCATENATE_OP:case i.AstNodeType.EQUALS_OP:case i.AstNodeType.NOT_EQUAL_OP:case i.AstNodeType.LESS_THAN_OP:case i.AstNodeType.GREATER_THAN_OP:case i.AstNodeType.LESS_THAN_OR_EQUAL_OP:case i.AstNodeType.GREATER_THAN_OR_EQUAL_OP:case i.AstNodeType.MINUS_OP:case i.AstNodeType.PLUS_OP:case i.AstNodeType.TIMES_OP:case i.AstNodeType.DIV_OP:case i.AstNodeType.POWER_OP:return u(e.left)||u(e.right);case i.AstNodeType.PARENTHESIS:return u(e.expression);case i.AstNodeType.FUNCTION_CALL:return e.args.some(e=>u(e));case i.AstNodeType.ARRAY:return e.args.some(e=>e.some(e=>u(e)))}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{AddColumnsCommand:()=>A,AddRowsCommand:()=>R,Operations:()=>O,RemoveColumnsCommand:()=>N,RemoveRowsCommand:()=>x,normalizeAddedIndexes:()=>M,normalizeRemovedIndexes:()=>I});var d=r(2),h=r(6),a=r(1),l=r(3),c=r(112),s=r(113),u=r(68),p=r(4),n=r(80),i=r(117),o=r(119),f=r(120),g=r(121),m=r(122),y=r(123),v=r(124),b=r(77),w=r(70),C=r(115),E=r(7),T=r(125),S=r(71),_=r(72);class x{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return I(this.indexes)}rowsSpans(){return this.normalizedIndexes().map(e=>S.RowsSpan.fromNumberOfRows(this.sheet,e[0],e[1]))}}class R{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return M(this.indexes)}rowsSpans(){return this.normalizedIndexes().map(e=>S.RowsSpan.fromNumberOfRows(this.sheet,e[0],e[1]))}}class A{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return M(this.indexes)}columnsSpans(){return this.normalizedIndexes().map(e=>S.ColumnsSpan.fromNumberOfColumns(this.sheet,e[0],e[1]))}}class N{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return I(this.indexes)}columnsSpans(){return this.normalizedIndexes().map(e=>S.ColumnsSpan.fromNumberOfColumns(this.sheet,e[0],e[1]))}}class O{constructor(e,t,r,n,i,o,s,a,l){this.dependencyGraph=t,this.columnSearch=r,this.cellContentParser=n,this.parser=i,this.stats=o,this.lazilyTransformingAstService=s,this.namedExpressions=a,this.arraySizePredictor=l,this.changes=u.ContentChanges.empty(),this.allocateNamedExpressionAddressSpace(),this.maxColumns=e.maxColumns,this.maxRows=e.maxRows}get sheetMapping(){return this.dependencyGraph.sheetMapping}get addressMapping(){return this.dependencyGraph.addressMapping}removeRows(e){var t=[];for(const n of e.rowsSpans()){var r=this.doRemoveRows(n);r&&t.push(r)}return t}addRows(e){for(const t of e.rowsSpans())this.doAddRows(t)}addColumns(e){for(const t of e.columnsSpans())this.doAddColumns(t)}removeColumns(e){var t=[];for(const n of e.columnsSpans()){var r=this.doRemoveColumns(n);r&&t.push(r)}return t}removeSheet(t){this.dependencyGraph.removeSheet(t);let r=0;this.stats.measure(_.StatType.TRANSFORM_ASTS,()=>{var e=new v.RemoveSheetTransformer(t);e.performEagerTransformations(this.dependencyGraph,this.parser),r=this.lazilyTransformingAstService.addTransformation(e)}),this.sheetMapping.removeSheet(t),this.columnSearch.removeSheet(t);var e=this.namedExpressions.getAllNamedExpressionsForScope(t).map(e=>this.removeNamedExpression(e.normalizeExpressionName(),t));return{version:r,scopedNamedExpressions:e}}removeSheetByName(e){e=this.sheetMapping.fetch(e);return this.removeSheet(e)}clearSheet(e){this.dependencyGraph.clearSheet(e),this.columnSearch.removeSheet(e)}addSheet(e){e=this.sheetMapping.addSheet(e);return this.dependencyGraph.addressMapping.autoAddSheet(e,(0,T.findBoundaries)([])),this.sheetMapping.fetchDisplayName(e)}renameSheet(e,t){return this.sheetMapping.renameSheet(e,t)}moveRows(e,t,r,n){var i=S.RowsSpan.fromNumberOfRows(e,n,r),i=(this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddRows(i),n<t&&(t+=r),(0,l.simpleCellAddress)(e,0,t)),n=(0,l.simpleCellAddress)(e,0,n),i=(this.moveCells(i,Number.POSITIVE_INFINITY,r,n),S.RowsSpan.fromNumberOfRows(e,t,r));return this.doRemoveRows(i),this.lazilyTransformingAstService.commitCombinedMode()}moveColumns(e,t,r,n){var i=S.ColumnsSpan.fromNumberOfColumns(e,n,r),i=(this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddColumns(i),n<t&&(t+=r),(0,l.simpleCellAddress)(e,t,0)),n=(0,l.simpleCellAddress)(e,n,0),i=(this.moveCells(i,r,Number.POSITIVE_INFINITY,n),S.ColumnsSpan.fromNumberOfColumns(e,t,r));return this.doRemoveColumns(i),this.lazilyTransformingAstService.commitCombinedMode()}moveCells(e,t,r,n){this.ensureItIsPossibleToMoveCells(e,t,r,n);const i=d.AbsoluteCellRange.spanFrom(e,t,r);var o=d.AbsoluteCellRange.spanFrom(n,t,r);const s=n.col-e.col,a=n.row-e.row,l=n.sheet;var c=this.getRangeClipboardCells(o),o=this.dependencyGraph.rawValuesFromRange(o),o=(this.columnSearch.removeValues(o),this.dependencyGraph.rawValuesFromRange(i));this.columnSearch.moveValues(o,s,a,l);let u=0;this.stats.measure(_.StatType.TRANSFORM_ASTS,()=>{var e=new g.MoveCellsTransformer(i,s,a,l);e.performEagerTransformations(this.dependencyGraph,this.parser),u=this.lazilyTransformingAstService.addTransformation(e)}),this.dependencyGraph.moveCells(i,s,a,l);o=this.updateNamedExpressionsForMovedCells(e,t,r,n);return{version:u,overwrittenCellsData:c,addedGlobalNamedExpressions:o}}setRowOrder(t,e){var r,n=[];let i=[];for(const[o,s]of e)o!==s&&(r=d.AbsoluteCellRange.spanFrom({sheet:t,col:0,row:o},1/0,1),r=this.getRangeClipboardCells(r),i=i.concat(r),n.push(r.map(([{sheet:e,col:t},r])=>[{sheet:e,col:t,row:s},r])));return n.forEach(e=>this.restoreClipboardCells(t,e.values())),i}setColumnOrder(t,e){var r,n=[];let i=[];for(const[o,s]of e)o!==s&&(r=d.AbsoluteCellRange.spanFrom({sheet:t,col:o,row:0},1,1/0),r=this.getRangeClipboardCells(r),i=i.concat(r),n.push(r.map(([{sheet:e,row:t},r])=>[{sheet:e,col:s,row:t},r])));return n.forEach(e=>this.restoreClipboardCells(t,e.values())),i}addNamedExpression(e,t,r,n){n=this.namedExpressions.addNamedExpression(e,r,n);this.storeNamedExpressionInCell(n.address,t),this.adjustNamedExpressionEdges(n,e,r)}restoreNamedExpression(e,t,r){var n=e.displayName,t=(this.restoreCell(e.address,t),this.namedExpressions.restoreNamedExpression(e,r));this.adjustNamedExpressionEdges(t,n,r)}changeNamedExpressionExpression(e,t,r,n){var i,r=this.namedExpressions.namedExpressionForScope(e,r);if(r)return i=r.copy(),r.options=n,n=this.getClipboardCell(r.address),this.storeNamedExpressionInCell(r.address,t),[i,n];throw new b.NamedExpressionDoesNotExistError(e)}removeNamedExpression(e,t){var r=this.namedExpressions.namedExpressionForScope(e,t);if(!r)throw new b.NamedExpressionDoesNotExistError(e);this.namedExpressions.remove(r.displayName,t);var n=this.getClipboardCell(r.address);return void 0!==t?(t=this.namedExpressions.workbookNamedExpressionOrPlaceholder(e),this.dependencyGraph.exchangeNode(r.address,t.address)):this.dependencyGraph.setCellEmpty(r.address),[r,n]}ensureItIsPossibleToMoveCells(e,t,r,n){if((0,l.invalidSimpleCellAddress)(e)||!(k(t)&&k(r)||(i=t,s=r,0===(o=e).row&&k(i)&&s===Number.POSITIVE_INFINITY)||0===o.col&&k(s)&&i===Number.POSITIVE_INFINITY)||(0,l.invalidSimpleCellAddress)(n)||!this.sheetMapping.hasSheetWithId(e.sheet)||!this.sheetMapping.hasSheetWithId(n.sheet))throw new b.InvalidArgumentsError("a valid range of cells to move.");var i,o=d.AbsoluteCellRange.spanFrom(e,t,r),s=d.AbsoluteCellRange.spanFrom(n,t,r);if(s.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new b.SheetSizeLimitExceededError;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(o))throw new b.SourceLocationHasArrayError;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(s))throw new b.TargetLocationHasArrayError}restoreClipboardCells(e,t){var r,n,i,o=[];for([r,n]of t)this.restoreCell(r,n),n.type===s.ClipboardCellType.FORMULA&&(i=this.parser.fetchCachedResult(n.hash)["dependencies"],o.push(...this.updateNamedExpressionsForTargetAddress(e,r,i)));return o}restoreCell(e,t){switch(t.type){case s.ClipboardCellType.VALUE:this.setValueToCell(t,e);break;case s.ClipboardCellType.FORMULA:this.setFormulaToCellFromCache(t.hash,e);break;case s.ClipboardCellType.EMPTY:this.setCellEmpty(e);break;case s.ClipboardCellType.PARSING_ERROR:this.setParsingErrorToCell(t.rawInput,t.errors,e)}}getOldContent(e){var t=this.dependencyGraph.getCell(e);if(void 0===t||t instanceof p.EmptyCellVertex)return[e,{type:s.ClipboardCellType.EMPTY}];if(t instanceof p.ValueCellVertex)return[e,Object.assign({type:s.ClipboardCellType.VALUE},t.getValues())];if(t instanceof n.FormulaVertex)return[t.getAddress(this.lazilyTransformingAstService),{type:s.ClipboardCellType.FORMULA,hash:this.parser.computeHashFromAst(t.getFormula(this.lazilyTransformingAstService))}];if(t instanceof p.ParsingErrorVertex)return[e,{type:s.ClipboardCellType.PARSING_ERROR,rawInput:t.rawInput,errors:t.errors}];throw Error("Trying to copy unsupported type")}getClipboardCell(e){var t,r=this.dependencyGraph.getCell(e);if(void 0===r||r instanceof p.EmptyCellVertex)return{type:s.ClipboardCellType.EMPTY};if(r instanceof p.ValueCellVertex)return Object.assign({type:s.ClipboardCellType.VALUE},r.getValues());if(r instanceof p.ArrayVertex)return(t=r.getArrayCellValue(e))===w.EmptyValue?{type:s.ClipboardCellType.EMPTY}:{type:s.ClipboardCellType.VALUE,parsedValue:t,rawValue:r.getArrayCellRawValue(e)};if(r instanceof p.FormulaCellVertex)return{type:s.ClipboardCellType.FORMULA,hash:this.parser.computeHashFromAst(r.getFormula(this.lazilyTransformingAstService))};if(r instanceof p.ParsingErrorVertex)return{type:s.ClipboardCellType.PARSING_ERROR,rawInput:r.rawInput,errors:r.errors};throw Error("Trying to copy unsupported type")}getSheetClipboardCells(r){var e=this.dependencyGraph.getSheetHeight(r),n=this.dependencyGraph.getSheetWidth(r),i=new Array(e);for(let t=0;t<e;t++){i[t]=new Array(n);for(let e=0;e<n;e++){var o=(0,l.simpleCellAddress)(r,e,t);i[t][e]=this.getClipboardCell(o)}}return i}getRangeClipboardCells(e){var t=[];for(const r of e.addresses(this.dependencyGraph))t.push([r,this.getClipboardCell(r)]);return t}setCellContent(t,e){var r=this.cellContentParser.parse(e),n=this.getOldContent(t);if(r instanceof c.CellContent.Formula){var i=this.parser.parse(r.formula,t),{ast:o,errors:s}=i;if(0<s.length)this.setParsingErrorToCell(r.formula,s,t);else try{var a=this.arraySizePredictor.checkArraySize(o,t);if(a.width<=0||a.height<=0)throw Error("Incorrect array size");this.setFormulaToCell(t,a,i)}catch(e){if(!e.message)throw e;s={type:E.ParsingErrorType.InvalidRangeSize,message:"Invalid range size."};this.setParsingErrorToCell(r.formula,[s],t)}}else r instanceof c.CellContent.Empty?this.setCellEmpty(t):this.setValueToCell({parsedValue:r.value,rawValue:e},t);return n}setSheetContent(r,n){this.clearSheet(r);for(let t=0;t<n.length;t++)for(let e=0;e<n[t].length;e++){var i=(0,l.simpleCellAddress)(r,e,t);this.setCellContent(i,n[t][e])}}setParsingErrorToCell(e,t,r){var n=this.dependencyGraph.getCellValue(r),t=new p.ParsingErrorVertex(t,e),e=this.dependencyGraph.setParsingErrorToCell(r,t);this.columnSearch.remove((0,w.getRawValue)(n),r),this.columnSearch.applyChanges(e.getChanges()),this.changes.addAll(e),this.changes.addChange(t.getCellValue(),r)}setFormulaToCell(e,t,{ast:r,hasVolatileFunction:n,hasStructuralChangeFunction:i,dependencies:o}){var s=this.dependencyGraph.getCellValue(e),r=this.dependencyGraph.setFormulaToCell(e,r,(0,h.absolutizeDependencies)(o,e),t,n,i);this.columnSearch.remove((0,w.getRawValue)(s),e),this.columnSearch.applyChanges(r.getChanges()),this.changes.addAll(r)}setValueToCell(e,t){var r=this.dependencyGraph.getCellValue(t),n=this.dependencyGraph.setValueToCell(t,e);this.columnSearch.change((0,w.getRawValue)(r),(0,w.getRawValue)(e.parsedValue),t),this.columnSearch.applyChanges(n.getChanges().filter(e=>!(0,l.equalSimpleCellAddress)(e.address,t))),this.changes.addAll(n),this.changes.addChange(e.parsedValue,t)}setCellEmpty(e){var t,r;this.dependencyGraph.isArrayInternalCell(e)||(t=this.dependencyGraph.getCellValue(e),r=this.dependencyGraph.setCellEmpty(e),this.columnSearch.remove((0,w.getRawValue)(t),e),this.columnSearch.applyChanges(r.getChanges()),this.changes.addAll(r),this.changes.addChange(w.EmptyValue,e))}setFormulaToCellFromCache(e,t){var{ast:e,hasVolatileFunction:r,hasStructuralChangeFunction:n,dependencies:i}=this.parser.fetchCachedResult(e),i=(0,h.absolutizeDependencies)(i,t),[o]=new f.CleanOutOfScopeDependenciesTransformer(t.sheet).transformSingleAst(e,t),i=(this.parser.rememberNewAst(o),(0,h.filterDependenciesOutOfScope)(i)),e=this.arraySizePredictor.checkArraySize(e,t);this.dependencyGraph.setFormulaToCell(t,o,i,e,r,n)}rowEffectivelyNotInSheet(e,t){return this.dependencyGraph.addressMapping.getHeight(t)<=e}getAndClearContentChanges(){var e=this.changes;return this.changes=u.ContentChanges.empty(),e}forceApplyPostponedTransformations(){this.dependencyGraph.forceApplyPostponedTransformations()}doRemoveRows(r){if(!this.rowEffectivelyNotInSheet(r.rowStart,r.sheet)){var e,n=[];for([e]of this.dependencyGraph.entriesFromRowsSpan(r))n.push({address:e,cellType:this.getClipboardCell(e)});var{affectedArrays:i,contentChanges:o}=this.dependencyGraph.removeRows(r);this.columnSearch.applyChanges(o.getChanges());let t=0;return this.stats.measure(_.StatType.TRANSFORM_ASTS,()=>{var e=new y.RemoveRowsTransformer(r);e.performEagerTransformations(this.dependencyGraph,this.parser),t=this.lazilyTransformingAstService.addTransformation(e)}),this.rewriteAffectedArrays(i),{version:t,removedCells:n,rowFrom:r.rowStart,rowCount:r.numberOfRows}}}doRemoveColumns(r){if(!this.columnEffectivelyNotInSheet(r.columnStart,r.sheet)){var e,n=[];for([e]of this.dependencyGraph.entriesFromColumnsSpan(r))n.push({address:e,cellType:this.getClipboardCell(e)});var{affectedArrays:i,contentChanges:o}=this.dependencyGraph.removeColumns(r);this.columnSearch.applyChanges(o.getChanges()),this.columnSearch.removeColumns(r);let t=0;return this.stats.measure(_.StatType.TRANSFORM_ASTS,()=>{var e=new m.RemoveColumnsTransformer(r);e.performEagerTransformations(this.dependencyGraph,this.parser),t=this.lazilyTransformingAstService.addTransformation(e)}),this.rewriteAffectedArrays(i),{version:t,removedCells:n,columnFrom:r.columnStart,columnCount:r.numberOfColumns}}}doAddRows(t){var e;this.rowEffectivelyNotInSheet(t.rowStart,t.sheet)||(e=this.dependencyGraph.addRows(t)["affectedArrays"],this.stats.measure(_.StatType.TRANSFORM_ASTS,()=>{var e=new o.AddRowsTransformer(t);e.performEagerTransformations(this.dependencyGraph,this.parser),this.lazilyTransformingAstService.addTransformation(e)}),this.rewriteAffectedArrays(e))}rewriteAffectedArrays(e){for(const n of e.values()){var t,r;n.array.size.isRef||(r=n.getFormula(this.lazilyTransformingAstService),t=n.getAddress(this.lazilyTransformingAstService),r=this.parser.computeHashFromAst(r),this.setFormulaToCellFromCache(r,t))}}doAddColumns(t){var e,r;this.columnEffectivelyNotInSheet(t.columnStart,t.sheet)||({affectedArrays:e,contentChanges:r}=this.dependencyGraph.addColumns(t),this.columnSearch.addColumns(t),this.columnSearch.applyChanges(r.getChanges()),this.stats.measure(_.StatType.TRANSFORM_ASTS,()=>{var e=new i.AddColumnsTransformer(t);e.performEagerTransformations(this.dependencyGraph,this.parser),this.lazilyTransformingAstService.addTransformation(e)}),this.rewriteAffectedArrays(e))}columnEffectivelyNotInSheet(e,t){return this.dependencyGraph.addressMapping.getWidth(t)<=e}adjustNamedExpressionEdges(e,t,r){if(void 0!==r){var{vertex:n,id:i}=this.dependencyGraph.fetchCellOrCreateEmpty(e.address),o=null!=i?i:this.dependencyGraph.graph.getNodeId(n),i=this.namedExpressions.workbookNamedExpressionOrPlaceholder(t),{vertex:n,id:t}=this.dependencyGraph.fetchCellOrCreateEmpty(i.address),s=null!=t?t:this.dependencyGraph.graph.getNodeId(n);for(const c of this.dependencyGraph.graph.adjacentNodes(n))if(c instanceof p.FormulaCellVertex&&c.getAddress(this.lazilyTransformingAstService).sheet===r){var a=c.getFormula(this.lazilyTransformingAstService),l=c.getAddress(this.lazilyTransformingAstService),a=this.parser.fetchCachedResultForAst(a)["dependencies"];for(const u of(0,h.absolutizeDependencies)(a,l))u instanceof E.NamedExpressionDependency&&u.name.toLowerCase()===e.displayName.toLowerCase()&&(this.dependencyGraph.graph.removeEdge(s,c),this.dependencyGraph.graph.addEdge(o,c))}}}storeNamedExpressionInCell(e,t){var r=this.cellContentParser.parse(t);if(r instanceof c.CellContent.Formula){var n=this.parser.parse(r.formula,(0,l.simpleCellAddress)(-1,0,0));if((0,C.doesContainRelativeReferences)(n.ast))throw new b.NoRelativeAddressesAllowedError;var{ast:n,hasVolatileFunction:i,hasStructuralChangeFunction:o,dependencies:s}=n;this.dependencyGraph.setFormulaToCell(e,n,(0,h.absolutizeDependencies)(s,e),a.ArraySize.scalar(),i,o)}else r instanceof c.CellContent.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:r.value,rawValue:t},e)}updateNamedExpressionsForMovedCells(e,t,r,n){if(e.sheet===n.sheet)return[];var i=[];for(const s of d.AbsoluteCellRange.spanFrom(n,t,r).addresses(this.dependencyGraph)){var o=this.addressMapping.fetchCell(s);o instanceof p.FormulaCellVertex&&s.sheet!==e.sheet&&(o=o.getFormula(this.lazilyTransformingAstService),o=this.parser.fetchCachedResultForAst(o)["dependencies"],i.push(...this.updateNamedExpressionsForTargetAddress(e.sheet,s,o)))}return i}updateNamedExpressionsForTargetAddress(e,t,r){if(e===t.sheet)return[];var n,i,o=[],s=this.addressMapping.fetchCell(t);for(const a of(0,h.absolutizeDependencies)(r,t))a instanceof E.NamedExpressionDependency&&(i=a.name,n=this.dependencyGraph.fetchNamedExpressionVertex(i,e).vertex,(i=this.namedExpressions.isExpressionInScope(i,t.sheet)?this.dependencyGraph.fetchNamedExpressionVertex(i,t.sheet).vertex:this.copyOrFetchGlobalNamedExpressionVertex(i,n,o))!==n)&&(this.dependencyGraph.graph.removeEdgeIfExists(n,s),this.dependencyGraph.graph.addEdge(i,s));return o}allocateNamedExpressionAddressSpace(){this.dependencyGraph.addressMapping.addSheet(C.NamedExpressions.SHEET_FOR_WORKBOOK_EXPRESSIONS,new p.SparseStrategy(0,0))}copyOrFetchGlobalNamedExpressionVertex(e,t,r){let n=this.namedExpressions.namedExpressionForScope(e);var i,o;return void 0===n&&(n=this.namedExpressions.addNamedExpression(e),r.push(n.normalizeExpressionName()),t instanceof p.FormulaCellVertex?({ast:e,hasVolatileFunction:r,hasStructuralChangeFunction:i,dependencies:o}=this.parser.fetchCachedResultForAst(t.getFormula(this.lazilyTransformingAstService)),this.dependencyGraph.setFormulaToCell(n.address,e,(0,h.absolutizeDependencies)(o,n.address),a.ArraySize.scalar(),r,i)):t instanceof p.EmptyCellVertex?this.setCellEmpty(n.address):t instanceof p.ValueCellVertex&&this.setValueToCell(t.getValues(),n.address)),this.dependencyGraph.fetchCellOrCreateEmpty(n.address).vertex}}function I(e){if(e.length<=1)return e;var e=[...e].sort(([e],[t])=>e-t),t=e.reduce((e,[t,r])=>{var n=e[e.length-1],i=n[0]+n[1];return t<=i?n[1]+=Math.max(0,r-(i-t)):e.push([t,r]),e},[e[0]]);let r=0;for(let e=0;e<t.length;++e)t[e][0]-=r,r+=t[e][1];return t}function M(e){if(e.length<=1)return e;var e=[...e].sort(([e],[t])=>e-t),t=e.reduce((e,[t,r])=>{var n=e[e.length-1];return t===n[0]?n[1]=Math.max(n[1],r):e.push([t,r]),e},[e[0]]);let r=0;for(let e=0;e<t.length;++e)t[e][0]+=r,r+=t[e][1];return t}function k(e){return Number.isInteger(e)&&0<e}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{AddColumnsTransformer:()=>n});var i=r(3);class n extends r(118).Transformer{constructor(e){super(),this.columnsSpan=e}get sheet(){return this.columnsSpan.sheet}isIrreversible(){return!1}transformRowRangeAst(e,t){return e}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){throw Error("Not implemented")}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformCellAddress(e,t){var r=(0,i.absoluteSheetReference)(e,t);if(r!==this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet)return!1;const n=e.toSimpleColumnAddress(t);if(r===this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet)return this.columnsSpan.columnStart<=n.col&&e.shiftedByColumns(this.columnsSpan.numberOfColumns);if(t.sheet===this.columnsSpan.sheet&&r!==this.columnsSpan.sheet)return!(e.isColumnAbsolute()||t.col<this.columnsSpan.columnStart)&&e.shiftedByColumns(-this.columnsSpan.numberOfColumns);if(e.isColumnAbsolute())return!(e.col<this.columnsSpan.columnStart)&&e.shiftedByColumns(this.columnsSpan.numberOfColumns);{const n=e.toSimpleColumnAddress(t);return n.col<this.columnsSpan.columnStart?!(t.col<this.columnsSpan.columnStart)&&e.shiftedByColumns(-this.columnsSpan.numberOfColumns):t.col<this.columnsSpan.columnStart&&e.shiftedByColumns(this.columnsSpan.numberOfColumns)}}fixNodeAddress(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col+this.columnsSpan.numberOfColumns}):e}transformRange(e,t,r){var n=this.transformCellAddress(e,r),r=this.transformCellAddress(t,r);return n===i.ErrorType.REF||r===i.ErrorType.REF?i.ErrorType.REF:!(!n&&!r)&&[n||e,r||t]}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{Transformer:()=>o});var n=r(3),i=r(7);class o{performEagerTransformations(e,t){for(const i of e.arrayFormulaNodes()){var[r,n]=this.transformSingleAst(i.getFormula(e.lazilyTransformingAstService),i.getAddress(e.lazilyTransformingAstService)),r=t.rememberNewAst(r);i.setFormula(r),i.setAddress(n)}}transformSingleAst(e,t){return[this.transformAst(e,t),this.fixNodeAddress(t)]}transformAst(e,t){switch(e.type){case i.AstNodeType.CELL_REFERENCE:return this.transformCellReferenceAst(e,t);case i.AstNodeType.CELL_RANGE:return this.transformCellRangeAst(e,t);case i.AstNodeType.COLUMN_RANGE:return this.transformColumnRangeAst(e,t);case i.AstNodeType.ROW_RANGE:return this.transformRowRangeAst(e,t);case i.AstNodeType.EMPTY:case i.AstNodeType.ERROR:case i.AstNodeType.NUMBER:case i.AstNodeType.NAMED_EXPRESSION:case i.AstNodeType.ERROR_WITH_RAW_INPUT:case i.AstNodeType.STRING:return e;case i.AstNodeType.PERCENT_OP:case i.AstNodeType.MINUS_UNARY_OP:case i.AstNodeType.PLUS_UNARY_OP:return Object.assign(Object.assign({},e),{value:this.transformAst(e.value,t)});case i.AstNodeType.FUNCTION_CALL:return Object.assign(Object.assign({},e),{procedureName:e.procedureName,args:e.args.map(e=>this.transformAst(e,t))});case i.AstNodeType.PARENTHESIS:return Object.assign(Object.assign({},e),{expression:this.transformAst(e.expression,t)});case i.AstNodeType.ARRAY:return Object.assign(Object.assign({},e),{args:e.args.map(e=>e.map(e=>this.transformAst(e,t)))});default:return Object.assign(Object.assign({},e),{left:this.transformAst(e.left,t),right:this.transformAst(e.right,t)})}}transformCellReferenceAst(e,t){t=this.transformCellAddress(e.reference,t);return t instanceof i.CellAddress?Object.assign(Object.assign({},e),{reference:t}):t===n.ErrorType.REF?(0,i.buildCellErrorAst)(new n.CellError(n.ErrorType.REF)):e}transformCellRangeAst(e,t){t=this.transformCellRange(e.start,e.end,t);return Array.isArray(t)?Object.assign(Object.assign({},e),{start:t[0],end:t[1]}):t===n.ErrorType.REF?(0,i.buildCellErrorAst)(new n.CellError(n.ErrorType.REF)):e}transformColumnRangeAst(e,t){t=this.transformColumnRange(e.start,e.end,t);return Array.isArray(t)?Object.assign(Object.assign({},e),{start:t[0],end:t[1]}):t===n.ErrorType.REF?(0,i.buildCellErrorAst)(new n.CellError(n.ErrorType.REF)):e}transformRowRangeAst(e,t){t=this.transformRowRange(e.start,e.end,t);return Array.isArray(t)?Object.assign(Object.assign({},e),{start:t[0],end:t[1]}):t===n.ErrorType.REF?(0,i.buildCellErrorAst)(new n.CellError(n.ErrorType.REF)):e}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{AddRowsTransformer:()=>n});var i=r(3);class n extends r(118).Transformer{constructor(e){super(),this.rowsSpan=e}get sheet(){return this.rowsSpan.sheet}isIrreversible(){return!1}transformColumnRangeAst(e,t){return e}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){throw Error("Not implemented")}transformCellAddress(e,t){var r,n=(0,i.absoluteSheetReference)(e,t);return(n===this.rowsSpan.sheet||t.sheet===this.rowsSpan.sheet)&&(r=e.toSimpleRowAddress(t),n===this.rowsSpan.sheet&&t.sheet!==this.rowsSpan.sheet?this.rowsSpan.rowStart<=r.row&&e.shiftedByRows(this.rowsSpan.numberOfRows):t.sheet===this.rowsSpan.sheet&&n!==this.rowsSpan.sheet?!(e.isRowAbsolute()||t.row<this.rowsSpan.rowStart)&&e.shiftedByRows(-this.rowsSpan.numberOfRows):e.isRowAbsolute()?!(e.row<this.rowsSpan.rowStart)&&e.shiftedByRows(this.rowsSpan.numberOfRows):r.row<this.rowsSpan.rowStart?!(t.row<this.rowsSpan.rowStart)&&e.shiftedByRows(-this.rowsSpan.numberOfRows):t.row<this.rowsSpan.rowStart&&e.shiftedByRows(this.rowsSpan.numberOfRows))}fixNodeAddress(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row+this.rowsSpan.numberOfRows}):e}transformRange(e,t,r){var n=this.transformCellAddress(e,r),r=this.transformCellAddress(t,r);return n===i.ErrorType.REF||r===i.ErrorType.REF?i.ErrorType.REF:!(!n&&!r)&&[n||e,r||t]}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{CleanOutOfScopeDependenciesTransformer:()=>i});var n=r(3);class i extends r(118).Transformer{constructor(e){super(),this.sheet=e}isIrreversible(){return!0}fixNodeAddress(e){return e}transformCellAddress(e,t){return!!e.isInvalid(t)&&n.ErrorType.REF}transformCellRange(e,t,r){return!(!e.isInvalid(r)&&!t.isInvalid(r))&&n.ErrorType.REF}transformColumnRange(e,t,r){return!(!e.isInvalid(r)&&!t.isInvalid(r))&&n.ErrorType.REF}transformRowRange(e,t,r){return!(!e.isInvalid(r)&&!t.isInvalid(r))&&n.ErrorType.REF}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{DependentFormulaTransformer:()=>a,MoveCellsTransformer:()=>s});var n=r(3),o=r(7),i=r(11),t=r(118);class s extends t.Transformer{constructor(e,t,r,n){super(),this.sourceRange=e,this.toRight=t,this.toBottom=r,this.toSheet=n,this.dependentFormulaTransformer=new a(e,t,r,n)}get sheet(){return this.sourceRange.sheet}isIrreversible(){return!0}transformSingleAst(e,t){return this.sourceRange.addressInRange(t)?[this.transformAst(e,t),this.fixNodeAddress(t)]:this.dependentFormulaTransformer.transformSingleAst(e,t)}fixNodeAddress(e){return(0,n.simpleCellAddress)(this.toSheet,e.col+this.toRight,e.row+this.toBottom)}transformCellAddress(e,t){return this.transformAddress(e,t)}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}transformAddress(e,t){var r=this.sourceRange;if(e instanceof o.CellAddress){t=e.toSimpleCellAddress(t);if(r.addressInRange(t))return e.shiftAbsoluteDimensions(this.toRight,this.toBottom)}return e.shiftRelativeDimensions(-this.toRight,-this.toBottom)}transformRange(e,t,r){var n=this.sourceRange;if(e instanceof o.CellAddress&&t instanceof o.CellAddress){var i=e.toSimpleCellAddress(r),r=t.toSimpleCellAddress(r);if(n.addressInRange(i)&&n.addressInRange(r))return[e.shiftAbsoluteDimensions(this.toRight,this.toBottom),t.shiftAbsoluteDimensions(this.toRight,this.toBottom)]}return[e.shiftRelativeDimensions(-this.toRight,-this.toBottom),t.shiftRelativeDimensions(-this.toRight,-this.toBottom)]}}class a extends t.Transformer{constructor(e,t,r,n){super(),this.sourceRange=e,this.toRight=t,this.toBottom=r,this.toSheet=n}get sheet(){return this.sourceRange.sheet}isIrreversible(){return!0}fixNodeAddress(e){return e}transformCellAddress(e,t){return!!this.shouldMove(e,t)&&e.moved(this.toSheet,this.toRight,this.toBottom)}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}shouldMove(e,t){return e instanceof o.CellAddress?this.sourceRange.addressInRange(e.toSimpleCellAddress(t)):e instanceof i.RowAddress?this.sourceRange.rowInRange(e.toSimpleRowAddress(t))&&!this.sourceRange.isFinite():this.sourceRange.columnInRange(e.toSimpleColumnAddress(t))&&!this.sourceRange.isFinite()}transformRange(e,t,r){e=this.transformCellAddress(e,r),t=this.transformCellAddress(t,r);return!(!e||!t)&&[e,t]}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{RemoveColumnsTransformer:()=>n});var a=r(3);class n extends r(118).Transformer{constructor(e){super(),this.columnsSpan=e}get sheet(){return this.columnsSpan.sheet}isIrreversible(){return!0}transformRowRangeAst(e,t){return e}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){throw Error("Not implemented")}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformCellAddress(e,t){var r=(0,a.absoluteSheetReference)(e,t);if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet!==r)return!1;if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet===r){var n=e.toSimpleColumnAddress(t);if(n.col<this.columnsSpan.columnStart)return!1;if(n.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet!==r){if(e.isColumnAbsolute())return!1;if(t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet===r)if(e.isColumnAbsolute()){if(e.col<this.columnsSpan.columnStart)return!1;if(e.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}else{n=e.toSimpleColumnAddress(t);if(n.col<this.columnsSpan.columnStart){if(t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}else if(n.col>this.columnsSpan.columnEnd){if(t.col<this.columnsSpan.columnStart)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns);if(t.col>this.columnsSpan.columnEnd)return!1}}return a.ErrorType.REF}fixNodeAddress(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col-this.columnsSpan.numberOfColumns}):e}transformRange(e,t,r){var n=(0,a.absoluteSheetReference)(e,r);let i=e,o=t;if(this.columnsSpan.sheet===n){var n=e.toSimpleColumnAddress(r),s=t.toSimpleColumnAddress(r);if(this.columnsSpan.columnStart<=n.col&&this.columnsSpan.columnEnd>=s.col)return a.ErrorType.REF;n.col>=this.columnsSpan.columnStart&&n.col<=this.columnsSpan.columnEnd&&(i=e.shiftedByColumns(this.columnsSpan.columnEnd-n.col+1)),s.col>=this.columnsSpan.columnStart&&s.col<=this.columnsSpan.columnEnd&&(o=t.shiftedByColumns(-(s.col-this.columnsSpan.columnStart+1)))}e=this.transformCellAddress(i,r),n=this.transformCellAddress(o,r);if(!1===e&&!1===n)return[i,o];if(e===a.ErrorType.REF||n===a.ErrorType.REF)throw Error("Cannot happen");return[e||i,n||o]}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{RemoveRowsTransformer:()=>n});var a=r(3);class n extends r(118).Transformer{constructor(e){super(),this.rowsSpan=e}get sheet(){return this.rowsSpan.sheet}isIrreversible(){return!0}transformColumnRangeAst(e,t){return e}transformCellAddress(e,t){var r=(0,a.absoluteSheetReference)(e,t);if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet!==r)return!1;if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet===r){var n=e.toSimpleRowAddress(t);if(n.row<this.rowsSpan.rowStart)return!1;if(n.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet!==r){if(e.isRowAbsolute())return!1;if(t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet===r)if(e.isRowAbsolute()){if(e.row<this.rowsSpan.rowStart)return!1;if(e.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}else{n=e.toSimpleRowAddress(t);if(n.row<this.rowsSpan.rowStart){if(t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}else if(n.row>this.rowsSpan.rowEnd){if(t.row<this.rowsSpan.rowStart)return e.shiftedByRows(-this.rowsSpan.numberOfRows);if(t.row>this.rowsSpan.rowEnd)return!1}}return a.ErrorType.REF}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){throw Error("Not implemented")}fixNodeAddress(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row-this.rowsSpan.numberOfRows}):e}transformRange(e,t,r){var n=(0,a.absoluteSheetReference)(e,r);let i=e,o=t;if(this.rowsSpan.sheet===n){var n=e.toSimpleRowAddress(r),s=t.toSimpleRowAddress(r);if(this.rowsSpan.rowStart<=n.row&&this.rowsSpan.rowEnd>=s.row)return a.ErrorType.REF;n.row>=this.rowsSpan.rowStart&&n.row<=this.rowsSpan.rowEnd&&(i=e.shiftedByRows(this.rowsSpan.rowEnd-n.row+1)),s.row>=this.rowsSpan.rowStart&&s.row<=this.rowsSpan.rowEnd&&(o=t.shiftedByRows(-(s.row-this.rowsSpan.rowStart+1)))}e=this.transformCellAddress(i,r),n=this.transformCellAddress(o,r);return!1===e&&!1===n?[i,o]:e===a.ErrorType.REF||n===a.ErrorType.REF?a.ErrorType.REF:[e||i,n||o]}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{RemoveSheetTransformer:()=>i});var n=r(3);class i extends r(118).Transformer{constructor(e){super(),this.sheet=e}isIrreversible(){return!0}performEagerTransformations(e,t){for(const n of e.arrayFormulaNodes()){var[r]=this.transformSingleAst(n.getFormula(e.lazilyTransformingAstService),n.getAddress(e.lazilyTransformingAstService));n.setFormula(r)}}fixNodeAddress(e){return e}transformCellAddress(e,t){return this.transformAddress(e)}transformCellRange(e,t,r){return this.transformAddress(e)}transformColumnRange(e,t,r){return this.transformAddress(e)}transformRowRange(e,t,r){return this.transformAddress(e)}transformAddress(e){return e.sheet===this.sheet&&n.ErrorType.REF}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{findBoundaries:()=>function(n){let e=0,i=0,o=0;for(let r=0;r<n.length;r++){let t=0;for(let e=0;e<n[r].length;e++){var s=n[r][e];null!=s&&(t=e+1,++o)}e=Math.max(e,t),0<t&&(i=r+1)}var t=e*i;return{height:i,width:e,fill:0==t?0:o/t}},validateAsSheet:()=>function(t){if(!Array.isArray(t))throw new n.InvalidArgumentsError("an array of arrays.");for(let e=0;e<t.length;e++)if(!Array.isArray(t[e]))throw new n.InvalidArgumentsError("an array of arrays.")}});var n=r(77)},(e,t,r)=>{"use strict";r.r(t),r.d(t,{AddColumnsUndoEntry:()=>f,AddNamedExpressionUndoEntry:()=>E,AddRowsUndoEntry:()=>a,AddSheetUndoEntry:()=>m,BaseUndoEntry:()=>n,BatchUndoEntry:()=>_,ChangeNamedExpressionUndoEntry:()=>S,ClearSheetUndoEntry:()=>b,MoveCellsUndoEntry:()=>o,MoveColumnsUndoEntry:()=>p,MoveRowsUndoEntry:()=>h,PasteUndoEntry:()=>C,RemoveColumnsUndoEntry:()=>g,RemoveNamedExpressionUndoEntry:()=>T,RemoveRowsUndoEntry:()=>i,RemoveSheetUndoEntry:()=>y,RenameSheetUndoEntry:()=>v,SetCellContentsUndoEntry:()=>w,SetColumnOrderUndoEntry:()=>u,SetRowOrderUndoEntry:()=>c,SetSheetContentUndoEntry:()=>d,UndoRedo:()=>x});var l=r(3),s=r(116);class n{}class i extends n{constructor(e,t){super(),this.command=e,this.rowsRemovals=t}doUndo(e){e.undoRemoveRows(this)}doRedo(e){e.redoRemoveRows(this)}}class o extends n{constructor(e,t,r,n,i,o,s){super(),this.sourceLeftCorner=e,this.width=t,this.height=r,this.destinationLeftCorner=n,this.overwrittenCellsData=i,this.addedGlobalNamedExpressions=o,this.version=s}doUndo(e){e.undoMoveCells(this)}doRedo(e){e.redoMoveCells(this)}}class a extends n{constructor(e){super(),this.command=e}doUndo(e){e.undoAddRows(this)}doRedo(e){e.redoAddRows(this)}}class c extends n{constructor(e,t,r){super(),this.sheetId=e,this.rowMapping=t,this.oldContent=r}doUndo(e){e.undoSetRowOrder(this)}doRedo(e){e.redoSetRowOrder(this)}}class u extends n{constructor(e,t,r){super(),this.sheetId=e,this.columnMapping=t,this.oldContent=r}doUndo(e){e.undoSetColumnOrder(this)}doRedo(e){e.redoSetColumnOrder(this)}}class d extends n{constructor(e,t,r){super(),this.sheetId=e,this.oldSheetContent=t,this.newSheetContent=r}doUndo(e){e.undoSetSheetContent(this)}doRedo(e){e.redoSetSheetContent(this)}}class h extends n{constructor(e,t,r,n,i){super(),this.sheet=e,this.startRow=t,this.numberOfRows=r,this.targetRow=n,this.version=i,this.undoStart=this.startRow<this.targetRow?this.targetRow-this.numberOfRows:this.targetRow,this.undoEnd=this.startRow>this.targetRow?this.startRow+this.numberOfRows:this.startRow}doUndo(e){e.undoMoveRows(this)}doRedo(e){e.redoMoveRows(this)}}class p extends n{constructor(e,t,r,n,i){super(),this.sheet=e,this.startColumn=t,this.numberOfColumns=r,this.targetColumn=n,this.version=i,this.undoStart=this.startColumn<this.targetColumn?this.targetColumn-this.numberOfColumns:this.targetColumn,this.undoEnd=this.startColumn>this.targetColumn?this.startColumn+this.numberOfColumns:this.startColumn}doUndo(e){e.undoMoveColumns(this)}doRedo(e){e.redoMoveColumns(this)}}class f extends n{constructor(e){super(),this.command=e}doUndo(e){e.undoAddColumns(this)}doRedo(e){e.redoAddColumns(this)}}class g extends n{constructor(e,t){super(),this.command=e,this.columnsRemovals=t}doUndo(e){e.undoRemoveColumns(this)}doRedo(e){e.redoRemoveColumns(this)}}class m extends n{constructor(e){super(),this.sheetName=e}doUndo(e){e.undoAddSheet(this)}doRedo(e){e.redoAddSheet(this)}}class y extends n{constructor(e,t,r,n,i){super(),this.sheetName=e,this.sheetId=t,this.oldSheetContent=r,this.scopedNamedExpressions=n,this.version=i}doUndo(e){e.undoRemoveSheet(this)}doRedo(e){e.redoRemoveSheet(this)}}class v extends n{constructor(e,t,r){super(),this.sheetId=e,this.oldName=t,this.newName=r}doUndo(e){e.undoRenameSheet(this)}doRedo(e){e.redoRenameSheet(this)}}class b extends n{constructor(e,t){super(),this.sheetId=e,this.oldSheetContent=t}doUndo(e){e.undoClearSheet(this)}doRedo(e){e.redoClearSheet(this)}}class w extends n{constructor(e){super(),this.cellContents=e}doUndo(e){e.undoSetCellContents(this)}doRedo(e){e.redoSetCellContents(this)}}class C extends n{constructor(e,t,r,n){super(),this.targetLeftCorner=e,this.oldContent=t,this.newContent=r,this.addedGlobalNamedExpressions=n}doUndo(e){e.undoPaste(this)}doRedo(e){e.redoPaste(this)}}class E extends n{constructor(e,t,r,n){super(),this.name=e,this.newContent=t,this.scope=r,this.options=n}doUndo(e){e.undoAddNamedExpression(this)}doRedo(e){e.redoAddNamedExpression(this)}}class T extends n{constructor(e,t,r){super(),this.namedExpression=e,this.content=t,this.scope=r}doUndo(e){e.undoRemoveNamedExpression(this)}doRedo(e){e.redoRemoveNamedExpression(this)}}class S extends n{constructor(e,t,r,n,i){super(),this.namedExpression=e,this.newContent=t,this.oldContent=r,this.scope=n,this.options=i}doUndo(e){e.undoChangeNamedExpression(this)}doRedo(e){e.redoChangeNamedExpression(this)}}class _ extends n{constructor(){super(...arguments),this.operations=[]}add(e){this.operations.push(e)}*reversedOperations(){for(let e=this.operations.length-1;0<=e;e--)yield this.operations[e]}doUndo(e){e.undoBatch(this)}doRedo(e){e.redoBatch(this)}}class x{constructor(e,t){this.operations=t,this.oldData=new Map,this.undoStack=[],this.redoStack=[],this.undoLimit=e.undoLimit}saveOperation(e){void 0!==this.batchUndoEntry?this.batchUndoEntry.add(e):this.addUndoEntry(e)}beginBatchMode(){this.batchUndoEntry=new _}commitBatchMode(){if(void 0===this.batchUndoEntry)throw Error("Batch mode wasn't started");this.addUndoEntry(this.batchUndoEntry),this.batchUndoEntry=void 0}storeDataForVersion(e,t,r){this.oldData.has(e)||this.oldData.set(e,[]),this.oldData.get(e).push([t,r])}clearRedoStack(){this.redoStack=[]}clearUndoStack(){this.undoStack=[]}isUndoStackEmpty(){return 0===this.undoStack.length}isRedoStackEmpty(){return 0===this.redoStack.length}undo(){var e=this.undoStack.pop();if(!e)throw Error("Attempted to undo without operation on stack");this.undoEntry(e),this.redoStack.push(e)}undoBatch(e){for(const t of e.reversedOperations())this.undoEntry(t)}undoRemoveRows(e){this.operations.forceApplyPostponedTransformations();var{command:{sheet:t},rowsRemovals:r}=e;for(let e=r.length-1;0<=e;--e){var n,i,o=r[e];this.operations.addRows(new s.AddRowsCommand(t,[[o.rowFrom,o.rowCount]]));for({address:n,cellType:i}of o.removedCells)this.operations.restoreCell(n,i);this.restoreOldDataFromVersion(o.version-1)}}undoRemoveColumns(e){this.operations.forceApplyPostponedTransformations();var{command:{sheet:t},columnsRemovals:r}=e;for(let e=r.length-1;0<=e;--e){var n,i,o=r[e];this.operations.addColumns(new s.AddColumnsCommand(t,[[o.columnFrom,o.columnCount]]));for({address:n,cellType:i}of o.removedCells)this.operations.restoreCell(n,i);this.restoreOldDataFromVersion(o.version-1)}}undoAddRows(t){var r=t.command.rowsSpans();for(let e=r.length-1;0<=e;--e){var n=r[e];this.operations.removeRows(new s.RemoveRowsCommand(t.command.sheet,[[n.rowStart,n.numberOfRows]]))}}undoAddColumns(t){var r=t.command.columnsSpans();for(let e=r.length-1;0<=e;--e){var n=r[e];this.operations.removeColumns(new s.RemoveColumnsCommand(t.command.sheet,[[n.columnStart,n.numberOfColumns]]))}}undoSetCellContents(e){for(const i of e.cellContents){var t=i.address,[r,n]=i.oldContent;(0,l.equalSimpleCellAddress)(t,r)||this.operations.setCellEmpty(t),this.operations.restoreCell(r,n)}}undoPaste(e){this.restoreOperationOldContent(e.oldContent);for(const t of e.addedGlobalNamedExpressions)this.operations.removeNamedExpression(t)}undoMoveRows(e){var t=e["sheet"];this.operations.moveRows(t,e.undoStart,e.numberOfRows,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}undoMoveColumns(e){var t=e["sheet"];this.operations.moveColumns(t,e.undoStart,e.numberOfColumns,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}undoMoveCells(e){this.operations.forceApplyPostponedTransformations(),this.operations.moveCells(e.destinationLeftCorner,e.width,e.height,e.sourceLeftCorner),this.restoreOperationOldContent(e.overwrittenCellsData),this.restoreOldDataFromVersion(e.version-1);for(const t of e.addedGlobalNamedExpressions)this.operations.removeNamedExpression(t)}undoAddSheet(e){e=e.sheetName;this.operations.removeSheetByName(e)}undoRemoveSheet(e){this.operations.forceApplyPostponedTransformations();var t,r,{oldSheetContent:n,sheetId:i}=e;this.operations.addSheet(e.sheetName);for(let t=0;t<n.length;t++){var o=n[t];for(let e=0;e<o.length;e++){var s=o[e],a=(0,l.simpleCellAddress)(i,e,t);this.operations.restoreCell(a,s)}}for([t,r]of e.scopedNamedExpressions)this.operations.restoreNamedExpression(t,r,i);this.restoreOldDataFromVersion(e.version-1)}undoRenameSheet(e){this.operations.renameSheet(e.sheetId,e.oldName)}undoClearSheet(e){var{oldSheetContent:r,sheetId:n}=e;for(let t=0;t<r.length;t++){var i=r[t];for(let e=0;e<i.length;e++){var o=i[e],s=(0,l.simpleCellAddress)(n,e,t);this.operations.restoreCell(s,o)}}}undoSetSheetContent(e){var{oldSheetContent:r,sheetId:n}=e;this.operations.clearSheet(n);for(let t=0;t<r.length;t++){var i=r[t];for(let e=0;e<i.length;e++){var o=i[e],s=(0,l.simpleCellAddress)(n,e,t);this.operations.restoreCell(s,o)}}}undoAddNamedExpression(e){this.operations.removeNamedExpression(e.name,e.scope)}undoRemoveNamedExpression(e){this.operations.restoreNamedExpression(e.namedExpression,e.content,e.scope)}undoChangeNamedExpression(e){this.operations.restoreNamedExpression(e.namedExpression,e.oldContent,e.scope)}undoSetRowOrder(e){this.restoreOperationOldContent(e.oldContent)}undoSetColumnOrder(e){this.restoreOperationOldContent(e.oldContent)}redo(){var e=this.redoStack.pop();if(!e)throw Error("Attempted to redo without operation on stack");this.redoEntry(e),this.undoStack.push(e)}redoBatch(e){for(const t of e.operations)this.redoEntry(t)}redoRemoveRows(e){this.operations.removeRows(e.command)}redoMoveCells(e){this.operations.moveCells(e.sourceLeftCorner,e.width,e.height,e.destinationLeftCorner)}redoRemoveColumns(e){this.operations.removeColumns(e.command)}redoPaste(e){var{targetLeftCorner:r,newContent:n}=e,i=n.length,o=n[0].length;for(let t=0;t<i;++t)for(let e=0;e<o;++e){var s=(0,l.simpleCellAddress)(r.sheet,r.col+e,r.row+t);this.operations.restoreCell(s,n[t][e])}}redoSetCellContents(e){for(const t of e.cellContents)this.operations.setCellContent(t.address,t.newContent)}redoAddRows(e){this.operations.addRows(e.command)}redoAddColumns(e){this.operations.addColumns(e.command)}redoRemoveSheet(e){this.operations.removeSheetByName(e.sheetName)}redoAddSheet(e){this.operations.addSheet(e.sheetName)}redoRenameSheet(e){this.operations.renameSheet(e.sheetId,e.newName)}redoMoveRows(e){this.operations.moveRows(e.sheet,e.startRow,e.numberOfRows,e.targetRow)}redoMoveColumns(e){this.operations.moveColumns(e.sheet,e.startColumn,e.numberOfColumns,e.targetColumn)}redoClearSheet(e){this.operations.clearSheet(e.sheetId)}redoSetSheetContent(e){var{sheetId:e,newSheetContent:t}=e;this.operations.setSheetContent(e,t)}redoAddNamedExpression(e){this.operations.addNamedExpression(e.name,e.newContent,e.scope,e.options)}redoRemoveNamedExpression(e){this.operations.removeNamedExpression(e.namedExpression.displayName,e.scope)}redoChangeNamedExpression(e){this.operations.changeNamedExpressionExpression(e.namedExpression.displayName,e.newContent,e.scope,e.options)}redoSetRowOrder(e){this.operations.setRowOrder(e.sheetId,e.rowMapping)}redoSetColumnOrder(e){this.operations.setColumnOrder(e.sheetId,e.columnMapping)}addUndoEntry(e){this.undoStack.push(e),this.undoStack.splice(0,Math.max(0,this.undoStack.length-this.undoLimit))}undoEntry(e){e.doUndo(this)}restoreOperationOldContent(e){for(var[t,r]of e)this.operations.restoreCell(t,r)}redoEntry(e){e.doRedo(this)}restoreOldDataFromVersion(e){for(const n of this.oldData.get(e)||[]){var[t,r]=n;this.operations.setFormulaToCellFromCache(r,t)}}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{Evaluator:()=>p});var s=r(2),a=r(6),n=r(3),o=r(68),l=r(4),c=r(80),u=r(95),d=r(70),i=r(69),h=r(72);class p{constructor(e,t,r,n,i,o){this.config=e,this.stats=t,this.interpreter=r,this.lazilyTransformingAstService=n,this.dependencyGraph=i,this.columnSearch=o}run(){this.stats.start(h.StatType.TOP_SORT);const{sorted:e,cycled:t}=this.dependencyGraph.topSortWithScc();this.stats.end(h.StatType.TOP_SORT),this.stats.measure(h.StatType.EVALUATION,()=>{this.recomputeFormulas(t,e)})}partialRun(e){const i=o.ContentChanges.empty();return this.stats.measure(h.StatType.EVALUATION,()=>{this.dependencyGraph.graph.getTopSortedWithSccSubgraphFrom(e,e=>{var t,r,n;return e instanceof c.FormulaVertex?(t=e.isComputed()?e.getCellValue():void 0,(r=this.recomputeFormulaVertexValue(e))!==t&&(n=e.getAddress(this.lazilyTransformingAstService),i.addChange(r,n),this.columnSearch.change((0,d.getRawValue)(t),(0,d.getRawValue)(r),n),!0)):(e instanceof l.RangeVertex&&e.clearCache(),!0)},e=>{var t,r;e instanceof l.RangeVertex?e.clearCache():e instanceof c.FormulaVertex&&(t=e.getAddress(this.lazilyTransformingAstService),this.columnSearch.remove((0,d.getRawValue)(e.valueOrUndef()),t),r=new n.CellError(n.ErrorType.CYCLE,void 0,e),e.setCellValue(r),i.addChange(r,t))})}),i}runAndForget(e,t,r){var n,i=[];for(const o of(0,a.absolutizeDependencies)(r,t))o instanceof s.AbsoluteCellRange&&(n=o,void 0===this.dependencyGraph.getRange(n.start,n.end))&&(n=new l.RangeVertex(n),this.dependencyGraph.rangeMapping.setRange(n),i.push(n));r=this.evaluateAstToCellValue(e,new u.InterpreterState(t,this.config.useArrayArithmetic));return i.forEach(e=>{this.dependencyGraph.rangeMapping.removeRange(e)}),r}recomputeFormulas(e,t){e.forEach(e=>{e instanceof c.FormulaVertex&&e.setCellValue(new n.CellError(n.ErrorType.CYCLE,void 0,e))}),t.forEach(e=>{var t,r;e instanceof c.FormulaVertex?(t=this.recomputeFormulaVertexValue(e),r=e.getAddress(this.lazilyTransformingAstService),this.columnSearch.add((0,d.getRawValue)(t),r)):e instanceof l.RangeVertex&&e.clearCache()})}recomputeFormulaVertexValue(e){var t,r=e.getAddress(this.lazilyTransformingAstService);return e instanceof l.ArrayVertex&&(e.array.size.isRef||!this.dependencyGraph.isThereSpaceForArray(e))?e.setNoSpace():(t=e.getFormula(this.lazilyTransformingAstService),t=this.evaluateAstToCellValue(t,new u.InterpreterState(r,this.config.useArrayArithmetic,e)),e.setCellValue(t))}evaluateAstToCellValue(e,t){e=this.interpreter.evaluateAst(e,t);return!(e instanceof i.SimpleRangeValue)&&e===d.EmptyValue&&this.config.evaluateNullToZero?0:e}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{ExportedCellChange:()=>u,ExportedNamedExpressionChange:()=>d,Exporter:()=>h});var n=r(3),i=r(100),o=r(61),s=r(70),a=r(69),l=r(115),c=r(8);class u{constructor(e,t){this.address=e,this.newValue=t}get col(){return this.address.col}get row(){return this.address.row}get sheet(){return this.address.sheet}get value(){return this.newValue}}class d{constructor(e,t){this.name=e,this.newValue=t}}class h{constructor(e,t,r,n){this.config=e,this.namedExpressions=t,this.sheetIndexMapping=r,this.lazilyTransformingService=n}exportChange(e){var t=e.value,e=e.address;if(e.sheet===l.NamedExpressions.SHEET_FOR_WORKBOOK_EXPRESSIONS){var r=this.namedExpressions.namedExpressionInAddress(e.row);if(r)return new d(r.displayName,this.exportScalarOrRange(t));throw new Error("Missing named expression")}if(t instanceof a.SimpleRangeValue){var n,i,o=[];for([n,i]of t.entriesFromTopLeftCorner(e))o.push(new u(i,this.exportValue(n)));return o}return new u(e,this.exportValue(t))}exportValue(e){return e instanceof a.SimpleRangeValue?this.detailedError(new n.CellError(n.ErrorType.VALUE,o.ErrorMessage.ScalarExpected)):this.config.smartRounding&&(0,s.isExtendedNumber)(e)?this.cellValueRounding((0,s.getRawValue)(e)):e instanceof n.CellError?this.detailedError(e):e===s.EmptyValue?null:(0,s.getRawValue)(e)}exportScalarOrRange(e){return e instanceof a.SimpleRangeValue?e.rawData().map(e=>e.map(e=>this.exportValue(e))):this.exportValue(e)}detailedError(e){var t;let r=void 0;var n=null==(n=e.root)?void 0:n.getAddress(this.lazilyTransformingService);return void 0!==n&&(r=n.sheet===l.NamedExpressions.SHEET_FOR_WORKBOOK_EXPRESSIONS?null==(t=this.namedExpressions.namedExpressionInAddress(n.row))?void 0:t.displayName:(0,c.simpleCellAddressToString)(this.sheetIndexMapping,n,-1)),new i.DetailedCellError(e,this.config.translationPackage.getErrorTranslation(e.type),r)}cellValueRounding(e){var t;return 0===e?e:(t=Math.floor(Math.log10(Math.abs(e))),t=Math.pow(10,this.config.precisionRounding-t),e<0?-Math.round(-e*t)/t:Math.round(e*t)/t)}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{GraphBuilder:()=>n,SimpleStrategy:()=>s});var h=r(6),p=r(1),f=r(3),g=r(112),m=r(4),y=r(70),v=r(72);class n{constructor(e,t,r,n,i,o){this.dependencyGraph=e,this.columnSearch=t,this.parser=r,this.cellContentParser=n,this.stats=i,this.arraySizePredictor=o,this.buildStrategy=new s(e,t,r,i,n,o)}buildGraph(e,t){const r=t.measure(v.StatType.COLLECT_DEPENDENCIES,()=>this.buildStrategy.run(e));this.dependencyGraph.getAndClearContentChanges(),t.measure(v.StatType.PROCESS_DEPENDENCIES,()=>this.processDependencies(r))}processDependencies(e){e.forEach((e,t)=>{this.dependencyGraph.processCellDependencies(e,t)})}}class s{constructor(e,t,r,n,i,o){this.dependencyGraph=e,this.columnIndex=t,this.parser=r,this.stats=n,this.cellContentParser=i,this.arraySizePredictor=o}run(e){var r=new Map;for(const t in e){var n=this.dependencyGraph.getSheetId(t),i=e[t];for(let t=0;t<i.length;++t){var o=i[t];for(let e=0;e<o.length;++e){var s,a,l,c=o[e];const u=(0,f.simpleCellAddress)(n,e,t),d=this.cellContentParser.parse(c);d instanceof g.CellContent.Formula?0<(l=this.stats.measure(v.StatType.PARSER,()=>this.parser.parse(d.formula,u))).errors.length?(this.shrinkArrayIfNeeded(u),s=new m.ParsingErrorVertex(l.errors,d.formula),this.dependencyGraph.addVertex(u,s)):(this.shrinkArrayIfNeeded(u),(s=this.arraySizePredictor.checkArraySize(l.ast,u)).isScalar()?(a=new m.FormulaCellVertex(l.ast,u,0),r.set(a,(0,h.absolutizeDependencies)(l.dependencies,u)),this.dependencyGraph.addVertex(u,a),l.hasVolatileFunction&&this.dependencyGraph.markAsVolatile(a),l.hasStructuralChangeFunction&&this.dependencyGraph.markAsDependentOnStructureChange(a)):(a=new m.ArrayVertex(l.ast,u,new p.ArraySize(s.width,s.height)),r.set(a,(0,h.absolutizeDependencies)(l.dependencies,u)),this.dependencyGraph.addArrayVertex(u,a))):d instanceof g.CellContent.Empty||(this.shrinkArrayIfNeeded(u),l=new m.ValueCellVertex(d.value,c),this.columnIndex.add((0,y.getRawValue)(d.value),u),this.dependencyGraph.addVertex(u,l))}}}return r}shrinkArrayIfNeeded(e){e=this.dependencyGraph.getCell(e);e instanceof m.ArrayVertex&&this.dependencyGraph.shrinkArrayToCorner(e)}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{FunctionRegistry:()=>s});var i=r(77),n=r(110),t=r(131);function a(e,t){let r=t.implementedFunctions[e];var n=null==(n=t.aliases)?void 0:n[e];if(void 0!==n){if(void 0!==r)throw new i.AliasAlreadyExisting(e,t.name);r=t.implementedFunctions[n]}if(void 0===r)throw i.FunctionPluginValidationError.functionNotDeclaredInPlugin(e,t.name);return r}class s{constructor(e){if(this.config=e,this.functions=new Map,this.arraySizeFunctions=new Map,this.volatileFunctions=new Set,this.arrayFunctions=new Set,this.structuralChangeFunctions=new Set,this.functionsWhichDoesNotNeedArgumentsToBeComputed=new Set,this.functionsMetadata=new Map,this.doesFunctionNeedArgumentToBeComputed=e=>this.functionsWhichDoesNotNeedArgumentsToBeComputed.has(e),this.isFunctionVolatile=e=>this.volatileFunctions.has(e),this.isArrayFunction=e=>this.arrayFunctions.has(e),this.isFunctionDependentOnSheetStructureChange=e=>this.structuralChangeFunctions.has(e),0<e.functionPlugins.length){this.instancePlugins=new Map;for(const o of e.functionPlugins)s.loadPluginFunctions(o,this.instancePlugins)}else this.instancePlugins=new Map(s.plugins);for(var[t,r]of s.protectedFunctions())s.loadFunctionUnprotected(r,t,this.instancePlugins);for(var[n,i]of this.instancePlugins.entries())this.categorizeFunction(n,a(n,i))}static registerFunctionPlugin(e,t){this.loadPluginFunctions(e,this.plugins),void 0!==t&&this.loadTranslations(t)}static registerFunction(e,t,r){this.loadPluginFunction(t,e,this.plugins),void 0!==r&&this.loadTranslations(r)}static unregisterFunction(e){if(this.functionIsProtected(e))throw i.ProtectedFunctionError.cannotUnregisterFunctionWithId(e);this.plugins.delete(e)}static unregisterFunctionPlugin(e){for(const n of this.protectedPlugins())if(n===e)throw i.ProtectedFunctionError.cannotUnregisterProtectedPlugin();for(var[t,r]of this.plugins.entries())r===e&&this.plugins.delete(t)}static unregisterAll(){this.plugins.clear()}static getRegisteredFunctionIds(){return[...Array.from(this.plugins.keys()),...Array.from(this._protectedPlugins.keys())]}static getPlugins(){return Array.from(new Set(this.plugins.values()).values())}static getFunctionPlugin(e){if(!this.functionIsProtected(e))return this.plugins.get(e)}static functionIsProtected(e){return this._protectedPlugins.has(e)}static loadTranslations(t){const r=new Set(n.HyperFormula.getRegisteredLanguagesCodes());Object.keys(t).forEach(e=>{r.has(e)&&n.HyperFormula.getLanguage(e).extendFunctions(t[e])})}static loadPluginFunctions(t,r){Object.keys(t.implementedFunctions).forEach(e=>{this.loadPluginFunction(t,e,r)}),void 0!==t.aliases&&Object.keys(t.aliases).forEach(e=>{this.loadPluginFunction(t,e,r)})}static loadPluginFunction(e,t,r){if(this.functionIsProtected(t))throw i.ProtectedFunctionError.cannotRegisterFunctionWithId(t);this.loadFunctionUnprotected(e,t,r)}static loadFunctionUnprotected(e,t,r){var n=a(t,e).method;if(!Object.prototype.hasOwnProperty.call(e.prototype,n))throw i.FunctionPluginValidationError.functionMethodNotFound(n,e.name);r.set(t,e)}static*protectedFunctions(){for(var[e,t]of this._protectedPlugins)void 0!==t&&(yield[e,t])}static*protectedPlugins(){for(var[,e]of this._protectedPlugins)void 0!==e&&(yield e)}initializePlugins(t){var r=[];for(const[o,s]of this.instancePlugins.entries()){let e=r.find(e=>e instanceof s);void 0===e&&(e=new s(t),r.push(e));var n=a(o,s),i=n.method,i=(this.functions.set(o,[i,e]),n.arraySizeMethod);void 0!==i&&this.arraySizeFunctions.set(o,[i,e])}}getFunctionPlugin(e){if(!s.functionIsProtected(e))return this.instancePlugins.get(e)}getFunction(e){var t=this.functions.get(e);if(void 0!==t&&this.config.translationPackage.isFunctionTranslated(e)){const[r,n]=t;return(e,t)=>n[r](e,t)}}getArraySizeFunction(e){var t=this.arraySizeFunctions.get(e);if(void 0!==t&&this.config.translationPackage.isFunctionTranslated(e)){const[r,n]=t;return(e,t)=>n[r](e,t)}}getMetadata(e){return this.functionsMetadata.get(e)}getPlugins(){var e,t,r=new Set;for([e,t]of this.instancePlugins)s.functionIsProtected(e)||r.add(t);return Array.from(r)}getRegisteredFunctionIds(){return Array.from(this.functions.keys())}categorizeFunction(e,t){t.isVolatile&&this.volatileFunctions.add(e),t.arrayFunction&&this.arrayFunctions.add(e),t.doesNotNeedArgumentsToBeComputed&&this.functionsWhichDoesNotNeedArgumentsToBeComputed.add(e),t.isDependentOnSheetStructureChange&&this.structuralChangeFunctions.add(e),this.functionsMetadata.set(e,t)}}s.plugins=new Map,s._protectedPlugins=new Map([["VERSION",t.VersionPlugin],["OFFSET",void 0]])},(e,t,r)=>{"use strict";r.r(t),r.d(t,{VersionPlugin:()=>o});var n=r(110),t=r(97);const i=new Map([["gpl-v3",1],["missing",2],["invalid",3],["expired",4]]);class o extends t.FunctionPlugin{version(e,t){return this.runFunction(e.args,t,this.metadata("VERSION"),()=>{var{licenseKeyValidityState:e,licenseKey:t}=this.config;let r;return i.has(t)?r=i.get(t):i.has(e)?r=i.get(e):"valid"===e&&(r=t.slice(-5)),`HyperFormula v${n.HyperFormula.version}, `+r})}}o.implementedFunctions={VERSION:{method:"version",parameters:[]}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{Interpreter:()=>n});var d=r(2),h=r(81),v=r(3),b=r(61),p=r(57),w=r(98),u=r(133),f=r(130),g=r(95),m=r(70),C=r(69);class n{constructor(e,t,r,n,i,o,s,a,l,c){this.config=e,this.dependencyGraph=t,this.columnSearch=r,this.stats=n,this.arithmeticHelper=i,this.functionRegistry=o,this.namedExpressions=s,this.serialization=a,this.arraySizePredictor=l,this.dateTimeHelper=c,this.equalOp=(e,t)=>E(this.arithmeticHelper.eq,e,t),this.notEqualOp=(e,t)=>E(this.arithmeticHelper.neq,e,t),this.greaterThanOp=(e,t)=>E(this.arithmeticHelper.gt,e,t),this.lessThanOp=(e,t)=>E(this.arithmeticHelper.lt,e,t),this.greaterThanOrEqualOp=(e,t)=>E(this.arithmeticHelper.geq,e,t),this.lessThanOrEqualOp=(e,t)=>E(this.arithmeticHelper.leq,e,t),this.concatOp=(e,t)=>E(this.arithmeticHelper.concat,(0,w.coerceScalarToString)(e),(0,w.coerceScalarToString)(t)),this.plusOp=(e,t)=>E(this.arithmeticHelper.addWithEpsilon,this.arithmeticHelper.coerceScalarToNumberOrError(e),this.arithmeticHelper.coerceScalarToNumberOrError(t)),this.minusOp=(e,t)=>E(this.arithmeticHelper.subtract,this.arithmeticHelper.coerceScalarToNumberOrError(e),this.arithmeticHelper.coerceScalarToNumberOrError(t)),this.timesOp=(e,t)=>E(this.arithmeticHelper.multiply,this.arithmeticHelper.coerceScalarToNumberOrError(e),this.arithmeticHelper.coerceScalarToNumberOrError(t)),this.powerOp=(e,t)=>E(this.arithmeticHelper.pow,this.arithmeticHelper.coerceScalarToNumberOrError(e),this.arithmeticHelper.coerceScalarToNumberOrError(t)),this.divOp=(e,t)=>E(this.arithmeticHelper.divide,this.arithmeticHelper.coerceScalarToNumberOrError(e),this.arithmeticHelper.coerceScalarToNumberOrError(t)),this.unaryMinusOp=e=>y(this.arithmeticHelper.unaryMinus,this.arithmeticHelper.coerceScalarToNumberOrError(e)),this.percentOp=e=>y(this.arithmeticHelper.unaryPercent,this.arithmeticHelper.coerceScalarToNumberOrError(e)),this.unaryPlusOp=e=>this.arithmeticHelper.unaryPlus(e),this.functionRegistry.initializePlugins(this),this.criterionBuilder=new u.CriterionBuilder(e)}evaluateAst(e,t){let r=this.evaluateAstWithoutPostprocessing(e,t);if((0,m.isExtendedNumber)(r)){if((0,w.isNumberOverflow)((0,m.getRawValue)(r)))return new v.CellError(v.ErrorType.NUM,b.ErrorMessage.NaN);r=(0,m.cloneNumber)(r,(0,w.fixNegativeZero)((0,m.getRawValue)(r)))}r instanceof C.SimpleRangeValue&&1===r.height()&&1===r.width()&&([[r]]=r.data);e=r,t=t.formulaVertex;return e instanceof v.CellError&&void 0!==t?e.attachRootVertex(t):e}evaluateAstWithoutPostprocessing(e,r){switch(e.type){case p.AstNodeType.EMPTY:return m.EmptyValue;case p.AstNodeType.CELL_REFERENCE:var t=e.reference.toSimpleCellAddress(r.formulaAddress);return(0,v.invalidSimpleCellAddress)(t)?new v.CellError(v.ErrorType.REF,b.ErrorMessage.BadRef):this.dependencyGraph.getCellValue(t);case p.AstNodeType.NUMBER:case p.AstNodeType.STRING:return e.value;case p.AstNodeType.CONCATENATE_OP:var t=this.evaluateAst(e.left,r),n=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.concatOp,t,n,r);case p.AstNodeType.EQUALS_OP:t=this.evaluateAst(e.left,r),n=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.equalOp,t,n,r);case p.AstNodeType.NOT_EQUAL_OP:t=this.evaluateAst(e.left,r),n=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.notEqualOp,t,n,r);case p.AstNodeType.GREATER_THAN_OP:t=this.evaluateAst(e.left,r),n=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.greaterThanOp,t,n,r);case p.AstNodeType.LESS_THAN_OP:t=this.evaluateAst(e.left,r),n=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.lessThanOp,t,n,r);case p.AstNodeType.GREATER_THAN_OR_EQUAL_OP:t=this.evaluateAst(e.left,r),n=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.greaterThanOrEqualOp,t,n,r);case p.AstNodeType.LESS_THAN_OR_EQUAL_OP:t=this.evaluateAst(e.left,r),n=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.lessThanOrEqualOp,t,n,r);case p.AstNodeType.PLUS_OP:t=this.evaluateAst(e.left,r),n=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.plusOp,t,n,r);case p.AstNodeType.MINUS_OP:t=this.evaluateAst(e.left,r),n=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.minusOp,t,n,r);case p.AstNodeType.TIMES_OP:t=this.evaluateAst(e.left,r),n=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.timesOp,t,n,r);case p.AstNodeType.POWER_OP:t=this.evaluateAst(e.left,r),n=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.powerOp,t,n,r);case p.AstNodeType.DIV_OP:t=this.evaluateAst(e.left,r),n=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.divOp,t,n,r);case p.AstNodeType.PLUS_UNARY_OP:t=this.evaluateAst(e.value,r);return this.unaryRangeWrapper(this.unaryPlusOp,t,r);case p.AstNodeType.MINUS_UNARY_OP:n=this.evaluateAst(e.value,r);return this.unaryRangeWrapper(this.unaryMinusOp,n,r);case p.AstNodeType.PERCENT_OP:t=this.evaluateAst(e.value,r);return this.unaryRangeWrapper(this.percentOp,t,r);case p.AstNodeType.FUNCTION_CALL:return"valid"===this.config.licenseKeyValidityState||f.FunctionRegistry.functionIsProtected(e.procedureName)?void 0!==(n=this.functionRegistry.getFunction(e.procedureName))?n(e,new g.InterpreterState(r.formulaAddress,r.arraysFlag||this.functionRegistry.isArrayFunction(e.procedureName),r.formulaVertex)):new v.CellError(v.ErrorType.NAME,b.ErrorMessage.FunctionName(e.procedureName)):new v.CellError(v.ErrorType.LIC,b.ErrorMessage.LicenseKey(this.config.licenseKeyValidityState));case p.AstNodeType.NAMED_EXPRESSION:t=this.namedExpressions.nearestNamedExpression(e.expressionName,r.formulaAddress.sheet);return t?this.dependencyGraph.getCellValue(t.address):new v.CellError(v.ErrorType.NAME,b.ErrorMessage.NamedExpressionName(e.expressionName));case p.AstNodeType.CELL_RANGE:if(!this.rangeSpansOneSheet(e))return new v.CellError(v.ErrorType.REF,b.ErrorMessage.RangeManySheets);n=d.AbsoluteCellRange.fromCellRange(e,r.formulaAddress),t=this.dependencyGraph.getArray(n);if(t){t=t.array;if(t instanceof h.NotComputedArray)throw new Error("Array should be already computed");if(t instanceof v.CellError)return t;if(t instanceof h.ArrayValue)return C.SimpleRangeValue.fromRange(t.raw(),n,this.dependencyGraph);throw new Error("Unknown array")}return C.SimpleRangeValue.onlyRange(n,this.dependencyGraph);case p.AstNodeType.COLUMN_RANGE:return this.rangeSpansOneSheet(e)?(t=d.AbsoluteColumnRange.fromColumnRange(e,r.formulaAddress),C.SimpleRangeValue.onlyRange(t,this.dependencyGraph)):new v.CellError(v.ErrorType.REF,b.ErrorMessage.RangeManySheets);case p.AstNodeType.ROW_RANGE:return this.rangeSpansOneSheet(e)?(n=d.AbsoluteRowRange.fromRowRangeAst(e,r.formulaAddress),C.SimpleRangeValue.onlyRange(n,this.dependencyGraph)):new v.CellError(v.ErrorType.REF,b.ErrorMessage.RangeManySheets);case p.AstNodeType.PARENTHESIS:return this.evaluateAst(e.expression,r);case p.AstNodeType.ARRAY:{let t=void 0;var i=[];for(const c of e.args){let e=void 0;var o=[];for(const u of c){var s=(0,w.coerceToRange)(this.evaluateAst(u,r)),a=s.height();if(void 0===e)e=a,o.push(...s.data);else{if(e!==a)return new v.CellError(v.ErrorType.REF,b.ErrorMessage.SizeMismatch);for(let e=0;e<a;e++)o[e].push(...s.data[e])}}var l=o[0].length;if(void 0===t)t=l;else if(t!==l)return new v.CellError(v.ErrorType.REF,b.ErrorMessage.SizeMismatch);i.push(...o)}return C.SimpleRangeValue.onlyValues(i)}case p.AstNodeType.ERROR_WITH_RAW_INPUT:case p.AstNodeType.ERROR:return e.error}}rangeSpansOneSheet(e){return e.start.sheet===e.end.sheet}unaryRangeWrapper(t,e,r){return(e=e instanceof C.SimpleRangeValue&&!r.arraysFlag?null!=(r=(0,w.coerceRangeToScalar)(e,r))?r:new v.CellError(v.ErrorType.VALUE,b.ErrorMessage.ScalarExpected):e)instanceof v.CellError?e:e instanceof C.SimpleRangeValue?(r=e.data.map(e=>e.map(t)),C.SimpleRangeValue.onlyValues(r)):t(e)}binaryRangeWrapper(r,n,i,e){var t;if((n=n instanceof C.SimpleRangeValue&&!e.arraysFlag?null!=(t=(0,w.coerceRangeToScalar)(n,e))?t:new v.CellError(v.ErrorType.VALUE,b.ErrorMessage.ScalarExpected):n)instanceof v.CellError)return n;if((i=i instanceof C.SimpleRangeValue&&!e.arraysFlag?null!=(t=(0,w.coerceRangeToScalar)(i,e))?t:new v.CellError(v.ErrorType.VALUE,b.ErrorMessage.ScalarExpected):i)instanceof v.CellError)return i;if(n instanceof C.SimpleRangeValue||i instanceof C.SimpleRangeValue){if(!(n instanceof C.SimpleRangeValue)){if(i.isAdHoc()){var o=i.data;for(let t=0;t<o.length;t++)for(let e=0;e<o[0].length;e++)o[t][e]=r(n,o[t][e]);return C.SimpleRangeValue.onlyValues(o)}n=C.SimpleRangeValue.fromScalar(n)}if(!(i instanceof C.SimpleRangeValue)){if(n.isAdHoc()){var s=n.data;for(let t=0;t<s.length;t++)for(let e=0;e<s[0].length;e++)s[t][e]=r(s[t][e],i);return C.SimpleRangeValue.onlyValues(s)}i=C.SimpleRangeValue.fromScalar(i)}if(n.width()===i.width()&&n.height()===i.height()){if(n.isAdHoc()){var a=n.data,l=i.data;for(let t=0;t<a.length;t++)for(let e=0;e<a[0].length;e++)a[t][e]=r(a[t][e],l[t][e]);return C.SimpleRangeValue.onlyValues(a)}if(i.isAdHoc()){var c=n.data,u=i.data;for(let t=0;t<c.length;t++)for(let e=0;e<c[0].length;e++)u[t][e]=r(c[t][e],u[t][e]);return C.SimpleRangeValue.onlyValues(u)}}var d=Math.max(n.width(),i.width()),h=Math.max(n.height(),i.height()),p=Array(h);for(let e=0;e<h;e++)p[e]=Array(d);for(let t=0;t<h;t++){var f=1!==n.height()?t:0,g=1!==i.height()?t:0;for(let e=0;e<d;e++){var m=1!==n.width()?e:0,y=1!==i.width()?e:0;f<n.height()&&g<i.height()&&m<n.width()&&y<i.width()?p[t][e]=r(n.data[f][m],i.data[g][y]):p[t][e]=new v.CellError(v.ErrorType.NA)}}return C.SimpleRangeValue.onlyValues(p)}return r(n,i)}}function y(e,t){return t instanceof v.CellError?t:e(t)}function E(e,t,r){return t instanceof v.CellError?t:r instanceof v.CellError?r:e(t,r)}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{CriterionBuilder:()=>n,CriterionType:()=>o,buildCriterion:()=>a,buildCriterionLambda:()=>i});var o,s=r(70);(t=o=o||{}).GREATER_THAN="GREATER_THAN",t.GREATER_THAN_OR_EQUAL="GREATER_THAN_OR_EQUAL",t.LESS_THAN="LESS_THAN",t.LESS_THAN_OR_EQUAL="LESS_THAN_OR_EQUAL",t.NOT_EQUAL="NOT_EQUAL",t.EQUAL="EQUAL";const a=(e,t)=>({operator:e,value:t});class n{constructor(e){var t;this.trueString=null!=(t=null==(t=e.translationPackage.getMaybeFunctionTranslation("TRUE"))?void 0:t.toLowerCase())?t:"true",this.falseString=null!=(e=null==(t=e.translationPackage.getMaybeFunctionTranslation("FALSE"))?void 0:t.toLowerCase())?e:"false"}fromCellValue(e,t){if("string"==typeof e||"boolean"==typeof e||"number"==typeof e){var r=this.parseCriterion(e,t);if(void 0!==r)return{raw:e,lambda:i(r,t)}}}parseCriterion(r,n){if("number"==typeof r||"boolean"==typeof r)return a(o.EQUAL,r);if("string"==typeof r){var i=l.exec(r);let e,t;e=i?(t=function(e){switch(e){case">":return o.GREATER_THAN;case">=":return o.GREATER_THAN_OR_EQUAL;case"<":return o.LESS_THAN;case"<=":return o.LESS_THAN_OR_EQUAL;case"<>":return o.NOT_EQUAL;case"=":return o.EQUAL;default:return}}(i[1]),i[2]):(t=o.EQUAL,r);i=n.coerceToMaybeNumber(e),r=e.toLowerCase()===this.trueString||e.toLowerCase()!==this.falseString&&void 0;if(void 0===t)return;if(""===e)return a(t,null);if(void 0!==i)return a(t,(0,s.getRawValue)(i));if(t===o.EQUAL||t===o.NOT_EQUAL)return a(t,null!=r?r:e)}}}const l=/([<>=]+)(.*)/;const i=(t,r)=>{switch(t.operator){case o.GREATER_THAN:return"number"==typeof t.value?e=>"number"==typeof e&&0<r.floatCmp(e,t.value):e=>!1;case o.GREATER_THAN_OR_EQUAL:return"number"==typeof t.value?e=>"number"==typeof e&&0<=r.floatCmp(e,t.value):e=>!1;case o.LESS_THAN:return"number"==typeof t.value?e=>"number"==typeof e&&r.floatCmp(e,t.value)<0:e=>!1;case o.LESS_THAN_OR_EQUAL:return"number"==typeof t.value?e=>"number"==typeof e&&r.floatCmp(e,t.value)<=0:e=>!1;case o.EQUAL:return"number"==typeof t.value?e=>{return"number"==typeof e?0===r.floatCmp(e,t.value):"string"==typeof e&&""!==e&&void 0!==(e=r.coerceToMaybeNumber(e))&&0===r.floatCmp(e,t.value)}:"string"==typeof t.value?r.eqMatcherFunction(t.value):"boolean"==typeof t.value?e=>"boolean"==typeof e&&e===t.value:e=>e===s.EmptyValue;case o.NOT_EQUAL:return"number"==typeof t.value?e=>{return"number"==typeof e?0!==r.floatCmp(e,t.value):"string"!=typeof e||""===e||void 0===(e=r.coerceToMaybeNumber(e))||0!==r.floatCmp(e,t.value)}:"string"==typeof t.value?r.neqMatcherFunction(t.value):"boolean"==typeof t.value?e=>"boolean"!=typeof e||e!==t.value:e=>e!==s.EmptyValue}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{LazilyTransformingAstService:()=>i});var n=r(135),s=r(72);class i{constructor(e){this.stats=e,this.transformations=[]}version(){return this.transformations.length}addTransformation(e){return void 0!==this.combinedTransformer?this.combinedTransformer.add(e):this.transformations.push(e),this.version()}beginCombinedMode(e){this.combinedTransformer=new n.CombinedTransformer(e)}commitCombinedMode(){if(void 0===this.combinedTransformer)throw Error("Combined mode wasn't started");return this.transformations.push(this.combinedTransformer),this.combinedTransformer=void 0,this.version()}applyTransformations(t,r,n){this.stats.start(s.StatType.TRANSFORM_ASTS_POSTPONED);for(let e=n;e<this.transformations.length;e++){var i=this.transformations[e],[i,o]=(i.isIrreversible()&&(this.undoRedo.storeDataForVersion(e,r,this.parser.computeHashFromAst(t)),this.parser.rememberNewAst(t)),i.transformSingleAst(t,r));t=i,r=o}n=this.parser.rememberNewAst(t);return this.stats.end(s.StatType.TRANSFORM_ASTS_POSTPONED),[n,r,this.transformations.length]}*getTransformationsFrom(t,r){for(let e=t;e<this.transformations.length;e++){var n=this.transformations[e];r&&!r(n)||(yield n)}}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{CombinedTransformer:()=>n});class n{constructor(e){this.sheet=e,this.transformations=[]}add(e){this.transformations.push(e)}performEagerTransformations(t,r){this.transformations.forEach(e=>e.performEagerTransformations(t,r))}transformSingleAst(e,t){let[r,n]=[e,t];return this.transformations.forEach(e=>{[r,n]=e.transformSingleAst(r,n)}),[r,n]}isIrreversible(){return!0}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{buildColumnSearchStrategy:()=>function(e,t,r){return t.useColumnIndex?new i.ColumnIndex(e,t,r):new n.ColumnBinarySearch(e)}});var n=r(137),i=r(140)},(e,t,r)=>{"use strict";r.r(t),r.d(t,{ColumnBinarySearch:()=>n});class n extends r(138).AdvancedFind{constructor(e){super(e),this.dependencyGraph=e}add(e,t){}remove(e,t){}change(e,t,r){}applyChanges(e){}addColumns(e){}removeColumns(e){}removeSheet(e){}moveValues(e,t,r,n){}removeValues(e){}find(e,t,r){return this.basicFind(e,t,"row",r)}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{AdvancedFind:()=>n});var i=r(70),s=r(98),a=r(139);class n{constructor(e){this.dependencyGraph=e}advancedFind(t,e){let r;var n=e.range;r=void 0===n?e.valuesFromTopLeftCorner():this.dependencyGraph.computeListOfValuesInRange(n);for(let e=0;e<r.length;e++)if(t((0,i.getRawValue)(r[e])))return e;return-1}basicFind(e,t,r,{ordering:n,matchExactly:i}){var e="string"==typeof e?(0,s.forceNormalizeString)(e):e,o=t.range;return void 0===o?this.findNormalizedValue(e,t.valuesFromTopLeftCorner()):"none"===n?this.findNormalizedValue(e,this.dependencyGraph.computeListOfValuesInRange(o)):(0,a.findLastOccurrenceInOrderedRange)(e,o,{searchCoordinate:r,orderingDirection:n,matchExactly:i},this.dependencyGraph)}findNormalizedValue(e,t){return t.map(i.getRawValue).map(e=>"string"==typeof e?(0,s.forceNormalizeString)(e):e).indexOf(e)}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{compare:()=>m,findLastMatchingIndex:()=>g,findLastOccurrenceInOrderedArray:()=>function(t,r,e="asc"){e="asc"===e?e=>0<=m(t,r[e]):e=>0<=-m(t,r[e]);return g(e,0,r.length-1)},findLastOccurrenceInOrderedRange:()=>function(t,r,{searchCoordinate:e,orderingDirection:n,matchExactly:i},o){const s=r.start[e],a="col"===e?r.effectiveEndColumn(o):r.effectiveEndRow(o),l="col"===e?e=>(0,p.getRawValue)(o.getCellValue((0,h.simpleCellAddress)(r.sheet,e,r.start.row))):e=>(0,p.getRawValue)(o.getCellValue((0,h.simpleCellAddress)(r.sheet,r.start.col,e))),c="asc"===n?(e,t)=>m(e,t):(e,t)=>-m(e,t),u=g(e=>0<=c(t,l(e)),s,a),d=l(u);if(u===f||typeof d!=typeof t)return f;if(i&&d!==t)return f;return u-s}});var h=r(3),p=r(70);const f=-1;function g(e,t,r){let n=t,i=r;for(;n<i;){var o=Math.ceil((n+i)/2);e(o)?n=o:i=o-1}return n===i&&e(n)?n:f}function m(e,t){return typeof e==typeof t?e===p.EmptyValue?0:e<t?-1:t<e?1:0:e===p.EmptyValue||t!==p.EmptyValue&&(t instanceof h.CellError||"number"==typeof e&&"string"==typeof t||"number"==typeof e&&"boolean"==typeof t||("string"!=typeof e||"number"!=typeof t)&&"string"==typeof e&&"boolean"==typeof t)?-1:1}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{ColumnIndex:()=>d,findInOrderedArray:()=>h});var a=r(3),s=r(119),l=r(123),o=r(98),i=r(70),c=r(69),u=r(72),n=r(137);class d{constructor(e,t,r){this.dependencyGraph=e,this.config=t,this.stats=r,this.index=new Map,this.transformingService=this.dependencyGraph.lazilyTransformingAstService,this.binarySearchStrategy=new n.ColumnBinarySearch(e)}add(e,t){if(!(e===i.EmptyValue||e instanceof a.CellError))if(e instanceof c.SimpleRangeValue)for(var[r,n]of e.entriesFromTopLeftCorner(t))this.addSingleCellValue((0,i.getRawValue)(r),n);else this.addSingleCellValue(e,t)}remove(e,t){if(void 0!==e)if(e instanceof c.SimpleRangeValue)for(var[r,n]of e.entriesFromTopLeftCorner(t))this.removeSingleValue((0,i.getRawValue)(r),n);else this.removeSingleValue(e,t)}change(e,t,r){e!==t&&(this.remove(e,r),this.add(t,r))}applyChanges(e){for(const t of e)void 0!==t.oldValue&&this.change((0,i.getRawValue)(t.oldValue),(0,i.getRawValue)(t.value),t.address)}moveValues(e,t,r,n){for(var[i,o]of e){var s=(0,a.movedSimpleCellAddress)(o,n,t,r);this.remove(i,o),this.add(i,s)}}removeValues(e){for(var[t,r]of e)this.remove(t,r)}find(e,t,{ordering:r,matchExactly:n}){var i=this.findUsingColumnIndex(e,t,!0===n?"findFirst":"findLast");return void 0!==i?i:this.binarySearchStrategy.find(e,t,{ordering:r,matchExactly:n})}findUsingColumnIndex(e,t,r){var n,t=t.range;if(void 0!==t)return this.ensureRecentData(t.sheet,t.start.col,e),(n=this.getColumnMap(t.sheet,t.start.col))?(e="string"==typeof e?(0,o.forceNormalizeString)(e):e,(n=n.get(e))&&n.index&&0!==n.index.length&&void 0!==(e=d.findRowBelongingToRange(n,t,r))?e-t.start.row:void 0):-1}static findRowBelongingToRange(e,t,r){var n=t.start.row,t=t.end.row,r="findFirst"===r?h(n,e.index,"upperBound"):h(t,e.index,"lowerBound");return-1!==r&&n<=(n=e.index[r])&&n<=t?n:void 0}advancedFind(e,t){return this.binarySearchStrategy.advancedFind(e,t)}addColumns(e){var t=this.index.get(e.sheet);t&&t.splice(e.columnStart,0,...Array(e.numberOfColumns))}removeColumns(e){var t=this.index.get(e.sheet);t&&t.splice(e.columnStart,e.numberOfColumns)}removeSheet(e){this.index.delete(e)}getColumnMap(e,t){this.index.has(e)||this.index.set(e,[]);e=this.index.get(e);let r=e[t];return r||(r=new Map,e[t]=r),r}getValueIndex(e,t,r){var n=this.getColumnMap(e,t);let i=this.getColumnMap(e,t).get(r);return i||(i={version:this.transformingService.version(),index:[]},n.set(r,i)),i}ensureRecentData(t,e,r){var n=this.getValueIndex(t,e,r),i=this.transformingService.version();if(n.version!==i){for(const o of this.transformingService.getTransformationsFrom(n.version,e=>e.sheet===t&&(e instanceof s.AddRowsTransformer||e instanceof l.RemoveRowsTransformer)))o instanceof s.AddRowsTransformer?this.addRows(e,o.rowsSpan,r):o instanceof l.RemoveRowsTransformer&&this.removeRows(e,o.rowsSpan,r);n.version=i}}addSingleCellValue(t,r){this.stats.measure(u.StatType.BUILD_COLUMN_INDEX,()=>{this.ensureRecentData(r.sheet,r.col,t),"string"==typeof t&&(t=(0,o.forceNormalizeString)(t));var e=this.getValueIndex(r.sheet,r.col,t);d.addValue(e,r.row)})}removeSingleValue(n,i){this.stats.measure(u.StatType.BUILD_COLUMN_INDEX,()=>{this.ensureRecentData(i.sheet,i.col,n);var e,t=this.getColumnMap(i.sheet,i.col),r=("string"==typeof n&&(n=(0,o.forceNormalizeString)(n)),t.get(n));r&&(-1<(e=h(i.row,r.index))&&r.index.splice(e,1),0===r.index.length&&t.delete(n),0===t.size)&&delete this.index.get(i.sheet)[i.col]})}addRows(e,t,r){e=this.getValueIndex(t.sheet,e,r);d.shiftRows(e,t.rowStart,t.numberOfRows)}removeRows(e,t,r){e=this.getValueIndex(t.sheet,e,r);d.removeRowsFromValues(e,t),d.shiftRows(e,t.rowEnd+1,-t.numberOfRows)}static addValue(e,t){var r=h(t,e.index,"lowerBound");e.index[r]!==t&&e.index.splice(r+1,0,t)}static removeRowsFromValues(e,t){var r=h(t.rowStart,e.index,"upperBound"),n=h(t.rowEnd,e.index,"lowerBound");-1<r&&-1<n&&r<=n&&e.index[r]<=t.rowEnd&&e.index.splice(r,n-r+1)}static shiftRows(t,r,n){r=h(r,t.index,"upperBound");if(-1!==r)for(let e=r;e<t.index.length;++e)t.index[e]+=n}}function h(e,t,r="upperBound"){let n=0,i=t.length-1;for(;n<=i;){var o=Math.floor((n+i)/2);if(e>t[o])n=o+1;else{if(!(e<t[o]))return o;i=o-1}}r="lowerBound"===r?i:n;return 0<=r&&r<=t.length?r:-1}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{NumberLiteralHelper:()=>n});class n{constructor(e){this.config=e;var e="."===this.config.thousandSeparator?"\\"+this.config.thousandSeparator:this.config.thousandSeparator,t="."===this.config.decimalSeparator?"\\"+this.config.decimalSeparator:this.config.decimalSeparator;this.numberPattern=new RegExp(`^([+-]?((${t}\\d+)|(\\d+(${e}\\d{3,})*(${t}\\d*)?)))(e[+-]?\\d+)?$`),this.allThousandSeparatorsRegex=new RegExp(""+e,"g")}numericStringToMaybeNumber(e){if(this.numberPattern.test(e))return e=this.numericStringToNumber(e),isNaN(e)?void 0:e}numericStringToNumber(e){e=e.replace(this.allThousandSeparatorsRegex,"").replace(this.config.decimalSeparator,".");return Number(e)}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{Serialization:()=>o});var l=r(3),i=r(4),n=r(7);class o{constructor(e,t,r){this.dependencyGraph=e,this.unparser=t,this.exporter=r}getCellHyperlink(e){e=this.dependencyGraph.getCell(e);if(e instanceof i.FormulaCellVertex){e=e.getFormula(this.dependencyGraph.lazilyTransformingAstService);if("HYPERLINK"===e.procedureName)return e.hyperlink}}getCellFormula(e,t){var r=this.dependencyGraph.getCell(e);if(r instanceof i.FormulaCellVertex)return n=r.getFormula(this.dependencyGraph.lazilyTransformingAstService),this.unparser.unparse(n,t=null!=t?t:e);if(r instanceof i.ArrayVertex){var n=r.getAddress(this.dependencyGraph.lazilyTransformingAstService);if(n.row!==e.row||n.col!==e.col||n.sheet!==e.sheet)return;t=null!=t?t:e;n=r.getFormula(this.dependencyGraph.lazilyTransformingAstService);if(void 0!==n)return this.unparser.unparse(n,t)}else if(r instanceof i.ParsingErrorVertex)return r.getFormula()}getCellSerialized(e,t){return null!=(t=this.getCellFormula(e,t))?t:this.getRawValue(e)}getCellValue(e){return this.exporter.exportValue(this.dependencyGraph.getScalarValue(e))}getRawValue(e){return this.dependencyGraph.getRawValue(e)}getSheetValues(e){return this.genericSheetGetter(e,e=>this.getCellValue(e))}getSheetFormulas(e){return this.genericSheetGetter(e,e=>this.getCellFormula(e))}genericSheetGetter(r,n){var i=this.dependencyGraph.getSheetHeight(r),o=this.dependencyGraph.getSheetWidth(r),s=new Array(i);for(let t=0;t<i;t++){s[t]=new Array(o);for(let e=0;e<o;e++){var a=(0,l.simpleCellAddress)(r,e,t);s[t][e]=n(a)}for(let e=o-1;0<=e&&(null===s[t][e]||void 0===s[t][e]);e--)s[t].pop()}for(let e=i-1;0<=e&&0===s[e].length;e--)s.pop();return s}genericAllSheetsGetter(e){var t={};for(const n of this.dependencyGraph.sheetMapping.displayNames()){var r=this.dependencyGraph.sheetMapping.fetch(n);t[n]=e(r)}return t}getSheetSerialized(e){return this.genericSheetGetter(e,e=>this.getCellSerialized(e))}getAllSheetsValues(){return this.genericAllSheetsGetter(e=>this.getSheetValues(e))}getAllSheetsFormulas(){return this.genericAllSheetsGetter(e=>this.getSheetFormulas(e))}getAllSheetsSerialized(){return this.genericAllSheetsGetter(e=>this.getSheetSerialized(e))}getAllNamedExpressionsSerialized(){const t=[];let e=0;for(const n of this.dependencyGraph.sheetMapping.displayNames()){var r=this.dependencyGraph.sheetMapping.fetch(n);t[r]=e,e++}return this.dependencyGraph.namedExpressions.getAllNamedExpressions().map(e=>({name:e.expression.displayName,expression:this.getCellSerialized(e.expression.address),scope:void 0!==e.scope?t[e.scope]:void 0,options:e.expression.options}))}withNewConfig(e,t){e=new n.Unparser(e,(0,n.buildLexerConfig)(e),this.dependencyGraph.sheetMapping.fetchDisplayName,t);return new o(this.dependencyGraph,e,this.exporter)}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{objectDestroy:()=>function(e){for(var[t,r]of Object.entries(e))r instanceof Function?e[t]=function(e){return()=>{throw new Error(`The "${e}" method cannot be called because this HyperFormula instance has been destroyed`)}}(r):delete e[t]}})},(e,t,r)=>{"use strict";r.r(t),r.d(t,{Emitter:()=>i,Events:()=>n});var n,t=r(145);(r=n=n||{}).SheetAdded="sheetAdded",r.SheetRemoved="sheetRemoved",r.SheetRenamed="sheetRenamed",r.NamedExpressionAdded="namedExpressionAdded",r.NamedExpressionRemoved="namedExpressionRemoved",r.ValuesUpdated="valuesUpdated",r.EvaluationSuspended="evaluationSuspended",r.EvaluationResumed="evaluationResumed";class i extends t.TinyEmitter{emit(e,...t){return super.emit(e,...t),this}}},e=>{function t(){}t.prototype={on:function(e,t,r){var n=this.e||(this.e={});return(n[e]||(n[e]=[])).push({fn:t,ctx:r}),this},once:function(e,t,r){var n=this;function i(){n.off(e,i),t.apply(r,arguments)}return i._=t,this.on(e,i,r)},emit:function(e){for(var t=[].slice.call(arguments,1),r=((this.e||(this.e={}))[e]||[]).slice(),n=0,i=r.length;n<i;n++)r[n].fn.apply(r[n].ctx,t);return this},off:function(e,t){var r=this.e||(this.e={}),n=r[e],i=[];if(n&&t)for(var o=0,s=n.length;o<s;o++)n[o].fn!==t&&n[o].fn._!==t&&i.push(n[o]);return i.length?r[e]=i:delete r[e],this}},e.exports=t,e.exports.TinyEmitter=t},(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n});const n={errors:{CYCLE:"#CYCLE!",DIV_BY_ZERO:"#DIV/0!",ERROR:"#ERROR!",NA:"#N/A",NAME:"#NAME?",NUM:"#NUM!",REF:"#REF!",SPILL:"#SPILL!",VALUE:"#VALUE!"},functions:{FILTER:"FILTER",ADDRESS:"ADDRESS",ARRAY_CONSTRAIN:"ARRAY_CONSTRAIN",ARRAYFORMULA:"ARRAYFORMULA",ABS:"ABS",ACOS:"ACOS",ACOSH:"ACOSH",ACOT:"ACOT",ACOTH:"ACOTH",AND:"AND",ARABIC:"ARABIC",ASIN:"ASIN",ASINH:"ASINH",ATAN2:"ATAN2",ATAN:"ATAN",ATANH:"ATANH",AVERAGE:"AVERAGE",AVERAGEA:"AVERAGEA",AVERAGEIF:"AVERAGEIF",BASE:"BASE",BIN2DEC:"BIN2DEC",BIN2HEX:"BIN2HEX",BIN2OCT:"BIN2OCT",BITAND:"BITAND",BITLSHIFT:"BITLSHIFT",BITOR:"BITOR",BITRSHIFT:"BITRSHIFT",BITXOR:"BITXOR",CEILING:"CEILING",CHAR:"CHAR",CHOOSE:"CHOOSE",CLEAN:"CLEAN",CODE:"CODE",COLUMN:"COLUMN",COLUMNS:"COLUMNS",CONCATENATE:"CONCATENATE",CORREL:"CORREL",COS:"COS",COSH:"COSH",COT:"COT",COTH:"COTH",COUNT:"COUNT",COUNTA:"COUNTA",COUNTBLANK:"COUNTBLANK",COUNTIF:"COUNTIF",COUNTIFS:"COUNTIFS",COUNTUNIQUE:"COUNTUNIQUE",CSC:"CSC",CSCH:"CSCH",CUMIPMT:"CUMIPMT",CUMPRINC:"CUMPRINC",DATE:"DATE",DATEDIF:"DATEDIF",DATEVALUE:"DATEVALUE",DAY:"DAY",DAYS360:"DAYS360",DAYS:"DAYS",DB:"DB",DDB:"DDB",DEC2BIN:"DEC2BIN",DEC2HEX:"DEC2HEX",DEC2OCT:"DEC2OCT",DECIMAL:"DECIMAL",DEGREES:"DEGREES",DELTA:"DELTA",DOLLARDE:"DOLLARDE",DOLLARFR:"DOLLARFR",EDATE:"EDATE",EFFECT:"EFFECT",EOMONTH:"EOMONTH",ERF:"ERF",ERFC:"ERFC",EVEN:"EVEN",EXACT:"EXACT",EXP:"EXP",FALSE:"FALSE",FIND:"FIND",FORMULATEXT:"FORMULATEXT",FV:"FV",FVSCHEDULE:"FVSCHEDULE",HEX2BIN:"HEX2BIN",HEX2DEC:"HEX2DEC",HEX2OCT:"HEX2OCT",HLOOKUP:"HLOOKUP",HOUR:"HOUR",HYPERLINK:"HYPERLINK",IF:"IF",IFERROR:"IFERROR",IFNA:"IFNA",IFS:"IFS",INDEX:"INDEX",INT:"INT",INTERVAL:"INTERVAL",IPMT:"IPMT",ISBINARY:"ISBINARY",ISBLANK:"ISBLANK",ISERR:"ISERR",ISERROR:"ISERROR",ISEVEN:"ISEVEN",ISFORMULA:"ISFORMULA",ISLOGICAL:"ISLOGICAL",ISNA:"ISNA",ISNONTEXT:"ISNONTEXT",ISNUMBER:"ISNUMBER",ISODD:"ISODD",ISOWEEKNUM:"ISOWEEKNUM",ISPMT:"ISPMT",ISREF:"ISREF",ISTEXT:"ISTEXT",LEFT:"LEFT",LEN:"LEN",LN:"LN",LOG10:"LOG10",LOG:"LOG",LOWER:"LOWER",MATCH:"MATCH",MAX:"MAX",MAXA:"MAXA",MAXIFS:"MAXIFS",MAXPOOL:"MAXPOOL",MEDIAN:"MEDIAN",MEDIANPOOL:"MEDIANPOOL",MID:"MID",MIN:"MIN",MINA:"MINA",MINIFS:"MINIFS",MINUTE:"MINUTE",MIRR:"MIRR",MMULT:"MMULT",MOD:"MOD",MONTH:"MONTH",NA:"NA",NETWORKDAYS:"NETWORKDAYS","NETWORKDAYS.INTL":"NETWORKDAYS.INTL",NOMINAL:"NOMINAL",NOT:"NOT",NOW:"NOW",NPER:"NPER",NPV:"NPV",OCT2BIN:"OCT2BIN",OCT2DEC:"OCT2DEC",OCT2HEX:"OCT2HEX",ODD:"ODD",OFFSET:"OFFSET",OR:"OR",PI:"PI",PMT:"PMT",PDURATION:"PDURATION",PRODUCT:"PRODUCT",POWER:"POWER",PPMT:"PPMT",PROPER:"PROPER",PV:"PV",RADIANS:"RADIANS",RAND:"RAND",RATE:"RATE",REPLACE:"REPLACE",REPT:"REPT",RIGHT:"RIGHT",ROMAN:"ROMAN",ROUND:"ROUND",ROUNDDOWN:"ROUNDDOWN",ROUNDUP:"ROUNDUP",ROW:"ROW",ROWS:"ROWS",RRI:"RRI",SEARCH:"SEARCH",SEC:"SEC",SECH:"SECH",SECOND:"SECOND",SHEET:"SHEET",SHEETS:"SHEETS",SIN:"SIN",SINH:"SINH",SLN:"SLN",SPLIT:"SPLIT",SQRT:"SQRT",STDEVA:"STDEVA","STDEV.P":"STDEV.P",STDEVPA:"STDEVPA","STDEV.S":"STDEV.S",SUBSTITUTE:"SUBSTITUTE",SUBTOTAL:"SUBTOTAL",SUM:"SUM",SUMIF:"SUMIF",SUMIFS:"SUMIFS",SUMPRODUCT:"SUMPRODUCT",SUMSQ:"SUMSQ",SWITCH:"SWITCH",SYD:"SYD",T:"T",TAN:"TAN",TANH:"TANH",TBILLEQ:"TBILLEQ",TBILLPRICE:"TBILLPRICE",TBILLYIELD:"TBILLYIELD",TEXT:"TEXT",TIME:"TIME",TIMEVALUE:"TIMEVALUE",TODAY:"TODAY",TRANSPOSE:"TRANSPOSE",TRIM:"TRIM",TRUE:"TRUE",TRUNC:"TRUNC",UNICHAR:"UNICHAR",UNICODE:"UNICODE",UPPER:"UPPER",VARA:"VARA","VAR.P":"VAR.P",VARPA:"VARPA","VAR.S":"VAR.S",VLOOKUP:"VLOOKUP",WEEKDAY:"WEEKDAY",WEEKNUM:"WEEKNUM",WORKDAY:"WORKDAY","WORKDAY.INTL":"WORKDAY.INTL",XNPV:"XNPV",XOR:"XOR",YEAR:"YEAR",YEARFRAC:"YEARFRAC","HF.ADD":"HF.ADD","HF.CONCAT":"HF.CONCAT","HF.DIVIDE":"HF.DIVIDE","HF.EQ":"HF.EQ","HF.GT":"HF.GT","HF.GTE":"HF.GTE","HF.LT":"HF.LT","HF.LTE":"HF.LTE","HF.MINUS":"HF.MINUS","HF.MULTIPLY":"HF.MULTIPLY","HF.NE":"HF.NE","HF.POW":"HF.POW","HF.UMINUS":"HF.UMINUS","HF.UNARY_PERCENT":"HF.UNARY_PERCENT","HF.UPLUS":"HF.UPLUS",VARP:"VARP",VAR:"VAR",STDEVP:"STDEVP",STDEV:"STDEV","EXPON.DIST":"EXPON.DIST",FISHER:"FISHER",FISHERINV:"FISHERINV",GAMMA:"GAMMA","GAMMA.DIST":"GAMMA.DIST",GAMMALN:"GAMMALN","GAMMALN.PRECISE":"GAMMALN.PRECISE","GAMMA.INV":"GAMMA.INV",GAUSS:"GAUSS",FACT:"FACT",FACTDOUBLE:"FACTDOUBLE",COMBIN:"COMBIN",COMBINA:"COMBINA",GCD:"GCD",LCM:"LCM",MROUND:"MROUND",MULTINOMIAL:"MULTINOMIAL",QUOTIENT:"QUOTIENT",RANDBETWEEN:"RANDBETWEEN",SERIESSUM:"SERIESSUM",SIGN:"SIGN",SQRTPI:"SQRTPI",SUMX2MY2:"SUMX2MY2",SUMX2PY2:"SUMX2PY2",SUMXMY2:"SUMXMY2",EXPONDIST:"EXPONDIST",GAMMADIST:"GAMMADIST",GAMMAINV:"GAMMAINV","BETA.DIST":"BETA.DIST",BETADIST:"BETADIST","BETA.INV":"BETA.INV",BETAINV:"BETAINV","BINOM.DIST":"BINOM.DIST",BINOMDIST:"BINOMDIST","BINOM.INV":"BINOM.INV",BESSELI:"BESSELI",BESSELJ:"BESSELJ",BESSELK:"BESSELK",BESSELY:"BESSELY","CHISQ.DIST":"CHISQ.DIST","CHISQ.DIST.RT":"CHISQ.DIST.RT","CHISQ.INV":"CHISQ.INV","CHISQ.INV.RT":"CHISQ.INV.RT",CHIDIST:"CHIDIST",CHIINV:"CHIINV","F.DIST":"F.DIST","F.DIST.RT":"F.DIST.RT","F.INV":"F.INV","F.INV.RT":"F.INV.RT",FDIST:"FDIST",FINV:"FINV",WEIBULL:"WEIBULL","WEIBULL.DIST":"WEIBULL.DIST",POISSON:"POISSON","POISSON.DIST":"POISSON.DIST","HYPGEOM.DIST":"HYPGEOM.DIST",HYPGEOMDIST:"HYPGEOMDIST","T.DIST":"T.DIST","T.DIST.2T":"T.DIST.2T","T.DIST.RT":"T.DIST.RT","T.INV":"T.INV","T.INV.2T":"T.INV.2T",TDIST:"TDIST",TINV:"TINV",LOGINV:"LOGINV","LOGNORM.DIST":"LOGNORM.DIST","LOGNORM.INV":"LOGNORM.INV",LOGNORMDIST:"LOGNORMDIST","NORM.DIST":"NORM.DIST","NORM.INV":"NORM.INV","NORM.S.DIST":"NORM.S.DIST","NORM.S.INV":"NORM.S.INV",NORMDIST:"NORMDIST",NORMINV:"NORMINV",NORMSDIST:"NORMSDIST",NORMSINV:"NORMSINV",PHI:"PHI","NEGBINOM.DIST":"NEGBINOM.DIST",NEGBINOMDIST:"NEGBINOMDIST",COMPLEX:"COMPLEX",IMABS:"IMABS",IMAGINARY:"IMAGINARY",IMARGUMENT:"IMARGUMENT",IMCONJUGATE:"IMCONJUGATE",IMCOS:"IMCOS",IMCOSH:"IMCOSH",IMCOT:"IMCOT",IMCSC:"IMCSC",IMCSCH:"IMCSCH",IMDIV:"IMDIV",IMEXP:"IMEXP",IMLN:"IMLN",IMLOG10:"IMLOG10",IMLOG2:"IMLOG2",IMPOWER:"IMPOWER",IMPRODUCT:"IMPRODUCT",IMREAL:"IMREAL",IMSEC:"IMSEC",IMSECH:"IMSECH",IMSIN:"IMSIN",IMSINH:"IMSINH",IMSQRT:"IMSQRT",IMSUB:"IMSUB",IMSUM:"IMSUM",IMTAN:"IMTAN",LARGE:"LARGE",SMALL:"SMALL",AVEDEV:"AVEDEV",CONFIDENCE:"CONFIDENCE","CONFIDENCE.NORM":"CONFIDENCE.NORM","CONFIDENCE.T":"CONFIDENCE.T",DEVSQ:"DEVSQ",GEOMEAN:"GEOMEAN",HARMEAN:"HARMEAN",CRITBINOM:"CRITBINOM","COVARIANCE.P":"COVARIANCE.P","COVARIANCE.S":"COVARIANCE.S",COVAR:"COVAR",PEARSON:"PEARSON",RSQ:"RSQ",STANDARDIZE:"STANDARDIZE","Z.TEST":"Z.TEST",ZTEST:"ZTEST","F.TEST":"F.TEST",FTEST:"FTEST",STEYX:"STEYX",SLOPE:"SLOPE","CHISQ.TEST":"CHISQ.TEST",CHITEST:"CHITEST","T.TEST":"T.TEST",TTEST:"TTEST",SKEW:"SKEW","SKEW.P":"SKEW.P",WEIBULLDIST:"WEIBULLDIST",VARS:"VARS",TINV2T:"TINV2T",TDISTRT:"TDISTRT",TDIST2T:"TDIST2T",STDEVS:"STDEVS",FINVRT:"FINVRT",FDISTRT:"FDISTRT",CHIDISTRT:"CHIDISTRT",CHIINVRT:"CHIINVRT",COVARIANCEP:"COVARIANCEP",COVARIANCES:"COVARIANCES",LOGNORMINV:"LOGNORMINV",POISSONDIST:"POISSONDIST",SKEWP:"SKEWP","CEILING.MATH":"CEILING.MATH",FLOOR:"FLOOR","FLOOR.MATH":"FLOOR.MATH","CEILING.PRECISE":"CEILING.PRECISE","FLOOR.PRECISE":"FLOOR.PRECISE","ISO.CEILING":"ISO.CEILING"},langCode:"enGB",ui:{NEW_SHEET_PREFIX:"Sheet"}}},(L,e,t)=>{"use strict";t.r(e),t.d(e,{AbsPlugin:()=>i.AbsPlugin,AddressPlugin:()=>r.AddressPlugin,ArrayPlugin:()=>n.ArrayPlugin,BitShiftPlugin:()=>o.BitShiftPlugin,BitwiseLogicOperationsPlugin:()=>s.BitwiseLogicOperationsPlugin,BooleanPlugin:()=>a.BooleanPlugin,CharPlugin:()=>l.CharPlugin,CodePlugin:()=>c.CodePlugin,ComplexPlugin:()=>j.ComplexPlugin,ConditionalAggregationPlugin:()=>D.ConditionalAggregationPlugin,CountBlankPlugin:()=>u.CountBlankPlugin,CountUniquePlugin:()=>d.CountUniquePlugin,DateTimePlugin:()=>h.DateTimePlugin,DegreesPlugin:()=>p.DegreesPlugin,DeltaPlugin:()=>f.DeltaPlugin,ExpPlugin:()=>g.ExpPlugin,FinancialPlugin:()=>m.FinancialPlugin,FormulaTextPlugin:()=>y.FormulaTextPlugin,HyperlinkPlugin:()=>v.HyperlinkPlugin,InformationPlugin:()=>b.InformationPlugin,IsEvenPlugin:()=>w.IsEvenPlugin,IsOddPlugin:()=>C.IsOddPlugin,LogarithmPlugin:()=>E.LogarithmPlugin,LookupPlugin:()=>U.LookupPlugin,MathConstantsPlugin:()=>T.MathConstantsPlugin,MathPlugin:()=>B.MathPlugin,MatrixPlugin:()=>S.MatrixPlugin,MedianPlugin:()=>_.MedianPlugin,ModuloPlugin:()=>x.ModuloPlugin,NumericAggregationPlugin:()=>R.NumericAggregationPlugin,PowerPlugin:()=>A.PowerPlugin,RadiansPlugin:()=>N.RadiansPlugin,RadixConversionPlugin:()=>O.RadixConversionPlugin,RandomPlugin:()=>I.RandomPlugin,RomanPlugin:()=>V.RomanPlugin,RoundingPlugin:()=>M.RoundingPlugin,SimpleArithmerticPlugin:()=>W.SimpleArithmerticPlugin,SqrtPlugin:()=>k.SqrtPlugin,StatisticalAggregationPlugin:()=>z.StatisticalAggregationPlugin,StatisticalPlugin:()=>$.StatisticalPlugin,SumprodPlugin:()=>P.SumprodPlugin,TextPlugin:()=>F.TextPlugin,TrigonometryPlugin:()=>H.TrigonometryPlugin});var r=t(148),n=t(149),i=t(150),o=t(151),s=t(152),a=t(153),l=t(154),c=t(155),u=t(156),d=t(157),h=t(158),p=t(159),f=t(160),g=t(161),m=t(162),y=t(163),v=t(164),b=t(165),w=t(166),C=t(167),E=t(168),T=t(169),S=t(170),_=t(171),x=t(172),R=t(173),A=t(174),N=t(175),O=t(176),I=t(177),M=t(178),k=t(179),D=t(180),P=t(183),F=t(184),H=t(185),U=t(186),V=t(188),W=t(189),$=t(190),B=t(193),j=t(194),z=t(195)},(e,t,r)=>{"use strict";r.r(t),r.d(t,{AddressPlugin:()=>n});var l,c=r(8),t=r(97),i=r(3),o=r(61);(r=l=l||{})[r.FullyAbsolute=1]="FullyAbsolute",r[r.RowAbsoluteColRelative=2]="RowAbsoluteColRelative",r[r.RowRelativeColAbsolute=3]="RowRelativeColAbsolute",r[r.FullyRelative=4]="FullyRelative";class n extends t.FunctionPlugin{verifyAddressArguments(e,t,r,n){if(n){if(e<1||t<1)return new i.CellError(i.ErrorType.VALUE,o.ErrorMessage.LessThanOne)}else if(l.FullyAbsolute==r){if(e<1||t<1)return new i.CellError(i.ErrorType.VALUE,o.ErrorMessage.LessThanOne)}else if(l.RowAbsoluteColRelative==r){if(e<1)return new i.CellError(i.ErrorType.VALUE,o.ErrorMessage.LessThanOne)}else if(l.RowRelativeColAbsolute==r&&t<1)return new i.CellError(i.ErrorType.VALUE,o.ErrorMessage.LessThanOne)}address(e,t){return this.runFunction(e.args,t,this.metadata("ADDRESS"),(e,t,r,n,i)=>{var o=this.verifyAddressArguments(e,t,r,n);if(void 0!==o)return o;o=(0,c.columnIndexToLabel)(t-1);let s="";null!=i&&(s=i+"!");var i=0==t?"C":`C[${t}]`,a=0==e?"R":`R[${e}]`;return l.FullyRelative==r?n?""+s+o+e:s+a+i:l.RowRelativeColAbsolute==r?n?s+"$"+o+e:s+a+"C"+t:l.RowAbsoluteColRelative==r?n?""+s+o+"$"+e:s+"R"+e+i:n?s+`$${o}$`+e:s+`R${e}C`+t})}}n.implementedFunctions={ADDRESS:{method:"address",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,optionalArg:!0,defaultValue:1,minValue:1,maxValue:4},{argumentType:t.FunctionArgumentType.BOOLEAN,optionalArg:!0,defaultValue:!0},{argumentType:t.FunctionArgumentType.STRING,optionalArg:!0}]}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{ArrayPlugin:()=>n});var o=r(1),a=r(3),l=r(61),s=r(7),c=r(98),u=r(95),d=r(69),t=r(97);class n extends t.FunctionPlugin{arrayformula(e,t){return this.runFunction(e.args,t,this.metadata("ARRAYFORMULA"),e=>e)}arrayformulaArraySize(e,t){if(1!==e.args.length)return o.ArraySize.error();const r=this.metadata("ARRAYFORMULA");return e.args.map(e=>{return this.arraySizeForAst(e,new u.InterpreterState(t.formulaAddress,t.arraysFlag||null!=(e=null===r||void 0===r?void 0:r.arrayFunction)&&e))})[0]}arrayconstrain(e,t){return this.runFunction(e.args,t,this.metadata("ARRAY_CONSTRAIN"),(e,t,r)=>{t=Math.min(t,e.height()),r=Math.min(r,e.width());var n=e.data,i=[];for(let e=0;e<t;e++)i.push(n[e].slice(0,r));return d.SimpleRangeValue.onlyValues(i)})}arrayconstrainArraySize(e,t){if(3!==e.args.length)return o.ArraySize.error();const r=this.metadata("ARRAY_CONSTRAIN");let{height:n,width:i}=e.args.map(e=>{return this.arraySizeForAst(e,new u.InterpreterState(t.formulaAddress,t.arraysFlag||null!=(e=null===r||void 0===r?void 0:r.arrayFunction)&&e))})[0];return e.args[1].type===s.AstNodeType.NUMBER&&(n=Math.min(n,e.args[1].value)),e.args[2].type===s.AstNodeType.NUMBER&&(i=Math.min(i,e.args[2].value)),n<1||i<1||!Number.isInteger(n)||!Number.isInteger(i)?o.ArraySize.error():new o.ArraySize(i,n)}filter(e,t){return this.runFunction(e.args,t,this.metadata("FILTER"),(e,...n)=>{for(const r of n)if(e.width()!==r.width()||e.height()!==r.height())return new a.CellError(a.ErrorType.NA,l.ErrorMessage.EqualLength);if(1<e.width()&&1<e.height())return new a.CellError(a.ErrorType.NA,l.ErrorMessage.WrongDimension);var i=e.data,t=[];for(let r=0;r<e.height();r++){var o=[];for(let t=0;t<e.width();t++){let e=!0;for(const s of n)if(!0!==(0,c.coerceScalarToBoolean)(s.data[r][t])){e=!1;break}e&&o.push(i[r][t])}0<o.length&&t.push(o)}return 0<t.length?d.SimpleRangeValue.onlyValues(t):new a.CellError(a.ErrorType.NA,l.ErrorMessage.EmptyRange)})}filterArraySize(e,t){if(e.args.length<=1)return o.ArraySize.error();const r=this.metadata("FILTER");var e=e.args.map(e=>{return this.arraySizeForAst(e,new u.InterpreterState(t.formulaAddress,t.arraysFlag||null!=(e=null===r||void 0===r?void 0:r.arrayFunction)&&e))}),n=Math.max(...e.map(e=>e.width)),e=Math.max(...e.map(e=>e.height));return new o.ArraySize(n,e)}}n.implementedFunctions={ARRAYFORMULA:{method:"arrayformula",arraySizeMethod:"arrayformulaArraySize",arrayFunction:!0,parameters:[{argumentType:t.FunctionArgumentType.ANY}]},ARRAY_CONSTRAIN:{method:"arrayconstrain",arraySizeMethod:"arrayconstrainArraySize",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.INTEGER,minValue:1},{argumentType:t.FunctionArgumentType.INTEGER,minValue:1}],vectorizationForbidden:!0},FILTER:{method:"filter",arraySizeMethod:"filterArraySize",arrayFunction:!0,parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.RANGE}],repeatLastArgs:1}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{AbsPlugin:()=>n});t=r(97);class n extends t.FunctionPlugin{abs(e,t){return this.runFunction(e.args,t,this.metadata("ABS"),Math.abs)}}n.implementedFunctions={ABS:{method:"abs",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{BitShiftPlugin:()=>s});var n=r(3),i=r(61),t=r(97);const o=0xffffffffffff;class s extends t.FunctionPlugin{bitlshift(e,t){return this.runFunction(e.args,t,this.metadata("BITLSHIFT"),a)}bitrshift(e,t){return this.runFunction(e.args,t,this.metadata("BITRSHIFT"),l)}}function a(e,t){return t<0?l(e,-t):c(e*Math.pow(2,t))}function l(e,t){return t<0?a(e,-t):c(Math.floor(e/Math.pow(2,t)))}function c(e){return e>o?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.BitshiftLong):e}s.implementedFunctions={BITLSHIFT:{method:"bitlshift",parameters:[{argumentType:t.FunctionArgumentType.INTEGER,minValue:0},{argumentType:t.FunctionArgumentType.INTEGER,minValue:-53,maxValue:53}]},BITRSHIFT:{method:"bitrshift",parameters:[{argumentType:t.FunctionArgumentType.INTEGER,minValue:0},{argumentType:t.FunctionArgumentType.INTEGER,minValue:-53,maxValue:53}]}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{BitwiseLogicOperationsPlugin:()=>n});t=r(97);class n extends t.FunctionPlugin{bitand(e,t){return this.runFunction(e.args,t,this.metadata("BITAND"),(e,t)=>e&t)}bitor(e,t){return this.runFunction(e.args,t,this.metadata("BITOR"),(e,t)=>e|t)}bitxor(e,t){return this.runFunction(e.args,t,this.metadata("BITXOR"),(e,t)=>e^t)}}n.implementedFunctions={BITAND:{method:"bitand",parameters:[{argumentType:t.FunctionArgumentType.INTEGER,minValue:0},{argumentType:t.FunctionArgumentType.INTEGER,minValue:0}]},BITOR:{method:"bitor",parameters:[{argumentType:t.FunctionArgumentType.INTEGER,minValue:0},{argumentType:t.FunctionArgumentType.INTEGER,minValue:0}]},BITXOR:{method:"bitxor",parameters:[{argumentType:t.FunctionArgumentType.INTEGER,minValue:0},{argumentType:t.FunctionArgumentType.INTEGER,minValue:0}]}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{BooleanPlugin:()=>n});var i=r(3),o=r(61),t=r(97);class n extends t.FunctionPlugin{literalTrue(e,t){return this.runFunction(e.args,t,this.metadata("TRUE"),()=>!0)}literalFalse(e,t){return this.runFunction(e.args,t,this.metadata("FALSE"),()=>!1)}conditionalIf(e,t){return this.runFunction(e.args,t,this.metadata("IF"),(e,t,r)=>e?t:r)}ifs(e,t){return this.runFunction(e.args,t,this.metadata("IFS"),(...t)=>{for(let e=0;e<t.length;e+=2)if(t[e])return t[e+1];return new i.CellError(i.ErrorType.NA,o.ErrorMessage.NoConditionMet)})}and(e,t){return this.runFunction(e.args,t,this.metadata("AND"),(...e)=>e.filter(e=>void 0!==e).every(e=>!!e))}or(e,t){return this.runFunction(e.args,t,this.metadata("OR"),(...e)=>e.filter(e=>void 0!==e).some(e=>e))}not(e,t){return this.runFunction(e.args,t,this.metadata("NOT"),e=>!e)}xor(e,t){return this.runFunction(e.args,t,this.metadata("XOR"),(...e)=>{let t=0;return e.filter(e=>void 0!==e).forEach(e=>{e&&t++}),t%2==1})}switch(e,t){return this.runFunction(e.args,t,this.metadata("SWITCH"),(e,...t)=>{var r=t.length;let n=0;for(;n+1<r;n+=2)if(!(t[n]instanceof i.CellError)&&this.arithmeticHelper.eq(e,t[n]))return t[n+1];return n<r?t[n]:new i.CellError(i.ErrorType.NA,o.ErrorMessage.NoDefault)})}iferror(e,t){return this.runFunction(e.args,t,this.metadata("IFERROR"),(e,t)=>e instanceof i.CellError?t:e)}ifna(e,t){return this.runFunction(e.args,t,this.metadata("IFNA"),(e,t)=>e instanceof i.CellError&&e.type===i.ErrorType.NA?t:e)}choose(e,t){return this.runFunction(e.args,t,this.metadata("CHOOSE"),(e,...t)=>e>t.length?new i.CellError(i.ErrorType.NUM,o.ErrorMessage.Selector):t[e-1])}}n.implementedFunctions={TRUE:{method:"literalTrue",parameters:[]},FALSE:{method:"literalFalse",parameters:[]},IF:{method:"conditionalIf",parameters:[{argumentType:t.FunctionArgumentType.BOOLEAN},{argumentType:t.FunctionArgumentType.SCALAR,passSubtype:!0},{argumentType:t.FunctionArgumentType.SCALAR,defaultValue:!1,passSubtype:!0}]},IFS:{method:"ifs",parameters:[{argumentType:t.FunctionArgumentType.BOOLEAN},{argumentType:t.FunctionArgumentType.SCALAR,passSubtype:!0}],repeatLastArgs:2},AND:{method:"and",parameters:[{argumentType:t.FunctionArgumentType.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},OR:{method:"or",parameters:[{argumentType:t.FunctionArgumentType.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},XOR:{method:"xor",parameters:[{argumentType:t.FunctionArgumentType.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},NOT:{method:"not",parameters:[{argumentType:t.FunctionArgumentType.BOOLEAN}]},SWITCH:{method:"switch",parameters:[{argumentType:t.FunctionArgumentType.NOERROR},{argumentType:t.FunctionArgumentType.SCALAR,passSubtype:!0},{argumentType:t.FunctionArgumentType.SCALAR,passSubtype:!0}],repeatLastArgs:1},IFERROR:{method:"iferror",parameters:[{argumentType:t.FunctionArgumentType.SCALAR,passSubtype:!0},{argumentType:t.FunctionArgumentType.SCALAR,passSubtype:!0}]},IFNA:{method:"ifna",parameters:[{argumentType:t.FunctionArgumentType.SCALAR,passSubtype:!0},{argumentType:t.FunctionArgumentType.SCALAR,passSubtype:!0}]},CHOOSE:{method:"choose",parameters:[{argumentType:t.FunctionArgumentType.INTEGER,minValue:1},{argumentType:t.FunctionArgumentType.SCALAR,passSubtype:!0}],repeatLastArgs:1}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{CharPlugin:()=>o});var n=r(3),i=r(61),t=r(97);class o extends t.FunctionPlugin{char(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),e=>e<1||256<=e?new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.CharacterCodeBounds):String.fromCharCode(Math.trunc(e)))}unichar(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),e=>e<1||1114112<=e?new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.CharacterCodeBounds):String.fromCodePoint(Math.trunc(e)))}}o.implementedFunctions={CHAR:{method:"char",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},UNICHAR:{method:"unichar",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{CodePlugin:()=>o});var n=r(3),i=r(61),t=r(97);class o extends t.FunctionPlugin{code(e,t){return this.runFunction(e.args,t,this.metadata("CODE"),e=>0===e.length?new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.EmptyString):e.charCodeAt(0))}unicode(e,t){return this.runFunction(e.args,t,this.metadata("UNICODE"),e=>{return null!=(e=e.codePointAt(0))?e:new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.EmptyString)})}}o.implementedFunctions={CODE:{method:"code",parameters:[{argumentType:t.FunctionArgumentType.STRING}]},UNICODE:{method:"unicode",parameters:[{argumentType:t.FunctionArgumentType.STRING}]}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{CountBlankPlugin:()=>i});var n=r(70),t=r(97);class i extends t.FunctionPlugin{countblank(e,t){return this.runFunction(e.args,t,this.metadata("COUNTBLANK"),(...e)=>{let t=0;return e.forEach(e=>{e===n.EmptyValue&&t++}),t})}}i.implementedFunctions={COUNTBLANK:{method:"countblank",parameters:[{argumentType:t.FunctionArgumentType.SCALAR}],repeatLastArgs:1,expandRanges:!0}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{CountUniquePlugin:()=>n});var i=r(3),t=r(97);class n extends t.FunctionPlugin{countunique(e,t){return this.runFunction(e.args,t,this.metadata("COUNTUNIQUE"),(...e)=>{var t=new Set,r=new Set;for(const n of e)n instanceof i.CellError?r.add(n.type):""!==n&&t.add(n);return t.size+r.size})}}n.implementedFunctions={COUNTUNIQUE:{method:"countunique",parameters:[{argumentType:t.FunctionArgumentType.SCALAR}],repeatLastArgs:1,expandRanges:!0}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{DateTimePlugin:()=>i});var l=r(3),o=r(104),a=r(61),n=r(106),s=r(70),t=r(97);class i extends t.FunctionPlugin{constructor(){super(...arguments),this.isoweeknumCore=e=>{var t=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e)),r=this.dateTimeHelper.numberToSimpleDate(e),r=this.dateTimeHelper.dateToNumber({year:r.year,month:1,day:1}),r=this.dateTimeHelper.relativeNumberToAbsoluteNumber(r),r=r+((4-r)%7+7)%7,t=Math.floor((t-1)/7)-Math.floor((r-1)/7)+1;return 0==t?this.isoweeknumCore(e-7)+1:t},this.days360Core=(e,t,r)=>{e=this.dateTimeHelper.numberToSimpleDate(e),t=this.dateTimeHelper.numberToSimpleDate(t);let n,i;return r?(n=(0,o.toBasisEU)(e),i=(0,o.toBasisEU)(t)):[n,i]=this.dateTimeHelper.toBasisUS(e,t),360*(i.year-n.year)+30*(i.month-n.month)+i.day-n.day}}date(e,t){return this.runFunction(e.args,t,this.metadata("DATE"),(e,t,r)=>{r=Math.trunc(r),t=Math.trunc(t);let n=Math.trunc(e);n<this.dateTimeHelper.getEpochYearZero()&&(n+=this.dateTimeHelper.getEpochYearZero());e=Math.floor((t-1)/12),t-=12*e,e={year:n+=e,month:t,day:1};return this.dateTimeHelper.isValidDate(e)?(t=this.dateTimeHelper.dateToNumber(e)+(r-1),void 0===(t=this.dateTimeHelper.getWithinBounds(t))?new l.CellError(l.ErrorType.NUM,a.ErrorMessage.DateBounds):t):new l.CellError(l.ErrorType.VALUE,a.ErrorMessage.InvalidDate)})}time(e,t){return this.runFunction(e.args,t,this.metadata("TIME"),(e,t,r)=>{e=(0,o.timeToNumber)({hours:Math.trunc(e),minutes:Math.trunc(t),seconds:Math.trunc(r)});return e<0?new l.CellError(l.ErrorType.NUM,a.ErrorMessage.NegativeTime):e%1})}eomonth(e,t){return this.runFunction(e.args,t,this.metadata("EOMONTH"),(e,t)=>{e=this.dateTimeHelper.numberToSimpleDate(e),e=this.dateTimeHelper.dateToNumber(this.dateTimeHelper.endOfMonth((0,o.offsetMonth)(e,t)));return void 0===(e=this.dateTimeHelper.getWithinBounds(e))?new l.CellError(l.ErrorType.NUM,a.ErrorMessage.DateBounds):e})}day(e,t){return this.runFunction(e.args,t,this.metadata("DAY"),e=>this.dateTimeHelper.numberToSimpleDate(e).day)}days(e,t){return this.runFunction(e.args,t,this.metadata("DAYS"),(e,t)=>Math.trunc(e)-Math.trunc(t))}month(e,t){return this.runFunction(e.args,t,this.metadata("MONTH"),e=>this.dateTimeHelper.numberToSimpleDate(e).month)}year(e,t){return this.runFunction(e.args,t,this.metadata("YEAR"),e=>this.dateTimeHelper.numberToSimpleDate(e).year)}hour(e,t){return this.runFunction(e.args,t,this.metadata("HOUR"),e=>(0,o.numberToSimpleTime)((0,o.roundToNearestSecond)(e)%1).hours)}minute(e,t){return this.runFunction(e.args,t,this.metadata("MINUTE"),e=>(0,o.numberToSimpleTime)((0,o.roundToNearestSecond)(e)%1).minutes)}second(e,t){return this.runFunction(e.args,t,this.metadata("SECOND"),e=>(0,o.numberToSimpleTime)((0,o.roundToNearestSecond)(e)%1).seconds)}text(e,t){return this.runFunction(e.args,t,this.metadata("TEXT"),(e,t)=>(0,n.format)(e,t,this.config,this.dateTimeHelper))}weekday(e,t){return this.runFunction(e.args,t,this.metadata("WEEKDAY"),(e,t)=>{e=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e));return 3===t?(e-1)%7:void 0===(t=d.get(t))?new l.CellError(l.ErrorType.NUM,a.ErrorMessage.BadMode):(e-t)%7+1})}weeknum(e,t){return this.runFunction(e.args,t,this.metadata("WEEKNUM"),(e,t)=>{var r=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e)),n=this.dateTimeHelper.numberToSimpleDate(e),n=this.dateTimeHelper.dateToNumber({year:n.year,month:1,day:1}),n=this.dateTimeHelper.relativeNumberToAbsoluteNumber(n);return 21===t?this.isoweeknumCore(e):void 0===(e=d.get(t))?new l.CellError(l.ErrorType.NUM,a.ErrorMessage.BadMode):Math.floor((r-e)/7)-Math.floor((n-e)/7)+1})}isoweeknum(e,t){return this.runFunction(e.args,t,this.metadata("ISOWEEKNUM"),this.isoweeknumCore)}datevalue(e,t){return this.runFunction(e.args,t,this.metadata("DATEVALUE"),e=>{e=this.dateTimeHelper.parseDateTimeFromConfigFormats(e).dateTime;return void 0===e?new l.CellError(l.ErrorType.VALUE,a.ErrorMessage.IncorrectDateTime):(0,o.instanceOfSimpleDate)(e)?((0,o.instanceOfSimpleTime)(e)?Math.trunc((0,o.timeToNumber)(e)):0)+this.dateTimeHelper.dateToNumber(e):0})}timevalue(e,t){return this.runFunction(e.args,t,this.metadata("TIMEVALUE"),e=>{e=this.dateTimeHelper.dateStringToDateNumber(e);return void 0===e?new l.CellError(l.ErrorType.VALUE,a.ErrorMessage.IncorrectDateTime):(0,s.getRawValue)(e)%1})}now(e,t){return this.runFunction(e.args,t,this.metadata("NOW"),()=>{var e=new Date(Date.now());return(0,o.timeToNumber)({hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()})+this.dateTimeHelper.dateToNumber({year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate()})})}today(e,t){return this.runFunction(e.args,t,this.metadata("TODAY"),()=>{var e=new Date(Date.now());return this.dateTimeHelper.dateToNumber({year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate()})})}edate(e,t){return this.runFunction(e.args,t,this.metadata("EDATE"),(e,t)=>{e=this.dateTimeHelper.numberToSimpleDate(e),e=(0,o.truncateDayInMonth)((0,o.offsetMonth)(e,t)),t=this.dateTimeHelper.dateToNumber(e);return void 0===(t=this.dateTimeHelper.getWithinBounds(t))?new l.CellError(l.ErrorType.NUM,a.ErrorMessage.DateBounds):t})}datedif(e,t){return this.runFunction(e.args,t,this.metadata("DATEDIF"),(e,t,r)=>{if(t<e)return new l.CellError(l.ErrorType.NUM,a.ErrorMessage.StartEndDate);if("D"===r)return Math.floor(t)-Math.floor(e);var n,i,o=this.dateTimeHelper.numberToSimpleDate(e),s=this.dateTimeHelper.numberToSimpleDate(t);switch(r){case"M":return 12*(s.year-o.year)+(s.month-o.month)-(s.day<o.day?1:0);case"YM":return(s.month-o.month+12-(s.day<o.day?1:0))%12;case"Y":return s.month>o.month||s.month===o.month&&s.day>=o.day?s.year-o.year:s.year-o.year-1;case"MD":return s.day>=o.day?s.day-o.day:(n=1===s.month?12:s.month-1,i=1===s.month?s.year-1:s.year,this.dateTimeHelper.daysInMonth(i,n)+s.day-o.day);case"YD":return s.month>o.month||s.month===o.month&&s.day>=o.day?Math.floor(t)-this.dateTimeHelper.dateToNumber({year:s.year,month:o.month,day:o.day}):Math.floor(t)-Math.floor(e)-365*(s.year-o.year-1)-this.dateTimeHelper.leapYearsCount(s.year-1)+this.dateTimeHelper.leapYearsCount(o.year);default:return new l.CellError(l.ErrorType.NUM,a.ErrorMessage.BadMode)}})}days360(e,t){return this.runFunction(e.args,t,this.metadata("DAYS360"),this.days360Core)}yearfrac(e,t){return this.runFunction(e.args,t,this.metadata("YEARFRAC"),(e,t,r)=>{switch(e=Math.trunc(e),(t=Math.trunc(t))<e&&([e,t]=[t,e]),r){case 0:return this.days360Core(e,t,!1)/360;case 1:return(t-e)/this.dateTimeHelper.yearLengthForBasis(this.dateTimeHelper.numberToSimpleDate(e),this.dateTimeHelper.numberToSimpleDate(t));case 2:return(t-e)/360;case 3:return(t-e)/365;case 4:return this.days360Core(e,t,!0)/360}throw new Error("Should not be reachable.")})}interval(e,t){return this.runFunction(e.args,t,this.metadata("INTERVAL"),e=>{var t=(e=Math.trunc(e))%60,r=(e=Math.trunc(e/60))%60,n=(e=Math.trunc(e/60))%24,i=(e=Math.trunc(e/24))%30,o=(e=Math.trunc(e/30))%12,e=Math.trunc(e/12);return"P"+(0<e?e+"Y":"")+(0<o?o+"M":"")+(0<i?i+"D":"")+"T"+(0<n?n+"H":"")+(0<r?r+"M":"")+(0<t?t+"S":"")})}networkdays(e,t){return this.runFunction(e.args,t,this.metadata("NETWORKDAYS"),(e,t,r)=>this.networkdayscore(e,t,1,r))}networkdaysintl(e,t){return this.runFunction(e.args,t,this.metadata("NETWORKDAYS.INTL"),(e,t,r,n)=>this.networkdayscore(e,t,r,n))}workday(e,t){return this.runFunction(e.args,t,this.metadata("WORKDAY"),(e,t,r)=>this.workdaycore(e,t,1,r))}workdayintl(e,t){return this.runFunction(e.args,t,this.metadata("WORKDAY.INTL"),(e,t,r,n)=>this.workdaycore(e,t,r,n))}networkdayscore(e,t,r,n){e=Math.trunc(e);let i=1;(t=Math.trunc(t))<e&&([e,t]=[t,e],i=-1);r=u(r);return r instanceof l.CellError?r:(n=this.simpleRangeToFilteredHolidays(r,n))instanceof l.CellError?n:i*this.countWorkdays(e,t,r,n)}workdaycore(r,n,e,t){r=Math.trunc(r),n=Math.trunc(n);var i=u(e);if(i instanceof l.CellError)return i;var o=this.simpleRangeToFilteredHolidays(i,t);if(o instanceof l.CellError)return o;if(0<n){let e=1;for(;this.countWorkdays(r+1,r+e,i,o)<n;)e*=2;let t=1;for(;t+1<e;){var s=Math.trunc((t+e)/2);this.countWorkdays(r+1,r+s,i,o)<n?t=s:e=s}return r+e}if(n<0){n*=-1;let e=1;for(;this.countWorkdays(r-e,r-1,i,o)<n;)e*=2;let t=1;for(;t+1<e;){var a=Math.trunc((t+e)/2);this.countWorkdays(r-a,r-1,i,o)<n?t=a:e=a}return r-e}return r}countWorkdays(e,t,r,n){var i=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(t)),o=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e));let s=0;for(let e=0;e<7;e++)"0"===r.charAt(e)&&(s=(s+=Math.floor((i+6-e)/7))-Math.floor((o-1+6-e)/7));return s-=c(t+1,n)-c(e,n)}simpleRangeToFilteredHolidays(t,e){e=null!=(e=null==e?void 0:e.valuesFromTopLeftCorner())?e:[];for(const n of e)if(n instanceof l.CellError)return n;var r=[];for(const i of e)if(i!==s.EmptyValue){if(!(0,s.isExtendedNumber)(i))return new l.CellError(l.ErrorType.VALUE,a.ErrorMessage.WrongType);r.push(Math.trunc((0,s.getRawValue)(i)))}return[...new Set(r)].sort((e,t)=>e-t).filter(e=>{e=this.dateTimeHelper.relativeNumberToAbsoluteNumber(e);return"0"===t.charAt((e-1)%7)})}}function c(e,t){if(0===t.length)return 0;if(e<=t[0])return 0;if(t[t.length-1]<e)return t.length;let r=0,n=t.length-1;for(;r+1<n;){var i=Math.floor((n+r)/2);t[i]>=e?n=i:r=i}return n}function u(e){return"number"!=typeof e&&"string"!=typeof e?new l.CellError(l.ErrorType.VALUE,a.ErrorMessage.WrongType):"string"==typeof e?7===e.length&&/^(0|1)*$/.test(e)&&"1111111"!==e?e:new l.CellError(l.ErrorType.NUM,a.ErrorMessage.WeekendString):null!=(e=h.get(e))?e:new l.CellError(l.ErrorType.NUM,a.ErrorMessage.BadMode)}i.implementedFunctions={DATE:{method:"date",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER}],returnNumberType:s.NumberType.NUMBER_DATE},TIME:{method:"time",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER}],returnNumberType:s.NumberType.NUMBER_TIME},MONTH:{method:"month",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0}]},YEAR:{method:"year",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0}]},HOUR:{method:"hour",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0}]},MINUTE:{method:"minute",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0}]},SECOND:{method:"second",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0}]},TEXT:{method:"text",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.STRING}]},EOMONTH:{method:"eomonth",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER}],returnNumberType:s.NumberType.NUMBER_DATE},DAY:{method:"day",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0}]},DAYS:{method:"days",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0}]},WEEKDAY:{method:"weekday",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:1}]},WEEKNUM:{method:"weeknum",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:1}]},ISOWEEKNUM:{method:"isoweeknum",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0}]},DATEVALUE:{method:"datevalue",parameters:[{argumentType:t.FunctionArgumentType.STRING}],returnNumberType:s.NumberType.NUMBER_DATE},TIMEVALUE:{method:"timevalue",parameters:[{argumentType:t.FunctionArgumentType.STRING}],returnNumberType:s.NumberType.NUMBER_TIME},NOW:{method:"now",parameters:[],isVolatile:!0,returnNumberType:s.NumberType.NUMBER_DATETIME},TODAY:{method:"today",parameters:[],isVolatile:!0,returnNumberType:s.NumberType.NUMBER_DATE},EDATE:{method:"edate",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER}],returnNumberType:s.NumberType.NUMBER_DATE},DAYS360:{method:"days360",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.BOOLEAN,defaultValue:!1}]},DATEDIF:{method:"datedif",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.STRING}]},YEARFRAC:{method:"yearfrac",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.INTEGER,defaultValue:0,minValue:0,maxValue:4}]},INTERVAL:{method:"interval",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0}]},NETWORKDAYS:{method:"networkdays",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.RANGE,optionalArg:!0}]},"NETWORKDAYS.INTL":{method:"networkdaysintl",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NOERROR,defaultValue:1},{argumentType:t.FunctionArgumentType.RANGE,optionalArg:!0}]},WORKDAY:{method:"workday",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.RANGE,optionalArg:!0}]},"WORKDAY.INTL":{method:"workdayintl",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NOERROR,defaultValue:1},{argumentType:t.FunctionArgumentType.RANGE,optionalArg:!0}]}};const d=new Map([[1,0],[2,1],[11,1],[12,2],[13,3],[14,4],[15,5],[16,6],[17,0]]),h=new Map([[1,"0000011"],[2,"1000001"],[3,"1100000"],[4,"0110000"],[5,"0011000"],[6,"0001100"],[7,"0000110"],[11,"0000001"],[12,"1000000"],[13,"0100000"],[14,"0010000"],[15,"0001000"],[16,"0000100"],[17,"0000010"]])},(e,t,r)=>{"use strict";r.r(t),r.d(t,{DegreesPlugin:()=>n});t=r(97);class n extends t.FunctionPlugin{degrees(e,t){return this.runFunction(e.args,t,this.metadata("DEGREES"),e=>e*(180/Math.PI))}}n.implementedFunctions={DEGREES:{method:"degrees",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{DeltaPlugin:()=>n});t=r(97);class n extends t.FunctionPlugin{delta(e,t){return this.runFunction(e.args,t,this.metadata("DELTA"),(e,t)=>e===t?1:0)}}n.implementedFunctions={DELTA:{method:"delta",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0}]}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{ExpPlugin:()=>n});t=r(97);class n extends t.FunctionPlugin{exp(e,t){return this.runFunction(e.args,t,this.metadata("EXP"),Math.exp)}}n.implementedFunctions={EXP:{method:"exp",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{FinancialPlugin:()=>n});var u=r(3),c=r(61),i=r(70),t=r(97);class n extends t.FunctionPlugin{pmt(e,t){return this.runFunction(e.args,t,this.metadata("PMT"),s)}ipmt(e,t){return this.runFunction(e.args,t,this.metadata("IPMT"),l)}ppmt(e,t){return this.runFunction(e.args,t,this.metadata("PPMT"),d)}fv(e,t){return this.runFunction(e.args,t,this.metadata("FV"),a)}cumipmt(e,t){return this.runFunction(e.args,t,this.metadata("CUMIPMT"),(t,r,n,i,o,s)=>{if(o<i)return new u.CellError(u.ErrorType.NUM,c.ErrorMessage.EndStartPeriod);let a=0;for(let e=i;e<=o;e++)a+=l(t,e,r,n,0,s);return a})}cumprinc(e,t){return this.runFunction(e.args,t,this.metadata("CUMPRINC"),(t,r,n,i,o,s)=>{if(o<i)return new u.CellError(u.ErrorType.NUM,c.ErrorMessage.EndStartPeriod);let a=0;for(let e=i;e<=o;e++)a+=d(t,e,r,n,0,s);return a})}db(e,t){return this.runFunction(e.args,t,this.metadata("DB"),(t,e,r,n,i)=>{if(12===i&&r<n||r+1<n)return new u.CellError(u.ErrorType.NUM,c.ErrorMessage.PeriodLong);if(t<=e)return 0;var o=Math.round(1e3*(1-Math.pow(e/t,1/r)))/1e3,e=t*o*i/12;if(1===n)return e;let s=e;for(let e=0;e<n-2;e++)s+=(t-s)*o;return n===r+1?(t-s)*o*(12-i)/12:(t-s)*o})}ddb(e,t){return this.runFunction(e.args,t,this.metadata("DDB"),(e,t,r,n,i)=>{if(r<n)return new u.CellError(u.ErrorType.NUM);let o=i/r,s;s=1<=o?(o=1)===n?e:0:e*Math.pow(1-o,n-1);i=e*Math.pow(1-o,n);return Math.max(s-Math.max(t,i),0)})}dollarde(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARDE"),(e,t)=>{if(t<1)return new u.CellError(u.ErrorType.DIV_BY_ZERO);for(t=Math.trunc(t);10<t;)t/=10;return Math.trunc(e)+10*(e-Math.trunc(e))/t})}dollarfr(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARFR"),(e,t)=>{if(t<1)return new u.CellError(u.ErrorType.DIV_BY_ZERO);for(t=Math.trunc(t);10<t;)t/=10;return Math.trunc(e)+(e-Math.trunc(e))*t/10})}effect(e,t){return this.runFunction(e.args,t,this.metadata("EFFECT"),(e,t)=>(t=Math.trunc(t),Math.pow(1+e/t,t)-1))}ispmt(e,t){return this.runFunction(e.args,t,this.metadata("ISPMT"),(e,t,r,n)=>0===r?new u.CellError(u.ErrorType.DIV_BY_ZERO):n*e*(t/r-1))}nominal(e,t){return this.runFunction(e.args,t,this.metadata("NOMINAL"),(e,t)=>(t=Math.trunc(t),(Math.pow(e+1,1/t)-1)*t))}nper(e,t){return this.runFunction(e.args,t,this.metadata("NPER"),(e,t,r,n,i)=>0===e?0===t?new u.CellError(u.ErrorType.DIV_BY_ZERO):(-r-n)/t:(i&&(t*=1+e),Math.log((t-n*e)/(r*e+t))/Math.log(1+e)))}rate(e,t){return this.runFunction(e.args,t,this.metadata("RATE"),(r,n,i,o,s,e)=>{if(e<=-1)return new u.CellError(u.ErrorType.VALUE);var a,l;let c=e;s=s?1:0;for(let e=0;e<50;e++){if(c<=-1)return new u.CellError(u.ErrorType.NUM);let e;if(e=Math.abs(c)<1e-7?i*(1+r*c)+n*(1+c*s)*r+o:i*(a=Math.pow(1+c,r))+n*(1/c+s)*(a-1)+o,Math.abs(e)<1e-7)return c;let t;t=Math.abs(c)<1e-7?i*r+n*s*r:(a=Math.pow(1+c,r),i*(l=r*Math.pow(1+c,r-1))+n*(1/c+s)*l+n*(-1/(c*c))*(a-1)),c-=e/t}return new u.CellError(u.ErrorType.NUM)})}pv(e,t){return this.runFunction(e.args,t,this.metadata("PV"),(e,t,r,n,i)=>(i=i?1:0,-1===e?0===t?new u.CellError(u.ErrorType.NUM):new u.CellError(u.ErrorType.DIV_BY_ZERO):0===e?-r*t-n:((1-Math.pow(1+e,t))*r*(1+e*i)/e-n)/Math.pow(1+e,t)))}rri(e,t){return this.runFunction(e.args,t,this.metadata("RRI"),(e,t,r)=>0===t||r<0&&0<t||0<r&&t<0?new u.CellError(u.ErrorType.NUM):Math.pow(r/t,1/e)-1)}sln(e,t){return this.runFunction(e.args,t,this.metadata("SLN"),(e,t,r)=>0===r?new u.CellError(u.ErrorType.DIV_BY_ZERO):(e-t)/r)}syd(e,t){return this.runFunction(e.args,t,this.metadata("SYD"),(e,t,r,n)=>r<n?new u.CellError(u.ErrorType.NUM):(e-t)*(r-n+1)*2/(r*(r+1)))}tbilleq(e,t){return this.runFunction(e.args,t,this.metadata("TBILLEQ"),(e,t,r)=>{var n,i;return e=Math.round(e),(t=Math.round(t))<=e||(n=this.dateTimeHelper.numberToSimpleDate(e),(i=this.dateTimeHelper.numberToSimpleDate(t)).year>n.year+1)||i.year===n.year+1&&(i.month>n.month||i.month===n.month&&i.day>n.day)?new u.CellError(u.ErrorType.NUM):0==(i=360-r*(t-e))?0:i<0?new u.CellError(u.ErrorType.NUM):365*r/i})}tbillprice(e,t){return this.runFunction(e.args,t,this.metadata("TBILLPRICE"),(e,t,r)=>{var n,i;return e=Math.round(e),(t=Math.round(t))<=e||(n=this.dateTimeHelper.numberToSimpleDate(e),(i=this.dateTimeHelper.numberToSimpleDate(t)).year>n.year+1)||i.year===n.year+1&&(i.month>n.month||i.month===n.month&&i.day>n.day)?new u.CellError(u.ErrorType.NUM):0==(i=360-r*(t-e))?0:i<0?new u.CellError(u.ErrorType.NUM):100*(1-r*(t-e)/360)})}tbillyield(e,t){return this.runFunction(e.args,t,this.metadata("TBILLYIELD"),(e,t,r)=>{var n,i;return e=Math.round(e),(t=Math.round(t))<=e||(n=this.dateTimeHelper.numberToSimpleDate(e),(i=this.dateTimeHelper.numberToSimpleDate(t)).year>n.year+1)||i.year===n.year+1&&(i.month>n.month||i.month===n.month&&i.day>n.day)?new u.CellError(u.ErrorType.NUM):360*(100-r)/(r*(t-e))})}fvschedule(e,t){return this.runFunction(e.args,t,this.metadata("FVSCHEDULE"),(e,t)=>{t=t.valuesFromTopLeftCorner();for(const r of t)if(r instanceof u.CellError)return r;for(const n of t)if((0,i.isExtendedNumber)(n))e*=1+(0,i.getRawValue)(n);else if(n!==i.EmptyValue)return new u.CellError(u.ErrorType.VALUE,c.ErrorMessage.NumberExpected);return e})}npv(e,t){return this.runFunction(e.args,t,this.metadata("NPV"),(e,...t)=>{t=this.arithmeticHelper.coerceNumbersExactRanges(t);return t instanceof u.CellError?t:h(e,t)})}mirr(e,t){return this.runFunction(e.args,t,this.metadata("MIRR"),(e,t,r)=>{e=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());if(e instanceof u.CellError)return e;let n=!1,i=!1;var o,s,a=[],l=[];for(const c of e)(0<c?(n=!0,a.push(c),l):(c<0?(i=!0,l.push(c)):l.push(0),a)).push(0);return n&&i?(e=e.length,(o=h(r,a))instanceof u.CellError?o:(s=h(t,l))instanceof u.CellError?s:Math.pow(-o*Math.pow(1+r,e)/s/(1+t),1/(e-1))-1):new u.CellError(u.ErrorType.DIV_BY_ZERO)})}pduration(e,t){return this.runFunction(e.args,t,this.metadata("PDURATION"),(e,t,r)=>(Math.log(r)-Math.log(t))/Math.log(1+e))}xnpv(e,t){return this.runFunction(e.args,t,this.metadata("XNPV"),(t,e,r)=>{e=e.valuesFromTopLeftCorner();for(const a of e)if("number"!=typeof a)return new u.CellError(u.ErrorType.VALUE,c.ErrorMessage.NumberExpected);var n=e,e=r.valuesFromTopLeftCorner();for(const l of e)if("number"!=typeof l)return new u.CellError(u.ErrorType.VALUE,c.ErrorMessage.NumberExpected);var i=e;if(i.length!==n.length)return new u.CellError(u.ErrorType.NUM,c.ErrorMessage.EqualLength);var o=i.length;let s=0;if(i[0]<0)return new u.CellError(u.ErrorType.NUM,c.ErrorMessage.ValueSmall);for(let e=0;e<o;e++){if(i[e]=Math.floor(i[e]),i[e]<i[0])return new u.CellError(u.ErrorType.NUM,c.ErrorMessage.ValueSmall);s+=n[e]/Math.pow(1+t,(i[e]-i[0])/365)}return s})}}function s(e,t,r,n,i){return 0===e?(-r-n)/t:(n*e+r*e*(n=Math.pow(1+e,t)))*(i?1/(1+e):1)/(1-n)}function l(e,t,r,n,i,o){r=s(e,r,n,i,o);return 1===t?e*(o?0:-n):e*(o?a(e,t-2,r,n,o)-r:a(e,t-1,r,n,o))}function a(e,t,r,n,i){return 0===e?-n-r*t:r*(i?1+e:1)*(1-(r=Math.pow(1+e,t)))/e-n*r}function d(e,t,r,n,i,o){return s(e,r,n,i,o)-l(e,t,r,n,i,o)}function h(t,r){let n=0;for(let e=r.length-1;0<=e;e--){if(n+=r[e],-1===t){if(0===n)continue;return new u.CellError(u.ErrorType.DIV_BY_ZERO)}n/=1+t}return n}n.implementedFunctions={PMT:{method:"pmt",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0}],returnNumberType:i.NumberType.NUMBER_CURRENCY},IPMT:{method:"ipmt",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0}],returnNumberType:i.NumberType.NUMBER_CURRENCY},PPMT:{method:"ppmt",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0}],returnNumberType:i.NumberType.NUMBER_CURRENCY},FV:{method:"fv",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0}],returnNumberType:i.NumberType.NUMBER_CURRENCY},CUMIPMT:{method:"cumipmt",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.INTEGER,minValue:1},{argumentType:t.FunctionArgumentType.INTEGER,minValue:1},{argumentType:t.FunctionArgumentType.INTEGER,minValue:0,maxValue:1}],returnNumberType:i.NumberType.NUMBER_CURRENCY},CUMPRINC:{method:"cumprinc",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.INTEGER,minValue:1},{argumentType:t.FunctionArgumentType.INTEGER,minValue:1},{argumentType:t.FunctionArgumentType.INTEGER,minValue:0,maxValue:1}],returnNumberType:i.NumberType.NUMBER_CURRENCY},DB:{method:"db",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.INTEGER,minValue:0},{argumentType:t.FunctionArgumentType.INTEGER,minValue:0},{argumentType:t.FunctionArgumentType.INTEGER,minValue:1,maxValue:12,defaultValue:12}],returnNumberType:i.NumberType.NUMBER_CURRENCY},DDB:{method:"ddb",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.INTEGER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0,defaultValue:2}],returnNumberType:i.NumberType.NUMBER_CURRENCY},DOLLARDE:{method:"dollarde",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0}]},DOLLARFR:{method:"dollarfr",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0}]},EFFECT:{method:"effect",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1}],returnNumberType:i.NumberType.NUMBER_PERCENT},ISPMT:{method:"ispmt",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER}]},NOMINAL:{method:"nominal",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1}],returnNumberType:i.NumberType.NUMBER_PERCENT},NPER:{method:"nper",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0}]},PV:{method:"pv",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0}],returnNumberType:i.NumberType.NUMBER_CURRENCY},RATE:{method:"rate",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:.1}],returnNumberType:i.NumberType.NUMBER_PERCENT},RRI:{method:"rri",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER}],returnNumberType:i.NumberType.NUMBER_PERCENT},SLN:{method:"sln",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER}],returnNumberType:i.NumberType.NUMBER_CURRENCY},SYD:{method:"syd",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0}],returnNumberType:i.NumberType.NUMBER_CURRENCY},TBILLEQ:{method:"tbilleq",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0}],returnNumberType:i.NumberType.NUMBER_PERCENT},TBILLPRICE:{method:"tbillprice",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0}],returnNumberType:i.NumberType.NUMBER_CURRENCY},TBILLYIELD:{method:"tbillyield",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0}],returnNumberType:i.NumberType.NUMBER_PERCENT},FVSCHEDULE:{method:"fvschedule",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.RANGE}],returnNumberType:i.NumberType.NUMBER_CURRENCY},NPV:{method:"npv",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.ANY}],repeatLastArgs:1,returnNumberType:i.NumberType.NUMBER_CURRENCY},MIRR:{method:"mirr",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER}],returnNumberType:i.NumberType.NUMBER_PERCENT},PDURATION:{method:"pduration",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0}]},XNPV:{method:"xnpv",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:-1},{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.RANGE}]}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{FormulaTextPlugin:()=>o});var n=r(3),i=r(61),t=r(96),r=r(97);class o extends t.FunctionPlugin{formulatext(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("FORMULATEXT"),()=>new n.CellError(n.ErrorType.NA,i.ErrorMessage.WrongArgNumber),e=>{return null!=(e=this.serialization.getCellFormula(e))?e:new n.CellError(n.ErrorType.NA,i.ErrorMessage.Formula)})}}o.implementedFunctions={FORMULATEXT:{method:"formulatext",parameters:[{argumentType:r.FunctionArgumentType.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,isDependentOnSheetStructureChange:!0,vectorizationForbidden:!0}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{HyperlinkPlugin:()=>n});t=r(97);class n extends t.FunctionPlugin{hyperlink(r,e){return this.runFunction(r.args,e,this.metadata("HYPERLINK"),(e,t)=>(r.hyperlink=e,null!=t?t:e))}}n.implementedFunctions={HYPERLINK:{method:"hyperlink",parameters:[{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.STRING,optionalArg:!0}]}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{InformationPlugin:()=>c});var i=r(3),n=r(80),o=r(61),s=r(7),a=r(70),l=r(69),t=r(97);class c extends t.FunctionPlugin{isbinary(e,t){return this.runFunction(e.args,t,this.metadata("ISBINARY"),e=>/^[01]{1,10}$/.test(e))}iserr(e,t){return this.runFunction(e.args,t,this.metadata("ISERR"),e=>e instanceof i.CellError&&e.type!==i.ErrorType.NA)}iserror(e,t){return this.runFunction(e.args,t,this.metadata("ISERROR"),e=>e instanceof i.CellError)}isformula(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ISFORMULA"),()=>new i.CellError(i.ErrorType.NA,o.ErrorMessage.WrongArgNumber),e=>{return this.dependencyGraph.addressMapping.getCell(e)instanceof n.FormulaVertex})}isblank(e,t){return this.runFunction(e.args,t,this.metadata("ISBLANK"),e=>e===a.EmptyValue)}isna(e,t){return this.runFunction(e.args,t,this.metadata("ISNA"),e=>e instanceof i.CellError&&e.type==i.ErrorType.NA)}isnumber(e,t){return this.runFunction(e.args,t,this.metadata("ISNUMBER"),a.isExtendedNumber)}islogical(e,t){return this.runFunction(e.args,t,this.metadata("ISLOGICAL"),e=>"boolean"==typeof e)}isref(e,t){return this.runFunction(e.args,t,this.metadata("ISREF"),e=>e instanceof i.CellError&&(e.type==i.ErrorType.REF||e.type==i.ErrorType.CYCLE))}istext(e,t){return this.runFunction(e.args,t,this.metadata("ISTEXT"),e=>"string"==typeof e)}isnontext(e,t){return this.runFunction(e.args,t,this.metadata("ISNONTEXT"),e=>!("string"==typeof e))}column(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("COLUMN"),()=>t.formulaAddress.col+1,e=>e.col+1)}columns(e,t){if(1!==e.args.length)return new i.CellError(i.ErrorType.NA,o.ErrorMessage.WrongArgNumber);if(e.args.some(e=>e.type===s.AstNodeType.EMPTY))return new i.CellError(i.ErrorType.NUM,o.ErrorMessage.EmptyArg);let r=e.args[0];for(;r.type===s.AstNodeType.PARENTHESIS;)r=r.expression;return r.type===s.AstNodeType.CELL_RANGE||r.type===s.AstNodeType.COLUMN_RANGE?r.end.col-r.start.col+1:r.type===s.AstNodeType.CELL_REFERENCE?1:r.type===s.AstNodeType.ROW_RANGE?this.config.maxColumns:(e=this.evaluateAst(r,t))instanceof l.SimpleRangeValue?e.width():e instanceof i.CellError?e:1}row(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ROW"),()=>t.formulaAddress.row+1,e=>e.row+1)}rows(e,t){if(1!==e.args.length)return new i.CellError(i.ErrorType.NA,o.ErrorMessage.WrongArgNumber);if(e.args.some(e=>e.type===s.AstNodeType.EMPTY))return new i.CellError(i.ErrorType.NUM,o.ErrorMessage.EmptyArg);let r=e.args[0];for(;r.type===s.AstNodeType.PARENTHESIS;)r=r.expression;return r.type===s.AstNodeType.CELL_RANGE||r.type===s.AstNodeType.ROW_RANGE?r.end.row-r.start.row+1:r.type===s.AstNodeType.CELL_REFERENCE?1:r.type===s.AstNodeType.COLUMN_RANGE?this.config.maxRows:(e=this.evaluateAst(r,t))instanceof l.SimpleRangeValue?e.height():e instanceof i.CellError?e:1}index(e,t){return this.runFunction(e.args,t,this.metadata("INDEX"),(e,t,r)=>{var n;return r<1||t<1?new i.CellError(i.ErrorType.VALUE,o.ErrorMessage.LessThanOne):r>e.width()||t>e.height()?new i.CellError(i.ErrorType.NUM,o.ErrorMessage.ValueLarge):null!=(t=null!=(t=null==(n=null==(n=null==e?void 0:e.data)?void 0:n[t-1])?void 0:n[r-1])?t:null==(r=null==(n=null==e?void 0:e.data)?void 0:n[0])?void 0:r[0])?t:new i.CellError(i.ErrorType.VALUE,o.ErrorMessage.CellRangeExpected)})}na(e,t){return new i.CellError(i.ErrorType.NA)}sheet(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("SHEET"),()=>t.formulaAddress.sheet+1,e=>e.sheet+1,e=>{e=this.dependencyGraph.sheetMapping.get(e);return void 0!==e?e+1:new i.CellError(i.ErrorType.NA,o.ErrorMessage.SheetRef)})}sheets(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("SHEETS"),()=>this.dependencyGraph.sheetMapping.numberOfSheets(),()=>1,()=>new i.CellError(i.ErrorType.VALUE,o.ErrorMessage.CellRefExpected))}}c.implementedFunctions={COLUMN:{method:"column",parameters:[{argumentType:t.FunctionArgumentType.NOERROR,optionalArg:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},COLUMNS:{method:"columns",parameters:[{argumentType:t.FunctionArgumentType.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISBINARY:{method:"isbinary",parameters:[{argumentType:t.FunctionArgumentType.STRING}]},ISERR:{method:"iserr",parameters:[{argumentType:t.FunctionArgumentType.SCALAR}]},ISFORMULA:{method:"isformula",parameters:[{argumentType:t.FunctionArgumentType.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISNA:{method:"isna",parameters:[{argumentType:t.FunctionArgumentType.SCALAR}]},ISREF:{method:"isref",parameters:[{argumentType:t.FunctionArgumentType.SCALAR}],vectorizationForbidden:!0},ISERROR:{method:"iserror",parameters:[{argumentType:t.FunctionArgumentType.SCALAR}]},ISBLANK:{method:"isblank",parameters:[{argumentType:t.FunctionArgumentType.SCALAR}]},ISNUMBER:{method:"isnumber",parameters:[{argumentType:t.FunctionArgumentType.SCALAR}]},ISLOGICAL:{method:"islogical",parameters:[{argumentType:t.FunctionArgumentType.SCALAR}]},ISTEXT:{method:"istext",parameters:[{argumentType:t.FunctionArgumentType.SCALAR}]},ISNONTEXT:{method:"isnontext",parameters:[{argumentType:t.FunctionArgumentType.SCALAR}]},INDEX:{method:"index",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:1}]},NA:{method:"na",parameters:[]},ROW:{method:"row",parameters:[{argumentType:t.FunctionArgumentType.NOERROR,optionalArg:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ROWS:{method:"rows",parameters:[{argumentType:t.FunctionArgumentType.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEET:{method:"sheet",parameters:[{argumentType:t.FunctionArgumentType.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEETS:{method:"sheets",parameters:[{argumentType:t.FunctionArgumentType.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{IsEvenPlugin:()=>n});t=r(97);class n extends t.FunctionPlugin{iseven(e,t){return this.runFunction(e.args,t,this.metadata("ISEVEN"),e=>e%2==0)}}n.implementedFunctions={ISEVEN:{method:"iseven",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{IsOddPlugin:()=>n});t=r(97);class n extends t.FunctionPlugin{isodd(e,t){return this.runFunction(e.args,t,this.metadata("ISODD"),e=>e%2==1)}}n.implementedFunctions={ISODD:{method:"isodd",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{LogarithmPlugin:()=>n});t=r(97);class n extends t.FunctionPlugin{log10(e,t){return this.runFunction(e.args,t,this.metadata("LOG10"),Math.log10)}log(e,t){return this.runFunction(e.args,t,this.metadata("LOG"),(e,t)=>Math.log(e)/Math.log(t))}ln(e,t){return this.runFunction(e.args,t,this.metadata("LN"),Math.log)}}n.implementedFunctions={LOG10:{method:"log10",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},LOG:{method:"log",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:10,greaterThan:0}]},LN:{method:"ln",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{MathConstantsPlugin:()=>i,PI:()=>n});t=r(97);const n=parseFloat(Math.PI.toFixed(14));class i extends t.FunctionPlugin{pi(e,t){return this.runFunction(e.args,t,this.metadata("PI"),()=>n)}sqrtpi(e,t){return this.runFunction(e.args,t,this.metadata("SQRTPI"),e=>Math.sqrt(n*e))}}i.implementedFunctions={PI:{method:"pi",parameters:[]},SQRTPI:{method:"sqrtpi",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0}]}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{MatrixPlugin:()=>n});var a=r(1),i=r(3),o=r(61),l=r(7),c=r(95),s=r(69),t=r(97);function u(e,t){return new a.ArraySize(t.width,e.height)}function d(e,t,r){return new a.ArraySize(1+(e.width-t)/r,1+(e.height-t)/r)}class n extends t.FunctionPlugin{mmult(e,t){return this.runFunction(e.args,t,this.metadata("MMULT"),(e,t)=>{var r;return e.hasOnlyNumbers()&&t.hasOnlyNumbers()?t.height()!==e.width()?new i.CellError(i.ErrorType.VALUE,o.ErrorMessage.ArrayDimensions):(r=u(e.size,t.size),r=this.createKernel(function(t,r,n){let i=0;for(let e=0;e<n;++e)i+=t[this.thread.y][e]*r[e][this.thread.x];return i},r)(e.rawNumbers(),t.rawNumbers(),e.width()),s.SimpleRangeValue.onlyNumbers(r)):new i.CellError(i.ErrorType.VALUE,o.ErrorMessage.NumberRange)})}mmultArraySize(e,t){if(2!==e.args.length)return a.ArraySize.error();const r=this.metadata("MMULT");var[e,n]=e.args.map(e=>{return this.arraySizeForAst(e,new c.InterpreterState(t.formulaAddress,t.arraysFlag||null!=(e=null===r||void 0===r?void 0:r.arrayFunction)&&e))});return u(e,n)}maxpool(e,t){return this.runFunction(e.args,t,this.metadata("MAXPOOL"),(e,t,r=t)=>{var n;return e.hasOnlyNumbers()?(n=d(e.size,t,r),n=this.createKernel(function(r,n,e){var i=this.thread.x*e,o=this.thread.y*e;let s=r[o][i];for(let t=0;t<n;t++)for(let e=0;e<n;e++)s=Math.max(s,r[o+t][i+e]);return s},n)(e.rawNumbers(),t,r),s.SimpleRangeValue.onlyNumbers(n)):new i.CellError(i.ErrorType.VALUE,o.ErrorMessage.NumberRange)})}medianpool(e,t){return this.runFunction(e.args,t,this.metadata("MEDIANPOOL"),(e,t,r=t)=>{var n;return e.hasOnlyNumbers()?(n=d(e.size,t,r),n=this.createKernel(function(n,i,e){var o=this.thread.x*e,s=this.thread.y*e;let r=n[s][o];for(let t=0;t<i;t++)for(let e=0;e<i;e++)r=Math.max(r,n[s+t][o+e]);let a=n[s][o];for(let t=0;t<i;t++)for(let e=0;e<i;e++)a=Math.min(a,n[s+t][o+e]);var t=i*i;let l=a,c=r,u=42;for(let e=0;e<32;e++){var d=(l+c)/2;let r=0;for(let t=0;t<i;t++)for(let e=0;e<i;e++)n[s+t][o+e]>d&&r++;if(i%2==0){if(r===t/2){u=d;break}r>t/2?l=d:c=d}else{if(r===(t-1)/2){u=d;break}r>(t-1)/2?l=d:c=d}}return u},n)(e.rawNumbers(),t,r),s.SimpleRangeValue.onlyNumbers(n)):new i.CellError(i.ErrorType.VALUE,o.ErrorMessage.NumberRange)})}maxpoolArraySize(e,t){if(e.args.length<2||3<e.args.length)return a.ArraySize.error();const r=this.metadata("MAXPOOL");var n=e.args.map(e=>{return this.arraySizeForAst(e,new c.InterpreterState(t.formulaAddress,t.arraysFlag||null!=(e=null===r||void 0===r?void 0:r.arrayFunction)&&e))})[0],i=e.args[1];let o,s=o=i.type===l.AstNodeType.NUMBER?i.value:1;return 3===e.args.length&&(i=e.args[2],s=i.type===l.AstNodeType.NUMBER?i.value:1),o>n.width||o>n.height||s>o||(n.width-o)%s!=0||(n.height-o)%s!=0?a.ArraySize.error():d(n,o,s)}medianpoolArraySize(e,t){return this.maxpoolArraySize(e,t)}transpose(e,t){return this.runFunction(e.args,t,this.metadata("TRANSPOSE"),e=>{var r=e.rawData(),n=e.size,i=[];for(let t=0;t<n.width;++t){i[t]=[];for(let e=0;e<n.height;++e)i[t][e]=r[e][t]}return s.SimpleRangeValue.onlyValues(i)})}transposeArraySize(e,t){if(1!==e.args.length)return a.ArraySize.error();const r=this.metadata("TRANSPOSE");var[e]=e.args.map(e=>{return this.arraySizeForAst(e,new c.InterpreterState(t.formulaAddress,t.arraysFlag||null!=(e=null===r||void 0===r?void 0:r.arrayFunction)&&e))});return new a.ArraySize(e.height,e.width)}createKernel(i,o){return function(...r){var n=[];for(let t=0;t<o.height;++t){n.push([]);for(let e=0;e<o.width;++e)n[t][e]=i.apply({thread:{x:e,y:t}},r)}return n}}}n.implementedFunctions={MMULT:{method:"mmult",arraySizeMethod:"mmultArraySize",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.RANGE}],vectorizationForbidden:!0},TRANSPOSE:{method:"transpose",arraySizeMethod:"transposeArraySize",parameters:[{argumentType:t.FunctionArgumentType.RANGE}],vectorizationForbidden:!0},MAXPOOL:{method:"maxpool",arraySizeMethod:"maxpoolArraySize",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,optionalArg:!0}],vectorizationForbidden:!0},MEDIANPOOL:{method:"medianpool",arraySizeMethod:"medianpoolArraySize",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,optionalArg:!0}],vectorizationForbidden:!0}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{MedianPlugin:()=>o});var n=r(3),i=r(61),t=r(97);class o extends t.FunctionPlugin{median(e,t){return this.runFunction(e.args,t,this.metadata("MEDIAN"),(...e)=>{e=this.arithmeticHelper.coerceNumbersExactRanges(e);return e instanceof n.CellError?e:0===e.length?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.OneValue):(e.sort((e,t)=>e-t),e.length%2==0?(e[e.length/2-1]+e[e.length/2])/2:e[Math.floor(e.length/2)])})}large(e,t){return this.runFunction(e.args,t,this.metadata("LARGE"),(e,t)=>{e=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());return e instanceof n.CellError?e:(e.sort((e,t)=>e-t),(t=Math.trunc(t))>e.length?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.ValueLarge):e[e.length-t])})}small(e,t){return this.runFunction(e.args,t,this.metadata("SMALL"),(e,t)=>{e=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());return e instanceof n.CellError?e:(e.sort((e,t)=>e-t),(t=Math.trunc(t))>e.length?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.ValueLarge):e[t-1])})}}o.implementedFunctions={MEDIAN:{method:"median",parameters:[{argumentType:t.FunctionArgumentType.ANY}],repeatLastArgs:1},LARGE:{method:"large",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1}]},SMALL:{method:"small",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1}]}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{ModuloPlugin:()=>i});var n=r(3),t=r(97);class i extends t.FunctionPlugin{mod(e,t){return this.runFunction(e.args,t,this.metadata("MOD"),(e,t)=>0===t?new n.CellError(n.ErrorType.DIV_BY_ZERO):e%t)}}i.implementedFunctions={MOD:{method:"mod",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER}]}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{NumericAggregationPlugin:()=>l});var c=r(2),p=r(3),u=r(61),d=r(77),h=r(7),n=r(98),i=r(70),f=r(69),o=r(97);function s(e){return(0,i.isExtendedNumber)(e)&&!Number.isFinite((0,i.getRawValue)(e))?0:e}class a{constructor(e,t,r){this.sumsq=e,this.sum=t,this.count=r}static single(e){return new a(e*e,e,1)}compose(e){return new a(this.sumsq+e.sumsq,this.sum+e.sum,this.count+e.count)}averageValue(){if(0<this.count)return this.sum/this.count}varSValue(){if(1<this.count)return(this.sumsq-this.sum*this.sum/this.count)/(this.count-1)}varPValue(){if(0<this.count)return(this.sumsq-this.sum*this.sum/this.count)/this.count}}a.empty=new a(0,0,0);class l extends o.FunctionPlugin{constructor(){super(...arguments),this.addWithEpsilonRaw=(e,t)=>this.arithmeticHelper.addWithEpsilonRaw(e,t)}sum(e,t){return this.doSum(e.args,t)}sumsq(e,t){return this.reduce(e.args,t,0,"SUMSQ",this.addWithEpsilonRaw,e=>Math.pow((0,i.getRawValue)(e),2),g)}max(e,t){return this.doMax(e.args,t)}maxa(e,t){return s(this.reduce(e.args,t,Number.NEGATIVE_INFINITY,"MAXA",(e,t)=>Math.max(e,t),i.getRawValue,m))}min(e,t){return this.doMin(e.args,t)}mina(e,t){return s(this.reduce(e.args,t,Number.POSITIVE_INFINITY,"MINA",(e,t)=>Math.min(e,t),i.getRawValue,m))}count(e,t){return this.doCount(e.args,t)}counta(e,t){return this.doCounta(e.args,t)}average(e,t){return this.doAverage(e.args,t)}averagea(e,t){e=this.reduce(e.args,t,a.empty,"_AGGREGATE_A",(e,t)=>e.compose(t),e=>a.single((0,i.getRawValue)(e)),m);return e instanceof p.CellError?e:null!=(t=e.averageValue())?t:new p.CellError(p.ErrorType.DIV_BY_ZERO)}vars(e,t){return this.doVarS(e.args,t)}varp(e,t){return this.doVarP(e.args,t)}vara(e,t){e=this.reduceAggregateA(e.args,t);return e instanceof p.CellError?e:null!=(t=e.varSValue())?t:new p.CellError(p.ErrorType.DIV_BY_ZERO)}varpa(e,t){e=this.reduceAggregateA(e.args,t);return e instanceof p.CellError?e:null!=(t=e.varPValue())?t:new p.CellError(p.ErrorType.DIV_BY_ZERO)}stdevs(e,t){return this.doStdevS(e.args,t)}stdevp(e,t){return this.doStdevP(e.args,t)}stdeva(e,t){e=this.reduceAggregateA(e.args,t);return e instanceof p.CellError?e:void 0===(t=e.varSValue())?new p.CellError(p.ErrorType.DIV_BY_ZERO):Math.sqrt(t)}stdevpa(e,t){e=this.reduceAggregateA(e.args,t);return e instanceof p.CellError?e:void 0===(t=e.varPValue())?new p.CellError(p.ErrorType.DIV_BY_ZERO):Math.sqrt(t)}product(e,t){return this.doProduct(e.args,t)}subtotal(e,t){if(e.args.length<2)return new p.CellError(p.ErrorType.NA,u.ErrorMessage.WrongArgNumber);var r=this.coerceToType(this.evaluateAst(e.args[0],t),{argumentType:o.FunctionArgumentType.NUMBER},t),n=e.args.slice(1);switch(r){case 1:case 101:return this.doAverage(n,t);case 2:case 102:return this.doCount(n,t);case 3:case 103:return this.doCounta(n,t);case 4:case 104:return this.doMax(n,t);case 5:case 105:return this.doMin(n,t);case 6:case 106:return this.doProduct(n,t);case 7:case 107:return this.doStdevS(n,t);case 8:case 108:return this.doStdevP(n,t);case 9:case 109:return this.doSum(n,t);case 10:case 110:return this.doVarS(n,t);case 11:case 111:return this.doVarP(n,t);default:return new p.CellError(p.ErrorType.VALUE,u.ErrorMessage.BadMode)}}reduceAggregate(e,t){return this.reduce(e,t,a.empty,"_AGGREGATE",(e,t)=>e.compose(t),e=>a.single((0,i.getRawValue)(e)),g)}reduceAggregateA(e,t){return this.reduce(e,t,a.empty,"_AGGREGATE_A",(e,t)=>e.compose(t),e=>a.single((0,i.getRawValue)(e)),m)}doAverage(e,t){e=this.reduceAggregate(e,t);return e instanceof p.CellError?e:null!=(t=e.averageValue())?t:new p.CellError(p.ErrorType.DIV_BY_ZERO)}doVarS(e,t){e=this.reduceAggregate(e,t);return e instanceof p.CellError?e:null!=(t=e.varSValue())?t:new p.CellError(p.ErrorType.DIV_BY_ZERO)}doVarP(e,t){e=this.reduceAggregate(e,t);return e instanceof p.CellError?e:null!=(t=e.varPValue())?t:new p.CellError(p.ErrorType.DIV_BY_ZERO)}doStdevS(e,t){e=this.reduceAggregate(e,t);return e instanceof p.CellError?e:void 0===(t=e.varSValue())?new p.CellError(p.ErrorType.DIV_BY_ZERO):Math.sqrt(t)}doStdevP(e,t){e=this.reduceAggregate(e,t);return e instanceof p.CellError?e:void 0===(t=e.varPValue())?new p.CellError(p.ErrorType.DIV_BY_ZERO):Math.sqrt(t)}doCount(e,t){return this.reduce(e,t,0,"COUNT",(e,t)=>e+t,i.getRawValue,e=>(0,i.isExtendedNumber)(e)?1:0)}doCounta(e,t){return this.reduce(e,t,0,"COUNTA",(e,t)=>e+t,i.getRawValue,e=>e===i.EmptyValue?0:1)}doMax(e,t){return s(this.reduce(e,t,Number.NEGATIVE_INFINITY,"MAX",(e,t)=>Math.max(e,t),i.getRawValue,g))}doMin(e,t){return s(this.reduce(e,t,Number.POSITIVE_INFINITY,"MIN",(e,t)=>Math.min(e,t),i.getRawValue,g))}doSum(e,t){return this.reduce(e,t,0,"SUM",this.addWithEpsilonRaw,i.getRawValue,g)}doProduct(e,t){return this.reduce(e,t,1,"PRODUCT",(e,t)=>e*t,i.getRawValue,g)}reduce(e,i,o,s,a,l,c){return e.length<1?new p.CellError(p.ErrorType.NA,u.ErrorMessage.WrongArgNumber):e.reduce((e,t)=>{if(e instanceof p.CellError)return e;var r;if(t.type===h.AstNodeType.CELL_RANGE||t.type===h.AstNodeType.COLUMN_RANGE||t.type===h.AstNodeType.ROW_RANGE)return(r=this.evaluateRange(t,i,o,s,a,l,c))instanceof p.CellError?r:a(r,e);let n;if((n=this.evaluateAst(t,i))instanceof f.SimpleRangeValue)return Array.from(n.valuesFromTopLeftCorner()).map(c).filter(e=>void 0!==e).map(e=>e instanceof p.CellError?e:l(e)).reduce((e,t)=>e instanceof p.CellError?e:t instanceof p.CellError?t:a(e,t),e);if(t.type===h.AstNodeType.CELL_REFERENCE){if(void 0===(n=c(n)))return e}else if(n=this.coerceScalarToNumberOrError(n),void 0===(n=c(n)))return e;return n instanceof p.CellError?n:a(e,l(n))},o)}evaluateRange(e,t,r,n,i,o,s){let a;try{a=c.AbsoluteCellRange.fromAst(e,t.formulaAddress)}catch(e){if(e instanceof d.SheetsNotEqual)return new p.CellError(p.ErrorType.REF,u.ErrorMessage.RangeManySheets);throw e}e=this.dependencyGraph.getRange(a.start,a.end);if(void 0===e)throw new Error("Range does not exists in graph");let l=e.getFunctionValue(n);return void 0===l&&(t=this.getRangeValues(n,a,e,o,s),l=t.reduce((e,t)=>e instanceof p.CellError?e:t instanceof p.CellError?t:i(e,t),r),e.setFunctionValue(n,l)),l}getRangeValues(e,t,r,n,i){var o=[],{smallerRangeVertex:s,restRange:a}=this.dependencyGraph.rangeMapping.findSmallerRange(t);let l;if(void 0!==s&&this.dependencyGraph.existsEdge(s,r)){r=s.getFunctionValue(e);if(void 0!==r)o.push(r);else for(const d of s.range.addresses(this.dependencyGraph)){var c=i(this.dependencyGraph.getScalarValue(d));c instanceof p.CellError?o.push(c):void 0!==c&&o.push(n(c))}l=a}else l=t;for(const h of l.addresses(this.dependencyGraph)){var u=i(this.dependencyGraph.getScalarValue(h));u instanceof p.CellError?o.push(u):void 0!==u&&o.push(n(u))}return o}}function g(e){if((0,i.isExtendedNumber)(e)||e instanceof p.CellError)return e}function m(e){return"boolean"==typeof e?(0,n.coerceBooleanToNumber)(e):(0,i.isExtendedNumber)(e)||e instanceof p.CellError?e:"string"==typeof e?0:void 0}l.implementedFunctions={SUM:{method:"sum",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1},SUMSQ:{method:"sumsq",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1},MAX:{method:"max",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1},MIN:{method:"min",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1},MAXA:{method:"maxa",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1},MINA:{method:"mina",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1},COUNT:{method:"count",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1},COUNTA:{method:"counta",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1},AVERAGE:{method:"average",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1},AVERAGEA:{method:"averagea",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1},PRODUCT:{method:"product",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1},"VAR.S":{method:"vars",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1},"VAR.P":{method:"varp",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1},VARA:{method:"vara",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1},VARPA:{method:"varpa",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1},"STDEV.S":{method:"stdevs",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1},"STDEV.P":{method:"stdevp",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1},STDEVA:{method:"stdeva",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1},STDEVPA:{method:"stdevpa",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1},SUBTOTAL:{method:"subtotal",parameters:[{argumentType:o.FunctionArgumentType.NUMBER},{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1}},l.aliases={VAR:"VAR.S",VARP:"VAR.P",STDEV:"STDEV.S",STDEVP:"STDEV.P",VARS:"VAR.S",STDEVS:"STDEV.S"}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{PowerPlugin:()=>n});t=r(97);class n extends t.FunctionPlugin{power(e,t){return this.runFunction(e.args,t,this.metadata("POWER"),Math.pow)}}n.implementedFunctions={POWER:{method:"power",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER}]}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{RadiansPlugin:()=>n});t=r(97);class n extends t.FunctionPlugin{radians(e,t){return this.runFunction(e.args,t,this.metadata("RADIANS"),e=>e*(Math.PI/180))}}n.implementedFunctions={RADIANS:{method:"radians",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{RadixConversionPlugin:()=>a});var n=r(3),i=r(61),o=r(106),t=r(97);const s=10;class a extends t.FunctionPlugin{dec2bin(e,t){return this.runFunction(e.args,t,this.metadata("DEC2BIN"),(e,t)=>c(e,2,t))}dec2oct(e,t){return this.runFunction(e.args,t,this.metadata("DEC2OCT"),(e,t)=>c(e,8,t))}dec2hex(e,t){return this.runFunction(e.args,t,this.metadata("DEC2HEX"),(e,t)=>c(e,16,t))}bin2dec(e,t){return this.runFunction(e.args,t,this.metadata("BIN2DEC"),e=>{e=l(e,2,s);return void 0===e?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.NotBinary):p(e,2)})}bin2oct(e,t){return this.runFunction(e.args,t,this.metadata("BIN2OCT"),(e,t)=>{e=l(e,2,s);return void 0===e?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.NotBinary):c(p(e,2),8,t)})}bin2hex(e,t){return this.runFunction(e.args,t,this.metadata("BIN2HEX"),(e,t)=>{e=l(e,2,s);return void 0===e?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.NotBinary):c(p(e,2),16,t)})}oct2dec(e,t){return this.runFunction(e.args,t,this.metadata("OCT2DEC"),e=>{e=l(e,8,s);return void 0===e?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.NotOctal):p(e,8)})}oct2bin(e,t){return this.runFunction(e.args,t,this.metadata("OCT2BIN"),(e,t)=>{e=l(e,8,s);return void 0===e?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.NotOctal):c(p(e,8),2,t)})}oct2hex(e,t){return this.runFunction(e.args,t,this.metadata("OCT2HEX"),(e,t)=>{e=l(e,8,s);return void 0===e?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.NotOctal):c(p(e,8),16,t)})}hex2dec(e,t){return this.runFunction(e.args,t,this.metadata("HEX2DEC"),e=>{e=l(e,16,s);return void 0===e?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.NotHex):p(e,16)})}hex2bin(e,t){return this.runFunction(e.args,t,this.metadata("HEX2BIN"),(e,t)=>{e=l(e,16,s);return void 0===e?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.NotHex):c(p(e,16),2,t)})}hex2oct(e,t){return this.runFunction(e.args,t,this.metadata("HEX2OCT"),(e,t)=>{e=l(e,16,s);return void 0===e?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.NotHex):c(p(e,16),8,t)})}base(e,t){return this.runFunction(e.args,t,this.metadata("BASE"),d)}decimal(e,t){return this.runFunction(e.args,t,this.metadata("DECIMAL"),(e,t)=>{e=l(e,t,255);return void 0===e?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.NotHex):parseInt(e,t)})}}function l(e,t,r){t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".substr(0,t),t=new RegExp(`^[${t}]+$`);if(!(e.length>r)&&t.test(e))return e}function c(e,t,r){return e>-u(t)-1?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.ValueBaseLarge):e<u(t)?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.ValueBaseSmall):(t=h(e,t),void 0===r||e<0?t:t.length>r?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.ValueBaseLong):(0,o.padLeft)(t,r))}function u(e){return-Math.pow(e,s)/2}function d(e,t,r){e=h(e,t);return void 0!==r&&r>e.length?(0,o.padLeft)(e,r):e}function h(e,t){return(e+(e<0?Math.pow(t,s):0)).toString(t).toUpperCase()}function p(e,t){e=parseInt(e,t),t=Math.pow(t,s);return t/2<=e?e-t:e}a.implementedFunctions={DEC2BIN:{method:"dec2bin",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2OCT:{method:"dec2oct",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2HEX:{method:"dec2hex",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},BIN2DEC:{method:"bin2dec",parameters:[{argumentType:t.FunctionArgumentType.STRING}]},BIN2OCT:{method:"bin2oct",parameters:[{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.NUMBER,optionalArg:!0,minValue:0,maxValue:s}]},BIN2HEX:{method:"bin2hex",parameters:[{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.NUMBER,optionalArg:!0,minValue:0,maxValue:s}]},OCT2DEC:{method:"oct2dec",parameters:[{argumentType:t.FunctionArgumentType.STRING}]},OCT2BIN:{method:"oct2bin",parameters:[{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.NUMBER,optionalArg:!0,minValue:0,maxValue:s}]},OCT2HEX:{method:"oct2hex",parameters:[{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.NUMBER,optionalArg:!0,minValue:0,maxValue:s}]},HEX2DEC:{method:"hex2dec",parameters:[{argumentType:t.FunctionArgumentType.STRING}]},HEX2BIN:{method:"hex2bin",parameters:[{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.NUMBER,optionalArg:!0,minValue:0,maxValue:s}]},HEX2OCT:{method:"hex2oct",parameters:[{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.NUMBER,optionalArg:!0,minValue:0,maxValue:s}]},DECIMAL:{method:"decimal",parameters:[{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.NUMBER,minValue:2,maxValue:36}]},BASE:{method:"base",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:2,maxValue:36},{argumentType:t.FunctionArgumentType.NUMBER,optionalArg:!0,minValue:0,maxValue:255}]}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{RandomPlugin:()=>o});var n=r(3),i=r(61),t=r(97);class o extends t.FunctionPlugin{rand(e,t){return this.runFunction(e.args,t,this.metadata("RAND"),Math.random)}randbetween(e,t){return this.runFunction(e.args,t,this.metadata("RANDBETWEEN"),(e,t)=>t<e?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.WrongOrder):((e=Math.ceil(e))===(t=Math.floor(t)+1)&&(t+=1),e+Math.floor(Math.random()*(t-e))))}}o.implementedFunctions={RAND:{method:"rand",parameters:[],isVolatile:!0},RANDBETWEEN:{method:"randbetween",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER}],isVolatile:!0}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{RoundingPlugin:()=>a,findNextEvenNumber:()=>s,findNextOddNumber:()=>o});var n=r(3),i=r(61),t=r(97);function o(e){e=Math.ceil(e);return e%2==1?e:e+1}function s(e){e=Math.ceil(e);return e%2==0?e:e+1}class a extends t.FunctionPlugin{roundup(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),(e,t)=>{t=Math.pow(10,t);return e<0?-Math.ceil(-e*t)/t:Math.ceil(e*t)/t})}rounddown(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),(e,t)=>{t=Math.pow(10,t);return e<0?-Math.floor(-e*t)/t:Math.floor(e*t)/t})}round(e,t){return this.runFunction(e.args,t,this.metadata("ROUND"),(e,t)=>{t=Math.pow(10,t);return e<0?-Math.round(-e*t)/t:Math.round(e*t)/t})}intFunc(e,t){return this.runFunction(e.args,t,this.metadata("INT"),e=>e<0?-Math.floor(-e):Math.floor(e))}even(e,t){return this.runFunction(e.args,t,this.metadata("EVEN"),e=>e<0?-s(-e):s(e))}odd(e,t){return this.runFunction(e.args,t,this.metadata("ODD"),e=>e<0?-o(-e):o(e))}ceilingmath(e,t){return this.runFunction(e.args,t,this.metadata("CEILING.MATH"),(e,t,r)=>0===t||0===e?0:(t=Math.abs(t),1===r&&e<0&&(t=-t),Math.ceil(e/t)*t))}ceiling(e,t){return this.runFunction(e.args,t,this.metadata("CEILING"),(e,t)=>0===e?0:0===t?new n.CellError(n.ErrorType.DIV_BY_ZERO):0<e&&t<0?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.DistinctSigns):Math.ceil(e/t)*t)}ceilingprecise(e,t){return this.runFunction(e.args,t,this.metadata("CEILING.PRECISE"),(e,t)=>0===t||0===e?0:(t=Math.abs(t),Math.ceil(e/t)*t))}floormath(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR.MATH"),(e,t,r)=>0===t||0===e?0:(t=Math.abs(t),1===r&&e<0&&(t*=-1),Math.floor(e/t)*t))}floor(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR"),(e,t)=>0===e?0:0===t?new n.CellError(n.ErrorType.DIV_BY_ZERO):0<e&&t<0?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.DistinctSigns):Math.floor(e/t)*t)}floorprecise(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR.PRECISE"),(e,t)=>0===t||0===e?0:(t=Math.abs(t),Math.floor(e/t)*t))}}a.implementedFunctions={ROUNDUP:{method:"roundup",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0}]},ROUNDDOWN:{method:"rounddown",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0}]},ROUND:{method:"round",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0}]},INT:{method:"intFunc",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},EVEN:{method:"even",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},ODD:{method:"odd",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},"CEILING.MATH":{method:"ceilingmath",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:1},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0}]},CEILING:{method:"ceiling",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER}]},"CEILING.PRECISE":{method:"ceilingprecise",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:1}]},"FLOOR.MATH":{method:"floormath",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:1},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0}]},FLOOR:{method:"floor",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER}]},"FLOOR.PRECISE":{method:"floorprecise",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:1}]}},a.aliases={"ISO.CEILING":"CEILING.PRECISE",TRUNC:"ROUNDDOWN"}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{SqrtPlugin:()=>n});t=r(97);class n extends t.FunctionPlugin{sqrt(e,t){return this.runFunction(e.args,t,this.metadata("SQRT"),Math.sqrt)}}n.implementedFunctions={SQRT:{method:"sqrt",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{ConditionalAggregationPlugin:()=>n});var u=r(3),d=r(61),h=r(181),i=r(70),t=r(97);class o{constructor(e,t){this.sum=e,this.count=t}static single(e){return new o(e,1)}compose(e){return new o(this.sum+e.sum,this.count+e.count)}averageValue(){if(0<this.count)return this.sum/this.count}}function s(e){return(0,i.isExtendedNumber)(e)&&!Number.isFinite((0,i.getRawValue)(e))?0:e}function a(e){return e instanceof u.CellError?e:(0,i.isExtendedNumber)(e)?(0,i.getRawValue)(e):void 0}o.empty=new o(0,0);class n extends t.FunctionPlugin{sumif(e,t){const n="SUMIF";return this.runFunction(e.args,t,this.metadata(n),(e,t,r)=>this.computeConditionalAggregationFunction(null!=r?r:e,[e,t],n,0,(e,t)=>this.arithmeticHelper.nonstrictadd(e,t),a))}sumifs(e,t){const r="SUMIFS";return this.runFunction(e.args,t,this.metadata(r),(e,...t)=>this.computeConditionalAggregationFunction(e,t,r,0,(e,t)=>this.arithmeticHelper.nonstrictadd(e,t),a))}averageif(e,t){const n="AVERAGEIF";return this.runFunction(e.args,t,this.metadata(n),(e,t,r)=>{r=this.computeConditionalAggregationFunction(null!=r?r:e,[e,t],n,o.empty,(e,t)=>e.compose(t),e=>(0,i.isExtendedNumber)(e)?o.single((0,i.getRawValue)(e)):o.empty);return r instanceof u.CellError?r:r.averageValue()||new u.CellError(u.ErrorType.DIV_BY_ZERO)})}countif(e,t){const r="COUNTIF";return this.runFunction(e.args,t,this.metadata(r),(e,t)=>this.computeConditionalAggregationFunction(e,[e,t],r,0,(e,t)=>e+t,()=>1))}countifs(e,t){const r="COUNTIFS";return this.runFunction(e.args,t,this.metadata(r),(...e)=>this.computeConditionalAggregationFunction(e[0],e,r,0,(e,t)=>e+t,()=>1))}minifs(e,t){const r="MINIFS",n=(e,t)=>void 0===t||void 0===e?void 0===t?e:t:Math.min(e,t);return this.runFunction(e.args,t,this.metadata(r),(e,...t)=>{return s(this.computeConditionalAggregationFunction(e,t,r,Number.POSITIVE_INFINITY,n,a))})}maxifs(e,t){const r="MAXIFS",n=(e,t)=>void 0===t||void 0===e?void 0===t?e:t:Math.max(e,t);return this.runFunction(e.args,t,this.metadata(r),(e,...t)=>{return s(this.computeConditionalAggregationFunction(e,t,r,Number.NEGATIVE_INFINITY,n,a))})}computeConditionalAggregationFunction(e,t,r,n,i,o){var s,a=[];for(let e=0;e<t.length;e+=2){var l=t[e],c=this.interpreter.criterionBuilder.fromCellValue(t[e+1],this.arithmeticHelper);if(void 0===c)return new u.CellError(u.ErrorType.VALUE,d.ErrorMessage.BadCriterion);a.push(new h.Condition(l,c))}return new h.CriterionFunctionCompute(this.interpreter,(s=r,e=>{e=e.map(e=>`${e.conditionRange.range.sheet},${e.conditionRange.range.start.col},`+e.conditionRange.range.start.row);return[s,...e].join(",")}),n,i,o).compute(e,a)}}n.implementedFunctions={SUMIF:{method:"sumif",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.NOERROR},{argumentType:t.FunctionArgumentType.RANGE,optionalArg:!0}]},COUNTIF:{method:"countif",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.NOERROR}]},AVERAGEIF:{method:"averageif",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.NOERROR},{argumentType:t.FunctionArgumentType.RANGE,optionalArg:!0}]},SUMIFS:{method:"sumifs",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.NOERROR}],repeatLastArgs:2},COUNTIFS:{method:"countifs",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.NOERROR}],repeatLastArgs:2},MINIFS:{method:"minifs",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.NOERROR}],repeatLastArgs:2},MAXIFS:{method:"maxifs",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.NOERROR}],repeatLastArgs:2}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{Condition:()=>i,CriterionFunctionCompute:()=>n});var c=r(3),a=r(61),o=r(182),s=r(70);class n{constructor(e,t,r,n,i){this.interpreter=e,this.cacheKey=t,this.reduceInitialValue=r,this.composeFunction=n,this.mapFunction=i,this.dependencyGraph=this.interpreter.dependencyGraph}compute(e,t){for(const s of t)if(!s.conditionRange.sameDimensionsAs(e))return new c.CellError(c.ErrorType.VALUE,a.ErrorMessage.EqualLength);const r=this.tryToGetRangeVertexForRangeValue(e);var n,i,o=t.map(e=>this.tryToGetRangeVertexForRangeValue(e.conditionRange));return r&&o.every(e=>void 0!==e)?(n=t.map(e=>e.criterionPackage.raw).join(","),void 0!==(i=this.findAlreadyComputedValueInCache(r,this.cacheKey(t),n))?(this.interpreter.stats.incrementCriterionFunctionFullCacheUsed(),i):((i=this.buildNewCriterionCache(this.cacheKey(t),t.map(e=>e.conditionRange.range),e.range)).has(n)||i.set(n,[this.evaluateRangeValue(e,t),t.map(e=>e.criterionPackage.lambda)]),r.setCriterionFunctionValues(this.cacheKey(t),i),o.forEach(e=>{void 0!==e&&e.addDependentCacheRange(r)}),i.get(n)[0])):this.evaluateRangeValue(e,t)}tryToGetRangeVertexForRangeValue(e){e=e.range;if(void 0!==e)return this.dependencyGraph.getRange(e.start,e.end)}reduceFunction(e){let t=this.reduceInitialValue;for(const r of e)t=this.composeFunction(t,r);return t}findAlreadyComputedValueInCache(e,t,r){return e.getCriterionFunctionValue(t,r)}evaluateRangeValue(e,t){var r=t.map(e=>e.criterionPackage.lambda),e=Array.from(e.valuesFromTopLeftCorner()).map(this.mapFunction)[Symbol.iterator](),r=d(r,t.map(e=>e.conditionRange.iterateValuesFromTopLeftCorner()),e);return this.reduceFunction(r)}buildNewCriterionCache(e,t,r){var n=this.dependencyGraph.getRange(r.start,r.end);const{smallerRangeVertex:i,restConditionRanges:o,restValuesRange:s}=((e,t,r)=>{if(r.end.row>r.start.row){var n=(0,c.simpleCellAddress)(r.end.sheet,r.end.col,r.end.row-1),e=e.getRange(r.start,n);if(void 0!==e)return{smallerRangeVertex:e,restValuesRange:r.withStart((0,c.simpleCellAddress)(r.start.sheet,r.start.col,r.end.row)),restConditionRanges:t.map(e=>e.withStart((0,c.simpleCellAddress)(e.start.sheet,e.start.col,e.end.row)))}}return{restValuesRange:r,restConditionRanges:t}})(this.dependencyGraph,t,r);let a;a=void 0!==i&&this.dependencyGraph.existsEdge(i,n)?i.getCriterionFunctionValues(e):new Map;const l=new Map;return a.forEach(([e,t],r)=>{var n=d(t,o.map(e=>u(this.dependencyGraph,e)),Array.from(u(this.dependencyGraph,s)).map(this.mapFunction)[Symbol.iterator]()),e=this.composeFunction(e,this.reduceFunction(n));this.interpreter.stats.incrementCriterionFunctionPartialCacheUsed(),l.set(r,[e,t])}),l}}class i{constructor(e,t){this.conditionRange=e,this.criterionPackage=t}}function*u(e,t){for(const r of t.addresses(e))yield(0,s.getRawValue)(e.getScalarValue(r))}function*d(e,t,r){for(const i of r){var n=t.map(e=>(0,o.split)(e));if(!n.every(e=>Object.prototype.hasOwnProperty.call(e,"value")))return;!function(t,r){var n=[];for(let e=0;e<Math.min(t.length,r.length);e++)n.push([t[e],r[e]]);return n}(n.map(e=>(0,s.getRawValue)(e.value)),e).every(([e,t])=>t(e))||(yield i),t=n.map(e=>e.rest)}}},(e,t,r)=>{"use strict";function*n(){}r.r(t),r.d(t,{empty:()=>n,first:()=>function(e){var e=e[Symbol.iterator](),{done:e,value:t}=e.next();if(!e)return t},split:()=>function(e){var e=e[Symbol.iterator](),{done:t,value:r}=e.next();return t?{rest:n()}:{value:r,rest:e}}})},(e,t,r)=>{"use strict";r.r(t),r.d(t,{SumprodPlugin:()=>n});var l=r(3),c=r(61),u=r(70),t=r(97);class n extends t.FunctionPlugin{sumproduct(e,t){return this.runFunction(e.args,t,this.metadata("SUMPRODUCT"),(...e)=>{var t=e[0].width(),r=e[0].height();for(const s of e)if(s.width()!==t||s.height()!==r)return new l.CellError(l.ErrorType.VALUE,c.ErrorMessage.EqualLength);let n=0;var i=e.map(e=>e.iterateValuesFromTopLeftCorner());for(let e=0;e<t*r;e++){let e=1;for(const a of i){var o=a.next().value;if(o instanceof l.CellError)return o;o=this.coerceScalarToNumberOrError(o);(0,u.isExtendedNumber)(o)?e*=(0,u.getRawValue)(o):e=0}n+=e}return n})}}n.implementedFunctions={SUMPRODUCT:{method:"sumproduct",parameters:[{argumentType:t.FunctionArgumentType.RANGE}],repeatLastArgs:1}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{TextPlugin:()=>n});var a=r(3),l=r(61),t=r(97);class n extends t.FunctionPlugin{concatenate(e,t){return this.runFunction(e.args,t,this.metadata("CONCATENATE"),(...e)=>"".concat(...e))}split(e,t){return this.runFunction(e.args,t,this.metadata("SPLIT"),(e,t)=>{e=e.split(" ");return t>=e.length||t<0?new a.CellError(a.ErrorType.VALUE,l.ErrorMessage.IndexBounds):e[t]})}len(e,t){return this.runFunction(e.args,t,this.metadata("LEN"),e=>e.length)}lower(e,t){return this.runFunction(e.args,t,this.metadata("LOWER"),e=>e.toLowerCase())}trim(e,t){return this.runFunction(e.args,t,this.metadata("TRIM"),e=>e.replace(/^ +| +$/g,"").replace(/ +/g," "))}proper(e,t){return this.runFunction(e.args,t,this.metadata("PROPER"),e=>e.replace(/\p{L}+/gu,e=>e.charAt(0).toUpperCase()+e.substring(1).toLowerCase()))}clean(e,t){return this.runFunction(e.args,t,this.metadata("CLEAN"),e=>e.replace(/[\u0000-\u001F]/g,""))}exact(e,t){return this.runFunction(e.args,t,this.metadata("EXACT"),(e,t)=>e===t)}rept(e,t){return this.runFunction(e.args,t,this.metadata("REPT"),(e,t)=>t<0?new a.CellError(a.ErrorType.VALUE,l.ErrorMessage.NegativeCount):e.repeat(t))}right(e,t){return this.runFunction(e.args,t,this.metadata("RIGHT"),(e,t)=>t<0?new a.CellError(a.ErrorType.VALUE,l.ErrorMessage.NegativeLength):0===t?"":e.slice(-t))}left(e,t){return this.runFunction(e.args,t,this.metadata("LEFT"),(e,t)=>t<0?new a.CellError(a.ErrorType.VALUE,l.ErrorMessage.NegativeLength):e.slice(0,t))}mid(e,t){return this.runFunction(e.args,t,this.metadata("MID"),(e,t,r)=>t<1?new a.CellError(a.ErrorType.VALUE,l.ErrorMessage.LessThanOne):r<0?new a.CellError(a.ErrorType.VALUE,l.ErrorMessage.NegativeLength):e.substring(t-1,t+r-1))}replace(e,t){return this.runFunction(e.args,t,this.metadata("REPLACE"),(e,t,r,n)=>t<1?new a.CellError(a.ErrorType.VALUE,l.ErrorMessage.LessThanOne):r<0?new a.CellError(a.ErrorType.VALUE,l.ErrorMessage.NegativeLength):e.substring(0,t-1)+n+e.substring(t+r-1))}search(e,t){return this.runFunction(e.args,t,this.metadata("SEARCH"),(e,t,r)=>{return r<1||r>t.length?new a.CellError(a.ErrorType.VALUE,l.ErrorMessage.LengthBounds):(e=e.toLowerCase(),t=t.substring(r-1).toLowerCase(),-1<(t=this.arithmeticHelper.requiresRegex(e)?this.arithmeticHelper.searchString(e,t):t.indexOf(e))?t+r:new a.CellError(a.ErrorType.VALUE,l.ErrorMessage.PatternNotFound))})}substitute(e,t){return this.runFunction(e.args,t,this.metadata("SUBSTITUTE"),(e,t,r,n)=>{var i,t=this.escapeRegExpSpecialCharacters(t),o=new RegExp(t,"g");if(void 0===n)return e.replace(o,r);if(n<1)return new a.CellError(a.ErrorType.VALUE,l.ErrorMessage.LessThanOne);let s=0;for(;null!==(i=o.exec(e));)if(n===++s)return e.substring(0,i.index)+r+e.substring(o.lastIndex);return e})}find(e,t){return this.runFunction(e.args,t,this.metadata("FIND"),(e,t,r)=>{return r<1||r>t.length?new a.CellError(a.ErrorType.VALUE,l.ErrorMessage.IndexBounds):0<(t=t.substring(r-1).indexOf(e)+r)?t:new a.CellError(a.ErrorType.VALUE,l.ErrorMessage.PatternNotFound)})}t(e,t){return this.runFunction(e.args,t,this.metadata("T"),e=>e instanceof a.CellError||"string"==typeof e?e:"")}upper(e,t){return this.runFunction(e.args,t,this.metadata("UPPER"),e=>e.toUpperCase())}escapeRegExpSpecialCharacters(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}}n.implementedFunctions={CONCATENATE:{method:"concatenate",parameters:[{argumentType:t.FunctionArgumentType.STRING}],repeatLastArgs:1,expandRanges:!0},EXACT:{method:"exact",parameters:[{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.STRING}]},SPLIT:{method:"split",parameters:[{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.NUMBER}]},LEN:{method:"len",parameters:[{argumentType:t.FunctionArgumentType.STRING}]},LOWER:{method:"lower",parameters:[{argumentType:t.FunctionArgumentType.STRING}]},MID:{method:"mid",parameters:[{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER}]},TRIM:{method:"trim",parameters:[{argumentType:t.FunctionArgumentType.STRING}]},T:{method:"t",parameters:[{argumentType:t.FunctionArgumentType.SCALAR}]},PROPER:{method:"proper",parameters:[{argumentType:t.FunctionArgumentType.STRING}]},CLEAN:{method:"clean",parameters:[{argumentType:t.FunctionArgumentType.STRING}]},REPT:{method:"rept",parameters:[{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.NUMBER}]},RIGHT:{method:"right",parameters:[{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:1}]},LEFT:{method:"left",parameters:[{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:1}]},REPLACE:{method:"replace",parameters:[{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.STRING}]},SEARCH:{method:"search",parameters:[{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:1}]},SUBSTITUTE:{method:"substitute",parameters:[{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.NUMBER,optionalArg:!0}]},FIND:{method:"find",parameters:[{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:1}]},UPPER:{method:"upper",parameters:[{argumentType:t.FunctionArgumentType.STRING}]}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{TrigonometryPlugin:()=>s});var n=r(3),i=r(61),t=r(97),o=r(169);class s extends t.FunctionPlugin{acos(e,t){return this.runFunction(e.args,t,this.metadata("ACOS"),Math.acos)}asin(e,t){return this.runFunction(e.args,t,this.metadata("ASIN"),Math.asin)}cos(e,t){return this.runFunction(e.args,t,this.metadata("COS"),Math.cos)}sin(e,t){return this.runFunction(e.args,t,this.metadata("SIN"),Math.sin)}tan(e,t){return this.runFunction(e.args,t,this.metadata("TAN"),Math.tan)}atan(e,t){return this.runFunction(e.args,t,this.metadata("ATAN"),Math.atan)}atan2(e,t){return this.runFunction(e.args,t,this.metadata("ATAN2"),(e,t)=>0===e&&0===t?new n.CellError(n.ErrorType.DIV_BY_ZERO):Math.atan2(t,e))}cot(e,t){return this.runFunction(e.args,t,this.metadata("COT"),e=>0===e?new n.CellError(n.ErrorType.DIV_BY_ZERO):1/Math.tan(e))}acot(e,t){return this.runFunction(e.args,t,this.metadata("ACOT"),e=>0===e?o.PI/2:Math.atan(1/e))}sec(e,t){return this.runFunction(e.args,t,this.metadata("SEC"),e=>1/Math.cos(e))}csc(e,t){return this.runFunction(e.args,t,this.metadata("CSC"),e=>0===e?new n.CellError(n.ErrorType.DIV_BY_ZERO):1/Math.sin(e))}sinh(e,t){return this.runFunction(e.args,t,this.metadata("SINH"),Math.sinh)}asinh(e,t){return this.runFunction(e.args,t,this.metadata("ASINH"),Math.asinh)}cosh(e,t){return this.runFunction(e.args,t,this.metadata("COSH"),Math.cosh)}acosh(e,t){return this.runFunction(e.args,t,this.metadata("ACOSH"),Math.acosh)}tanh(e,t){return this.runFunction(e.args,t,this.metadata("TANH"),Math.tanh)}atanh(e,t){return this.runFunction(e.args,t,this.metadata("ATANH"),Math.atanh)}coth(e,t){return this.runFunction(e.args,t,this.metadata("COTH"),e=>0===e?new n.CellError(n.ErrorType.DIV_BY_ZERO):1/Math.tanh(e))}acoth(e,t){return this.runFunction(e.args,t,this.metadata("ACOTH"),e=>0===e?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.NonZero):Math.atanh(1/e))}sech(e,t){return this.runFunction(e.args,t,this.metadata("SECH"),e=>1/Math.cosh(e))}csch(e,t){return this.runFunction(e.args,t,this.metadata("CSCH"),e=>0===e?new n.CellError(n.ErrorType.DIV_BY_ZERO):1/Math.sinh(e))}}s.implementedFunctions={ACOS:{method:"acos",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},ASIN:{method:"asin",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},COS:{method:"cos",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},SIN:{method:"sin",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},TAN:{method:"tan",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},ATAN:{method:"atan",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},ATAN2:{method:"atan2",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER}]},COT:{method:"cot",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},SEC:{method:"sec",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},CSC:{method:"csc",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},SINH:{method:"sinh",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},COSH:{method:"cosh",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},TANH:{method:"tanh",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},COTH:{method:"coth",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},SECH:{method:"sech",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},CSCH:{method:"csch",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},ACOT:{method:"acot",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},ASINH:{method:"asinh",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},ACOSH:{method:"acosh",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},ATANH:{method:"atanh",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},ACOTH:{method:"acoth",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{LookupPlugin:()=>i});var a=r(2),l=r(3),c=r(61),n=r(187),u=r(72),o=r(98),d=r(69),t=r(97);class i extends t.FunctionPlugin{constructor(){super(...arguments),this.rowSearch=new n.RowSearchStrategy(this.dependencyGraph)}vlookup(e,t){return this.runFunction(e.args,t,this.metadata("VLOOKUP"),(e,t,r,n)=>{var i=t.range;return void 0===i?new l.CellError(l.ErrorType.VALUE,c.ErrorMessage.WrongType):r<1?new l.CellError(l.ErrorType.VALUE,c.ErrorMessage.LessThanOne):r>i.width()?new l.CellError(l.ErrorType.REF,c.ErrorMessage.IndexLarge):this.doVlookup((0,o.zeroIfEmpty)(e),t,r-1,n)})}hlookup(e,t){return this.runFunction(e.args,t,this.metadata("HLOOKUP"),(e,t,r,n)=>{var i=t.range;return void 0===i?new l.CellError(l.ErrorType.VALUE,c.ErrorMessage.WrongType):r<1?new l.CellError(l.ErrorType.VALUE,c.ErrorMessage.LessThanOne):r>i.height()?new l.CellError(l.ErrorType.REF,c.ErrorMessage.IndexLarge):this.doHlookup((0,o.zeroIfEmpty)(e),t,r-1,n)})}match(e,t){return this.runFunction(e.args,t,this.metadata("MATCH"),(e,t,r)=>this.doMatch((0,o.zeroIfEmpty)(e),t,r))}searchInRange(e,t,r,n){return!r&&"string"==typeof e&&this.arithmeticHelper.requiresRegex(e)?n.advancedFind(this.arithmeticHelper.eqMatcherFunction(e),t):n.find(e,t,r?{ordering:"asc"}:{ordering:"none",matchExactly:!0})}doVlookup(e,t,r,n){this.dependencyGraph.stats.start(u.StatType.VLOOKUP);var i=t.range;let o;o=void 0===i?d.SimpleRangeValue.onlyValues(t.data.map(e=>[e[0]])):d.SimpleRangeValue.onlyRange(a.AbsoluteCellRange.spanFrom(i.start,1,i.height()),this.dependencyGraph);e=this.searchInRange(e,o,n,this.columnSearch);if(this.dependencyGraph.stats.end(u.StatType.VLOOKUP),-1===e)return new l.CellError(l.ErrorType.NA,c.ErrorMessage.ValueNotFound);let s;return(s=void 0===i?t.data[e][r]:(n=(0,l.simpleCellAddress)(i.sheet,i.start.col+r,i.start.row+e),this.dependencyGraph.getCellValue(n)))instanceof d.SimpleRangeValue?new l.CellError(l.ErrorType.VALUE,c.ErrorMessage.WrongType):s}doHlookup(e,t,r,n){var i=t.range;let o;o=void 0===i?d.SimpleRangeValue.onlyValues([t.data[0]]):d.SimpleRangeValue.onlyRange(a.AbsoluteCellRange.spanFrom(i.start,i.width(),1),this.dependencyGraph);e=this.searchInRange(e,o,n,this.rowSearch);if(-1===e)return new l.CellError(l.ErrorType.NA,c.ErrorMessage.ValueNotFound);let s;return(s=void 0===i?t.data[r][e]:(n=(0,l.simpleCellAddress)(i.sheet,i.start.col+e,i.start.row+r),this.dependencyGraph.getCellValue(n)))instanceof d.SimpleRangeValue?new l.CellError(l.ErrorType.VALUE,c.ErrorMessage.WrongType):s}doMatch(e,t,r){return[-1,0,1].includes(r)?1<t.width()&&1<t.height()?new l.CellError(l.ErrorType.NA):-1===(e=(1===t.width()?this.columnSearch:this.rowSearch).find(e,t,0===r?{ordering:"none",matchExactly:!0}:{ordering:-1===r?"desc":"asc"}))?new l.CellError(l.ErrorType.NA,c.ErrorMessage.ValueNotFound):e+1:new l.CellError(l.ErrorType.VALUE,c.ErrorMessage.BadMode)}}i.implementedFunctions={VLOOKUP:{method:"vlookup",parameters:[{argumentType:t.FunctionArgumentType.NOERROR},{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.BOOLEAN,defaultValue:!0}]},HLOOKUP:{method:"hlookup",parameters:[{argumentType:t.FunctionArgumentType.NOERROR},{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.BOOLEAN,defaultValue:!0}]},MATCH:{method:"match",parameters:[{argumentType:t.FunctionArgumentType.NOERROR},{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:1}]}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{RowSearchStrategy:()=>n});class n extends r(138).AdvancedFind{constructor(e){super(e),this.dependencyGraph=e}find(e,t,r){return this.basicFind(e,t,"col",r)}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{RomanPlugin:()=>s});var n=r(3),i=r(61),o=r(70),t=r(97);class s extends t.FunctionPlugin{roman(e,t){return this.runFunction(e.args,t,this.metadata("ROMAN"),(e,t)=>{return e=Math.trunc(e),!1===t?t=4:!0===t&&(t=0),(t=(0,o.getRawValue)(this.coerceScalarToNumberOrError(t)))instanceof n.CellError?t:(t=Math.trunc(t))<0?new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.ValueSmall):4<t?new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.ValueLarge):(t=t,e={val:(e=e)%1e3,acc:"M".repeat(Math.floor(e/1e3))},4===t&&(l(e,"IM",999,1e3),l(e,"ID",499,500)),3<=t&&(l(e,"VM",995,1e3),l(e,"VD",495,500)),2<=t&&(l(e,"XM",990,1e3),l(e,"XD",490,500)),1<=t&&(l(e,"LM",950,1e3),l(e,"LD",450,500)),l(e,"CM",900,1e3),l(e,"CD",400,500),l(e,"D",500,900),e.acc+="C".repeat(Math.floor(e.val/100)),e.val%=100,2<=t&&(l(e,"IC",99,100),l(e,"IL",49,50)),1<=t&&(l(e,"VC",95,100),l(e,"VL",45,50)),l(e,"XC",90,100),l(e,"XL",40,50),l(e,"L",50,90),e.acc+="X".repeat(Math.floor(e.val/10)),e.val%=10,l(e,"IX",9,10),l(e,"IV",4,5),l(e,"V",5,9),e.acc+="I".repeat(e.val),e.acc)})}arabic(e,t){return this.runFunction(e.args,t,this.metadata("ARABIC"),e=>{let t=!1;return(e=e.trim().toUpperCase()).startsWith("-")&&(e=e.slice(1),t=!0,""===e)||(a(e={input:e,acc:0},{token:"MMM",val:3e3},{token:"MM",val:2e3},{token:"M",val:1e3}),a(e,{token:"IM",val:999},{token:"VM",val:995},{token:"XM",val:990},{token:"LM",val:950},{token:"CM",val:900}),a(e,{token:"D",val:500},{token:"ID",val:499},{token:"VD",val:495},{token:"XD",val:490},{token:"LD",val:450},{token:"CD",val:400}),a(e,{token:"CCC",val:300},{token:"CC",val:200},{token:"C",val:100}),a(e,{token:"IC",val:99},{token:"VC",val:95},{token:"XC",val:90}),a(e,{token:"L",val:50},{token:"IL",val:49},{token:"VL",val:45},{token:"XL",val:40}),a(e,{token:"XXX",val:30},{token:"XX",val:20},{token:"X",val:10}),a(e,{token:"IX",val:9}),a(e,{token:"V",val:5},{token:"IV",val:4}),a(e,{token:"III",val:3},{token:"II",val:2},{token:"I",val:1}),""!==e.input)?new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.InvalidRoman):t?-e.acc:e.acc})}}function a(e,...t){for(const r of t)if(e.input.startsWith(r.token)){e.input=e.input.slice(r.token.length),e.acc+=r.val;break}}function l(e,t,r,n){e.val>=r&&e.val<n&&(e.val-=r,e.acc+=t)}s.implementedFunctions={ROMAN:{method:"roman",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:1,lessThan:4e3},{argumentType:t.FunctionArgumentType.NOERROR,optionalArg:!0,defaultValue:0}]},ARABIC:{method:"arabic",parameters:[{argumentType:t.FunctionArgumentType.STRING}]}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{SimpleArithmerticPlugin:()=>n});t=r(97);class n extends t.FunctionPlugin{add(e,t){return this.runFunction(e.args,t,this.metadata("HF.ADD"),this.arithmeticHelper.addWithEpsilon)}concat(e,t){return this.runFunction(e.args,t,this.metadata("HF.CONCAT"),this.arithmeticHelper.concat)}divide(e,t){return this.runFunction(e.args,t,this.metadata("HF.DIVIDE"),this.arithmeticHelper.divide)}eq(e,t){return this.runFunction(e.args,t,this.metadata("HF.EQ"),this.arithmeticHelper.eq)}gt(e,t){return this.runFunction(e.args,t,this.metadata("HF.GT"),this.arithmeticHelper.gt)}gte(e,t){return this.runFunction(e.args,t,this.metadata("HF.GTE"),this.arithmeticHelper.geq)}lt(e,t){return this.runFunction(e.args,t,this.metadata("HF.LT"),this.arithmeticHelper.lt)}lte(e,t){return this.runFunction(e.args,t,this.metadata("HF.LTE"),this.arithmeticHelper.leq)}minus(e,t){return this.runFunction(e.args,t,this.metadata("HF.MINUS"),this.arithmeticHelper.subtract)}multiply(e,t){return this.runFunction(e.args,t,this.metadata("HF.MULTIPLY"),this.arithmeticHelper.multiply)}ne(e,t){return this.runFunction(e.args,t,this.metadata("HF.NE"),this.arithmeticHelper.neq)}pow(e,t){return this.runFunction(e.args,t,this.metadata("HF.POW"),this.arithmeticHelper.pow)}uminus(e,t){return this.runFunction(e.args,t,this.metadata("HF.UMINUS"),this.arithmeticHelper.unaryMinus)}upercent(e,t){return this.runFunction(e.args,t,this.metadata("HF.UNARY_PERCENT"),this.arithmeticHelper.unaryPercent)}uplus(e,t){return this.runFunction(e.args,t,this.metadata("HF.UPLUS"),this.arithmeticHelper.unaryPlus)}}n.implementedFunctions={"HF.ADD":{method:"add",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,passSubtype:!0},{argumentType:t.FunctionArgumentType.NUMBER,passSubtype:!0}]},"HF.CONCAT":{method:"concat",parameters:[{argumentType:t.FunctionArgumentType.STRING,passSubtype:!0},{argumentType:t.FunctionArgumentType.STRING,passSubtype:!0}]},"HF.DIVIDE":{method:"divide",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,passSubtype:!0},{argumentType:t.FunctionArgumentType.NUMBER,passSubtype:!0}]},"HF.EQ":{method:"eq",parameters:[{argumentType:t.FunctionArgumentType.NOERROR,passSubtype:!0},{argumentType:t.FunctionArgumentType.NOERROR,passSubtype:!0}]},"HF.GT":{method:"gt",parameters:[{argumentType:t.FunctionArgumentType.NOERROR,passSubtype:!0},{argumentType:t.FunctionArgumentType.NOERROR,passSubtype:!0}]},"HF.GTE":{method:"gte",parameters:[{argumentType:t.FunctionArgumentType.NOERROR,passSubtype:!0},{argumentType:t.FunctionArgumentType.NOERROR,passSubtype:!0}]},"HF.LT":{method:"lt",parameters:[{argumentType:t.FunctionArgumentType.NOERROR,passSubtype:!0},{argumentType:t.FunctionArgumentType.NOERROR,passSubtype:!0}]},"HF.LTE":{method:"lte",parameters:[{argumentType:t.FunctionArgumentType.NOERROR,passSubtype:!0},{argumentType:t.FunctionArgumentType.NOERROR,passSubtype:!0}]},"HF.MINUS":{method:"minus",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,passSubtype:!0},{argumentType:t.FunctionArgumentType.NUMBER,passSubtype:!0}]},"HF.MULTIPLY":{method:"multiply",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,passSubtype:!0},{argumentType:t.FunctionArgumentType.NUMBER,passSubtype:!0}]},"HF.NE":{method:"ne",parameters:[{argumentType:t.FunctionArgumentType.NOERROR,passSubtype:!0},{argumentType:t.FunctionArgumentType.NOERROR,passSubtype:!0}]},"HF.POW":{method:"pow",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,passSubtype:!0},{argumentType:t.FunctionArgumentType.NUMBER,passSubtype:!0}]},"HF.UMINUS":{method:"uminus",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,passSubtype:!0}]},"HF.UNARY_PERCENT":{method:"upercent",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,passSubtype:!0}]},"HF.UPLUS":{method:"uplus",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,passSubtype:!0}]}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{StatisticalPlugin:()=>i});var s=r(3),a=r(61),n=r(191),l=r(192),t=r(97);class i extends t.FunctionPlugin{erf(e,t){return this.runFunction(e.args,t,this.metadata("ERF"),(e,t)=>void 0===t?(0,l.erf)(e):(0,l.erf)(t)-(0,l.erf)(e))}erfc(e,t){return this.runFunction(e.args,t,this.metadata("ERFC"),l.erfc)}expondist(e,t){return this.runFunction(e.args,t,this.metadata("EXPON.DIST"),(e,t,r)=>r?l.exponential.cdf(e,t):l.exponential.pdf(e,t))}fisher(e,t){return this.runFunction(e.args,t,this.metadata("FISHER"),e=>Math.log((1+e)/(1-e))/2)}fisherinv(e,t){return this.runFunction(e.args,t,this.metadata("FISHERINV"),e=>1-2/(Math.exp(2*e)+1))}gamma(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA"),l.gammafn)}gammadist(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA.DIST"),(e,t,r,n)=>n?l.gamma.cdf(e,t,r):l.gamma.pdf(e,t,r))}gammaln(e,t){return this.runFunction(e.args,t,this.metadata("GAMMALN"),l.gammaln)}gammainv(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA.INV"),l.gamma.inv)}gauss(e,t){return this.runFunction(e.args,t,this.metadata("GAUSS"),e=>l.normal.cdf(e,0,1)-.5)}betadist(e,t){return this.runFunction(e.args,t,this.metadata("BETA.DIST"),(e,t,r,n,i,o)=>e<=i?new s.CellError(s.ErrorType.NUM,a.ErrorMessage.ValueSmall):o<=e?new s.CellError(s.ErrorType.NUM,a.ErrorMessage.ValueLarge):(e=(e-i)/(o-i),n?l.beta.cdf(e,t,r):l.beta.pdf(e,t,r)))}betainv(e,t){return this.runFunction(e.args,t,this.metadata("BETA.INV"),(e,t,r,n,i)=>i<=n?new s.CellError(s.ErrorType.NUM,a.ErrorMessage.WrongOrder):l.beta.inv(e,t,r)*(i-n)+n)}binomialdist(e,t){return this.runFunction(e.args,t,this.metadata("BINOM.DIST"),(e,t,r,n)=>t<e?new s.CellError(s.ErrorType.NUM,a.ErrorMessage.WrongOrder):(e=Math.trunc(e),t=Math.trunc(t),n?l.binomial.cdf(e,t,r):l.binomial.pdf(e,t,r)))}binomialinv(e,t){return this.runFunction(e.args,t,this.metadata("BINOM.INV"),(e,t,r)=>{let n=-1,i=e=Math.trunc(e);for(;i>n+1;){var o=Math.trunc((n+i)/2);l.binomial.cdf(o,e,t)>=r?i=o:n=o}return i})}besselifn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELI"),(e,t)=>(0,n.besseli)(e,Math.trunc(t)))}besseljfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELJ"),(e,t)=>(0,n.besselj)(e,Math.trunc(t)))}besselkfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELK"),(e,t)=>(0,n.besselk)(e,Math.trunc(t)))}besselyfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELY"),(e,t)=>(0,n.bessely)(e,Math.trunc(t)))}chisqdist(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.DIST"),(e,t,r)=>(t=Math.trunc(t),r?l.chisquare.cdf(e,t):l.chisquare.pdf(e,t)))}chisqdistrt(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.DIST.RT"),(e,t)=>1-l.chisquare.cdf(e,Math.trunc(t)))}chisqinv(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.INV"),(e,t)=>l.chisquare.inv(e,Math.trunc(t)))}chisqinvrt(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.INV.RT"),(e,t)=>l.chisquare.inv(1-e,Math.trunc(t)))}fdist(e,t){return this.runFunction(e.args,t,this.metadata("F.DIST"),(e,t,r,n)=>(t=Math.trunc(t),r=Math.trunc(r),n?l.centralF.cdf(e,t,r):l.centralF.pdf(e,t,r)))}fdistrt(e,t){return this.runFunction(e.args,t,this.metadata("F.DIST.RT"),(e,t,r)=>1-l.centralF.cdf(e,Math.trunc(t),Math.trunc(r)))}finv(e,t){return this.runFunction(e.args,t,this.metadata("F.INV"),(e,t,r)=>l.centralF.inv(e,Math.trunc(t),Math.trunc(r)))}finvrt(e,t){return this.runFunction(e.args,t,this.metadata("F.INV.RT"),(e,t,r)=>l.centralF.inv(1-e,Math.trunc(t),Math.trunc(r)))}weibulldist(e,t){return this.runFunction(e.args,t,this.metadata("WEIBULL.DIST"),(e,t,r,n)=>n?l.weibull.cdf(e,r,t):l.weibull.pdf(e,r,t))}poissondist(e,t){return this.runFunction(e.args,t,this.metadata("POISSON.DIST"),(e,t,r)=>(e=Math.trunc(e),r?l.poisson.cdf(e,t):l.poisson.pdf(e,t)))}hypgeomdist(e,t){return this.runFunction(e.args,t,this.metadata("HYPGEOM.DIST"),(e,t,r,n,i)=>t<e||r<e||n<t||n<r||e+n<r+t?new s.CellError(s.ErrorType.NUM,a.ErrorMessage.ValueLarge):(e=Math.trunc(e),t=Math.trunc(t),r=Math.trunc(r),n=Math.trunc(n),i?l.hypgeom.cdf(e,n,r,t):l.hypgeom.pdf(e,n,r,t)))}tdist(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST"),(e,t,r)=>(t=Math.trunc(t),r?l.studentt.cdf(e,t):l.studentt.pdf(e,t)))}tdist2t(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST.2T"),(e,t)=>2*(1-l.studentt.cdf(e,Math.trunc(t))))}tdistrt(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST.RT"),(e,t)=>1-l.studentt.cdf(e,Math.trunc(t)))}tdistold(e,t){return this.runFunction(e.args,t,this.metadata("TDIST"),(e,t,r)=>r*(1-l.studentt.cdf(e,Math.trunc(t))))}tinv(e,t){return this.runFunction(e.args,t,this.metadata("T.INV"),(e,t)=>l.studentt.inv(e,Math.trunc(t)))}tinv2t(e,t){return this.runFunction(e.args,t,this.metadata("T.INV.2T"),(e,t)=>l.studentt.inv(1-e/2,Math.trunc(t)))}lognormdist(e,t){return this.runFunction(e.args,t,this.metadata("LOGNORM.DIST"),(e,t,r,n)=>n?l.lognormal.cdf(e,t,r):l.lognormal.pdf(e,t,r))}lognorminv(e,t){return this.runFunction(e.args,t,this.metadata("LOGNORM.INV"),(e,t,r)=>l.lognormal.inv(e,t,r))}normdist(e,t){return this.runFunction(e.args,t,this.metadata("NORM.DIST"),(e,t,r,n)=>n?l.normal.cdf(e,t,r):l.normal.pdf(e,t,r))}norminv(e,t){return this.runFunction(e.args,t,this.metadata("NORM.INV"),(e,t,r)=>l.normal.inv(e,t,r))}normsdist(e,t){return this.runFunction(e.args,t,this.metadata("NORM.S.DIST"),(e,t)=>t?l.normal.cdf(e,0,1):l.normal.pdf(e,0,1))}normsinv(e,t){return this.runFunction(e.args,t,this.metadata("NORM.S.INV"),e=>l.normal.inv(e,0,1))}phi(e,t){return this.runFunction(e.args,t,this.metadata("PHI"),e=>l.normal.pdf(e,0,1))}negbinomdist(e,t){return this.runFunction(e.args,t,this.metadata("NEGBINOM.DIST"),(e,t,r,n)=>(e=Math.trunc(e),t=Math.trunc(t),n?l.negbin.cdf(e,t,r):l.negbin.pdf(e,t,r)))}confidencenorm(e,t){return this.runFunction(e.args,t,this.metadata("CONFIDENCE.NORM"),(e,t,r)=>(0,l.normalci)(1,e,t,Math.trunc(r))[1]-1)}confidencet(e,t){return this.runFunction(e.args,t,this.metadata("CONFIDENCE.T"),(e,t,r)=>1===(r=Math.trunc(r))?new s.CellError(s.ErrorType.DIV_BY_ZERO):(0,l.tci)(1,e,t,r)[1]-1)}standardize(e,t){return this.runFunction(e.args,t,this.metadata("STANDARDIZE"),(e,t,r)=>(e-t)/r)}}i.implementedFunctions={ERF:{method:"erf",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,optionalArg:!0}]},ERFC:{method:"erfc",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},"EXPON.DIST":{method:"expondist",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.BOOLEAN}]},FISHER:{method:"fisher",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:-1,lessThan:1}]},FISHERINV:{method:"fisherinv",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},GAMMA:{method:"gamma",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},"GAMMA.DIST":{method:"gammadist",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.BOOLEAN}]},GAMMALN:{method:"gammaln",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0}]},"GAMMA.INV":{method:"gammainv",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0,lessThan:1},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0}]},GAUSS:{method:"gauss",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},"BETA.DIST":{method:"betadist",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.BOOLEAN},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:1}]},"BETA.INV":{method:"betainv",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0,maxValue:1},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:1}]},"BINOM.DIST":{method:"binomialdist",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0,maxValue:1},{argumentType:t.FunctionArgumentType.BOOLEAN}]},"BINOM.INV":{method:"binomialinv",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0,maxValue:1},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0,lessThan:1}]},BESSELI:{method:"besselifn",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0}]},BESSELJ:{method:"besseljfn",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0}]},BESSELK:{method:"besselkfn",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0}]},BESSELY:{method:"besselyfn",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0}]},"CHISQ.DIST":{method:"chisqdist",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1,maxValue:1e10},{argumentType:t.FunctionArgumentType.BOOLEAN}]},"CHISQ.DIST.RT":{method:"chisqdistrt",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV":{method:"chisqinv",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0,maxValue:1},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV.RT":{method:"chisqinvrt",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0,maxValue:1},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1}]},"F.DIST":{method:"fdist",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1},{argumentType:t.FunctionArgumentType.BOOLEAN}]},"F.DIST.RT":{method:"fdistrt",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1}]},"F.INV":{method:"finv",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0,maxValue:1},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1}]},"F.INV.RT":{method:"finvrt",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0,maxValue:1},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1}]},"WEIBULL.DIST":{method:"weibulldist",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.BOOLEAN}]},"POISSON.DIST":{method:"poissondist",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.BOOLEAN}]},"HYPGEOM.DIST":{method:"hypgeomdist",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.BOOLEAN}]},"T.DIST":{method:"tdist",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1},{argumentType:t.FunctionArgumentType.BOOLEAN}]},"T.DIST.2T":{method:"tdist2t",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1}]},"T.DIST.RT":{method:"tdistrt",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1}]},TDIST:{method:"tdistold",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1},{argumentType:t.FunctionArgumentType.INTEGER,minValue:1,maxValue:2}]},"T.INV":{method:"tinv",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0,lessThan:1},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1}]},"T.INV.2T":{method:"tinv2t",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0,maxValue:1},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1}]},"LOGNORM.DIST":{method:"lognormdist",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.BOOLEAN}]},"LOGNORM.INV":{method:"lognorminv",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0,lessThan:1},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0}]},"NORM.DIST":{method:"normdist",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.BOOLEAN}]},"NORM.INV":{method:"norminv",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0,lessThan:1},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0}]},"NORM.S.DIST":{method:"normsdist",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.BOOLEAN}]},"NORM.S.INV":{method:"normsinv",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0,lessThan:1}]},PHI:{method:"phi",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},"NEGBINOM.DIST":{method:"negbinomdist",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0,maxValue:1},{argumentType:t.FunctionArgumentType.BOOLEAN}]},"CONFIDENCE.NORM":{method:"confidencenorm",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0,lessThan:1},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1}]},"CONFIDENCE.T":{method:"confidencet",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0,lessThan:1},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1}]},STANDARDIZE:{method:"standardize",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0}]}},i.aliases={NEGBINOMDIST:"NEGBINOM.DIST",EXPONDIST:"EXPON.DIST",BETADIST:"BETA.DIST",NORMDIST:"NORM.DIST",NORMINV:"NORM.INV",NORMSDIST:"NORM.S.DIST",NORMSINV:"NORM.S.INV",LOGNORMDIST:"LOGNORM.DIST",LOGINV:"LOGNORM.INV",TINV:"T.INV.2T",HYPGEOMDIST:"HYPGEOM.DIST",POISSON:"POISSON.DIST",WEIBULL:"WEIBULL.DIST",FINV:"F.INV.RT",FDIST:"F.DIST.RT",CHIDIST:"CHISQ.DIST.RT",CHIINV:"CHISQ.INV.RT",GAMMADIST:"GAMMA.DIST","GAMMALN.PRECISE":"GAMMALN",GAMMAINV:"GAMMA.INV",BETAINV:"BETA.INV",BINOMDIST:"BINOM.DIST",CONFIDENCE:"CONFIDENCE.NORM",CRITBINOM:"BINOM.INV",WEIBULLDIST:"WEIBULL.DIST",TINV2T:"T.INV.2T",TDISTRT:"T.DIST.RT",TDIST2T:"T.DIST.2T",FINVRT:"F.INV.RT",FDISTRT:"F.DIST.RT",CHIDISTRT:"CHISQ.DIST.RT",CHIINVRT:"CHISQ.INV.RT",LOGNORMINV:"LOGNORM.INV",POISSONDIST:"POISSON.DIST"}},(L,e,t)=>{"use strict";t.r(e),t.d(e,{besseli:()=>P,besselj:()=>m,besselk:()=>F,bessely:()=>D});var d=Math;function u(e,t){for(var r=0,n=0;r<e.length;++r)n=t*n+e[r];return n}function h(e,t,r,n,i){if(0===t)return r;if(1===t)return n;for(var o=2/e,s=n,a=1;a<t;++a)s=n*a*o+i*r,r=n,n=s;return s}function r(r,n,e,i,o){return function(e,t){if(i){if(0===e)return 1==i?-1/0:1/0;if(e<0)return NaN}return 0===t?r(e):1===t?n(e):t<0?NaN:h(e,t|=0,r(e),n(e),o)}}o=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),s=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),a=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),l=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34935152e-8].reverse(),c=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),p=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),f=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),g=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();var o,s,a,l,c,p,f,g,m=function e(t,r){if(r=Math.round(r),!isFinite(t))return isNaN(t)?t:0;if(r<0)return(r%2?-1:1)*e(t,-r);if(t<0)return(r%2?-1:1)*e(-t,r);if(0===r)return y(t);if(1===r)return v(t);if(0===t)return 0;var n=0;if(r<t)n=h(t,r,y(t),v(t),-1);else{for(var i,o=!1,s=0,a=0,l=1,c=2/t,u=2*d.floor((r+d.floor(d.sqrt(40*r)))/2);0<u;u--)i=u*c*l-s,s=l,1e10<d.abs(l=i)&&(l*=1e-10,s*=1e-10,n*=1e-10,a*=1e-10),o&&(a+=l),o=!o,u==r&&(n=s);n/=a=2*a-l}return n};function y(e){var t,r=0,n=0,i=e*e;return e<8?(r=u(o,i))/(n=u(s,i)):(t=e-.785398164,r=u(a,i=64/i),n=u(l,i),d.sqrt(.636619772/e)*(d.cos(t)*r-d.sin(t)*n*8/e))}function v(e){var t=0,r=0,n=0,i=e*e,o=d.abs(e)-2.356194491;return Math.abs(e)<8?t=(r=e*u(c,i))/(n=u(p,i)):(r=u(f,i=64/i),n=u(g,i),t=d.sqrt(.636619772/d.abs(e))*(d.cos(o)*r-d.sin(o)*n*8/d.abs(e)),e<0&&(t=-t)),t}b=.636619772,w=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),C=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),E=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),T=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34945152e-8].reverse(),S=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),_=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),x=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),R=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();var b,w,C,E,T,S,_,x,R,A,N,O,I,n,i,M,k,D=r(function(e){var t=0,r=0,n=e*e,i=e-.785398164;return e<8?(t=u(w,n))/(r=u(C,n))+b*m(e,0)*d.log(e):(t=u(E,n=64/n),r=u(T,n),d.sqrt(b/e)*(d.sin(i)*t+d.cos(i)*r*8/e))},function(e){var t=0,r=0,n=e*e,i=e-2.356194491;return e<8?(t=e*u(S,n))/(r=u(_,n))+b*(m(e,1)*d.log(e)-1/e):(t=u(x,n=64/n),r=u(R,n),d.sqrt(b/e)*(d.sin(i)*t+d.cos(i)*r*8/e))},0,1,-1),P=(A=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),N=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),O=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),I=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function e(t,r){if(0===(r=Math.round(r)))return(n=t)<=3.75?u(A,n*n/14.0625):d.exp(d.abs(n))/d.sqrt(d.abs(n))*u(N,3.75/d.abs(n));var n;if(1===r)return(n=t)<3.75?n*u(O,n*n/14.0625):(n<0?-1:1)*d.exp(d.abs(n))/d.sqrt(d.abs(n))*u(I,3.75/d.abs(n));if(r<0)return NaN;if(0===d.abs(t))return 0;if(t==1/0)return 1/0;for(var i,o=0,s=2/d.abs(t),a=0,l=1,c=2*d.round((r+d.round(d.sqrt(40*r)))/2);0<c;c--)i=c*s*l+a,a=l,1e10<d.abs(l=i)&&(l*=1e-10,a*=1e-10,o*=1e-10),c==r&&(o=a);return o*=e(t,0)/l,t<0&&r%2?-o:o}),F=(n=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),i=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),M=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),k=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse(),r(function(e){return e<=2?-d.log(e/2)*P(e,0)+u(n,e*e/4):d.exp(-e)/d.sqrt(e)*u(i,2/e)},function(e){return e<=2?d.log(e/2)*P(e,1)+1/e*u(M,e*e/4):d.exp(-e)/d.sqrt(e)*u(k,2/e)},0,2,1))},(L,e,t)=>{"use strict";function n(e){var t,r,n,i=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18];let o=i.length-1,s=!1,a=0,l=0;if(0===e)return 0;for(e<0&&(e=-e,s=!0),t=4*(n=2/(2+e))-2;0<o;o--)a=t*(r=a)-l+i[o],l=r;return n=n*Math.exp(-e*e+.5*(i[0]+t*a)-l),s?n-1:1-n}function s(e){return 1-n(e)}function i(e){let t=0,r,n,i,o;if(2<=e)return-100;if(e<=0)return 100;for(o=e<1?e:2-e,i=Math.sqrt(-2*Math.log(o/2)),r=-.70711*((2.30753+.27061*i)/(1+i*(.99229+.04481*i))-i);t<2;t++)n=s(r)-o,r+=n/(1.1283791670955126*Math.exp(-r*r)-r*n);return e<1?r:-r}t.r(e),t.d(e,{beta:()=>d,binomial:()=>v,centralF:()=>S,chisquare:()=>T,corrcoeff:()=>function(e,t){return P(e,t)/D(e,1)/D(t,1)},covariance:()=>P,erf:()=>n,erfc:()=>s,exponential:()=>r,factorial:()=>E,factorialln:()=>C,gamma:()=>a,gammafn:()=>o,gammaln:()=>p,geomean:()=>function(e){return Math.pow(function(e){var t=1,r=e.length;for(;0<=--r;)t*=e[r];return t}(e),1/e.length)},hypgeom:()=>R,lognormal:()=>F,mean:()=>I,negbin:()=>N,normal:()=>c,normalci:()=>function(){var e,t=[].slice.call(arguments),r=new Array(2);e=4===t.length?Math.abs(c.inv(t[1]/2,0,1)*t[2]/Math.sqrt(t[3])):Math.abs(c.inv(t[1]/2,0,1)*D(t[2])/Math.sqrt(t[2].length));return r[0]=t[0]-e,r[1]=t[0]+e,r},poisson:()=>x,stdev:()=>D,studentt:()=>A,sumsqerr:()=>M,tci:()=>function(){var e,t=[].slice.call(arguments),r=new Array(2);e=4===t.length?Math.abs(A.inv(t[1]/2,t[3]-1)*t[2]/Math.sqrt(t[3])):Math.abs(A.inv(t[1]/2,t[2].length-1)*D(t[2],!0)/Math.sqrt(t[2].length));return r[0]=t[0]-e,r[1]=t[0]+e,r},variance:()=>k,weibull:()=>_});const r={pdf:(e,t)=>e<0?0:t*Math.exp(-t*e),cdf:(e,t)=>e<0?0:1-Math.exp(-t*e)};function o(e){var t=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],r=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535];let n=!1,i=0,o=0,s=0,a=e,l,c,u,d;if(171.6243769536076<e)return 1/0;if(a<=0){if(!(d=a%1))return 1/0;n=(1&a?-1:1)*Math.PI/Math.sin(Math.PI*d),a=1-a}for(u=a,c=a<1?a++:(a-=i=(0|a)-1)-1,l=0;l<8;++l)s=(s+t[l])*c,o=o*c+r[l];if(d=s/o+1,u<a)d/=u;else if(u>a)for(l=0;l<i;++l)d*=a,a++;return d=n?n/d:d}const a={pdf:function(e,t,r){return e<0?0:0===e&&1===t?1/r:Math.exp((t-1)*Math.log(e)-e/r-p(t)-t*Math.log(r))},cdf:function(e,t,r){return e<0?0:u(t,e/r)},inv:function(e,t,r){return l(e,t)*r}};function p(e){let t=0;var r=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];let n=1.000000000190015,i,o,s;for(s=(o=i=e)+5.5,s-=(i+.5)*Math.log(s);t<6;t++)n+=r[t]/++o;return Math.log(2.5066282746310007*n/i)-s}function u(e,t){var r=p(e);let n=e,i=1/e,o=i,s=t+1-e,a=1/1e-30,l=1/s,c=l,u=1;var d,h=-~(8.5*Math.log(1<=e?e:1/e)+.4*e+17);if(t<0||e<=0)return NaN;if(t<e+1){for(;u<=h;u++)i+=o*=t/++n;return i*Math.exp(-t+e*Math.log(t)-r)}for(;u<=h;u++)d=-u*(u-e),s+=2,l=d*l+s,a=s+d/a,l=1/l,c*=l*a;return 1-c*Math.exp(-t+e*Math.log(t)-r)}function l(e,t){let r=0;var n=t-1,i=p(t);let o,s,a,l,c;if(1<=e)return Math.max(100,t+100*Math.sqrt(t));if(e<=0)return 0;for(o=1<t?(l=Math.log(n),c=Math.exp(n*(l-1)-i),s=Math.sqrt(-2*Math.log(e<.5?e:1-e)),o=(2.30753+.27061*s)/(1+s*(.99229+.04481*s))-s,e<.5&&(o=-o),Math.max(.001,t*Math.pow(1-1/(9*t)-o/(3*Math.sqrt(t)),3))):e<(s=1-t*(.253+.12*t))?Math.pow(e/s,1/t):1-Math.log(1-(e-s)/(1-s));r<12;r++){if(o<=0)return 0;if(a=(u(t,o)-e)/(s=1<t?c*Math.exp(-(o-n)+n*(Math.log(o)-l)):Math.exp(-o+n*Math.log(o)-i)),(o-=s=a/(1-.5*Math.min(1,a*((t-1)/o-1))))<=0&&(o=.5*(o+s)),Math.abs(s)<1e-8*o)break}return o}const c={pdf:function(e,t,r){return Math.exp(-.5*Math.log(2*Math.PI)-Math.log(r)-Math.pow(e-t,2)/(2*r*r))},cdf:function(e,t,r){return.5*(1+n((e-t)/Math.sqrt(2*r*r)))},inv:function(e,t,r){return-1.4142135623730951*r*i(2*e)+t}},d={pdf:function(e,t,r){return 1<e||e<0?0:1==t&&1==r?1:t<512&&r<512?Math.pow(e,t-1)*Math.pow(1-e,r-1)/h(t,r):Math.exp((t-1)*Math.log(e)+(r-1)*Math.log(1-e)-f(t,r))},cdf:function(e,t,r){return 1<e||e<0?+(1<e):m(e,t,r)},inv:g};function h(e,t){if(!(e<=0||t<=0))return 170<e+t?Math.exp(f(e,t)):o(e)*o(t)/o(e+t)}function f(e,t){return p(e)+p(t)-p(e+t)}function g(e,t,r){var n,i,o,s,a,l,c,u=t-1,d=r-1,h=0;if(e<=0)return 0;if(1<=e)return 1;for(s=1<=t&&1<=r?(s=(2.30753+.27061*(i=Math.sqrt(-2*Math.log(e<.5?e:1-e))))/(1+i*(.99229+.04481*i))-i,l=((s=e<.5?-s:s)*s-3)/6,a=2/(1/(2*t-1)+1/(2*r-1)),l=s*Math.sqrt(l+a)/a-(1/(2*r-1)-1/(2*t-1))*(l+5/6-2/(3*a)),t/(t+r*Math.exp(2*l))):(a=Math.log(t/(t+r)),n=Math.log(r/(t+r)),e<(i=Math.exp(t*a)/t)/(l=i+(o=Math.exp(r*n)/r))?Math.pow(t*l*e,1/t):1-Math.pow(r*l*(1-e),1/r)),c=-p(t)-p(r)+p(t+r);h<10;h++){if(0===s||1===s)return s;if(1<=(s=(s-=i=(o=(m(s,t,r)-e)/(i=Math.exp(u*Math.log(s)+d*Math.log(1-s)+c)))/(1-.5*Math.min(1,o*(u/s-d/(1-s)))))<=0?.5*(s+i):s)&&(s=.5*(s+i+1)),Math.abs(i)<1e-8*s&&0<h)break}return s}function m(e,t,r){var n=0===e||1===e?0:Math.exp(p(t+r)-p(t)-p(r)+t*Math.log(e)+r*Math.log(1-e));return!(e<0||1<e)&&(e<(t+1)/(t+r+2)?n*y(e,t,r)/t:1-n*y(1-e,r,t)/r)}function y(e,t,r){for(var n,i,o=1e-30,s=1,a=t+r,l=t+1,c=t-1,u=1,d=1-a*e/l,h=d=1/(d=Math.abs(d)<o?o:d);s<=100&&(d=1+(n=s*(r-s)*e/((c+(i=2*s))*(t+i)))*d,u=1+n/u,h*=(d=1/(d=Math.abs(d)<o?o:d))*(u=Math.abs(u)<o?o:u),d=1+(n=-(t+s)*(a+s)*e/((t+i)*(l+i)))*d,u=1+n/u,h*=i=(d=1/(d=Math.abs(d)<o?o:d))*(u=Math.abs(u)<o?o:u),!(Math.abs(i-1)<3e-7));s++);return h}const v={pdf:function(e,t,r){return 0===r||1===r?t*r===e?1:0:w(t,e)*Math.pow(r,e)*Math.pow(1-r,t-e)},cdf:function(e,t,r){var n,i;return e<0?0:t<=e?1:r<0||1<r||t<=0?NaN:(r=r,e=(n=(e=Math.floor(e))+1)+(t=t-e),i=Math.exp(p(e)-p(t)-p(n)+n*Math.log(r)+t*Math.log(1-r)),e=r<(n+1)/(e+2)?i*b(r,n,t,1e-10):1-i*b(1-r,t,n,1e-10),Math.round(1e10*(1-e))/1e10)}};function b(e,t,r,n){for(var i,o=0,s=1,a=1,l=1,c=0,u=0;Math.abs((a-u)/a)>n;)s=l+(i=-(t+c)*(t+r+c)*e/(t+2*c)/(t+2*c+1))*s,a=(o=(u=a)+i*o)+(i=(c+=1)*(r-c)*e/(t+2*c-1)/(t+2*c))*a,o/=l=s+i*l,s/=l,a/=l,l=1;return a/t}function w(e,t){return 170<e||170<t?Math.exp((n=t,C(r=e)-C(n)-C(r-n))):E(e)/E(t)/E(e-t);var r,n}function C(e){return e<0?NaN:p(e+1)}function E(e){return e<0?NaN:o(e+1)}const T={pdf:function(e,t){return e<0?0:0===e&&2===t?.5:Math.exp((t/2-1)*Math.log(e)-e/2-t/2*Math.log(2)-p(t/2))},cdf:function(e,t){return e<0?0:u(t/2,e/2)},inv:function(e,t){return 2*l(e,.5*t)}},S={pdf:function(e,t,r){var n;return e<0?0:t<=2?0===e&&t<2?1/0:0===e&&2===t?1:1/h(t/2,r/2)*Math.pow(t/r,t/2)*Math.pow(e,t/2-1)*Math.pow(1+t/r*e,-(t+r)/2):(n=t*e/(r+e*t),t*(r/(r+e*t))/2*v.pdf((t-2)/2,(t+r-2)/2,n))},cdf:function(e,t,r){return e<0?0:m(t*e/(t*e+r),t/2,r/2)},inv:function(e,t,r){return r/(t*(1/g(e,t/2,r/2)-1))}},_={pdf:function(e,t,r){return e<0||t<0||r<0?0:r/t*Math.pow(e/t,r-1)*Math.exp(-Math.pow(e/t,r))},cdf:function(e,t,r){return e<0?0:1-Math.exp(-Math.pow(e/t,r))}},x={pdf:function(e,t){return t<0||e%1!=0||e<0?0:Math.pow(t,e)*Math.exp(-t)/E(e)},cdf:function(e,t){var r=0;if(e<0)return 0;for(var n=0;r<=e;r++)n+=x.pdf(r,t);return n}},R={pdf:function(e,t,r,n){if(e<0||e<r-(t-n))return 0;if(n<e||r<e)return 0;if(t<2*r)return t<2*n?R.pdf(t-r-n+e,t,t-r,t-n):R.pdf(n-e,t,t-r,n);if(t<2*n)return R.pdf(r-e,t,r,t-n);if(r<n)return R.pdf(e,t,n,r);for(var i=1,o=0,s=0;s<e;s++){for(;1<i&&o<n;)i*=1-r/(t-o),o++;i*=(n-s)*(r-s)/((s+1)*(t-r-n+s+1))}for(;o<n;o++)i*=1-r/(t-o);return Math.min(1,Math.max(0,i))},cdf:function e(t,r,n,i){if(t<0||t<n-(r-i))return 0;if(i<=t||n<=t)return 1;if(r<2*n)return r<2*i?e(r-n-i+t,r,r-n,r-i):1-R.cdf(i-t-1,r,r-n,i);if(r<2*i)return 1-R.cdf(n-t-1,r,n,r-i);if(n<i)return R.cdf(t,r,i,n);for(var o=1,s=1,a=0,l=0;l<t;l++){for(;1<o&&a<i;){var c=1-n/(r-a);s*=c,o*=c,a++}o+=s*=(i-l)*(n-l)/((l+1)*(r-n-i+l+1))}for(;a<i;a++)o*=1-n/(r-a);return Math.min(1,Math.max(0,o))}},A={pdf:function(e,t){return t=1e100<t?1e100:t,1/(Math.sqrt(t)*h(.5,t/2))*Math.pow(1+e*e/t,-(t+1)/2)},cdf:function(e,t){var r=t/2;return m((e+Math.sqrt(e*e+t))/(2*Math.sqrt(e*e+t)),r,r)},inv:function(e,t){var r=g(2*Math.min(e,1-e),.5*t,.5),r=Math.sqrt(t*(1-r)/r);return.5<e?r:-r}},F={pdf:function(e,t,r){return e<=0?0:Math.exp(-Math.log(e)-.5*Math.log(2*Math.PI)-Math.log(r)-Math.pow(Math.log(e)-t,2)/(2*r*r))},cdf:function(e,t,r){return e<0?0:.5+.5*n((Math.log(e)-t)/Math.sqrt(2*r*r))},inv:function(e,t,r){return Math.exp(-1.4142135623730951*r*i(2*e)+t)}},N={pdf:function(e,t,r){return e===e>>>0&&(e<0?0:w(e+t-1,t-1)*Math.pow(1-r,e)*Math.pow(r,t))},cdf:function(e,t,r){var n=0,i=0;if(e<0)return 0;for(;i<=e;i++)n+=N.pdf(i,t,r);return n}};function O(e){for(var t=0,r=e.length;0<=--r;)t+=e[r];return t}function I(e){return O(e)/e.length}function M(e){for(var t,r=I(e),n=0,i=e.length;0<=--i;)n+=(t=e[i]-r)*t;return n}function k(e,t){return M(e)/(e.length-(t?1:0))}function D(e,t){return Math.sqrt(k(e,t))}function P(e,t){for(var r=I(e),n=I(t),i=e.length,o=new Array(i),s=0;s<i;s++)o[s]=(e[s]-r)*(t[s]-n);return O(o)/(i-1)}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{MathPlugin:()=>n});var l=r(3),c=r(61),t=r(97);class n extends t.FunctionPlugin{fact(e,t){return this.runFunction(e.args,t,this.metadata("FACT"),t=>{t=Math.trunc(t);let r=1;for(let e=1;e<=t;e++)r*=e;return r})}factdouble(e,t){return this.runFunction(e.args,t,this.metadata("FACTDOUBLE"),t=>{let r=1;for(let e=t=Math.trunc(t);1<=e;e-=2)r*=e;return r})}combin(e,t){return this.runFunction(e.args,t,this.metadata("COMBIN"),(e,t)=>e<t?new l.CellError(l.ErrorType.NUM,c.ErrorMessage.WrongOrder):i(e=Math.trunc(e),t=Math.trunc(t)))}combina(e,t){return this.runFunction(e.args,t,this.metadata("COMBINA"),(e,t)=>1030<=(e=Math.trunc(e))+(t=Math.trunc(t))-1?new l.CellError(l.ErrorType.NUM,c.ErrorMessage.ValueLarge):0===e&&0===t?1:i(e+t-1,t))}gcd(e,t){return this.runFunction(e.args,t,this.metadata("GCD"),(...e)=>{e=this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(e);if(e instanceof l.CellError)return e;let t=0;for(const r of e){if(r<0)return new l.CellError(l.ErrorType.NUM,c.ErrorMessage.ValueSmall);t=o(t,Math.trunc(r))}return t>Number.MAX_SAFE_INTEGER?new l.CellError(l.ErrorType.NUM,c.ErrorMessage.ValueLarge):t})}lcm(e,t){return this.runFunction(e.args,t,this.metadata("LCM"),(...e)=>{var t,r,e=this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(e);if(e instanceof l.CellError)return e;let n=1;for(const i of e){if(i<0)return new l.CellError(l.ErrorType.NUM,c.ErrorMessage.ValueSmall);n=(t=n,r=Math.trunc(i),0!==t&&0!==r?t*(r/o(t,r)):0)}return n>Number.MAX_SAFE_INTEGER?new l.CellError(l.ErrorType.NUM,c.ErrorMessage.ValueLarge):n})}mround(e,t){return this.runFunction(e.args,t,this.metadata("MROUND"),(e,t)=>0===t?0:0<e&&t<0||e<0&&0<t?new l.CellError(l.ErrorType.NUM,c.ErrorMessage.DistinctSigns):Math.round(e/t)*t)}multinomial(e,t){return this.runFunction(e.args,t,this.metadata("MULTINOMIAL"),(...e)=>{let t=0,r=1;for(var n of e){if(n<0)return new l.CellError(l.ErrorType.NUM,c.ErrorMessage.ValueSmall);n=Math.trunc(n);for(let e=1;e<=n;e++)r*=(t+e)/e;t+=n}return Math.round(r)})}quotient(e,t){return this.runFunction(e.args,t,this.metadata("QUOTIENT"),(e,t)=>0===t?new l.CellError(l.ErrorType.DIV_BY_ZERO):Math.trunc(e/t))}seriessum(e,t){return this.runFunction(e.args,t,this.metadata("SERIESSUM"),(e,t,r,n)=>{n=this.arithmeticHelper.manyToOnlyNumbersDropNulls(n.valuesFromTopLeftCorner());if(n instanceof l.CellError)return n;let i=0;n.reverse();for(const o of n)i=(i*=Math.pow(e,r))+o;return i*Math.pow(e,t)})}sign(e,t){return this.runFunction(e.args,t,this.metadata("SIGN"),e=>0<e?1:e<0?-1:0)}sumx2my2(e,t){return this.runFunction(e.args,t,this.metadata("SUMX2MY2"),(e,t)=>{var r=e.valuesFromTopLeftCorner(),n=t.valuesFromTopLeftCorner();if(r.length!==n.length)return new l.CellError(l.ErrorType.NA,c.ErrorMessage.EqualLength);var i=r.length;let o=0;for(let e=0;e<i;e++){var s=r[e],a=n[e];if(s instanceof l.CellError)return s;if(a instanceof l.CellError)return a;"number"==typeof s&&"number"==typeof a&&(o+=Math.pow(s,2)-Math.pow(a,2))}return o})}sumx2py2(e,t){return this.runFunction(e.args,t,this.metadata("SUMX2PY2"),(e,t)=>{var r=e.valuesFromTopLeftCorner(),n=t.valuesFromTopLeftCorner();if(r.length!==n.length)return new l.CellError(l.ErrorType.NA,c.ErrorMessage.EqualLength);var i=r.length;let o=0;for(let e=0;e<i;e++){var s=r[e],a=n[e];if(s instanceof l.CellError)return s;if(a instanceof l.CellError)return a;"number"==typeof s&&"number"==typeof a&&(o+=Math.pow(s,2)+Math.pow(a,2))}return o})}sumxmy2(e,t){return this.runFunction(e.args,t,this.metadata("SUMXMY2"),(e,t)=>{var r=e.valuesFromTopLeftCorner(),n=t.valuesFromTopLeftCorner();if(r.length!==n.length)return new l.CellError(l.ErrorType.NA,c.ErrorMessage.EqualLength);var i=r.length;let o=0;for(let e=0;e<i;e++){var s=r[e],a=n[e];if(s instanceof l.CellError)return s;if(a instanceof l.CellError)return a;"number"==typeof s&&"number"==typeof a&&(o+=Math.pow(s-a,2))}return o})}}function i(t,r){t<2*r&&(r=t-r);let n=1;for(let e=1;e<=r;e++)n*=(t-r+e)/e;return Math.round(n)}function o(e,t){for(e<t&&([e,t]=[t,e]);0<t;)[e,t]=[t,e%t];return e}n.implementedFunctions={FACT:{method:"fact",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0,maxValue:170}]},FACTDOUBLE:{method:"factdouble",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0,maxValue:288}]},COMBIN:{method:"combin",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0,lessThan:1030},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0}]},COMBINA:{method:"combina",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0}]},GCD:{method:"gcd",parameters:[{argumentType:t.FunctionArgumentType.ANY}],repeatLastArgs:1},LCM:{method:"lcm",parameters:[{argumentType:t.FunctionArgumentType.ANY}],repeatLastArgs:1},MROUND:{method:"mround",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER}]},MULTINOMIAL:{method:"multinomial",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}],repeatLastArgs:1,expandRanges:!0},QUOTIENT:{method:"quotient",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER}]},SERIESSUM:{method:"seriessum",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.RANGE}]},SIGN:{method:"sign",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},SUMX2MY2:{method:"sumx2my2",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.RANGE}]},SUMX2PY2:{method:"sumx2py2",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.RANGE}]},SUMXMY2:{method:"sumxmy2",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.RANGE}]}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{ComplexPlugin:()=>i});var a=r(3),n=r(61),l=r(98),t=r(97);class i extends t.FunctionPlugin{complex(e,t){return this.runFunction(e.args,t,this.metadata("COMPLEX"),(e,t,r)=>"i"!==r&&"j"!==r?new a.CellError(a.ErrorType.VALUE,n.ErrorMessage.ShouldBeIorJ):(0,l.coerceComplexToString)([e,t],r))}imabs(e,t){return this.runFunction(e.args,t,this.metadata("IMABS"),f)}imaginary(e,t){return this.runFunction(e.args,t,this.metadata("IMAGINARY"),([,e])=>e)}imreal(e,t){return this.runFunction(e.args,t,this.metadata("IMREAL"),([e])=>e)}imargument(e,t){return this.runFunction(e.args,t,this.metadata("IMARGUMENT"),([e,t])=>0===e&&0===t?new a.CellError(a.ErrorType.DIV_BY_ZERO):Math.atan2(t,e))}imconjugate(e,t){return this.runFunction(e.args,t,this.metadata("IMCONJUGATE"),([e,t])=>(0,l.coerceComplexToString)([e,-t]))}imcos(e,t){return this.runFunction(e.args,t,this.metadata("IMCOS"),e=>(0,l.coerceComplexToString)(c(e)))}imcosh(e,t){return this.runFunction(e.args,t,this.metadata("IMCOSH"),e=>(0,l.coerceComplexToString)(u(e)))}imcot(e,t){return this.runFunction(e.args,t,this.metadata("IMCOT"),e=>(0,l.coerceComplexToString)(s(c(e),d(e))))}imcsc(e,t){return this.runFunction(e.args,t,this.metadata("IMCSC"),e=>(0,l.coerceComplexToString)(s([1,0],d(e))))}imcsch(e,t){return this.runFunction(e.args,t,this.metadata("IMCSCH"),e=>(0,l.coerceComplexToString)(s([1,0],h(e))))}imsec(e,t){return this.runFunction(e.args,t,this.metadata("IMSEC"),e=>(0,l.coerceComplexToString)(s([1,0],c(e))))}imsech(e,t){return this.runFunction(e.args,t,this.metadata("IMSECH"),e=>(0,l.coerceComplexToString)(s([1,0],u(e))))}imsin(e,t){return this.runFunction(e.args,t,this.metadata("IMSIN"),e=>(0,l.coerceComplexToString)(d(e)))}imsinh(e,t){return this.runFunction(e.args,t,this.metadata("IMSINH"),e=>(0,l.coerceComplexToString)(h(e)))}imtan(e,t){return this.runFunction(e.args,t,this.metadata("IMTAN"),e=>(0,l.coerceComplexToString)(s(d(e),c(e))))}imdiv(e,t){return this.runFunction(e.args,t,this.metadata("IMDIV"),(e,t)=>(0,l.coerceComplexToString)(s(e,t)))}improduct(e,t){return this.runFunction(e.args,t,this.metadata("IMPRODUCT"),(...e)=>{e=this.arithmeticHelper.coerceComplexExactRanges(e);if(e instanceof a.CellError)return e;let t=[1,0];for(const r of e)t=o(t,r);return(0,l.coerceComplexToString)(t)})}imsum(e,t){return this.runFunction(e.args,t,this.metadata("IMSUM"),(...e)=>{var t,r,n,i,e=this.arithmeticHelper.coerceComplexExactRanges(e);if(e instanceof a.CellError)return e;let o=[0,0];for(const s of e)o=([[t,r],[n,i]]=[o,s],[t+n,r+i]);return(0,l.coerceComplexToString)(o)})}imsub(e,t){return this.runFunction(e.args,t,this.metadata("IMSUB"),(e,t)=>{return(0,l.coerceComplexToString)(([[e,t],[r,n]]=[e,t],[e-r,t-n]));var r,n})}imexp(e,t){return this.runFunction(e.args,t,this.metadata("IMEXP"),e=>(0,l.coerceComplexToString)(p(e)))}imln(e,t){return this.runFunction(e.args,t,this.metadata("IMLN"),e=>(0,l.coerceComplexToString)(g(e)))}imlog10(e,t){return this.runFunction(e.args,t,this.metadata("IMLOG10"),e=>{var[e,t]=g(e),r=Math.log(10);return(0,l.coerceComplexToString)([e/r,t/r])})}imlog2(e,t){return this.runFunction(e.args,t,this.metadata("IMLOG2"),e=>{var[e,t]=g(e),r=Math.log(2);return(0,l.coerceComplexToString)([e/r,t/r])})}impower(e,t){return this.runFunction(e.args,t,this.metadata("IMPOWER"),(e,t)=>(0,l.coerceComplexToString)(m(e,t)))}imsqrt(e,t){return this.runFunction(e.args,t,this.metadata("IMSQRT"),e=>(0,l.coerceComplexToString)(m(e,.5)))}}function o([e,t],[r,n]){return[e*r-t*n,e*n+r*t]}function s([e,t],[r,n]){var i=Math.pow(r,2)+Math.pow(n,2),[e,t]=o([e,t],[r,-n]);return[e/i,t/i]}function c([e,t]){return[Math.cos(e)*Math.cosh(t),-Math.sin(e)*Math.sinh(t)]}function u([e,t]){return[Math.cosh(e)*Math.cos(t),Math.sinh(e)*Math.sin(t)]}function d([e,t]){return[Math.sin(e)*Math.cosh(t),Math.cos(e)*Math.sinh(t)]}function h([e,t]){return[Math.sinh(e)*Math.cos(t),Math.cosh(e)*Math.sin(t)]}function p([e,t]){return[Math.exp(e)*Math.cos(t),Math.exp(e)*Math.sin(t)]}function f([e,t]){return Math.sqrt(e*e+t*t)}function g([e,t]){return[Math.log(f([e,t])),Math.atan2(t,e)]}function m(e,t){var[e,r]=g(e);return p([t*e,t*r])}i.implementedFunctions={COMPLEX:{method:"complex",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.STRING,defaultValue:"i"}]},IMABS:{method:"imabs",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX}]},IMAGINARY:{method:"imaginary",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX}]},IMREAL:{method:"imreal",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX}]},IMARGUMENT:{method:"imargument",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX}]},IMCONJUGATE:{method:"imconjugate",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX}]},IMCOS:{method:"imcos",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX}]},IMCOSH:{method:"imcosh",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX}]},IMCOT:{method:"imcot",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX}]},IMCSC:{method:"imcsc",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX}]},IMCSCH:{method:"imcsch",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX}]},IMSEC:{method:"imsec",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX}]},IMSECH:{method:"imsech",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX}]},IMSIN:{method:"imsin",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX}]},IMSINH:{method:"imsinh",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX}]},IMTAN:{method:"imtan",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX}]},IMDIV:{method:"imdiv",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX},{argumentType:t.FunctionArgumentType.COMPLEX}]},IMPRODUCT:{method:"improduct",parameters:[{argumentType:t.FunctionArgumentType.ANY}],repeatLastArgs:1},IMSUM:{method:"imsum",parameters:[{argumentType:t.FunctionArgumentType.ANY}],repeatLastArgs:1},IMSUB:{method:"imsub",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX},{argumentType:t.FunctionArgumentType.COMPLEX}]},IMEXP:{method:"imexp",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX}]},IMLN:{method:"imln",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX}]},IMLOG10:{method:"imlog10",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX}]},IMLOG2:{method:"imlog2",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX}]},IMPOWER:{method:"impower",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX},{argumentType:t.FunctionArgumentType.NUMBER}]},IMSQRT:{method:"imsqrt",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX}]}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{StatisticalAggregationPlugin:()=>n});var c=r(3),u=r(61),l=r(70),d=r(192),t=r(97);class n extends t.FunctionPlugin{avedev(e,t){return this.runFunction(e.args,t,this.metadata("AVEDEV"),(...e)=>{e=this.arithmeticHelper.coerceNumbersExactRanges(e);if(e instanceof c.CellError)return e;if(0===e.length)return new c.CellError(c.ErrorType.DIV_BY_ZERO);const r=(0,d.mean)(e);return e.reduce((e,t)=>e+Math.abs(t-r),0)/e.length})}devsq(e,t){return this.runFunction(e.args,t,this.metadata("DEVSQ"),(...e)=>{e=this.arithmeticHelper.coerceNumbersExactRanges(e);return e instanceof c.CellError?e:0===e.length?0:(0,d.sumsqerr)(e)})}geomean(e,t){return this.runFunction(e.args,t,this.metadata("GEOMEAN"),(...e)=>{e=this.arithmeticHelper.coerceNumbersExactRanges(e);if(e instanceof c.CellError)return e;if(0===e.length)return new c.CellError(c.ErrorType.NUM,u.ErrorMessage.OneValue);for(const t of e)if(t<=0)return new c.CellError(c.ErrorType.NUM,u.ErrorMessage.ValueSmall);return(0,d.geomean)(e)})}harmean(e,t){return this.runFunction(e.args,t,this.metadata("HARMEAN"),(...e)=>{e=this.arithmeticHelper.coerceNumbersExactRanges(e);if(e instanceof c.CellError)return e;if(0===e.length)return new c.CellError(c.ErrorType.NUM,u.ErrorMessage.OneValue);for(const t of e)if(t<=0)return new c.CellError(c.ErrorType.NUM,u.ErrorMessage.ValueSmall);return e.length/e.reduce((e,t)=>e+1/t,0)})}correl(e,t){return this.runFunction(e.args,t,this.metadata("CORREL"),(e,t)=>{return e.numberOfElements()!==t.numberOfElements()?new c.CellError(c.ErrorType.NA,u.ErrorMessage.EqualLength):(e=s(e,t))instanceof c.CellError?e:e[0].length<=1?new c.CellError(c.ErrorType.DIV_BY_ZERO,u.ErrorMessage.TwoValues):(0,d.corrcoeff)(e[0],e[1])})}rsq(e,t){return this.runFunction(e.args,t,this.metadata("RSQ"),(e,t)=>{return e.numberOfElements()!==t.numberOfElements()?new c.CellError(c.ErrorType.NA,u.ErrorMessage.EqualLength):(e=s(e,t))instanceof c.CellError?e:e[0].length<=1?new c.CellError(c.ErrorType.DIV_BY_ZERO,u.ErrorMessage.TwoValues):Math.pow((0,d.corrcoeff)(e[0],e[1]),2)})}covariancep(e,t){return this.runFunction(e.args,t,this.metadata("COVARIANCE.P"),(e,t)=>{return e.numberOfElements()!==t.numberOfElements()?new c.CellError(c.ErrorType.NA,u.ErrorMessage.EqualLength):(e=s(e,t))instanceof c.CellError?e:(t=e[0].length)<1?new c.CellError(c.ErrorType.DIV_BY_ZERO,u.ErrorMessage.OneValue):1===t?0:(0,d.covariance)(e[0],e[1])*(t-1)/t})}covariances(e,t){return this.runFunction(e.args,t,this.metadata("COVARIANCE.S"),(e,t)=>{return e.numberOfElements()!==t.numberOfElements()?new c.CellError(c.ErrorType.NA,u.ErrorMessage.EqualLength):(e=s(e,t))instanceof c.CellError?e:e[0].length<=1?new c.CellError(c.ErrorType.DIV_BY_ZERO,u.ErrorMessage.TwoValues):(0,d.covariance)(e[0],e[1])})}ztest(e,t){return this.runFunction(e.args,t,this.metadata("Z.TEST"),(e,t,r)=>{e=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());if(e instanceof c.CellError)return e;var n=e.length;if(void 0===r){if(n<2)return new c.CellError(c.ErrorType.DIV_BY_ZERO,u.ErrorMessage.TwoValues);r=(0,d.stdev)(e,!0)}return n<1?new c.CellError(c.ErrorType.NA,u.ErrorMessage.OneValue):0===r?new c.CellError(c.ErrorType.DIV_BY_ZERO):1-d.normal.cdf(((0,d.mean)(e)-t)/(r/Math.sqrt(n)),0,1)})}ftest(e,t){return this.runFunction(e.args,t,this.metadata("F.TEST"),(e,t)=>{var r,n,e=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner()),t=this.arithmeticHelper.manyToExactNumbers(t.valuesFromTopLeftCorner());return e instanceof c.CellError?e:t instanceof c.CellError?t:e.length<=1||t.length<=1||(n=(0,d.variance)(e,!0),r=(0,d.variance)(t,!0),0===n)||0===r?new c.CellError(c.ErrorType.DIV_BY_ZERO):(n=d.centralF.cdf(n/r,e.length-1,t.length-1),2*Math.min(n,1-n))})}steyx(e,t){return this.runFunction(e.args,t,this.metadata("STEYX"),(e,t)=>{return e.numberOfElements()!==t.numberOfElements()?new c.CellError(c.ErrorType.NA,u.ErrorMessage.EqualLength):(e=s(e,t))instanceof c.CellError?e:(t=e[0].length)<=2?new c.CellError(c.ErrorType.DIV_BY_ZERO,u.ErrorMessage.ThreeValues):Math.sqrt(((0,d.sumsqerr)(e[0])-Math.pow((0,d.covariance)(e[0],e[1])*(t-1),2)/(0,d.sumsqerr)(e[1]))/(t-2))})}slope(e,t){return this.runFunction(e.args,t,this.metadata("SLOPE"),(e,t)=>{return e.numberOfElements()!==t.numberOfElements()?new c.CellError(c.ErrorType.NA,u.ErrorMessage.EqualLength):(e=s(e,t))instanceof c.CellError?e:(t=e[0].length)<=1?new c.CellError(c.ErrorType.DIV_BY_ZERO,u.ErrorMessage.TwoValues):(0,d.covariance)(e[0],e[1])*(t-1)/(0,d.sumsqerr)(e[1])})}chisqtest(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.TEST"),(e,t)=>{var r=e.height(),n=e.width();if(t.height()!==r||t.width()!==n)return new c.CellError(c.ErrorType.NA,u.ErrorMessage.EqualLength);var i=s(e,t);if(i instanceof c.CellError)return i;if(i[0].length<=1)return new c.CellError(c.ErrorType.DIV_BY_ZERO,u.ErrorMessage.TwoValues);let o=0;for(let e=0;e<i[0].length;e++){if(0===i[1][e])return new c.CellError(c.ErrorType.DIV_BY_ZERO);o+=Math.pow(i[0][e]-i[1][e],2)/i[1][e]}return o<0?new c.CellError(c.ErrorType.NUM,u.ErrorMessage.NaN):1-d.chisquare.cdf(o,1<r&&1<n?(r-1)*(n-1):r*n-1)})}ttest(e,t){return this.runFunction(e.args,t,this.metadata("T.TEST"),(e,t,r,n)=>{var i=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner()),o=this.arithmeticHelper.manyToExactNumbers(t.valuesFromTopLeftCorner());if(i instanceof c.CellError)return i;if(o instanceof c.CellError)return o;var s=i.length,e=o.length;if(1!==n)return 2===n?s<=1||e<=1?new c.CellError(c.ErrorType.DIV_BY_ZERO,u.ErrorMessage.TwoValues):0==(t=((0,d.sumsqerr)(i)+(0,d.sumsqerr)(o))/(s+e-2))?new c.CellError(c.ErrorType.DIV_BY_ZERO):(n=Math.abs(((0,d.mean)(i)-(0,d.mean)(o))/Math.sqrt(t*(1/s+1/e))),r*(1-d.studentt.cdf(n,s+e-2))):s<=1||e<=1?new c.CellError(c.ErrorType.DIV_BY_ZERO,u.ErrorMessage.TwoValues):(t=(0,d.variance)(i,!0),n=(0,d.variance)(o,!0),0===t&&0===n?new c.CellError(c.ErrorType.DIV_BY_ZERO):(l=Math.abs(((0,d.mean)(i)-(0,d.mean)(o))/Math.sqrt(t/s+n/e)),t=Math.pow(t/s+n/e,2)/(Math.pow(t/s,2)/(s-1)+Math.pow(n/e,2)/(e-1)),r*(1-d.studentt.cdf(l,t))));if(e!==s)return new c.CellError(c.ErrorType.NA,u.ErrorMessage.EqualLength);if(s<=1)return new c.CellError(c.ErrorType.DIV_BY_ZERO,u.ErrorMessage.TwoValues);var a=Array(s);for(let e=0;e<s;e++)a[e]=i[e]-o[e];var l,n=(0,d.stdev)(a,!0);return 0===n?new c.CellError(c.ErrorType.DIV_BY_ZERO):(l=Math.abs(Math.sqrt(s)*(0,d.mean)(a)/n),r*(1-d.studentt.cdf(l,s-1)))})}skew(e,t){return this.runFunction(e.args,t,this.metadata("SKEW"),(...e)=>{e=this.arithmeticHelper.coerceNumbersExactRanges(e);if(e instanceof c.CellError)return e;var t=e.length;if(t<3)return new c.CellError(c.ErrorType.DIV_BY_ZERO,u.ErrorMessage.ThreeValues);const r=(0,d.mean)(e),n=(0,d.stdev)(e,!0);return 0===n?new c.CellError(c.ErrorType.DIV_BY_ZERO):e.reduce((e,t)=>e+Math.pow((t-r)/n,3),0)*t/(t-1)/(t-2)})}skewp(e,t){return this.runFunction(e.args,t,this.metadata("SKEW.P"),(...e)=>{e=this.arithmeticHelper.coerceNumbersExactRanges(e);if(e instanceof c.CellError)return e;var t=e.length;if(t<3)return new c.CellError(c.ErrorType.DIV_BY_ZERO,u.ErrorMessage.ThreeValues);const r=(0,d.mean)(e),n=(0,d.stdev)(e,!1);return 0===n?new c.CellError(c.ErrorType.DIV_BY_ZERO):e.reduce((e,t)=>e+Math.pow((t-r)/n,3),0)/t})}}function s(e,t){for(var r=e.iterateValuesFromTopLeftCorner(),n=t.iterateValuesFromTopLeftCorner(),i=[],o=[];s=r.next(),a=n.next(),!s.done&&!a.done;){var s=s.value,a=a.value;if(s instanceof c.CellError)return s;if(a instanceof c.CellError)return a;(0,l.isExtendedNumber)(s)&&(0,l.isExtendedNumber)(a)&&(i.push((0,l.getRawValue)(s)),o.push((0,l.getRawValue)(a)))}return[i,o]}n.implementedFunctions={AVEDEV:{method:"avedev",parameters:[{argumentType:t.FunctionArgumentType.ANY}],repeatLastArgs:1},DEVSQ:{method:"devsq",parameters:[{argumentType:t.FunctionArgumentType.ANY}],repeatLastArgs:1},GEOMEAN:{method:"geomean",parameters:[{argumentType:t.FunctionArgumentType.ANY}],repeatLastArgs:1},HARMEAN:{method:"harmean",parameters:[{argumentType:t.FunctionArgumentType.ANY}],repeatLastArgs:1},CORREL:{method:"correl",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.RANGE}]},RSQ:{method:"rsq",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.RANGE}]},"COVARIANCE.P":{method:"covariancep",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.RANGE}]},"COVARIANCE.S":{method:"covariances",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.RANGE}]},"Z.TEST":{method:"ztest",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,optionalArg:!0}]},"F.TEST":{method:"ftest",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.RANGE}]},STEYX:{method:"steyx",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.RANGE}]},SLOPE:{method:"slope",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.RANGE}]},"CHISQ.TEST":{method:"chisqtest",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.RANGE}]},"T.TEST":{method:"ttest",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.INTEGER,minValue:1,maxValue:2},{argumentType:t.FunctionArgumentType.INTEGER,minValue:1,maxValue:3}]},SKEW:{method:"skew",parameters:[{argumentType:t.FunctionArgumentType.ANY}],repeatLastArgs:1},"SKEW.P":{method:"skewp",parameters:[{argumentType:t.FunctionArgumentType.ANY}],repeatLastArgs:1}},n.aliases={COVAR:"COVARIANCE.P",FTEST:"F.TEST",PEARSON:"CORREL",ZTEST:"Z.TEST",CHITEST:"CHISQ.TEST",TTEST:"T.TEST",COVARIANCEP:"COVARIANCE.P",COVARIANCES:"COVARIANCE.S",SKEWP:"SKEW.P"}},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,N(r(198))),o=(t.CellCoords=i.CellCoords,t.CellRange=i.CellRange,r(733)),s=N(r(502)),a=r(597),l=n(r(1071)),n=n(r(815)),c=N(r(504)),u=N(r(478)),d=N(r(481)),h=N(r(596)),p=N(r(782)),f=N(r(485)),g=N(r(480)),m=N(r(337)),y=N(r(512)),v=N(r(482)),b=N(r(335)),w=N(r(491)),C=N(r(334)),E=N(r(492)),T=r(493),S=r(515),_=r(516),x=r(645),R=r(510),r=r(813);function A(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(A=function(e){return e?r:t})(e))}function N(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=A(t);if(t&&t.has(e))return t.get(e);var r,n,i={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e)"default"!==r&&{}.hasOwnProperty.call(e,r)&&((n=o?Object.getOwnPropertyDescriptor(e,r):null)&&(n.get||n.set)?Object.defineProperty(i,r,n):i[r]=e[r]);return i.default=e,t&&t.set(e,i),i}(0,o.registerAllModules)(),(0,l.default)(i.default),i.default.__GhostTable=n.default,i.default._getListenersCounter=s.getListenersCounter,i.default._getRegisteredMapsCounter=a.getRegisteredMapsCounter,i.default.EventManager=s.default;o=[u,d,h,p,f,g,m,y,v,b,w,c],l=[C,E];i.default.helper={},i.default.dom={},u.arrayEach(o,t=>{u.arrayEach(Object.getOwnPropertyNames(t),e=>{"_"!==e.charAt(0)&&(i.default.helper[e]=t[e])})}),u.arrayEach(l,t=>{u.arrayEach(Object.getOwnPropertyNames(t),e=>{"_"!==e.charAt(0)&&(i.default.dom[e]=t[e])})}),i.default.cellTypes=null!=(n=i.default.cellTypes)?n:{},u.arrayEach((0,x.getRegisteredCellTypeNames)(),e=>{i.default.cellTypes[e]=(0,x.getCellType)(e)}),i.default.cellTypes.registerCellType=x.registerCellType,i.default.cellTypes.getCellType=x.getCellType,i.default.editors=null!=(a=i.default.editors)?a:{},u.arrayEach((0,T.getRegisteredEditorNames)(),e=>{i.default.editors[b.toUpperCaseFirst(e)+"Editor"]=(0,T.getEditor)(e)}),i.default.editors.registerEditor=T.registerEditor,i.default.editors.getEditor=T.getEditor,i.default.renderers=null!=(s=i.default.renderers)?s:{},u.arrayEach((0,S.getRegisteredRendererNames)(),e=>{var t=(0,S.getRenderer)(e);"base"===e&&(i.default.renderers.cellDecorator=t),i.default.renderers[b.toUpperCaseFirst(e)+"Renderer"]=t}),i.default.renderers.registerRenderer=S.registerRenderer,i.default.renderers.getRenderer=S.getRenderer,i.default.validators=null!=(d=i.default.validators)?d:{},u.arrayEach((0,_.getRegisteredValidatorNames)(),e=>{i.default.validators[b.toUpperCaseFirst(e)+"Validator"]=(0,_.getValidator)(e)}),i.default.validators.registerValidator=_.registerValidator,i.default.validators.getValidator=_.getValidator,i.default.plugins=null!=(h=i.default.plugins)?h:{},u.arrayEach((0,R.getPluginsNames)(),e=>{i.default.plugins[e]=(0,R.getPlugin)(e)}),i.default.plugins[b.toUpperCaseFirst(r.BasePlugin.PLUGIN_KEY)+"Plugin"]=r.BasePlugin,i.default.plugins.registerPlugin=R.registerPlugin,i.default.plugins.getPlugin=R.getPlugin,t.default=i.default},e=>{e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(199),r(200),r(201),r(202),n(r(203))),o=r(594),s=r(638),n=n(r(494)),a=r(616),l=r(645),c=r(723),u=r(663),r=r(518);function d(e,t){e=new i.default(e,t||{},o.rootInstanceSymbol);return e.init(),e}t.CellCoords=r.CellCoords,t.CellRange=r.CellRange,(0,l.registerCellType)(c.TextCellType),d.editors={BaseEditor:u.BaseEditor},d.Core=function(e){return new i.default(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},o.rootInstanceSymbol)},d.DefaultSettings=(0,s.metaSchemaFactory)(),d.hooks=n.default.getSingleton(),d.CellCoords=r.CellCoords,d.CellRange=r.CellRange,d.packageName="handsontable",d.buildDate="30/07/2024 11:22:06",d.version="14.5.0",d.languages={dictionaryKeys:a.dictionaryKeys,getLanguageDictionary:a.getLanguageDictionary,getLanguagesDictionaries:a.getLanguagesDictionaries,registerLanguageDictionary:a.registerLanguageDictionary,getTranslatedPhrase:a.getTranslatedPhrase};t.default=d},(e,t,r)=>{"use strict";r.r(t)},(e,t,r)=>{"use strict";r.r(t)},(e,t,r)=>{"use strict";r.r(t)},(e,t,r)=>{"use strict";r.r(t)},(n,e,t)=>{"use strict";var r=t(197),A=(e.__esModule=!0,e.default=function(e,t){var n=this;let r=2<arguments.length&&void 0!==arguments[2]&&arguments[2],L=this;const i=new k.default(L);let p,d,f,c,o,s,g=!0;(0,X.hasValidParameter)(r)&&(0,X.registerAsRootInstance)(this);this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const a=null!=(h=null==t?void 0:t.layoutDirection)?h:"inherit",l=["rtl","ltr"].includes(a)?a:this.rootWindow.getComputedStyle(this.rootElement).direction,m=(this.rootElement.setAttribute("dir",l),this.isRtl=function(){return"rtl"===l},this.isLtr=function(){return!L.isRtl()},this.getDirectionFactor=function(){return L.isLtr()?1:-1},t.language=(0,Q.getValidLanguageCode)(t.language),new re.MetaManager(L,t,[re.DynamicCellMetaMod,re.ExtendMetaPropertiesMod])),F=m.getTableMeta(),y=m.getGlobalMeta(),u=(0,ie.createUniqueMap)();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),(0,X.isRootInstance)(this)&&(0,O._injectProductInfo)(t.licenseKey,e);this.guid="ht_"+(0,j.randomString)(),le.set(this.guid,this),this.columnIndexMapper=new K.IndexMapper,this.rowIndexMapper=new K.IndexMapper,this.columnIndexMapper.addLocalHook("indexesSequenceChange",e=>{L.runHooks("afterColumnSequenceChange",e)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",e=>{L.runHooks("afterRowSequenceChange",e)}),d=new G.default(L),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid);var h=e=>{var{row:e,col:t}=e;return L._createCellCoords(0<=e?L.rowIndexMapper.getRenderableFromVisualIndex(e):e,0<=t?L.columnIndexMapper.getRenderableFromVisualIndex(t):t)},t=e=>{var{row:e,col:t}=e;return L._createCellCoords(0<=e?L.rowIndexMapper.getVisualFromRenderableIndex(e):e,0<=t?L.columnIndexMapper.getVisualFromRenderableIndex(t):t)},e=(e,t)=>{var r=e<t?1:-1,n=Math.min(e,t),t=Math.max(e,t),e=L.rowIndexMapper.getNearestNotHiddenIndex(e,r);return null===e||1==r&&t<e||-1==r&&e<n?null:0<=e?L.rowIndexMapper.getRenderableFromVisualIndex(e):e},v=(e,t)=>{var r=e<t?1:-1,n=Math.min(e,t),t=Math.max(e,t),e=L.columnIndexMapper.getNearestNotHiddenIndex(e,r);return null===e||1==r&&t<e||-1==r&&e<n?null:0<=e?L.columnIndexMapper.getRenderableFromVisualIndex(e):e};let b=new te.Selection(F,{rowIndexMapper:L.rowIndexMapper,columnIndexMapper:L.columnIndexMapper,countCols:()=>L.countCols(),countRows:()=>L.countRows(),propToCol:e=>p.propToCol(e),isEditorOpened:()=>!!L.getActiveEditor()&&L.getActiveEditor().isOpened(),countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return n.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return n.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>L.getShortcutManager(),createCellCoords:(e,t)=>L._createCellCoords(e,t),createCellRange:(e,t,r)=>L._createCellRange(e,t,r),visualToRenderableCoords:h,renderableToVisualCoords:t,findFirstNonHiddenRenderableRow:e,findFirstNonHiddenRenderableColumn:v,isDisabledCellSelection:(e,t)=>(e<0||t<0?L.getSettings():L.getCellMeta(e,t)).disableVisualSelection});this.selection=b;h=e=>{e=e.hiddenIndexesChanged;e&&this.selection.commit()};function w(r,n){var i="className"===r?L.rootElement:L.table;if(g)(0,A.addClass)(i,n);else{let e=[],t=[];y[r]&&(e=Array.isArray(y[r])?y[r]:(0,U.stringToArray)(y[r])),n&&(t=Array.isArray(n)?n:(0,U.stringToArray)(n));var o=(0,U.getDifferenceOfArrays)(e,t),s=(0,U.getDifferenceOfArrays)(t,e);o.length&&(0,A.removeClass)(i,o),s.length&&(0,A.addClass)(i,s)}y[r]=n}function C(){let e=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,e=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){0===this.validatorsInQueue&&!1===e&&(e=!0,this.onQueueEmpty(this.valid))}}}function E(i,r,e){if(i.length){const t=L.getActiveEditor(),l=new C;let n=!0;l.onQueueEmpty=()=>{t&&n&&t.cancelChanges(),e()};for(let t=i.length-1;0<=t;t--){var[o,s,,a]=i[t],s=p.propToCol(s);let e;"numeric"===(e=Number.isInteger(s)?L.getCellMeta(o,s):{...Object.getPrototypeOf(F),...F}).type&&"string"==typeof a&&(0,z.isNumericLike)(a)&&(i[t][3]=(o=void 0,o=(s=a).replace(",","."),!1===isNaN(parseFloat(o))?parseFloat(o):s)),L.getCellValidator(e)&&(l.addValidatorToQueue(),L.validateCell(i[t][3],e,function(t,r){return function(e){if("boolean"!=typeof e)throw new Error("Validation error: result is not boolean");!1===e&&!1===r.allowInvalid&&(n=!1,i.splice(t,1),r.valid=!0),l.removeValidatorFormQueue()}}(t,e),r))}l.checkIfQueueIsEmpty()}else e()}function T(r,n){for(let t=r.length-1;0<=t;t--){let e=!1;if(null===r[t])r.splice(t,1);else if(null!==r[t][2]&&void 0!==r[t][2]||null!==r[t][3]&&void 0!==r[t][3]){if(F.allowInsertRow)for(;r[t][0]>L.countRows()-1;){var i=p.createRow(void 0,void 0,{source:n})["delta"];if(0===i){e=!0;break}}if("array"===L.dataType&&(!F.columns||0===F.columns.length)&&F.allowInsertColumn)for(;p.propToCol(r[t][1])>L.countCols()-1;){var o=p.createCol(void 0,void 0,{source:n})["delta"];if(0===o){e=!0;break}}e||p.set(r[t][0],r[t][1],r[t][3])}}var e=0<r.length;L.forceFullRender=!0,e?(f.adjustRowsAndCols(),L.runHooks("beforeChangeRender",r,n),c.closeEditor(),L.view.render(),c.prepareEditor(),L.view.adjustElementsSize(),L.runHooks("afterChange",r,n||"edit"),(e=L.getActiveEditor())&&(0,O.isDefined)(e.refreshValue)&&e.refreshValue()):L.view.render()}function S(e,t,r){return Array.isArray(e)?e:[[e,t,r]]}function _(e,t){var r=L.getActiveEditor(),t=L.runHooks("beforeChange",e,t||"edit"),e=e.filter(e=>null!==e);return!1===t||0===e.length?(r&&r.cancelChanges(),[]):e}this.columnIndexMapper.addLocalHook("cacheUpdated",h),this.rowIndexMapper.addLocalHook("cacheUpdated",h),this.selection.addLocalHook("afterSetRangeEnd",(e,t)=>{var r=(0,H.createObjectPropListener)(!1),n=this.selection.getSelectedRange(),{from:i,to:o}=n.current(),n=n.size()-1,i=(this.runHooks("afterSelection",i.row,i.col,o.row,o.col,r,n),this.runHooks("afterSelectionByProp",i.row,L.colToProp(i.col),o.row,L.colToProp(o.col),r,n),t&&(!r.isTouched()||r.isTouched()&&!r.value)&&s.scrollTo(e),b.isSelectedByRowHeader()),o=b.isSelectedByColumnHeader();i&&o?(0,A.addClass)(this.rootElement,["ht__selection--rows","ht__selection--columns"]):i?((0,A.removeClass)(this.rootElement,"ht__selection--columns"),(0,A.addClass)(this.rootElement,"ht__selection--rows")):o?((0,A.removeClass)(this.rootElement,"ht__selection--rows"),(0,A.addClass)(this.rootElement,"ht__selection--columns")):(0,A.removeClass)(this.rootElement,["ht__selection--rows","ht__selection--columns"]),"shift"!==b.getSelectionSource()&&c.closeEditor(null),L.view.render(),c.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",e=>{this.runHooks("beforeSelectionFocusSet",e.row,e.col)}),this.selection.addLocalHook("afterSetFocus",e=>{var t=(0,H.createObjectPropListener)(!1);this.runHooks("afterSelectionFocusSet",e.row,e.col,t),t.isTouched()&&(!t.isTouched()||t.value)||s.scrollTo(e),c.closeEditor(),L.view.render(),c.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",e=>{var t=e.length-1,{from:e,to:r}=e[t];this.runHooks("afterSelectionEnd",e.row,e.col,r.row,r.col,t),this.runHooks("afterSelectionEndByProp",e.row,L.colToProp(e.col),r.row,L.colToProp(r.col),t)}),this.selection.addLocalHook("afterIsMultipleSelection",e=>{var t=this.runHooks("afterIsMultipleSelection",e.value);e.value&&(e.value=t)}),this.selection.addLocalHook("afterDeselect",()=>{c.closeEditor(),L.view.render(),(0,A.removeClass)(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("beforeSetRangeStart",...t)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("beforeSetRangeStartOnly",...t)}).addLocalHook("beforeSetRangeEnd",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("beforeSetRangeEnd",...t)}).addLocalHook("beforeSelectColumns",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("beforeSelectColumns",...t)}).addLocalHook("afterSelectColumns",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("afterSelectColumns",...t)}).addLocalHook("beforeSelectRows",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("beforeSelectRows",...t)}).addLocalHook("afterSelectRows",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("afterSelectRows",...t)}).addLocalHook("beforeModifyTransformStart",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("modifyTransformStart",...t)}).addLocalHook("afterModifyTransformStart",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("afterModifyTransformStart",...t)}).addLocalHook("beforeModifyTransformFocus",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("modifyTransformFocus",...t)}).addLocalHook("afterModifyTransformFocus",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("afterModifyTransformFocus",...t)}).addLocalHook("beforeModifyTransformEnd",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("modifyTransformEnd",...t)}).addLocalHook("afterModifyTransformEnd",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("afterModifyTransformEnd",...t)}).addLocalHook("beforeRowWrap",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("beforeRowWrap",...t)}).addLocalHook("beforeColumnWrap",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("beforeColumnWrap",...t)}).addLocalHook("insertRowRequire",e=>this.alter("insert_row_above",e,1,"auto")).addLocalHook("insertColRequire",e=>this.alter("insert_col_start",e,1,"auto")),f={alter(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;let s=3<arguments.length?arguments[3]:void 0;var n=4<arguments.length?arguments[4]:void 0,i=e=>{return 0===e.length?[]:((e=[...e]).sort((e,t)=>{var[e]=e,[t]=t;return e===t?0:t<e?1:-1}),(0,U.arrayReduce)(e,(e,t)=>{var[t,r]=t,n=e[e.length-1],[i,o]=n,i=i+o;return t<=i?(o=Math.max(r-(i-t),0),n[1]+=o):e.push([t,r]),e},[e[0]]))};switch(e){case"insert_row_below":case"insert_row_above":var o=L.countSourceRows();if(F.maxRows===o)return;var a="insert_row_below"===e?"below":"above",{delta:l,startPhysicalIndex:o}=(t=null!=(l=t)?l:"below"==a?o:0,p.createRow(t,r,{source:s,mode:a}));b.shiftRows(L.toVisualRow(o),l);break;case"insert_col_start":case"insert_col_end":var a="insert_col_end"===e?"end":"start",{delta:l,startPhysicalIndex:o}=(t=null!=(o=t)?o:"end"==a?L.countSourceCols():0,p.createCol(t,r,{source:s,mode:a}));l&&(Array.isArray(F.colHeaders)&&((a=[L.toVisualColumn(o),0]).length+=l,Array.prototype.splice.apply(F.colHeaders,a)),b.shiftColumns(L.toVisualColumn(o),l));break;case"remove_row":a=e=>{let o=0;(0,U.arrayEach)(e,e=>{let[t,r]=e;var n,e=(0,O.isEmpty)(t)?L.countRows()-1:Math.max(t-o,0),i=(Number.isInteger(t)&&(t=Math.max(t-o,0)),p.removeRow(t,r,s));i&&(b.isSelected()&&(i=L.getSelectedRangeLast().highlight["row"],i>=t)&&i<=t+r-1&&c.closeEditor(!0),0===(i=L.countRows())?b.deselect():"ContextMenu.removeRow"===s?b.refresh():b.shiftRows(t,-r),e+1<=(n=F.fixedRowsTop)&&(F.fixedRowsTop-=Math.min(r,n-e)),(n=F.fixedRowsBottom)&&i-n<=e&&(F.fixedRowsBottom-=Math.min(r,n)),o+=r)})};Array.isArray(t)?a(i(t)):a([[t,r]]);break;case"remove_col":o=e=>{let o=0;(0,U.arrayEach)(e,e=>{let[t,r]=e;var n,e=(0,O.isEmpty)(t)?L.countCols()-1:Math.max(t-o,0);let i=L.toPhysicalColumn(e);Number.isInteger(t)&&(t=Math.max(t-o,0)),p.removeCol(t,r,s)&&(b.isSelected()&&(n=L.getSelectedRangeLast().highlight["col"],n>=t)&&n<=t+r-1&&c.closeEditor(!0),0===L.countCols()?b.deselect():"ContextMenu.removeColumn"===s?b.refresh():b.shiftColumns(t,-r),e+1<=(n=F.fixedColumnsStart)&&(F.fixedColumnsStart-=Math.min(r,n-e)),Array.isArray(F.colHeaders)&&(void 0===i&&(i=-1),F.colHeaders.splice(i,r)),o+=r)})};Array.isArray(t)?o(i(t)):o([[t,r]]);break;default:throw new Error(`There is no such action "${e}"`)}L.view.render(),n||f.adjustRowsAndCols()},adjustRowsAndCols(){var t=F.minRows,r=F.minSpareRows,n=F.minCols,i=F.minSpareCols;t&&(o=L.countRows())<t&&p.createRow(o,t-o,{source:"auto"}),r&&(t=L.countEmptyRows(!0))<r&&(o=Math.min(r-t,F.maxRows-L.countSourceRows()),p.createRow(L.countRows(),o,{source:"auto"}));{let e;(n||i)&&(e=L.countEmptyCols(!0));var o,r=L.countCols();n&&!F.columns&&r<n&&(t=n-r,e+=t,p.createCol(r,t,{source:"auto"})),i&&!F.columns&&"array"===L.dataType&&e<i&&(r=L.countCols(),o=i-e,n=Math.min(o,F.maxCols-r),p.createCol(r,n,{source:"auto"}))}L.view&&L.view.adjustElementsSize()},populateFromArray(i,o,s,a,l){let c,u,d,h;var p=[],f={},g=[],m=i.row;const y=i.col;if(0===(u=o.length))return!1;let v=0,b=0;switch((0,H.isObject)(s)&&(v=s.col-y+1,b=s.row-m+1),l){case"shift_down":var w=(0,U.pivot)(o),C=w.length,E=Math.max(C,v),T=L.getData().slice(m),S=(0,U.pivot)(T).slice(y,y+E);for(d=0;d<E;d+=1)if(d<C){for(c=0,u=w[d].length;c<b-u;c+=1)w[d].push(w[d][c%u]);d<S.length?g.push(w[d].concat(S[d])):g.push(w[d].concat(new Array(T.length).fill(null)))}else g.push(w[d%C].concat(S[d]));L.populateFromArray(m,y,(0,U.pivot)(g));break;case"shift_right":var _=o.length,x=Math.max(_,b),R=L.getData().slice(m).map(e=>e.slice(y));for(c=0;c<x;c+=1)if(c<_){for(d=0,h=o[c].length;d<v-h;d+=1)o[c].push(o[c][d%h]);if(c<R.length)for(let e=0;e<R[c].length;e+=1)o[c].push(R[c][e]);else o[c].push(...new Array(R[0].length).fill(null))}else o.push(o[c%u].slice(0,x).concat(R[c]));L.populateFromArray(m,y,o);break;default:f.row=i.row,f.col=i.col;let e=0,r=0,n=!0,t;var A=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,e=o[e%o.length];return null!==t?e[t%e.length]:e},N=o.length,O=s?s.row-i.row+1:0;for(u=s?O:Math.max(N,O),c=0;c<u&&!(s&&f.row>s.row&&N<O||!F.allowInsertRow&&f.row>L.countRows()-1||f.row>=F.maxRows);c++){var I,M,k=c-e,D=A(k).length,P=s?s.col-i.col+1:0;if(h=s?P:Math.max(D,P),f.col=i.col,t=L.getCellMeta(f.row,f.col),"CopyPaste.paste"!==a&&"Autofill.fill"!==a||!t.skipRowOnPaste){for(r=0,d=0;d<h&&!(s&&f.col>s.col&&D<P||!F.allowInsertColumn&&f.col>L.countCols()-1||f.col>=F.maxCols);d++)if(t=L.getCellMeta(f.row,f.col),"CopyPaste.paste"!==a&&"Autofill.fill"!==a||!t.skipColumnOnPaste){if(!t.readOnly||"UndoRedo.undo"===a){let e=A(k,d-r),t=L.getDataAtCell(f.row,f.col);null!==e&&"object"==typeof e?null!==(t=Array.isArray(e)&&null===t?[]:t)&&"object"==typeof t&&(I=(0,H.duckSchema)(!Array.isArray(t)&&t[0]||t),M=(0,H.duckSchema)(!Array.isArray(e)&&e[0]||e),(0,H.isObjectEqual)(I,M)||Array.isArray(I)&&Array.isArray(M))?e=(0,H.deepClone)(e):n=!1:null!==t&&"object"==typeof t&&(n=!1),n&&p.push([f.row,f.col,e]),n=!0}f.col+=1}else r+=1,f.col+=1,h+=1;f.row+=1}else e+=1,f.row+=1,u+=1}L.setDataAtCell(p,null,null,a||"populateFromArray")}}},this.init=function(){d.setData(F.data),L.runHooks("beforeInit"),((0,I.isMobileBrowser)()||(0,I.isIpadOS)())&&(0,A.addClass)(L.rootElement,"mobile"),this.updateSettings(F,!0),this.view=new Y.default(this),c=M.default.getInstance(L,F,b),s=(0,ne.createViewportScroller)(L),o=new D.FocusManager(L),(0,X.isRootInstance)(this)&&(0,ne.installFocusCatcher)(L),L.runHooks("init"),this.forceFullRender=!0,this.view.render(),g&&null===L.rootElement.offsetParent&&(0,A.observeVisibilityChangeOnce)(L.rootElement,()=>{L.view._wt.wtOverlays.updateLastSpreaderSize(),L.render(),L.view.adjustElementsSize()}),"object"==typeof g&&(L.runHooks("afterChange",g[0],g[1]),g=!1),L.runHooks("afterInit")},this._createCellCoords=function(e,t){return L.view._wt.createCellCoords(e,t)},this._createCellRange=function(e,t,r){return L.view._wt.createCellRange(e,t,r)},this.validateCell=function(t,i,o,r){let e=L.getCellValidator(i);function n(e,t){var r,n;1<arguments.length&&void 0!==t&&!t||!0===i.hidden||(t=i.visualCol,n=i.visualRow,(r=L.getCell(n,t,!0))&&"TH"!==r.nodeName&&(n=L.rowIndexMapper.getRenderableFromVisualIndex(n),t=L.columnIndexMapper.getRenderableFromVisualIndex(t),L.view._wt.getSetting("cellRenderer",n,t,r))),o(e)}var s;(0,O.isRegExp)(e)&&(e=(s=e,function(e,t){t(s.test(e))})),(0,N.isFunction)(e)?(t=L.runHooks("beforeValidate",t,i.visualRow,i.prop,r),L._registerImmediate(()=>{e.call(i,t,e=>{L&&(e=L.runHooks("afterValidate",e,t,i.visualRow,i.prop,r),n(i.valid=e),L.runHooks("postAfterValidate",e,t,i.visualRow,i.prop,r))})})):L._registerImmediate(()=>{i.valid=!0,n(i.valid,!1)})},this.setDataAtCell=function(e,t,r,n){var i,o=S(e,t,r),s=[];let a=n,l,c;for(l=0,i=o.length;l<i;l++){if("object"!=typeof o[l])throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof o[l][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");c=o[l][1]>=this.countCols()?o[l][1]:p.colToProp(o[l][1]),s.push([o[l][0],c,d.getAtCell(this.toPhysicalRow(o[l][0]),o[l][1]),o[l][2]])}a||"object"!=typeof e||(a=t);const u=_(s,n);L.runHooks("afterSetDataAtCell",u,a),E(u,a,()=>{T(u,a)})},this.setDataAtRowProp=function(e,t,r,n){var i,o=S(e,t,r),s=[];let a=n,l;for(l=0,i=o.length;l<i;l++)s.push([o[l][0],o[l][1],d.getAtCell(this.toPhysicalRow(o[l][0]),o[l][1]),o[l][2]]);a||"object"!=typeof e||(a=t);const c=_(s,n);L.runHooks("afterSetDataAtRowProp",c,a),E(c,a,()=>{T(c,a)})},this.listen=function(){L&&!L.isListening()&&(le.forEach(e=>{L!==e&&e.unlisten()}),ae=L.guid,L.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(ae=null,L.runHooks("afterUnlisten"))},this.isListening=function(){return ae===L.guid},this.destroyEditor=function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];c.closeEditor(e),L.view.render(),t&&b.isSelected()&&c.prepareEditor()},this.populateFromArray=function(e,t,r,n,i,o,s){if("object"!=typeof r||"object"!=typeof r[0])throw new Error("populateFromArray parameter `input` must be an array of arrays");n="number"==typeof n?L._createCellCoords(n,i):null;return f.populateFromArray(L._createCellCoords(e,t),r,n,o,s)},this.spliceCol=function(e,t,r){for(var n=arguments.length,i=new Array(3<n?n-3:0),o=3;o<n;o++)i[o-3]=arguments[o];return p.spliceCol(e,t,r,...i)},this.spliceRow=function(e,t,r){for(var n=arguments.length,i=new Array(3<n?n-3:0),o=3;o<n;o++)i[o-3]=arguments[o];return p.spliceRow(e,t,r,...i)},this.getSelected=function(){if(b.isSelected())return(0,U.arrayMap)(b.getSelectedRange(),e=>{var{from:e,to:t}=e;return[e.row,e.col,t.row,t.col]})},this.getSelectedLast=function(){var e=this.getSelected();let t;return t=e&&0<e.length?e[e.length-1]:t},this.getSelectedRange=function(){if(b.isSelected())return Array.from(b.getSelectedRange())},this.getSelectedRangeLast=function(){var e=this.getSelectedRange();let t;return t=e&&0<e.length?e[e.length-1]:t},this.emptySelectedCells=function(e){if(b.isSelected()&&0!==this.countRows()&&0!==this.countCols()){const i=[];(0,U.arrayEach)(b.getSelectedRange(),e=>{if(!e.isSingleHeader()){const r=e.getTopStartCorner(),n=e.getBottomEndCorner();(0,z.rangeEach)(r.row,n.row,t=>{(0,z.rangeEach)(r.col,n.col,e=>{this.getCellMeta(t,e).readOnly||i.push([t,e,null])})})}}),0<i.length&&this.setDataAtCell(i,e)}},this.isRenderSuspended=function(){return 0<this.renderSuspendedCounter},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){var e=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(e,0),this.isRenderSuspended()||e!==this.renderSuspendedCounter||(this.renderCall?this:L.view).render()},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||L.view.render())},this.batchRender=function(e){this.suspendRender();e=e();return this.resumeRender(),e},this.isExecutionSuspended=function(){return 0<this.executionSuspendedCounter},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(t,0),(!this.isExecutionSuspended()&&t===this.executionSuspendedCounter||e)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],e=(this.suspendExecution(),e());return this.resumeExecution(t),e},this.batch=function(e){this.suspendRender(),this.suspendExecution();e=e();return this.resumeExecution(),this.resumeRender(),e},this.refreshDimensions=function(){var e,t,r,n,i;L.view&&({width:e,height:t}=L.view.getLastSize(),{width:r,height:n}=L.rootElement.getBoundingClientRect(),i=r!==e||n!==t,!1!==L.runHooks("beforeRefreshDimensions",{width:e,height:t},{width:r,height:n},i))&&(!i&&L.view._wt.wtOverlays.scrollableElement!==L.rootWindow||(L.view.setLastSize(r,n),L.render()),L.runHooks("afterRefreshDimensions",{width:e,height:t},{width:r,height:n},i))},this.updateData=function(e,t){(0,re.replaceData)(e,e=>{p=e},e=>{p=e,L.columnIndexMapper.fitToLength(this.getInitialColumnCount()),L.rowIndexMapper.fitToLength(this.countSourceRows()),f.adjustRowsAndCols(),b.refresh()},{hotInstance:L,dataMap:p,dataSource:d,internalSource:"updateData",source:t,metaManager:m,firstRun:g})},this.loadData=function(e,t){(0,re.replaceData)(e,e=>{p=e},()=>{m.clearCellsCache(),L.initIndexMappers(),f.adjustRowsAndCols(),b.refresh(),g=g&&[null,"loadData"]},{hotInstance:L,dataMap:p,dataSource:d,internalSource:"loadData",source:t,metaManager:m,firstRun:g})},this.getInitialColumnCount=function(){var e,t=F.columns;let r=0;if(Array.isArray(t))r=t.length;else if((0,N.isFunction)(t))if("array"===L.dataType){var n=this.countSourceCols();for(let e=0;e<n;e+=1)t(e)&&(r+=1)}else"object"!==L.dataType&&"function"!==L.dataType||(r=p.colToPropCache.length);else r=(0,O.isDefined)(F.dataSchema)?(e=p.getSchema(),Array.isArray(e)?e.length:(0,H.deepObjectSize)(e)):this.countSourceCols();return r},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(e,t,r,n){return(0,O.isUndefined)(e)?p.getAll():p.getRange(L._createCellCoords(e,t),L._createCellCoords(r,n),p.DESTINATION_RENDERER)},this.getCopyableText=function(e,t,r,n){return p.getCopyableText(L._createCellCoords(e,t),L._createCellCoords(r,n))},this.getCopyableData=function(e,t){return p.getCopyable(e,p.colToProp(t))},this.getSchema=function(){return p.getSchema()},this.updateSettings=function(t){var e,r,n=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=(g?L.loadData:L.updateData).bind(this);let o=!1,s,a;if((0,O.isDefined)(t.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if((0,O.isDefined)(t.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if((0,O.isDefined)(t.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(s in t)"data"!==s&&("language"===s?(e=t.language,r=(r=void 0,ee.normalizeLanguageCode)(e),(0,Q.hasLanguageDictionary)(r)?(L.runHooks("beforeLanguageChange",r),y.language=r,L.runHooks("afterLanguageChange",r)):(0,ee.warnUserAboutLanguageRegistration)(e)):"className"===s?w("className",t.className):"tableClassName"===s&&L.table?(w("tableClassName",t.tableClassName),L.view._wt.wtOverlays.syncOverlayTableClassNames()):Z.default.getSingleton().isRegistered(s)||Z.default.getSingleton().isDeprecated(s)?((0,N.isFunction)(t[s])||Array.isArray(t[s]))&&(t[s].initialHook=!0,L.addHook(s,t[s])):!n&&(0,H.hasOwnProperty)(t,s)&&(y[s]=t[s]));void 0===t.data&&void 0===F.data?i(null,"updateSettings"):void 0!==t.data?i(t.data,"updateSettings"):void 0!==t.columns&&(p.createMap(),L.initIndexMappers());var l,c=L.countCols(),u=F.columns;if(u&&(0,N.isFunction)(u)&&(o=!0),void 0===t.cell&&void 0===t.cells&&void 0===t.columns||m.clearCache(),0<c)for(s=0,a=0;s<c;s++)u&&(l=o?u(s):u[a])&&m.updateColumnMeta(a,l),a+=1;(0,O.isDefined)(t.cell)&&(0,H.objectEach)(t.cell,e=>{L.setCellMetaObject(e.row,e.col,e)}),L.runHooks("afterCellMetaReset");let d=L.rootElement.style.height,h=(""!==d&&(d=parseInt(L.rootElement.style.height,10)),t.height);if((0,N.isFunction)(h)&&(h=h()),n&&L.rootElement.getAttribute("style")&&L.rootElement.setAttribute("data-initialstyle",L.rootElement.getAttribute("style")),null===h?(i=L.rootElement.getAttribute("data-initialstyle"))&&(-1<i.indexOf("height")||-1<i.indexOf("overflow"))?L.rootElement.setAttribute("style",i):(L.rootElement.style.height="",L.rootElement.style.overflow=""):void 0!==h&&(L.rootElement.style.height=isNaN(h)?""+h:h+"px",L.rootElement.style.overflow="hidden"),void 0!==t.width){let e=t.width;(0,N.isFunction)(e)&&(e=e()),L.rootElement.style.width=isNaN(e)?""+e:e+"px"}n||(L.view&&(L.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),L.view._wt.exportSettingsAsClassNames()),L.runHooks("afterUpdateSettings",t)),f.adjustRowsAndCols(),L.view&&!g&&(L.forceFullRender=!0,L.view.render(),L.view._wt.wtOverlays.adjustElementsSize()),n||!L.view||""!==d&&""!==h&&void 0!==h||d===h||L.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var e=L.getSelectedLast();return F.getValue?(0,N.isFunction)(F.getValue)?F.getValue.call(L):e?L.getData()[e[0][0]][F.getValue]:void 0:e?L.getDataAtCell(e[0],e[1]):void 0},this.getSettings=function(){return F},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(e,t,r,n,i){f.alter(e,t,r,n,i)},this.getCell=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]&&arguments[2];let n=t,i=e;if(0<=t){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(t)))return null;n=this.columnIndexMapper.getRenderableFromVisualIndex(t)}if(0<=e){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(e)))return null;i=this.rowIndexMapper.getRenderableFromVisualIndex(e)}return null===i||null===n||void 0===i||void 0===n?null:L.view.getCellAtCoords(L._createCellCoords(i,n),r)},this.getCoords=function(e){e=this.view._wt.wtTable.getCoords(e);if(null===e)return null;var{row:e,col:t}=e;let r=e,n=t;return 0<=e&&(r=this.rowIndexMapper.getVisualFromRenderableIndex(e)),0<=t&&(n=this.columnIndexMapper.getVisualFromRenderableIndex(t)),L._createCellCoords(r,n)},this.colToProp=function(e){return p.colToProp(e)},this.propToCol=function(e){return p.propToCol(e)},this.toVisualRow=e=>this.rowIndexMapper.getVisualFromPhysicalIndex(e),this.toVisualColumn=e=>this.columnIndexMapper.getVisualFromPhysicalIndex(e),this.toPhysicalRow=e=>this.rowIndexMapper.getPhysicalFromVisualIndex(e),this.toPhysicalColumn=e=>this.columnIndexMapper.getPhysicalFromVisualIndex(e),this.getDataAtCell=function(e,t){return p.get(e,p.colToProp(t))},this.getDataAtRowProp=function(e,t){return p.get(e,t)},this.getDataAtCol=function(e){var r=[],n=p.getRange(L._createCellCoords(0,e),L._createCellCoords(F.data.length-1,e),p.DESTINATION_RENDERER);for(let t=0;t<n.length;t+=1)for(let e=0;e<n[t].length;e+=1)r.push(n[t][e]);return r},this.getDataAtProp=function(e){var r=[],n=p.getRange(L._createCellCoords(0,p.propToCol(e)),L._createCellCoords(F.data.length-1,p.propToCol(e)),p.DESTINATION_RENDERER);for(let t=0;t<n.length;t+=1)for(let e=0;e<n[t].length;e+=1)r.push(n[t][e]);return r},this.getSourceData=function(e,t,r,n){let i;return i=void 0===e?d.getData():d.getByRange(L._createCellCoords(e,t),L._createCellCoords(r,n))},this.getSourceDataArray=function(e,t,r,n){let i;return i=void 0===e?d.getData(!0):d.getByRange(L._createCellCoords(e,t),L._createCellCoords(r,n),!0)},this.getSourceDataAtCol=function(e){return d.getAtColumn(e)},this.setSourceDataAtCell=function(e,t,r,n){e=S(e,t,r),t=this.hasHook("afterSetSourceDataAtCell");const i=[];t&&(0,U.arrayEach)(e,e=>{var[e,t,r]=e;i.push([e,t,d.getAtCell(e,t),r])}),(0,U.arrayEach)(e,e=>{var[e,t,r]=e;d.setAtCell(e,t,r)}),t&&this.runHooks("afterSetSourceDataAtCell",i,n),this.render();r=L.getActiveEditor();r&&(0,O.isDefined)(r.refreshValue)&&r.refreshValue()},this.getSourceDataAtRow=function(e){return d.getAtRow(e)},this.getSourceDataAtCell=function(e,t){return d.getAtCell(e,t)},this.getDataAtRow=function(e){return p.getRange(L._createCellCoords(e,0),L._createCellCoords(e,this.countCols()-1),p.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(e,t,r,n){e=void 0===e?[0,0,this.countRows(),this.countCols()]:[e,t,r,n];const[i,o]=e;let[,,s,a]=e,l=null,c=null,u=(void 0===s&&(s=i),void 0===a&&(a=o),"mixed");return(0,z.rangeEach)(Math.max(Math.min(i,s),0),Math.max(i,s),t=>{let r=!0;return(0,z.rangeEach)(Math.max(Math.min(o,a),0),Math.max(o,a),e=>{e=this.getCellMeta(t,e);return c=e.type,l?r=l===c:l=c,r}),u=r?c:"mixed",r}),u},this.removeCellMeta=function(e,t,r){var[n,i]=[this.toPhysicalRow(e),this.toPhysicalColumn(t)],o=m.getCellMetaKeyValue(n,i,r);!1!==L.runHooks("beforeRemoveCellMeta",e,t,r,o)&&(m.removeCellMeta(n,i,r),L.runHooks("afterRemoveCellMeta",e,t,r,o))},this.spliceCellsMeta=function(r){for(var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length,n=new Array(2<t?t-2:0),i=2;i<t;i++)n[i-2]=arguments[i];if(0<n.length&&!Array.isArray(n[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");0<e&&m.removeRow(this.toPhysicalRow(r),e),0<n.length&&(0,U.arrayEach)(n.reverse(),e=>{m.createRow(this.toPhysicalRow(r)),(0,U.arrayEach)(e,(e,t)=>this.setCellMetaObject(r,t,e))}),L.render()},this.setCellMetaObject=function(r,n,e){"object"==typeof e&&(0,H.objectEach)(e,(e,t)=>{this.setCellMeta(r,n,t,e)})},this.setCellMeta=function(r,n,i,o){var e=L.runHooks("beforeSetCellMeta",r,n,i,o);if(!1!==e){let e=r,t=n;r<this.countRows()&&(e=this.toPhysicalRow(r)),n<this.countCols()&&(t=this.toPhysicalColumn(n)),m.setCellMeta(e,t,i,o),L.runHooks("afterSetCellMeta",r,n,i,o)}},this.getCellsMeta=function(){return m.getCellsMeta()},this.getCellMeta=function(e,t){let r=this.toPhysicalRow(e),n=this.toPhysicalColumn(t);return null===r&&(r=e),null===n&&(n=t),m.getCellMeta(r,n,{visualRow:e,visualColumn:t})},this.getColumnMeta=function(e){return m.getColumnMeta(this.toPhysicalColumn(e))},this.getCellMetaAtRow=function(e){return m.getCellsMetaAtRow(e)},this.isColumnModificationAllowed=function(){return!("object"===L.dataType||F.columns)},this.getCellRenderer=function(e,t){t=("number"==typeof e?L.getCellMeta(e,t):e).renderer;return"string"==typeof t?(0,W.getRenderer)(t):(0,O.isUndefined)(t)?(0,W.getRenderer)("text"):t},this.getCellEditor=function(e,t){t=("number"==typeof e?L.getCellMeta(e,t):e).editor;return"string"==typeof t?(0,$.getEditor)(t):(0,O.isUndefined)(t)?(0,$.getEditor)("text"):t},this.getCellValidator=function(e,t){t=("number"==typeof e?L.getCellMeta(e,t):e).validator;return"string"==typeof t?(0,B.getValidator)(t):t},this.validateCells=function(e){this._validateCells(e)},this.validateRows=function(e,t){if(!Array.isArray(e))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(t,e)},this.validateColumns=function(e,t){if(!Array.isArray(e))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(t,void 0,e)},this._validateCells=function(e,t,r){const n=new C;e&&(n.onQueueEmpty=e);let i=L.countRows()-1;for(;0<=i;){if(void 0!==t&&-1===t.indexOf(i));else{let e=L.countCols()-1;for(;0<=e;)void 0!==r&&-1===r.indexOf(e)||(n.addValidatorToQueue(),L.validateCell(L.getDataAtCell(i,e),L.getCellMeta(i,e),e=>{if("boolean"!=typeof e)throw new Error("Validation error: result is not boolean");!1===e&&(n.valid=!1),n.removeValidatorFormQueue()},"validateCells")),--e}--i}n.checkIfQueueIsEmpty()},this.getRowHeader=function(e){let t=F.rowHeaders,r=e;return void 0===(r=void 0!==r?L.runHooks("modifyRowHeader",r):r)?(t=[],(0,z.rangeEach)(L.countRows()-1,e=>{t.push(L.getRowHeader(e))})):Array.isArray(t)&&void 0!==t[r]?t=t[r]:(0,N.isFunction)(t)?t=t(r):t&&"string"!=typeof t&&"number"!=typeof t&&(t=r+1),t},this.hasRowHeaders=function(){return!!F.rowHeaders},this.hasColHeaders=function(){if(void 0!==F.colHeaders&&null!==F.colHeaders)return!!F.colHeaders;for(let e=0,t=L.countCols();e<t;e++)if(L.getColHeader(e))return!0;return!1},this.getColHeader=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1,r=L.runHooks("modifyColHeader",e);if(void 0===r){var n=[],i=L.countCols();for(let e=0;e<i;e++)n.push(L.getColHeader(e));return n}let o=F.colHeaders;var s=L.toPhysicalColumn(r),a=function(e){var t=[],r=L.countCols();let n=0;for(;n<r;n++)(0,N.isFunction)(F.columns)&&F.columns(n)&&t.push(n);return t[e]}(s);return!1===F.colHeaders?o=null:F.columns&&(0,N.isFunction)(F.columns)&&F.columns(a)&&F.columns(a).title?o=F.columns(a).title:F.columns&&F.columns[s]&&F.columns[s].title?o=F.columns[s].title:Array.isArray(F.colHeaders)&&void 0!==F.colHeaders[s]?o=F.colHeaders[s]:(0,N.isFunction)(F.colHeaders)?o=F.colHeaders(s):F.colHeaders&&"string"!=typeof F.colHeaders&&"number"!=typeof F.colHeaders&&(o=(0,q.spreadsheetColumnLabel)(r)),o=L.runHooks("modifyColumnHeaderValue",o,e,t)},this._getColWidthFromSettings=function(e){let t;var r;if(0<=e&&(r=L.getCellMeta(0,e),t=r.width),void 0!==(t=void 0!==t&&t!==F.width?t:F.colWidths)&&null!==t){switch(typeof t){case"object":t=t[e];break;case"function":t=t(e)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getColWidth=function(e){let t=L._getColWidthFromSettings(e);return t=void 0===(t=L.runHooks("modifyColWidth",t,e))?J.DEFAULT_COLUMN_WIDTH:t},this._getRowHeightFromSettings=function(e){let t=F.rowHeights;if(void 0!==t&&null!==t){switch(typeof t){case"object":t=t[e];break;case"function":t=t(e)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getRowHeight=function(e){var t=L._getRowHeightFromSettings(e);return L.runHooks("modifyRowHeight",t,e)},this.countSourceRows=function(){return d.countRows()},this.countSourceCols=function(){return d.countFirstRowKeys()},this.countRows=function(){return p.getLength()},this.countCols=function(){var e=F.maxCols,t=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(e,t)},this.countRenderedRows=function(){return L.view._wt.drawn?L.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return L.view._wt.drawn?L.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return L.view._wt.drawn?L.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return L.view._wt.drawn?L.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],r=0;return(0,z.rangeEachReverse)(L.countRows()-1,e=>{if(L.isEmptyRow(e))r+=1;else if(!0===t)return!1}),r},this.countEmptyCols=function(){let t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],r=0;return(0,z.rangeEachReverse)(L.countCols()-1,e=>{if(L.isEmptyCol(e))r+=1;else if(!0===t)return!1}),r},this.isEmptyRow=function(e){return F.isEmptyRow.call(L,e)},this.isEmptyCol=function(e){return F.isEmptyCol.call(L,e)},this.selectCell=function(e,t,r,n){var i=!(4<arguments.length&&void 0!==arguments[4])||arguments[4],o=!(5<arguments.length&&void 0!==arguments[5])||arguments[5];return!(0,O.isUndefined)(e)&&!(0,O.isUndefined)(t)&&this.selectCells([[e,t,r,n]],i,o)},this.selectCells=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[[]],t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],r=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],t=(!1===t&&s.suspend(),b.selectCells(e));return t&&r&&L.listen(),s.resume(),t},this.selectColumns=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:e,r=2<arguments.length?arguments[2]:void 0;return b.selectColumns(e,t,r)},this.selectRows=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:e,r=2<arguments.length?arguments[2]:void 0;return b.selectRows(e,t,r)},this.deselectCell=function(){b.deselect()},this.selectAll=function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:e,r=2<arguments.length?arguments[2]:void 0;s.skipNextScrollCycle(),b.selectAll(e,t,r)};const x=(e,t)=>e.getNearestNotHiddenIndex(t,1,!0);this.scrollViewportTo=function(e){var{row:e,col:t,verticalSnap:r,horizontalSnap:n,considerHiddenIndexes:i}=null!=(t=e="number"==typeof e?{row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:null==(t=arguments[4])||t}:e)?t:{};let o,s,a,l,c=(void 0!==r&&(o="top"===r,s=!o),void 0!==n&&(a="start"===n,l=!a),e),u=t;if(void 0===i||i){var r=Number.isInteger(e)&&0<=e,n=Number.isInteger(t)&&0<=t,i=r?x(this.rowIndexMapper,e):void 0,d=n?x(this.columnIndexMapper,t):void 0;if(null===i||null===d)return!1;c=r?L.rowIndexMapper.getRenderableFromVisualIndex(i):e,u=n?L.columnIndexMapper.getRenderableFromVisualIndex(d):t}r=Number.isInteger(c),i=Number.isInteger(u);return r&&0<=c&&i&&0<=u?L.view.scrollViewport(L._createCellCoords(c,u),o,l,s,a):r&&0<=c&&(i&&u<0||!i)?L.view.scrollViewportVertically(c,o,s):!!(i&&0<=u&&(r&&c<0||!r))&&L.view.scrollViewportHorizontally(u,l,a)},this.scrollToFocusedCell=function(){let e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:()=>{};var t;this.selection.isSelected()&&(this.addHookOnce("afterScroll",e),t=this.getSelectedRangeLast()["highlight"],this.scrollViewportTo(t.toObject())?this.view.render():(this.removeHook("afterScroll",e),this._registerImmediate(()=>e())))},this.destroy=function(){var e;L._clearTimeouts(),L._clearImmediates(),L.view&&L.view.destroy(),d&&d.destroy(),d=null,this.getShortcutManager().destroy(),m.clearCache(),le.delete(this.guid),(0,X.isRootInstance)(L)&&(e=this.rootDocument.querySelector(".hot-display-license-info"))&&e.parentNode.removeChild(e),(0,A.empty)(L.rootElement),i.destroy(),c&&c.destroy(),L.batchExecution(()=>{L.rowIndexMapper.unregisterAll(),L.columnIndexMapper.unregisterAll(),u.getItems().forEach(e=>{var[,e]=e;e.destroy()}),u.clear(),L.runHooks("afterDestroy")},!0),Z.default.getSingleton().destroy(L),(0,H.objectEach)(L,(e,t,r)=>{var n;(0,N.isFunction)(e)?r[t]=(n=t,()=>{throw new Error(`The "${n}" method cannot be called because this Handsontable instance has been destroyed`)}):"guid"!==t&&(r[t]=null)}),L.isDestroyed=!0,p&&p.destroy(),p=null,f=null,b=null,c=null,L=null},this.getActiveEditor=function(){return c.getActiveEditor()},this.getPlugin=function(e){e=(0,j.toUpperCaseFirst)(e);return"UndoRedo"===e?this.undoRedo:u.getItem(e)},this.getPluginName=function(e){return e===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:u.getId(e)},this.getInstance=function(){return L},this.addHook=function(e,t,r){Z.default.getSingleton().add(e,t,L,r)},this.hasHook=function(e){return Z.default.getSingleton().has(e,L)||Z.default.getSingleton().has(e)},this.addHookOnce=function(e,t,r){Z.default.getSingleton().once(e,t,L,r)},this.removeHook=function(e,t){Z.default.getSingleton().remove(e,t,L)},this.runHooks=function(e,t,r,n,i,o,s){return Z.default.getSingleton().run(L,e,t,r,n,i,o,s)},this.getTranslatedPhrase=function(e,t){return(0,Q.getTranslatedPhrase)(F.language,e,t)},this.toHTML=()=>(0,P.instanceToHTML)(this),this.toTableElement=()=>{var e=this.rootDocument.createElement("div");return e.insertAdjacentHTML("afterbegin",(0,P.instanceToHTML)(this)),e.firstElementChild},this.timeouts=[],this._registerTimeout=function(e){let t=e;"function"==typeof t&&(t=setTimeout(t,1<arguments.length&&void 0!==arguments[1]?arguments[1]:0)),this.timeouts.push(t)},this._clearTimeouts=function(){(0,U.arrayEach)(this.timeouts,e=>{clearTimeout(e)})},this.immediates=[],this._registerImmediate=function(e){this.immediates.push(setImmediate(e))},this._clearImmediates=function(){(0,U.arrayEach)(this.immediates,e=>{clearImmediate(e)})},this._getEditorManager=function(){return c},this.isRtl=function(){return"rtl"===L.rootWindow.getComputedStyle(L.rootElement).direction},this.isLtr=function(){return!L.isRtl()},this.getDirectionFactor=function(){return L.isLtr()?1:-1};const R=(0,oe.createShortcutManager)({handleEvent(){return L.isListening()},beforeKeyDown:e=>this.runHooks("beforeKeyDown",e),afterKeyDown:e=>{this.isDestroyed||L.runHooks("afterDocumentKeyDown",e)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",e=>{!1===e.ctrlKey&&!1===e.metaKey&&R.releasePressedKeys()}),this.getShortcutManager=function(){return R},this.getFocusManager=function(){return o},(0,V.getPluginsNames)().forEach(e=>{var t=(0,V.getPlugin)(e);u.addItem(e,new t(this))}),(0,se.registerAllShortcutContexts)(L),R.setActiveContextName("grid"),Z.default.getSingleton().run(L,"construct")},t(204),t(286),t(290),t(302),t(305),t(309),t(312),t(315),t(318),t(321),t(334)),N=t(480),O=t(337),I=t(481),M=r(t(486)),k=r(t(502)),H=t(482),D=t(503),U=t(478),P=t(504),V=t(510),W=t(515),$=t(493),B=t(516),j=t(335),z=t(512),Y=r(t(517)),G=r(t(595)),q=t(596),K=t(597),X=t(594),J=t(518),Z=r(t(494)),Q=t(616),ee=t(617),te=t(622),re=t(638),ne=t(654),ie=t(513),oe=t(717),se=t(656);let ae=null;const le=new Map;new Set},(e,t,r)=>{"use strict";function n(e,t){var r={};r[e]=l(e,t,d),o({global:!0,constructor:!0,arity:1,forced:d},r)}function i(e,t){var r;u&&u[e]&&((r={})[e]=l(c+"."+e,t,d),o({target:c,stat:!0,constructor:!0,arity:1,forced:d},r))}var o=r(205),s=r(206),a=r(270),l=r(271),c="WebAssembly",u=s[c],d=7!==new Error("e",{cause:7}).cause;n("Error",function(t){return function(e){return a(t,this,arguments)}}),n("EvalError",function(t){return function(e){return a(t,this,arguments)}}),n("RangeError",function(t){return function(e){return a(t,this,arguments)}}),n("ReferenceError",function(t){return function(e){return a(t,this,arguments)}}),n("SyntaxError",function(t){return function(e){return a(t,this,arguments)}}),n("TypeError",function(t){return function(e){return a(t,this,arguments)}}),n("URIError",function(t){return function(e){return a(t,this,arguments)}}),i("CompileError",function(t){return function(e){return a(t,this,arguments)}}),i("LinkError",function(t){return function(e){return a(t,this,arguments)}}),i("RuntimeError",function(t){return function(e){return a(t,this,arguments)}})},(e,t,r)=>{"use strict";var c=r(206),u=r(207).f,d=r(245),h=r(249),p=r(239),f=r(257),g=r(269);e.exports=function(e,t){var r,n,i,o=e.target,s=e.global,a=e.stat,l=s?c:a?c[o]||p(o,{}):c[o]&&c[o].prototype;if(l)for(r in t){if(n=t[r],i=e.dontCallGetSet?(i=u(l,r))&&i.value:l[r],!g(s?r:o+(a?".":"#")+r,e.forced)&&void 0!==i){if(typeof n==typeof i)continue;f(n,i)}(e.sham||i&&i.sham)&&d(n,"sham",!0),h(l,r,n,e)}}},function(e){"use strict";function t(e){return e&&e.Math===Math&&e}e.exports=t("object"==typeof globalThis&&globalThis)||t("object"==typeof window&&window)||t("object"==typeof self&&self)||t("object"==typeof global&&global)||t("object"==typeof this&&this)||function(){return this}()||Function("return this")()},(e,t,r)=>{"use strict";var n=r(208),i=r(210),o=r(212),s=r(213),a=r(214),l=r(220),c=r(240),u=r(243),d=Object.getOwnPropertyDescriptor;t.f=n?d:function(e,t){if(e=a(e),t=l(t),u)try{return d(e,t)}catch(e){}if(c(e,t))return s(!i(o.f,e,t),e[t])}},(e,t,r)=>{"use strict";r=r(209);e.exports=!r(function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})},e=>{"use strict";e.exports=function(e){try{return!!e()}catch(e){return!0}}},(e,t,r)=>{"use strict";var r=r(211),n=Function.prototype.call;e.exports=r?n.bind(n):function(){return n.apply(n,arguments)}},(e,t,r)=>{"use strict";r=r(209);e.exports=!r(function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})},(e,t)=>{"use strict";var r={}.propertyIsEnumerable,n=Object.getOwnPropertyDescriptor,i=n&&!r.call({1:2},1);t.f=i?function(e){e=n(this,e);return!!e&&e.enumerable}:r},e=>{"use strict";e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},(e,t,r)=>{"use strict";var n=r(215),i=r(218);e.exports=function(e){return n(i(e))}},(e,t,r)=>{"use strict";var n=r(216),i=r(209),o=r(217),s=Object,a=n("".split);e.exports=i(function(){return!s("z").propertyIsEnumerable(0)})?function(e){return"String"===o(e)?a(e,""):s(e)}:s},(e,t,r)=>{"use strict";var r=r(211),n=Function.prototype,i=n.call,n=r&&n.bind.bind(i,i);e.exports=r?n:function(e){return function(){return i.apply(e,arguments)}}},(e,t,r)=>{"use strict";var r=r(216),n=r({}.toString),i=r("".slice);e.exports=function(e){return i(n(e),8,-1)}},(e,t,r)=>{"use strict";var n=r(219),i=TypeError;e.exports=function(e){if(n(e))throw new i("Can't call method on "+e);return e}},e=>{"use strict";e.exports=function(e){return null==e}},(e,t,r)=>{"use strict";var n=r(221),i=r(224);e.exports=function(e){e=n(e,"string");return i(e)?e:e+""}},(e,t,r)=>{"use strict";var n=r(210),i=r(222),o=r(224),s=r(231),a=r(234),r=r(235),l=TypeError,c=r("toPrimitive");e.exports=function(e,t){if(!i(e)||o(e))return e;var r=s(e,c);if(r){if(r=n(r,e,t=void 0===t?"default":t),!i(r)||o(r))return r;throw new l("Can't convert object to primitive value")}return a(e,t=void 0===t?"number":t)}},(e,t,r)=>{"use strict";var n=r(223);e.exports=function(e){return"object"==typeof e?null!==e:n(e)}},e=>{"use strict";var t="object"==typeof document&&document.all;e.exports=void 0===t&&void 0!==t?function(e){return"function"==typeof e||e===t}:function(e){return"function"==typeof e}},(e,t,r)=>{"use strict";var n=r(225),i=r(223),o=r(226),r=r(227),s=Object;e.exports=r?function(e){return"symbol"==typeof e}:function(e){var t=n("Symbol");return i(t)&&o(t.prototype,s(e))}},(e,t,r)=>{"use strict";var n=r(206),i=r(223);e.exports=function(e,t){return arguments.length<2?(r=n[e],i(r)?r:void 0):n[e]&&n[e][t];var r}},(e,t,r)=>{"use strict";r=r(216);e.exports=r({}.isPrototypeOf)},(e,t,r)=>{"use strict";r=r(228);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},(e,t,r)=>{"use strict";var n=r(229),i=r(209),o=r(206).String;e.exports=!!Object.getOwnPropertySymbols&&!i(function(){var e=Symbol("symbol detection");return!o(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&n&&n<41})},(e,t,r)=>{"use strict";var n,i,o=r(206),r=r(230),s=o.process,o=o.Deno,s=s&&s.versions||o&&o.version,o=s&&s.v8;!(i=o?0<(n=o.split("."))[0]&&n[0]<4?1:+(n[0]+n[1]):i)&&r&&(!(n=r.match(/Edge\/(\d+)/))||74<=n[1])&&(n=r.match(/Chrome\/(\d+)/))&&(i=+n[1]),e.exports=i},e=>{"use strict";e.exports="undefined"!=typeof navigator&&String(navigator.userAgent)||""},(e,t,r)=>{"use strict";var n=r(232),i=r(219);e.exports=function(e,t){e=e[t];return i(e)?void 0:n(e)}},(e,t,r)=>{"use strict";var n=r(223),i=r(233),o=TypeError;e.exports=function(e){if(n(e))return e;throw new o(i(e)+" is not a function")}},e=>{"use strict";var t=String;e.exports=function(e){try{return t(e)}catch(e){return"Object"}}},(e,t,r)=>{"use strict";var i=r(210),o=r(223),s=r(222),a=TypeError;e.exports=function(e,t){var r,n;if("string"===t&&o(r=e.toString)&&!s(n=i(r,e)))return n;if(o(r=e.valueOf)&&!s(n=i(r,e)))return n;if("string"!==t&&o(r=e.toString)&&!s(n=i(r,e)))return n;throw new a("Can't convert object to primitive value")}},(e,t,r)=>{"use strict";var n=r(206),i=r(236),o=r(240),s=r(242),a=r(228),r=r(227),l=n.Symbol,c=i("wks"),u=r?l.for||l:l&&l.withoutSetter||s;e.exports=function(e){return o(c,e)||(c[e]=a&&o(l,e)?l[e]:u("Symbol."+e)),c[e]}},(e,t,r)=>{"use strict";var n=r(237);e.exports=function(e,t){return n[e]||(n[e]=t||{})}},(e,t,r)=>{"use strict";var n=r(238),i=r(206),r=r(239),o="__core-js_shared__",e=e.exports=i[o]||r(o,{});(e.versions||(e.versions=[])).push({version:"3.37.1",mode:n?"pure":"global",copyright:"© 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.37.1/LICENSE",source:"https://github.com/zloirock/core-js"})},e=>{"use strict";e.exports=!1},(e,t,r)=>{"use strict";var n=r(206),i=Object.defineProperty;e.exports=function(t,r){try{i(n,t,{value:r,configurable:!0,writable:!0})}catch(e){n[t]=r}return r}},(e,t,r)=>{"use strict";var n=r(216),i=r(241),o=n({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return o(i(e),t)}},(e,t,r)=>{"use strict";var n=r(218),i=Object;e.exports=function(e){return i(n(e))}},(e,t,r)=>{"use strict";var r=r(216),n=0,i=Math.random(),o=r(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+o(++n+i,36)}},(e,t,r)=>{"use strict";var n=r(208),i=r(209),o=r(244);e.exports=!n&&!i(function(){return 7!==Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a})},(e,t,r)=>{"use strict";var n=r(206),r=r(222),i=n.document,o=r(i)&&r(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},(e,t,r)=>{"use strict";var n=r(208),i=r(246),o=r(213);e.exports=n?function(e,t,r){return i.f(e,t,o(1,r))}:function(e,t,r){return e[t]=r,e}},(e,t,r)=>{"use strict";var n=r(208),i=r(243),o=r(247),s=r(248),a=r(220),l=TypeError,c=Object.defineProperty,u=Object.getOwnPropertyDescriptor,d="enumerable",h="configurable",p="writable";t.f=n?o?function(e,t,r){var n;return s(e),t=a(t),s(r),"function"==typeof e&&"prototype"===t&&"value"in r&&p in r&&!r[p]&&(n=u(e,t))&&n[p]&&(e[t]=r.value,r={configurable:(h in r?r:n)[h],enumerable:(d in r?r:n)[d],writable:!1}),c(e,t,r)}:c:function(e,t,r){if(s(e),t=a(t),s(r),i)try{return c(e,t,r)}catch(e){}if("get"in r||"set"in r)throw new l("Accessors not supported");return"value"in r&&(e[t]=r.value),e}},(e,t,r)=>{"use strict";var n=r(208),r=r(209);e.exports=n&&r(function(){return 42!==Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype})},(e,t,r)=>{"use strict";var n=r(222),i=String,o=TypeError;e.exports=function(e){if(n(e))return e;throw new o(i(e)+" is not an object")}},(e,t,r)=>{"use strict";var s=r(223),a=r(246),l=r(250),c=r(239);e.exports=function(e,t,r,n){var i=(n=n||{}).enumerable,o=void 0!==n.name?n.name:t;if(s(r)&&l(r,o,n),n.global)i?e[t]=r:c(t,r);else{try{n.unsafe?e[t]&&(i=!0):delete e[t]}catch(e){}i?e[t]=r:a.f(e,t,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return e}},(e,t,r)=>{"use strict";var n=r(216),i=r(209),o=r(223),s=r(240),a=r(208),l=r(251).CONFIGURABLE,c=r(252),r=r(253),u=r.enforce,d=r.get,h=String,p=Object.defineProperty,f=n("".slice),g=n("".replace),m=n([].join),y=a&&!i(function(){return 8!==p(function(){},"length",{value:8}).length}),v=String(String).split("String"),r=e.exports=function(e,t,r){"Symbol("===f(h(t),0,7)&&(t="["+g(h(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!s(e,"name")||l&&e.name!==t)&&(a?p(e,"name",{value:t,configurable:!0}):e.name=t),y&&r&&s(r,"arity")&&e.length!==r.arity&&p(e,"length",{value:r.arity});try{r&&s(r,"constructor")&&r.constructor?a&&p(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(e){}r=u(e);return s(r,"source")||(r.source=m(v,"string"==typeof t?t:"")),e};Function.prototype.toString=r(function(){return o(this)&&d(this).source||c(this)},"toString")},(e,t,r)=>{"use strict";var n=r(208),r=r(240),i=Function.prototype,o=n&&Object.getOwnPropertyDescriptor,r=r(i,"name"),s=r&&"something"===function(){}.name,n=r&&(!n||o(i,"name").configurable);e.exports={EXISTS:r,PROPER:s,CONFIGURABLE:n}},(e,t,r)=>{"use strict";var n=r(216),i=r(223),r=r(237),o=n(Function.toString);i(r.inspectSource)||(r.inspectSource=function(e){return o(e)}),e.exports=r.inspectSource},(e,t,r)=>{"use strict";var n,i,o,s,a=r(254),l=r(206),c=r(222),u=r(245),d=r(240),h=r(237),p=r(255),r=r(256),f="Object already initialized",g=l.TypeError,l=l.WeakMap,m=a||h.state?((o=h.state||(h.state=new l)).get=o.get,o.has=o.has,o.set=o.set,n=function(e,t){if(o.has(e))throw new g(f);return t.facade=e,o.set(e,t),t},i=function(e){return o.get(e)||{}},function(e){return o.has(e)}):(r[s=p("state")]=!0,n=function(e,t){if(d(e,s))throw new g(f);return t.facade=e,u(e,s,t),t},i=function(e){return d(e,s)?e[s]:{}},function(e){return d(e,s)});e.exports={set:n,get:i,has:m,enforce:function(e){return m(e)?i(e):n(e,{})},getterFor:function(t){return function(e){if(c(e)&&(e=i(e)).type===t)return e;throw new g("Incompatible receiver, "+t+" required")}}}},(e,t,r)=>{"use strict";var n=r(206),r=r(223),n=n.WeakMap;e.exports=r(n)&&/native code/.test(String(n))},(e,t,r)=>{"use strict";var n=r(236),i=r(242),o=n("keys");e.exports=function(e){return o[e]||(o[e]=i(e))}},e=>{"use strict";e.exports={}},(e,t,r)=>{"use strict";var l=r(240),c=r(258),u=r(207),d=r(246);e.exports=function(e,t,r){for(var n=c(t),i=d.f,o=u.f,s=0;s<n.length;s++){var a=n[s];l(e,a)||r&&l(r,a)||i(e,a,o(t,a))}}},(e,t,r)=>{"use strict";var n=r(225),i=r(216),o=r(259),s=r(268),a=r(248),l=i([].concat);e.exports=n("Reflect","ownKeys")||function(e){var t=o.f(a(e)),r=s.f;return r?l(t,r(e)):t}},(e,t,r)=>{"use strict";var n=r(260),i=r(267).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return n(e,i)}},(e,t,r)=>{"use strict";var n=r(216),s=r(240),a=r(214),l=r(261).indexOf,c=r(256),u=n([].push);e.exports=function(e,t){var r,n=a(e),i=0,o=[];for(r in n)!s(c,r)&&s(n,r)&&u(o,r);for(;t.length>i;)!s(n,r=t[i++])||~l(o,r)||u(o,r);return o}},(e,t,r)=>{"use strict";function n(a){return function(e,t,r){var n=l(e),i=u(n);if(0!==i){var o,s=c(r,i);if(a&&t!=t){for(;s<i;)if((o=n[s++])!=o)return!0}else for(;s<i;s++)if((a||s in n)&&n[s]===t)return a||s||0}return!a&&-1}}var l=r(214),c=r(262),u=r(265);e.exports={includes:n(!0),indexOf:n(!1)}},(e,t,r)=>{"use strict";var n=r(263),i=Math.max,o=Math.min;e.exports=function(e,t){e=n(e);return e<0?i(e+t,0):o(e,t)}},(e,t,r)=>{"use strict";var n=r(264);e.exports=function(e){e=+e;return e!=e||0==e?0:n(e)}},e=>{"use strict";var t=Math.ceil,r=Math.floor;e.exports=Math.trunc||function(e){e=+e;return(0<e?r:t)(e)}},(e,t,r)=>{"use strict";var n=r(266);e.exports=function(e){return n(e.length)}},(e,t,r)=>{"use strict";var n=r(263),i=Math.min;e.exports=function(e){e=n(e);return 0<e?i(e,9007199254740991):0}},e=>{"use strict";e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},(e,t)=>{"use strict";t.f=Object.getOwnPropertySymbols},(e,t,r)=>{"use strict";function n(e,t){return(e=l[a(e)])===u||e!==c&&(o(t)?i(t):!!t)}var i=r(209),o=r(223),s=/#|\.prototype\./,a=n.normalize=function(e){return String(e).replace(s,".").toLowerCase()},l=n.data={},c=n.NATIVE="N",u=n.POLYFILL="P";e.exports=n},(e,t,r)=>{"use strict";var r=r(211),n=Function.prototype,i=n.apply,o=n.call;e.exports="object"==typeof Reflect&&Reflect.apply||(r?o.bind(i):function(){return o.apply(i,arguments)})},(e,t,r)=>{"use strict";var u=r(225),d=r(240),h=r(245),p=r(226),f=r(272),g=r(257),m=r(276),y=r(277),v=r(278),b=r(282),w=r(283),C=r(208),E=r(238);e.exports=function(e,t,r,n){var i="stackTraceLimit",o=n?2:1,e=e.split("."),s=e[e.length-1],a=u.apply(null,e);if(a){var l=a.prototype;if(!E&&d(l,"cause")&&delete l.cause,!r)return a;var e=u("Error"),c=t(function(e,t){t=v(n?t:e,void 0),e=n?new a(e):new a;return void 0!==t&&h(e,"message",t),w(e,c,e.stack,2),this&&p(l,this)&&y(e,this,c),o<arguments.length&&b(e,arguments[o]),e});if(c.prototype=l,"Error"!==s?f?f(c,e):g(c,e,{name:!0}):C&&i in a&&(m(c,a,i),m(c,a,"prepareStackTrace")),g(c,a),!E)try{l.name!==s&&h(l,"name",s),l.constructor=c}catch(e){}return c}}},(e,t,r)=>{"use strict";var i=r(273),o=r(222),s=r(218),a=r(274);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var r,n=!1,e={};try{(r=i(Object.prototype,"__proto__","set"))(e,[]),n=e instanceof Array}catch(e){}return function(e,t){return s(e),a(t),o(e)&&(n?r(e,t):e.__proto__=t),e}}():void 0)},(e,t,r)=>{"use strict";var n=r(216),i=r(232);e.exports=function(e,t,r){try{return n(i(Object.getOwnPropertyDescriptor(e,t)[r]))}catch(e){}}},(e,t,r)=>{"use strict";var n=r(275),i=String,o=TypeError;e.exports=function(e){if(n(e))return e;throw new o("Can't set "+i(e)+" as a prototype")}},(e,t,r)=>{"use strict";var n=r(222);e.exports=function(e){return n(e)||null===e}},(e,t,r)=>{"use strict";var n=r(246).f;e.exports=function(e,t,r){r in e||n(e,r,{configurable:!0,get:function(){return t[r]},set:function(e){t[r]=e}})}},(e,t,r)=>{"use strict";var n=r(223),i=r(222),o=r(272);e.exports=function(e,t,r){return o&&n(t=t.constructor)&&t!==r&&i(t=t.prototype)&&t!==r.prototype&&o(e,t),e}},(e,t,r)=>{"use strict";var n=r(279);e.exports=function(e,t){return void 0===e?arguments.length<2?"":t:n(e)}},(e,t,r)=>{"use strict";var n=r(280),i=String;e.exports=function(e){if("Symbol"===n(e))throw new TypeError("Cannot convert a Symbol value to a string");return i(e)}},(e,t,r)=>{"use strict";var n=r(281),i=r(223),o=r(217),s=r(235)("toStringTag"),a=Object,l="Arguments"===o(function(){return arguments}());e.exports=n?o:function(e){var t;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(t=function(e,t){try{return e[t]}catch(e){}}(e=a(e),s))?t:l?o(e):"Object"===(t=o(e))&&i(e.callee)?"Arguments":t}},(e,t,r)=>{"use strict";var n={};n[r(235)("toStringTag")]="z",e.exports="[object z]"===String(n)},(e,t,r)=>{"use strict";var n=r(222),i=r(245);e.exports=function(e,t){n(t)&&"cause"in t&&i(e,"cause",t.cause)}},(e,t,r)=>{"use strict";var i=r(245),o=r(284),s=r(285),a=Error.captureStackTrace;e.exports=function(e,t,r,n){s&&(a?a(e,t):i(e,"stack",o(r,n)))}},(e,t,r)=>{"use strict";var r=r(216),n=Error,i=r("".replace),r=String(new n("zxcasd").stack),o=/\n\s*at [^:]*:[^\n]*/,s=o.test(r);e.exports=function(e,t){if(s&&"string"==typeof e&&!n.prepareStackTrace)for(;t--;)e=i(e,o,"");return e}},(e,t,r)=>{"use strict";var n=r(209),i=r(213);e.exports=!n(function(){var e=new Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",i(1,7)),7!==e.stack)})},(e,t,r)=>{"use strict";var n=r(205),o=r(241),s=r(265),a=r(287),l=r(289);n({target:"Array",proto:!0,arity:1,forced:r(209)(function(){return 4294967297!==[].push.call({length:4294967296},1)})||!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(e){return e instanceof TypeError}}()},{push:function(e){var t=o(this),r=s(t),n=arguments.length;l(r+n);for(var i=0;i<n;i++)t[r]=arguments[i],r++;return a(t,r),r}})},(e,t,r)=>{"use strict";var n=r(208),i=r(288),o=TypeError,s=Object.getOwnPropertyDescriptor,r=n&&!function(){if(void 0!==this)return 1;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}();e.exports=r?function(e,t){if(i(e)&&!s(e,"length").writable)throw new o("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t}},(e,t,r)=>{"use strict";var n=r(217);e.exports=Array.isArray||function(e){return"Array"===n(e)}},e=>{"use strict";var t=TypeError;e.exports=function(e){if(9007199254740991<e)throw t("Maximum allowed index exceeded");return e}},(e,t,r)=>{"use strict";r(291)},(e,t,r)=>{"use strict";var n=r(205),i=r(292);n({target:"Set",proto:!0,real:!0,forced:!r(301)("difference")},{difference:i})},(e,t,r)=>{"use strict";var i=r(293),n=r(294),o=r(295),s=r(298),a=r(299),l=r(296),c=r(297),u=n.has,d=n.remove;e.exports=function(e){var t=i(this),r=a(e),n=o(t);return s(t)<=r.size?l(t,function(e){r.includes(e)&&d(n,e)}):c(r.getIterator(),function(e){u(t,e)&&d(n,e)}),n}},(e,t,r)=>{"use strict";var n=r(294).has;e.exports=function(e){return n(e),e}},(e,t,r)=>{"use strict";var r=r(216),n=Set.prototype;e.exports={Set:Set,add:r(n.add),has:r(n.has),remove:r(n.delete),proto:n}},(e,t,r)=>{"use strict";var n=r(294),i=r(296),o=n.Set,s=n.add;e.exports=function(e){var t=new o;return i(e,function(e){s(t,e)}),t}},(e,t,r)=>{"use strict";var n=r(216),i=r(297),r=r(294),o=r.Set,r=r.proto,s=n(r.forEach),a=n(r.keys),l=a(new o).next;e.exports=function(e,t,r){return r?i({iterator:a(e),next:l},t):s(e,t)}},(e,t,r)=>{"use strict";var s=r(210);e.exports=function(e,t,r){for(var n,i=r?e:e.iterator,o=e.next;!(n=s(o,i)).done;)if(void 0!==(n=t(n.value)))return n}},(e,t,r)=>{"use strict";var n=r(273),r=r(294);e.exports=n(r.proto,"size","get")||function(e){return e.size}},(e,t,r)=>{"use strict";function n(e,t){this.set=e,this.size=h(t,0),this.has=i(e.has),this.keys=i(e.keys)}var i=r(232),o=r(248),s=r(210),a=r(263),l=r(300),c="Invalid size",u=RangeError,d=TypeError,h=Math.max;n.prototype={getIterator:function(){return l(o(s(this.keys,this.set)))},includes:function(e){return s(this.has,this.set,e)}},e.exports=function(e){o(e);var t=+e.size;if(t!=t)throw new d(c);t=a(t);if(t<0)throw new u(c);return new n(e,t)}},e=>{"use strict";e.exports=function(e){return{iterator:e,next:e.next,done:!1}}},(e,t,r)=>{"use strict";function n(e){return{size:e,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}}var i=r(225);e.exports=function(e){var t=i("Set");try{(new t)[e](n(0));try{return(new t)[e](n(-1)),!1}catch(e){return!0}}catch(e){return!1}}},(e,t,r)=>{"use strict";r(303)},(e,t,r)=>{"use strict";var n=r(205),i=r(209),o=r(304);n({target:"Set",proto:!0,real:!0,forced:!r(301)("intersection")||i(function(){return"3,2"!==String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))})},{intersection:o})},(e,t,r)=>{"use strict";var i=r(293),n=r(294),o=r(298),s=r(299),a=r(296),l=r(297),c=n.Set,u=n.add,d=n.has;e.exports=function(e){var t=i(this),r=s(e),n=new c;return o(t)>r.size?l(r.getIterator(),function(e){d(t,e)&&u(n,e)}):a(t,function(e){r.includes(e)&&u(n,e)}),n}},(e,t,r)=>{"use strict";r(306)},(e,t,r)=>{"use strict";var n=r(205),i=r(307);n({target:"Set",proto:!0,real:!0,forced:!r(301)("isDisjointFrom")},{isDisjointFrom:i})},(e,t,r)=>{"use strict";var i=r(293),o=r(294).has,s=r(298),a=r(299),l=r(296),c=r(297),u=r(308);e.exports=function(e){var t,r=i(this),n=a(e);return s(r)<=n.size?!1!==l(r,function(e){if(n.includes(e))return!1},!0):(t=n.getIterator(),!1!==c(t,function(e){if(o(r,e))return u(t,"normal",!1)}))}},(e,t,r)=>{"use strict";var o=r(210),s=r(248),a=r(231);e.exports=function(e,t,r){var n,i;s(e);try{if(!(n=a(e,"return"))){if("throw"===t)throw r;return r}n=o(n,e)}catch(e){i=!0,n=e}if("throw"===t)throw r;if(i)throw n;return s(n),r}},(e,t,r)=>{"use strict";r(310)},(e,t,r)=>{"use strict";var n=r(205),i=r(311);n({target:"Set",proto:!0,real:!0,forced:!r(301)("isSubsetOf")},{isSubsetOf:i})},(e,t,r)=>{"use strict";var n=r(293),i=r(298),o=r(296),s=r(299);e.exports=function(e){var t=n(this),r=s(e);return!(i(t)>r.size)&&!1!==o(t,function(e){if(!r.includes(e))return!1},!0)}},(e,t,r)=>{"use strict";r(313)},(e,t,r)=>{"use strict";var n=r(205),i=r(314);n({target:"Set",proto:!0,real:!0,forced:!r(301)("isSupersetOf")},{isSupersetOf:i})},(e,t,r)=>{"use strict";var n=r(293),i=r(294).has,o=r(298),s=r(299),a=r(297),l=r(308);e.exports=function(e){var t,r=n(this),e=s(e);return!(o(r)<e.size)&&(t=e.getIterator(),!1!==a(t,function(e){if(!i(r,e))return l(t,"normal",!1)}))}},(e,t,r)=>{"use strict";r(316)},(e,t,r)=>{"use strict";var n=r(205),i=r(317);n({target:"Set",proto:!0,real:!0,forced:!r(301)("symmetricDifference")},{symmetricDifference:i})},(e,t,r)=>{"use strict";var n=r(293),i=r(294),o=r(295),s=r(299),a=r(297),l=i.add,c=i.has,u=i.remove;e.exports=function(e){var t=n(this),e=s(e).getIterator(),r=o(t);return a(e,function(e){(c(t,e)?u:l)(r,e)}),r}},(e,t,r)=>{"use strict";r(319)},(e,t,r)=>{"use strict";var n=r(205),i=r(320);n({target:"Set",proto:!0,real:!0,forced:!r(301)("union")},{union:i})},(e,t,r)=>{"use strict";var n=r(293),i=r(294).add,o=r(295),s=r(299),a=r(297);e.exports=function(e){var t=n(this),e=s(e).getIterator(),r=o(t);return a(e,function(e){i(r,e)}),r}},(e,t,r)=>{"use strict";r(322),r(331)},(e,t,r)=>{"use strict";var n=r(205),i=r(206),r=r(323).clear;n({global:!0,bind:!0,enumerable:!0,forced:i.clearImmediate!==r},{clearImmediate:r})},(e,t,r)=>{"use strict";function n(e){return function(){N(e)}}function i(e){N(e.data)}function o(e){l.postMessage(_(e),s.protocol+"//"+s.host)}var s,a,l=r(206),c=r(270),u=r(324),d=r(223),h=r(240),p=r(209),f=r(326),g=r(327),m=r(244),y=r(328),v=r(329),r=r(330),b=l.setImmediate,w=l.clearImmediate,C=l.process,E=l.Dispatch,T=l.Function,S=l.MessageChannel,_=l.String,x=0,R={},A="onreadystatechange",N=(p(function(){s=l.location}),function(e){var t;h(R,e)&&(t=R[e],delete R[e],t())});b&&w||(b=function(e){y(arguments.length,1);var t=d(e)?e:T(e),r=g(arguments,1);return R[++x]=function(){c(t,void 0,r)},a(x),x},w=function(e){delete R[e]},r?a=function(e){C.nextTick(n(e))}:E&&E.now?a=function(e){E.now(n(e))}:S&&!v?(v=(r=new S).port2,r.port1.onmessage=i,a=u(v.postMessage,v)):l.addEventListener&&d(l.postMessage)&&!l.importScripts&&s&&"file:"!==s.protocol&&!p(o)?(a=o,l.addEventListener("message",i,!1)):a=A in m("script")?function(e){f.appendChild(m("script"))[A]=function(){f.removeChild(this),N(e)}}:function(e){setTimeout(n(e),0)}),e.exports={set:b,clear:w}},(e,t,r)=>{"use strict";var n=r(325),i=r(232),o=r(211),s=n(n.bind);e.exports=function(e,t){return i(e),void 0===t?e:o?s(e,t):function(){return e.apply(t,arguments)}}},(e,t,r)=>{"use strict";var n=r(217),i=r(216);e.exports=function(e){if("Function"===n(e))return i(e)}},(e,t,r)=>{"use strict";r=r(225);e.exports=r("document","documentElement")},(e,t,r)=>{"use strict";r=r(216);e.exports=r([].slice)},e=>{"use strict";var r=TypeError;e.exports=function(e,t){if(e<t)throw new r("Not enough arguments");return e}},(e,t,r)=>{"use strict";r=r(230);e.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(r)},(e,t,r)=>{"use strict";var n=r(206),r=r(217);e.exports="process"===r(n.process)},(e,t,r)=>{"use strict";var n=r(205),i=r(206),o=r(323).set,r=r(332),r=i.setImmediate?r(o,!1):o;n({global:!0,bind:!0,enumerable:!0,forced:i.setImmediate!==r},{setImmediate:r})},(e,t,r)=>{"use strict";var n=r(206),l=r(270),c=r(223),i=r(333),o=r(230),u=r(327),d=r(328),h=n.Function,p=/MSIE .\./.test(o)||i&&((r=n.Bun.version.split(".")).length<3||"0"===r[0]&&(r[1]<3||"3"===r[1]&&"0"===r[2]));e.exports=function(o,s){var a=s?2:1;return p?function(e,t){var r=d(arguments.length,1)>a,n=c(e)?e:h(e),i=r?u(arguments,a):[],e=r?function(){l(n,this,i)}:n;return s?o(e,t):o(e)}:o}},e=>{"use strict";e.exports="function"==typeof Bun&&Bun&&"string"==typeof Bun.version},(e,t,r)=>{"use strict";t.__esModule=!0,t.addClass=c,t.addEvent=function(e,t,r){e.addEventListener(t,r,!1)},t.clearTextSelection=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:window;e.getSelection&&(e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges())},t.closest=s,t.closestDown=function(e,t,r){var n=[];let i=e;for(;(i=i&&s(i,t,r))&&(!r||r.contains(i));)n.push(i),i=i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i.host:i.parentNode;e=n.length;return e?n[e-1]:null},t.empty=h,t.fastInnerHTML=function(e,t){var r=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];p.test(t)?e.innerHTML=r?(0,n.sanitize)(t):t:f(e,t)},t.fastInnerText=f,t.getCaretPosition=function(e){if(e.selectionStart)return e.selectionStart;return 0},t.getComputedStyle=y,t.getCssTransform=function(e){let t;if(e.style.transform&&""!==(t=e.style.transform))return["transform",t];return-1},t.getFrameElement=i,t.getMaximumScrollLeft=function(e){return e.scrollWidth-e.clientWidth},t.getMaximumScrollTop=function(e){return e.scrollHeight-e.clientHeight},t.getParent=function(e){let t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=-1,n=null,i=e;for(;null!==i;){if(r===t){n=i;break}i=i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i.host:(r+=1,i.parentNode)}return n},t.getParentWindow=function(e){return i(e)&&e.parent},t.getScrollLeft=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:window;return e!==t?e.scrollLeft:m(t)},t.getScrollTop=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:window;return e!==t?e.scrollTop:g(t)},t.getScrollableElement=function(e){let t=e.ownerDocument,n=t?t.defaultView:void 0;t||(t=e.document||e,n=t.defaultView);var i=["auto","scroll"];let o=e.parentNode;for(;o&&o.style&&t.body!==o;){let{overflow:e,overflowX:t,overflowY:r}=o.style;if([e,t,r].includes("scroll"))return o;if({overflow:e,overflowX:t,overflowY:r}=n.getComputedStyle(o),i.includes(e)||i.includes(t)||i.includes(r))return o;if(o.clientHeight<=o.scrollHeight+1&&(i.includes(r)||i.includes(e)))return o;if(o.clientWidth<=o.scrollWidth+1&&(i.includes(t)||i.includes(e)))return o;o=o.parentNode}return n},t.getScrollbarWidth=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:document;void 0===v&&(v=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:document;var t=e.createElement("div"),r=(t.style.height="200px",t.style.width="100%",e.createElement("div")),n=(r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(t),(e.body||e.documentElement).appendChild(r),t.offsetWidth);r.style.overflow="scroll";let i=t.offsetWidth;n===i&&(i=r.clientWidth);return(e.body||e.documentElement).removeChild(r),n-i}(e));return v},t.getSelectionEndPosition=function(e){if(e.selectionEnd)return e.selectionEnd;return 0},t.getSelectionText=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:window;var t=e.document;let r="";e.getSelection?r=e.getSelection().toString():t.selection&&"Control"!==t.selection.type&&(r=t.selection.createRange().text);return r},t.getStyle=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:window;var n;if(e)return e===r?"width"===t?r.innerWidth+"px":"height"===t?r.innerHeight+"px":void 0:""!==(n=e.style[t])&&void 0!==n?n:""!==(n=y(e,r))[t]&&void 0!==n[t]?n[t]:void 0},t.getTrimmingContainer=function(e){var t=e.ownerDocument,r=t.defaultView;let n=e.parentNode;for(;n&&n.style&&t.body!==n;){if("visible"!==n.style.overflow&&""!==n.style.overflow)return n;var i=y(n,r),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),i=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(i))return n;n=n.parentNode}return r},t.getWindowScrollLeft=m,t.getWindowScrollTop=g,t.hasAccessToParentWindow=function(e){return!!Object.getPrototypeOf(e.parent)},t.hasClass=function(e,t){return void 0!==e.classList&&"string"==typeof t&&""!==t&&e.classList.contains(t)},t.hasHorizontalScrollbar=function(e){return e.offsetHeight!==e.clientHeight},t.hasVerticalScrollbar=function(e){return e.offsetWidth!==e.clientWidth},t.index=function(e){let t=0,r=e;if(r.previousSibling)for(;r=r.previousSibling;)t+=1;return t},t.innerHeight=function(e){return e.clientHeight||e.innerHeight},t.innerWidth=function(e){return e.clientWidth||e.innerWidth},t.isChildOf=function(e,t){let r=e.parentNode,n=[];"string"==typeof t?n=e.defaultView?Array.prototype.slice.call(e.querySelectorAll(t),0):Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):n.push(t);for(;null!==r;){if(-1<n.indexOf(r))return!0;r=r.parentNode}return!1},t.isDetached=function(e){return!e.parentNode},t.isInput=b,t.isOutsideInput=w,t.isThisHotChild=function(e,t){e=e.closest(".handsontable");return!!e&&(e.parentNode===t||e===t)},t.isVisible=function e(t){const r=t.ownerDocument.documentElement;let n=t;for(;n!==r;){if(null===n)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(n.host){if(n.host.impl)return e(n.host.impl);if(n.host)return e(n.host);throw new Error("Lost in Web Components world")}return!1}if("none"===y(n).display)return!1;n=n.parentNode}return!0},t.makeElementContentEditableAndSelectItsContent=C,t.matchesCSSRules=function(e,t){var r=t["selectorText"];let n=!1;t.type===CSSRule.STYLE_RULE&&r&&(e.msMatchesSelector?n=e.msMatchesSelector(r):e.matches&&(n=e.matches(r)));return n},t.observeVisibilityChangeOnce=function(r,n){var e=new IntersectionObserver((e,t)=>{e.forEach(e=>{e.isIntersecting&&null!==r.offsetParent&&(n(),t.unobserve(r))})},{root:r.ownerDocument.body});e.observe(r)},t.offset=function(e){var t=e.ownerDocument,r=t.defaultView,n=t.documentElement;let i=e,o,s,a;o=i.offsetLeft,s=i.offsetTop,a=i;for(;(i=i.offsetParent)&&i!==t.body&&"offsetLeft"in i;)o+=i.offsetLeft,s+=i.offsetTop,a=i;a&&"fixed"===a.style.position&&(o+=r.pageXOffset||n.scrollLeft,s+=r.pageYOffset||n.scrollTop);return{left:o,top:s}},t.outerHeight=function(e){return e.offsetHeight},t.outerWidth=function(e){return e.offsetWidth},t.overlayContainsElement=function(e,t,r){r=r.parentElement.querySelector(".ht_clone_"+e);return r?r.contains(t):null},t.removeAttribute=function(r){let e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];"string"==typeof e?e=e.split(" "):e instanceof RegExp&&(e=[e]);var{regexFree:t,regexes:n}=l(e,!0);t.forEach(e=>{""!==e&&r.removeAttribute(e)}),n.forEach(t=>{r.getAttributeNames().forEach(e=>{t.test(e)&&r.removeAttribute(e)})})},t.removeClass=u,t.removeContentEditableFromElementAndDeselect=E,t.removeEvent=function(e,t,r){e.removeEventListener(t,r,!1)},t.removeTextNodes=function t(e){if(3===e.nodeType)e.parentNode.removeChild(e);else if(-1<["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)){const r=e.childNodes;for(let e=r.length-1;0<=e;e--)t(r[e])}},t.resetCssTransform=function(e){e.style.transform&&""!==e.style.transform&&(e.style.transform="")},t.runWithSelectedContendEditableElement=function(e,t){var r=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];C(e,r),t(),E(e,r)},t.selectElementIfAllowed=function(e){var t=e.ownerDocument.activeElement;w(t)||e.select()},t.setAttribute=d,t.setCaretPosition=function(t,r,n){void 0===n&&(n=r);if(t.setSelectionRange){t.focus();try{t.setSelectionRange(r,n)}catch(e){var i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(r,n),i.style.display=o}}},t.setOverlayPosition=function(e,t,r){e.style.transform=`translate3d(${t},${r},0)`},r(204),r(286);var n=r(335),o=r(479);function i(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}function s(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],r=2<arguments.length?arguments[2]:void 0,{ELEMENT_NODE:n,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=e;for(;null!==o&&void 0!==o&&o!==r;){var{nodeType:s,nodeName:a}=o;if(s===n&&(t.includes(a)||t.includes(o)))return o;a=o["host"];o=a&&s===i?a:o.parentNode}return null}function a(e){return e&&e.length?e.filter(e=>!!e):[]}function l(e,r){if(!e||!e.length)return r?{regexFree:[],regexes:[]}:[];const n=[];var t=[];return t.push(...e.filter(e=>{var t=e instanceof RegExp;return t&&r&&n.push(e),!t})),r?{regexFree:t,regexes:n}:t}function c(e,t){0<(t=a(t="string"==typeof t?t.split(" "):t)).length&&e.classList.add(...t)}function u(r,e){"string"==typeof e?e=e.split(" "):e instanceof RegExp&&(e=[e]);var{regexFree:e,regexes:t}=l(e,!0);0<(e=a(e)).length&&r.classList.remove(...e),t.forEach(t=>{r.classList.forEach(e=>{t.test(e)&&r.classList.remove(e)})})}function d(t){let e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];var r=2<arguments.length?arguments[2]:void 0;(e=Array.isArray(e)?e:[[e,r]]).forEach(e=>{Array.isArray(e)&&""!==e[0]&&t.setAttribute(...e)})}function h(e){for(var t;t=e.lastChild;)e.removeChild(t)}const p=t.HTML_CHARACTERS=/(<(.*)>|&(.*);)/;function f(e,t){var r=e.firstChild;r&&3===r.nodeType&&null===r.nextSibling?r.textContent=t:(h(e),e.appendChild(e.ownerDocument.createTextNode(t)))}function g(){return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:window).scrollY}function m(){return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:window).scrollX}function y(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:window;return e.currentStyle||t.getComputedStyle(e)}let v;function b(e){return e&&(-1<["INPUT","SELECT","TEXTAREA"].indexOf(e.nodeName)||"true"===e.contentEditable)}function w(e){return b(e)&&!1===e.hasAttribute("data-hot-input")}function C(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],r=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],n=e.ownerDocument,i=n.createRange(),n=n.defaultView.getSelection();d(e,"contenteditable",!0),r&&d(e,...(0,o.A11Y_HIDDEN)()),t&&c(e,"invisibleSelection"),i.selectNodeContents(e),n.removeAllRanges(),n.addRange(i)}function E(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],r=e.ownerDocument.defaultView.getSelection();e.hasAttribute("aria-hidden")&&e.removeAttribute("aria-hidden"),r.removeAllRanges(),t&&u(e,"invisibleSelection"),e.removeAttribute("contenteditable")}},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,t.equalsIgnoreCase=function(){var e=[];for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];let i=r.length;for(;i;){--i;var o=(0,s.stringify)(r[i]).toLowerCase();-1===e.indexOf(o)&&e.push(o)}return 1===e.length},t.isPercentValue=function(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)},t.randomString=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()},t.sanitize=o,t.stripTags=function(e){return o(""+e,{ALLOWED_TAGS:[]})},t.substitute=function(e){let r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return(""+e).replace(/(?:\\)?\[([^[\]]+)]/g,(e,t)=>"\\"===e.charAt(0)?e.substr(1,e.length-1):void 0===r[t]?"":r[t])},t.toUpperCaseFirst=function(e){return e[0].toUpperCase()+e.substr(1)},r(286),n(r(336))),s=r(337);function o(e,t){return i.default.sanitize(e,t)}},function(e,t,r){e.exports=function(){"use strict";function Ke(e){"@babel/helpers - typeof";return Ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ke(e)}function a(e,t){a=Object.setPrototypeOf||function e(t,r){t.__proto__=r;return t};return a(e,t)}function n(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true}catch(e){return false}}function i(e,t,r){if(n())i=Reflect.construct;else i=function e(t,r,n){var i=[null];i.push.apply(i,r);var o=Function.bind.apply(t,i);var s=new o;if(n)a(s,n.prototype);return s};return i.apply(null,arguments)}function Xe(e){return t(e)||r(e)||h(e)||p()}function t(e){if(Array.isArray(e))return o(e)}function r(e){if(typeof Symbol!=="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function h(e,t){if(!e)return;if(typeof e==="string")return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor)r=e.constructor.name;if(r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}function o(e,t){if(t==null||t>e.length)t=e.length;for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function p(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var f=Object.hasOwnProperty,l=Object.setPrototypeOf,g=Object.isFrozen,m=Object.getPrototypeOf,y=Object.getOwnPropertyDescriptor,Je=Object.freeze,e=Object.seal,v=Object.create,s=typeof Reflect!=="undefined"&&Reflect,c=s.apply,u=s.construct;if(!c)c=function e(t,r,n){return t.apply(r,n)};if(!Je)Je=function e(t){return t};if(!e)e=function e(t){return t};if(!u)u=function e(t,r){return i(t,Xe(r))};var bt=d(Array.prototype.forEach),Ze=d(Array.prototype.pop),Qe=d(Array.prototype.push),et=d(String.prototype.toLowerCase),tt=d(String.prototype.toString),rt=d(String.prototype.match),nt=d(String.prototype.replace),wt=d(String.prototype.indexOf),Ct=d(String.prototype.trim),it=d(RegExp.prototype.test),ot=b(TypeError);function d(i){return function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return c(i,e,r)}}function b(n){return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return u(n,t)}}function st(e,t,r){var n;r=(n=r)!==null&&n!==void 0?n:et;if(l)l(e,null);var i=t.length;while(i--){var o=t[i];if(typeof o==="string"){var s=r(o);if(s!==o){if(!g(t))t[i]=s;o=s}}e[o]=true}return e}function at(e){var t=v(null);var r;for(r in e)if(c(f,e,[r])===true)t[r]=e[r];return t}function lt(e,t){while(e!==null){var r=y(e,t);if(r){if(r.get)return d(r.get);if(typeof r.value==="function")return d(r.value)}e=m(e)}function n(e){console.warn("fallback value for",e);return null}return n}var ct=Je(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),ut=Je(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),dt=Je(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Et=Je(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),ht=Je(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),Tt=Je(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),pt=Je(["#text"]),ft=Je(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),gt=Je(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),mt=Je(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),yt=Je(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),St=e(/\{\{[\w\W]*|[\w\W]*\}\}/gm),_t=e(/<%[\w\W]*|[\w\W]*%>/gm),xt=e(/\${[\w\W]*}/gm),Rt=e(/^data-[\-\w.\u00B7-\uFFFF]/),At=e(/^aria-[\-\w]+$/),Nt=e(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Ot=e(/^(?:\w+script|data):/i),It=e(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Mt=e(/^html$/i),kt=e(/^[a-z][.\w]*(-[.\w]+)+$/i),Dt=function e(){return typeof window==="undefined"?null:window},Pt=function e(t,r){if(Ke(t)!=="object"||typeof t.createPolicy!=="function")return null;var n=null;var i="data-tt-policy-suffix";if(r.currentScript&&r.currentScript.hasAttribute(i))n=r.currentScript.getAttribute(i);var o="dompurify"+(n?"#"+n:"");try{return t.createPolicy(o,{createHTML:function e(t){return t},createScriptURL:function e(t){return t}})}catch(e){console.warn("TrustedTypes policy "+o+" could not be created.");return null}},w;function vt(){var u=arguments.length>0&&arguments[0]!==undefined?arguments[0]:Dt();var h=function e(t){return vt(t)};h.version="2.5.6";h.removed=[];if(!u||!u.document||u.document.nodeType!==9){h.isSupported=false;return h}var d=u.document;var a=u.document;var P=u.DocumentFragment,L=u.HTMLTemplateElement,p=u.Node,F=u.Element,r=u.NodeFilter,H=u.NamedNodeMap,U=H===void 0?u.NamedNodeMap||u.MozNamedAttrMap:H,V=u.HTMLFormElement,W=u.DOMParser,f=u.trustedTypes;var e=F.prototype;var $=lt(e,"cloneNode");var B=lt(e,"nextSibling");var j=lt(e,"childNodes");var z=lt(e,"parentNode");if(typeof L==="function"){var Y=a.createElement("template");if(Y.content&&Y.content.ownerDocument)a=Y.content.ownerDocument}var g=Pt(f,d);var G=g?g.createHTML(""):"";var t=a,q=t.implementation,K=t.createNodeIterator,X=t.createDocumentFragment,J=t.getElementsByTagName;var Z=d.importNode;var Q={};try{Q=at(a).documentMode?a.documentMode:{}}catch(e){}var i={};h.isSupported=typeof z==="function"&&q&&q.createHTMLDocument!==undefined&&Q!==9;var ee=St,te=_t,re=xt,ne=Rt,ie=At,oe=Ot,se=It,ae=kt;var le=Nt;var m=null;var ce=st({},[].concat(Xe(ct),Xe(ut),Xe(dt),Xe(ht),Xe(pt)));var y=null;var ue=st({},[].concat(Xe(ft),Xe(gt),Xe(mt),Xe(yt)));var c=Object.seal(Object.create(null,{tagNameCheck:{writable:true,configurable:false,enumerable:true,value:null},attributeNameCheck:{writable:true,configurable:false,enumerable:true,value:null},allowCustomizedBuiltInElements:{writable:true,configurable:false,enumerable:true,value:false}}));var v=null;var de=null;var he=true;var pe=true;var fe=false;var ge=true;var b=false;var me=true;var w=false;var ye=false;var ve=false;var C=false;var E=false;var T=false;var be=true;var we=false;var Ce="user-content-";var Ee=true;var S=false;var n={};var _=null;var Te=st({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);var Se=null;var _e=st({},["audio","video","img","source","image","track"]);var xe=null;var Re=st({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]);var o="http://www.w3.org/1998/Math/MathML";var s="http://www.w3.org/2000/svg";var l="http://www.w3.org/1999/xhtml";var x=l;var Ae=false;var Ne=null;var Oe=st({},[o,s,l],tt);var R;var Ie=["application/xhtml+xml","text/html"];var Me="text/html";var A;var N=null;var ke=a.createElement("form");var De=function e(t){return t instanceof RegExp||t instanceof Function};var Pe=function e(t){if(N&&N===t)return;if(!t||Ke(t)!=="object")t={};t=at(t);R=Ie.indexOf(t.PARSER_MEDIA_TYPE)===-1?R=Me:R=t.PARSER_MEDIA_TYPE;A=R==="application/xhtml+xml"?tt:et;m="ALLOWED_TAGS"in t?st({},t.ALLOWED_TAGS,A):ce;y="ALLOWED_ATTR"in t?st({},t.ALLOWED_ATTR,A):ue;Ne="ALLOWED_NAMESPACES"in t?st({},t.ALLOWED_NAMESPACES,tt):Oe;xe="ADD_URI_SAFE_ATTR"in t?st(at(Re),t.ADD_URI_SAFE_ATTR,A):Re;Se="ADD_DATA_URI_TAGS"in t?st(at(_e),t.ADD_DATA_URI_TAGS,A):_e;_="FORBID_CONTENTS"in t?st({},t.FORBID_CONTENTS,A):Te;v="FORBID_TAGS"in t?st({},t.FORBID_TAGS,A):{};de="FORBID_ATTR"in t?st({},t.FORBID_ATTR,A):{};n="USE_PROFILES"in t?t.USE_PROFILES:false;he=t.ALLOW_ARIA_ATTR!==false;pe=t.ALLOW_DATA_ATTR!==false;fe=t.ALLOW_UNKNOWN_PROTOCOLS||false;ge=t.ALLOW_SELF_CLOSE_IN_ATTR!==false;b=t.SAFE_FOR_TEMPLATES||false;me=t.SAFE_FOR_XML!==false;w=t.WHOLE_DOCUMENT||false;C=t.RETURN_DOM||false;E=t.RETURN_DOM_FRAGMENT||false;T=t.RETURN_TRUSTED_TYPE||false;ve=t.FORCE_BODY||false;be=t.SANITIZE_DOM!==false;we=t.SANITIZE_NAMED_PROPS||false;Ee=t.KEEP_CONTENT!==false;S=t.IN_PLACE||false;le=t.ALLOWED_URI_REGEXP||le;x=t.NAMESPACE||l;c=t.CUSTOM_ELEMENT_HANDLING||{};if(t.CUSTOM_ELEMENT_HANDLING&&De(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck))c.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck;if(t.CUSTOM_ELEMENT_HANDLING&&De(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck))c.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck;if(t.CUSTOM_ELEMENT_HANDLING&&typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements==="boolean")c.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements;if(b)pe=false;if(E)C=true;if(n){m=st({},Xe(pt));y=[];if(n.html===true){st(m,ct);st(y,ft)}if(n.svg===true){st(m,ut);st(y,gt);st(y,yt)}if(n.svgFilters===true){st(m,dt);st(y,gt);st(y,yt)}if(n.mathMl===true){st(m,ht);st(y,mt);st(y,yt)}}if(t.ADD_TAGS){if(m===ce)m=at(m);st(m,t.ADD_TAGS,A)}if(t.ADD_ATTR){if(y===ue)y=at(y);st(y,t.ADD_ATTR,A)}if(t.ADD_URI_SAFE_ATTR)st(xe,t.ADD_URI_SAFE_ATTR,A);if(t.FORBID_CONTENTS){if(_===Te)_=at(_);st(_,t.FORBID_CONTENTS,A)}if(Ee)m["#text"]=true;if(w)st(m,["html","head","body"]);if(m.table){st(m,["tbody"]);delete v.tbody}if(Je)Je(t);N=t};var Le=st({},["mi","mo","mn","ms","mtext"]);var Fe=st({},["foreignobject","annotation-xml"]);var He=st({},["title","style","font","a","script"]);var O=st({},ut);st(O,dt);st(O,Et);var Ue=st({},ht);st(Ue,Tt);var Ve=function e(t){var r=z(t);if(!r||!r.tagName)r={namespaceURI:x,tagName:"template"};var n=et(t.tagName);var i=et(r.tagName);if(!Ne[t.namespaceURI])return false;if(t.namespaceURI===s){if(r.namespaceURI===l)return n==="svg";if(r.namespaceURI===o)return n==="svg"&&(i==="annotation-xml"||Le[i]);return Boolean(O[n])}if(t.namespaceURI===o){if(r.namespaceURI===l)return n==="math";if(r.namespaceURI===s)return n==="math"&&Fe[i];return Boolean(Ue[n])}if(t.namespaceURI===l){if(r.namespaceURI===s&&!Fe[i])return false;if(r.namespaceURI===o&&!Le[i])return false;return!Ue[n]&&(He[n]||!O[n])}if(R==="application/xhtml+xml"&&Ne[t.namespaceURI])return true;return false};var I=function e(t){Qe(h.removed,{element:t});try{t.parentNode.removeChild(t)}catch(e){try{t.outerHTML=G}catch(e){t.remove()}}};var M=function e(t,r){try{Qe(h.removed,{attribute:r.getAttributeNode(t),from:r})}catch(e){Qe(h.removed,{attribute:null,from:r})}r.removeAttribute(t);if(t==="is"&&!y[t])if(C||E)try{I(r)}catch(e){}else try{r.setAttribute(t,"")}catch(e){}};var We=function e(t){var r;var n;if(ve)t="<remove></remove>"+t;else{var i=rt(t,/^[\r\n\t ]+/);n=i&&i[0]}if(R==="application/xhtml+xml"&&x===l)t='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+t+"</body></html>";var o=g?g.createHTML(t):t;if(x===l)try{r=(new W).parseFromString(o,R)}catch(e){}if(!r||!r.documentElement){r=q.createDocument(x,"template",null);try{r.documentElement.innerHTML=Ae?G:o}catch(e){}}var s=r.body||r.documentElement;if(t&&n)s.insertBefore(a.createTextNode(n),s.childNodes[0]||null);if(x===l)return J.call(r,w?"html":"body")[0];return w?r.documentElement:s};var $e=function e(t){return K.call(t.ownerDocument||t,t,r.SHOW_ELEMENT|r.SHOW_COMMENT|r.SHOW_TEXT|r.SHOW_PROCESSING_INSTRUCTION|r.SHOW_CDATA_SECTION,null,false)};var Be=function e(t){return t instanceof V&&(typeof t.nodeName!=="string"||typeof t.textContent!=="string"||typeof t.removeChild!=="function"||!(t.attributes instanceof U)||typeof t.removeAttribute!=="function"||typeof t.setAttribute!=="function"||typeof t.namespaceURI!=="string"||typeof t.insertBefore!=="function"||typeof t.hasChildNodes!=="function")};var k=function e(t){return Ke(p)==="object"?t instanceof p:t&&Ke(t)==="object"&&typeof t.nodeType==="number"&&typeof t.nodeName==="string"};var D=function e(t,r,n){if(!i[t])return;bt(i[t],function(e){e.call(h,r,n,N)})};var je=function e(t){var r;D("beforeSanitizeElements",t,null);if(Be(t)){I(t);return true}if(it(/[\u0080-\uFFFF]/,t.nodeName)){I(t);return true}var n=A(t.nodeName);D("uponSanitizeElement",t,{tagName:n,allowedTags:m});if(t.hasChildNodes()&&!k(t.firstElementChild)&&(!k(t.content)||!k(t.content.firstElementChild))&&it(/<[/\w]/g,t.innerHTML)&&it(/<[/\w]/g,t.textContent)){I(t);return true}if(n==="select"&&it(/<template/i,t.innerHTML)){I(t);return true}if(t.nodeType===7){I(t);return true}if(me&&t.nodeType===8&&it(/<[/\w]/g,t.data)){I(t);return true}if(!m[n]||v[n]){if(!v[n]&&Ye(n)){if(c.tagNameCheck instanceof RegExp&&it(c.tagNameCheck,n))return false;if(c.tagNameCheck instanceof Function&&c.tagNameCheck(n))return false}if(Ee&&!_[n]){var i=z(t)||t.parentNode;var o=j(t)||t.childNodes;if(o&&i){var s=o.length;for(var a=s-1;a>=0;--a){var l=$(o[a],true);l.__removalCount=(t.__removalCount||0)+1;i.insertBefore(l,B(t))}}}I(t);return true}if(t instanceof F&&!Ve(t)){I(t);return true}if((n==="noscript"||n==="noembed"||n==="noframes")&&it(/<\/no(script|embed|frames)/i,t.innerHTML)){I(t);return true}if(b&&t.nodeType===3){r=t.textContent;r=nt(r,ee," ");r=nt(r,te," ");r=nt(r,re," ");if(t.textContent!==r){Qe(h.removed,{element:t.cloneNode()});t.textContent=r}}D("afterSanitizeElements",t,null);return false};var ze=function e(t,r,n){if(be&&(r==="id"||r==="name")&&(n in a||n in ke))return false;if(pe&&!de[r]&&it(ne,r));else if(he&&it(ie,r));else if(!y[r]||de[r])if(Ye(t)&&(c.tagNameCheck instanceof RegExp&&it(c.tagNameCheck,t)||c.tagNameCheck instanceof Function&&c.tagNameCheck(t))&&(c.attributeNameCheck instanceof RegExp&&it(c.attributeNameCheck,r)||c.attributeNameCheck instanceof Function&&c.attributeNameCheck(r))||r==="is"&&c.allowCustomizedBuiltInElements&&(c.tagNameCheck instanceof RegExp&&it(c.tagNameCheck,n)||c.tagNameCheck instanceof Function&&c.tagNameCheck(n)));else return false;else if(xe[r]);else if(it(le,nt(n,se,"")));else if((r==="src"||r==="xlink:href"||r==="href")&&t!=="script"&&wt(n,"data:")===0&&Se[t]);else if(fe&&!it(oe,nt(n,se,"")));else if(n)return false;else;return true};var Ye=function e(t){return t!=="annotation-xml"&&rt(t,ae)};var Ge=function e(t){var r;var n;var i;var o;D("beforeSanitizeAttributes",t,null);var s=t.attributes;if(!s)return;var a={attrName:"",attrValue:"",keepAttr:true,allowedAttributes:y};o=s.length;while(o--){r=s[o];var l=r,c=l.name,u=l.namespaceURI;n=c==="value"?r.value:Ct(r.value);i=A(c);a.attrName=i;a.attrValue=n;a.keepAttr=true;a.forceKeepAttr=undefined;D("uponSanitizeAttribute",t,a);n=a.attrValue;if(me&&it(/((--!?|])>)|<\/(style|title)/i,n)){M(c,t);continue}if(a.forceKeepAttr)continue;M(c,t);if(!a.keepAttr)continue;if(!ge&&it(/\/>/i,n)){M(c,t);continue}if(b){n=nt(n,ee," ");n=nt(n,te," ");n=nt(n,re," ")}var d=A(t.nodeName);if(!ze(d,i,n))continue;if(we&&(i==="id"||i==="name")){M(c,t);n=Ce+n}if(g&&Ke(f)==="object"&&typeof f.getAttributeType==="function")if(u);else switch(f.getAttributeType(d,i)){case"TrustedHTML":{n=g.createHTML(n);break}case"TrustedScriptURL":{n=g.createScriptURL(n);break}}try{if(u)t.setAttributeNS(u,c,n);else t.setAttribute(c,n);if(Be(t))I(t);else Ze(h.removed)}catch(e){}}D("afterSanitizeAttributes",t,null)};var qe=function e(t){var r;var n=$e(t);D("beforeSanitizeShadowDOM",t,null);while(r=n.nextNode()){D("uponSanitizeShadowNode",r,null);if(je(r))continue;if(r.content instanceof P)e(r.content);Ge(r)}D("afterSanitizeShadowDOM",t,null)};h.sanitize=function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var r;var n;var i;var o;var s;Ae=!e;if(Ae)e="\x3c!--\x3e";if(typeof e!=="string"&&!k(e))if(typeof e.toString==="function"){e=e.toString();if(typeof e!=="string")throw ot("dirty is not a string, aborting")}else throw ot("toString is not a function");if(!h.isSupported){if(Ke(u.toStaticHTML)==="object"||typeof u.toStaticHTML==="function"){if(typeof e==="string")return u.toStaticHTML(e);if(k(e))return u.toStaticHTML(e.outerHTML)}return e}if(!ye)Pe(t);h.removed=[];if(typeof e==="string")S=false;if(S){if(e.nodeName){var a=A(e.nodeName);if(!m[a]||v[a])throw ot("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof p){r=We("\x3c!----\x3e");n=r.ownerDocument.importNode(e,true);if(n.nodeType===1&&n.nodeName==="BODY")r=n;else if(n.nodeName==="HTML")r=n;else r.appendChild(n)}else{if(!C&&!b&&!w&&e.indexOf("<")===-1)return g&&T?g.createHTML(e):e;r=We(e);if(!r)return C?null:T?G:""}if(r&&ve)I(r.firstChild);var l=$e(S?e:r);while(i=l.nextNode()){if(i.nodeType===3&&i===o)continue;if(je(i))continue;if(i.content instanceof P)qe(i.content);Ge(i);o=i}o=null;if(S)return e;if(C){if(E){s=X.call(r.ownerDocument);while(r.firstChild)s.appendChild(r.firstChild)}else s=r;if(y.shadowroot||y.shadowrootmod)s=Z.call(d,s,true);return s}var c=w?r.outerHTML:r.innerHTML;if(w&&m["!doctype"]&&r.ownerDocument&&r.ownerDocument.doctype&&r.ownerDocument.doctype.name&&it(Mt,r.ownerDocument.doctype.name))c="<!DOCTYPE "+r.ownerDocument.doctype.name+">\n"+c;if(b){c=nt(c,ee," ");c=nt(c,te," ");c=nt(c,re," ")}return g&&T?g.createHTML(c):c};h.setConfig=function(e){Pe(e);ye=true};h.clearConfig=function(){N=null;ye=false};h.isValidAttribute=function(e,t,r){if(!N)Pe({});var n=A(e);var i=A(t);return ze(n,i,r)};h.addHook=function(e,t){if(typeof t!=="function")return;i[e]=i[e]||[];Qe(i[e],t)};h.removeHook=function(e){if(i[e])return Ze(i[e])};h.removeHooks=function(e){if(i[e])i[e]=[]};h.removeAllHooks=function(){i={}};return h}return vt()}(),window.DOMPurify=r(336)},(e,t,r)=>{"use strict";var n=r(197),c=(t.__esModule=!0,t._injectProductInfo=function(e,t){var r=!u(e),n="string"==typeof e&&"non-commercial-and-evaluation"===e.toLowerCase(),i="14.5.0";let o,s="invalid",a="invalid";var l=function(n){let e=[][d],i=e;if(n[d]!==g("Z"))return!1;for(let e="",t="B<H4P+".split(""),r=g(t.shift());r;r=g(t.shift()||"A"))--r<""[d]?i|=(p(""+p(h(e)+(h(f(n,Math.abs(r),2))+[]).padStart(2,"0")))%97||2)>>1:e=f(n,r,r?1===t[d]?9:8:6);return i===e}(e=m(e||""));a=r||n||l?l?(r=(0,c.default)("30/07/2024","DD/MM/YYYY"),l=Math.floor(r.toDate().getTime()/864e5),r=y(e),o=(0,c.default)(864e5*(r+1),"x").format("MMMM DD, YYYY"),r<l?s="expired":s="valid"):n?(s="non_commercial","valid"):s="invalid":(s="missing","missing");v()&&(s="valid",a="valid");b||"valid"===s||(w[s]({keyValidityDate:o,hotVersion:i})&&console["non_commercial"===s?"info":"warn"](w[s]({keyValidityDate:o,hotVersion:i})),b=!0);"valid"!==a&&t.parentNode&&C[a]({keyValidityDate:o,hotVersion:i})&&((e=document.createElement("div")).className="hot-display-license-info",e.innerHTML=C[a]({keyValidityDate:o,hotVersion:i}),t.parentNode.insertBefore(e,t.nextSibling))},t.isDefined=function(e){return void 0!==e},t.isEmpty=u,t.isRegExp=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},t.isUndefined=o,t.stringify=function(e){let t;switch(typeof e){case"string":case"number":t=""+e;break;case"object":t=null===e?"":e.toString();break;case"undefined":t="";break;default:t=e.toString()}return t},n(r(338))),i=r(477);function o(e){return void 0===e}function u(e){return null===e||""===e||o(e)}const d="length",h=e=>parseInt(e,16),p=e=>parseInt(e,10),f=(e,t,r)=>e.substr(t,r),g=e=>e.codePointAt(0)-65,m=e=>(""+e).replace(/\-/g,""),y=e=>h(f(m(e),h("12"),g("F")))/(h(f(m(e),g("B"),~~![][d]))||9),v=()=>"undefined"!=typeof location&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let b=!1;const w={invalid:()=>(0,i.toSingleLine)`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:e=>{var{keyValidityDate:e,hotVersion:t}=e;return(0,i.toSingleLine)`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${t}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>(0,i.toSingleLine)`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},C={invalid:()=>(0,i.toSingleLine)`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:e=>{var{keyValidityDate:e,hotVersion:t}=e;return(0,i.toSingleLine)`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${t}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>(0,i.toSingleLine)`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""}},function(us,e,ds){(us=ds.nmd(us)).exports=function(){"use strict";var L,F;function d(){return L.apply(null,arguments)}function H(e){L=e}function s(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function U(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function l(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function V(e){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(e).length===0;else{var t;for(t in e)if(l(e,t))return false;return true}}function a(e){return e===void 0}function c(e){return typeof e==="number"||Object.prototype.toString.call(e)==="[object Number]"}function W(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function $(e,t){var r=[],n,i=e.length;for(n=0;n<i;++n)r.push(t(e[n],n));return r}function B(e,t){for(var r in t)if(l(t,r))e[r]=t[r];if(l(t,"toString"))e.toString=t.toString;if(l(t,"valueOf"))e.valueOf=t.valueOf;return e}function u(e,t,r,n){return Zr(e,t,r,n,true).utc()}function j(){return{empty:false,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:false,invalidEra:null,invalidMonth:null,invalidFormat:false,userInvalidated:false,iso:false,parsedDateParts:[],era:null,meridiem:null,rfc2822:false,weekdayMismatch:false}}function h(e){if(e._pf==null)e._pf=j();return e._pf}if(Array.prototype.some)F=Array.prototype.some;else F=function(e){var t=Object(this),r=t.length>>>0,n;for(n=0;n<r;n++)if(n in t&&e.call(this,t[n],n,t))return true;return false};function z(e){var t=null,r=false,n=e._d&&!isNaN(e._d.getTime());if(n){t=h(e);r=F.call(t.parsedDateParts,function(e){return e!=null});n=t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r);if(e._strict)n=n&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===undefined}if(Object.isFrozen==null||!Object.isFrozen(e))e._isValid=n;else return n;return e._isValid}function Y(e){var t=u(NaN);if(e!=null)B(h(t),e);else h(t).userInvalidated=true;return t}var G=d.momentProperties=[],q=false;function K(e,t){var r,n,i,o=G.length;if(!a(t._isAMomentObject))e._isAMomentObject=t._isAMomentObject;if(!a(t._i))e._i=t._i;if(!a(t._f))e._f=t._f;if(!a(t._l))e._l=t._l;if(!a(t._strict))e._strict=t._strict;if(!a(t._tzm))e._tzm=t._tzm;if(!a(t._isUTC))e._isUTC=t._isUTC;if(!a(t._offset))e._offset=t._offset;if(!a(t._pf))e._pf=h(t);if(!a(t._locale))e._locale=t._locale;if(o>0)for(r=0;r<o;r++){n=G[r];i=t[n];if(!a(i))e[n]=i}return e}function X(e){K(this,e);this._d=new Date(e._d!=null?e._d.getTime():NaN);if(!this.isValid())this._d=new Date(NaN);if(q===false){q=true;d.updateOffset(this);q=false}}function p(e){return e instanceof X||e!=null&&e._isAMomentObject!=null}function J(e){if(d.suppressDeprecationWarnings===false&&typeof console!=="undefined"&&console.warn)console.warn("Deprecation warning: "+e)}function e(o,s){var a=true;return B(function(){if(d.deprecationHandler!=null)d.deprecationHandler(null,o);if(a){var e=[],t,r,n,i=arguments.length;for(r=0;r<i;r++){t="";if(typeof arguments[r]==="object"){t+="\n["+r+"] ";for(n in arguments[0])if(l(arguments[0],n))t+=n+": "+arguments[0][n]+", ";t=t.slice(0,-2)}else t=arguments[r];e.push(t)}J(o+"\nArguments: "+Array.prototype.slice.call(e).join("")+"\n"+(new Error).stack);a=false}return s.apply(this,arguments)},s)}var Z={},Q;function ee(e,t){if(d.deprecationHandler!=null)d.deprecationHandler(e,t);if(!Z[e]){J(t);Z[e]=true}}function f(e){return typeof Function!=="undefined"&&e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function te(e){var t,r;for(r in e)if(l(e,r)){t=e[r];if(f(t))this[r]=t;else this["_"+r]=t}this._config=e;this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function re(e,t){var r=B({},e),n;for(n in t)if(l(t,n))if(U(e[n])&&U(t[n])){r[n]={};B(r[n],e[n]);B(r[n],t[n])}else if(t[n]!=null)r[n]=t[n];else delete r[n];for(n in e)if(l(e,n)&&!l(t,n)&&U(e[n]))r[n]=B({},r[n]);return r}function ne(e){if(e!=null)this.set(e)}if(d.suppressDeprecationWarnings=false,d.deprecationHandler=null,Object.keys)Q=Object.keys;else Q=function(e){var t,r=[];for(t in e)if(l(e,t))r.push(t);return r};var ie={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function oe(e,t,r){var n=this._calendar[e]||this._calendar["sameElse"];return f(n)?n.call(t,r):n}function o(e,t,r){var n=""+Math.abs(e),i=t-n.length,o=e>=0;return(o?r?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+n}var se=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,ae=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,le={},ce={};function n(e,t,r,n){var i=n;if(typeof n==="string")i=function(){return this[n]()};if(e)ce[e]=i;if(t)ce[t[0]]=function(){return o(i.apply(this,arguments),t[1],t[2])};if(r)ce[r]=function(){return this.localeData().ordinal(i.apply(this,arguments),e)}}function ue(e){if(e.match(/\[[\s\S]/))return e.replace(/^\[|\]$/g,"");return e.replace(/\\/g,"")}function de(n){var i=n.match(se),e,o;for(e=0,o=i.length;e<o;e++)if(ce[i[e]])i[e]=ce[i[e]];else i[e]=ue(i[e]);return function(e){var t="",r;for(r=0;r<o;r++)t+=f(i[r])?i[r].call(e,n):i[r];return t}}function he(e,t){if(!e.isValid())return e.localeData().invalidDate();t=pe(t,e.localeData());le[t]=le[t]||de(t);return le[t](e)}function pe(e,t){var r=5;function n(e){return t.longDateFormat(e)||e}ae.lastIndex=0;while(r>=0&&ae.test(e)){e=e.replace(ae,n);ae.lastIndex=0;r-=1}return e}var fe={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function ge(e){var t=this._longDateFormat[e],r=this._longDateFormat[e.toUpperCase()];if(t||!r)return t;this._longDateFormat[e]=r.match(se).map(function(e){if(e==="MMMM"||e==="MM"||e==="DD"||e==="dddd")return e.slice(1);return e}).join("");return this._longDateFormat[e]}var me="Invalid date";function ye(){return this._invalidDate}var ve="%d",be=/\d{1,2}/;function we(e){return this._ordinal.replace("%d",e)}var Ce={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function Ee(e,t,r,n){var i=this._relativeTime[r];return f(i)?i(e,t,r,n):i.replace(/%d/i,e)}function Te(e,t){var r=this._relativeTime[e>0?"future":"past"];return f(r)?r(t):r.replace(/%s/i,t)}var Se={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function g(e){return typeof e==="string"?Se[e]||Se[e.toLowerCase()]:undefined}function _e(e){var t={},r,n;for(n in e)if(l(e,n)){r=g(n);if(r)t[r]=e[n]}return t}var xe={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function Re(e){var t=[],r;for(r in e)if(l(e,r))t.push({unit:r,priority:xe[r]});t.sort(function(e,t){return e.priority-t.priority});return t}var Ae=/\d/,t=/\d\d/,Ne=/\d{3}/,Oe=/\d{4}/,Ie=/[+-]?\d{6}/,r=/\d\d?/,Me=/\d\d\d\d?/,ke=/\d\d\d\d\d\d?/,De=/\d{1,3}/,Pe=/\d{1,4}/,Le=/[+-]?\d{1,6}/,Fe=/\d+/,He=/[+-]?\d+/,Ue=/Z|[+-]\d\d:?\d\d/gi,Ve=/Z|[+-]\d\d(?::?\d\d)?/gi,We=/[+-]?\d+(\.\d{1,3})?/,$e=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Be=/^[1-9]\d?/,je=/^([1-9]\d|\d)/,ze;function i(e,r,n){ze[e]=f(r)?r:function(e,t){return e&&n?n:r}}function Ye(e,t){if(!l(ze,e))return new RegExp(Ge(e));return ze[e](t._strict,t._locale)}function Ge(e){return m(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,r,n,i){return t||r||n||i}))}function m(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function y(e){if(e<0)return Math.ceil(e)||0;else return Math.floor(e)}function v(e){var t=+e,r=0;if(t!==0&&isFinite(t))r=y(t);return r}var ze={},qe={};function b(e,r){var t,n=r,i;if(typeof e==="string")e=[e];if(c(r))n=function(e,t){t[r]=v(e)};i=e.length;for(t=0;t<i;t++)qe[e[t]]=n}function Ke(e,i){b(e,function(e,t,r,n){r._w=r._w||{};i(e,r._w,r,n)})}function Xe(e,t,r){if(t!=null&&l(qe,e))qe[e](t,r._a,r,e)}function Je(e){return e%4===0&&e%100!==0||e%400===0}var w=0,C=1,E=2,T=3,S=4,_=5,Ze=6,Qe=7,et=8;function tt(e){return Je(e)?366:365}n("Y",0,0,function(){var e=this.year();return e<=9999?o(e,4):"+"+e}),n(0,["YY",2],0,function(){return this.year()%100}),n(0,["YYYY",4],0,"year"),n(0,["YYYYY",5],0,"year"),n(0,["YYYYYY",6,true],0,"year"),i("Y",He),i("YY",r,t),i("YYYY",Pe,Oe),i("YYYYY",Le,Ie),i("YYYYYY",Le,Ie),b(["YYYYY","YYYYYY"],w),b("YYYY",function(e,t){t[w]=e.length===2?d.parseTwoDigitYear(e):v(e)}),b("YY",function(e,t){t[w]=d.parseTwoDigitYear(e)}),b("Y",function(e,t){t[w]=parseInt(e,10)}),d.parseTwoDigitYear=function(e){return v(e)+(v(e)>68?1900:2e3)};var rt=it("FullYear",true),x;function nt(){return Je(this.year())}function it(t,r){return function(e){if(e!=null){st(this,t,e);d.updateOffset(this,r);return this}else return ot(this,t)}}function ot(e,t){if(!e.isValid())return NaN;var r=e._d,n=e._isUTC;switch(t){case"Milliseconds":return n?r.getUTCMilliseconds():r.getMilliseconds();case"Seconds":return n?r.getUTCSeconds():r.getSeconds();case"Minutes":return n?r.getUTCMinutes():r.getMinutes();case"Hours":return n?r.getUTCHours():r.getHours();case"Date":return n?r.getUTCDate():r.getDate();case"Day":return n?r.getUTCDay():r.getDay();case"Month":return n?r.getUTCMonth():r.getMonth();case"FullYear":return n?r.getUTCFullYear():r.getFullYear();default:return NaN}}function st(e,t,r){var n,i,o,s,a;if(!e.isValid()||isNaN(r))return;n=e._d;i=e._isUTC;switch(t){case"Milliseconds":return void(i?n.setUTCMilliseconds(r):n.setMilliseconds(r));case"Seconds":return void(i?n.setUTCSeconds(r):n.setSeconds(r));case"Minutes":return void(i?n.setUTCMinutes(r):n.setMinutes(r));case"Hours":return void(i?n.setUTCHours(r):n.setHours(r));case"Date":return void(i?n.setUTCDate(r):n.setDate(r));case"FullYear":break;default:return}o=r;s=e.month();a=e.date();a=a===29&&s===1&&!Je(o)?28:a;void(i?n.setUTCFullYear(o,s,a):n.setFullYear(o,s,a))}function at(e){e=g(e);if(f(this[e]))return this[e]();return this}function lt(e,t){if(typeof e==="object"){e=_e(e);var r=Re(e),n,i=r.length;for(n=0;n<i;n++)this[r[n].unit](e[r[n].unit])}else{e=g(e);if(f(this[e]))return this[e](t)}return this}function ct(e,t){return(e%t+t)%t}if(Array.prototype.indexOf)x=Array.prototype.indexOf;else x=function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1};function ut(e,t){if(isNaN(e)||isNaN(t))return NaN;var r=ct(t,12);e+=(t-r)/12;return r===1?Je(e)?29:28:31-r%7%2}n("M",["MM",2],"Mo",function(){return this.month()+1}),n("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),n("MMMM",0,0,function(e){return this.localeData().months(this,e)}),i("M",r,Be),i("MM",r,t),i("MMM",function(e,t){return t.monthsShortRegex(e)}),i("MMMM",function(e,t){return t.monthsRegex(e)}),b(["M","MM"],function(e,t){t[C]=v(e)-1}),b(["MMM","MMMM"],function(e,t,r,n){var i=r._locale.monthsParse(e,n,r._strict);if(i!=null)t[C]=i;else h(r).invalidMonth=e});var dt="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ht="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),pt=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,ft=$e,gt=$e;function mt(e,t){if(!e)return s(this._months)?this._months:this._months["standalone"];return s(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||pt).test(t)?"format":"standalone"][e.month()]}function yt(e,t){if(!e)return s(this._monthsShort)?this._monthsShort:this._monthsShort["standalone"];return s(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[pt.test(t)?"format":"standalone"][e.month()]}function vt(e,t,r){var n,i,o,s=e.toLocaleLowerCase();if(!this._monthsParse){this._monthsParse=[];this._longMonthsParse=[];this._shortMonthsParse=[];for(n=0;n<12;++n){o=u([2e3,n]);this._shortMonthsParse[n]=this.monthsShort(o,"").toLocaleLowerCase();this._longMonthsParse[n]=this.months(o,"").toLocaleLowerCase()}}if(r)if(t==="MMM"){i=x.call(this._shortMonthsParse,s);return i!==-1?i:null}else{i=x.call(this._longMonthsParse,s);return i!==-1?i:null}else if(t==="MMM"){i=x.call(this._shortMonthsParse,s);if(i!==-1)return i;i=x.call(this._longMonthsParse,s);return i!==-1?i:null}else{i=x.call(this._longMonthsParse,s);if(i!==-1)return i;i=x.call(this._shortMonthsParse,s);return i!==-1?i:null}}function bt(e,t,r){var n,i,o;if(this._monthsParseExact)return vt.call(this,e,t,r);if(!this._monthsParse){this._monthsParse=[];this._longMonthsParse=[];this._shortMonthsParse=[]}for(n=0;n<12;n++){i=u([2e3,n]);if(r&&!this._longMonthsParse[n]){this._longMonthsParse[n]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i");this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")}if(!r&&!this._monthsParse[n]){o="^"+this.months(i,"")+"|^"+this.monthsShort(i,"");this._monthsParse[n]=new RegExp(o.replace(".",""),"i")}if(r&&t==="MMMM"&&this._longMonthsParse[n].test(e))return n;else if(r&&t==="MMM"&&this._shortMonthsParse[n].test(e))return n;else if(!r&&this._monthsParse[n].test(e))return n}}function wt(e,t){if(!e.isValid())return e;if(typeof t==="string")if(/^\d+$/.test(t))t=v(t);else{t=e.localeData().monthsParse(t);if(!c(t))return e}var r=t,n=e.date();n=n<29?n:Math.min(n,ut(e.year(),r));void(e._isUTC?e._d.setUTCMonth(r,n):e._d.setMonth(r,n));return e}function Ct(e){if(e!=null){wt(this,e);d.updateOffset(this,true);return this}else return ot(this,"Month")}function Et(){return ut(this.year(),this.month())}function Tt(e){if(this._monthsParseExact){if(!l(this,"_monthsRegex"))_t.call(this);if(e)return this._monthsShortStrictRegex;else return this._monthsShortRegex}else{if(!l(this,"_monthsShortRegex"))this._monthsShortRegex=ft;return this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex}}function St(e){if(this._monthsParseExact){if(!l(this,"_monthsRegex"))_t.call(this);if(e)return this._monthsStrictRegex;else return this._monthsRegex}else{if(!l(this,"_monthsRegex"))this._monthsRegex=gt;return this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex}}function _t(){function e(e,t){return t.length-e.length}var t=[],r=[],n=[],i,o,s,a;for(i=0;i<12;i++){o=u([2e3,i]);s=m(this.monthsShort(o,""));a=m(this.months(o,""));t.push(s);r.push(a);n.push(a);n.push(s)}t.sort(e);r.sort(e);n.sort(e);this._monthsRegex=new RegExp("^("+n.join("|")+")","i");this._monthsShortRegex=this._monthsRegex;this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i");this._monthsShortStrictRegex=new RegExp("^("+t.join("|")+")","i")}function xt(e,t,r,n,i,o,s){var a;if(e<100&&e>=0){a=new Date(e+400,t,r,n,i,o,s);if(isFinite(a.getFullYear()))a.setFullYear(e)}else a=new Date(e,t,r,n,i,o,s);return a}function Rt(e){var t,r;if(e<100&&e>=0){r=Array.prototype.slice.call(arguments);r[0]=e+400;t=new Date(Date.UTC.apply(null,r));if(isFinite(t.getUTCFullYear()))t.setUTCFullYear(e)}else t=new Date(Date.UTC.apply(null,arguments));return t}function At(e,t,r){var n=7+t-r,i=(7+Rt(e,0,n).getUTCDay()-t)%7;return-i+n-1}function Nt(e,t,r,n,i){var o=(7+r-n)%7,s=At(e,n,i),a=1+7*(t-1)+o+s,l,c;if(a<=0){l=e-1;c=tt(l)+a}else if(a>tt(e)){l=e+1;c=a-tt(e)}else{l=e;c=a}return{year:l,dayOfYear:c}}function Ot(e,t,r){var n=At(e.year(),t,r),i=Math.floor((e.dayOfYear()-n-1)/7)+1,o,s;if(i<1){s=e.year()-1;o=i+R(s,t,r)}else if(i>R(e.year(),t,r)){o=i-R(e.year(),t,r);s=e.year()+1}else{s=e.year();o=i}return{week:o,year:s}}function R(e,t,r){var n=At(e,t,r),i=At(e+1,t,r);return(tt(e)-n+i)/7}function It(e){return Ot(e,this._week.dow,this._week.doy).week}n("w",["ww",2],"wo","week"),n("W",["WW",2],"Wo","isoWeek"),i("w",r,Be),i("ww",r,t),i("W",r,Be),i("WW",r,t),Ke(["w","ww","W","WW"],function(e,t,r,n){t[n.substr(0,1)]=v(e)});var Mt={dow:0,doy:6};function kt(){return this._week.dow}function Dt(){return this._week.doy}function Pt(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")}function Lt(e){var t=Ot(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")}function Ft(e,t){if(typeof e!=="string")return e;if(!isNaN(e))return parseInt(e,10);e=t.weekdaysParse(e);if(typeof e==="number")return e;return null}function Ht(e,t){if(typeof e==="string")return t.weekdaysParse(e)%7||7;return isNaN(e)?null:e}function Ut(e,t){return e.slice(t,7).concat(e.slice(0,t))}n("d",0,"do","day"),n("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),n("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),n("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),n("e",0,0,"weekday"),n("E",0,0,"isoWeekday"),i("d",r),i("e",r),i("E",r),i("dd",function(e,t){return t.weekdaysMinRegex(e)}),i("ddd",function(e,t){return t.weekdaysShortRegex(e)}),i("dddd",function(e,t){return t.weekdaysRegex(e)}),Ke(["dd","ddd","dddd"],function(e,t,r,n){var i=r._locale.weekdaysParse(e,n,r._strict);if(i!=null)t.d=i;else h(r).invalidWeekday=e}),Ke(["d","e","E"],function(e,t,r,n){t[n]=v(e)});var Vt="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Wt="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),$t="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Bt=$e,jt=$e,zt=$e;function Yt(e,t){var r=s(this._weekdays)?this._weekdays:this._weekdays[e&&e!==true&&this._weekdays.isFormat.test(t)?"format":"standalone"];return e===true?Ut(r,this._week.dow):e?r[e.day()]:r}function Gt(e){return e===true?Ut(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function qt(e){return e===true?Ut(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function Kt(e,t,r){var n,i,o,s=e.toLocaleLowerCase();if(!this._weekdaysParse){this._weekdaysParse=[];this._shortWeekdaysParse=[];this._minWeekdaysParse=[];for(n=0;n<7;++n){o=u([2e3,1]).day(n);this._minWeekdaysParse[n]=this.weekdaysMin(o,"").toLocaleLowerCase();this._shortWeekdaysParse[n]=this.weekdaysShort(o,"").toLocaleLowerCase();this._weekdaysParse[n]=this.weekdays(o,"").toLocaleLowerCase()}}if(r)if(t==="dddd"){i=x.call(this._weekdaysParse,s);return i!==-1?i:null}else if(t==="ddd"){i=x.call(this._shortWeekdaysParse,s);return i!==-1?i:null}else{i=x.call(this._minWeekdaysParse,s);return i!==-1?i:null}else if(t==="dddd"){i=x.call(this._weekdaysParse,s);if(i!==-1)return i;i=x.call(this._shortWeekdaysParse,s);if(i!==-1)return i;i=x.call(this._minWeekdaysParse,s);return i!==-1?i:null}else if(t==="ddd"){i=x.call(this._shortWeekdaysParse,s);if(i!==-1)return i;i=x.call(this._weekdaysParse,s);if(i!==-1)return i;i=x.call(this._minWeekdaysParse,s);return i!==-1?i:null}else{i=x.call(this._minWeekdaysParse,s);if(i!==-1)return i;i=x.call(this._weekdaysParse,s);if(i!==-1)return i;i=x.call(this._shortWeekdaysParse,s);return i!==-1?i:null}}function Xt(e,t,r){var n,i,o;if(this._weekdaysParseExact)return Kt.call(this,e,t,r);if(!this._weekdaysParse){this._weekdaysParse=[];this._minWeekdaysParse=[];this._shortWeekdaysParse=[];this._fullWeekdaysParse=[]}for(n=0;n<7;n++){i=u([2e3,1]).day(n);if(r&&!this._fullWeekdaysParse[n]){this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i");this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i");this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")}if(!this._weekdaysParse[n]){o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,"");this._weekdaysParse[n]=new RegExp(o.replace(".",""),"i")}if(r&&t==="dddd"&&this._fullWeekdaysParse[n].test(e))return n;else if(r&&t==="ddd"&&this._shortWeekdaysParse[n].test(e))return n;else if(r&&t==="dd"&&this._minWeekdaysParse[n].test(e))return n;else if(!r&&this._weekdaysParse[n].test(e))return n}}function Jt(e){if(!this.isValid())return e!=null?this:NaN;var t=ot(this,"Day");if(e!=null){e=Ft(e,this.localeData());return this.add(e-t,"d")}else return t}function Zt(e){if(!this.isValid())return e!=null?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")}function Qt(e){if(!this.isValid())return e!=null?this:NaN;if(e!=null){var t=Ht(e,this.localeData());return this.day(this.day()%7?t:t-7)}else return this.day()||7}function er(e){if(this._weekdaysParseExact){if(!l(this,"_weekdaysRegex"))nr.call(this);if(e)return this._weekdaysStrictRegex;else return this._weekdaysRegex}else{if(!l(this,"_weekdaysRegex"))this._weekdaysRegex=Bt;return this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex}}function tr(e){if(this._weekdaysParseExact){if(!l(this,"_weekdaysRegex"))nr.call(this);if(e)return this._weekdaysShortStrictRegex;else return this._weekdaysShortRegex}else{if(!l(this,"_weekdaysShortRegex"))this._weekdaysShortRegex=jt;return this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex}}function rr(e){if(this._weekdaysParseExact){if(!l(this,"_weekdaysRegex"))nr.call(this);if(e)return this._weekdaysMinStrictRegex;else return this._weekdaysMinRegex}else{if(!l(this,"_weekdaysMinRegex"))this._weekdaysMinRegex=zt;return this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex}}function nr(){function e(e,t){return t.length-e.length}var t=[],r=[],n=[],i=[],o,s,a,l,c;for(o=0;o<7;o++){s=u([2e3,1]).day(o);a=m(this.weekdaysMin(s,""));l=m(this.weekdaysShort(s,""));c=m(this.weekdays(s,""));t.push(a);r.push(l);n.push(c);i.push(a);i.push(l);i.push(c)}t.sort(e);r.sort(e);n.sort(e);i.sort(e);this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i");this._weekdaysShortRegex=this._weekdaysRegex;this._weekdaysMinRegex=this._weekdaysRegex;this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i");this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i");this._weekdaysMinStrictRegex=new RegExp("^("+t.join("|")+")","i")}function ir(){return this.hours()%12||12}function or(){return this.hours()||24}function sr(e,t){n(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function ar(e,t){return t._meridiemParse}function lr(e){return(e+"").toLowerCase().charAt(0)==="p"}n("H",["HH",2],0,"hour"),n("h",["hh",2],0,ir),n("k",["kk",2],0,or),n("hmm",0,0,function(){return""+ir.apply(this)+o(this.minutes(),2)}),n("hmmss",0,0,function(){return""+ir.apply(this)+o(this.minutes(),2)+o(this.seconds(),2)}),n("Hmm",0,0,function(){return""+this.hours()+o(this.minutes(),2)}),n("Hmmss",0,0,function(){return""+this.hours()+o(this.minutes(),2)+o(this.seconds(),2)}),sr("a",true),sr("A",false),i("a",ar),i("A",ar),i("H",r,je),i("h",r,Be),i("k",r,Be),i("HH",r,t),i("hh",r,t),i("kk",r,t),i("hmm",Me),i("hmmss",ke),i("Hmm",Me),i("Hmmss",ke),b(["H","HH"],T),b(["k","kk"],function(e,t,r){var n=v(e);t[T]=n===24?0:n}),b(["a","A"],function(e,t,r){r._isPm=r._locale.isPM(e);r._meridiem=e}),b(["h","hh"],function(e,t,r){t[T]=v(e);h(r).bigHour=true}),b("hmm",function(e,t,r){var n=e.length-2;t[T]=v(e.substr(0,n));t[S]=v(e.substr(n));h(r).bigHour=true}),b("hmmss",function(e,t,r){var n=e.length-4,i=e.length-2;t[T]=v(e.substr(0,n));t[S]=v(e.substr(n,2));t[_]=v(e.substr(i));h(r).bigHour=true}),b("Hmm",function(e,t,r){var n=e.length-2;t[T]=v(e.substr(0,n));t[S]=v(e.substr(n))}),b("Hmmss",function(e,t,r){var n=e.length-4,i=e.length-2;t[T]=v(e.substr(0,n));t[S]=v(e.substr(n,2));t[_]=v(e.substr(i))});var cr,ur=it("Hours",true);function dr(e,t,r){if(e>11)return r?"pm":"PM";else return r?"am":"AM"}var hr={calendar:ie,longDateFormat:fe,invalidDate:me,ordinal:ve,dayOfMonthOrdinalParse:be,relativeTime:Ce,months:dt,monthsShort:ht,week:Mt,weekdays:Vt,weekdaysMin:$t,weekdaysShort:Wt,meridiemParse:/[ap]\.?m?\.?/i},A={},pr={},fr;function gr(e,t){var r,n=Math.min(e.length,t.length);for(r=0;r<n;r+=1)if(e[r]!==t[r])return r;return n}function mr(e){return e?e.toLowerCase().replace("_","-"):e}function yr(e){var t=0,r,n,i,o;while(t<e.length){o=mr(e[t]).split("-");r=o.length;n=mr(e[t+1]);n=n?n.split("-"):null;while(r>0){i=br(o.slice(0,r).join("-"));if(i)return i;if(n&&n.length>=r&&gr(o,n)>=r-1)break;r--}t++}return fr}function vr(e){return!!(e&&e.match("^[^/\\\\]*$"))}function br(t){var e=null,r;if(A[t]===undefined&&"object"!=="undefined"&&us&&us.exports&&vr(t))try{e=fr._abbr;r=undefined;ds(339)("./"+t);wr(e)}catch(e){A[t]=null}return A[t]}function wr(e,t){var r;if(e){if(a(t))r=N(e);else r=Cr(e,t);if(r)fr=r;else if(typeof console!=="undefined"&&console.warn)console.warn("Locale "+e+" not found. Did you forget to load it?")}return fr._abbr}function Cr(e,t){if(t!==null){var r,n=hr;t.abbr=e;if(A[e]!=null){ee("defineLocaleOverride","use moment.updateLocale(localeName, config) to change "+"an existing locale. moment.defineLocale(localeName, "+"config) should only be used for creating a new locale "+"See http://momentjs.com/guides/#/warnings/define-locale/ for more info.");n=A[e]._config}else if(t.parentLocale!=null)if(A[t.parentLocale]!=null)n=A[t.parentLocale]._config;else{r=br(t.parentLocale);if(r!=null)n=r._config;else{if(!pr[t.parentLocale])pr[t.parentLocale]=[];pr[t.parentLocale].push({name:e,config:t});return null}}A[e]=new ne(re(n,t));if(pr[e])pr[e].forEach(function(e){Cr(e.name,e.config)});wr(e);return A[e]}else{delete A[e];return null}}function Er(e,t){if(t!=null){var r,n,i=hr;if(A[e]!=null&&A[e].parentLocale!=null)A[e].set(re(A[e]._config,t));else{n=br(e);if(n!=null)i=n._config;t=re(i,t);if(n==null)t.abbr=e;r=new ne(t);r.parentLocale=A[e];A[e]=r}wr(e)}else if(A[e]!=null)if(A[e].parentLocale!=null){A[e]=A[e].parentLocale;if(e===wr())wr(e)}else if(A[e]!=null)delete A[e];return A[e]}function N(e){var t;if(e&&e._locale&&e._locale._abbr)e=e._locale._abbr;if(!e)return fr;if(!s(e)){t=br(e);if(t)return t;e=[e]}return yr(e)}function Tr(){return Q(A)}function Sr(e){var t,r=e._a;if(r&&h(e).overflow===-2){t=r[C]<0||r[C]>11?C:r[E]<1||r[E]>ut(r[w],r[C])?E:r[T]<0||r[T]>24||r[T]===24&&(r[S]!==0||r[_]!==0||r[Ze]!==0)?T:r[S]<0||r[S]>59?S:r[_]<0||r[_]>59?_:r[Ze]<0||r[Ze]>999?Ze:-1;if(h(e)._overflowDayOfYear&&(t<w||t>E))t=E;if(h(e)._overflowWeeks&&t===-1)t=Qe;if(h(e)._overflowWeekday&&t===-1)t=et;h(e).overflow=t}return e}var _r=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,xr=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Rr=/Z|[+-]\d\d(?::?\d\d)?/,Ar=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,false],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,false],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,false],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,false],["YYYY",/\d{4}/,false]],Nr=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Or=/^\/?Date\((-?\d+)/i,Ir=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Mr={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function kr(e){var t,r,n=e._i,i=_r.exec(n)||xr.exec(n),o,s,a,l,c=Ar.length,u=Nr.length;if(i){h(e).iso=true;for(t=0,r=c;t<r;t++)if(Ar[t][1].exec(i[1])){s=Ar[t][0];o=Ar[t][2]!==false;break}if(s==null){e._isValid=false;return}if(i[3]){for(t=0,r=u;t<r;t++)if(Nr[t][1].exec(i[3])){a=(i[2]||" ")+Nr[t][0];break}if(a==null){e._isValid=false;return}}if(!o&&a!=null){e._isValid=false;return}if(i[4])if(Rr.exec(i[4]))l="Z";else{e._isValid=false;return}e._f=s+(a||"")+(l||"");zr(e)}else e._isValid=false}function Dr(e,t,r,n,i,o){var s=[Pr(e),ht.indexOf(t),parseInt(r,10),parseInt(n,10),parseInt(i,10)];if(o)s.push(parseInt(o,10));return s}function Pr(e){var t=parseInt(e,10);if(t<=49)return 2e3+t;else if(t<=999)return 1900+t;return t}function Lr(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Fr(e,t,r){if(e){var n=Wt.indexOf(e),i=new Date(t[0],t[1],t[2]).getDay();if(n!==i){h(r).weekdayMismatch=true;r._isValid=false;return false}}return true}function Hr(e,t,r){if(e)return Mr[e];else if(t)return 0;else{var n=parseInt(r,10),i=n%100,o=(n-i)/100;return o*60+i}}function Ur(e){var t=Ir.exec(Lr(e._i)),r;if(t){r=Dr(t[4],t[3],t[2],t[5],t[6],t[7]);if(!Fr(t[1],r,e))return;e._a=r;e._tzm=Hr(t[8],t[9],t[10]);e._d=Rt.apply(null,e._a);e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm);h(e).rfc2822=true}else e._isValid=false}function Vr(e){var t=Or.exec(e._i);if(t!==null){e._d=new Date(+t[1]);return}kr(e);if(e._isValid===false)delete e._isValid;else return;Ur(e);if(e._isValid===false)delete e._isValid;else return;if(e._strict)e._isValid=false;else d.createFromInputFallback(e)}function Wr(e,t,r){if(e!=null)return e;if(t!=null)return t;return r}function $r(e){var t=new Date(d.now());if(e._useUTC)return[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()];return[t.getFullYear(),t.getMonth(),t.getDate()]}function Br(e){var t,r,n=[],i,o,s;if(e._d)return;i=$r(e);if(e._w&&e._a[E]==null&&e._a[C]==null)jr(e);if(e._dayOfYear!=null){s=Wr(e._a[w],i[w]);if(e._dayOfYear>tt(s)||e._dayOfYear===0)h(e)._overflowDayOfYear=true;r=Rt(s,0,e._dayOfYear);e._a[C]=r.getUTCMonth();e._a[E]=r.getUTCDate()}for(t=0;t<3&&e._a[t]==null;++t)e._a[t]=n[t]=i[t];for(;t<7;t++)e._a[t]=n[t]=e._a[t]==null?t===2?1:0:e._a[t];if(e._a[T]===24&&e._a[S]===0&&e._a[_]===0&&e._a[Ze]===0){e._nextDay=true;e._a[T]=0}e._d=(e._useUTC?Rt:xt).apply(null,n);o=e._useUTC?e._d.getUTCDay():e._d.getDay();if(e._tzm!=null)e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm);if(e._nextDay)e._a[T]=24;if(e._w&&typeof e._w.d!=="undefined"&&e._w.d!==o)h(e).weekdayMismatch=true}function jr(e){var t,r,n,i,o,s,a,l,c;t=e._w;if(t.GG!=null||t.W!=null||t.E!=null){o=1;s=4;r=Wr(t.GG,e._a[w],Ot(O(),1,4).year);n=Wr(t.W,1);i=Wr(t.E,1);if(i<1||i>7)l=true}else{o=e._locale._week.dow;s=e._locale._week.doy;c=Ot(O(),o,s);r=Wr(t.gg,e._a[w],c.year);n=Wr(t.w,c.week);if(t.d!=null){i=t.d;if(i<0||i>6)l=true}else if(t.e!=null){i=t.e+o;if(t.e<0||t.e>6)l=true}else i=o}if(n<1||n>R(r,o,s))h(e)._overflowWeeks=true;else if(l!=null)h(e)._overflowWeekday=true;else{a=Nt(r,n,i,o,s);e._a[w]=a.year;e._dayOfYear=a.dayOfYear}}function zr(e){if(e._f===d.ISO_8601){kr(e);return}if(e._f===d.RFC_2822){Ur(e);return}e._a=[];h(e).empty=true;var t=""+e._i,r,n,i,o,s,a=t.length,l=0,c,u;i=pe(e._f,e._locale).match(se)||[];u=i.length;for(r=0;r<u;r++){o=i[r];n=(t.match(Ye(o,e))||[])[0];if(n){s=t.substr(0,t.indexOf(n));if(s.length>0)h(e).unusedInput.push(s);t=t.slice(t.indexOf(n)+n.length);l+=n.length}if(ce[o]){if(n)h(e).empty=false;else h(e).unusedTokens.push(o);Xe(o,n,e)}else if(e._strict&&!n)h(e).unusedTokens.push(o)}h(e).charsLeftOver=a-l;if(t.length>0)h(e).unusedInput.push(t);if(e._a[T]<=12&&h(e).bigHour===true&&e._a[T]>0)h(e).bigHour=undefined;h(e).parsedDateParts=e._a.slice(0);h(e).meridiem=e._meridiem;e._a[T]=Yr(e._locale,e._a[T],e._meridiem);c=h(e).era;if(c!==null)e._a[w]=e._locale.erasConvertYear(c,e._a[w]);Br(e);Sr(e)}function Yr(e,t,r){var n;if(r==null)return t;if(e.meridiemHour!=null)return e.meridiemHour(t,r);else if(e.isPM!=null){n=e.isPM(r);if(n&&t<12)t+=12;if(!n&&t===12)t=0;return t}else return t}function Gr(e){var t,r,n,i,o,s,a=false,l=e._f.length;if(l===0){h(e).invalidFormat=true;e._d=new Date(NaN);return}for(i=0;i<l;i++){o=0;s=false;t=K({},e);if(e._useUTC!=null)t._useUTC=e._useUTC;t._f=e._f[i];zr(t);if(z(t))s=true;o+=h(t).charsLeftOver;o+=h(t).unusedTokens.length*10;h(t).score=o;if(!a){if(n==null||o<n||s){n=o;r=t;if(s)a=true}}else if(o<n){n=o;r=t}}B(e,r||t)}function qr(e){if(e._d)return;var t=_e(e._i),r=t.day===undefined?t.date:t.day;e._a=$([t.year,t.month,r,t.hour,t.minute,t.second,t.millisecond],function(e){return e&&parseInt(e,10)});Br(e)}function Kr(e){var t=new X(Sr(Xr(e)));if(t._nextDay){t.add(1,"d");t._nextDay=undefined}return t}function Xr(e){var t=e._i,r=e._f;e._locale=e._locale||N(e._l);if(t===null||r===undefined&&t==="")return Y({nullInput:true});if(typeof t==="string")e._i=t=e._locale.preparse(t);if(p(t))return new X(Sr(t));else if(W(t))e._d=t;else if(s(r))Gr(e);else if(r)zr(e);else Jr(e);if(!z(e))e._d=null;return e}function Jr(e){var t=e._i;if(a(t))e._d=new Date(d.now());else if(W(t))e._d=new Date(t.valueOf());else if(typeof t==="string")Vr(e);else if(s(t)){e._a=$(t.slice(0),function(e){return parseInt(e,10)});Br(e)}else if(U(t))qr(e);else if(c(t))e._d=new Date(t);else d.createFromInputFallback(e)}function Zr(e,t,r,n,i){var o={};if(t===true||t===false){n=t;t=undefined}if(r===true||r===false){n=r;r=undefined}if(U(e)&&V(e)||s(e)&&e.length===0)e=undefined;o._isAMomentObject=true;o._useUTC=o._isUTC=i;o._l=r;o._i=e;o._f=t;o._strict=n;return Kr(o)}function O(e,t,r,n){return Zr(e,t,r,n,false)}d.createFromInputFallback=e("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), "+"which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are "+"discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),d.ISO_8601=function(){},d.RFC_2822=function(){};var Qr=e("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=O.apply(null,arguments);if(this.isValid()&&e.isValid())return e<this?this:e;else return Y()}),en=e("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=O.apply(null,arguments);if(this.isValid()&&e.isValid())return e>this?this:e;else return Y()});function tn(e,t){var r,n;if(t.length===1&&s(t[0]))t=t[0];if(!t.length)return O();r=t[0];for(n=1;n<t.length;++n)if(!t[n].isValid()||t[n][e](r))r=t[n];return r}function rn(){var e=[].slice.call(arguments,0);return tn("isBefore",e)}function nn(){var e=[].slice.call(arguments,0);return tn("isAfter",e)}var on=function(){return Date.now?Date.now():+new Date},sn=["year","quarter","month","week","day","hour","minute","second","millisecond"];function an(e){var t,r=false,n,i=sn.length;for(t in e)if(l(e,t)&&!(x.call(sn,t)!==-1&&(e[t]==null||!isNaN(e[t]))))return false;for(n=0;n<i;++n)if(e[sn[n]]){if(r)return false;if(parseFloat(e[sn[n]])!==v(e[sn[n]]))r=true}return true}function ln(){return this._isValid}function cn(){return I(NaN)}function un(e){var t=_e(e),r=t.year||0,n=t.quarter||0,i=t.month||0,o=t.week||t.isoWeek||0,s=t.day||0,a=t.hour||0,l=t.minute||0,c=t.second||0,u=t.millisecond||0;this._isValid=an(t);this._milliseconds=+u+c*1e3+l*6e4+a*1e3*60*60;this._days=+s+o*7;this._months=+i+n*3+r*12;this._data={};this._locale=N();this._bubble()}function dn(e){return e instanceof un}function hn(e){if(e<0)return Math.round(-1*e)*-1;else return Math.round(e)}function pn(e,t,r){var n=Math.min(e.length,t.length),i=Math.abs(e.length-t.length),o=0,s;for(s=0;s<n;s++)if(r&&e[s]!==t[s]||!r&&v(e[s])!==v(t[s]))o++;return o+i}function fn(e,r){n(e,0,0,function(){var e=this.utcOffset(),t="+";if(e<0){e=-e;t="-"}return t+o(~~(e/60),2)+r+o(~~e%60,2)})}fn("Z",":"),fn("ZZ",""),i("Z",Ve),i("ZZ",Ve),b(["Z","ZZ"],function(e,t,r){r._useUTC=true;r._tzm=mn(Ve,e)});var gn=/([\+\-]|\d\d)/gi;function mn(e,t){var r=(t||"").match(e),n,i,o;if(r===null)return null;n=r[r.length-1]||[];i=(n+"").match(gn)||["-",0,0];o=+(i[1]*60)+v(i[2]);return o===0?0:i[0]==="+"?o:-o}function yn(e,t){var r,n;if(t._isUTC){r=t.clone();n=(p(e)||W(e)?e.valueOf():O(e).valueOf())-r.valueOf();r._d.setTime(r._d.valueOf()+n);d.updateOffset(r,false);return r}else return O(e).local()}function vn(e){return-Math.round(e._d.getTimezoneOffset())}function bn(e,t,r){var n=this._offset||0,i;if(!this.isValid())return e!=null?this:NaN;if(e!=null){if(typeof e==="string"){e=mn(Ve,e);if(e===null)return this}else if(Math.abs(e)<16&&!r)e=e*60;if(!this._isUTC&&t)i=vn(this);this._offset=e;this._isUTC=true;if(i!=null)this.add(i,"m");if(n!==e)if(!t||this._changeInProgress)Ln(this,I(e-n,"m"),1,false);else if(!this._changeInProgress){this._changeInProgress=true;d.updateOffset(this,true);this._changeInProgress=null}return this}else return this._isUTC?n:vn(this)}function wn(e,t){if(e!=null){if(typeof e!=="string")e=-e;this.utcOffset(e,t);return this}else return-this.utcOffset()}function Cn(e){return this.utcOffset(0,e)}function En(e){if(this._isUTC){this.utcOffset(0,e);this._isUTC=false;if(e)this.subtract(vn(this),"m")}return this}function Tn(){if(this._tzm!=null)this.utcOffset(this._tzm,false,true);else if(typeof this._i==="string"){var e=mn(Ue,this._i);if(e!=null)this.utcOffset(e);else this.utcOffset(0,true)}return this}function Sn(e){if(!this.isValid())return false;e=e?O(e).utcOffset():0;return(this.utcOffset()-e)%60===0}function _n(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function xn(){if(!a(this._isDSTShifted))return this._isDSTShifted;var e={},t;K(e,this);e=Xr(e);if(e._a){t=e._isUTC?u(e._a):O(e._a);this._isDSTShifted=this.isValid()&&pn(e._a,t.toArray())>0}else this._isDSTShifted=false;return this._isDSTShifted}function Rn(){return this.isValid()?!this._isUTC:false}function An(){return this.isValid()?this._isUTC:false}function Nn(){return this.isValid()?this._isUTC&&this._offset===0:false}d.updateOffset=function(){};var On=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,In=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function I(e,t){var r=e,n=null,i,o,s;if(dn(e))r={ms:e._milliseconds,d:e._days,M:e._months};else if(c(e)||!isNaN(+e)){r={};if(t)r[t]=+e;else r.milliseconds=+e}else if(n=On.exec(e)){i=n[1]==="-"?-1:1;r={y:0,d:v(n[E])*i,h:v(n[T])*i,m:v(n[S])*i,s:v(n[_])*i,ms:v(hn(n[Ze]*1e3))*i}}else if(n=In.exec(e)){i=n[1]==="-"?-1:1;r={y:Mn(n[2],i),M:Mn(n[3],i),w:Mn(n[4],i),d:Mn(n[5],i),h:Mn(n[6],i),m:Mn(n[7],i),s:Mn(n[8],i)}}else if(r==null)r={};else if(typeof r==="object"&&("from"in r||"to"in r)){s=Dn(O(r.from),O(r.to));r={};r.ms=s.milliseconds;r.M=s.months}o=new un(r);if(dn(e)&&l(e,"_locale"))o._locale=e._locale;if(dn(e)&&l(e,"_isValid"))o._isValid=e._isValid;return o}function Mn(e,t){var r=e&&parseFloat(e.replace(",","."));return(isNaN(r)?0:r)*t}function kn(e,t){var r={};r.months=t.month()-e.month()+(t.year()-e.year())*12;if(e.clone().add(r.months,"M").isAfter(t))--r.months;r.milliseconds=+t-+e.clone().add(r.months,"M");return r}function Dn(e,t){var r;if(!(e.isValid()&&t.isValid()))return{milliseconds:0,months:0};t=yn(t,e);if(e.isBefore(t))r=kn(e,t);else{r=kn(t,e);r.milliseconds=-r.milliseconds;r.months=-r.months}return r}function Pn(i,o){return function(e,t){var r,n;if(t!==null&&!isNaN(+t)){ee(o,"moment()."+o+"(period, number) is deprecated. Please use moment()."+o+"(number, period). "+"See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info.");n=e;e=t;t=n}r=I(e,t);Ln(this,r,i);return this}}function Ln(e,t,r,n){var i=t._milliseconds,o=hn(t._days),s=hn(t._months);if(!e.isValid())return;n=n==null?true:n;if(s)wt(e,ot(e,"Month")+s*r);if(o)st(e,"Date",ot(e,"Date")+o*r);if(i)e._d.setTime(e._d.valueOf()+i*r);if(n)d.updateOffset(e,o||s)}I.fn=un.prototype,I.invalid=cn;var Fn=Pn(1,"add"),Hn=Pn(-1,"subtract");function Un(e){return typeof e==="string"||e instanceof String}function Vn(e){return p(e)||W(e)||Un(e)||c(e)||$n(e)||Wn(e)||e===null||e===undefined}function Wn(e){var t=U(e)&&!V(e),r=false,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=n.length;for(i=0;i<s;i+=1){o=n[i];r=r||l(e,o)}return t&&r}function $n(t){var e=s(t),r=false;if(e)r=t.filter(function(e){return!c(e)&&Un(t)}).length===0;return e&&r}function Bn(e){var t=U(e)&&!V(e),r=false,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<n.length;i+=1){o=n[i];r=r||l(e,o)}return t&&r}function jn(e,t){var r=e.diff(t,"days",true);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function zn(e,t){if(arguments.length===1)if(!arguments[0]){e=undefined;t=undefined}else if(Vn(arguments[0])){e=arguments[0];t=undefined}else if(Bn(arguments[0])){t=arguments[0];e=undefined}var r=e||O(),n=yn(r,this).startOf("day"),i=d.calendarFormat(this,n)||"sameElse",o=t&&(f(t[i])?t[i].call(this,r):t[i]);return this.format(o||this.localeData().calendar(i,this,O(r)))}function Yn(){return new X(this)}function Gn(e,t){var r=p(e)?e:O(e);if(!(this.isValid()&&r.isValid()))return false;t=g(t)||"millisecond";if(t==="millisecond")return this.valueOf()>r.valueOf();else return r.valueOf()<this.clone().startOf(t).valueOf()}function qn(e,t){var r=p(e)?e:O(e);if(!(this.isValid()&&r.isValid()))return false;t=g(t)||"millisecond";if(t==="millisecond")return this.valueOf()<r.valueOf();else return this.clone().endOf(t).valueOf()<r.valueOf()}function Kn(e,t,r,n){var i=p(e)?e:O(e),o=p(t)?t:O(t);if(!(this.isValid()&&i.isValid()&&o.isValid()))return false;n=n||"()";return(n[0]==="("?this.isAfter(i,r):!this.isBefore(i,r))&&(n[1]===")"?this.isBefore(o,r):!this.isAfter(o,r))}function Xn(e,t){var r=p(e)?e:O(e),n;if(!(this.isValid()&&r.isValid()))return false;t=g(t)||"millisecond";if(t==="millisecond")return this.valueOf()===r.valueOf();else{n=r.valueOf();return this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf()}}function Jn(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function Zn(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function Qn(e,t,r){var n,i,o;if(!this.isValid())return NaN;n=yn(e,this);if(!n.isValid())return NaN;i=(n.utcOffset()-this.utcOffset())*6e4;t=g(t);switch(t){case"year":o=ei(this,n)/12;break;case"month":o=ei(this,n);break;case"quarter":o=ei(this,n)/3;break;case"second":o=(this-n)/1e3;break;case"minute":o=(this-n)/6e4;break;case"hour":o=(this-n)/36e5;break;case"day":o=(this-n-i)/864e5;break;case"week":o=(this-n-i)/6048e5;break;default:o=this-n}return r?o:y(o)}function ei(e,t){if(e.date()<t.date())return-ei(t,e);var r=(t.year()-e.year())*12+(t.month()-e.month()),n=e.clone().add(r,"months"),i,o;if(t-n<0){i=e.clone().add(r-1,"months");o=(t-n)/(n-i)}else{i=e.clone().add(r+1,"months");o=(t-n)/(i-n)}return-(r+o)||0}function ti(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function ri(e){if(!this.isValid())return null;var t=e!==true,r=t?this.clone().utc():this;if(r.year()<0||r.year()>9999)return he(r,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ");if(f(Date.prototype.toISOString))if(t)return this.toDate().toISOString();else return new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",he(r,"Z"));return he(r,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function ni(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="",r,n,i,o;if(!this.isLocal()){e=this.utcOffset()===0?"moment.utc":"moment.parseZone";t="Z"}r="["+e+'("]';n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY";i="-MM-DD[T]HH:mm:ss.SSS";o=t+'[")]';return this.format(r+n+i+o)}function ii(e){if(!e)e=this.isUtc()?d.defaultFormatUtc:d.defaultFormat;var t=he(this,e);return this.localeData().postformat(t)}function oi(e,t){if(this.isValid()&&(p(e)&&e.isValid()||O(e).isValid()))return I({to:this,from:e}).locale(this.locale()).humanize(!t);else return this.localeData().invalidDate()}function si(e){return this.from(O(),e)}function ai(e,t){if(this.isValid()&&(p(e)&&e.isValid()||O(e).isValid()))return I({from:this,to:e}).locale(this.locale()).humanize(!t);else return this.localeData().invalidDate()}function li(e){return this.to(O(),e)}function ci(e){var t;if(e===undefined)return this._locale._abbr;else{t=N(e);if(t!=null)this._locale=t;return this}}d.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",d.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var ui=e("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){if(e===undefined)return this.localeData();else return this.locale(e)});function di(){return this._locale}var hi=1e3,pi=60*hi,fi=60*pi,gi=(365*400+97)*24*fi;function mi(e,t){return(e%t+t)%t}function yi(e,t,r){if(e<100&&e>=0)return new Date(e+400,t,r)-gi;else return new Date(e,t,r).valueOf()}function vi(e,t,r){if(e<100&&e>=0)return Date.UTC(e+400,t,r)-gi;else return Date.UTC(e,t,r)}function bi(e){var t,r;e=g(e);if(e===undefined||e==="millisecond"||!this.isValid())return this;r=this._isUTC?vi:yi;switch(e){case"year":t=r(this.year(),0,1);break;case"quarter":t=r(this.year(),this.month()-this.month()%3,1);break;case"month":t=r(this.year(),this.month(),1);break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=r(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf();t-=mi(t+(this._isUTC?0:this.utcOffset()*pi),fi);break;case"minute":t=this._d.valueOf();t-=mi(t,pi);break;case"second":t=this._d.valueOf();t-=mi(t,hi);break}this._d.setTime(t);d.updateOffset(this,true);return this}function wi(e){var t,r;e=g(e);if(e===undefined||e==="millisecond"||!this.isValid())return this;r=this._isUTC?vi:yi;switch(e){case"year":t=r(this.year()+1,0,1)-1;break;case"quarter":t=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=r(this.year(),this.month()+1,1)-1;break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf();t+=fi-mi(t+(this._isUTC?0:this.utcOffset()*pi),fi)-1;break;case"minute":t=this._d.valueOf();t+=pi-mi(t,pi)-1;break;case"second":t=this._d.valueOf();t+=hi-mi(t,hi)-1;break}this._d.setTime(t);d.updateOffset(this,true);return this}function Ci(){return this._d.valueOf()-(this._offset||0)*6e4}function Ei(){return Math.floor(this.valueOf()/1e3)}function Ti(){return new Date(this.valueOf())}function Si(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function _i(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function xi(){return this.isValid()?this.toISOString():null}function Ri(){return z(this)}function Ai(){return B({},h(this))}function Ni(){return h(this).overflow}function Oi(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function Ii(e,t){var r,n,i,o=this._eras||N("en")._eras;for(r=0,n=o.length;r<n;++r){switch(typeof o[r].since){case"string":i=d(o[r].since).startOf("day");o[r].since=i.valueOf();break}switch(typeof o[r].until){case"undefined":o[r].until=+Infinity;break;case"string":i=d(o[r].until).startOf("day").valueOf();o[r].until=i.valueOf();break}}return o}function Mi(e,t,r){var n,i,o=this.eras(),s,a,l;e=e.toUpperCase();for(n=0,i=o.length;n<i;++n){s=o[n].name.toUpperCase();a=o[n].abbr.toUpperCase();l=o[n].narrow.toUpperCase();if(r)switch(t){case"N":case"NN":case"NNN":if(a===e)return o[n];break;case"NNNN":if(s===e)return o[n];break;case"NNNNN":if(l===e)return o[n];break}else if([s,a,l].indexOf(e)>=0)return o[n]}}function ki(e,t){var r=e.since<=e.until?+1:-1;if(t===undefined)return d(e.since).year();else return d(e.since).year()+(t-e.offset)*r}function Di(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e){r=this.clone().startOf("day").valueOf();if(n[e].since<=r&&r<=n[e].until)return n[e].name;if(n[e].until<=r&&r<=n[e].since)return n[e].name}return""}function Pi(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e){r=this.clone().startOf("day").valueOf();if(n[e].since<=r&&r<=n[e].until)return n[e].narrow;if(n[e].until<=r&&r<=n[e].since)return n[e].narrow}return""}function Li(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e){r=this.clone().startOf("day").valueOf();if(n[e].since<=r&&r<=n[e].until)return n[e].abbr;if(n[e].until<=r&&r<=n[e].since)return n[e].abbr}return""}function Fi(){var e,t,r,n,i=this.localeData().eras();for(e=0,t=i.length;e<t;++e){r=i[e].since<=i[e].until?+1:-1;n=this.clone().startOf("day").valueOf();if(i[e].since<=n&&n<=i[e].until||i[e].until<=n&&n<=i[e].since)return(this.year()-d(i[e].since).year())*r+i[e].offset}return this.year()}function Hi(e){if(!l(this,"_erasNameRegex"))zi.call(this);return e?this._erasNameRegex:this._erasRegex}function Ui(e){if(!l(this,"_erasAbbrRegex"))zi.call(this);return e?this._erasAbbrRegex:this._erasRegex}function Vi(e){if(!l(this,"_erasNarrowRegex"))zi.call(this);return e?this._erasNarrowRegex:this._erasRegex}function Wi(e,t){return t.erasAbbrRegex(e)}function $i(e,t){return t.erasNameRegex(e)}function Bi(e,t){return t.erasNarrowRegex(e)}function ji(e,t){return t._eraYearOrdinalRegex||Fe}function zi(){var e=[],t=[],r=[],n=[],i,o,s,a,l,c=this.eras();for(i=0,o=c.length;i<o;++i){s=m(c[i].name);a=m(c[i].abbr);l=m(c[i].narrow);t.push(s);e.push(a);r.push(l);n.push(s);n.push(a);n.push(l)}this._erasRegex=new RegExp("^("+n.join("|")+")","i");this._erasNameRegex=new RegExp("^("+t.join("|")+")","i");this._erasAbbrRegex=new RegExp("^("+e.join("|")+")","i");this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}function Yi(e,t){n(0,[e,e.length],0,t)}function Gi(e){return Qi.call(this,e,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function qi(e){return Qi.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function Ki(){return R(this.year(),1,4)}function Xi(){return R(this.isoWeekYear(),1,4)}function Ji(){var e=this.localeData()._week;return R(this.year(),e.dow,e.doy)}function Zi(){var e=this.localeData()._week;return R(this.weekYear(),e.dow,e.doy)}function Qi(e,t,r,n,i){var o;if(e==null)return Ot(this,n,i).year;else{o=R(e,n,i);if(t>o)t=o;return eo.call(this,e,t,r,n,i)}}function eo(e,t,r,n,i){var o=Nt(e,t,r,n,i),s=Rt(o.year,0,o.dayOfYear);this.year(s.getUTCFullYear());this.month(s.getUTCMonth());this.date(s.getUTCDate());return this}function to(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}n("N",0,0,"eraAbbr"),n("NN",0,0,"eraAbbr"),n("NNN",0,0,"eraAbbr"),n("NNNN",0,0,"eraName"),n("NNNNN",0,0,"eraNarrow"),n("y",["y",1],"yo","eraYear"),n("y",["yy",2],0,"eraYear"),n("y",["yyy",3],0,"eraYear"),n("y",["yyyy",4],0,"eraYear"),i("N",Wi),i("NN",Wi),i("NNN",Wi),i("NNNN",$i),i("NNNNN",Bi),b(["N","NN","NNN","NNNN","NNNNN"],function(e,t,r,n){var i=r._locale.erasParse(e,n,r._strict);if(i)h(r).era=i;else h(r).invalidEra=e}),i("y",Fe),i("yy",Fe),i("yyy",Fe),i("yyyy",Fe),i("yo",ji),b(["y","yy","yyy","yyyy"],w),b(["yo"],function(e,t,r,n){var i;if(r._locale._eraYearOrdinalRegex)i=e.match(r._locale._eraYearOrdinalRegex);if(r._locale.eraYearOrdinalParse)t[w]=r._locale.eraYearOrdinalParse(e,i);else t[w]=parseInt(e,10)}),n(0,["gg",2],0,function(){return this.weekYear()%100}),n(0,["GG",2],0,function(){return this.isoWeekYear()%100}),Yi("gggg","weekYear"),Yi("ggggg","weekYear"),Yi("GGGG","isoWeekYear"),Yi("GGGGG","isoWeekYear"),i("G",He),i("g",He),i("GG",r,t),i("gg",r,t),i("GGGG",Pe,Oe),i("gggg",Pe,Oe),i("GGGGG",Le,Ie),i("ggggg",Le,Ie),Ke(["gggg","ggggg","GGGG","GGGGG"],function(e,t,r,n){t[n.substr(0,2)]=v(e)}),Ke(["gg","GG"],function(e,t,r,n){t[n]=d.parseTwoDigitYear(e)}),n("Q",0,"Qo","quarter"),i("Q",Ae),b("Q",function(e,t){t[C]=(v(e)-1)*3}),n("D",["DD",2],"Do","date"),i("D",r,Be),i("DD",r,t),i("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient}),b(["D","DD"],E),b("Do",function(e,t){t[E]=v(e.match(r)[0])});var ro=it("Date",true);function no(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?t:this.add(e-t,"d")}n("DDD",["DDDD",3],"DDDo","dayOfYear"),i("DDD",De),i("DDDD",Ne),b(["DDD","DDDD"],function(e,t,r){r._dayOfYear=v(e)}),n("m",["mm",2],0,"minute"),i("m",r,je),i("mm",r,t),b(["m","mm"],S);var io=it("Minutes",false),oo=(n("s",["ss",2],0,"second"),i("s",r,je),i("ss",r,t),b(["s","ss"],_),it("Seconds",false)),so,ao;for(n("S",0,0,function(){return~~(this.millisecond()/100)}),n(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),n(0,["SSS",3],0,"millisecond"),n(0,["SSSS",4],0,function(){return this.millisecond()*10}),n(0,["SSSSS",5],0,function(){return this.millisecond()*100}),n(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3}),n(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4}),n(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5}),n(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6}),i("S",De,Ae),i("SS",De,t),i("SSS",De,Ne),so="SSSS";so.length<=9;so+="S")i(so,Fe);function lo(e,t){t[Ze]=v(("0."+e)*1e3)}for(so="S";so.length<=9;so+="S")b(so,lo);function co(){return this._isUTC?"UTC":""}function uo(){return this._isUTC?"Coordinated Universal Time":""}ao=it("Milliseconds",false),n("z",0,0,"zoneAbbr"),n("zz",0,0,"zoneName");var M=X.prototype;if(M.add=Fn,M.calendar=zn,M.clone=Yn,M.diff=Qn,M.endOf=wi,M.format=ii,M.from=oi,M.fromNow=si,M.to=ai,M.toNow=li,M.get=at,M.invalidAt=Ni,M.isAfter=Gn,M.isBefore=qn,M.isBetween=Kn,M.isSame=Xn,M.isSameOrAfter=Jn,M.isSameOrBefore=Zn,M.isValid=Ri,M.lang=ui,M.locale=ci,M.localeData=di,M.max=en,M.min=Qr,M.parsingFlags=Ai,M.set=lt,M.startOf=bi,M.subtract=Hn,M.toArray=Si,M.toObject=_i,M.toDate=Ti,M.toISOString=ri,M.inspect=ni,typeof Symbol!=="undefined"&&Symbol.for!=null)M[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"};function ho(e){return O(e*1e3)}function po(){return O.apply(null,arguments).parseZone()}function fo(e){return e}M.toJSON=xi,M.toString=ti,M.unix=Ei,M.valueOf=Ci,M.creationData=Oi,M.eraName=Di,M.eraNarrow=Pi,M.eraAbbr=Li,M.eraYear=Fi,M.year=rt,M.isLeapYear=nt,M.weekYear=Gi,M.isoWeekYear=qi,M.quarter=M.quarters=to,M.month=Ct,M.daysInMonth=Et,M.week=M.weeks=Pt,M.isoWeek=M.isoWeeks=Lt,M.weeksInYear=Ji,M.weeksInWeekYear=Zi,M.isoWeeksInYear=Ki,M.isoWeeksInISOWeekYear=Xi,M.date=ro,M.day=M.days=Jt,M.weekday=Zt,M.isoWeekday=Qt,M.dayOfYear=no,M.hour=M.hours=ur,M.minute=M.minutes=io,M.second=M.seconds=oo,M.millisecond=M.milliseconds=ao,M.utcOffset=bn,M.utc=Cn,M.local=En,M.parseZone=Tn,M.hasAlignedHourOffset=Sn,M.isDST=_n,M.isLocal=Rn,M.isUtcOffset=An,M.isUtc=Nn,M.isUTC=Nn,M.zoneAbbr=co,M.zoneName=uo,M.dates=e("dates accessor is deprecated. Use date instead.",ro),M.months=e("months accessor is deprecated. Use month instead",Ct),M.years=e("years accessor is deprecated. Use year instead",rt),M.zone=e("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",wn),M.isDSTShifted=e("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",xn);var k=ne.prototype;function go(e,t,r,n){var i=N(),o=u().set(n,t);return i[r](o,e)}function mo(e,t,r){if(c(e)){t=e;e=undefined}e=e||"";if(t!=null)return go(e,t,r,"month");var n,i=[];for(n=0;n<12;n++)i[n]=go(e,n,r,"month");return i}function yo(e,t,r,n){if(typeof e==="boolean"){if(c(t)){r=t;t=undefined}t=t||""}else{t=e;r=t;e=false;if(c(t)){r=t;t=undefined}t=t||""}var i=N(),o=e?i._week.dow:0,s,a=[];if(r!=null)return go(t,(r+o)%7,n,"day");for(s=0;s<7;s++)a[s]=go(t,(s+o)%7,n,"day");return a}function vo(e,t){return mo(e,t,"months")}function bo(e,t){return mo(e,t,"monthsShort")}function wo(e,t,r){return yo(e,t,r,"weekdays")}function Co(e,t,r){return yo(e,t,r,"weekdaysShort")}function Eo(e,t,r){return yo(e,t,r,"weekdaysMin")}k.calendar=oe,k.longDateFormat=ge,k.invalidDate=ye,k.ordinal=we,k.preparse=fo,k.postformat=fo,k.relativeTime=Ee,k.pastFuture=Te,k.set=te,k.eras=Ii,k.erasParse=Mi,k.erasConvertYear=ki,k.erasAbbrRegex=Ui,k.erasNameRegex=Hi,k.erasNarrowRegex=Vi,k.months=mt,k.monthsShort=yt,k.monthsParse=bt,k.monthsRegex=St,k.monthsShortRegex=Tt,k.week=It,k.firstDayOfYear=Dt,k.firstDayOfWeek=kt,k.weekdays=Yt,k.weekdaysMin=qt,k.weekdaysShort=Gt,k.weekdaysParse=Xt,k.weekdaysRegex=er,k.weekdaysShortRegex=tr,k.weekdaysMinRegex=rr,k.isPM=lr,k.meridiem=dr,wr("en",{eras:[{since:"0001-01-01",until:+Infinity,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-Infinity,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,r=v(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+r}}),d.lang=e("moment.lang is deprecated. Use moment.locale instead.",wr),d.langData=e("moment.langData is deprecated. Use moment.localeData instead.",N);var D=Math.abs;function To(){var e=this._data;this._milliseconds=D(this._milliseconds);this._days=D(this._days);this._months=D(this._months);e.milliseconds=D(e.milliseconds);e.seconds=D(e.seconds);e.minutes=D(e.minutes);e.hours=D(e.hours);e.months=D(e.months);e.years=D(e.years);return this}function So(e,t,r,n){var i=I(t,r);e._milliseconds+=n*i._milliseconds;e._days+=n*i._days;e._months+=n*i._months;return e._bubble()}function _o(e,t){return So(this,e,t,1)}function xo(e,t){return So(this,e,t,-1)}function Ro(e){if(e<0)return Math.floor(e);else return Math.ceil(e)}function Ao(){var e=this._milliseconds,t=this._days,r=this._months,n=this._data,i,o,s,a,l;if(!(e>=0&&t>=0&&r>=0||e<=0&&t<=0&&r<=0)){e+=Ro(Oo(r)+t)*864e5;t=0;r=0}n.milliseconds=e%1e3;i=y(e/1e3);n.seconds=i%60;o=y(i/60);n.minutes=o%60;s=y(o/60);n.hours=s%24;t+=y(s/24);l=y(No(t));r+=l;t-=Ro(Oo(l));a=y(r/12);r%=12;n.days=t;n.months=r;n.years=a;return this}function No(e){return e*4800/146097}function Oo(e){return e*146097/4800}function Io(e){if(!this.isValid())return NaN;var t,r,n=this._milliseconds;e=g(e);if(e==="month"||e==="quarter"||e==="year"){t=this._days+n/864e5;r=this._months+No(t);switch(e){case"month":return r;case"quarter":return r/3;case"year":return r/12}}else{t=this._days+Math.round(Oo(this._months));switch(e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return t*24+n/36e5;case"minute":return t*1440+n/6e4;case"second":return t*86400+n/1e3;case"millisecond":return Math.floor(t*864e5)+n;default:throw new Error("Unknown unit "+e)}}}function Mo(e){return function(){return this.as(e)}}var ko=Mo("ms"),Do=Mo("s"),Po=Mo("m"),Lo=Mo("h"),Fo=Mo("d"),Ho=Mo("w"),Uo=Mo("M"),Vo=Mo("Q"),Wo=Mo("y"),$o=ko;function Bo(){return I(this)}function jo(e){e=g(e);return this.isValid()?this[e+"s"]():NaN}function zo(e){return function(){return this.isValid()?this._data[e]:NaN}}var Yo=zo("milliseconds"),Go=zo("seconds"),qo=zo("minutes"),Ko=zo("hours"),Xo=zo("days"),Jo=zo("months"),Zo=zo("years");function Qo(){return y(this.days()/7)}var es=Math.round,ts={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function rs(e,t,r,n,i){return i.relativeTime(t||1,!!r,e,n)}function ns(e,t,r,n){var i=I(e).abs(),o=es(i.as("s")),s=es(i.as("m")),a=es(i.as("h")),l=es(i.as("d")),c=es(i.as("M")),u=es(i.as("w")),d=es(i.as("y")),h=o<=r.ss&&["s",o]||o<r.s&&["ss",o]||s<=1&&["m"]||s<r.m&&["mm",s]||a<=1&&["h"]||a<r.h&&["hh",a]||l<=1&&["d"]||l<r.d&&["dd",l];if(r.w!=null)h=h||u<=1&&["w"]||u<r.w&&["ww",u];h=h||c<=1&&["M"]||c<r.M&&["MM",c]||d<=1&&["y"]||["yy",d];h[2]=t;h[3]=+e>0;h[4]=n;return rs.apply(null,h)}function is(e){if(e===undefined)return es;if(typeof e==="function"){es=e;return true}return false}function os(e,t){if(ts[e]===undefined)return false;if(t===undefined)return ts[e];ts[e]=t;if(e==="s")ts.ss=t-1;return true}function ss(e,t){if(!this.isValid())return this.localeData().invalidDate();var r=false,n=ts,i,o;if(typeof e==="object"){t=e;e=false}if(typeof e==="boolean")r=e;if(typeof t==="object"){n=Object.assign({},ts,t);if(t.s!=null&&t.ss==null)n.ss=t.s-1}i=this.localeData();o=ns(this,!r,n,i);if(r)o=i.pastFuture(+this,o);return i.postformat(o)}var as=Math.abs;function ls(e){return(e>0)-(e<0)||+e}function cs(){if(!this.isValid())return this.localeData().invalidDate();var e=as(this._milliseconds)/1e3,t=as(this._days),r=as(this._months),n,i,o,s,a=this.asSeconds(),l,c,u,d;if(!a)return"P0D";n=y(e/60);i=y(n/60);e%=60;n%=60;o=y(r/12);r%=12;s=e?e.toFixed(3).replace(/\.?0+$/,""):"";l=a<0?"-":"";c=ls(this._months)!==ls(a)?"-":"";u=ls(this._days)!==ls(a)?"-":"";d=ls(this._milliseconds)!==ls(a)?"-":"";return l+"P"+(o?c+o+"Y":"")+(r?c+r+"M":"")+(t?u+t+"D":"")+(i||n||e?"T":"")+(i?d+i+"H":"")+(n?d+n+"M":"")+(e?d+s+"S":"")}var P=un.prototype;return P.isValid=ln,P.abs=To,P.add=_o,P.subtract=xo,P.as=Io,P.asMilliseconds=ko,P.asSeconds=Do,P.asMinutes=Po,P.asHours=Lo,P.asDays=Fo,P.asWeeks=Ho,P.asMonths=Uo,P.asQuarters=Vo,P.asYears=Wo,P.valueOf=$o,P._bubble=Ao,P.clone=Bo,P.get=jo,P.milliseconds=Yo,P.seconds=Go,P.minutes=qo,P.hours=Ko,P.days=Xo,P.weeks=Qo,P.months=Jo,P.years=Zo,P.humanize=ss,P.toISOString=cs,P.toString=cs,P.toJSON=cs,P.locale=ci,P.localeData=di,P.toIsoString=e("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",cs),P.lang=ui,n("X",0,0,"unix"),n("x",0,0,"valueOf"),i("x",He),i("X",We),b("X",function(e,t,r){r._d=new Date(parseFloat(e)*1e3)}),b("x",function(e,t,r){r._d=new Date(v(e))}),d.version="2.30.1",H(O),d.fn=M,d.min=rn,d.max=nn,d.now=on,d.utc=u,d.unix=ho,d.months=vo,d.isDate=W,d.locale=wr,d.invalid=Y,d.duration=I,d.isMoment=p,d.weekdays=wo,d.parseZone=po,d.localeData=N,d.isDuration=dn,d.monthsShort=bo,d.weekdaysMin=Eo,d.defineLocale=Cr,d.updateLocale=Er,d.locales=Tr,d.weekdaysShort=Co,d.normalizeUnits=g,d.relativeTimeRounding=is,d.relativeTimeThreshold=os,d.calendarFormat=jn,d.prototype=M,d.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},d}(),window.moment=ds(338)},(e,t,r)=>{var n={"./af":340,"./af.js":340,"./ar":341,"./ar-dz":342,"./ar-dz.js":342,"./ar-kw":343,"./ar-kw.js":343,"./ar-ly":344,"./ar-ly.js":344,"./ar-ma":345,"./ar-ma.js":345,"./ar-ps":346,"./ar-ps.js":346,"./ar-sa":347,"./ar-sa.js":347,"./ar-tn":348,"./ar-tn.js":348,"./ar.js":341,"./az":349,"./az.js":349,"./be":350,"./be.js":350,"./bg":351,"./bg.js":351,"./bm":352,"./bm.js":352,"./bn":353,"./bn-bd":354,"./bn-bd.js":354,"./bn.js":353,"./bo":355,"./bo.js":355,"./br":356,"./br.js":356,"./bs":357,"./bs.js":357,"./ca":358,"./ca.js":358,"./cs":359,"./cs.js":359,"./cv":360,"./cv.js":360,"./cy":361,"./cy.js":361,"./da":362,"./da.js":362,"./de":363,"./de-at":364,"./de-at.js":364,"./de-ch":365,"./de-ch.js":365,"./de.js":363,"./dv":366,"./dv.js":366,"./el":367,"./el.js":367,"./en-au":368,"./en-au.js":368,"./en-ca":369,"./en-ca.js":369,"./en-gb":370,"./en-gb.js":370,"./en-ie":371,"./en-ie.js":371,"./en-il":372,"./en-il.js":372,"./en-in":373,"./en-in.js":373,"./en-nz":374,"./en-nz.js":374,"./en-sg":375,"./en-sg.js":375,"./eo":376,"./eo.js":376,"./es":377,"./es-do":378,"./es-do.js":378,"./es-mx":379,"./es-mx.js":379,"./es-us":380,"./es-us.js":380,"./es.js":377,"./et":381,"./et.js":381,"./eu":382,"./eu.js":382,"./fa":383,"./fa.js":383,"./fi":384,"./fi.js":384,"./fil":385,"./fil.js":385,"./fo":386,"./fo.js":386,"./fr":387,"./fr-ca":388,"./fr-ca.js":388,"./fr-ch":389,"./fr-ch.js":389,"./fr.js":387,"./fy":390,"./fy.js":390,"./ga":391,"./ga.js":391,"./gd":392,"./gd.js":392,"./gl":393,"./gl.js":393,"./gom-deva":394,"./gom-deva.js":394,"./gom-latn":395,"./gom-latn.js":395,"./gu":396,"./gu.js":396,"./he":397,"./he.js":397,"./hi":398,"./hi.js":398,"./hr":399,"./hr.js":399,"./hu":400,"./hu.js":400,"./hy-am":401,"./hy-am.js":401,"./id":402,"./id.js":402,"./is":403,"./is.js":403,"./it":404,"./it-ch":405,"./it-ch.js":405,"./it.js":404,"./ja":406,"./ja.js":406,"./jv":407,"./jv.js":407,"./ka":408,"./ka.js":408,"./kk":409,"./kk.js":409,"./km":410,"./km.js":410,"./kn":411,"./kn.js":411,"./ko":412,"./ko.js":412,"./ku":413,"./ku-kmr":414,"./ku-kmr.js":414,"./ku.js":413,"./ky":415,"./ky.js":415,"./lb":416,"./lb.js":416,"./lo":417,"./lo.js":417,"./lt":418,"./lt.js":418,"./lv":419,"./lv.js":419,"./me":420,"./me.js":420,"./mi":421,"./mi.js":421,"./mk":422,"./mk.js":422,"./ml":423,"./ml.js":423,"./mn":424,"./mn.js":424,"./mr":425,"./mr.js":425,"./ms":426,"./ms-my":427,"./ms-my.js":427,"./ms.js":426,"./mt":428,"./mt.js":428,"./my":429,"./my.js":429,"./nb":430,"./nb.js":430,"./ne":431,"./ne.js":431,"./nl":432,"./nl-be":433,"./nl-be.js":433,"./nl.js":432,"./nn":434,"./nn.js":434,"./oc-lnc":435,"./oc-lnc.js":435,"./pa-in":436,"./pa-in.js":436,"./pl":437,"./pl.js":437,"./pt":438,"./pt-br":439,"./pt-br.js":439,"./pt.js":438,"./ro":440,"./ro.js":440,"./ru":441,"./ru.js":441,"./sd":442,"./sd.js":442,"./se":443,"./se.js":443,"./si":444,"./si.js":444,"./sk":445,"./sk.js":445,"./sl":446,"./sl.js":446,"./sq":447,"./sq.js":447,"./sr":448,"./sr-cyrl":449,"./sr-cyrl.js":449,"./sr.js":448,"./ss":450,"./ss.js":450,"./sv":451,"./sv.js":451,"./sw":452,"./sw.js":452,"./ta":453,"./ta.js":453,"./te":454,"./te.js":454,"./tet":455,"./tet.js":455,"./tg":456,"./tg.js":456,"./th":457,"./th.js":457,"./tk":458,"./tk.js":458,"./tl-ph":459,"./tl-ph.js":459,"./tlh":460,"./tlh.js":460,"./tr":461,"./tr.js":461,"./tzl":462,"./tzl.js":462,"./tzm":463,"./tzm-latn":464,"./tzm-latn.js":464,"./tzm.js":463,"./ug-cn":465,"./ug-cn.js":465,"./uk":466,"./uk.js":466,"./ur":467,"./ur.js":467,"./uz":468,"./uz-latn":469,"./uz-latn.js":469,"./uz.js":468,"./vi":470,"./vi.js":470,"./x-pseudo":471,"./x-pseudo.js":471,"./yo":472,"./yo.js":472,"./zh-cn":473,"./zh-cn.js":473,"./zh-hk":474,"./zh-hk.js":474,"./zh-mo":475,"./zh-mo.js":475,"./zh-tw":476,"./zh-tw.js":476};function i(e){e=o(e);return r(e)}function o(e){if(r.o(n,e))return n[e];throw(e=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",e}i.keys=function(){return Object.keys(n)},i.resolve=o,(e.exports=i).id=339},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},(e,t,r)=>{"use strict";t.__esModule=!0,t.toSingleLine=function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e=(0,i.arrayReduce)(e,(e,t,r)=>{return e+t.replace(/\r?\n\s*/g,"")+(n[r]||"")},"");return e.trim()};var i=r(478)},(e,t,r)=>{"use strict";function n(e,t,r,n){let i=-1,o=e,s=r;var a=(o=Array.isArray(e)?o:Array.from(e)).length;for(n&&a&&(i+=1,s=o[i]),i+=1;i<a;)s=t(s,o[i],i,o),i+=1;return s}function s(e,t){let r=0,n=e;for(var i=(n=Array.isArray(e)?n:Array.from(e)).length;r<i&&!1!==t(n[r],r,n);)r+=1;return e}function i(e){return n(e,(e,t)=>e+t,0)}t.__esModule=!0,t.arrayAvg=function(e){return e.length?i(e)/e.length:0},t.arrayEach=s,t.arrayFilter=function(e,t){let r=0,n=e;Array.isArray(e)||(n=Array.from(e));var i=n.length,o=[];let s=-1;for(;r<i;){var a=n[r];t(a,r,n)&&(s+=1,o[s]=a),r+=1}return o},t.arrayFlatten=function r(e){return n(e,(e,t)=>e.concat(Array.isArray(t)?r(t):t),[])},t.arrayMap=function(e,t){let r=0,n=e;Array.isArray(e)||(n=Array.from(e));var i=n.length,o=[];let s=-1;for(;r<i;){var a=n[r];s+=1,o[s]=t(a,r,n),r+=1}return o},t.arrayMax=function(e){return n(e,(e,t)=>t<e?e:t,Array.isArray(e)?e[0]:void 0)},t.arrayMin=function(e){return n(e,(e,t)=>e<t?e:t,Array.isArray(e)?e[0]:void 0)},t.arrayReduce=n,t.arraySum=i,t.arrayUnique=function(e){const t=[];return s(e,e=>{-1===t.indexOf(e)&&t.push(e)}),t},t.extendArray=function(e,t){var r=t.length;let n=0;for(;n<r;)e.push(t[n]),n+=1},t.getDifferenceOfArrays=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var[n,...i]=[...t];let o=n;return s(i,t=>{o=o.filter(e=>!t.includes(e))}),o},t.getIntersectionOfArrays=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var[n,...i]=[...t];let o=n;return s(i,t=>{o=o.filter(e=>t.includes(e))}),o},t.getUnionOfArrays=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const[n,...i]=[...t],o=new Set(n);return s(i,e=>{s(e,e=>{o.has(e)||o.add(e)})}),Array.from(o)},t.pivot=function(r){var n=[];if(r&&0!==r.length&&r[0]&&0!==r[0].length){var e=r.length,i=r[0].length;for(let t=0;t<e;t++)for(let e=0;e<i;e++)n[e]||(n[e]=[]),n[e][t]=r[t][e]}return n},t.stringToArray=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:" ";return e.split(t)},t.to2dArray=function(e){var t=e.length;let r=0;for(;r<t;)e[r]=[e[r]],r+=1},r(286),r(290),r(302),r(305),r(309),r(312),r(315),r(318)},(e,t)=>{"use strict";t.__esModule=!0;t.A11Y_TABINDEX=e=>["tabindex",e],t.A11Y_TREEGRID=()=>["role","treegrid"],t.A11Y_PRESENTATION=()=>["role","presentation"],t.A11Y_GRIDCELL=()=>["role","gridcell"],t.A11Y_ROWHEADER=()=>["role","rowheader"],t.A11Y_ROWGROUP=()=>["role","rowgroup"],t.A11Y_COLUMNHEADER=()=>["role","columnheader"],t.A11Y_ROW=()=>["role","row"],t.A11Y_MENU=()=>["role","menu"],t.A11Y_MENU_ITEM=()=>["role","menuitem"],t.A11Y_COMBOBOX=()=>["role","combobox"],t.A11Y_LISTBOX=()=>["role","listbox"],t.A11Y_OPTION=()=>["role","option"],t.A11Y_CHECKBOX=()=>["role","checkbox"],t.A11Y_SCOPE_COL=()=>["scope","col"],t.A11Y_SCOPE_ROW=()=>["scope","row"],t.A11Y_TEXT=()=>["type","text"],t.A11Y_LABEL=e=>["aria-label",e],t.A11Y_HIDDEN=()=>["aria-hidden","true"],t.A11Y_DISABLED=()=>["aria-disabled","true"],t.A11Y_MULTISELECTABLE=()=>["aria-multiselectable","true"],t.A11Y_HASPOPUP=e=>["aria-haspopup",e],t.A11Y_ROWCOUNT=e=>["aria-rowcount",e],t.A11Y_COLCOUNT=e=>["aria-colcount",e],t.A11Y_ROWINDEX=e=>["aria-rowindex",e],t.A11Y_COLINDEX=e=>["aria-colindex",e],t.A11Y_EXPANDED=e=>["aria-expanded",e],t.A11Y_SORT=e=>["aria-sort",e],t.A11Y_READONLY=()=>["aria-readonly","true"],t.A11Y_INVALID=()=>["aria-invalid","true"],t.A11Y_CHECKED=e=>["aria-checked",e],t.A11Y_SELECTED=()=>["aria-selected","true"],t.A11Y_AUTOCOMPLETE=()=>["aria-autocomplete","list"],t.A11Y_CONTROLS=e=>["aria-controls",e],t.A11Y_ACTIVEDESCENDANT=e=>["aria-activedescendant",e],t.A11Y_LIVE=e=>["aria-live",e],t.A11Y_RELEVANT=e=>["aria-relevant",e],t.A11Y_SETSIZE=e=>["aria-setsize",e];t.A11Y_POSINSET=e=>["aria-posinset",e]},(e,t,r)=>{"use strict";t.__esModule=!0,t.curry=function(a){const l=a.length;return function o(s){return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=s.concat(t);let i;return i=n.length>=l?a.apply(this,n):o(n)}}([])},t.curryRight=function(a){const l=a.length;return function o(s){return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=s.concat(t.reverse());let i;return i=n.length>=l?a.apply(this,n):o(n)}}([])},t.debounce=function(n){let i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:200,o=null,s;return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return o&&clearTimeout(o),o=setTimeout(()=>{s=n.apply(this,t)},i),s}},t.fastCall=function(e,t,r,n,i,o,s,a){{if((0,l.isDefined)(a))return e.call(t,r,n,i,o,s,a);if((0,l.isDefined)(s))return e.call(t,r,n,i,o,s);if((0,l.isDefined)(o))return e.call(t,r,n,i,o);if((0,l.isDefined)(i))return e.call(t,r,n,i);if((0,l.isDefined)(n))return e.call(t,r,n);if((0,l.isDefined)(r))return e.call(t,r)}return e.call(t)},t.isFunction=function(e){return"function"==typeof e},t.partial=function(n){for(var e=arguments.length,i=new Array(1<e?e-1:0),t=1;t<e;t++)i[t-1]=arguments[t];return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.apply(this,i.concat(t))}},t.pipe=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const[n,...i]=t;return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,o.arrayReduce)(i,(e,t)=>t(e),n.apply(this,t))}},t.throttle=s,t.throttleAfterHits=function(n){let e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:200,t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:10;const i=s(n,e);let o=t;function r(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return(o?(--o,n):i).apply(this,t)}return r.clearHits=function(){o=t},r};var o=r(478),l=r(337);function s(o){let s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:200,a=0;const l={lastCallThrottled:!0};let c=null;return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=Date.now();let i=!1;return l.lastCallThrottled=!0,a||(a=n,i=!0),n=s-(n-a),i?(l.lastCallThrottled=!1,o.apply(this,t)):(c&&clearTimeout(c),c=setTimeout(()=>{l.lastCallThrottled=!1,o.apply(this,t),a=0,c=void 0},n)),l}}},(e,t,r)=>{"use strict";t.__esModule=!0,t.isChrome=function(){return i.chrome.value},t.isChromeWebKit=function(){return i.chromeWebKit.value},t.isEdge=function(){return i.edge.value},t.isEdgeWebKit=function(){return i.edgeWebKit.value},t.isFirefox=function(){return i.firefox.value},t.isFirefoxWebKit=function(){return i.firefoxWebKit.value},t.isIOS=function(){return o.ios.value},t.isIpadOS=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:navigator)["maxTouchPoints"];return 2<e&&o.mac.value},t.isLinuxOS=function(){return o.linux.value},t.isMacOS=function(){return o.mac.value},t.isMobileBrowser=function(){return i.mobile.value},t.isSafari=function(){return i.safari.value},t.isWindowsOS=function(){return o.win.value},t.setBrowserMeta=s,t.setPlatformMeta=a;var n=r(482),t=r(485),r=r=>{const n={value:!1,test:(e,t)=>{n.value=r(e,t)}};return n};const i={chrome:r((e,t)=>/Chrome/.test(e)&&/Google/.test(t)),chromeWebKit:r(e=>/CriOS/.test(e)),edge:r(e=>/Edge/.test(e)),edgeWebKit:r(e=>/EdgiOS/.test(e)),firefox:r(e=>/Firefox/.test(e)),firefoxWebKit:r(e=>/FxiOS/.test(e)),mobile:r(e=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)),safari:r((e,t)=>/Safari/.test(e)&&/Apple Computer/.test(t))},o={mac:r(e=>/^Mac/.test(e)),win:r(e=>/^Win/.test(e)),linux:r(e=>/^Linux/.test(e)),ios:r(e=>/iPhone|iPad|iPod/i.test(e))};function s(){let{userAgent:t=navigator.userAgent,vendor:r=navigator.vendor}=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};(0,n.objectEach)(i,e=>{e=e.test;e(t,r)})}function a(){let{platform:t=navigator.platform}=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};(0,n.objectEach)(o,e=>{e=e.test;e(t)})}(0,t.isCSR)()&&(s(),a())},(e,t,r)=>{"use strict";t.__esModule=!0,t.clone=function(e){const r={};return a(e,(e,t)=>{r[t]=e}),r},t.createObjectPropListener=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"value";const r="_"+t,n={_touched:!1,[r]:e,isTouched(){return this._touched}};return Object.defineProperty(n,t,{get(){return this[r]},set(e){this._touched=!0,this[r]=e},enumerable:!0,configurable:!0}),n},t.deepClone=o,t.deepExtend=function r(n,i){a(i,(e,t)=>{i[t]&&"object"==typeof i[t]?(n[t]||(Array.isArray(i[t])?n[t]=[]:"[object Date]"===Object.prototype.toString.call(i[t])?n[t]=i[t]:n[t]={}),r(n[t],i[t])):n[t]=i[t]})},t.deepObjectSize=function(e){if(!s(e))return 0;function n(e){let r=0;return s(e)?a(e,(e,t)=>{"__children"!==t&&(r+=n(e))}):r+=1,r}return n(e)},t.defineGetter=function(e,t,r,n){n.value=r,n.writable=!1!==n.writable,n.enumerable=!1!==n.enumerable,n.configurable=!1!==n.configurable,Object.defineProperty(e,t,n)},t.duckSchema=function r(e){let n;Array.isArray(e)?n=e.length?new Array(e.length).fill(null):[]:(n={},a(e,(e,t)=>{"__children"!==t&&(e&&"object"==typeof e&&!Array.isArray(e)?n[t]=r(e):Array.isArray(e)?e.length&&"object"==typeof e[0]&&!Array.isArray(e[0])?n[t]=[r(e[0])]:n[t]=[]:n[t]=null)}));return n},t.extend=function(r,e,n){const i=Array.isArray(n);return a(e,(e,t)=>{!1!==i&&!n.includes(t)||(r[t]=e)}),r},t.getProperty=function(e,t){t=t.split(".");let r=e;return a(t,e=>{if(void 0===(r=r[e]))return r=void 0,!1}),r},t.hasOwnProperty=l,t.inherit=function(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e},t.isObject=s,t.isObjectEqual=function(e,t){return JSON.stringify(e)===JSON.stringify(t)},t.mixin=function(r){r.MIXINS||(r.MIXINS=[]);for(var e=arguments.length,t=new Array(1<e?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return(0,i.arrayEach)(t,e=>{r.MIXINS.push(e.MIXIN_NAME),a(e,(e,t)=>{if(void 0!==r.prototype[t])throw new Error(`Mixin conflict. Property '${t}' already exist and cannot be overwritten.`);"function"==typeof e?r.prototype[t]=e:Object.defineProperty(r.prototype,t,{get:function(e,t){const r="_"+e;return function(){return void 0===this[r]&&(this[r]=(e=>{let t=e;return t=Array.isArray(t)||s(t)?o(t):t})(t)),this[r]}}(t,e),set:function(e){const t="_"+e;return function(e){this[t]=e}}(t),configurable:!0})})}),r},t.objectEach=a,t.setProperty=function(e,t,r){const n=t.split(".");let i=e;n.forEach((e,t)=>{t!==n.length-1?(l(i,e)||(i[e]={}),i=i[e]):i[e]=r})},r(204),r(286),r(483);var i=r(478);function o(e){return"object"==typeof e?JSON.parse(JSON.stringify(e)):e}function s(e){return"[object Object]"===Object.prototype.toString.call(e)}function a(e,t){for(const r in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,r))&&!1===t(e[r],r,e))break;return e}function l(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},(e,t,r)=>{"use strict";function i(e,t){var r=p(arguments),n=f(t);if(d(n)||void 0!==e&&!h(e))return r[1]=function(e,t){if(d(n)&&(t=l(n,this,g(e),t)),!h(t))return t},a(m,null,r)}function o(e,t,r){var n=v(r,t-1),r=v(r,t+1);return y(T,e)&&!y(S,r)||y(S,e)&&!y(T,n)?"\\u"+C(b(e,0),16):e}var n=r(205),s=r(225),a=r(270),l=r(210),c=r(216),u=r(209),d=r(223),h=r(224),p=r(327),f=r(484),r=r(228),g=String,m=s("JSON","stringify"),y=c(/./.exec),v=c("".charAt),b=c("".charCodeAt),w=c("".replace),C=c(1..toString),E=/[\uD800-\uDFFF]/g,T=/^[\uD800-\uDBFF]$/,S=/^[\uDC00-\uDFFF]$/,_=!r||u(function(){var e=s("Symbol")("stringify detection");return"[null]"!==m([e])||"{}"!==m({a:e})||"{}"!==m(Object(e))}),x=u(function(){return'"\\udf06\\ud834"'!==m("\udf06\ud834")||'"\\udead"'!==m("\udead")});m&&n({target:"JSON",stat:!0,arity:3,forced:_||x},{stringify:function(e,t,r){var n=p(arguments),n=a(_?i:m,null,n);return x&&"string"==typeof n?w(n,E,o):n}})},(e,t,r)=>{"use strict";var n=r(216),a=r(288),l=r(223),c=r(217),u=r(279),d=n([].push);e.exports=function(e){if(l(e))return e;if(a(e)){for(var t=e.length,n=[],r=0;r<t;r++){var i=e[r];"string"==typeof i?d(n,i):"number"!=typeof i&&"Number"!==c(i)&&"String"!==c(i)||d(n,u(i))}var o=n.length,s=!0;return function(e,t){if(s)return s=!1,t;if(a(this))return t;for(var r=0;r<o;r++)if(n[r]===e)return t}}}},(e,t)=>{"use strict";t.__esModule=!0,t.cancelAnimationFrame=function(e){window.cancelAnimationFrame(e)},t.getComparisonFunction=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return r=r||("object"==typeof Intl?new Intl.Collator(e,t).compare:"function"==typeof String.prototype.localeCompare?(e,t)=>(""+e).localeCompare(t):(e,t)=>e===t?0:t<e?-1:1)},t.isCSR=function(){return"undefined"!=typeof window},t.isTouchSupported=function(){return"ontouchstart"in window},t.requestAnimationFrame=function(e){return window.requestAnimationFrame(e)};let r},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),n(r(487))),o=r(491),s=r(492),l=r(493),a=n(r(502));function c(e,t){var r=e;if(t.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object");t.add(e)}function u(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var d=new WeakSet;class h{constructor(e,t,r){c(this,d),(0,i.default)(this,"hot",void 0),(0,i.default)(this,"tableMeta",void 0),(0,i.default)(this,"selection",void 0),(0,i.default)(this,"eventManager",void 0),(0,i.default)(this,"destroyed",!1),(0,i.default)(this,"activeEditor",void 0),(0,i.default)(this,"cellProperties",void 0),this.hot=e,this.tableMeta=t,this.selection=r,this.eventManager=new a.default(e),this.hot.addHook("afterDocumentKeyDown",e=>u(d,this,p).call(this,e)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",e=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",e)}),this.hot.view._wt.update("onCellDblClick",(e,t,r)=>u(d,this,f).call(this,e,t,r))}getActiveEditor(){return this.activeEditor}prepareEditor(){if(this.activeEditor&&this.activeEditor.isWaiting())this.closeEditor(!1,!1,e=>{e&&this.prepareEditor()});else{var r=null==(r=this.hot.getSelectedRangeLast())?void 0:r.highlight;if(r&&!r.isHeader()){var n,i,o,{row:r,col:s}=r,a=this.hot.runHooks("modifyGetCellCoords",r,s);let e=r,t=s;Array.isArray(a)&&([e,t]=a),this.cellProperties=this.hot.getCellMeta(e,t),this.isCellEditable()?(a=this.hot.getCell(r,s,!0))&&(n=this.hot.getCellEditor(this.cellProperties),i=this.hot.colToProp(t),o=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(e),t),this.activeEditor=(0,l.getEditorInstance)(n,this.hot),this.activeEditor.prepare(r,s,i,a,o,this.cellProperties)):this.clearActiveEditor()}}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(t,r){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2];if(this.isCellEditable()){var i=this.hot.getSelectedRangeLast();let e=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,t,r,n);!1===(e=r instanceof MouseEvent&&"boolean"!=typeof e?0===this.hot.selection.getLayerLevel()&&i.isSingle():e)?this.clearActiveEditor():(this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(t,r)))}else this.clearActiveEditor()}closeEditor(e,t,r){this.activeEditor?this.activeEditor.finishEditing(e,t,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){var e,t,r,n,i=this.hot.getSelectedRangeLast();return!(!i||(e=this.hot.getCellEditor(this.cellProperties),{row:i,col:t}=i.highlight,{rowIndexMapper:n,columnIndexMapper:r}=this.hot,n=n.isHidden(this.hot.toPhysicalRow(i))||r.isHidden(this.hot.toPhysicalColumn(t)),this.cellProperties.readOnly)||!e||n)}moveSelectionAfterEnter(e){var t={..."function"==typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(t.row=-t.row,t.col=-t.col),this.hot.selection.isMultiple()?this.selection.transformFocus(t.row,t.col):this.selection.transformStart(t.row,t.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function p(e){var t,r=this.hot.getSelectedRangeLast();!this.hot.isListening()||!r||r.highlight.isHeader()||(0,s.isImmediatePropagationStopped)(e)||(r=e["keyCode"],t=(e.ctrlKey||e.metaKey)&&!e.altKey,this.activeEditor&&(!this.activeEditor||this.activeEditor.isWaiting()))||(0,o.isFunctionKey)(r)||(0,o.isCtrlMetaKey)(r)||t||this.isEditorOpened()||this.openEditor("",e)}function f(e,t){t.isCell()&&this.openEditor(null,e,!0)}const g=new WeakMap;h.getInstance=function(e,t,r){let n=g.get(e);return n||(n=new h(e,t,r),g.set(e,n)),n};t.default=h},(e,t,r)=>{var n=r(488);e.exports=function(e,t,r){return(t=n(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},e.exports.__esModule=!0,e.exports.default=e.exports},(e,t,r)=>{var n=r(489).default,i=r(490);e.exports=function(e){return e=i(e,"string"),"symbol"==n(e)?e:e+""},e.exports.__esModule=!0,e.exports.default=e.exports},t=>{function r(e){return t.exports=r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t.exports.__esModule=!0,t.exports.default=t.exports,r(e)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports},(e,t,r)=>{var n=r(489).default;e.exports=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);if(r=r.call(e,t||"default"),"object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")},e.exports.__esModule=!0,e.exports.default=e.exports},(e,t,r)=>{"use strict";t.__esModule=!0,t.isCtrlKey=function(e){var t=[];(0,i.isMacOS)()?t.push(o.COMMAND_LEFT,o.COMMAND_RIGHT,o.COMMAND_FIREFOX):t.push(o.CONTROL);return t.includes(e)},t.isCtrlMetaKey=function(e){return[o.CONTROL,o.COMMAND_LEFT,o.COMMAND_RIGHT,o.COMMAND_FIREFOX].includes(e)},t.isFunctionKey=function(e){return s.includes(e)},t.isKey=function(t,e){e=e.split("|");let r=!1;return(0,n.arrayEach)(e,e=>{if(t===o[e])return!(r=!0)}),r},t.isPrintableChar=function(e){return 32===e||48<=e&&e<=57||96<=e&&e<=111||186<=e&&e<=192||219<=e&&e<=222||226<=e||65<=e&&e<=90},r(286);var n=r(478),i=r(481);const o=t.KEY_CODES={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:(0,i.isFirefox)()?182:174,AUDIO_MUTE:(0,i.isFirefox)()?181:173,AUDIO_UP:(0,i.isFirefox)()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},s=[o.ALT,o.ARROW_DOWN,o.ARROW_LEFT,o.ARROW_RIGHT,o.ARROW_UP,o.AUDIO_DOWN,o.AUDIO_MUTE,o.AUDIO_UP,o.BACKSPACE,o.CAPS_LOCK,o.DELETE,o.END,o.ENTER,o.ESCAPE,o.F1,o.F2,o.F3,o.F4,o.F5,o.F6,o.F7,o.F8,o.F9,o.F10,o.F11,o.F12,o.F13,o.F14,o.F15,o.F16,o.F17,o.F18,o.F19,o.HOME,o.INSERT,o.MEDIA_NEXT,o.MEDIA_PLAY_PAUSE,o.MEDIA_PREV,o.MEDIA_STOP,o.NULL,o.NUM_LOCK,o.PAGE_DOWN,o.PAGE_UP,o.PAUSE,o.SCROLL_LOCK,o.SHIFT,o.TAB]},(e,t)=>{"use strict";t.__esModule=!0,t.isImmediatePropagationStopped=function(e){return!1===e.isImmediatePropagationEnabled},t.isLeftClick=function(e){return 0===e.button},t.isRightClick=function(e){return 2===e.button},t.isTouchEvent=function(e){return e instanceof TouchEvent},t.offsetRelativeTo=function(e,t){var r={x:e.offsetX,y:e.offsetY};let n=e.target;if(t instanceof HTMLElement&&(n===t||!n.contains(t)))for(;n!==t;)r.x+=n.offsetLeft,r.y+=n.offsetTop,n=n.offsetParent;return r},t.stopImmediatePropagation=function(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,t.RegisteredEditor=d,t.getEditorInstance=t._getEditorInstance=function(e,t){let r;if("function"==typeof e)o.get(e)||h(null,e),r=o.get(e);else{if("string"!=typeof e)throw Error('Only strings and functions can be passed as "editor" parameter');r=a(e)}if(r)return r.getInstance(t);throw Error(`No editor registered under name "${e}"`)},t.getEditor=function(e){if("function"==typeof e)return e;if(l(e))return a(e).getConstructor();throw Error(`No registered editor found under "${e}" name`)},t.registerEditor=h,r(204),n(r(494))),n=n(r(501));const o=new WeakMap,{register:s,getItem:a,hasItem:l,getNames:c,getValues:u}=(0,n.default)("editors");function d(e){const t={},r=e;this.getConstructor=function(){return e},this.getInstance=function(e){return e.guid in t||(t[e.guid]=new r(e)),t[e.guid]},i.default.getSingleton().add("afterDestroy",function(){t[this.guid]=null})}function h(e,t){e&&"string"!=typeof e&&(e=(t=e).EDITOR_TYPE);var r=new d(t);"string"==typeof e&&s(e,r),o.set(t,r)}t.getRegisteredEditors=u,t.getRegisteredEditorNames=c,t.hasEditor=l},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(286),r(495),n(r(487))),s=r(478),o=r(482),a=r(335),l=r(500),n=r(477),g=r(480);const c=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],u=(0,n.toSingleLine)`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,d=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),h=new Map([[]]),p=new WeakMap;class f{static getSingleton(){return m}constructor(){(0,i.default)(this,"globalBucket",void 0),this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const t=Object.create(null);return(0,s.arrayEach)(c,e=>{t[e]=[],this.initOrderMap(t,e)}),t}getBucket(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(n,i){let t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;var e=3<arguments.length?arguments[3]:void 0;if(Array.isArray(i))(0,s.arrayEach)(i,e=>this.add(n,e,t));else{d.has(n)&&(0,l.warn)((0,a.substitute)(u,{hookName:n,removedInVersion:d.get(n)})),h.has(n)&&(0,l.warn)(h.get(n));const o=this.getBucket(t);if(void 0===o[n]&&(this.register(n),o[n]=[],this.initOrderMap(o,n)),i.skip=!1,-1===o[n].indexOf(i)){let r=!1;i.initialHook&&(0,s.arrayEach)(o[n],(e,t)=>{if(e.initialHook)return o[n][t]=i,!(r=!0)}),r||o[n].push(i)}this.setCallbackOrderIndex(o,n,i,e),this.orderBucketByOrderIndex(o,n)}return this}once(t,e){let r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;var n=3<arguments.length?arguments[3]:void 0;Array.isArray(e)?(0,s.arrayEach)(e,e=>this.once(t,e,r)):(e.runOnce=!0,this.add(t,e,r,n))}remove(e,t){var r=this.getBucket(2<arguments.length&&void 0!==arguments[2]?arguments[2]:null);return void 0!==r[e]&&0<=r[e].indexOf(t)&&(t.skip=!0)}has(e){var t=this.getBucket(1<arguments.length&&void 0!==arguments[1]?arguments[1]:null);return!(void 0===t[e]||!t[e].length)}run(t,r,n,i,o,s,a,l){{var c,u=this.globalBucket[r],d=u?u.length:0;let e=0;if(d)for(;e<d;)!u[e]||u[e].skip?e+=1:(void 0!==(c=(0,g.fastCall)(u[e],t,n,i,o,s,a,l))&&(n=c),u[e]&&u[e].runOnce&&this.remove(r,u[e]),e+=1)}{var h,p=this.getBucket(t)[r],f=p?p.length:0;let e=0;if(f)for(;e<f;)!p[e]||p[e].skip?e+=1:(void 0!==(h=(0,g.fastCall)(p[e],t,n,i,o,s,a,l))&&(n=h),p[e]&&p[e].runOnce&&this.remove(r,p[e],t),e+=1)}return n}destroy(){(0,o.objectEach)(this.getBucket(0<arguments.length&&void 0!==arguments[0]?arguments[0]:null),(e,t,r)=>r[t].length=0)}register(e){this.isRegistered(e)||c.push(e)}deregister(e){this.isRegistered(e)&&c.splice(c.indexOf(e),1)}isDeprecated(e){return h.has(e)||d.has(e)}isRegistered(e){return 0<=c.indexOf(e)}getRegistered(){return c}setCallbackOrderIndex(e,t,r,n){n=Number.isInteger(n)?n:0,e=this.getCallbackOrderMap(e,t);e.set(n,[...e.get(n)||[],r])}orderBucketByOrderIndex(e,t){var r=this.getCallbackOrderMap(e,t);void 0===r||0===r.size||1===r.size&&r.has(0)||(e[t]=[...r].sort((e,t)=>e[0]-t[0]).flatMap(e=>{var[,e]=e;return e}))}initOrderMap(e,t){p.has(e)||p.set(e,[]),p.get(e)[t]=new Map}getCallbackOrderMap(e,t){return p.get(e)[t]}}const m=new f;t.default=f},(e,t,r)=>{"use strict";r(496)("flatMap")},(e,t,r)=>{"use strict";var n=r(235),i=r(497),r=r(246).f,o=n("unscopables"),s=Array.prototype;void 0===s[o]&&r(s,o,{configurable:!0,value:i(null)}),e.exports=function(e){s[o][e]=!0}},(e,t,r)=>{"use strict";function n(){}function i(e){e.write(g("")),e.close();var t=e.parentWindow.Object;return e=null,t}var o,s=r(248),a=r(498),l=r(267),c=r(256),u=r(326),d=r(244),r=r(255),h="prototype",p="script",f=r("IE_PROTO"),g=function(e){return"<"+p+">"+e+"</"+p+">"},m=function(){try{o=new ActiveXObject("htmlfile")}catch(e){}m="undefined"==typeof document||document.domain&&o?i(o):(e=d("iframe"),t="java"+p+":",e.style.display="none",u.appendChild(e),e.src=String(t),(t=e.contentWindow.document).open(),t.write(g("document.F=Object")),t.close(),t.F);for(var e,t,r=l.length;r--;)delete m[h][l[r]];return m()};c[f]=!0,e.exports=Object.create||function(e,t){var r;return null!==e?(n[h]=s(e),r=new n,n[h]=null,r[f]=e):r=m(),void 0===t?r:a.f(r,t)}},(e,t,r)=>{"use strict";var n=r(208),i=r(247),a=r(246),l=r(248),c=r(214),u=r(499);t.f=n&&!i?Object.defineProperties:function(e,t){l(e);for(var r,n=c(t),i=u(t),o=i.length,s=0;s<o;)a.f(e,r=i[s++],n[r]);return e}},(e,t,r)=>{"use strict";var n=r(260),i=r(267);e.exports=Object.keys||function(e){return n(e,i)}},(e,t,r)=>{"use strict";t.__esModule=!0,t.error=function(){(0,n.isDefined)(console)&&console.error(...arguments)},t.info=function(){(0,n.isDefined)(console)&&console.info(...arguments)},t.log=function(){(0,n.isDefined)(console)&&console.log(...arguments)},t.warn=function(){(0,n.isDefined)(console)&&console.warn(...arguments)};var n=r(337)},(e,t)=>{"use strict";t.__esModule=!0,t.default=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"common";n.has(e)||n.set(e,new Map);const r=n.get(e);return{register:function(e,t){r.set(e,t)},getItem:function(e){return r.get(e)},hasItem:function(e){return r.has(e)},getNames:function(){return[...r.keys()]},getValues:function(){return[...r.values()]}}};const n=t.collection=new Map},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,t.getListenersCounter=function(){return s},r(286),n(r(487))),o=r(492);let s=0;t.default=class{constructor(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;(0,i.default)(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]&&arguments[3];function i(e){r.call(this,function(e){const t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),(0,o.stopImmediatePropagation)(this)},e}(e))}return this.context.eventListeners.push({element:e,event:t,callback:r,callbackProxy:i,options:n,eventManager:this}),e.addEventListener(t,i,n),s+=1,()=>{this.removeEventListener(e,t,r)}}removeEventListener(e,t,r){var n,i=3<arguments.length&&void 0!==arguments[3]&&arguments[3];let o=this.context.eventListeners.length;for(;o;)--o,(n=this.context.eventListeners[o]).event!==t||n.element!==e||r&&r!==n.callback||i&&n.eventManager!==this||(this.context.eventListeners.splice(o,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options),--s)}clearEvents(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0];if(this.context){let e=this.context.eventListeners.length;for(;e;){--e;var r=this.context.eventListeners[e];t&&r.eventManager!==this||(this.context.eventListeners.splice(e,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),--s)}}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,t){let r=e.document,n=e;r||(r=e.ownerDocument||e,n=r.defaultView);var i={bubbles:!0,cancelable:"mousemove"!==t,view:n,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let o;r.createEvent?(o=r.createEvent("MouseEvents")).initMouseEvent(t,i.bubbles,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,i.relatedTarget||r.body.parentNode):o=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(o):e.fireEvent("on"+t,o)}}},(e,t,r)=>{"use strict";t.__esModule=!0,r(204);var n=r(500),i=r(334),o=r(480);function s(e,t,r){a(e,t),t.set(e,r)}function a(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function l(e,t){return e.get(u(e,t))}function c(e,t,r){e.set(u(e,t),r)}function u(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}const d=Object.freeze({CELL:"cell",MIXED:"mixed"});var h=new WeakMap,p=new WeakMap,f=new WeakMap,g=new WeakMap,m=new WeakMap,y=new WeakSet;function v(e){var t;const r=null==(t=l(h,this).getSelectedRangeLast())?void 0:t.highlight;r&&l(h,this).selection.isCellVisible(r)?null===(t=l(h,this).getCell(r.row,r.col,!0))?l(h,this).addHookOnce("afterScroll",()=>{e(l(h,this).getCell(r.row,r.col,!0))}):e(t):e(null)}function b(){u(y,this,v).call(this,e=>{var t=l(h,this).rootDocument["activeElement"];t&&(0,i.isOutsideInput)(t)&&t.blur(),this.focusOnHighlightedCell(e)})}function w(){u(y,this,v).call(this,e=>{this.getFocusMode()===d.MIXED&&"TD"===e.nodeName&&this.refocusToEditorTextarea()})}function C(e){"boolean"==typeof e.imeFastEdit&&this.setFocusMode(e.imeFastEdit?d.MIXED:d.CELL)}t.FocusManager=class{constructor(e){var t,n=this,r=(a(t=this,r=y),r.add(t),s(this,h,void 0),s(this,p,void 0),s(this,f,1),s(this,g,null),s(this,m,new Map),e.getSettings());c(h,this,e),c(p,this,r.imeFastEdit?d.MIXED:d.CELL),l(h,this).addHook("afterUpdateSettings",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return u(y,n,C).call(n,...t)}),l(h,this).addHook("afterSelection",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return u(y,n,b).call(n,...t)}),l(h,this).addHook("afterSelectionFocusSet",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return u(y,n,b).call(n,...t)}),l(h,this).addHook("afterSelectionEnd",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return u(y,n,w).call(n,...t)})}getFocusMode(){return l(p,this)}setFocusMode(e){Object.values(d).includes(e)?c(p,this,e):(0,n.warn)(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return l(f,this)}setRefocusDelay(e){c(f,this,e)}setRefocusElementGetter(e){c(g,this,e)}getRefocusElement(){var e;return"function"==typeof l(g,this)?l(g,this).call(this):null==(e=l(h,this).getActiveEditor())?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const t=t=>{var r=null==(r=l(h,this).getSelectedRangeLast())?void 0:r.highlight;if(r){let e=l(h,this).runHooks("modifyFocusedElement",r.row,r.col,t);!(e=e instanceof HTMLElement?e:t)||null!=(r=l(h,this).getActiveEditor())&&r.isOpened()||e.focus({preventScroll:!0})}};e?t(e):u(y,this,v).call(this,e=>t(e))}refocusToEditorTextarea(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:l(f,this);const r=this.getRefocusElement();!l(h,this).getSettings().imeFastEdit||null!=(e=l(h,this).getActiveEditor())&&e.isOpened()||!r||(l(m,this).has(t)||l(m,this).set(t,(0,o.debounce)(()=>{r.select()},t)),l(m,this).get(t)())}}},(e,t,r)=>{"use strict";t.__esModule=!0,t._dataToHTML=function(t){var r=t.length,n=["<table>"];for(let e=0;e<r;e+=1){var i=t[e],o=i.length,s=[];0===e&&n.push("<tbody>");for(let e=0;e<o;e+=1){var a=i[e],a=(0,b.isEmpty)(a)?"":a.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20{2,}/gi,e=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(e.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${a}</td>`)}n.push("<tr>",...s,"</tr>"),e+1===r&&n.push("</tbody>")}return n.push("</table>"),n.join("")},t.htmlToGridSettings=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:document;var r={},n=t.createDocumentFragment(),t=t.createElement("div");n.appendChild(t);let i=e;"string"==typeof i&&(n=i.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,e=>{var t=e.match(/<td\b[^>]*?>/g)[0];return""+t+e.substring(t.length,e.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(/<p.*?>/g,"\n").replace("\n","").replaceAll(/<\/(.*)>\s+$/gm,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/gm,"")+"</td>"}),t.insertAdjacentHTML("afterbegin",""+n),i=t.querySelector("table"));if(i&&function(e){return"TABLE"===(e&&e.nodeName||"")}(i)){var o=t.querySelector('meta[name$="enerator"]');const E=null!==i.querySelector("tbody th");var e=i.querySelector("tr"),s=e?Array.from(e.cells).reduce((e,t)=>e+t.colSpan,0)-(E?1:0):0,n=i.tFoot&&Array.from(i.tFoot.rows)||[];const T=[];i.tHead&&(t=Array.from(i.tHead.rows).filter(e=>{var t=null!==e.querySelector("td");return t&&T.push(e),!t}),e=t.length,a=0<e,1<e?r.nestedHeaders=Array.from(t).reduce((e,t)=>{t=Array.from(t.cells).reduce((e,t,r)=>{return E&&0===r||({colSpan:r,innerHTML:t}=t,e.push(1<r?{label:t,colspan:r}:t)),e},[]);return e.push(t),e},[]):a&&(r.colHeaders=Array.from(t[0].children).reduce((e,t,r)=>(E&&0===r||e.push(t.innerHTML),e),[]))),T.length&&(r.fixedRowsTop=T.length),n.length&&(r.fixedRowsBottom=n.length);var a,l,c=[...T,...Array.from(i.tBodies).reduce((e,t)=>(e.push(...Array.from(t.rows)),e),[]),...n],u=(l=c.length,new Array(l));for(let e=0;e<l;e++)u[e]=new Array(s);var d=[],h=[];for(let r=0;r<l;r++){var p=c[r],f=Array.from(p.cells),g=f.length;for(let e=0;e<g;e++){var m=f[e],{nodeName:y,innerHTML:v,rowSpan:b,colSpan:w}=m,C=u[r].findIndex(e=>void 0===e);if("TD"===y){if(1<b||1<w){for(let t=r;t<r+b;t++)if(t<l)for(let e=C;e<C+w;e++)u[t][e]=null;y=m.getAttribute("style");y&&y.includes("mso-ignore:colspan")||d.push({col:C,row:r,rowspan:b,colspan:w})}let e="";e=o&&/excel/gi.test(o.content)?v.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,"\r\n"):v.replace(/<br(\s*|\/)>[\r\n]?/gim,"\r\n"),u[r][C]=e.replace(_,e=>S[e])}else h.push(v)}}return d.length&&(r.mergeCells=d),h.length&&(r.rowHeaders=h),u.length&&(r.data=u),r}},t.instanceToHTML=function(n){var e=n.hasColHeaders(),i=n.hasRowHeaders(),t=[e?-1:0,i?-1:0,n.countRows()-1,n.countCols()-1],o=n.getData(...t),s=o.length,a=0<s?o[0].length:0,t=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],c=["<tbody>","</tbody>"],u=i?1:0,d=e?1:0;for(let r=0;r<s;r+=1){var h=e&&0===r,p=[];for(let t=0;t<a;t+=1){var f,g,m,y=!h&&i&&0===t;let e="";h?e=`<th>${n.getColHeader(t-u)}</th>`:y?e=`<th>${n.getRowHeader(r-d)}</th>`:(y=o[r][t],{hidden:g,rowspan:m,colspan:f}=n.getCellMeta(r-d,t-u),g||(g=[],m&&g.push(`rowspan="${m}"`),f&&g.push(`colspan="${f}"`),e=(0,b.isEmpty)(y)?`<td ${g.join(" ")}></td>`:(m=y.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;"),`<td ${g.join(" ")}>${m}</td>`))),p.push(e)}var v=["<tr>",...p,"</tr>"].join("");h?l.splice(1,0,v):c.splice(-1,0,v)}return t.splice(1,0,l.join(""),c.join("")),t.join("")},r(286),r(505);var b=r(337);const S={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},_=new RegExp(Object.keys(S).map(e=>`(${e})`).join("|"),"gi")},(e,t,r)=>{"use strict";var n=r(205),f=r(210),i=r(216),g=r(218),m=r(223),y=r(219),v=r(506),b=r(279),w=r(231),C=r(507),E=r(509),o=r(235),T=r(238),S=o("replace"),_=TypeError,x=i("".indexOf),R=i("".replace),A=i("".slice),N=Math.max;n({target:"String",proto:!0},{replaceAll:function(e,t){var r,n,i,o,s,a,l,c,u=g(this),d=0,h=0,p="";if(!y(e)){if((r=v(e))&&(n=b(g(C(e))),!~x(n,"g")))throw new _("`.replaceAll` does not allow non-global regexes");if(n=w(e,S))return f(n,e,u,t);if(T&&r)return R(b(u),e,t)}for(i=b(u),o=b(e),(s=m(t))||(t=b(t)),a=o.length,l=N(1,a),d=x(i,o);-1!==d;)c=s?b(t(o,d,i)):E(o,i,d,[],void 0,t),p+=A(i,h,d)+c,h=d+a,d=d+l>i.length?-1:x(i,o,d+l);return h<i.length&&(p+=A(i,h)),p}})},(e,t,r)=>{"use strict";var n=r(222),i=r(217),o=r(235)("match");e.exports=function(e){var t;return n(e)&&(void 0!==(t=e[o])?!!t:"RegExp"===i(e))}},(e,t,r)=>{"use strict";var n=r(210),i=r(240),o=r(226),s=r(508),a=RegExp.prototype;e.exports=function(e){var t=e.flags;return void 0!==t||"flags"in a||i(e,"flags")||!o(a,e)?t:n(s,e)}},(e,t,r)=>{"use strict";var n=r(248);e.exports=function(){var e=n(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t}},(e,t,r)=>{"use strict";var n=r(216),i=r(241),h=Math.floor,p=n("".charAt),f=n("".replace),g=n("".slice),m=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,y=/\$([$&'`]|\d{1,2})/g;e.exports=function(o,s,a,l,c,e){var u=a+o.length,d=l.length,t=y;return void 0!==c&&(c=i(c),t=m),f(e,t,function(e,t){var r;switch(p(t,0)){case"$":return"$";case"&":return o;case"`":return g(s,0,a);case"'":return g(s,u);case"<":r=c[g(t,1,-1)];break;default:var n,i=+t;if(0==i)return e;if(d<i)return 0!==(n=h(i/10))&&n<=d?void 0===l[n-1]?p(t,1):l[n-1]+p(t,1):e;r=l[i-1]}return void 0===r?"":r})}},(e,t,r)=>{"use strict";t.__esModule=!0,t.getPlugin=c,t.getPluginsNames=function(){return[...s.getItems(),...a.getItems()]},t.hasPlugin=function(e){return!!c(e)},t.registerPlugin=function(e,t,r){[e,t,r]=function(e,t,r){"function"==typeof e&&(e=(t=e).PLUGIN_KEY,r=t.PLUGIN_PRIORITY);return[e,t,r]}(e,t,r),void 0===c(e)&&function(e,t,r){e=(0,n.toUpperCaseFirst)(e);if(l.hasItem(e))throw new Error(o(e));void 0===r?a.addItem(e):s.addItem(r,e);l.addItem(e,t)}(e,t,r)},r(204);var n=r(335),t=r(511),i=r(513),r=r(514);const o=e=>`There is already registered "${e}" plugin.`;const s=(0,t.createPriorityMap)({errorPriorityExists:e=>`There is already registered plugin on priority "${e}".`,errorPriorityNaN:e=>`The priority "${e}" is not a number.`}),a=(0,r.createUniqueSet)({errorItemExists:o}),l=(0,i.createUniqueMap)({errorIdExists:o});function c(e){e=(0,n.toUpperCaseFirst)(e);return l.getItem(e)}},(e,t,r)=>{"use strict";t.__esModule=!0,t.createPriorityMap=function(){let{errorPriorityExists:r,errorPriorityNaN:n}=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};const i=new Map;return r=(0,s.isFunction)(r)?r:c,n=(0,s.isFunction)(n)?n:u,{addItem:function(e,t){if(!(0,o.isNumeric)(e))throw new Error(n(e));if(i.has(e))throw new Error(r(e));i.set(e,t)},getItems:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:a;const[r,n]=l.get(e)||l.get(a);return[...i].sort((e,t)=>e[0]<t[0]?r:n).map(e=>e[1])}}},r(204);var o=r(512),s=r(480);const a=t.ASC="asc";t.DESC="desc";const l=new Map([[a,[-1,1]],["desc",[1,-1]]]),c=e=>`The priority '${e}' is already declared in a map.`,u=e=>`The priority '${e}' is not a number.`},(e,t,r)=>{"use strict";function n(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],r=typeof e;return"number"==r?!isNaN(e)&&isFinite(e):"string"==r?0!==e.length&&(1===e.length?/\d/.test(e):(t=Array.from(new Set([".",...t])).map(e=>"\\"+e).join("|"),new RegExp(`^[+-]?(((${t})?\\d+((${t})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(e.trim()))):"object"==r&&!(!e||"number"!=typeof e.valueOf()||e instanceof Date)}t.__esModule=!0,t.clamp=function(e,t,r){{if(Math.min(e,t)===e)return t;if(Math.max(e,r)===e)return r}return e},t.isNumeric=n,t.isNumericLike=function(e){return n(e,[","])},t.rangeEach=function(e,t,r){let n=-1;"function"==typeof t?(r=t,t=e):n=e-1;for(;++n<=t&&!1!==r(n););},t.rangeEachReverse=function(e,t,r){let n=e+1;"function"==typeof t&&(r=t,t=0);for(;--n>=t&&!1!==r(n););},t.valueAccordingPercent=function(e,t){return t=parseInt(t.toString().replace("%",""),10),t=isNaN(t)?0:t,parseInt(e*t/100,10)},r(290),r(302),r(305),r(309),r(312),r(315),r(318)},(e,t,r)=>{"use strict";t.__esModule=!0,t.createUniqueMap=function(){let r=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})["errorIdExists"];const n=new Map;function t(){return[...n]}function i(e){return n.has(e)}return r=(0,o.isFunction)(r)?r:s,{addItem:function(e,t){if(i(e))throw new Error(r(e));n.set(e,t)},clear:function(){n.clear()},getId:function(r){var[e]=t().find(e=>{var[e,t]=e;return r===t&&e})||[null];return e},getItem:function(e){return n.get(e)},getItems:t,hasItem:i,removeItem:function(e){return n.delete(e)}}},r(204);var o=r(480);const s=e=>`The id '${e}' is already declared in a map.`},(e,t,r)=>{"use strict";t.__esModule=!0,t.createUniqueSet=function(){let t=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})["errorItemExists"];const r=new Set;return t=(0,n.isFunction)(t)?t:i,{addItem:function(e){if(r.has(e))throw new Error(t(e));r.add(e)},clear:function(){r.clear()},getItems:function(){return[...r]}}},r(204),r(290),r(302),r(305),r(309),r(312),r(315),r(318);var n=r(480);const i=e=>`'${e}' value is already declared in a unique set.`},(e,t,r)=>{"use strict";var n=r(197);t.__esModule=!0,t.getRenderer=function(e){if("function"==typeof e)return e;if(s(e))return o(e);throw Error(`No registered renderer found under "${e}" name`)},t.registerRenderer=function(e,t){"string"!=typeof e&&(e=(t=e).RENDERER_TYPE);i(e,t)},r(204);const{register:i,getItem:o,hasItem:s,getNames:a,getValues:l}=(0,n(r(501)).default)("renderers");t.getRegisteredRenderers=l,t.getRegisteredRendererNames=a,t.hasRenderer=s},(e,t,r)=>{"use strict";var n=r(197);t.__esModule=!0,t.getValidator=function(e){if("function"==typeof e)return e;if(s(e))return o(e);throw Error(`No registered validator found under "${e}" name`)},t.registerValidator=function(e,t){"string"!=typeof e&&(e=(t=e).VALIDATOR_TYPE);i(e,t)},r(204);const{register:i,getItem:o,hasItem:s,getNames:a,getValues:l}=(0,n(r(501)).default)("validators");t.getRegisteredValidators=l,t.getRegisteredValidatorNames=a,t.hasValidator=s},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),r(286),n(r(487))),u=r(334),o=n(r(502)),s=r(492),a=n(r(518)),l=r(593),c=r(594),d=r(479);function h(e,t,r){p(e,t),t.set(e,r)}function p(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function f(e,t){return e.get(m(e,t))}function g(e,t,r){e.set(m(e,t),r)}function m(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var y=new WeakMap,v=new WeakMap,b=new WeakMap,w=new WeakMap,C=new WeakMap,E=new WeakMap,T=new WeakMap,S=new WeakSet;function _(){return parseInt(this.hot.rootElement.getAttribute((0,d.A11Y_COLCOUNT)()[0]),10)}function x(e){e=m(S,this,_).call(this)+e;(0,u.setAttribute)(this.hot.rootElement,...(0,d.A11Y_COLCOUNT)(e))}t.default=class{constructor(e){var t,r;p(t=this,r=S),r.add(t),(0,i.default)(this,"hot",void 0),(0,i.default)(this,"eventManager",void 0),(0,i.default)(this,"settings",void 0),(0,i.default)(this,"THEAD",void 0),(0,i.default)(this,"TBODY",void 0),(0,i.default)(this,"_wt",void 0),(0,i.default)(this,"activeWt",void 0),h(this,y,0),h(this,v,0),(0,i.default)(this,"postponedAdjustElementsSize",!1),h(this,b,!1),h(this,w,void 0),h(this,C,void 0),h(this,E,0),h(this,T,0),this.hot=e,this.eventManager=new o.default(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,t){e=this._wt.getCell(e,t);return e<0?null:e}scrollViewport(e,t,r,n,i){return this._wt.scrollViewport(e,t,r,n,i)}scrollViewportHorizontally(e,t,r){return this._wt.scrollViewportHorizontally(e,t,r)}scrollViewportVertically(e,t,r){return this._wt.scrollViewportVertically(e,t,r)}createElements(){var{rootElement:e,rootDocument:t}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),(0,u.addClass)(e,"handsontable"),g(C,this,t.createElement("TABLE")),(0,u.addClass)(f(C,this),"htCore"),this.hot.getSettings().tableClassName&&(0,u.addClass)(f(C,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&((0,u.setAttribute)(f(C,this),[(0,d.A11Y_PRESENTATION)()]),(0,u.setAttribute)(e,[(0,d.A11Y_TREEGRID)(),(0,d.A11Y_ROWCOUNT)(-1),(0,d.A11Y_COLCOUNT)(this.hot.countCols()),(0,d.A11Y_MULTISELECTABLE)()])),this.THEAD=t.createElement("THEAD"),f(C,this).appendChild(this.THEAD),this.TBODY=t.createElement("TBODY"),f(C,this).appendChild(this.TBODY),this.hot.table=f(C,this),this.hot.container.insertBefore(f(C,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:a,rootDocument:l,selection:r,rootWindow:t}=this.hot,c=l.documentElement;this.eventManager.addEventListener(a,"mousedown",e=>{g(b,this,!0),this.isTextSelectionAllowed(e.target)||((0,u.clearTextSelection)(t),e.preventDefault(),t.focus())}),this.eventManager.addEventListener(a,"mouseup",()=>{g(b,this,!1)}),this.eventManager.addEventListener(a,"mousemove",e=>{f(b,this)&&!this.isTextSelectionAllowed(e.target)&&(this.settings.fragmentSelection&&(0,u.clearTextSelection)(t),e.preventDefault())}),this.eventManager.addEventListener(c,"keyup",e=>{r.isInProgress()&&!e.shiftKey&&r.finish()}),this.eventManager.addEventListener(c,"mouseup",e=>{r.isInProgress()&&(0,s.isLeftClick)(e)&&r.finish(),g(w,this,!1);var t=(0,u.isOutsideInput)(l.activeElement);(0,u.isInput)(l.activeElement)&&!t||!t&&(r.isSelected()||r.isSelectedByAnyHeader()||a.contains(e.target)||(0,s.isRightClick)(e))||this.hot.unlisten()}),this.eventManager.addEventListener(c,"contextmenu",e=>{r.isInProgress()&&(0,s.isRightClick)(e)&&(r.finish(),g(w,this,!1))}),this.eventManager.addEventListener(c,"touchend",()=>{r.isInProgress()&&r.finish(),g(w,this,!1)}),this.eventManager.addEventListener(c,"mousedown",e=>{var t=e.target,r=e.x||e.clientX,n=e.y||e.clientY;let i=e.target;if(!f(w,this)&&a&&this.hot.view){var o=this._wt.wtTable["holder"];if(i===o){var s=(0,u.getScrollbarWidth)(l);if(l.elementFromPoint(r+s,n)!==o||l.elementFromPoint(r,n+s)!==o)return}else for(;i!==c;){if(null===i){if(e.isTargetWebComponent)break;return}if(i===a)return;i=i.parentNode}("function"==typeof this.settings.outsideClickDeselects?this.settings.outsideClickDeselects(t):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)}});let e=(0,u.getParentWindow)(t);for(;null!==e;)this.eventManager.addEventListener(e.document.documentElement,"click",()=>{this.hot.unlisten()}),e=(0,u.getParentWindow)(e);this.eventManager.addEventListener(f(C,this),"selectstart",e=>{this.settings.fragmentSelection||(0,u.isInput)(e.target)||e.preventDefault()})}translateFromRenderableToVisualCoords(e){var{row:e,col:t}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(e,t))}translateFromRenderableToVisualIndex(e,t){let r=0<=e?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,n=0<=t?this.hot.columnIndexMapper.getVisualFromRenderableIndex(t):t;return null===r&&(r=e),null===n&&(n=t),[r,n]}countRenderableIndexes(e,t){t=Math.min(e.getNotTrimmedIndexesLength(),t),t=e.getNearestNotHiddenIndex(t-1,-1);return null===t?0:e.getRenderableFromVisualIndex(t)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,t,r,n){if(isNaN(e)||e<0)return 0;e=r.getNearestNotHiddenIndex(e,t),r=r.getRenderableFromVisualIndex(e);if(!Number.isInteger(r))return 0;let i=0;return t<0?i=r+1:0<t&&(i=n-r),i}countNotHiddenFixedColumnsStart(){var e=this.hot.countCols(),e=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(e,-1)}countNotHiddenFixedRowsTop(){var e=this.hot.countRows(),e=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(e,-1)}countNotHiddenFixedRowsBottom(){var e=this.hot.countRows(),e=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(e,1)}countRenderableColumnsInRange(t,r){let n=0;for(let e=t;e<=r;e++)null!==this.hot.columnIndexMapper.getRenderableFromVisualIndex(e)&&(n+=1);return n}countRenderableRowsInRange(t,r){let n=0;for(let e=t;e<=r;e++)null!==this.hot.rowIndexMapper.getRenderableFromVisualIndex(e)&&(n+=1);return n}isMainTableNotFullyCoveredByOverlays(){var e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),t=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>t}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:f(C,this),isDataViewInstance:()=>(0,c.isRootInstance)(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(e,t)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(e,t)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>0<this.settings.fixedColumnsStart||0<e.rowHeaders().length,shouldRenderTopOverlay:()=>0<this.settings.fixedRowsTop||0<e.columnHeaders().length,shouldRenderBottomOverlay:()=>0<this.settings.fixedRowsBottom,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{var e=[];return this.hot.hasRowHeaders()&&e.push((e,t)=>{e=0<=e?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e;this.appendRowHeader(e,t)}),this.hot.runHooks("afterGetRowHeaderRenderers",e),g(v,this,e.length),this.hot.getSettings().ariaTags&&m(S,this,_).call(this)===this.hot.countCols()&&m(S,this,x).call(this,f(v,this)),e},columnHeaders:()=>{var e=[];return this.hot.hasColHeaders()&&e.push((e,t)=>{e=0<=e?this.hot.columnIndexMapper.getVisualFromRenderableIndex(e):e;this.appendColHeader(e,t)}),this.hot.runHooks("afterGetColumnHeaderRenderers",e),g(y,this,e.length),e},columnWidth:e=>{var t=this.hot.columnIndexMapper.getVisualFromRenderableIndex(e);return this.hot.getColWidth(null===t?e:t)},rowHeight:e=>{var t=this.hot.rowIndexMapper.getVisualFromRenderableIndex(e);return this.hot.getRowHeight(null===t?e:t)},rowHeightByOverlayName:(e,t)=>{var r=this.hot.rowIndexMapper.getVisualFromRenderableIndex(e),e=null===r?e:r;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(e),e,t)},cellRenderer:(e,t,r)=>{var[e,t]=this.translateFromRenderableToVisualIndex(e,t),n=this.hot.runHooks("modifyGetCellCoords",e,t);let i=e,o=t;Array.isArray(n)&&([i,o]=n);var n=this.hot.getCellMeta(i,o),s=this.hot.colToProp(o);let a=this.hot.getDataAtRowProp(i,s);this.hot.hasHook("beforeValueRender")&&(a=this.hot.runHooks("beforeValueRender",a,n)),this.hot.runHooks("beforeRenderer",r,e,t,s,a,n),this.hot.getCellRenderer(n)(this.hot,r,e,t,s,a,n),this.hot.runHooks("afterRenderer",r,e,t,s,a,n)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&(0,u.isVisible)(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(e,t,r,n)=>{var t=this.translateFromRenderableToVisualCoords(t),i={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=n,g(w,this,!0),this.hot.runHooks("beforeOnCellMouseDown",e,t,r,i),(0,s.isImmediatePropagationStopped)(e)||((0,l.handleMouseEvent)(e,{coords:t,selection:this.hot.selection,controller:i,cellCoordsFactory:(e,t)=>this.hot._createCellCoords(e,t)}),this.hot.runHooks("afterOnCellMouseDown",e,t,r),this.activeWt=this._wt)},onCellContextMenu:(e,t,r,n)=>{t=this.translateFromRenderableToVisualCoords(t);this.activeWt=n,g(w,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",e,t,r),(0,s.isImmediatePropagationStopped)(e)||(this.hot.runHooks("afterOnCellContextMenu",e,t,r),this.activeWt=this._wt)},onCellMouseOut:(e,t,r,n)=>{t=this.translateFromRenderableToVisualCoords(t);this.activeWt=n,this.hot.runHooks("beforeOnCellMouseOut",e,t,r),(0,s.isImmediatePropagationStopped)(e)||(this.hot.runHooks("afterOnCellMouseOut",e,t,r),this.activeWt=this._wt)},onCellMouseOver:(e,t,r,n)=>{var t=this.translateFromRenderableToVisualCoords(t),i={row:!1,column:!1,cell:!1};this.activeWt=n,this.hot.runHooks("beforeOnCellMouseOver",e,t,r,i),(0,s.isImmediatePropagationStopped)(e)||(f(w,this)&&(0,l.handleMouseEvent)(e,{coords:t,selection:this.hot.selection,controller:i,cellCoordsFactory:(e,t)=>this.hot._createCellCoords(e,t)}),this.hot.runHooks("afterOnCellMouseOver",e,t,r),this.activeWt=this._wt)},onCellMouseUp:(e,t,r,n)=>{t=this.translateFromRenderableToVisualCoords(t);this.activeWt=n,this.hot.runHooks("beforeOnCellMouseUp",e,t,r),(0,s.isImmediatePropagationStopped)(e)||this.hot.isDestroyed||(this.hot.runHooks("afterOnCellMouseUp",e,t,r),this.activeWt=this._wt)},onCellCornerMouseDown:e=>{e.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",e)},onCellCornerDblClick:e=>{e.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",e)},beforeDraw:(e,t)=>this.beforeRender(e,t),onDraw:e=>this.afterRender(e),onBeforeViewportScrollVertically:e=>{var t=this.hot.rowIndexMapper,r=e<0;let n=e;return r||null!==(n=t.getVisualFromRenderableIndex(e))?(n=this.hot.runHooks("beforeViewportScrollVertically",n),this.hot.runHooks("beforeViewportScroll"),r?n:t.getRenderableFromVisualIndex(n)):e},onBeforeViewportScrollHorizontally:e=>{var t=this.hot.columnIndexMapper,r=e<0;let n=e;return r||null!==(n=t.getVisualFromRenderableIndex(e))?(n=this.hot.runHooks("beforeViewportScrollHorizontally",n),this.hot.runHooks("beforeViewportScroll"),r?n:t.getRenderableFromVisualIndex(n)):e},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(e,t,r)=>{var n=this.hot.rowIndexMapper,i=e<0;let o=e;i||(o=n.getVisualFromRenderableIndex(e));e=this.hot.runHooks("beforeHighlightingRowHeader",o,t,r);return i?e:n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(e,1))},onBeforeHighlightingColumnHeader:(e,t,r)=>{var n=this.hot.columnIndexMapper,i=e<0;let o=e;i||(o=n.getVisualFromRenderableIndex(e));e=this.hot.runHooks("beforeHighlightingColumnHeader",o,t,r);return i?e:n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(e,1))},onAfterDrawSelection:(e,t,r)=>{let n;var[e,t]=this.translateFromRenderableToVisualIndex(e,t),i=this.hot.selection.getSelectedRange();return 0<i.size()&&(i=i.peekByIndex(null!=r?r:0),n=[i.from.row,i.from.col,i.to.row,i.to.col]),this.hot.runHooks("afterDrawSelection",e,t,n,r)},onBeforeDrawBorders:(e,t)=>{var[e,r,n,i]=e,e=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(e),this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),this.hot.rowIndexMapper.getVisualFromRenderableIndex(n),this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)];return this.hot.runHooks("beforeDrawBorders",e,t)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(e,t)=>{t=this.hot.columnIndexMapper.getVisualFromRenderableIndex(t);return this.hot.runHooks("beforeStretchingColumnWidth",e,t)},onModifyRowHeaderWidth:e=>this.hot.runHooks("modifyRowHeaderWidth",e),onModifyGetCellCoords:(e,t,r)=>{var n,i=this.hot.rowIndexMapper,o=this.hot.columnIndexMapper,t=0<=t?o.getVisualFromRenderableIndex(t):t,e=0<=e?i.getVisualFromRenderableIndex(e):e,e=this.hot.runHooks("modifyGetCellCoords",e,t,r);if(Array.isArray(e))return[t,r,e,n]=e,[0<=t?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(t,1)):t,0<=r?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(r,1)):r,0<=e?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(e,-1)):e,0<=n?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(n,-1)):n]},viewportRowCalculatorOverride:e=>{let t=this.settings.viewportRowRenderingOffset;var r,n,i,o;(0<(t="auto"===t&&this.settings.fixedRowsTop?10:t)||"auto"===t)&&(r=this.countRenderableRows(),n=e.startRow,i=e.endRow,"number"==typeof t?(e.startRow=Math.max(n-t,0),e.endRow=Math.min(i+t,r-1)):"auto"===t&&(o=Math.ceil(i/r*12),e.startRow=Math.max(n-o,0),e.endRow=Math.min(i+o,r-1))),this.hot.runHooks("afterViewportRowCalculatorOverride",e)},viewportColumnCalculatorOverride:e=>{let t=this.settings.viewportColumnRenderingOffset;var r,n,i,o;(0<(t="auto"===t&&this.settings.fixedColumnsStart?10:t)||"auto"===t)&&(r=this.countRenderableColumns(),n=e.startColumn,i=e.endColumn,"number"==typeof t&&(e.startColumn=Math.max(n-t,0),e.endColumn=Math.min(i+t,r-1)),"auto"===t)&&(o=Math.ceil(i/r*6),e.startColumn=Math.max(n-o,0),e.endColumn=Math.min(i+o,r-1)),this.hot.runHooks("afterViewportColumnCalculatorOverride",e)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{var e=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||e}},t=(this.hot.runHooks("beforeInitWalkontable",e),this._wt=new a.default(e),this.activeWt=this._wt,this._wt.wtTable.spreader);var{width:r,height:n}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,n),this.eventManager.addEventListener(t,"mousedown",e=>{e.target===t&&3===e.which&&e.stopPropagation()}),this.eventManager.addEventListener(t,"contextmenu",e=>{e.target===t&&3===e.which&&e.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){return!(!(0,u.isInput)(e)&&(e=(0,u.isChildOf)(e,this._wt.wtTable.spreader),!0!==this.settings.fragmentSelection||!e)&&("cell"!==this.settings.fragmentSelection||!this.isSelectedOnlyCell()||!e)&&(this.settings.fragmentSelection||!this.isCellEdited()||!this.isSelectedOnlyCell()))}isMouseDown(){return f(w,this)}isSelectedOnlyCell(){var e;return null!=(e=null==(e=this.hot.getSelectedRangeLast())?void 0:e.isSingleCell())&&e}isCellEdited(){var e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,t){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,t)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,t){if(t.firstChild){var r=t.firstChild;if(!(0,u.hasClass)(r,"relative"))return(0,u.empty)(t),void this.appendRowHeader(e,t);this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{var{rootDocument:r,getRowHeader:n}=this.hot,i=r.createElement("div"),r=r.createElement("span");i.className="relative",r.className="rowHeader",this.updateCellHeader(r,e,n),i.appendChild(r),t.appendChild(i)}this.hot.runHooks("afterGetRowHeader",e,t)}appendColHeader(t,e){var r,n,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:this.hot.getColHeader,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,s=()=>{var e=0<=t?this.hot.getColumnMeta(t).headerClassName:null;return e?e.split(" "):[]};e.firstChild?(n=e.firstChild,(0,u.hasClass)(n,"relative")?(this.updateCellHeader(n.querySelector(".colHeader"),t,i,o),(n.className="",u.addClass)(n,["relative",...s()])):((0,u.empty)(e),this.appendColHeader(t,e,i,o))):(n=this.hot["rootDocument"],r=n.createElement("div"),n=n.createElement("span"),s=s(),r.classList.add("relative",...s),n.className="colHeader",this.settings.ariaTags&&((0,u.setAttribute)(r,...(0,d.A11Y_PRESENTATION)()),(0,u.setAttribute)(n,...(0,d.A11Y_PRESENTATION)())),this.updateCellHeader(n,t,i,o),r.appendChild(n),e.appendChild(r)),this.hot.runHooks("afterGetColHeader",t,e,o)}updateCellHeader(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;let i=t;var o=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&((0,u.hasClass)(e,"colHeader")?i=o.wtTable.columnFilter.sourceToRendered(t):(0,u.hasClass)(e,"rowHeader")&&(i=o.wtTable.rowFilter.sourceToRendered(t))),-1<i?(0,u.fastInnerHTML)(e,r(t,n)):((0,u.fastInnerText)(e,String.fromCharCode(160)),(0,u.addClass)(e,"cornerHeader"))}maximumVisibleElementWidth(e){e=this._wt.wtViewport.getWorkspaceWidth()-e;return 0<e?e:0}maximumVisibleElementHeight(e){e=this._wt.wtViewport.getWorkspaceHeight()-e;return 0<e?e:0}setLastSize(e,t){g(E,this,e),g(T,this,t)}getLastSize(){return{width:f(E,this),height:f(T,this)}}getFirstRenderedVisibleRow(){return this._wt.wtViewport.rowsRenderCalculator?this.hot.rowIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getFirstRenderedRow(),1):null}getLastRenderedVisibleRow(){return this._wt.wtViewport.rowsRenderCalculator?this.hot.rowIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getLastRenderedRow(),-1):null}getFirstRenderedVisibleColumn(){return this._wt.wtViewport.columnsRenderCalculator?this.hot.columnIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getFirstRenderedColumn(),1):null}getLastRenderedVisibleColumn(){return this._wt.wtViewport.columnsRenderCalculator?this.hot.columnIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getLastRenderedColumn(),-1):null}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return f(y,this)}getRowHeadersCount(){return f(v,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){return(null!=(e=this._wt.wtOverlays.getParentOverlay(e))?e:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}isVisible(){return this._wt.wtTable.isVisible()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(519)),i=(t.ViewportColumnsCalculator=i.ViewportColumnsCalculator,t.ViewportRowsCalculator=i.ViewportRowsCalculator,t.DEFAULT_ROW_HEIGHT=i.DEFAULT_ROW_HEIGHT,t.DEFAULT_COLUMN_WIDTH=i.DEFAULT_COLUMN_WIDTH,n(r(533))),i=(t.CellCoords=i.default,n(r(534))),i=(t.CellRange=i.default,n(r(535))),n=(t.default=i.default,t.Core=i.default,r(576)),i=(t.Selection=n.Selection,t.HIGHLIGHT_ACTIVE_HEADER_TYPE=n.ACTIVE_HEADER_TYPE,t.HIGHLIGHT_AREA_TYPE=n.AREA_TYPE,t.HIGHLIGHT_FOCUS_TYPE=n.FOCUS_TYPE,t.HIGHLIGHT_FILL_TYPE=n.FILL_TYPE,t.HIGHLIGHT_HEADER_TYPE=n.HEADER_TYPE,t.HIGHLIGHT_ROW_TYPE=n.ROW_TYPE,t.HIGHLIGHT_COLUMN_TYPE=n.COLUMN_TYPE,t.HIGHLIGHT_CUSTOM_SELECTION_TYPE=n.CUSTOM_SELECTION_TYPE,function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(545))),n=(t.Renderer=i,r(547)),i=(t.OrderView=n.OrderView,t.SharedOrderView=n.SharedOrderView,r(502));function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}t.getListenersCounter=i.getListenersCounter},(e,t,r)=>{"use strict";t.__esModule=!0;var n=r(520),n=(t.FullyVisibleColumnsCalculationType=n.FullyVisibleColumnsCalculationType,r(523)),n=(t.FullyVisibleRowsCalculationType=n.FullyVisibleRowsCalculationType,r(524)),n=(t.PartiallyVisibleColumnsCalculationType=n.PartiallyVisibleColumnsCalculationType,r(525)),n=(t.PartiallyVisibleRowsCalculationType=n.PartiallyVisibleRowsCalculationType,r(526)),n=(t.RenderedAllColumnsCalculationType=n.RenderedAllColumnsCalculationType,r(527)),n=(t.RenderedAllRowsCalculationType=n.RenderedAllRowsCalculationType,r(528)),n=(t.RenderedColumnsCalculationType=n.RenderedColumnsCalculationType,r(529)),n=(t.RenderedRowsCalculationType=n.RenderedRowsCalculationType,r(530)),n=(t.ViewportColumnsCalculator=n.ViewportColumnsCalculator,t.DEFAULT_COLUMN_WIDTH=n.DEFAULT_WIDTH,r(532));t.ViewportRowsCalculator=n.ViewportRowsCalculator,t.DEFAULT_ROW_HEIGHT=n.DEFAULT_HEIGHT},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(521),r(522),n(r(487)));t.FullyVisibleColumnsCalculationType=class{constructor(){(0,i.default)(this,"count",0),(0,i.default)(this,"startColumn",null),(0,i.default)(this,"endColumn",null),(0,i.default)(this,"startPosition",null),(0,i.default)(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){var{totalCalculatedWidth:t,zeroBasedScrollOffset:r,viewportWidth:n,columnWidth:i}=t;r<=t&&t+i<=r+(0<r?n+1:n)&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=e),this.endColumn=e)}finalize(e){var{scrollOffset:t,viewportWidth:r,inlineStartOffset:n,zeroBasedScrollOffset:i,totalColumns:o,needReverse:s,startPositions:a,columnWidth:l}=e;if(this.endColumn===o-1&&s)for(this.startColumn=this.endColumn;0<this.startColumn;){var c=a[this.endColumn]+l-a[this.startColumn-1];if(c<=r&&--this.startColumn,r<=c)break}this.startPosition=null!=(s=a[this.startColumn])?s:null;s=t+r-(0<i?r+1:r),i=null===this.startColumn?0:e.getColumnWidth(this.startColumn);s<-1*n||t>a.at(-1)||-1*i<-1*t-r?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endColumn&&(this.endColumn=o-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}}},(e,t,r)=>{"use strict";var n=r(205),i=r(241),o=r(265),s=r(263),r=r(496);n({target:"Array",proto:!0},{at:function(e){var t=i(this),r=o(t),e=s(e),e=0<=e?e:r+e;return e<0||r<=e?void 0:t[e]}}),r("at")},(e,t,r)=>{"use strict";var n=r(205),i=r(216),o=r(218),s=r(263),a=r(279),r=r(209),l=i("".charAt);n({target:"String",proto:!0,forced:r(function(){return"\ud842"!=="𠮷".at(-2)})},{at:function(e){var t=a(o(this)),r=t.length,e=s(e),e=0<=e?e:r+e;return e<0||r<=e?void 0:l(t,e)}})},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(521),r(522),n(r(487)));t.FullyVisibleRowsCalculationType=class{constructor(){(0,i.default)(this,"count",0),(0,i.default)(this,"startRow",null),(0,i.default)(this,"endRow",null),(0,i.default)(this,"startPosition",null),(0,i.default)(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){var{totalCalculatedHeight:t,zeroBasedScrollOffset:r,innerViewportHeight:n,rowHeight:i}=t;r<=t&&t+i<=n&&(null===this.startRow&&(this.startRow=e),this.endRow=e)}finalize(e){var{scrollOffset:t,viewportHeight:r,horizontalScrollbarHeight:n,totalRows:i,needReverse:o,startPositions:s,rowHeight:a}=e;if(this.endRow===i-1&&o)for(this.startRow=this.endRow;0<this.startRow;){var l=s[this.endRow]+a-s[this.startRow-1];if(l<=r-n&&--this.startRow,r-n<=l)break}this.startPosition=null!=(o=s[this.startRow])?o:null,t+r-n<(null===this.startRow?0:e.getRowHeight(this.startRow))||t>s.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,i<this.endRow&&(this.endRow=i-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(521),r(522),n(r(487)));t.PartiallyVisibleColumnsCalculationType=class{constructor(){(0,i.default)(this,"count",0),(0,i.default)(this,"startColumn",null),(0,i.default)(this,"endColumn",null),(0,i.default)(this,"startPosition",null),(0,i.default)(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){var{totalCalculatedWidth:t,zeroBasedScrollOffset:r,viewportWidth:n}=t,n=(t<=r&&(this.startColumn=e),0<r?n+1:n);r<=t&&t<=r+n&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=e)),this.endColumn=e}finalize(e){var{scrollOffset:e,viewportWidth:t,inlineStartOffset:r,zeroBasedScrollOffset:n,totalColumns:i,needReverse:o,startPositions:s,columnWidth:a}=e;if(this.endColumn===i-1&&o)for(this.startColumn=this.endColumn;0<this.startColumn;){var l=s[this.endColumn]+a-s[this.startColumn-1];if(--this.startColumn,t<l)break}this.startPosition=null!=(o=s[this.startColumn])?o:null,e+t-(0<n?t+1:t)<-1*r||e>s.at(-1)+a||0<-1*e-t?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,i<this.endColumn&&(this.endColumn=i-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}}},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(521),r(522),n(r(487)));t.PartiallyVisibleRowsCalculationType=class{constructor(){(0,i.default)(this,"count",0),(0,i.default)(this,"startRow",null),(0,i.default)(this,"endRow",null),(0,i.default)(this,"startPosition",null),(0,i.default)(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){var{totalCalculatedHeight:t,zeroBasedScrollOffset:r,innerViewportHeight:n}=t;t<=r&&(this.startRow=e),r<=t&&t<=n&&null===this.startRow&&(this.startRow=e),this.endRow=e}finalize(e){var{scrollOffset:e,viewportHeight:t,horizontalScrollbarHeight:r,totalRows:n,needReverse:i,startPositions:o,rowHeight:s}=e;if(this.endRow===n-1&&i)for(this.startRow=this.endRow;0<this.startRow;){var a=o[this.endRow]+s-o[this.startRow-1];if(--this.startRow,t-r<=a)break}this.startPosition=null!=(i=o[this.startRow])?i:null,e+t-r<0||e>o.at(-1)+s?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,n<this.endRow&&(this.endRow=n-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(487)));t.RenderedAllColumnsCalculationType=class{constructor(){(0,i.default)(this,"count",0),(0,i.default)(this,"startColumn",0),(0,i.default)(this,"endColumn",0),(0,i.default)(this,"startPosition",0),(0,i.default)(this,"isVisibleInTrimmingContainer",!0)}initialize(e){e=e.totalColumns;this.count=e,this.endColumn=this.count-1}process(){}finalize(){}}},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(487)));t.RenderedAllRowsCalculationType=class{constructor(){(0,i.default)(this,"count",0),(0,i.default)(this,"startRow",0),(0,i.default)(this,"endRow",0),(0,i.default)(this,"startPosition",0),(0,i.default)(this,"isVisibleInTrimmingContainer",!0)}initialize(e){e=e.totalRows;this.count=e,this.endRow=this.count-1}process(){}finalize(){}}},(e,t,r)=>{"use strict";t.__esModule=!0;class n extends r(524).PartiallyVisibleColumnsCalculationType{finalize(e){super.finalize(e);var{overrideFn:e,totalColumns:t,startPositions:r}=e;null!==this.startColumn&&"function"==typeof e&&e(this),this.startColumn<0&&(this.startColumn=0),this.startPosition=null!=(e=r[this.startColumn])?e:null,t<this.endColumn&&(this.endColumn=t-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}}t.RenderedColumnsCalculationType=n},(e,t,r)=>{"use strict";t.__esModule=!0;class n extends r(525).PartiallyVisibleRowsCalculationType{finalize(e){super.finalize(e);var{overrideFn:e,totalRows:t,startPositions:r}=e;null!==this.startRow&&"function"==typeof e&&e(this),this.startRow<0&&(this.startRow=0),this.startPosition=null!=(e=r[this.startRow])?e:null,t<this.endRow&&(this.endRow=t-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}t.RenderedRowsCalculationType=n},(e,t,r)=>{"use strict";var n=r(197),a=(t.__esModule=!0,r(286),n(r(487))),n=r(531);t.DEFAULT_WIDTH=50;class i extends n.ViewportBaseCalculator{constructor(e){var{calculationTypes:e,viewportWidth:t,scrollOffset:r,totalColumns:n,columnWidthFn:i,overrideFn:o,inlineStartOffset:s}=e;super(e),(0,a.default)(this,"viewportWidth",0),(0,a.default)(this,"scrollOffset",0),(0,a.default)(this,"zeroBasedScrollOffset",0),(0,a.default)(this,"totalColumns",0),(0,a.default)(this,"columnWidthFn",null),(0,a.default)(this,"columnWidth",0),(0,a.default)(this,"overrideFn",null),(0,a.default)(this,"inlineStartOffset",0),(0,a.default)(this,"totalCalculatedWidth",0),(0,a.default)(this,"startPositions",[]),(0,a.default)(this,"needReverse",!0),this.viewportWidth=t,this.scrollOffset=r,this.zeroBasedScrollOffset=Math.max(r,0),this.totalColumns=n,this.columnWidthFn=i,this.overrideFn=o,this.inlineStartOffset=s,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){e=this.columnWidthFn(e);return isNaN(e)?50:e}}t.ViewportColumnsCalculator=i},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(487)));t.ViewportBaseCalculator=class{constructor(e){(0,i.default)(this,"calculationTypes",[]),(0,i.default)(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(r){this.calculationTypes.forEach(e=>{var[e,t]=e;this.calculationResults.set(e,t),t.initialize(r)})}_process(t,r){this.calculationTypes.forEach(e=>{var[,e]=e;return e.process(t,r)})}_finalize(t){this.calculationTypes.forEach(e=>{var[,e]=e;return e.finalize(t)})}getResultsFor(e){return this.calculationResults.get(e)}}},(e,t,r)=>{"use strict";var n=r(197),a=(t.__esModule=!0,r(286),n(r(487))),n=r(531);t.DEFAULT_HEIGHT=23;class i extends n.ViewportBaseCalculator{constructor(e){var{calculationTypes:e,viewportHeight:t,scrollOffset:r,totalRows:n,rowHeightFn:i,overrideFn:o,horizontalScrollbarHeight:s}=e;super(e),(0,a.default)(this,"viewportHeight",0),(0,a.default)(this,"scrollOffset",0),(0,a.default)(this,"zeroBasedScrollOffset",0),(0,a.default)(this,"totalRows",0),(0,a.default)(this,"rowHeightFn",null),(0,a.default)(this,"rowHeight",0),(0,a.default)(this,"overrideFn",null),(0,a.default)(this,"horizontalScrollbarHeight",0),(0,a.default)(this,"innerViewportHeight",0),(0,a.default)(this,"totalCalculatedHeight",0),(0,a.default)(this,"startPositions",[]),(0,a.default)(this,"needReverse",!0),this.viewportHeight=t,this.scrollOffset=r,this.zeroBasedScrollOffset=Math.max(r,0),this.totalRows=n,this.rowHeightFn=i,this.overrideFn=o,this.horizontalScrollbarHeight=null!=s?s:0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){e=this.rowHeightFn(e);return isNaN(e)?23:e}}t.ViewportRowsCalculator=i},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),n(r(487)));function o(e,t,r){var n=e;if(t.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object");t.set(e,r)}function s(e,t){return e.get(l(e,t))}function a(e,t,r){e.set(l(e,t),r)}function l(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var c=new WeakMap;t.default=class u{constructor(e,t){var r=2<arguments.length&&void 0!==arguments[2]&&arguments[2];(0,i.default)(this,"row",null),(0,i.default)(this,"col",null),o(this,c,!1),a(c,this,r),void 0!==e&&void 0!==t&&(this.row=e,this.col=t)}isValid(e){var{countRows:e,countCols:t,countRowHeaders:r,countColHeaders:n}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-n||this.col<-r||this.row>=e||this.col>=t)}isEqual(e){return e===this||this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return 0<=this.row&&0<=this.col}isRtl(){return s(c,this)}isSouthEastOf(e){return this.row>=e.row&&(s(c,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(s(c,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(s(c,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(s(c,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=null===this.row?this.row:Math.max(this.row,0),this.col=null===this.col?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(null==e?void 0:e.row)&&(this.row=e.row),Number.isInteger(null==e?void 0:e.col)&&(this.col=e.col),e instanceof u&&a(c,this,e.isRtl()),this}clone(){return new u(this.row,this.col,s(c,this))}toObject(){return{row:this.row,col:this.col}}}},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),r(286),n(r(487))),o=n(r(533));function s(e,t,r){var n=e;if(t.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object");t.set(e,r)}function c(e,t){return e.get(a(e,t))}function a(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var u=new WeakMap;t.default=class l{constructor(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:e,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:e,n=3<arguments.length&&void 0!==arguments[3]&&arguments[3];(0,i.default)(this,"highlight",null),(0,i.default)(this,"from",null),(0,i.default)(this,"to",null),s(this,u,!1),this.highlight=e.clone(),this.from=t.clone(),this.to=r.clone(),e=this,t=n,(r=u).set(a(r,e),t)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return 0<=this.from.row&&this.from.row===this.to.row&&0<=this.from.col&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return!(!this.from.isHeader()||!this.to.isHeader())||this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){var e,t;return this.from.row<0&&this.to.row<0?0:(e=Math.max(this.from.row,0),t=Math.max(this.to.row,0),Math.max(e,t)-Math.min(e,t)+1)}getWidth(){var e,t;return this.from.col<0&&this.to.col<0?0:(e=Math.max(this.from.col,0),t=Math.max(this.to.col,0),Math.max(e,t)-Math.min(e,t)+1)}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){var{row:e,col:t}=e,r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return r.row<=e&&n.row>=e&&r.col<=t&&n.col>=t}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){var t=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return(e.row<t.row||e.col<t.col||e.row>r.row||e.col>r.col)&&(this.from=this._createCellCoords(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0)}expandByRange(e){var t,r,n,i,o,s=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];return!(this.includesRange(e)||!this.overlaps(e)||(r=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),t=this.getDirection(),n=e.getOuterTopStartCorner(),e=e.getOuterBottomEndCorner(),o=Math.min(r.row,n.row),r=Math.min(r.col,n.col),n=Math.max(i.row,e.row),i=Math.max(i.col,e.col),e=this._createCellCoords(o,r),o=this._createCellCoords(n,i),this.from=e,this.to=o,this.setDirection(t),s&&(this.highlight.row===this.getOuterBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col)&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally(),0))}getDirection(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()]}}getVerticalDirection(){return-1<["NE-SW","NW-SE"].indexOf(this.getDirection())?"N-S":"S-N"}getHorizontalDirection(){return-1<["NW-SE","SW-NE"].indexOf(this.getDirection())?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE")}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW")}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return c(u,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return c(u,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return c(u,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return c(u,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return c(u,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return c(u,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return c(u,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return c(u,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){return e instanceof o.default&&(e.isEqual(this.getOuterBottomEndCorner())?this.getOuterTopStartCorner():e.isEqual(this.getOuterTopStartCorner())?this.getOuterBottomEndCorner():e.isEqual(this.getOuterTopEndCorner())?this.getOuterBottomStartCorner():e.isEqual(this.getOuterBottomStartCorner())?this.getOuterTopEndCorner():void 0)}getBordersSharedWith(e){if(!this.includesRange(e))return[];const t=Math.min(this.from.row,this.to.row),r=Math.max(this.from.row,this.to.row),n=Math.min(this.from.col,this.to.col),i=Math.max(this.from.col,this.to.col),o=Math.min(e.from.row,e.to.row),s=Math.max(e.from.row,e.to.row),a=Math.min(e.from.col,e.to.col),l=Math.max(e.from.col,e.to.col);return e=[],t===o&&e.push("top"),i===l&&e.push(c(u,this)?"left":"right"),r===s&&e.push("bottom"),n===a&&e.push(c(u,this)?"right":"left"),e}getInner(){var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[];for(let t=r.row;t<=n.row;t++)for(let e=r.col;e<=n.col;e++)this.from.row===t&&this.from.col===e||this.to.row===t&&this.to.col===e||i.push(this._createCellCoords(t,e));return i}getAll(){var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[];for(let t=r.row;t<=n.row;t++)for(let e=r.col;e<=n.col;e++)r.row===t&&r.col===e?i.push(r):n.row===t&&n.col===e?i.push(n):i.push(this._createCellCoords(t,e));return i}forAll(r){var n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();for(let t=n.row;t<=i.row;t++)for(let e=n.col;e<=i.col;e++)if(!1===r(t,e))return}clone(){return new l(this.highlight,this.from,this.to,c(u,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,t){return new o.default(e,t,c(u,this))}}},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(536))),o=n(r(568));t.default=class s{constructor(e){e instanceof o.default?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=e=>{const t=new s(e);return()=>t},this._wot=new i.default(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,t){return this._wot.createCellCoords(e,t)}createCellRange(e,t,r){return this._wot.createCellRange(e,t,r)}draw(){return this._wot.draw(0<arguments.length&&void 0!==arguments[0]&&arguments[0]),this}getCell(e){return this._wot.getCell(e,1<arguments.length&&void 0!==arguments[1]&&arguments[1])}scrollViewport(e,t,r,n,i){return this._wot.scrollViewport(e,t,r,n,i)}scrollViewportHorizontally(e,t,r){return this._wot.scrollViewportHorizontally(e,t,r)}scrollViewportVertically(e,t,r){return this._wot.scrollViewportVertically(e,t,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,t){return this._wot.wtSettings.update(e,t),this}getSetting(e,t,r,n,i){return this._wot.wtSettings.getSetting(e,t,r,n,i)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(286),n(r(537))),o=n(r(538)),s=r(539),a=n(r(590)),l=n(r(591)),c=n(r(592)),n=n(r(568)),u=r(581),d=r(482),h=r(334);class p extends n.default{constructor(e,t){super(e,new a.default(t));e=this.wtSettings.getSetting("facade",this);this.wtTable=new l.default(this.getTableDao(),e,this.domBindings,this.wtSettings),this.wtViewport=new c.default(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new u.SelectionManager(this.wtSettings.getSetting("selections")),this.wtEvent=new i.default(e,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new o.default(this,e,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const r=[],n=[];(0,d.objectEach)({rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},(e,t)=>{this.wtSettings.getSetting(t).length&&n.push(e),r.push(e)}),(0,h.removeClass)(this.wtTable.wtRootElement.parentNode,r),(0,h.addClass)(this.wtTable.wtRootElement.parentNode,n)}getOverlayByName(e){return s.CLONE_TYPES.includes(e)&&(e=e.replace(/_([a-z])/g,e=>e[1].toUpperCase()),null!=(e=this.wtOverlays[e+"Overlay"]))?e:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}t.default=p},(e,t,r)=>{"use strict";t.__esModule=!0,r(204);var o=r(334),i=r(480),n=r(485),s=r(481),a=r(337);function l(e,t,r){var n=e;if(t.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object");t.set(e,r)}function c(e,t){return e.get(d(e,t))}function u(e,t,r){e.set(d(e,t),r)}function d(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var h=new WeakMap,p=new WeakMap,f=new WeakMap,g=new WeakMap,m=new WeakMap,y=new WeakMap,v=new WeakMap,b=new WeakMap,w=new WeakMap,C=new WeakMap;t.default=class{constructor(e,t,r,n,i,o){var s=6<arguments.length&&void 0!==arguments[6]?arguments[6]:null;l(this,h,void 0),l(this,p,void 0),l(this,f,void 0),l(this,g,void 0),l(this,m,void 0),l(this,y,void 0),l(this,v,void 0),l(this,b,void 0),l(this,w,[null,null]),l(this,C,[null,null]),u(h,this,r),u(p,this,t),u(f,this,i),u(g,this,o),u(m,this,s),u(y,this,n),u(v,this,e),this.registerEvents()}registerEvents(){c(y,this).addEventListener(c(f,this).holder,"contextmenu",e=>this.onContextMenu(e)),c(y,this).addEventListener(c(f,this).TABLE,"mouseover",e=>this.onMouseOver(e)),c(y,this).addEventListener(c(f,this).TABLE,"mouseout",e=>this.onMouseOut(e));var e=()=>{c(y,this).addEventListener(c(f,this).holder,"touchstart",e=>this.onTouchStart(e)),c(y,this).addEventListener(c(f,this).holder,"touchend",e=>this.onTouchEnd(e)),this.momentumScrolling||(this.momentumScrolling={}),c(y,this).addEventListener(c(f,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||c(h,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,c(h,this).getSetting("onAfterMomentumScroll"))},200)})},t=()=>{c(y,this).addEventListener(c(f,this).holder,"mouseup",e=>this.onMouseUp(e)),c(y,this).addEventListener(c(f,this).holder,"mousedown",e=>this.onMouseDown(e))};((0,s.isMobileBrowser)()?e:((0,n.isTouchSupported)()&&e(),t))()}selectedCellWasTouched(e){var t,r,n,e=this.parentCell(e).coords;return!(!c(b,this)||!e)&&([t,r]=[e.row,c(b,this).from.row],[e,n]=[e.col,c(b,this).from.col],t===r)&&e===n}parentCell(e){var t={},r=c(f,this).TABLE,r=(0,o.closestDown)(e,["TD","TH"],r);return r?(t.coords=c(f,this).getCoords(r),t.TD=r):(0,o.hasClass)(e,"wtBorder")&&(0,o.hasClass)(e,"current")?(t.coords=c(g,this).getFocusSelection().cellRange.highlight,t.TD=c(f,this).getCell(t.coords)):(0,o.hasClass)(e,"wtBorder")&&(0,o.hasClass)(e,"area")&&c(g,this).getAreaSelection().cellRange&&(t.coords=c(g,this).getAreaSelection().cellRange.to,t.TD=c(f,this).getCell(t.coords)),t}onMouseDown(e){var t=c(p,this).rootDocument.activeElement,r=(0,i.partial)(o.getParent,e.target),n=e.target;(["TD","TH"].includes(t.nodeName)||n!==t&&r(0)!==t&&r(1)!==t)&&(r=this.parentCell(n),(0,o.hasClass)(n,"corner")?c(h,this).getSetting("onCellCornerMouseDown",e,n):r.TD&&c(h,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,r.coords,r.TD),0===e.button||this.touchApplied)&&r.TD&&(c(C,this)[0]=r.TD,clearTimeout(c(w,this)[0]),c(w,this)[0]=setTimeout(()=>{c(C,this)[0]=null},1e3))}onContextMenu(e){var t;c(h,this).has("onCellContextMenu")&&(t=this.parentCell(e.target)).TD&&this.callListener("onCellContextMenu",e,t.coords,t.TD)}onMouseOver(e){var t,r,n;c(h,this).has("onCellMouseOver")&&(t=c(f,this).TABLE,r=(0,o.closestDown)(e.target,["TD","TH"],t),n=c(m,this)||this,r)&&r!==n.lastMouseOver&&(0,o.isChildOf)(r,t)&&(n.lastMouseOver=r,this.callListener("onCellMouseOver",e,c(f,this).getCoords(r),r))}onMouseOut(e){var t,r,n,i;c(h,this).has("onCellMouseOut")&&(t=c(f,this).TABLE,r=(0,o.closestDown)(e.target,["TD","TH"],t),n=(0,o.closestDown)(e.relatedTarget,["TD","TH"],t),i=c(m,this)||this,r)&&r!==n&&(0,o.isChildOf)(r,t)&&(this.callListener("onCellMouseOut",e,c(f,this).getCoords(r),r),null===n)&&(i.lastMouseOver=null)}onMouseUp(e){var t=this.parentCell(e.target);t.TD&&c(h,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,t.coords,t.TD),0!==e.button&&!this.touchApplied||(t.TD===c(C,this)[0]&&t.TD===c(C,this)[1]?((0,o.hasClass)(e.target,"corner")?this.callListener("onCellCornerDblClick",e,t.coords,t.TD):this.callListener("onCellDblClick",e,t.coords,t.TD),c(C,this)[0]=null,c(C,this)[1]=null):t.TD===c(C,this)[0]&&(c(C,this)[1]=t.TD,clearTimeout(c(w,this)[1]),c(w,this)[1]=setTimeout(()=>{c(C,this)[1]=null},500)))}onTouchStart(e){u(b,this,c(g,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var t=e.target,r=null==(r=this.parentCell(t))?void 0:r.coords,r=(0,a.isDefined)(r)&&0<=r.row&&0<=r.col;e.cancelable&&r&&c(h,this).getSetting("isDataViewInstance")&&(r=["A","BUTTON","INPUT"],(0,s.isIOS)()&&((0,s.isChromeWebKit)()||(0,s.isFirefoxWebKit)())&&this.selectedCellWasTouched(t)&&!r.includes(t.tagName)||!this.selectedCellWasTouched(t))&&e.preventDefault(),this.onMouseUp(e),this.touchApplied=!1}callListener(e,t,r,n){e=c(h,this).getSettingPure(e);e&&e(t,r,n,c(v,this).call(this))}destroy(){clearTimeout(c(w,this)[0]),clearTimeout(c(w,this)[1]),c(y,this).destroy()}}},(e,t,r)=>{"use strict";var n=r(197),s=(t.__esModule=!0,r(204),r(286),n(r(487))),a=r(334),l=r(485),i=r(478),o=r(491),c=r(481),u=r(500),d=r(539);function h(e,t,r){var n=e;if(t.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object");t.set(e,r)}function p(e,t,r){e.set(g(e,t),r)}function f(e,t){return e.get(g(e,t))}function g(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var m=new WeakMap,y=new WeakMap,v=new WeakMap,b=new WeakMap;t.default=class{constructor(e,t,r,n,i,o){(0,s.default)(this,"wot",null),h(this,m,[]),(0,s.default)(this,"topOverlay",null),(0,s.default)(this,"bottomOverlay",null),(0,s.default)(this,"inlineStartOverlay",null),(0,s.default)(this,"topInlineStartCornerOverlay",null),(0,s.default)(this,"bottomInlineStartCornerOverlay",null),(0,s.default)(this,"browserLineHeight",void 0),(0,s.default)(this,"wtSettings",null),h(this,y,!1),h(this,v,0),h(this,b,null),(0,s.default)(this,"resizeObserver",new ResizeObserver(e=>{(0,l.requestAnimationFrame)(()=>{Array.isArray(e)&&e.length&&(p(v,this,f(v,this)+1),100===f(v,this)&&((0,u.warn)("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),null!==f(b,this)&&clearTimeout(f(b,this)),p(b,this,setTimeout(()=>{p(v,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=n,this.domBindings=r,this.facadeGetter=t,this.wtTable=o;var{rootDocument:e,rootWindow:n}=this.domBindings,r=(this.instance=this.wot,this.eventManager=i,this.scrollbarSize=(0,a.getScrollbarWidth)(e),"hidden"===n.getComputedStyle(o.wtRootElement.parentNode).getPropertyValue("overflow"));this.scrollableElement=r?o.holder:(0,a.getScrollableElement)(o.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=n.scrollX,this.lastScrollY=n.scrollY}getOverlays(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=[...f(m,this)];return e&&t.push(this.wtTable),t}initBrowserLineHeight(){var{rootWindow:e,rootDocument:t}=this.domBindings,e=e.getComputedStyle(t.body),t=parseInt(e.lineHeight,10),e=1.2*parseInt(e.fontSize,10);this.browserLineHeight=t||e}initOverlays(){var e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new d.TopOverlay(...e),this.bottomOverlay=new d.BottomOverlay(...e),this.inlineStartOverlay=new d.InlineStartOverlay(...e),this.topInlineStartCornerOverlay=new d.TopInlineStartCornerOverlay(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new d.BottomInlineStartCornerOverlay(...e,this.bottomOverlay,this.inlineStartOverlay),p(m,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){p(y,this,f(m,this).reduce((e,t)=>t.hasRenderingStateChanged()||e,!1)),f(m,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),f(m,this).forEach(e=>{var t=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),t&&!e.needFullRender&&e.reset()})}refreshAll(){this.wot.drawn&&(this.wtTable.holder.parentNode?(this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1):this.destroy())}registerListeners(){var{rootDocument:e,rootWindow:t}=this.domBindings,r=this.topOverlay["mainTableScrollableElement"],n=this.inlineStartOverlay["mainTableScrollableElement"],e=(this.eventManager.addEventListener(e.documentElement,"keydown",e=>this.onKeyDown(e)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",e=>this.onTableScroll(e),{passive:!0}),r!==n&&this.eventManager.addEventListener(n,"scroll",e=>this.onTableScroll(e),{passive:!0}),t.devicePixelRatio&&1<t.devicePixelRatio),r=this.scrollableElement===t;const i=this.wtSettings.getSetting("preventWheel"),o={passive:r};!i&&!e&&(0,c.isChrome)()||this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",e=>this.onCloneWheel(e,i),o),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(e=>{e&&e.needFullRender&&(e=e.clone.wtTable["holder"],this.eventManager.addEventListener(e,"wheel",e=>this.onCloneWheel(e,i),o))});let s;this.eventManager.addEventListener(t,"resize",()=>{clearTimeout(s),s=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize"),p(v,this,0)},200)}),r||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){var t=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,n=this.topOverlay.mainTableScrollableElement,i=e.target;this.keyPressed&&(n!==t&&i!==t&&!e.target.contains(n)||r!==t&&i!==t&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,t){var r=this.domBindings["rootWindow"],n=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target,i=i!==r&&o!==r&&!o.contains(i),o=n!==r&&o!==r&&!o.contains(n);this.keyPressed&&(i||o)||this.scrollableElement===r||(n=this.translateMouseWheelToScroll(e),(t||this.scrollableElement!==r&&n)&&e.preventDefault())}onKeyDown(e){this.keyPressed=(0,o.isKey)(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let t=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;1===e.deltaMode&&(r+=r*this.browserLineHeight,t+=t*this.browserLineHeight);var e=this.scrollVertically(t),n=this.scrollHorizontally(r);return e||n}scrollVertically(e){var t=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,t!==this.scrollableElement.scrollTop}scrollHorizontally(e){var t=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,t!==this.scrollableElement.scrollLeft}syncScrollPositions(){var e,t,r,n,i;this.destroyed||(i=this.domBindings["rootWindow"],e=this.topOverlay.clone.wtTable.holder,t=this.inlineStartOverlay.clone.wtTable.holder,[r,n]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],this.horizontalScrolling=e.scrollLeft!==r||this.lastScrollX!==i.scrollX,this.verticalScrolling=t.scrollTop!==n||this.lastScrollY!==i.scrollY,this.lastScrollX=i.scrollX,this.lastScrollY=i.scrollY,this.horizontalScrolling&&(e.scrollLeft=r,i=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null)&&(i.scrollLeft=r),this.verticalScrolling&&(t.scrollTop=n),this.refreshAll())}syncScrollWithMaster(){var e,t;f(y,this)&&({scrollLeft:e,scrollTop:t}=this.topOverlay.mainTableScrollableElement,this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=e),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=e),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=t),p(y,this,!1))}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var e=this["wtTable"],t=this.domBindings["rootWindow"];"hidden"===t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=e.holder:this.scrollableElement=(0,a.getScrollableElement)(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){var e=this.wtTable.spreader,t=e.clientWidth,e=e.clientHeight,r=t!==this.spreaderLastSize.width||e!==this.spreaderLastSize.height;return r&&(this.spreaderLastSize.width=t,this.spreaderLastSize.height=e),r}adjustElementsSize(){var e=this.wot["wtViewport"];const t=this["wtTable"];var r=this.domBindings["rootWindow"];const n=this.scrollableElement===r;var r=this.wtSettings.getSetting("totalColumns"),i=this.wtSettings.getSetting("totalRows"),o=e.getRowHeaderWidth();const s=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,i)+1,a=o+this.inlineStartOverlay.sumCellSizes(0,r);var e=t.hider.style,i=!n&&this.scrollableElement.scrollTop>Math.max(0,s-t.holder.clientHeight)?1:0,o=!n&&this.scrollableElement.scrollLeft>Math.max(0,a-t.holder.clientWidth)?1:0;e.width=a+o+"px",e.height=s+i+"px",0<this.scrollbarSize&&({scrollHeight:r,scrollWidth:o}=t.wtRootElement,{scrollHeight:e,scrollWidth:i}=t.holder,this.hasScrollbarRight=r<e,this.hasScrollbarBottom=o<i,this.hasScrollbarRight&&t.hider.scrollWidth+this.scrollbarSize>o?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&t.hider.scrollHeight+this.scrollbarSize>r&&(this.hasScrollbarRight=!0)),this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){var t=this["wtTable"];t.hider.style.height=parseInt(t.hider.style.height,10)+e+"px"}expandHiderHorizontallyBy(e){var t=this["wtTable"];t.hider.style.width=parseInt(t.hider.style.width,10)+e+"px"}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(t){if(!t)return null;var e=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return(0,i.arrayEach)(e,e=>{e&&e.clone&&e.clone.wtTable.TABLE.contains(t)&&(r=e.clone)}),r}syncOverlayTableClassNames(){const t=this.wtTable.TABLE;var e=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];(0,i.arrayEach)(e,e=>{e&&(e.clone.wtTable.TABLE.className=t.className)})}}},(e,t,r)=>{"use strict";var n={BottomInlineStartCornerOverlay:t.__esModule=!0,BottomOverlay:!0,InlineStartOverlay:!0,Overlay:!0,TopInlineStartCornerOverlay:!0,TopOverlay:!0},i=r(540),i=(t.BottomInlineStartCornerOverlay=i.BottomInlineStartCornerOverlay,r(570)),i=(t.BottomOverlay=i.BottomOverlay,r(573)),i=(t.InlineStartOverlay=i.InlineStartOverlay,r(565)),i=(t.Overlay=i.Overlay,r(585)),i=(t.TopInlineStartCornerOverlay=i.TopInlineStartCornerOverlay,r(588)),o=(t.TopOverlay=i.TopOverlay,r(566));Object.keys(o).forEach(function(e){"default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(n,e)||e in t&&t[e]===o[e]||(t[e]=o[e])})},(e,t,r)=>{"use strict";var n=r(197),o=(t.__esModule=!0,r(334)),i=n(r(541)),n=r(565),s=r(566);class a extends n.Overlay{constructor(e,t,r,n,i,o){super(e,t,s.CLONE_BOTTOM_INLINE_START_CORNER,r,n),this.bottomOverlay=i,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new i.default(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){var t=this["wot"];if(this.updateTrimmingContainer(),t.wtTable.holder.parentNode){var r,t=this.clone.wtTable.holder.parentNode;t.style.top="",this.trimmingContainer===this.domBindings.rootWindow?(n=this.inlineStartOverlay.getOverlayOffset(),r=this.bottomOverlay.getOverlayOffset(),t.style[this.isRtl()?"right":"left"]=n+"px",t.style.bottom=r+"px"):((0,o.resetCssTransform)(t),this.repositionOverlay());let e=(0,o.outerHeight)(this.clone.wtTable.TABLE);var n=(0,o.outerWidth)(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(e=0),t.style.height=e+"px",t.style.width=n+"px"}return!1}repositionOverlay(){var{wtTable:e,wtViewport:t}=this.wot,r=this.domBindings["rootDocument"],n=this.clone.wtTable.holder.parentNode;let i=0;t.hasVerticalScroll()||(i+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(i+=(0,o.getScrollbarWidth)(r)),n.style.bottom=i+"px"}}t.BottomInlineStartCornerOverlay=a},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(542))),o=n(r(563)),n=n(r(564)),s=r(482),a=r(539);class l extends i.default{constructor(e,t,r,n){super(e,t,r,n,a.CLONE_BOTTOM_INLINE_START_CORNER)}}(0,s.mixin)(l,o.default),(0,s.mixin)(l,n.default);t.default=l},(e,t,r)=>{"use strict";var n=r(197),s=(t.__esModule=!0,r(204),r(286),n(r(487))),h=r(334),i=r(480),p=n(r(543)),f=n(r(544)),a=r(545),l=n(r(560)),c=n(r(562)),g=r(539),o=r(479);t.default=class{constructor(e,t,r,n,i){(0,s.default)(this,"wtSettings",null),(0,s.default)(this,"domBindings",void 0),(0,s.default)(this,"TBODY",null),(0,s.default)(this,"THEAD",null),(0,s.default)(this,"COLGROUP",null),(0,s.default)(this,"hasTableHeight",!0),(0,s.default)(this,"hasTableWidth",!0),(0,s.default)(this,"isTableVisible",!1),(0,s.default)(this,"tableOffset",0),(0,s.default)(this,"holderOffset",0),this.domBindings=r,this.isMaster="master"===i,this.name=i,this.dataAccessObject=e,this.facadeGetter=t,this.wtSettings=n,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,(0,h.removeTextNodes)(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const o=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(o)),this.rowUtils=new c.default(this.dataAccessObject,this.wtSettings),this.columnUtils=new l.default(this.dataAccessObject,this.wtSettings),this.tableRenderer=new a.Renderer({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){var e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){var t=e.parentNode;let r;return t&&t.nodeType===Node.ELEMENT_NODE&&(0,h.hasClass)(t,"wtHolder")||((r=this.domBindings.rootDocument.createElement("div")).className="wtSpreader",t&&t.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&(0,h.setAttribute)(r,[(0,o.A11Y_PRESENTATION)()]),r}createHider(e){var t=e.parentNode;let r;return t&&t.nodeType===Node.ELEMENT_NODE&&(0,h.hasClass)(t,"wtHolder")||((r=this.domBindings.rootDocument.createElement("div")).className="wtHider",t&&t.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&(0,h.setAttribute)(r,[(0,o.A11Y_PRESENTATION)()]),r}createHolder(e){var t=e.parentNode;let r;return t&&t.nodeType===Node.ELEMENT_NODE&&(0,h.hasClass)(t,"wtHolder")||((r=this.domBindings.rootDocument.createElement("div")).style.position="relative",r.className="wtHolder",t&&t.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags"))&&(0,h.setAttribute)(r.parentNode,[(0,o.A11Y_PRESENTATION)()]),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&(0,h.setAttribute)(r,[(0,o.A11Y_PRESENTATION)()]),r}draw(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],r=this["wtSettings"],{wtOverlays:n,wtViewport:i}=this.dataAccessObject,o=r.getSetting("totalRows"),s=r.getSetting("totalColumns"),a=r.getSetting("rowHeaders"),l=a.length,c=r.getSetting("columnHeaders"),u=c.length;let e=t;if(e=this.isMaster&&(n.beforeDraw(),this.holderOffset=(0,h.offset)(this.holder),e=i.createCalculators(e),l)&&!r.getSetting("fixedColumnsStart")&&(t=n.inlineStartOverlay.getScrollPosition(),r=this.correctHeaderWidth,this.correctHeaderWidth=0!==t,r!==this.correctHeaderWidth)?!1:e)this.isMaster&&n.refresh(!0);else{this.isMaster?this.tableOffset=(0,h.offset)(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;var t=0<o?this.getFirstRenderedRow():0,r=0<s?this.getFirstRenderedColumn():0;this.rowFilter=new f.default(t,o,u),this.columnFilter=new p.default(r,s,l);let e=!0;if(this.isMaster&&(this.alignOverlaysWithTrimmingContainer(),this.wtSettings.getSetting("beforeDraw",!0,t={}),e=!0!==t.skipRender),e){this.tableRenderer.setHeaderContentRenderers(a,c),(this.is(g.CLONE_BOTTOM)||this.is(g.CLONE_BOTTOM_INLINE_START_CORNER))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();let e;this.isMaster&&(e=this.dataAccessObject.workspaceWidth,i.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(g.CLONE_BOTTOM))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),n.refresh(!1),n.applyToDOM(),o=(0,h.outerWidth)(this.hider),u=(0,h.outerWidth)(this.TABLE),0!==o&&u!==o&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),e!==i.getWorkspaceWidth()&&(i.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)):this.is(g.CLONE_BOTTOM)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let d=!1;return this.isMaster&&(d=n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&(d=n.bottomOverlay.resetFixedPosition()||d),d=n.inlineStartOverlay.resetFixedPosition()||d,n.topInlineStartCornerOverlay&&n.topInlineStartCornerOverlay.resetFixedPosition(),n.bottomInlineStartCornerOverlay)&&n.bottomInlineStartCornerOverlay.clone&&n.bottomInlineStartCornerOverlay.resetFixedPosition(),d?(n.refreshAll(),n.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(e),this.isMaster&&n.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){var t=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;for(var n,i,o=this.wtSettings.getSetting("defaultRowHeight"),s=this.wtSettings.getSetting("columnHeaderHeight")||[];r;)--r,n=this.getColumnHeaderHeight(r),(i=this.getColumnHeader(t,r))&&(i=(0,h.innerHeight)(i),(!n&&o<i||n<i)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=i),Array.isArray(s)?null!==s[r]&&void 0!==s[r]&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=s[r]):isNaN(s)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=s),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(s[r]||s))&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=s[r]||s)}adjustColumnHeaderHeights(){var r=this["wtSettings"],n=this.THEAD.childNodes,i=this.dataAccessObject.wtViewport.oversizedColumnHeaders;for(let e=0,t=r.getSetting("columnHeaders").length;e<t;e++)if(i[e]){if(!n[e]||0===n[e].childNodes.length)return;n[e].childNodes[0].style.height=i[e]+"px"}}resetOversizedRows(){var e=this["wtSettings"],t=this.dataAccessObject["wtViewport"];if((this.isMaster||this.is(g.CLONE_BOTTOM))&&!e.getSetting("externalRowCalculator")){var r=this.getRenderedRowsCount();for(let e=0;e<r;e++){var n=this.rowFilter.renderedToSource(e);t.oversizedRows&&t.oversizedRows[n]&&(t.oversizedRows[n]=void 0)}}}getCell(e){let t=e.row,r=e.col;e=this.wtSettings.getSetting("onModifyGetCellCoords",t,r);if(e&&Array.isArray(e)&&([t,r]=e),this.isRowBeforeRenderedRows(t))return-1;if(this.isRowAfterRenderedRows(t))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;e=this.getRow(t);if(!e&&0<=t)throw new Error("TR was expected to be rendered but is not");e=e.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!e&&0<=r)throw new Error("TD or TH was expected to be rendered but is not");return e}getRow(e){let t=null,r=null;var n;return r=e<0?(t=null==(n=this.rowFilter)?void 0:n.sourceRowToVisibleColHeadedRow(e),this.THEAD):(t=null==(n=this.rowFilter)?void 0:n.sourceToRendered(e),this.TBODY),void 0!==t&&void 0!==r&&!(r.childNodes.length<t+1)&&r.childNodes[t]}getColumnHeader(e){var t=this.THEAD.childNodes[1<arguments.length&&void 0!==arguments[1]?arguments[1]:0];return null==t?void 0:t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const t=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(e=>{e=e.childNodes[r];e&&t.push(e)}),t}getRowHeader(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=this.wtSettings.getSetting("rowHeaders").length;if(!(r<=t))return e=(r=this.rowFilter.sourceToRendered(e))<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):r,null==(r=(r<0?this.THEAD:this.TBODY).childNodes[e])?void 0:r.childNodes[t]}getRowHeaders(t){var r=[],n=this.wtSettings.getSetting("rowHeaders").length;for(let e=0;e<n;e++){var i=this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)],i=null==i?void 0:i.childNodes[e];i&&r.push(i)}return r}getCoords(e){let t=e;if(null===(t="TD"!==t.nodeName&&"TH"!==t.nodeName?(0,h.closest)(t,["TD","TH"]):t))return null;var e=t.parentNode,r=e.parentNode;let n=(0,h.index)(e),i=t.cellIndex;return(0,h.overlayContainsElement)(g.CLONE_TOP_INLINE_START_CORNER,t,this.wtRootElement)||(0,h.overlayContainsElement)(g.CLONE_TOP,t,this.wtRootElement)?"THEAD"===r.nodeName&&(n-=r.childNodes.length):n=(0,h.overlayContainsElement)(g.CLONE_BOTTOM_INLINE_START_CORNER,t,this.wtRootElement)||(0,h.overlayContainsElement)(g.CLONE_BOTTOM,t,this.wtRootElement)?this.wtSettings.getSetting("totalRows")-r.childNodes.length+n:r===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(n):this.rowFilter.renderedToSource(n),i=(0,h.overlayContainsElement)(g.CLONE_TOP_INLINE_START_CORNER,t,this.wtRootElement)||(0,h.overlayContainsElement)(g.CLONE_INLINE_START,t,this.wtRootElement)||(0,h.overlayContainsElement)(g.CLONE_BOTTOM_INLINE_START_CORNER,t,this.wtRootElement)?this.columnFilter.offsettedTH(i):this.columnFilter.visibleRowHeadedColumnToSourceColumn(i),this.wot.createCellCoords(n,i)}markOversizedRows(){if(!this.wtSettings.getSetting("externalRowCalculator")){let e=this.TBODY.childNodes.length;var r,n,i,o;let t;if(e*this.wtSettings.getSetting("defaultRowHeight")!=(0,h.innerHeight)(this.TBODY)-1||this.wtSettings.getSetting("fixedRowsBottom"))for(;e;)--e,n=this.rowFilter.renderedToSource(e),r=this.getRowHeight(n),o=(i=this.getTrForRow(n)).querySelector("th"),t=o?(0,h.innerHeight)(o):(0,h.innerHeight)(i)-1,(!r&&this.wtSettings.getSetting("defaultRowHeight")<t||r<t)&&(t+=1,this.dataAccessObject.wtViewport.oversizedRows[n]=t)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){var t;return!(0<=e)&&(t=this.wtSettings.getSetting("rowHeaders").length,Math.abs(e)<=t)}isRowHeaderRendered(e){var t;return!(0<=e)&&(t=this.wtSettings.getSetting("columnHeaders").length,Math.abs(e)<=t)}isRowBeforeRenderedRows(e){var t=this.getFirstRenderedRow();return e<0&&t<=0?!this.isRowHeaderRendered(e):e<t}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){var t=this.getFirstRenderedColumn();return e<0&&t<=0?!this.isColumnHeaderRendered(e):e<t}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&0<=e}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return(0,h.outerWidth)(this.TABLE)}getHeight(){return(0,h.outerHeight)(this.TABLE)}getTotalWidth(){var e=(0,h.outerWidth)(this.hider);return 0!==e?e:this.getWidth()}getTotalHeight(){var e=(0,h.outerHeight)(this.hider);return 0!==e?e:this.getHeight()}isVisible(){return(0,h.isVisible)(this.TABLE)}_modifyRowHeaderWidth(e){let t=(0,i.isFunction)(e)?e():null;return Array.isArray(t)?(t=[...t])[t.length-1]=this._correctRowHeaderWidth(t[t.length-1]):t=this._correctRowHeaderWidth(t),t}_correctRowHeaderWidth(e){let t=e;return"number"!=typeof e&&(t=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(t+=1),t}}},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(487)));t.default=class{constructor(e,t,r){(0,i.default)(this,"offset",void 0),(0,i.default)(this,"total",void 0),(0,i.default)(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(487)));t.default=class{constructor(e,t,r){(0,i.default)(this,"offset",void 0),(0,i.default)(this,"total",void 0),(0,i.default)(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}},(e,t,r)=>{"use strict";var n=r(197),a=(t.__esModule=!0,n(r(546))),l=(t.RowHeadersRenderer=a.default,n(r(555))),c=(t.ColumnHeadersRenderer=l.default,n(r(556))),u=(t.ColGroupRenderer=c.default,n(r(557))),d=(t.RowsRenderer=u.default,n(r(558))),h=(t.CellsRenderer=d.default,n(r(559)));t.TableRenderer=h.default;t.Renderer=class{constructor(){var{TABLE:e,THEAD:t,COLGROUP:r,TBODY:n,rowUtils:i,columnUtils:o,cellRenderer:s}=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.renderer=new h.default(e,{cellRenderer:s}),this.renderer.setRenderers({rowHeaders:new a.default,columnHeaders:new l.default(t),colGroup:new c.default(r),rows:new u.default(n),cells:new d.default}),this.renderer.setAxisUtils(i,o)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,t){return this.renderer.setFilters(e,t),this}setViewportSize(e,t){return this.renderer.setViewportSize(e,t),this}setHeaderContentRenderers(e,t){return this.renderer.setHeaderContentRenderers(e,t),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(487))),o=r(547),n=n(r(553)),u=r(334),d=r(479);class s extends n.default{constructor(){super("TH"),(0,i.default)(this,"orderViews",new WeakMap),(0,i.default)(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new o.SharedOrderView(e,e=>this.nodesPool.obtain(this.sourceRowIndex,e),this.nodeType),this.orderViews.set(e,t)),t}render(){var{rowsToRender:t,rowHeaderFunctions:r,rowHeadersCount:n,rows:i,cells:o}=this.table;for(let e=0;e<t;e++){var s=this.table.renderedRowToSource(e),a=i.getRenderedNode(e),l=(this.sourceRowIndex=s,this.obtainOrderView(a)),a=o.obtainOrderView(a);l.appendView(a).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(let e=0;e<n;e++){l.render();var c=l.getCurrentNode();c.className="",c.removeAttribute("style"),(0,u.removeAttribute)(c,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&(0,u.setAttribute)(c,[(0,d.A11Y_ROWHEADER)(),(0,d.A11Y_SCOPE_ROW)(),(0,d.A11Y_COLINDEX)(e+1),(0,d.A11Y_TABINDEX)(-1)]),r[e](s,c,e)}l.end()}}}t.default=s},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(548))),i=(t.OrderView=i.default,n(r(552)));t.SharedOrderView=i.default},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(286),n(r(487))),a=r(549),o=n(r(550));t.default=class{constructor(e,t,r){(0,i.default)(this,"rootNode",void 0),(0,i.default)(this,"nodesPool",void 0),(0,i.default)(this,"sizeSet",new o.default),(0,i.default)(this,"childNodeType",void 0),(0,i.default)(this,"visualIndex",0),(0,i.default)(this,"collectedNodes",[]),this.rootNode=e,this.nodesPool=t,this.childNodeType=r.toUpperCase()}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){var e=this.collectedNodes.length;return 0<e?this.collectedNodes[e-1]:null}getRenderedChildCount(){var{rootNode:t,sizeSet:r}=this;let n=0;if(this.isSharedViewSet()){let e=t.firstElementChild;for(;e;){if(e.tagName===this.childNodeType)n+=1;else if(r.isPlaceOn(a.WORKING_SPACE_TOP))break;e=e.nextElementSibling}}else n=t.childElementCount;return n}start(){this.collectedNodes.length=0,this.visualIndex=0;var{rootNode:e,sizeSet:t}=this,r=this.isSharedViewSet(),n=t.getViewSize()["nextSize"];let i=this.getRenderedChildCount();for(;i<n;){var o=this.nodesPool();!r||t.isPlaceOn(a.WORKING_SPACE_BOTTOM)?e.appendChild(o):e.insertBefore(o,e.firstChild),i+=1}for(var s=r&&t.isPlaceOn(a.WORKING_SPACE_TOP);i>n;)e.removeChild(s?e.firstChild:e.lastChild),--i}render(){var{rootNode:e,sizeSet:t}=this;let r=this.visualIndex,n=(this.isSharedViewSet()&&t.isPlaceOn(a.WORKING_SPACE_BOTTOM)&&(r+=t.sharedSize.nextSize),e.childNodes[r]);n.tagName!==this.childNodeType&&(t=this.nodesPool(),e.replaceChild(t,n),n=t),this.collectedNodes.push(n),this.visualIndex+=1}end(){}}},(e,t)=>{"use strict";t.__esModule=!0;t.WORKING_SPACE_ALL=0,t.WORKING_SPACE_TOP=1,t.WORKING_SPACE_BOTTOM=2},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(487))),o=n(r(551)),s=r(549);t.default=class{constructor(){(0,i.default)(this,"size",new o.default),(0,i.default)(this,"workingSpace",s.WORKING_SPACE_ALL),(0,i.default)(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof o.default}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=s.WORKING_SPACE_TOP,e.workingSpace=s.WORKING_SPACE_BOTTOM,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=s.WORKING_SPACE_BOTTOM,e.workingSpace=s.WORKING_SPACE_TOP,this.sharedSize=e.getViewSize()}}},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(487)));t.default=class{constructor(){(0,i.default)(this,"currentSize",0),(0,i.default)(this,"nextSize",0),(0,i.default)(this,"currentOffset",0),(0,i.default)(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}},(e,t,r)=>{"use strict";var n=r(197);t.__esModule=!0;class i extends n(r(548)).default{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}t.default=i},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(487))),o=n(r(554));t.default=class{constructor(e,t){(0,i.default)(this,"nodesPool",null),(0,i.default)(this,"nodeType",void 0),(0,i.default)(this,"rootNode",void 0),(0,i.default)(this,"table",null),(0,i.default)(this,"renderedNodes",0),this.nodesPool="string"==typeof e?new o.default(e):null,this.nodeType=e,this.rootNode=t}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(487)));t.default=class{constructor(e){(0,i.default)(this,"nodeType",void 0),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}},(e,t,r)=>{"use strict";var n=r(197),l=(t.__esModule=!0,r(334)),n=n(r(553)),c=r(479);class i extends n.default{constructor(e){super(null,e)}adjust(){var{columnHeadersCount:r,rowHeadersCount:e}=this.table;let n=this.rootNode.firstChild;if(r){var t=this.table["columnsToRender"],i=t+e;for(let e=0,t=r;e<t;e++){for((n=this.rootNode.childNodes[e])||(n=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(n)),this.renderedNodes=n.childNodes.length;this.renderedNodes<i;)n.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>i;)n.removeChild(n.lastChild),--this.renderedNodes}var o=this.rootNode.childNodes.length;if(r<o)for(let e=r;e<o;e++)this.rootNode.removeChild(this.rootNode.lastChild)}else n&&(0,l.empty)(n)}render(){var e=this.table["columnHeadersCount"];this.table.isAriaEnabled()&&(0,l.setAttribute)(this.rootNode,[(0,c.A11Y_ROWGROUP)()]);for(let t=0;t<e;t+=1){var{columnHeaderFunctions:r,columnsToRender:n,rowHeadersCount:i}=this.table,o=this.rootNode.childNodes[t];this.table.isAriaEnabled()&&(0,l.setAttribute)(o,[(0,c.A11Y_ROW)(),(0,c.A11Y_ROWINDEX)(t+1)]);for(let e=-1*i;e<n;e+=1){var s=this.table.renderedColumnToSource(e),a=o.childNodes[e+i];a.className="",a.removeAttribute("style"),(0,l.removeAttribute)(a,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&(0,l.setAttribute)(a,[(0,c.A11Y_COLINDEX)(e+1+this.table.rowHeadersCount),(0,c.A11Y_TABINDEX)(-1),(0,c.A11Y_COLUMNHEADER)(),...0<=e?[(0,c.A11Y_SCOPE_COL)()]:[(0,c.A11Y_ROW)()]]),r[t](s,a,t)}}}}t.default=i},(e,t,r)=>{"use strict";var n=r(197),n=(t.__esModule=!0,n(r(553))),o=r(500),s=r(477),a=r(334);let l=!1;class i extends n.default{constructor(e){super(null,e)}adjust(){for(var{columnsToRender:e,rowHeadersCount:t}=this.table,r=e+t;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),--this.renderedNodes}render(){this.adjust();var{columnsToRender:t,rowHeadersCount:r}=this.table;!l&&1e3<t&&(l=!0,(0,o.warn)((0,s.toSingleLine)`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let e=0;e<r;e++){var n=this.table.renderedColumnToSource(e),n=this.table.columnUtils.getHeaderWidth(n);this.rootNode.childNodes[e].style.width=n+"px"}for(let e=0;e<t;e++){var i=this.table.renderedColumnToSource(e),i=this.table.columnUtils.getStretchedColumnWidth(i);this.rootNode.childNodes[e+r].style.width=i+"px"}var e=this.rootNode.firstChild;e&&(0,a.addClass)(e,"rowHeader")}}t.default=i},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(487))),n=n(r(553)),o=r(500),s=r(477),a=r(547),l=r(334),c=r(479);let u=!1;class d extends n.default{constructor(e){super("TR",e),(0,i.default)(this,"orderView",void 0),this.orderView=new a.OrderView(e,e=>this.nodesPool.obtain(e),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){var t=this.table["rowsToRender"];!u&&1e3<t&&(u=!0,(0,o.warn)((0,s.toSingleLine)`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&(0,l.setAttribute)(this.rootNode,[(0,c.A11Y_ROWGROUP)()]),this.orderView.setSize(t).setOffset(this.table.renderedRowToSource(0)).start();for(let e=0;e<t;e++){this.orderView.render();var r=this.orderView.getCurrentNode(),n=this.table.renderedRowToSource(e);this.table.isAriaEnabled()&&(0,l.setAttribute)(r,[(0,c.A11Y_ROW)(),(0,c.A11Y_ROWINDEX)(n+(null!=(n=null==(r=this.table.rowUtils)||null==(r=r.dataAccessObject)?void 0:r.columnHeaders.length)?n:0)+1)])}this.orderView.end()}}t.default=d},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(487))),u=r(334),o=r(547),n=n(r(553)),d=r(479);class s extends n.default{constructor(){super("TD"),(0,i.default)(this,"orderViews",new WeakMap),(0,i.default)(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new o.SharedOrderView(e,e=>this.nodesPool.obtain(this.sourceRowIndex,e),this.nodeType),this.orderViews.set(e,t)),t}render(){var{rowsToRender:t,columnsToRender:r,rows:n,rowHeaders:i}=this.table;for(let e=0;e<t;e++){var o=this.table.renderedRowToSource(e),s=n.getRenderedNode(e),a=(this.sourceRowIndex=o,this.obtainOrderView(s)),s=i.obtainOrderView(s);a.prependView(s).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(let e=0;e<r;e++){a.render();var l=a.getCurrentNode(),c=this.table.renderedColumnToSource(e);(0,u.hasClass)(l,"hide")||(l.className=""),l.removeAttribute("style"),l.removeAttribute("dir"),(0,u.removeAttribute)(l,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(o,c,l),this.table.isAriaEnabled()&&(0,u.setAttribute)(l,[...l.hasAttribute("role")?[]:[(0,d.A11Y_GRIDCELL)()],(0,d.A11Y_TABINDEX)(-1),(0,d.A11Y_COLINDEX)(c+(null!=(c=null==(l=this.table.rowUtils)||null==(l=l.dataAccessObject)?void 0:l.rowHeaders.length)?c:0)+1)])}a.end()}}}t.default=s},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(487)));t.default=class{constructor(e){var t=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{})["cellRenderer"];(0,i.default)(this,"rootNode",void 0),(0,i.default)(this,"rootDocument",void 0),(0,i.default)(this,"rowHeaders",null),(0,i.default)(this,"columnHeaders",null),(0,i.default)(this,"colGroup",null),(0,i.default)(this,"rows",null),(0,i.default)(this,"cells",null),(0,i.default)(this,"rowFilter",null),(0,i.default)(this,"columnFilter",null),(0,i.default)(this,"rowUtils",null),(0,i.default)(this,"columnUtils",null),(0,i.default)(this,"rowsToRender",0),(0,i.default)(this,"columnsToRender",0),(0,i.default)(this,"rowHeaderFunctions",[]),(0,i.default)(this,"rowHeadersCount",0),(0,i.default)(this,"columnHeaderFunctions",[]),(0,i.default)(this,"columnHeadersCount",0),(0,i.default)(this,"cellRenderer",void 0),(0,i.default)(this,"activeOverlayName",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=t}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,t){this.rowUtils=e,this.columnUtils=t}setViewportSize(e,t){this.rowsToRender=e,this.columnsToRender=t}setFilters(e,t){this.rowFilter=e,this.columnFilter=t}setHeaderContentRenderers(e,t){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=t,this.columnHeadersCount=t.length}setRenderers(){var{rowHeaders:e,columnHeaders:t,colGroup:r,rows:n,cells:i}=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};e.setTable(this),t.setTable(this),r.setTable(this),n.setTable(this),i.setTable(this),this.rowHeaders=e,this.columnHeaders=t,this.colGroup=r,this.rows=n,this.cells=i}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();var{rowsToRender:t,rows:r}=this;for(let e=0;e<t;e++){var n,i=r.getRenderedNode(e);i.firstChild&&(n=this.renderedRowToSource(e),n=this.rowUtils.getHeightByOverlayName(n,this.activeOverlayName),i.firstChild.style.height=n?n-1+"px":"")}}}},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(487))),o=r(334),s=r(561);t.default=class{constructor(e,t){(0,i.default)(this,"dataAccessObject",void 0),(0,i.default)(this,"wtSettings",void 0),(0,i.default)(this,"headerWidths",new Map),(0,i.default)(this,"stretching",void 0),this.dataAccessObject=e,this.wtSettings=t,this.stretching=new s.ColumnStretching({totalColumns:()=>this.wtSettings.getSetting("totalColumns"),stretchMode:()=>this.wtSettings.getSetting("stretchH"),stretchingColumnWidthFn:(e,t)=>this.wtSettings.getSetting("onBeforeStretchingColumnWidth",e,t),columnWidthFn:e=>this.dataAccessObject.wtTable.getColumnWidth(e)})}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){let t=this.getWidth(e);e=this.stretching.getStretchedColumnWidth(e,t);return t=e?e:t}getHeaderHeight(e){let t=this.wtSettings.getSetting("defaultRowHeight");e=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return t=void 0!==e?t?Math.max(t,e):e:t}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}refreshStretching(){var{wtTable:e,wtViewport:t,cloneSource:r}=this.dataAccessObject,r=(r?r.wtTable:e).holder,e=r.offsetHeight<r.scrollHeight?(0,o.getScrollbarWidth)():0;this.stretching.refreshStretching(t.getViewportWidth()-e)}calculateWidths(){var e=this["wtSettings"],t=e.getSetting("rowHeaderWidth");if(this.refreshStretching(),null!=(t=e.getSetting("onModifyRowHeaderWidth",t))){var r=e.getSetting("rowHeaders").length,n=e.getSetting("defaultColumnWidth");for(let e=0;e<r;e++){var i=null==(i=Array.isArray(t)?t[e]:t)?n:i;this.headerWidths.set(e,i)}}}}},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),n(r(487))),o=r(519);function s(e,t,r){var n=e;if(t.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object");t.set(e,r)}function a(e,t){return e.get(c(e,t))}function l(e,t,r){e.set(c(e,t),r)}function c(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var u=new WeakMap,d=new WeakMap,h=new WeakMap,p=new WeakMap,f=new WeakMap;t.ColumnStretching=class{constructor(e){var{totalColumns:e,stretchMode:t,stretchingColumnWidthFn:r,columnWidthFn:n}=e;(0,i.default)(this,"stretchAllRatio",0),(0,i.default)(this,"stretchLastWidth",0),(0,i.default)(this,"stretchAllColumnsWidth",[]),s(this,u,0),(0,i.default)(this,"needVerifyLastColumnWidth",!0),s(this,d,()=>0),s(this,h,e=>e),s(this,p,e=>e),s(this,f,()=>"none"),l(d,this,e),l(f,this,t),l(h,this,null!=r?r:a(h,this)),l(p,this,null!=n?n:a(p,this))}refreshStretching(r){if("none"!==a(f,this).call(this)){this.stretchAllRatio=0,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0,this.stretchLastWidth=0,l(u,this,r);let t=0;for(let e=0;e<a(d,this).call(this);e++){var n=this._getColumnWidth(e),i=a(h,this).call(this,void 0,e);"number"==typeof i?r-=i:t+=n}var e,o=r-t;"all"===a(f,this).call(this)&&0<o?(this.stretchAllRatio=r/t,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0):"last"===a(f,this).call(this)&&r!==1/0&&(e=this._getColumnWidth(a(d,this).call(this)-1),this.stretchLastWidth=0<=(o=o+e)?o:e)}}getStretchedColumnWidth(e,t){let r=null;return"all"===a(f,this).call(this)&&0!==this.stretchAllRatio?r=this._getStretchedAllColumnWidth(e,t):"last"===a(f,this).call(this)&&0!==this.stretchLastWidth&&(r=this._getStretchedLastColumnWidth(e)),r}_getStretchedAllColumnWidth(e,t){let r=0;var n;if(this.stretchAllColumnsWidth[e]||(t=Math.round(t*this.stretchAllRatio),n=a(h,this).call(this,t,e),this.stretchAllColumnsWidth[e]=void 0===n?t:isNaN(n)?this._getColumnWidth(e):n),this.stretchAllColumnsWidth.length===a(d,this).call(this)&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let e=0;e<this.stretchAllColumnsWidth.length;e++)r+=this.stretchAllColumnsWidth[e];r!==a(u,this)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=a(u,this)-r)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){return e===a(d,this).call(this)-1?this.stretchLastWidth:null}_getColumnWidth(e){let t=a(p,this).call(this,e);return t=isNaN(t)?o.DEFAULT_COLUMN_WIDTH:t}}},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(487)));t.default=class{constructor(e,t){(0,i.default)(this,"dataAccessObject",void 0),(0,i.default)(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=t}getHeight(e){let t=this.wtSettings.getSetting("rowHeight",e);e=this.dataAccessObject.wtViewport.oversizedRows[e];return t=void 0!==e?void 0===t?e:Math.max(t,e):t}getHeightByOverlayName(e,t){let r=this.wtSettings.getSetting("rowHeightByOverlayName",e,t);t=this.dataAccessObject.wtViewport.oversizedRows[e];return r=void 0!==t?void 0===r?t:Math.max(r,t):r}}},(e,t,r)=>{"use strict";t.__esModule=!0;var n={getFirstRenderedRow(){var e=this.wtSettings.getSetting("totalRows"),t=this.wtSettings.getSetting("fixedRowsBottom"),r=e-t;return 0===e||0===t?-1:r<0?0:r},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){var e=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),e)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};(0,r(482).defineGetter)(n,"MIXIN_NAME","stickyRowsBottom",{writable:!1,enumerable:!1}),t.default=n},(e,t,r)=>{"use strict";t.__esModule=!0;var n={getFirstRenderedColumn(){return 0===this.wtSettings.getSetting("totalColumns")?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){var e=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),e)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};(0,r(482).defineGetter)(n,"MIXIN_NAME","stickyColumnsStart",{writable:!1,enumerable:!1}),t.default=n},(e,t,r)=>{"use strict";var n=r(197),s=(t.__esModule=!0,r(204),n(r(487))),a=r(334),l=r(482),c=r(500),u=r(566),d=n(r(567)),h=r(479);t.Overlay=class{constructor(e,t,r,n,i){(0,s.default)(this,"wtSettings",null),(0,l.defineGetter)(this,"wot",e,{writable:!1}),this.domBindings=i,this.facadeGetter=t,this.wtSettings=n;var{TABLE:e,hider:i,spreader:t,holder:n,wtRootElement:o}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=e,this.hider=i,this.spreader=t,this.holder=n,this.wtRootElement=o,this.trimmingContainer=(0,a.getTrimmingContainer)(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){"before"===e&&this.shouldBeRendered()?this.needFullRender=!0:"after"!==e||this.shouldBeRendered()||(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=(0,a.getTrimmingContainer)(this.hider.parentNode.parentNode)}updateMainScrollableElement(){var e=this.wot["wtTable"],t=this.domBindings["rootWindow"];"hidden"===t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=(0,a.getScrollableElement)(e.TABLE)}getRelativeCellPosition(t,r,n){if(!1!==this.clone.wtTable.holder.contains(t)){var i=this.mainTableScrollableElement===this.domBindings.rootWindow,n=n<this.wtSettings.getSetting("fixedColumnsStart"),o=r<this.wtSettings.getSetting("fixedRowsTop"),r=r>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),s=this.clone.wtTable.spreader,s={start:this.getRelativeStartPosition(s),top:s.offsetTop},t={start:this.getRelativeStartPosition(t),top:t.offsetTop};let e=null;return e=i?this.getRelativeCellPositionWithinWindow(o,n,t,s):this.getRelativeCellPositionWithinHolder(o,r,n,t,s)}(0,c.warn)(`The provided element is not a child of the ${this.type} overlay`)}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,t,r,n){var i=this.wot.wtTable.wtRootElement.getBoundingClientRect();let o=0,s=0;if(t){let e=i.left;this.isRtl()&&(e=this.domBindings.rootWindow.innerWidth-(i.left+i.width+(0,a.getScrollbarWidth)())),o=e<=0?-1*e:0}else o=n.start;return s=e?this.clone.wtTable.TABLE.getBoundingClientRect().top-i.top:n.top,{start:r.start+o,top:r.top+s}}getRelativeCellPositionWithinHolder(e,t,r,n,i){const o=this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),s=this.wot.wtOverlays.topOverlay.getScrollPosition();let a=0,l=0;return r||(a=o-i.start),t?(r=this.wot.wtTable.wtRootElement.getBoundingClientRect(),t=this.clone.wtTable.TABLE.getBoundingClientRect(),l=-1*t.top+r.top):e||(l=s-i.top),{start:n.start-a,top:n.top-l}}makeClone(){if(-1===u.CLONE_TYPES.indexOf(this.type))throw new Error(`Clone type "${this.type}" is not supported.`);var{wtTable:e,wtSettings:t}=this.wot,{rootDocument:r,rootWindow:n}=this.domBindings,i=r.createElement("div"),r=r.createElement("table"),o=e.wtRootElement.parentNode,t=(i.className=u.CLONE_CLASS_NAMES.get(this.type)+" handsontable",i.setAttribute("dir",this.isRtl()?"rtl":"ltr"),i.style.position="absolute",i.style.top=0,i.style.overflow="visible",this.isRtl()?i.style.right=0:i.style.left=0,t.getSetting("ariaTags")&&(0,a.setAttribute)(i,[(0,h.A11Y_PRESENTATION)()]),r.className=e.TABLE.className,e.TABLE.getAttribute("role")),t=(t&&r.setAttribute("role",e.TABLE.getAttribute("role")),i.appendChild(r),o.appendChild(i),this.wtSettings.getSetting("preventOverflow"));return!0===t||"horizontal"===t&&this.type===u.CLONE_TOP||"vertical"===t&&this.type===u.CLONE_INLINE_START?this.mainTableScrollableElement=n:"hidden"===n.getComputedStyle(o).getPropertyValue("overflow")?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=(0,a.getScrollableElement)(e.TABLE),new d.default(r,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){this.needFullRender&&this.clone.draw(0<arguments.length&&void 0!==arguments[0]&&arguments[0])}reset(){var e=this.clone.wtTable.holder,t=this.clone.wtTable.hider;[e.style,t.style,e.parentNode.style].forEach(e=>{e.width="",e.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}},(e,t)=>{"use strict";t.__esModule=!0;t.CLONE_TOP="top";var r=t.CLONE_BOTTOM="bottom",n=t.CLONE_INLINE_START="inline_start",i=t.CLONE_TOP_INLINE_START_CORNER="top_inline_start_corner",o=t.CLONE_BOTTOM_INLINE_START_CORNER="bottom_inline_start_corner";t.CLONE_TYPES=["top",r,n,i,o],t.CLONE_CLASS_NAMES=new Map([["top","ht_clone_top"],[r,"ht_clone_"+r],[n,`ht_clone_${n} ht_clone_left`],[i,`ht_clone_${i} ht_clone_top_left_corner`],[o,`ht_clone_${o} ht_clone_bottom_left_corner`]])},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(487))),o=n(r(537));class s extends n(r(568)).default{constructor(e,t,r){super(e,t),(0,i.default)(this,"cloneSource",void 0),(0,i.default)(this,"cloneOverlay",void 0);e=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),e,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new o.default(e,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}t.default=s},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(286),n(r(487))),o=r(334),s=r(335),a=n(r(502)),l=n(r(569)),c=n(r(533)),u=n(r(534));t.default=class{get eventManager(){return new a.default(this)}constructor(e,t){(0,i.default)(this,"wtTable",void 0),(0,i.default)(this,"wtScroll",void 0),(0,i.default)(this,"wtViewport",void 0),(0,i.default)(this,"wtOverlays",void 0),(0,i.default)(this,"selectionManager",void 0),(0,i.default)(this,"wtEvent",void 0),(0,i.default)(this,"guid","wt_"+(0,s.randomString)()),(0,i.default)(this,"drawInterrupted",!1),(0,i.default)(this,"drawn",!1),(0,i.default)(this,"domBindings",void 0),(0,i.default)(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=t,this.wtScroll=new l.default(this.createScrollDao())}findOriginalHeaders(){const r=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let e=0,t=this.wtTable.THEAD.childNodes[0].childNodes.length;e<t;e++)r.push(this.wtTable.THEAD.childNodes[0].childNodes[e].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(e,t){(0,o.fastInnerText)(t,r[e])}])}}createCellCoords(e,t){return new c.default(e,t,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,t,r){return new u.default(e,t,r,this.wtSettings.getSetting("rtlMode"))}draw(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,this.wtTable.isVisible()?this.wtTable.draw(e):this.drawInterrupted=!0,this}getCell(e){if(1<arguments.length&&void 0!==arguments[1]&&arguments[1]){var t=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsTop"),n=this.wtSettings.getSetting("fixedRowsBottom"),i=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<r&&e.col<i)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<r)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<i&&e.row>=t-n){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<i)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<t&&e.row>=t-n&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}}return this.wtTable.getCell(e)}scrollViewport(e,t,r,n,i){return!(e.col<0||e.row<0)&&this.wtScroll.scrollViewport(e,t,r,n,i)}scrollViewportHorizontally(e,t,r){return!(e<0)&&this.wtScroll.scrollViewportHorizontally(e,t,r)}scrollViewportVertically(e,t,r){return!(e<0)&&this.wtScroll.scrollViewportVertically(e,t,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const t=this;return{get wot(){return t},get parentTableOffset(){return t.cloneSource.wtTable.tableOffset},get cloneSource(){return t.cloneSource},get workspaceWidth(){return t.wtViewport.getWorkspaceWidth()},get wtViewport(){return t.wtViewport},get wtOverlays(){return t.wtOverlays},get selectionManager(){return t.selectionManager},get drawn(){return t.drawn},set drawn(e){t.drawn=e},get wtTable(){return t.wtTable},get startColumnRendered(){return t.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return t.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return t.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return t.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return t.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return t.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return t.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return t.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return t.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return t.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return t.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return t.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return t.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return t.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return t.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return t.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return t.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return t.wtSettings.getSetting("rowHeaders")}}}}},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),n(r(487))),d=r(334);function o(e,t){var r=e;if(t.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object");t.add(e)}function s(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var a=new WeakSet;function l(n){var{wtSettings:e,inlineStartOverlay:i,wtTable:t,wtViewport:o,totalColumns:s,rootWindow:a}=this.dataAccessObject;if(i.mainTableScrollableElement===a){var l,e=e.getSetting("rtlMode");let r=null;r=e?(e=t.TABLE.getBoundingClientRect(),l=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth,Math.abs(e.right-l)):(0,d.offset)(t.wtRootElement).left;var c=Math.abs((0,d.getScrollLeft)(a,a));if(r>c){var u=(0,d.innerWidth)(a);let t=o.getRowHeaderWidth();for(let e=1;e<=s;e++)if(t+=i.sumCellSizes(e-1,e),r+t-c>=u){n=e-2;break}}}return n}function c(r){var{topOverlay:n,wtTable:e,wtViewport:i,totalRows:o,rootWindow:s}=this.dataAccessObject;if(n.mainTableScrollableElement===s){var a=(0,d.offset)(e.wtRootElement),l=(0,d.getScrollTop)(s,s);if(a.top>l){var c=(0,d.innerHeight)(s);let t=i.getColumnHeaderHeight();for(let e=1;e<=o;e++)if(t+=n.sumCellSizes(e-1,e),a.top+t-l>=c){r=e-2;break}}}return r}t.default=class{constructor(e){o(this,a),(0,i.default)(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,t,r,n,i){r=this.scrollViewportHorizontally(e.col,r,i),i=this.scrollViewportVertically(e.row,t,n);return r||i}scrollViewportHorizontally(e,t,r){var{drawn:n,totalColumns:i}=this.dataAccessObject;if(!n||!Number.isInteger(e)||e<0||i<e)return!1;var n=void 0===t&&void 0===r,{fixedColumnsStart:r,inlineStartOverlay:o}=this.dataAccessObject;if(n&&e<r)return!1;if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e),!Number.isInteger(e)||e<0||i<e)return!1;r=this.getFirstVisibleColumn(),i=this.getLastVisibleColumn();let s=!1;return s=n&&(e<r||i<e)||!n?o.scrollTo(e,n?e>=this.getLastPartiallyVisibleColumn():t):s}scrollViewportVertically(e,t,r){var{drawn:n,totalRows:i}=this.dataAccessObject;if(!n||!Number.isInteger(e)||e<0||i<e)return!1;var n=void 0===t&&void 0===r,{fixedRowsBottom:t,fixedRowsTop:o,topOverlay:s}=this.dataAccessObject;if(n&&(e<o||i-t-1<e))return!1;if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e),!Number.isInteger(e)||e<0||i<e)return!1;o=this.getFirstVisibleRow(),t=this.getLastVisibleRow();let a=!1;return a=n&&(e<o||t<e)||!n?s.scrollTo(e,n?e>=this.getLastPartiallyVisibleRow():r):a}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return s(a,this,c).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return s(a,this,c).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return s(a,this,l).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return s(a,this,l).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),n(r(487))),a=r(334),o=n(r(571)),n=r(565),s=r(566);class l extends n.Overlay{constructor(e,t,r,n){super(e,t,s.CLONE_BOTTOM,r,n),(0,i.default)(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new o.default(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;var e=this.domBindings["rootWindow"],t=this.clone.wtTable.holder.parentNode;t.style.top="";let r=0;var n=this.wtSettings.getSetting("preventOverflow"),e=(this.trimmingContainer!==e||n&&"vertical"===n?(r=this.getScrollPosition(),this.repositionOverlay()):(r=this.getOverlayOffset(),t.style.bottom=r+"px"),this.adjustHeaderBordersPosition(r));return this.adjustElementsSize(),e}repositionOverlay(){var{wtTable:e,wtViewport:t}=this.wot,r=this.domBindings["rootDocument"],n=this.clone.wtTable.holder.parentNode;let i=0;t.hasVerticalScroll()||(i+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(i+=(0,a.getScrollbarWidth)(r)),n.style.bottom=i+"px"}setScrollPosition(e){var t=this.domBindings["rootWindow"];let r=!1;return this.mainTableScrollableElement===t?(t.scrollTo((0,a.getWindowScrollLeft)(t),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){var{wtTable:r,wtSettings:n}=this.wot,i=n.getSetting("defaultRowHeight");let o=e,s=0;for(;o<t;){var a=r.getRowHeight(o);s+=void 0===a?i:a,o+=1}return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){var{wtTable:t,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:e}=this.domBindings,n=(0,a.getScrollbarWidth)(n),i=this.clone.wtTable.holder.parentNode.style,o=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==e||"horizontal"===o){let e=r.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(e-=n),e=Math.min(e,t.wtRootElement.scrollWidth),i.width=e+"px"}else i.width="";this.clone.wtTable.holder.style.width=i.width;let s=(0,a.outerHeight)(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(s=0),i.height=s+"px"}adjustRootChildrenSize(){var e=this.clone.wtTable["holder"];this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){var e=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px";else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){var e=this.isRtl()?"right":"left",t=this.clone.wtTable["spreader"];"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?t.style[e]=this.wot.wtViewport.columnsRenderCalculator.startPosition+"px":t.style[e]=""}scrollTo(e,t){let r=this.getTableParentOffset();var n=(this.wot.cloneSource||this.wot).wtTable.holder;let i=0;t&&n.offsetHeight!==n.clientHeight&&(i=(0,a.getScrollbarWidth)(this.domBindings.rootDocument)),t?r=(r+=this.sumCellSizes(0,e+1))-this.wot.wtViewport.getViewportHeight()+1:r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=i,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return(0,a.getScrollTop)(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){var e,t=this.domBindings["rootWindow"],r=this.wtSettings.getSetting("preventOverflow");let n=0;return this.trimmingContainer!==t||r&&"vertical"===r||(r=(t=this.wot.wtTable.getTotalHeight())-this.clone.wtTable.getTotalHeight(),e=this.domBindings.rootDocument.documentElement.clientHeight,(n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-e+t,0))>r&&(n=0)),n}adjustHeaderBordersPosition(e){var t=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==t,n=this.wtSettings.getSetting("columnHeaders");let i=!1;return(r||0===t)&&0<n.length&&(r=this.wot.wtTable.holder.parentNode,t=(0,a.hasClass)(r,"innerBorderBottom"),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),i=e||0===this.wtSettings.getSetting("totalRows")?((0,a.addClass)(r,"innerBorderBottom"),!t):((0,a.removeClass)(r,"innerBorderBottom"),t)),i}}t.BottomOverlay=l},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(542))),o=n(r(563)),n=n(r(572)),s=r(482),a=r(539);class l extends i.default{constructor(e,t,r,n){super(e,t,r,n,a.CLONE_BOTTOM)}}(0,s.mixin)(l,o.default),(0,s.mixin)(l,n.default);t.default=l},(e,t,r)=>{"use strict";t.__esModule=!0;var n={getFirstRenderedColumn(){var e=this.dataAccessObject.startColumnRendered;return null===e?-1:e},getFirstVisibleColumn(){var e=this.dataAccessObject.startColumnVisible;return null===e?-1:e},getFirstPartiallyVisibleColumn(){var e=this.dataAccessObject.startColumnPartiallyVisible;return null===e?-1:e},getLastRenderedColumn(){var e=this.dataAccessObject.endColumnRendered;return null===e?-1:e},getLastVisibleColumn(){var e=this.dataAccessObject.endColumnVisible;return null===e?-1:e},getLastPartiallyVisibleColumn(){var e=this.dataAccessObject.endColumnPartiallyVisible;return null===e?-1:e},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};(0,r(482).defineGetter)(n,"MIXIN_NAME","calculatedColumns",{writable:!1,enumerable:!1}),t.default=n},(e,t,r)=>{"use strict";var n=r(197),a=(t.__esModule=!0,r(204),r(334)),i=n(r(574)),n=r(565),o=r(576),s=r(566);class l extends n.Overlay{constructor(e,t,r,n){super(e,t,s.CLONE_INLINE_START,r,n)}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new i.default(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){var e=this.wot["wtTable"];if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;var e=this.domBindings["rootWindow"],t=this.clone.wtTable.holder.parentNode,r=this.wtSettings.getSetting("preventOverflow");let n=0;this.trimmingContainer!==e||r&&"horizontal"===r?(n=this.getScrollPosition(),(0,a.resetCssTransform)(t)):(n=this.getOverlayOffset()*(this.isRtl()?-1:1),(0,a.setOverlayPosition)(t,n+"px","0px"));e=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),e}setScrollPosition(e){var t=this.domBindings["rootWindow"];let r=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===t&&t.scrollX!==e?(t.scrollTo(e,(0,a.getWindowScrollTop)(t)),r=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,t){var r=this.wtSettings.getSetting("defaultColumnWidth");let n=e,i=0;for(;n<t;)i+=this.wot.wtTable.getStretchedColumnWidth(n)||r,n+=1;return i}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){var t=this.wot["wtTable"],{rootDocument:r,rootWindow:e}=this.domBindings,r=(0,a.getScrollbarWidth)(r),n=this.clone.wtTable.holder.parentNode.style,i=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==e||"vertical"===i){let e=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(e-=r),e=Math.min(e,t.wtRootElement.scrollHeight),n.height=e+"px"}else n.height="";this.clone.wtTable.holder.style.height=n.height;e=(0,a.outerWidth)(this.clone.wtTable.TABLE);n.width=e+"px"}adjustRootChildrenSize(){var e=this.clone.wtTable["holder"],t=this.wot.selectionManager.getFocusSelection()?parseInt(o.CORNER_DEFAULT_STYLE.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=parseInt(e.parentNode.style.width,10)+t+"px"}applyToDOM(){var e=this.wtSettings.getSetting("totalColumns"),t=this.isRtl()?"right":"left";if("number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style[t]=this.wot.wtViewport.columnsRenderCalculator.startPosition+"px";else{if(0!==e)throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style[t]="0"}this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px":this.clone.wtTable.spreader.style.top=""}scrollTo(e,t){var r=this["wtSettings"],n=r.getSetting("rowHeaders"),r=r.getSetting("fixedColumnsStart"),i=(this.wot.cloneSource||this.wot).wtTable.holder,r=0===r&&0<n.length&&!(0,a.hasClass)(i.parentNode,"innerBorderInlineStart")?1:0;let o=this.getTableParentOffset(),s=0;return(t=t&&(n=this.wot.wtTable.getColumnWidth(e),this.wot.wtViewport.getViewportWidth()<n)?!1:t)&&i.offsetWidth!==i.clientWidth&&(s=(0,a.getScrollbarWidth)(this.domBindings.rootDocument)),t?o=(o+=this.sumCellSizes(0,e+1))-this.wot.wtViewport.getViewportWidth()+r:o+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),o+=s,(0,a.getMaximumScrollLeft)(this.mainTableScrollableElement)===o-r&&0<r&&this.wot.wtOverlays.expandHiderHorizontallyBy(r),this.setScrollPosition(o)}getTableParentOffset(){var e=this.wtSettings.getSetting("preventOverflow");let t=0;return t=e||this.trimmingContainer!==this.domBindings.rootWindow?t:this.wot.wtTable.holderOffset.left}getScrollPosition(){return Math.abs((0,a.getScrollLeft)(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){var e=this.domBindings["rootWindow"],t=this.wtSettings.getSetting("preventOverflow");let r=0;return this.trimmingContainer!==e||t&&"horizontal"===t||(r=this.isRtl()?Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),e=this.wot.wtTable.getTotalWidth(),t=this.clone.wtTable.getTotalWidth(),r>e-t&&(r=0)),r}adjustHeaderBordersPosition(e){var t=this["wtSettings"],r=this.wot.wtTable.holder.parentNode,n=t.getSetting("rowHeaders"),i=t.getSetting("fixedColumnsStart"),o=t.getSetting("totalRows"),t="vertical"===t.getSetting("preventOverflow");(o?(0,a.removeClass):(0,a.addClass))(r,"emptyRows");let s=!1;return t||(i&&!n.length?(0,a.addClass)(r,"innerBorderLeft innerBorderInlineStart"):!i&&n.length&&(o=(0,a.hasClass)(r,"innerBorderInlineStart"),s=e?((0,a.addClass)(r,"innerBorderLeft innerBorderInlineStart"),!o):((0,a.removeClass)(r,"innerBorderLeft innerBorderInlineStart"),o))),s}}t.InlineStartOverlay=l},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(542))),o=n(r(575)),n=n(r(564)),s=r(482),a=r(539);class l extends i.default{constructor(e,t,r,n){super(e,t,r,n,a.CLONE_INLINE_START)}}(0,s.mixin)(l,o.default),(0,s.mixin)(l,n.default);t.default=l},(e,t,r)=>{"use strict";t.__esModule=!0;var n={getFirstRenderedRow(){var e=this.dataAccessObject.startRowRendered;return null===e?-1:e},getFirstVisibleRow(){var e=this.dataAccessObject.startRowVisible;return null===e?-1:e},getFirstPartiallyVisibleRow(){var e=this.dataAccessObject.startRowPartiallyVisible;return null===e?-1:e},getLastRenderedRow(){var e=this.dataAccessObject.endRowRendered;return null===e?-1:e},getLastVisibleRow(){var e=this.dataAccessObject.endRowVisible;return null===e?-1:e},getLastPartiallyVisibleRow(){var e=this.dataAccessObject.endRowPartiallyVisible;return null===e?-1:e},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};(0,r(482).defineGetter)(n,"MIXIN_NAME","calculatedRows",{writable:!1,enumerable:!1}),t.default=n},(e,t,r)=>{"use strict";var n=r(197),i={SelectionManager:t.__esModule=!0,Selection:!0},n=n(r(577)),o=(t.Selection=n.default,r(579)),s=(Object.keys(o).forEach(function(e){"default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(i,e)||e in t&&t[e]===o[e]||(t[e]=o[e])}),r(580)),n=(Object.keys(s).forEach(function(e){"default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(i,e)||e in t&&t[e]===s[e]||(t[e]=s[e])}),r(581));t.SelectionManager=n.SelectionManager},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(482)),n=n(r(578));class o{constructor(e,t){this.settings=e,this.cellRange=t||null}isEmpty(){return null===this.cellRange}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){var e=this.cellRange.getOuterTopStartCorner(),t=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,t.row,t.col]}destroy(){this.runLocalHooks("destroy")}}(0,i.mixin)(o,n.default);t.default=o},(e,t,r)=>{"use strict";t.__esModule=!0,r(286);var n=r(482),c=r(480),r={_localHooks:Object.create(null),addLocalHook(e,t){return this._localHooks[e]||(this._localHooks[e]=[]),this._localHooks[e].push(t),this},runLocalHooks(t,r,n,i,o,s,a){if(this._localHooks[t]){var l=this._localHooks[t].length;for(let e=0;e<l;e++)(0,c.fastCall)(this._localHooks[t][e],this,r,n,i,o,s,a)}},clearLocalHooks(){return this._localHooks={},this}};(0,n.defineGetter)(r,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1}),t.default=r},(e,t)=>{"use strict";t.__esModule=!0;t.ACTIVE_HEADER_TYPE="active-header",t.HEADER_TYPE="header",t.AREA_TYPE="area",t.FOCUS_TYPE="focus",t.FILL_TYPE="fill",t.ROW_TYPE="row",t.COLUMN_TYPE="column",t.CUSTOM_SELECTION_TYPE="custom-selection"},(e,t)=>{"use strict";t.__esModule=!0;t.CORNER_DEFAULT_STYLE=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"})},(e,t,r)=>{"use strict";var n=r(197),d=(t.__esModule=!0,r(204),r(286),r(582),r(290),r(302),r(305),r(309),r(312),r(315),r(318),r(334)),i=r(583),o=n(r(584));function s(e,t,r){a(e,t),t.set(e,r)}function a(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function h(e,t){return e.get(p(e,t))}function l(e,t,r){e.set(p(e,t),r)}function p(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var f=new WeakMap,g=new WeakMap,m=new WeakMap,y=new WeakMap,v=new WeakMap,c=new WeakMap,b=new WeakSet;function w(){var t=h(y,this).get(h(f,this)),r=h(f,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(r))for(let e=0;e<r.length;e++)t.add(r[e]);t.forEach(r=>{var e,n=h(f,this).wtTable.TABLE.querySelectorAll("."+r);let i=[];Array.isArray(null==(e=h(g,this).options)?void 0:e.cellAttributes)&&(i=h(g,this).options.cellAttributes.map(e=>e[0])),Array.isArray(null==(e=h(g,this).options)?void 0:e.headerAttributes)&&(i=[...i,...h(g,this).options.headerAttributes.map(e=>e[0])]);for(let e=0,t=n.length;e<t;e++)(0,d.removeClass)(n[e],r),(0,d.removeAttribute)(n[e],i)}),t.clear()}t.SelectionManager=class{constructor(e){var t,r;a(t=this,r=b),r.add(t),s(this,f,void 0),s(this,g,void 0),s(this,m,new i.SelectionScanner),s(this,y,new WeakMap),s(this,v,new WeakSet),s(this,c,new Map),l(g,this,e)}setActiveOverlay(e){return l(f,this,e),h(m,this).setActiveOverlay(h(f,this)),h(y,this).has(h(f,this))||h(y,this).set(h(f,this),new Set),this}getFocusSelection(){return null!==h(g,this)?h(g,this).getFocus():null}getAreaSelection(){return null!==h(g,this)?h(g,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(h(c,this).has(e)){var t=h(c,this).get(e);if(t.has(h(f,this)))return t.get(h(f,this));const r=new o.default(h(f,this),e.settings);return t.set(h(f,this),r),r}const r=new o.default(h(f,this),e.settings);return h(c,this).set(e,new Map([[h(f,this),r]])),r}getBorderInstances(e){return Array.from(null!=(e=null==(e=h(c,this).get(e))?void 0:e.values())?e:[])}destroyBorders(e){h(c,this).get(e).forEach(e=>e.destroy()),h(c,this).delete(e)}render(e){if(null!==h(g,this)){e&&p(b,this,w).call(this);var t=Array.from(h(g,this));const i=new Map,o=new Map;for(let e=0;e<t.length;e++){const s=t[e],{className:a,headerAttributes:l,createLayers:c,selectionType:u}=s.settings;h(v,this).has(s)||(h(v,this).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));var r,n=this.getBorderInstance(s);s.isEmpty()?null!=n&&n.disappear():(r=(a&&h(m,this).setActiveSelection(s).scan().forEach(e=>{var t;i.has(e)?(t=i.get(e)).has(a)&&!0===c?t.set(a,t.get(a)+1):t.set(a,1):i.set(e,new Map([[a,1]])),l&&(o.has(e)||o.set(e,[]),"TH"===e.nodeName)&&o.get(e).push(...l)}),s.getCorners()),h(f,this).getSetting("onBeforeDrawBorders",r,u),null!=n&&n.appear(r))}i.forEach((e,t)=>{var e=Array.from(e).map(e=>{let[r,t]=e;return 1===t?r:[r,...Array.from({length:t-1},(e,t)=>r+"-"+(t+1))]}).flat();e.forEach(e=>h(y,this).get(h(f,this)).add(e)),(0,d.addClass)(t,e),"TD"===t.nodeName&&Array.isArray(null==(e=h(g,this).options)?void 0:e.cellAttributes)&&(0,d.setAttribute)(t,h(g,this).options.cellAttributes)}),Array.from(o.keys()).forEach(e=>{(0,d.setAttribute)(e,[...o.get(e)])})}}}},(e,t,r)=>{"use strict";r(496)("flat")},(e,t,r)=>{"use strict";t.__esModule=!0,r(204),r(290),r(302),r(305),r(309),r(312),r(315),r(318);var c=r(334);function n(e,t,r){i(e,t),t.set(e,r)}function i(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function p(e,t){return e.get(u(e,t))}function o(e,t,r){e.set(u(e,t),r)}function u(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var f=new WeakMap,g=new WeakMap,d=new WeakSet;function h(t){var r=p(g,this)["wtTable"],n=r.getRenderedRowsCount(),i=r.getRenderedColumnsCount();for(let e=0;e<n;e+=1){var o=r.rowFilter.renderedToSource(e);for(let e=0;e<i;e+=1)t(o,r.columnFilter.renderedToSource(e))}}t.SelectionScanner=class{constructor(){var e,t;i(e=this,t=d),t.add(e),n(this,f,void 0),n(this,g,void 0)}setActiveOverlay(e){return o(g,this,e),this}setActiveSelection(e){return o(f,this,e),this}scan(){var e=p(f,this).settings.selectionType;const t=new Set;return"active-header"===e?(this.scanColumnsInHeadersRange(e=>t.add(e)),this.scanRowsInHeadersRange(e=>t.add(e))):"area"===e?this.scanCellsRange(e=>t.add(e)):"focus"===e?(this.scanColumnsInHeadersRange(e=>t.add(e)),this.scanRowsInHeadersRange(e=>t.add(e)),this.scanCellsRange(e=>t.add(e))):"fill"===e?this.scanCellsRange(e=>t.add(e)):"header"===e?(this.scanColumnsInHeadersRange(e=>t.add(e)),this.scanRowsInHeadersRange(e=>t.add(e))):"row"===e?(this.scanRowsInHeadersRange(e=>t.add(e)),this.scanRowsInCellsRange(e=>t.add(e))):"column"===e&&(this.scanColumnsInHeadersRange(e=>t.add(e)),this.scanColumnsInCellsRange(e=>t.add(e))),t}scanColumnsInHeadersRange(r){var[n,i,o,s]=p(f,this).getCorners(),a=p(g,this)["wtTable"],t=a.getRenderedColumnsCount(),l=a.getColumnHeadersCount();let c=0;for(let e=-a.getRowHeadersCount();e<t;e++){var u=a.columnFilter.renderedToSource(e);if(!(u<i||s<u)){for(let t=-l;t<0;t++)if(!(t<n||t>o)){var d=t+l;let e=a.getColumnHeader(u,d);var h=p(g,this).getSetting("onBeforeHighlightingColumnHeader",u,d,{selectionType:p(f,this).settings.selectionType,columnCursor:c,selectionWidth:s-i+1});null!==h&&r(e=h!==u?a.getColumnHeader(h,d):e)}c+=1}}}scanRowsInHeadersRange(r){var[n,i,o,s]=p(f,this).getCorners(),a=p(g,this)["wtTable"],t=a.getRenderedRowsCount(),l=a.getRowHeadersCount();let c=0;for(let e=-a.getColumnHeadersCount();e<t;e++){var u=a.rowFilter.renderedToSource(e);if(!(u<n||o<u)){for(let t=-l;t<0;t++)if(!(t<i||t>s)){var d=t+l;let e=a.getRowHeader(u,d);var h=p(g,this).getSetting("onBeforeHighlightingRowHeader",u,d,{selectionType:p(f,this).settings.selectionType,rowCursor:c,selectionHeight:o-n+1});null!==h&&r(e=h!==u?a.getRowHeader(h,d):e)}c+=1}}}scanCellsRange(n){const[i,o,s,a]=p(f,this).getCorners(),l=p(g,this)["wtTable"];u(d,this,h).call(this,(e,t)=>{var r;e>=i&&e<=s&&t>=o&&t<=a&&(r=l.getCell(p(g,this).createCellCoords(e,t)),"string"==typeof(e=p(g,this).getSetting("onAfterDrawSelection",e,t,p(f,this).settings.layerLevel))&&(0,c.addClass)(r,e),n(r))})}scanRowsInCellsRange(r){const[n,,i]=p(f,this).getCorners(),o=p(g,this)["wtTable"];u(d,this,h).call(this,(e,t)=>{e>=n&&e<=i&&(e=o.getCell(p(g,this).createCellCoords(e,t)),r(e))})}scanColumnsInCellsRange(r){const[,n,,i]=p(f,this).getCorners(),o=p(g,this)["wtTable"];u(d,this,h).call(this,(e,t)=>{t>=n&&t<=i&&(e=o.getCell(p(g,this).createCellCoords(e,t)),r(e))})}}},(e,t,r)=>{"use strict";t.__esModule=!0;var _=r(334),s=r(492),n=r(482),x=r(481),i=r(580);t.default=class{constructor(e,t){t&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=t,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=i.CORNER_DEFAULT_STYLE,this.cornerCenterPointOffset=-parseInt(this.cornerDefaultStyle.width,10)/2,this.corner=null,this.cornerStyle=null,this.createBorders(t),this.registerListeners())}registerListeners(){var e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let t=0,e=this.main.childNodes.length;t<e;t++){var r=this.main.childNodes[t];this.eventManager.addEventListener(r,"mouseenter",e=>this.onMouseEnter(e,this.main.childNodes[t]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,r){if(this.mouseDown&&this.wot.getSetting("hideBorderOnMouseDownOver")){e.preventDefault(),(0,s.stopImmediatePropagation)(e);const n=this,i=this.wot.rootDocument.body,o=r.getBoundingClientRect();r.style.display="none",this.eventManager.addEventListener(i,"mousemove",function e(t){(t.clientY<Math.floor(o.top)||t.clientY>Math.ceil(o.top+o.height)||t.clientX<Math.floor(o.left)||t.clientX>Math.ceil(o.left+o.width))&&(n.eventManager.removeEventListener(i,"mousemove",e),r.style.display="block")})}}createBorders(t){var r=this.wot["rootDocument"],n=(this.main=r.createElement("div"),["top","start","bottom","end","corner"]);let i=this.main.style;i.position="absolute",i.top=0;for(let e=i.left=0;e<5;e++){var o=n[e],s=r.createElement("div");s.className="wtBorder "+(this.settings.className||""),this.settings[o]&&this.settings[o].hide&&(s.className+=" hidden"),(i=s.style).backgroundColor=(this.settings[o]&&this.settings[o].color?this.settings[o]:t.border).color,i.height=this.settings[o]&&this.settings[o].width?this.settings[o].width+"px":t.border.width+"px",i.width=this.settings[o]&&this.settings[o].width?this.settings[o].width+"px":t.border.width+"px",this.main.appendChild(s)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),(0,x.isMobileBrowser)()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();var e=this.wot["wtTable"];let a=e.bordersHolder;a||((a=r.createElement("div")).className="htBorders",e.bordersHolder=a,e.spreader.appendChild(a)),a.appendChild(this.main)}createMultipleSelectorHandles(){var e=this.wot["rootDocument"],e=(this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")},this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style},{position:"absolute",height:"40px",width:"40px","border-radius":parseInt(40/1.5,10)+"px"}),e=((0,n.objectEach)(e,(e,t)=>{this.selectionHandles.styles.bottomHitArea[t]=e,this.selectionHandles.styles.topHitArea[t]=e}),{position:"absolute",height:"10px",width:"10px","border-radius":parseInt(10/1.5,10)+"px",background:"#F5F5FF",border:"1px solid #4285c8"});(0,n.objectEach)(e,(e,t)=>{this.selectionHandles.styles.bottom[t]=e,this.selectionHandles.styles.top[t]=e}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,t){var r=this.wot.selectionManager.getAreaSelection();return!(!r.cellRange||e===r.cellRange.to.row&&t===r.cellRange.to.col)}updateMultipleSelectionHandlesPosition(e,t,r,n,i,o){var s=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:a,topHitArea:l,bottom:c,bottomHitArea:u}=this.selectionHandles.styles,d=parseInt(a.borderWidth,10),h=parseInt(a.width,10),p=parseInt(l.width,10),f=this.wot.wtTable.getWidth(),g=this.wot.wtTable.getHeight(),m=(a.top=parseInt(r-h-1,10)+"px",a[s]=parseInt(n-h-1,10)+"px",l.top=parseInt(r-p/4*3,10)+"px",l[s]=parseInt(n-p/4*3,10)+"px",Math.min(parseInt(n+i,10),f-h-2*d)),n=Math.min(parseInt(n+i-p/4,10),f-p-2*d),i=(c[s]=m+"px",u[s]=n+"px",Math.min(parseInt(r+o,10),g-h-2*d)),f=Math.min(parseInt(r+o-p/4,10),g-p-2*d);c.top=i+"px",u.top=f+"px",this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(a.display="block",l.display="block",this.isPartRange(e,t)?(c.display="none",u.display="none"):(c.display="block",u.display="block")):(a.display="none",c.display="none",l.display="none",u.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||t===this.wot.wtSettings.getSetting("fixedColumnsStart")?(a.zIndex="9999",l.zIndex="9999"):(a.zIndex="",l.zIndex="")}appear(t){if(!this.disabled){var{wtTable:f,rootDocument:g,rootWindow:m}=this.wot;let l,c,u,d,h,p;var r=f.getRenderedRowsCount();for(let e=0;e<r;e+=1){var n=f.rowFilter.renderedToSource(e);if(n>=t[0]&&n<=t[2]){l=n,h=t[0];break}}for(let e=r-1;0<=e;--e){var i=f.rowFilter.renderedToSource(e);if(i>=t[0]&&i<=t[2]){c=i;break}}var o=f.getRenderedColumnsCount();for(let e=0;e<o;e+=1){var s=f.columnFilter.renderedToSource(e);if(s>=t[1]&&s<=t[3]){u=s,p=t[1];break}}for(let e=o-1;0<=e;--e){var a=f.columnFilter.renderedToSource(e);if(a>=t[1]&&a<=t[3]){d=a;break}}if(void 0===l||void 0===u)this.disappear();else{let t=f.getCell(this.wot.createCellCoords(l,u));var y=l!==c||u!==d,v=y?f.getCell(this.wot.createCellCoords(c,d)):t,b=(0,_.offset)(t),y=y?(0,_.offset)(v):b,w=(0,_.offset)(f.TABLE),C=(0,_.outerWidth)(f.TABLE),E=b.top,b=b.left,T=this.wot.wtSettings.getSetting("rtlMode");let n=0,i=0;if(n=T?(S=(0,_.outerWidth)(t),C=m.innerWidth-w.left-C,i=b+S-y.left,m.innerWidth-b-S-C-1):(i=y.left+(0,_.outerWidth)(v)-b,b-w.left-1),this.isEntireColumnSelected(l,c)){var S=this.getDimensionsFromHeader("columns",u,d,h,w);let e=null;S&&([e,n,i]=S),e&&(t=e)}let o=E-w.top-1,s=y.top+(0,_.outerHeight)(v)-E;if(this.isEntireRowSelected(u,d)){C=this.getDimensionsFromHeader("rows",l,c,p,w);let e=null;C&&([e,o,s]=C),e&&(t=e)}b=(0,_.getComputedStyle)(t,m),S=(0<parseInt(b.borderTopWidth,10)&&(o+=1,s=0<s?s-1:0),0<parseInt(b[T?"borderRightWidth":"borderLeftWidth"],10)&&(n+=1,i=0<i?i-1:0),T?"right":"left"),y=(this.topStyle.top=o+"px",this.topStyle[S]=n+"px",this.topStyle.width=i+"px",this.topStyle.display="block",this.startStyle.top=o+"px",this.startStyle[S]=n+"px",this.startStyle.height=s+"px",this.startStyle.display="block",Math.floor(this.settings.border.width/2));this.bottomStyle.top=o+s-y+"px",this.bottomStyle[S]=n+"px",this.bottomStyle.width=i+"px",this.bottomStyle.display="block",this.endStyle.top=o+"px",this.endStyle[S]=n+i-y+"px",this.endStyle.height=s+1+"px",this.endStyle.display="block";let e=this.settings.border.cornerVisible;e="function"==typeof e?e(this.settings.layerLevel):e;E=this.wot.getSetting("onModifyGetCellCoords",c,d);let[r,a]=[c,d];if(E&&Array.isArray(E)&&([,,r,a]=E),(0,x.isMobileBrowser)()||!e||this.isPartRange(r,a))this.cornerStyle.display="none";else{this.cornerStyle.top=o+s+this.cornerCenterPointOffset-1+"px",this.cornerStyle[S]=n+i+this.cornerCenterPointOffset-1+"px",this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let r=(0,_.getTrimmingContainer)(f.TABLE);w=r===m,C=(w&&(r=g.documentElement),parseInt(this.cornerDefaultStyle.width,10)/2),b=parseInt(this.cornerDefaultStyle.height,10)/2;if(d===this.wot.getSetting("totalColumns")-1){y=w?v.getBoundingClientRect().left:v.offsetLeft;let e=!1,t=0;(e=T?(t=y-parseInt(this.cornerDefaultStyle.width,10)/2)<0:(t=y+(0,_.outerWidth)(v)+parseInt(this.cornerDefaultStyle.width,10)/2)>=(0,_.innerWidth)(r))&&(this.cornerStyle[S]=Math.floor(n+i+this.cornerCenterPointOffset-C)+"px",this.cornerStyle[T?"borderLeftWidth":"borderRightWidth"]=0)}c===this.wot.getSetting("totalRows")-1&&(w?v.getBoundingClientRect().top:v.offsetTop)+(0,_.outerHeight)(v)+parseInt(this.cornerDefaultStyle.height,10)/2>=(0,_.innerHeight)(r)&&(this.cornerStyle.top=Math.floor(o+s+this.cornerCenterPointOffset-b)+"px",this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}(0,x.isMobileBrowser)()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(c,d,o,n,i,s)}}}isEntireColumnSelected(e,t){return e===this.wot.wtTable.getFirstRenderedRow()&&t===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,t){return e===this.wot.wtTable.getFirstRenderedColumn()&&t===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,t,r,n,i){const o=this.wot["wtTable"];var s=o.wtRootElement.parentNode;let a=null,l=null,c=null,u=null,d=null,h=null;var p=null,f=null;switch(e){case"rows":a=function(){return o.getRowHeader(...arguments)},l=function(){return(0,_.outerHeight)(...arguments)},c="ht__selection--rows",h="top";break;case"columns":a=function(){return o.getColumnHeader(...arguments)},l=function(){return(0,_.outerWidth)(...arguments)},c="ht__selection--columns",h="left"}return!(!s.classList.contains(c)||(e=this.wot.getSetting("columnHeaders").length,p=a(t,e-n),f=a(r,e-n),!p)||!f)&&(s=(0,_.offset)(p),t=(0,_.offset)(f),p&&f&&(u=s[h]-i[h]-1,d=t[h]+l(f)-s[h]),[p,u,d])}changeBorderStyle(e,t){var r=this[e].style,t=t[e];!t||t.hide?(0,_.addClass)(this[e],"hidden"):((0,_.hasClass)(this[e],"hidden")&&(0,_.removeClass)(this[e],"hidden"),r.backgroundColor=t.color,"top"!==e&&"bottom"!==e||(r.height=t.width+"px"),"start"!==e&&"end"!==e||(r.width=t.width+"px"))}changeBorderToDefaultStyle(e){const t=1,r="#000";e=this[e].style;e.backgroundColor=r,e.width=t+"px",e.height=t+"px"}toggleHiddenClass(e,t){this.changeBorderToDefaultStyle(e),(t?(0,_.addClass):(0,_.removeClass))(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",(0,x.isMobileBrowser)()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}},(e,t,r)=>{"use strict";var n=r(197),s=(t.__esModule=!0,n(r(487))),i=r(334),o=n(r(586)),n=r(565),a=r(566);class l extends n.Overlay{constructor(e,t,r,n,i,o){super(e,t,a.CLONE_TOP_INLINE_START_CORNER,r,n),(0,s.default)(this,"topOverlay",void 0),(0,s.default)(this,"inlineStartOverlay",void 0),this.topOverlay=i,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new o.default(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),this.wot.wtTable.holder.parentNode){var t,r=this.clone.wtTable.holder.parentNode;this.trimmingContainer===this.domBindings.rootWindow?(n=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),t=this.topOverlay.getOverlayOffset(),(0,i.setOverlayPosition)(r,n+"px",t+"px")):(0,i.resetCssTransform)(r);let e=(0,i.outerHeight)(this.clone.wtTable.TABLE);var n=(0,i.outerWidth)(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(e=0),r.style.height=e+"px",r.style.width=n+"px"}return!1}}t.TopInlineStartCornerOverlay=l},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(542))),o=n(r(587)),n=n(r(564)),s=r(482),a=r(539);class l extends i.default{constructor(e,t,r,n){super(e,t,r,n,a.CLONE_TOP_INLINE_START_CORNER)}}(0,s.mixin)(l,o.default),(0,s.mixin)(l,n.default);t.default=l},(e,t,r)=>{"use strict";t.__esModule=!0;var n={getFirstRenderedRow(){return 0===this.wtSettings.getSetting("totalRows")?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){var e=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),e)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};(0,r(482).defineGetter)(n,"MIXIN_NAME","stickyRowsTop",{writable:!1,enumerable:!1}),t.default=n},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),n(r(487))),c=r(334),o=n(r(589)),n=r(565),s=r(576),a=r(566);class l extends n.Overlay{constructor(e,t,r,n){super(e,t,a.CLONE_TOP,r,n),(0,i.default)(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new o.default(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;var e=this.clone.wtTable.holder.parentNode,t=this.domBindings["rootWindow"],r=this.wtSettings.getSetting("preventOverflow");let n=0,i=!1;this.trimmingContainer!==t||r&&"vertical"===r?(n=this.getScrollPosition(),(0,c.resetCssTransform)(e)):(t=this.wot["wtTable"],r=t.hider.getBoundingClientRect(),t=Math.ceil(r.bottom),r=e.offsetHeight,i=t===r,n=this.getOverlayOffset(),(0,c.setOverlayPosition)(e,"0px",n+"px"));t=this.adjustHeaderBordersPosition(n,i);return this.adjustElementsSize(),t}setScrollPosition(e){var t=this.domBindings.rootWindow;let r=!1;return this.mainTableScrollableElement===t&&t.scrollY!==e?(t.scrollTo((0,c.getWindowScrollLeft)(t),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){var r=this.wtSettings.getSetting("defaultRowHeight");let n=e,i=0;for(;n<t;){var o=this.wot.wtTable.getRowHeight(n);i+=void 0===o?r:o,n+=1}return i}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){var t=this.wot["wtTable"],{rootDocument:r,rootWindow:e}=this.domBindings,r=(0,c.getScrollbarWidth)(r),n=this.clone.wtTable.holder.parentNode.style,i=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==e||"horizontal"===i){let e=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(e-=r),e=Math.min(e,t.wtRootElement.scrollWidth),n.width=e+"px"}else n.width="";this.clone.wtTable.holder.style.width=n.width;let o=(0,c.outerHeight)(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(o=0),n.height=o+"px"}adjustRootChildrenSize(){var e=this.clone.wtTable["holder"],t=this.wot.selectionManager.getFocusSelection()?parseInt(s.CORNER_DEFAULT_STYLE.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=parseInt(e.parentNode.style.height,10)+t+"px"}applyToDOM(){var e=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px";else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){var e=this.isRtl()?"right":"left",t=this.clone.wtTable["spreader"];"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?t.style[e]=this.wot.wtViewport.columnsRenderCalculator.startPosition+"px":t.style[e]=""}scrollTo(e,t){var r,{wot:n,wtSettings:i}=this,o=(n.cloneSource||n).wtTable.holder,s=i.getSetting("columnHeaders"),s=0===i.getSetting("fixedRowsTop")&&0<s.length&&!(0,c.hasClass)(o.parentNode,"innerBorderTop")?1:0;let a=this.getTableParentOffset(),l=0;return(t=t&&(r=this.wot.wtTable.getRowHeight(e),this.wot.wtViewport.getViewportHeight()<r)?!1:t)&&o.offsetHeight!==o.clientHeight&&(l=(0,c.getScrollbarWidth)(this.domBindings.rootDocument)),t?(r=i.getSetting("fixedRowsBottom"),o=i.getSetting("totalRows"),a=1+(a=(a+=this.sumCellSizes(0,e+1))-(n.wtViewport.getViewportHeight()-this.sumCellSizes(o-r,o)))+s):a+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e),a+=l,(0,c.getMaximumScrollTop)(this.mainTableScrollableElement)===a-s&&0<s&&this.wot.wtOverlays.expandHiderVerticallyBy(s),this.setScrollPosition(a)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return(0,c.getScrollTop)(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){var e=this.domBindings["rootWindow"],t=this.wtSettings.getSetting("preventOverflow");let r=0;return this.trimmingContainer!==e||t&&"vertical"===t||(e=this.wot.wtTable.getTotalHeight()-this.clone.wtTable.getTotalHeight(),(r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0))>e&&(r=0)),r}adjustHeaderBordersPosition(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],r=this["wtSettings"],n=this.wot.wtTable.holder.parentNode,i=r.getSetting("totalColumns"),o="horizontal"===r.getSetting("preventOverflow");(i?(0,c.removeClass):(0,c.addClass))(n,"emptyColumns");let s=!1;return t||o||(i=r.getSetting("fixedRowsTop"),t=this.cachedFixedRowsTop!==i,o=r.getSetting("columnHeaders"),(t||0===i)&&0<o.length&&(t=(0,c.hasClass)(n,"innerBorderTop"),this.cachedFixedRowsTop=r.getSetting("fixedRowsTop"),s=e||0===r.getSetting("totalRows")?((0,c.addClass)(n,"innerBorderTop"),!t):((0,c.removeClass)(n,"innerBorderTop"),t))),s}}t.TopOverlay=l},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(542))),o=n(r(587)),n=n(r(572)),s=r(482),a=r(539);class l extends i.default{constructor(e,t,r,n){super(e,t,r,n,a.CLONE_TOP)}}(0,s.mixin)(l,o.default),(0,s.mixin)(l,n.default);t.default=l},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),n(r(487))),o=r(334),s=r(482);t.default=class{constructor(r){(0,i.default)(this,"settings",{}),(0,i.default)(this,"defaults",Object.freeze(this.getDefaults())),(0,s.objectEach)(this.defaults,(e,t)=>{if(void 0!==r[t])this.settings[t]=r[t];else{if(void 0===e)throw new Error(`A required setting "${t}" was not provided`);this.settings[t]=e}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>0<this.getSetting("fixedColumnsStart")||0<this.getSetting("rowHeaders").length,shouldRenderTopOverlay:()=>0<this.getSetting("fixedRowsTop")||0<this.getSetting("columnHeaders").length,shouldRenderBottomOverlay:()=>0<this.getSetting("fixedRowsBottom"),minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,t,r)=>{e=this.getSetting("data",e,t);(0,o.fastInnerText)(r,null==e?"":e)},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,t){return void 0===t?(0,s.objectEach)(e,(e,t)=>{this.settings[t]=e}):this.settings[e]=t,this}getSetting(e,t,r,n,i){return"function"==typeof this.settings[e]?this.settings[e](t,r,n,i):void 0!==t&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}},(e,t,r)=>{"use strict";var n=r(197),u=(t.__esModule=!0,r(334)),i=n(r(542)),o=n(r(575)),n=n(r(572)),r=r(482);class s extends i.default{constructor(e,t,r,n){super(e,t,r,n,"master")}alignOverlaysWithTrimmingContainer(){var t=(0,u.getTrimmingContainer)(this.wtRootElement),r=this.domBindings["rootWindow"];if(t===r)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{var n=t.parentElement,i=(0,u.getStyle)(t,"height",r),o=(0,u.getStyle)(t,"overflow",r),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=t,c=t.offsetWidth;let e=t.offsetHeight;n&&["auto","hidden","scroll"].includes(o)&&((o=t.cloneNode(!1)).style.overflow="auto",o.style.position="absolute",t.nextElementSibling?n.insertBefore(o,t.nextElementSibling):n.appendChild(o),t=parseInt((0,u.getComputedStyle)(o,r).height,10),n.removeChild(o),0===t)&&(e=0),e=Math.min(e,l),s.height="auto"===i?"auto":e+"px",c=Math.min(c,a),s.width=c+"px",s.overflow="",this.hasTableHeight="auto"===s.height||0<e,this.hasTableWidth=0<c}this.isTableVisible=(0,u.isVisible)(this.TABLE)}markOversizedColumnHeaders(){var e=this["wtSettings"],t=this.dataAccessObject["wtViewport"],r=e.getSetting("columnHeaders").length;if(r&&!t.hasOversizedColumnHeadersMarked.master){var n=e.getSetting("rowHeaders").length,i=this.getRenderedColumnsCount();for(let e=0;e<r;e++)for(let e=-1*n;e<i;e++)this.markIfOversizedColumnHeader(e);t.hasOversizedColumnHeadersMarked.master=!0}}}(0,r.mixin)(s,o.default),(0,r.mixin)(s,n.default);t.default=s},(e,t,r)=>{"use strict";t.__esModule=!0;var u=r(334),n=r(482),d=r(519);t.default=class{constructor(e,t,r,n,i){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=t,this.wtSettings=r,this.wtTable=i,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>new(this.wtSettings.getSetting("renderAllRows")?d.RenderedAllRowsCalculationType:d.RenderedRowsCalculationType)],["fullyVisible",()=>new d.FullyVisibleRowsCalculationType],["partiallyVisible",()=>new d.PartiallyVisibleRowsCalculationType]]),this.columnsCalculatorTypes=new Map([["rendered",()=>new(this.wtSettings.getSetting("renderAllColumns")?d.RenderedAllColumnsCalculationType:d.RenderedColumnsCalculationType)],["fullyVisible",()=>new d.FullyVisibleColumnsCalculationType],["partiallyVisible",()=>new d.PartiallyVisibleColumnsCalculationType]]),this.eventManager=n,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){var e=this.domBindings.rootDocument,t=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return r=t===this.domBindings.rootWindow?e.documentElement.clientHeight:0<(0,u.outerHeight)(t)&&0<t.clientHeight?t.clientHeight:1/0}getWorkspaceWidth(){var e=this["wtSettings"],{rootDocument:t,rootWindow:r}=this.domBindings,n=this.dataAccessObject.inlineStartOverlayTrimmingContainer,i=t.documentElement.offsetWidth,o=e.getSetting("totalColumns"),s=e.getSetting("preventOverflow"),a=e.getSetting("rtlMode"),l=this.wtTable.TABLE.getBoundingClientRect(),a=i-(a?l.right-i:l.left);let c;return s?(0,u.outerWidth)(this.wtTable.wtRootElement):(c=e.getSetting("freezeOverlays")?Math.min(a,i):Math.min(this.getContainerFillWidth(),a,i),n===r&&0<o&&this.sumColumnWidths(0,o-1)>c?t.documentElement.clientWidth:n===r||"scroll"!==(l=(0,u.getStyle)(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",r))&&"hidden"!==l&&"auto"!==l?"none"!==(s=e.getSetting("stretchH"))&&s?c:Math.max(c,(0,u.outerWidth)(this.wtTable.TABLE)):Math.max(c,n.clientWidth))}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,t){let r=0,n=e;for(;n<t;)r+=this.wtTable.getColumnWidth(n),n+=1;return r}getContainerFillWidth(){var e,t,r;return this.containerWidth||(e=this.wtTable.holder,(t=this.domBindings.rootDocument.createElement("div")).style.width="100%",t.style.height="1px",e.appendChild(t),r=t.offsetWidth,this.containerWidth=r,e.removeChild(t),r)}getWorkspaceOffset(){return(0,u.offset)(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=(0,u.outerHeight)(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();var t;return e!==1/0&&0<(t=this.getColumnHeaderHeight())&&(e-=t),e}getRowHeaderWidth(){var r=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(r)for(let e=this.rowHeaderWidth=0,t=n.length;e<t;e++)this.rowHeaderWidth+=r[e]||r;if(isNaN(this.rowHeaderWidth))if(n.length){let r=this.wtTable.TABLE.querySelector("TH");for(let e=this.rowHeaderWidth=0,t=n.length;e<t;e++)r?(this.rowHeaderWidth+=(0,u.outerWidth)(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){var e,t=this.getWorkspaceWidth();return t!==1/0&&0<(e=this.getRowHeaderWidth())?t-e:t}createRowsCalculator(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:t,wtTable:r}=this;let n=this.getViewportHeight(),i,o,s=(this.rowHeaderWidth=NaN,this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset);var a=t.getSetting("fixedRowsTop"),l=t.getSetting("fixedRowsBottom"),c=t.getSetting("totalRows");return a&&0<=s&&(o=this.dataAccessObject.topOverlay.sumCellSizes(0,a),s+=o,n-=o),l&&this.dataAccessObject.bottomOverlay.clone&&(o=this.dataAccessObject.bottomOverlay.sumCellSizes(c-l,c),n-=o),i=r.holder.clientHeight===r.holder.offsetHeight?0:(0,u.getScrollbarWidth)(this.domBindings.rootDocument),new d.ViewportRowsCalculator({calculationTypes:e.map(e=>[e,this.rowsCalculatorTypes.get(e)()]),viewportHeight:n,scrollOffset:s,totalRows:t.getSetting("totalRows"),rowHeightFn:e=>r.getRowHeight(e),overrideFn:t.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:i})}createColumnsCalculator(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:t,wtTable:r}=this;let n=this.getViewportWidth(),i=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;var o=t.getSetting("fixedColumnsStart");return o&&0<=i&&(o=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,o),i+=o,n-=o),r.holder.clientWidth!==r.holder.offsetWidth&&(n-=(0,u.getScrollbarWidth)(this.domBindings.rootDocument)),new d.ViewportColumnsCalculator({calculationTypes:e.map(e=>[e,this.columnsCalculatorTypes.get(e)()]),viewportWidth:n,scrollOffset:i,totalColumns:t.getSetting("totalColumns"),columnWidthFn:e=>r.getColumnWidth(e),overrideFn:t.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];var t,r=this["wtSettings"],n=this.createRowsCalculator(),i=this.createColumnsCalculator();return e&&!r.getSetting("renderAllRows")&&(t=n.getResultsFor("fullyVisible"),e=this.areAllProposedVisibleRowsAlreadyRendered(t)),e&&!r.getSetting("renderAllColumns")&&(t=i.getResultsFor("fullyVisible"),e=this.areAllProposedVisibleColumnsAlreadyRendered(t)),e||(this.rowsRenderCalculator=n.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=n.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){var e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),t=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=t.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=t.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:t,endRow:r}=e;if(null===t&&null===r){if(!e.isVisibleInTrimmingContainer)return!0;t=this.rowsPartiallyVisibleCalculator.startRow,r=this.rowsPartiallyVisibleCalculator.endRow}var{startRow:e,endRow:n}=this.rowsRenderCalculator;return!(t<e||t===e&&0<t||r>n||r===n&&r<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:t,endColumn:r}=e;if(null===t&&null===r){if(!e.isVisibleInTrimmingContainer)return!0;t=this.columnsPartiallyVisibleCalculator.startColumn,r=this.columnsPartiallyVisibleCalculator.endColumn}var{startColumn:e,endColumn:n}=this.columnsRenderCalculator;return!(t<e||t===e&&0<t||r>n||r===n&&r<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){(0,n.objectEach)(this.hasOversizedColumnHeadersMarked,(e,t,r)=>{r[t]=void 0})}}},(e,t,r)=>{"use strict";t.__esModule=!0,t.handleMouseEvent=function(e,t){var{coords:t,selection:r,controller:n,cellCoordsFactory:i}=t;s.get(e.type)({coords:t,selection:r,controller:n,cellCoordsFactory:i,isShiftKey:e.shiftKey,isLeftClick:(0,o.isLeftClick)(e)||"touchstart"===e.type,isRightClick:(0,o.isRightClick)(e)})},t.mouseDown=n,t.mouseOver=i;var o=r(492);function n(e){var{isShiftKey:e,isLeftClick:t,isRightClick:r,coords:n,selection:i,controller:o,cellCoordsFactory:s}=e,a=i.isSelected()?i.getSelectedRange().current():null,l=i.isSelectedByCorner(),c=i.isSelectedByRowHeader();i.markSource("mouse"),e&&a?0<=n.row&&0<=n.col&&!o.cell?i.setRangeEnd(n):(l||c)&&0<=n.row&&0<=n.col&&!o.cell?i.setRangeEnd(s(n.row,n.col)):l&&n.row<0&&!o.column?i.setRangeEnd(s(a.to.row,n.col)):c&&n.col<0&&!o.row?i.setRangeEnd(s(n.row,a.to.col)):(!l&&!c&&n.col<0||l&&n.col<0)&&!o.row?i.selectRows(Math.max(a.from.row,0),n.row,n.col):(!l&&!c&&n.row<0||c&&n.row<0)&&!o.column&&i.selectColumns(Math.max(a.from.col,0),n.col,n.row):(e=!i.inInSelection(n),s=t||r&&e,n.row<0&&0<=n.col&&!o.column?s&&i.selectColumns(n.col,n.col,n.row):n.col<0&&0<=n.row&&!o.row?s&&i.selectRows(n.row,n.row,n.col):0<=n.col&&0<=n.row&&!o.cell?s&&i.setRangeStart(n):n.col<0&&n.row<0&&i.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})),i.markEndSource()}function i(e){var t,r,n,{isLeftClick:e,coords:i,selection:o,controller:s,cellCoordsFactory:a}=e;e&&(e=o.isSelectedByRowHeader(),t=o.isSelectedByColumnHeader(),r=o.tableProps.countCols(),n=o.tableProps.countRows(),o.markSource("mouse"),t&&!s.column?o.setRangeEnd(a(n-1,i.col)):e&&!s.row?o.setRangeEnd(a(i.row,r-1)):s.cell||o.setRangeEnd(i),o.markEndSource())}const s=new Map([["mousedown",n],["mouseover",i],["touchstart",n]])},(e,t)=>{"use strict";t.__esModule=!0,t.hasValidParameter=function(e){return e===n},t.isRootInstance=function(e){return r.has(e)},t.registerAsRootInstance=function(e){r.set(e,!0)};const r=t.holder=new WeakMap,n=t.rootInstanceSymbol=Symbol("rootInstance")},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(286),n(r(487))),u=r(482),o=r(596),s=r(478),d=r(512),h=r(480);t.default=class{constructor(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];(0,i.default)(this,"hot",void 0),(0,i.default)(this,"data",void 0),(0,i.default)(this,"dataType","array"),(0,i.default)(this,"colToProp",()=>{}),(0,i.default)(this,"propToCol",()=>{}),this.hot=e,this.data=t}modifyRowData(e){let t;return void 0===(t=this.hot.hasHook("modifyRowData")?this.hot.runHooks("modifyRowData",e):t)||Number.isInteger(t)?this.data[e]:t}getData(){return this.data&&0!==this.data.length?this.getByRange(null,null,0<arguments.length&&void 0!==arguments[0]&&arguments[0]):this.data}setData(e){this.data=e}getAtColumn(r){const n=[];return(0,s.arrayEach)(this.data,(e,t)=>{t=this.getAtCell(t,r);n.push(t)}),n}getAtRow(n,r,i){let o=3<arguments.length&&void 0!==arguments[3]&&arguments[3];var e=void 0===r&&void 0===i;const s=this.hot.getSettings()["dataDotNotation"];let a=null,l=null;if(a=this.modifyRowData(n),Array.isArray(a))l=[],e?a.forEach((e,t)=>{l[t]=this.getAtPhysicalCell(n,t,a)}):(0,d.rangeEach)(r,i,e=>{l[e-r]=this.getAtPhysicalCell(n,e,a)});else if((0,u.isObject)(a)||(0,h.isFunction)(a))if(l=o?[]:{},!e||o){const c=this.countFirstRowKeys()-1;(0,d.rangeEach)(0,c,e=>{var t=this.colToProp(e);(r||0)<=e&&e<=(i||c)&&!Number.isInteger(t)&&(e=this.getAtPhysicalCell(n,t,a),o?l.push(e):s?(0,u.setProperty)(l,t,e):l[t]=e)})}else(0,u.objectEach)(a,(e,t)=>{var r=this.getAtPhysicalCell(n,t,a);s?(0,u.setProperty)(l,t,r):l[t]=r});return l}setAtCell(e,t,r){var n;e>=this.countRows()||t>=this.countFirstRowKeys()||(this.hot.hasHook("modifySourceData")&&(n=(0,u.createObjectPropListener)(r),this.hot.runHooks("modifySourceData",e,t,n,"set"),n.isTouched())&&(r=n.value),Number.isInteger(t)?this.data[e][t]=r:(0,u.setProperty)(this.data[e],t,r))}getAtPhysicalCell(e,t,r){let n=null;var i;return r&&(n="string"==typeof t?(i=this.hot.getSettings()["dataDotNotation"],i?(0,u.getProperty)(r,t):r[t]):"function"==typeof t?t(r):r[t]),n=this.hot.hasHook("modifySourceData")&&(i=(0,u.createObjectPropListener)(n),this.hot.runHooks("modifySourceData",e,t,i,"get"),i.isTouched())?i.value:n}getAtCell(e,t){var r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(t),r)}getByRange(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;let r=2<arguments.length&&void 0!==arguments[2]&&arguments[2],n=!1,i=null,o=null,s=null,a=null;null===e||null===t?(n=!0,i=0,s=this.countRows()-1):(i=Math.min(e.row,t.row),o=Math.min(e.col,t.col),s=Math.max(e.row,t.row),a=Math.max(e.col,t.col));const l=[];return(0,d.rangeEach)(i,s,e=>{l.push(n?this.getAtRow(e,void 0,void 0,r):this.getAtRow(e,o,a,r))}),l}countRows(){if(this.hot.hasHook("modifySourceLength")){var e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return(0,o.countFirstRowKeys)(this.data)}destroy(){this.data=null,this.hot=null}}},(e,t,r)=>{"use strict";t.__esModule=!0,t.countFirstRowKeys=function(e){let t=0;Array.isArray(e)&&(e[0]&&Array.isArray(e[0])?t=e[0].length:e[0]&&(0,n.isObject)(e[0])&&(t=(0,n.deepObjectSize)(e[0])));return t},t.createEmptySpreadsheetData=function(t,r){var n=[];var i;for(let e=0;e<t;e++){i=[];for(let e=0;e<r;e++)i.push("");n.push(i)}return n},t.createSpreadsheetData=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:100,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:4;var r=[];let n,i;for(n=0;n<e;n++){var o=[];for(i=0;i<t;i++)o.push(s(i)+(n+1));r.push(o)}return r},t.createSpreadsheetObjectData=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:100,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:4;var r=[];let n,i;for(n=0;n<e;n++){var o={};for(i=0;i<t;i++)o["prop"+i]=s(i)+(n+1);r.push(o)}return r},t.dataRowToChangesArray=function(e){let n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,t=e;const i=[];Array.isArray(e)&&Array.isArray(e[0])||(t=[e]);return t.forEach((t,r)=>{Array.isArray(t)?t.forEach((e,t)=>{i.push([r+n,t,e])}):Object.keys(t).forEach(e=>{i.push([r+n,e,t[e]])})}),i},t.isArrayOfArrays=function(e){return!!(Array.isArray(e)&&e.length&&e.every(e=>Array.isArray(e)))},t.isArrayOfObjects=function(e){return!!(Array.isArray(e)&&e.length&&e.every(e=>"object"==typeof e&&!Array.isArray(e)&&null!==e))},t.spreadsheetColumnIndex=function(r){let n=0;if(r)for(let e=0,t=r.length-1;e<r.length;e+=1,--t)n+=o**t*(i.indexOf(r[e])+1);return--n},t.spreadsheetColumnLabel=s,r(286);var n=r(482);const i="ABCDEFGHIJKLMNOPQRSTUVWXYZ",o=i.length;function s(e){let t=e+1,r="";for(var n;0<t;)n=(t-1)%o,r=String.fromCharCode(65+n)+r,t=parseInt((t-n)/o,10);return r}},(e,t,r)=>{"use strict";var n={IndexMapper:t.__esModule=!0,getRegisteredMapsCounter:!0,getIncreasedIndexes:!0,getDecreasedIndexes:!0,alterUtilsFactory:!0},i=r(598),i=(t.IndexMapper=i.IndexMapper,r(612)),i=(t.getRegisteredMapsCounter=i.getRegisteredMapsCounter,r(609)),o=(t.getIncreasedIndexes=i.getIncreasedIndexes,t.getDecreasedIndexes=i.getDecreasedIndexes,t.alterUtilsFactory=i.alterUtilsFactory,r(599));Object.keys(o).forEach(function(e){"default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(n,e)||e in t&&t[e]===o[e]||(t[e]=o[e])})},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(487))),a=(r(204),r(290),r(302),r(305),r(309),r(312),r(315),r(318),r(478)),l=r(599),o=r(610),n=n(r(578)),s=r(482),c=r(337),u=r(613);new Set;class d{constructor(){(0,i.default)(this,"indexesSequence",new l.IndexesSequence),(0,i.default)(this,"trimmingMapsCollection",new o.AggregatedCollection(e=>e.some(e=>!0===e),!1)),(0,i.default)(this,"hidingMapsCollection",new o.AggregatedCollection(e=>e.some(e=>!0===e),!1)),(0,i.default)(this,"variousMapsCollection",new o.MapCollection),(0,i.default)(this,"hidingChangesObservable",new u.ChangesObservable({initialIndexValue:!1})),(0,i.default)(this,"notTrimmedIndexesCache",[]),(0,i.default)(this,"notHiddenIndexesCache",[]),(0,i.default)(this,"isBatched",!1),(0,i.default)(this,"indexesSequenceChanged",!1),(0,i.default)(this,"indexesChangeSource",void 0),(0,i.default)(this,"trimmedIndexesChanged",!1),(0,i.default)(this,"hiddenIndexesChanged",!1),(0,i.default)(this,"renderablePhysicalIndexesCache",[]),(0,i.default)(this,"fromPhysicalToVisualIndexesCache",new Map),(0,i.default)(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if("hiding"!==e)throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,t,r){return this.registerMap(e,(0,l.createIndexMap)(t,r))}registerMap(e,t){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);(t instanceof l.TrimmingMap?this.trimmingMapsCollection:t instanceof l.HidingMap?this.hidingMapsCollection:this.variousMapsCollection).register(e,t);e=this.getNumberOfIndexes();return 0<e&&t.init(e),t}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){e=this.notTrimmedIndexesCache[e];return(0,c.isDefined)(e)?e:null}getPhysicalFromRenderableIndex(e){e=this.renderablePhysicalIndexesCache[e];return(0,c.isDefined)(e)?e:null}getVisualFromPhysicalIndex(e){e=this.fromPhysicalToVisualIndexesCache.get(e);return(0,c.isDefined)(e)?e:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){e=this.fromVisualToRenderableIndexesCache.get(e);return(0,c.isDefined)(e)?e:null}getNearestNotHiddenIndex(t,e){var r=2<arguments.length&&void 0!==arguments[2]&&arguments[2];if(null===this.getPhysicalFromVisualIndex(t))return null;if(this.fromVisualToRenderableIndexesCache.has(t))return t;var n=Array.from(this.fromVisualToRenderableIndexesCache.keys());let i=-1;return-1===(i=0<e?n.findIndex(e=>t<e):n.reverse().findIndex(e=>e<t))?r?this.getNearestNotHiddenIndex(t,-e,!1):null:n[i]}initToLength(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(t){var e,r=this.getNumberOfIndexes();t<r?(e=[...Array(this.getNumberOfIndexes()-t).keys()].map(e=>e+t),this.removeIndexes(e)):this.insertIndexes(r,t-r)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){void 0===this.indexesChangeSource&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),"update"===this.indexesChangeSource&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return!0===(!(0<arguments.length&&void 0!==arguments[0])||arguments[0])?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(e=>!1===this.isTrimmed(e))}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return!0===(!(0<arguments.length&&void 0!==arguments[0])||arguments[0])?this.notHiddenIndexesCache:this.getIndexesSequence().filter(e=>!1===this.isHidden(e))}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return!0===(!(0<arguments.length&&void 0!==arguments[0])||arguments[0])?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(e=>!1===this.isHidden(e))}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,t){var r=(0,a.arrayMap)(e="number"==typeof e?[e]:e,e=>this.getPhysicalFromVisualIndex(e)),n=this.getNotTrimmedIndexesLength(),e=e.length,i=(0,l.getListWithRemovedItems)(this.getIndexesSequence(),r),o=i.filter(e=>!1===this.isTrimmed(e));let s=i.indexOf(o[o.length-1])+1;t+e<n&&(e=o[t],s=i.indexOf(e)),this.indexesChangeSource="move",this.setIndexesSequence((0,l.getListWithInsertedItems)(i,s,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,t){var e=this.getNotTrimmedIndexes()[e],r=(0,c.isDefined)(e)?e:this.getNumberOfIndexes(),e=this.getIndexesSequence().includes(e)?this.getIndexesSequence().indexOf(e):this.getNumberOfIndexes(),t=(0,a.arrayMap)(new Array(t).fill(r),(e,t)=>e+t);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(e,t),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(e,t),this.hidingMapsCollection.insertToEvery(e,t),this.variousMapsCollection.insertToEvery(e,t),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){var e=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(!0===(0<arguments.length&&void 0!==arguments[0]&&arguments[0])||!1===this.isBatched&&!0===e)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){var t=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let e=0;e<t;e+=1){var r=this.getPhysicalFromVisualIndex(e);this.fromPhysicalToVisualIndexesCache.set(r,e)}}cacheFromVisualToRenderableIndexes(){var t=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let e=0;e<t;e+=1){var r=this.getPhysicalFromRenderableIndex(e),r=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(r,e)}}}t.IndexMapper=d,(0,s.mixin)(d,n.default)},(e,t,r)=>{"use strict";var n={createIndexMap:t.__esModule=!0,HidingMap:!0,IndexMap:!0,LinkedPhysicalIndexToValueMap:!0,PhysicalIndexToValueMap:!0,TrimmingMap:!0},i=(t.createIndexMap=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if(d.has(e))return new(d.get(e))(t);throw new Error(`The provided map type ("${e}") does not exist.`)},r(204),r(600)),o=(t.HidingMap=i.HidingMap,r(602)),s=(t.IndexMap=o.IndexMap,r(604)),a=(t.LinkedPhysicalIndexToValueMap=s.LinkedPhysicalIndexToValueMap,r(601)),l=(t.PhysicalIndexToValueMap=a.PhysicalIndexToValueMap,r(607)),c=(t.TrimmingMap=l.TrimmingMap,r(608)),u=(Object.keys(c).forEach(function(e){"default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(n,e)||e in t&&t[e]===c[e]||(t[e]=c[e])}),r(605));Object.keys(u).forEach(function(e){"default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(n,e)||e in t&&t[e]===u[e]||(t[e]=u[e])});const d=new Map([["hiding",i.HidingMap],["index",o.IndexMap],["linkedPhysicalIndexToValue",s.LinkedPhysicalIndexToValueMap],["physicalIndexToValue",a.PhysicalIndexToValueMap],["trimming",l.TrimmingMap]])},(e,t,r)=>{"use strict";t.__esModule=!0,r(286);var n=r(601),i=r(478);class o extends n.PhysicalIndexToValueMap{constructor(){super(0<arguments.length&&void 0!==arguments[0]&&arguments[0])}getHiddenIndexes(){return(0,i.arrayReduce)(this.getValues(),(e,t,r)=>(t&&e.push(r),e),[])}}t.HidingMap=o},(e,t,r)=>{"use strict";t.__esModule=!0;var n=r(602),i=r(603);class o extends n.IndexMap{insert(e,t){this.indexedValues=(0,i.getListWithInsertedItems)(this.indexedValues,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){this.indexedValues=(0,i.getListWithRemovedItems)(this.indexedValues,e),super.remove(e)}}t.PhysicalIndexToValueMap=o},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(286),n(r(487))),o=r(512),s=r(482),a=r(480),n=n(r(578));class l{constructor(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;(0,i.default)(this,"indexedValues",[]),(0,i.default)(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){var t=this.indexedValues;if(e<t.length)return t[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,t){return e<this.indexedValues.length&&(this.indexedValues[e]=t,this.runLocalHooks("change"),!0)}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;(this.indexedValues.length=0,a.isFunction)(this.initValueOrFn)?(0,o.rangeEach)(e-1,e=>this.indexedValues.push(this.initValueOrFn(e))):(0,o.rangeEach)(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}t.IndexMap=l,(0,s.mixin)(l,n.default)},(e,t,r)=>{"use strict";t.__esModule=!0,t.getListWithInsertedItems=function(e,t,r,n){var i=r.length?r[0]:void 0;return[...e.slice(0,i),...r.map((e,t)=>(0,o.isFunction)(n)?n(e,t):n),...void 0===i?[]:e.slice(i)]},t.getListWithRemovedItems=function(e,r){return(0,n.arrayFilter)(e,(e,t)=>!1===r.includes(t))};var o=r(480),n=r(478)},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(487))),n=r(602),o=r(603),s=r(605),a=r(606),l=r(480);class c extends n.IndexMap{constructor(){super(...arguments),(0,i.default)(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length&&(this.indexedValues[e]=t,!1===this.orderOfIndexes.includes(e)&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0)}clearValue(e){this.orderOfIndexes=(0,s.getListWithRemovedItems)(this.orderOfIndexes,[e]),(0,l.isFunction)(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,t){this.indexedValues=(0,o.getListWithInsertedItems)(this.indexedValues,e,t,this.initValueOrFn),this.orderOfIndexes=(0,a.getIncreasedIndexes)(this.orderOfIndexes,t),super.insert(e,t)}remove(e){this.indexedValues=(0,o.getListWithRemovedItems)(this.indexedValues,e),this.orderOfIndexes=(0,s.getListWithRemovedItems)(this.orderOfIndexes,e),this.orderOfIndexes=(0,a.getDecreasedIndexes)(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}t.LinkedPhysicalIndexToValueMap=c},(e,t,r)=>{"use strict";t.__esModule=!0,t.getListWithInsertedItems=function(e,t,r){return[...e.slice(0,t),...r,...e.slice(t)]},t.getListWithRemovedItems=function(e,t){return(0,n.arrayFilter)(e,e=>!1===t.includes(e))};var n=r(478)},(e,t,r)=>{"use strict";t.__esModule=!0,t.getDecreasedIndexes=function(e,r){return(0,i.arrayMap)(e,t=>t-r.filter(e=>e<t).length)},t.getIncreasedIndexes=function(e,t){const r=t[0],n=t.length;return(0,i.arrayMap)(e,e=>e>=r?e+n:e)};var i=r(478)},(e,t,r)=>{"use strict";t.__esModule=!0,r(286);var n=r(601),i=r(478);class o extends n.PhysicalIndexToValueMap{constructor(){super(0<arguments.length&&void 0!==arguments[0]&&arguments[0])}getTrimmedIndexes(){return(0,i.arrayReduce)(this.getValues(),(e,t,r)=>(t&&e.push(r),e),[])}}t.TrimmingMap=o},(e,t,r)=>{"use strict";t.__esModule=!0;var n=r(602),i=r(605),o=r(609);class s extends n.IndexMap{constructor(){super(e=>e)}insert(e,t){var r=(0,o.getIncreasedIndexes)(this.indexedValues,t);this.indexedValues=(0,i.getListWithInsertedItems)(r,e,t),super.insert(e,t)}remove(e){var t=(0,i.getListWithRemovedItems)(this.indexedValues,e);this.indexedValues=(0,o.getDecreasedIndexes)(t,e),super.remove(e)}}t.IndexesSequence=s},(e,t,r)=>{"use strict";t.__esModule=!0,r(204);var n=r(606),n=(t.getDecreasedIndexes=n.getDecreasedIndexes,t.getIncreasedIndexes=n.getIncreasedIndexes,r(605)),r=r(603);const i=new Map([["indexesSequence",{getListWithInsertedItems:n.getListWithInsertedItems,getListWithRemovedItems:n.getListWithRemovedItems}],["physicallyIndexed",{getListWithInsertedItems:r.getListWithInsertedItems,getListWithRemovedItems:r.getListWithRemovedItems}]]);t.alterUtilsFactory=e=>{if(!1===i.has(e))throw new Error(`Alter strategy with ID '${e}' does not exist.`);return i.get(e)}},(e,t,r)=>{"use strict";t.__esModule=!0;var n=r(611),i=(Object.keys(n).forEach(function(e){"default"===e||"__esModule"===e||e in t&&t[e]===n[e]||(t[e]=n[e])}),r(612));Object.keys(i).forEach(function(e){"default"===e||"__esModule"===e||e in t&&t[e]===i[e]||(t[e]=i[e])})},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(286),n(r(487))),n=r(612),o=r(478),s=r(337);class a extends n.MapCollection{constructor(e,t){super(),(0,i.default)(this,"mergedValuesCache",[]),(0,i.default)(this,"aggregationFunction",void 0),(0,i.default)(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=t}getMergedValues(){if(!0===(!(0<arguments.length&&void 0!==arguments[0])||arguments[0]))return this.mergedValuesCache;if(0===this.getLength())return[];var r=(0,o.arrayMap)(this.get(),e=>e.getValues()),e=[],n=(0,s.isDefined)(r[0])&&r[0].length||0;for(let t=0;t<n;t+=1){var i=[];for(let e=0;e<this.getLength();e+=1)i.push(r[e][t]);e.push(i)}return(0,o.arrayMap)(e,this.aggregationFunction)}getMergedValueAtIndex(e,t){t=this.getMergedValues(t)[e];return(0,s.isDefined)(t)?t:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}t.AggregatedCollection=a},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,t.getRegisteredMapsCounter=function(){return a},n(r(487))),o=r(337),s=r(482),n=n(r(578));let a=0;class l{constructor(){(0,i.default)(this,"collection",new Map)}register(e,t){!1===this.collection.has(e)&&(this.collection.set(e,t),t.addLocalHook("change",()=>this.runLocalHooks("change",t)),a+=1)}unregister(e){var t=this.collection.get(e);(0,o.isDefined)(t)&&(t.destroy(),this.collection.delete(e),this.runLocalHooks("change",t),--a)}unregisterAll(){this.collection.forEach((e,t)=>this.unregister(t)),this.collection.clear()}get(e){return(0,o.isUndefined)(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(t){this.collection.forEach(e=>{e.remove(t)})}insertToEvery(t,r){this.collection.forEach(e=>{e.insert(t,r)})}initEvery(t){this.collection.forEach(e=>{e.init(t)})}}t.MapCollection=l,(0,s.mixin)(l,n.default)},(e,t,r)=>{"use strict";t.__esModule=!0,r(204),r(290),r(302),r(305),r(309),r(312),r(315),r(318);var n=r(614),i=r(615);function o(e,t,r){var n=e;if(t.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object");t.set(e,r)}function s(e,t){return e.get(l(e,t))}function a(e,t,r){e.set(l(e,t),r)}function l(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var c=new WeakMap,u=new WeakMap,d=new WeakMap,h=new WeakMap,p=new WeakMap;t.ChangesObservable=class{constructor(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})["initialIndexValue"];o(this,c,new Set),o(this,u,[]),o(this,d,[]),o(this,h,!1),o(this,p,!1),a(p,this,null!=e&&e)}createObserver(){const e=new n.ChangesObserver;return s(c,this).add(e),e.addLocalHook("unsubscribe",()=>{s(c,this).delete(e)}),e._writeInitialChanges((0,i.arrayDiff)(s(u,this),s(d,this))),e}emit(e){let t=s(d,this);s(h,this)&&s(u,this).length===e.length||(0===e.length?e=new Array(t.length).fill(s(p,this)):a(u,this,new Array(e.length).fill(s(p,this))),s(h,this))||(a(h,this,!0),t=s(u,this));const r=(0,i.arrayDiff)(t,e);s(c,this).forEach(e=>e._write(r)),a(d,this,e)}}},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),r(482)),n=n(r(578));function o(e,t,r){var n=e;if(t.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object");t.set(e,r)}function s(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var a=new WeakMap;class l{constructor(){o(this,a,[])}subscribe(e){return this.addLocalHook("change",e),this._write((e=this,a.get(s(a,e)))),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return 0<e.length&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){var t;t=this,e=e,a.set(s(a,t),e)}}t.ChangesObserver=l,(0,i.mixin)(l,n.default)},(e,t,r)=>{"use strict";t.__esModule=!0,t.arrayDiff=function(e,t){var r=[];let n=0,i=0;for(;n<e.length&&i<t.length;n++,i++)e[n]!==t[i]&&r.push({op:"replace",index:i,oldValue:e[n],newValue:t[i]});for(;n<t.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:t[n]});for(;i<e.length;i++)r.push({op:"remove",index:i,oldValue:e[i],newValue:void 0});return r},r(286)},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,t.getDefaultLanguageDictionary=function(){return u.default},t.getLanguageDictionary=v,t.getLanguagesDictionaries=function(){return m()},t.getTranslatedPhrase=function(e,t,r){e=v(e);if(null===e)return null;e=e[t];if((0,s.isUndefined)(e))return null;t=function(t,r){let n=t;return(0,o.arrayEach)((0,c.getPhraseFormatters)(),e=>{n=e(t,r)}),n}(e,r);if(Array.isArray(t))return t[0];return t},t.getValidLanguageCode=function(e){let t=(0,a.normalizeLanguageCode)(e);b(t)||(t=h,(0,a.warnUserAboutLanguageRegistration)(e));return t},t.hasLanguageDictionary=b,t.registerLanguageDictionary=y,r(482)),o=r(478),s=r(337),a=r(617),l=n(r(501)),c=r(618),u=n(r(620)),n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=d(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621));function d(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(d=function(e){return e?r:t})(e))}t.dictionaryKeys=n;const h=t.DEFAULT_LANGUAGE_CODE=u.default.languageCode,{register:p,getItem:f,hasItem:g,getValues:m}=(0,l.default)("languagesDictionaries");function y(e,t){let r=e,n=t;return(0,i.isObject)(e)&&(n=e,r=n.languageCode),t=r,e=n,t!==h&&(0,a.extendNotExistingKeys)(e,f(h)),p(r,(0,i.deepClone)(n)),(0,i.deepClone)(n)}function v(e){return b(e)?(0,i.deepClone)(f(e)):null}function b(e){return g(e)}y(u.default)},(e,t,r)=>{"use strict";t.__esModule=!0,t.createCellHeadersRange=function(e,t){let r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:e,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:t,[i,o]=[r,n];t<e&&([i,o]=[o,i]);return i+"-"+o},t.extendNotExistingKeys=function(r,e){return(0,i.objectEach)(e,(e,t)=>{(0,n.isUndefined)(r[t])&&(r[t]=e)}),r},t.normalizeLanguageCode=function(e){var t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(e);if(t)return t[1].toLowerCase()+"-"+t[2].toUpperCase();return e},t.warnUserAboutLanguageRegistration=function(e){(0,n.isDefined)(e)&&(0,o.error)((0,s.toSingleLine)`Language with code "${e}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)};var n=r(337),i=r(482),o=r(500),s=r(477)},(e,t,r)=>{"use strict";var n=r(197),t=(t.__esModule=!0,t.getPhraseFormatters=t.getAll=function(){return o()},t.registerPhraseFormatter=t.register=s,n(r(501))),n=n(r(619));const{register:i,getValues:o}=(0,t.default)("phraseFormatters");function s(e,t){i(e,t)}s("pluralize",n.default)},(e,t)=>{"use strict";t.__esModule=!0,t.default=function(e,t){var r=Array.isArray(e)&&Number.isInteger(t);if(r)return e[t];return e}},(e,t,r)=>{"use strict";t.__esModule=!0;r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621));function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}r={languageCode:"en-US",[r.CONTEXTMENU_ITEMS_NO_ITEMS]:"No available options",[r.CONTEXTMENU_ITEMS_ROW_ABOVE]:"Insert row above",[r.CONTEXTMENU_ITEMS_ROW_BELOW]:"Insert row below",[r.CONTEXTMENU_ITEMS_INSERT_LEFT]:"Insert column left",[r.CONTEXTMENU_ITEMS_INSERT_RIGHT]:"Insert column right",[r.CONTEXTMENU_ITEMS_REMOVE_ROW]:["Remove row","Remove rows"],[r.CONTEXTMENU_ITEMS_REMOVE_COLUMN]:["Remove column","Remove columns"],[r.CONTEXTMENU_ITEMS_UNDO]:"Undo",[r.CONTEXTMENU_ITEMS_REDO]:"Redo",[r.CONTEXTMENU_ITEMS_READ_ONLY]:"Read only",[r.CONTEXTMENU_ITEMS_CLEAR_COLUMN]:"Clear column",[r.CONTEXTMENU_ITEMS_ALIGNMENT]:"Alignment",[r.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT]:"Left",[r.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER]:"Center",[r.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT]:"Right",[r.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY]:"Justify",[r.CONTEXTMENU_ITEMS_ALIGNMENT_TOP]:"Top",[r.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE]:"Middle",[r.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM]:"Bottom",[r.CONTEXTMENU_ITEMS_FREEZE_COLUMN]:"Freeze column",[r.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN]:"Unfreeze column",[r.CONTEXTMENU_ITEMS_BORDERS]:"Borders",[r.CONTEXTMENU_ITEMS_BORDERS_TOP]:"Top",[r.CONTEXTMENU_ITEMS_BORDERS_RIGHT]:"Right",[r.CONTEXTMENU_ITEMS_BORDERS_BOTTOM]:"Bottom",[r.CONTEXTMENU_ITEMS_BORDERS_LEFT]:"Left",[r.CONTEXTMENU_ITEMS_REMOVE_BORDERS]:"Remove border(s)",[r.CONTEXTMENU_ITEMS_ADD_COMMENT]:"Add comment",[r.CONTEXTMENU_ITEMS_EDIT_COMMENT]:"Edit comment",[r.CONTEXTMENU_ITEMS_REMOVE_COMMENT]:"Delete comment",[r.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT]:"Read-only comment",[r.CONTEXTMENU_ITEMS_MERGE_CELLS]:"Merge cells",[r.CONTEXTMENU_ITEMS_UNMERGE_CELLS]:"Unmerge cells",[r.CONTEXTMENU_ITEMS_COPY]:"Copy",[r.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS]:["Copy with header","Copy with headers"],[r.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS]:["Copy with group header","Copy with group headers"],[r.CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY]:["Copy header only","Copy headers only"],[r.CONTEXTMENU_ITEMS_CUT]:"Cut",[r.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD]:"Insert child row",[r.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD]:"Detach from parent",[r.CONTEXTMENU_ITEMS_HIDE_COLUMN]:["Hide column","Hide columns"],[r.CONTEXTMENU_ITEMS_SHOW_COLUMN]:["Show column","Show columns"],[r.CONTEXTMENU_ITEMS_HIDE_ROW]:["Hide row","Hide rows"],[r.CONTEXTMENU_ITEMS_SHOW_ROW]:["Show row","Show rows"],[r.FILTERS_CONDITIONS_NONE]:"None",[r.FILTERS_CONDITIONS_EMPTY]:"Is empty",[r.FILTERS_CONDITIONS_NOT_EMPTY]:"Is not empty",[r.FILTERS_CONDITIONS_EQUAL]:"Is equal to",[r.FILTERS_CONDITIONS_NOT_EQUAL]:"Is not equal to",[r.FILTERS_CONDITIONS_BEGINS_WITH]:"Begins with",[r.FILTERS_CONDITIONS_ENDS_WITH]:"Ends with",[r.FILTERS_CONDITIONS_CONTAINS]:"Contains",[r.FILTERS_CONDITIONS_NOT_CONTAIN]:"Does not contain",[r.FILTERS_CONDITIONS_GREATER_THAN]:"Greater than",[r.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL]:"Greater than or equal to",[r.FILTERS_CONDITIONS_LESS_THAN]:"Less than",[r.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL]:"Less than or equal to",[r.FILTERS_CONDITIONS_BETWEEN]:"Is between",[r.FILTERS_CONDITIONS_NOT_BETWEEN]:"Is not between",[r.FILTERS_CONDITIONS_AFTER]:"After",[r.FILTERS_CONDITIONS_BEFORE]:"Before",[r.FILTERS_CONDITIONS_TODAY]:"Today",[r.FILTERS_CONDITIONS_TOMORROW]:"Tomorrow",[r.FILTERS_CONDITIONS_YESTERDAY]:"Yesterday",[r.FILTERS_VALUES_BLANK_CELLS]:"Blank cells",[r.FILTERS_DIVS_FILTER_BY_CONDITION]:"Filter by condition",[r.FILTERS_DIVS_FILTER_BY_VALUE]:"Filter by value",[r.FILTERS_LABELS_CONJUNCTION]:"And",[r.FILTERS_LABELS_DISJUNCTION]:"Or",[r.FILTERS_BUTTONS_SELECT_ALL]:"Select all",[r.FILTERS_BUTTONS_CLEAR]:"Clear",[r.FILTERS_BUTTONS_OK]:"OK",[r.FILTERS_BUTTONS_CANCEL]:"Cancel",[r.FILTERS_BUTTONS_PLACEHOLDER_SEARCH]:"Search",[r.FILTERS_BUTTONS_PLACEHOLDER_VALUE]:"Value",[r.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE]:"Second value",[r.CHECKBOX_CHECKED]:"Checked",[r.CHECKBOX_UNCHECKED]:"Unchecked"};t.default=r},(e,t)=>{"use strict";t.__esModule=!0;t.CONTEXT_MENU_ITEMS_NAMESPACE="ContextMenu:items";var r="ContextMenu:items",r=(t.CONTEXTMENU_ITEMS_NO_ITEMS=r+".noItems",t.CONTEXTMENU_ITEMS_ROW_ABOVE=r+".insertRowAbove",t.CONTEXTMENU_ITEMS_ROW_BELOW=r+".insertRowBelow",t.CONTEXTMENU_ITEMS_INSERT_LEFT=r+".insertColumnOnTheLeft",t.CONTEXTMENU_ITEMS_INSERT_RIGHT=r+".insertColumnOnTheRight",t.CONTEXTMENU_ITEMS_REMOVE_ROW=r+".removeRow",t.CONTEXTMENU_ITEMS_REMOVE_COLUMN=r+".removeColumn",t.CONTEXTMENU_ITEMS_UNDO=r+".undo",t.CONTEXTMENU_ITEMS_REDO=r+".redo",t.CONTEXTMENU_ITEMS_READ_ONLY=r+".readOnly",t.CONTEXTMENU_ITEMS_CLEAR_COLUMN=r+".clearColumn",t.CONTEXTMENU_ITEMS_COPY=r+".copy",t.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS=r+".copyWithHeaders",t.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS=r+".copyWithGroupHeaders",t.CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY=r+".copyHeadersOnly",t.CONTEXTMENU_ITEMS_CUT=r+".cut",t.CONTEXTMENU_ITEMS_FREEZE_COLUMN=r+".freezeColumn",t.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN=r+".unfreezeColumn",t.CONTEXTMENU_ITEMS_MERGE_CELLS=r+".mergeCells",t.CONTEXTMENU_ITEMS_UNMERGE_CELLS=r+".unmergeCells",t.CONTEXTMENU_ITEMS_ADD_COMMENT=r+".addComment",t.CONTEXTMENU_ITEMS_EDIT_COMMENT=r+".editComment",t.CONTEXTMENU_ITEMS_REMOVE_COMMENT=r+".removeComment",t.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT=r+".readOnlyComment",t.CONTEXTMENU_ITEMS_ALIGNMENT=r+".align",t.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT=r+".align.left",t.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER=r+".align.center",t.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT=r+".align.right",t.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY=r+".align.justify",t.CONTEXTMENU_ITEMS_ALIGNMENT_TOP=r+".align.top",t.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE=r+".align.middle",t.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM=r+".align.bottom",t.CONTEXTMENU_ITEMS_BORDERS=r+".borders",t.CONTEXTMENU_ITEMS_BORDERS_TOP=r+".borders.top",t.CONTEXTMENU_ITEMS_BORDERS_RIGHT=r+".borders.right",t.CONTEXTMENU_ITEMS_BORDERS_BOTTOM=r+".borders.bottom",t.CONTEXTMENU_ITEMS_BORDERS_LEFT=r+".borders.left",t.CONTEXTMENU_ITEMS_REMOVE_BORDERS=r+".borders.remove",t.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD=r+".nestedHeaders.insertChildRow",t.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD=r+".nestedHeaders.detachFromParent",t.CONTEXTMENU_ITEMS_HIDE_COLUMN=r+".hideColumn",t.CONTEXTMENU_ITEMS_SHOW_COLUMN=r+".showColumn",t.CONTEXTMENU_ITEMS_HIDE_ROW=r+".hideRow",t.CONTEXTMENU_ITEMS_SHOW_ROW=r+".showRow",t.FILTERS_NAMESPACE="Filters:"),n=t.FILTERS_CONDITIONS_NAMESPACE=r+"conditions",n=(t.FILTERS_CONDITIONS_NONE=n+".none",t.FILTERS_CONDITIONS_EMPTY=n+".isEmpty",t.FILTERS_CONDITIONS_NOT_EMPTY=n+".isNotEmpty",t.FILTERS_CONDITIONS_EQUAL=n+".isEqualTo",t.FILTERS_CONDITIONS_NOT_EQUAL=n+".isNotEqualTo",t.FILTERS_CONDITIONS_BEGINS_WITH=n+".beginsWith",t.FILTERS_CONDITIONS_ENDS_WITH=n+".endsWith",t.FILTERS_CONDITIONS_CONTAINS=n+".contains",t.FILTERS_CONDITIONS_NOT_CONTAIN=n+".doesNotContain",t.FILTERS_CONDITIONS_BY_VALUE=n+".byValue",t.FILTERS_CONDITIONS_GREATER_THAN=n+".greaterThan",t.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL=n+".greaterThanOrEqualTo",t.FILTERS_CONDITIONS_LESS_THAN=n+".lessThan",t.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL=n+".lessThanOrEqualTo",t.FILTERS_CONDITIONS_BETWEEN=n+".isBetween",t.FILTERS_CONDITIONS_NOT_BETWEEN=n+".isNotBetween",t.FILTERS_CONDITIONS_AFTER=n+".after",t.FILTERS_CONDITIONS_BEFORE=n+".before",t.FILTERS_CONDITIONS_TODAY=n+".today",t.FILTERS_CONDITIONS_TOMORROW=n+".tomorrow",t.FILTERS_CONDITIONS_YESTERDAY=n+".yesterday",t.FILTERS_DIVS_FILTER_BY_CONDITION=r+"labels.filterByCondition",t.FILTERS_DIVS_FILTER_BY_VALUE=r+"labels.filterByValue",t.FILTERS_LABELS_CONJUNCTION=r+"labels.conjunction",t.FILTERS_LABELS_DISJUNCTION=r+"labels.disjunction",t.FILTERS_VALUES_BLANK_CELLS=r+"values.blankCells",t.FILTERS_BUTTONS_SELECT_ALL=r+"buttons.selectAll",t.FILTERS_BUTTONS_CLEAR=r+"buttons.clear",t.FILTERS_BUTTONS_OK=r+"buttons.ok",t.FILTERS_BUTTONS_CANCEL=r+"buttons.cancel",t.FILTERS_BUTTONS_PLACEHOLDER_SEARCH=r+"buttons.placeholder.search",t.FILTERS_BUTTONS_PLACEHOLDER_VALUE=r+"buttons.placeholder.value",t.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE=r+"buttons.placeholder.secondValue",t.CHECKBOX_RENDERER_NAMESPACE="CheckboxRenderer:");t.CHECKBOX_CHECKED=n+"checked",t.CHECKBOX_UNCHECKED=n+"unchecked"},(e,t,r)=>{"use strict";var n=r(197),i={Selection:t.__esModule=!0,handleMouseEvent:!0,detectSelectionType:!0,normalizeSelectionFactory:!0},n=n(r(623)),n=(t.Selection=n.default,r(593)),n=(t.handleMouseEvent=n.handleMouseEvent,r(637)),o=(t.detectSelectionType=n.detectSelectionType,t.normalizeSelectionFactory=n.normalizeSelectionFactory,r(624));Object.keys(o).forEach(function(e){"default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(i,e)||e in t&&t[e]===o[e]||(t[e]=o[e])})},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),r(286),r(290),r(302),r(305),r(309),r(312),r(315),r(318),n(r(487))),f=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=m(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(624)),o=n(r(635)),s=r(482),a=r(337),u=r(512),g=r(478),l=n(r(578)),c=n(r(636)),d=r(637),h=r(477),p=r(479);function m(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(m=function(e){return e?r:t})(e))}function y(e,t,r){var n=e;if(t.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object");t.set(e,r)}function v(e,t){return e.get(w(e,t))}function b(e,t,r){e.set(w(e,t),r)}function w(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var C=new WeakMap,E=new WeakMap,T=new WeakMap,S=new WeakMap,_=new WeakMap,x=new WeakMap;class R{constructor(e,t){var n=this;(0,i.default)(this,"settings",void 0),(0,i.default)(this,"tableProps",void 0),(0,i.default)(this,"inProgress",!1),(0,i.default)(this,"selectedRange",new o.default((e,t,r)=>this.tableProps.createCellRange(e,t,r))),(0,i.default)(this,"highlight",void 0),y(this,C,void 0),y(this,E,void 0),(0,i.default)(this,"selectedByRowHeader",new Set),(0,i.default)(this,"selectedByColumnHeader",new Set),y(this,T,!1),y(this,S,!1),y(this,_,"unknown"),y(this,x,-1),this.settings=e,this.tableProps=t,this.highlight=new f.default({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[(0,p.A11Y_SELECTED)()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(e,t)=>this.tableProps.isDisabledCellSelection(e,t),cellCornerVisible:function(){return n.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible(...arguments)},visualToRenderableCoords:e=>this.tableProps.visualToRenderableCoords(e),renderableToVisualCoords:e=>this.tableProps.renderableToVisualCoords(e),createCellCoords:(e,t)=>this.tableProps.createCellCoords(e,t),createCellRange:(e,t,r)=>this.tableProps.createCellRange(e,t,r)}),b(C,this,new c.default(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:e=>this.tableProps.visualToRenderableCoords(e),renderableToVisualCoords:e=>this.tableProps.renderableToVisualCoords(e),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(e,t)=>this.tableProps.createCellCoords(e,t),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),b(E,this,new c.default(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{var e=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,e.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{var e=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,e.getOuterBottomEndCorner().col)},visualToRenderableCoords:e=>this.tableProps.visualToRenderableCoords(e),renderableToVisualCoords:e=>this.tableProps.renderableToVisualCoords(e),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(e,t)=>this.tableProps.createCellCoords(e,t),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),v(C,this).addLocalHook("beforeTransformStart",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("beforeModifyTransformStart",...t)}),v(C,this).addLocalHook("afterTransformStart",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("afterModifyTransformStart",...t)}),v(C,this).addLocalHook("beforeTransformEnd",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("beforeModifyTransformEnd",...t)}),v(C,this).addLocalHook("afterTransformEnd",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("afterModifyTransformEnd",...t)}),v(C,this).addLocalHook("insertRowRequire",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("insertRowRequire",...t)}),v(C,this).addLocalHook("insertColRequire",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("insertColRequire",...t)}),v(C,this).addLocalHook("beforeRowWrap",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("beforeRowWrap",...t)}),v(C,this).addLocalHook("beforeColumnWrap",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("beforeColumnWrap",...t)}),v(E,this).addLocalHook("beforeTransformStart",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("beforeModifyTransformFocus",...t)}),v(E,this).addLocalHook("afterTransformStart",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("afterModifyTransformFocus",...t)})}getSelectedRange(){return this.selectedRange}markSource(e){b(_,this,e)}markEndSource(){b(_,this,"unknown")}getSelectionSource(){return v(_,this)}setExpectedLayers(e){b(x,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,b(x,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,t){var r=2<arguments.length&&void 0!==arguments[2]&&arguments[2],n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:e,i="multiple"===this.settings.selectionMode,o=(0,a.isUndefined)(t)?this.tableProps.getShortcutManager().isCtrlPressed():t,s=e.clone();b(T,this,!1),this.runLocalHooks("beforeSetRangeStart"+(r?"Only":""),s),i&&(o||!(0,a.isUndefined)(t))||this.selectedRange.clear(),this.selectedRange.add(s).current().setHighlight(n.clone()),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,t){this.setRangeStart(e,t,!0,2<arguments.length&&void 0!==arguments[2]?arguments[2]:e)}setRangeEnd(e){var t,r,n,i,o,s,a;this.selectedRange.isEmpty()||(a=e.clone(),t=this.tableProps.countRows(),r=this.tableProps.countCols(),n=this.selectedRange.current().clone().setTo(e).isSingleHeader(),(0<t||0<r)&&(0===t&&a.col<0&&!n||0===r&&a.row<0&&!n))||(this.runLocalHooks("beforeSetRangeEnd",a),this.begin(),n=this.selectedRange.current(),this.settings.navigableHeaders||n.highlight.normalize(),"single"===this.settings.selectionMode?(n.setFrom(n.highlight),n.setTo(n.highlight)):(i=n.getHorizontalDirection(),o=n.getVerticalDirection(),s=this.isMultiple(),n.setTo(a),s&&(i!==n.getHorizontalDirection()||1===n.getWidth()&&!n.includes(n.highlight))&&n.from.assign({col:n.highlight.col}),s&&(o!==n.getVerticalDirection()||1===n.getHeight()&&!n.includes(n.highlight))&&n.from.assign({row:n.highlight.row})),0<t&&0<r&&(this.settings.navigableHeaders&&(!this.settings.navigableHeaders||n.isSingleHeader())||n.to.normalize()),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit(),a=-1===v(x,this)||this.selectedRange.size()===v(x,this),this.runLocalHooks("afterSetRangeEnd",e,a))}applyAndCommit(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.selectedRange.current(),r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.getLayerLevel(),n=this.tableProps.countRows(),i=this.tableProps.countCols(),o=(r<this.highlight.layerLevel&&((0,g.arrayEach)(this.highlight.getAreas(),e=>{e.clear()}),(0,g.arrayEach)(this.highlight.getLayeredAreas(),e=>{e.clear()}),(0,g.arrayEach)(this.highlight.getRowHeaders(),e=>{e.clear()}),(0,g.arrayEach)(this.highlight.getColumnHeaders(),e=>{e.clear()}),(0,g.arrayEach)(this.highlight.getActiveRowHeaders(),e=>{e.clear()}),(0,g.arrayEach)(this.highlight.getActiveColumnHeaders(),e=>{e.clear()}),(0,g.arrayEach)(this.highlight.getActiveCornerHeaders(),e=>{e.clear()}),(0,g.arrayEach)(this.highlight.getRowHighlights(),e=>{e.clear()}),(0,g.arrayEach)(this.highlight.getColumnHighlights(),e=>{e.clear()})),this.highlight.useLayerLevel(r),this.highlight.createArea()),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),c=this.highlight.createActiveRowHeader(),u=this.highlight.createActiveColumnHeader(),d=this.highlight.createActiveCornerHeader(),h=this.highlight.createRowHighlight(),p=this.highlight.createColumnHighlight();o.clear(),s.clear(),a.clear(),l.clear(),c.clear(),u.clear(),d.clear(),h.clear(),p.clear(),this.highlight.isEnabledFor(f.AREA_TYPE,t.highlight)&&(this.isMultiple()||1<=r)&&(o.add(t.from).add(t.to).commit(),s.add(t.from).add(t.to).commit(),1===r)&&(o=this.selectedRange.previous(),this.highlight.useLayerLevel(r-1),this.highlight.createArea().add(o.from).commit().syncWith(o),this.highlight.createLayeredArea().add(o.from).commit().syncWith(o),this.highlight.useLayerLevel(r)),this.highlight.isEnabledFor(f.HEADER_TYPE,t.highlight)&&(t.isSingleHeader()||(s=this.tableProps.createCellCoords(Math.max(t.from.row,0),-1),o=this.tableProps.createCellCoords(t.to.row,-1),r=this.tableProps.createCellCoords(-1,Math.max(t.from.col,0)),e=this.tableProps.createCellCoords(-1,t.to.col),("single"===this.settings.selectionMode?(a.add(s).commit(),l.add(r).commit(),h.add(s).commit(),p.add(r)):(a.add(s).add(o).commit(),l.add(r).add(e).commit(),h.add(s).add(o).commit(),p.add(r).add(e))).commit()),a=!v(S,this)&&this.isEntireRowSelected()&&(0<i&&i===t.getWidth()||0===i&&this.isSelectedByRowHeader()),l=!v(S,this)&&this.isEntireColumnSelected()&&(0<n&&n===t.getHeight()||0===n&&this.isSelectedByColumnHeader()),a&&c.add(this.tableProps.createCellCoords(Math.max(t.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(t.to.row,0),-1)).commit(),l&&u.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(t.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(t.to.col,0))).commit(),a)&&l&&d.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}setRangeFocus(e){var t,r;this.selectedRange.isEmpty()||(t=this.selectedRange.current(),this.inProgress||this.runLocalHooks("beforeSetFocus",e),(r=this.highlight.getFocus()).clear(),t.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(f.FOCUS_TYPE,t.highlight)&&r.add(t.highlight).commit().syncWith(t),this.inProgress)||(b(T,this,!0),this.runLocalHooks("afterSetFocus",t.highlight))}transformStart(e,t){var r=2<arguments.length&&void 0!==arguments[2]&&arguments[2];this.settings.navigableHeaders?v(C,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):v(C,this).resetOffsetSize(),this.setRangeStart(v(C,this).transformStart(e,t,r))}transformEnd(e,t){this.settings.navigableHeaders?v(C,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):v(C,this).resetOffsetSize(),this.setRangeEnd(v(C,this).transformEnd(e,t))}transformFocus(e,t){var r=this.selectedRange.current(),{row:n,col:i}=r.getOuterTopStartCorner(),o=this.tableProps.countRenderableColumnsInRange(0,i-1),s=this.tableProps.countRenderableRowsInRange(0,n-1),r=(r.highlight.isHeader()?v(E,this).setOffsetSize({x:i<0?Math.abs(i):-o,y:n<0?Math.abs(n):-s}):v(E,this).setOffsetSize({x:i<0?0:-o,y:n<0?0:-s}),v(E,this).transformStart(e,t));this.setRangeFocus(r.normalize())}shiftRows(e,t){var r,n,i,o,s,a,l,c;this.isSelected()&&(c=this.selectedRange.current(),this.isSelectedByCorner()?this.selectAll(!0,!0,{disableHeadersHighlight:!0}):(this.isSelectedByColumnHeader()||c.getOuterTopStartCorner().row>=e)&&({from:c,to:r,highlight:n}=c,i=this.tableProps.countRows(),o=this.isSelectedByRowHeader(),a=(s=this.isSelectedByColumnHeader())?-1:0,l=s?0:t,this.getSelectedRange().pop(),l=this.tableProps.createCellCoords((0,u.clamp)(c.row+l,a,i-1),c.col),c=this.tableProps.createCellCoords((0,u.clamp)(r.row+t,a,i-1),r.col),this.markSource("shift"),n.row>=e?this.setRangeStartOnly(l,!0,this.tableProps.createCellCoords((0,u.clamp)(n.row+t,0,i-1),n.col)):this.setRangeStartOnly(l,!0),o&&this.selectedByRowHeader.add(this.getLayerLevel()),s&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(c),this.markEndSource()))}shiftColumns(e,t){var r,n,i,o,s,a,l,c;this.isSelected()&&(l=this.selectedRange.current(),this.isSelectedByCorner()?this.selectAll(!0,!0,{disableHeadersHighlight:!0}):(this.isSelectedByRowHeader()||l.getOuterTopStartCorner().col>=e)&&({from:l,to:r,highlight:n}=l,i=this.tableProps.countCols(),o=this.isSelectedByRowHeader(),s=this.isSelectedByColumnHeader(),a=o?-1:0,c=o?0:t,this.getSelectedRange().pop(),l=this.tableProps.createCellCoords(l.row,(0,u.clamp)(l.col+c,a,i-1)),c=this.tableProps.createCellCoords(r.row,(0,u.clamp)(r.col+t,a,i-1)),this.markSource("shift"),n.col>=e?this.setRangeStartOnly(l,!0,this.tableProps.createCellCoords(n.row,(0,u.clamp)(n.col+t,0,i-1))):this.setRangeStartOnly(l,!0),o&&this.selectedByRowHeader.add(this.getLayerLevel()),s&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(c),this.markEndSource()))}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){var e;return!!this.isSelected()&&(e=(0,s.createObjectPropListener)(!this.selectedRange.current().isSingle()),this.runLocalHooks("afterIsMultipleSelection",e),e.value)}isFocusSelectionChanged(){return this.isSelected()&&v(T,this)}isSelectedByRowHeader(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(-1===e?0<this.selectedByRowHeader.size:this.selectedByRowHeader.has(e))}isEntireRowSelected(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();const t=e=>{var t=e.getOuterTopStartCorner()["col"],r=this.tableProps.countRowHeaders(),n=this.tableProps.countCols();return(0<r&&t<0||0===r)&&e.getWidth()===n};return-1===e?Array.from(this.selectedRange).some(e=>t(e)):!!(e=this.selectedRange.peekByIndex(e))&&t(e)}isSelectedByColumnHeader(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(-1===e?0<this.selectedByColumnHeader.size:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();const t=e=>{var t=e.getOuterTopStartCorner()["row"],r=this.tableProps.countColHeaders(),n=this.tableProps.countRows();return(0<r&&t<0||0===r)&&e.getHeight()===n};return-1===e?Array.from(this.selectedRange).some(e=>t(e)):!!(e=this.selectedRange.peekByIndex(e))&&t(e)}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){e=this.tableProps.visualToRenderableCoords(e);return null!==e.row&&null!==e.col}isAreaCornerVisible(e){return(!Number.isInteger(e)||e===this.getLayerLevel())&&this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],r=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1},i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countColHeaders(),r=r?-a:0,a=t?-s:0;if(0!=r||0!=a||0!==i&&0!==o){let e=null==(t=this.getSelectedRange().current())?void 0:t.highlight;var{focusPosition:s,disableHeadersHighlight:t}=n,n=(b(S,this,t),s&&Number.isInteger(null==s?void 0:s.row)&&Number.isInteger(null==s?void 0:s.col)&&(e=this.tableProps.createCellCoords((0,u.clamp)(s.row,r,i-1),(0,u.clamp)(s.col,a,o-1))),this.tableProps.createCellCoords(r,a)),t=this.tableProps.createCellCoords(i-1,o-1);this.clear(),this.setRangeStartOnly(n,void 0,e),a<0&&this.selectedByRowHeader.add(this.getLayerLevel()),r<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(t),this.finish(),b(S,this,!1)}}selectCells(e){var t=this,r=(0,d.detectSelectionType)(e);if(r===d.SELECTION_TYPE_EMPTY)return!1;if(r===d.SELECTION_TYPE_UNRECOGNIZED)throw new Error((0,h.toSingleLine)`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const n=(0,d.normalizeSelectionFactory)(r,{createCellCoords:function(){return t.tableProps.createCellCoords(...arguments)},createCellRange:function(){return t.tableProps.createCellRange(...arguments)},propToCol:e=>this.tableProps.propToCol(e),keepDirection:!0});r=this.settings.navigableHeaders;const i={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:r?this.tableProps.countRowHeaders():0,countColHeaders:r?this.tableProps.countColHeaders():0};r=!e.some(e=>{var e=n(e),t=e.isValid(i);return!(t&&!e.containsHeaders()||t&&e.containsHeaders()&&e.isSingleHeader())});return r&&(this.clear(),this.setExpectedLayers(e.length),(0,g.arrayEach)(e,e=>{var{from:e,to:t}=n(e);this.setRangeStartOnly(e.clone(),!1),this.setRangeEnd(t.clone())}),this.finish()),r}selectColumns(r){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:r,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,r="string"==typeof r?this.tableProps.propToCol(r):r,n="string"==typeof n?this.tableProps.propToCol(n):n,o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countColHeaders(),l=0===a?0:-a,e=this.tableProps.createCellCoords(l,r),c=this.tableProps.createCellCoords(o-1,n),e=this.tableProps.createCellRange(e,e,c).isValid({countRows:o,countCols:s,countRowHeaders:0,countColHeaders:a});if(e){let e=0,t=0;t=Number.isInteger(null==i?void 0:i.row)&&Number.isInteger(null==i?void 0:i.col)?(e=(0,u.clamp)(i.row,l,o-1),(0,u.clamp)(i.col,Math.min(r,n),Math.max(r,n))):(e=(0,u.clamp)(i,l,o-1),r);c=this.tableProps.createCellCoords(e,t),s=0===a?0:(0,u.clamp)(c.row,l,-1),i=o-1,a=this.tableProps.createCellCoords(s,r),l=this.tableProps.createCellCoords(i,n);this.runLocalHooks("beforeSelectColumns",a,l,c),a.row=s,l.row=i,this.setRangeStartOnly(a,void 0,c),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(l),this.runLocalHooks("afterSelectColumns",a,l,c),this.finish()}return e}selectRows(r){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:r,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=0===a?0:-a,e=this.tableProps.createCellCoords(r,l),c=this.tableProps.createCellCoords(n,s-1),e=this.tableProps.createCellRange(e,e,c).isValid({countRows:o,countCols:s,countRowHeaders:a,countColHeaders:0});if(e){let e=0,t=0;t=Number.isInteger(null==i?void 0:i.row)&&Number.isInteger(null==i?void 0:i.col)?(e=(0,u.clamp)(i.row,Math.min(r,n),Math.max(r,n)),(0,u.clamp)(i.col,l,s-1)):(e=r,(0,u.clamp)(i,l,s-1));c=this.tableProps.createCellCoords(e,t),o=0===a?0:(0,u.clamp)(c.col,l,-1),i=s-1,a=this.tableProps.createCellCoords(r,o),l=this.tableProps.createCellCoords(n,i);this.runLocalHooks("beforeSelectRows",a,l,c),a.col=o,l.col=i,this.setRangeStartOnly(a,void 0,c),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(l),this.runLocalHooks("afterSelectRows",a,l,c),this.finish()}return e}refresh(){var e,t,r,n,i,o;this.isSelected()&&(e=this.tableProps.countRows(),t=this.tableProps.countCols(),0===e||0===t?this.deselect():({from:n,to:i,highlight:o}=r=this.selectedRange.peekByIndex(this.selectedRange.size()-1),this.clear(),o.assign({row:(0,u.clamp)(o.row,-1/0,e-1),col:(0,u.clamp)(o.col,-1/0,t-1)}),n.assign({row:(0,u.clamp)(n.row,-1/0,e-1),col:(0,u.clamp)(n.col,-1/0,t-1)}),i.assign({row:(0,u.clamp)(i.row,0,e-1),col:(0,u.clamp)(i.col,0,t-1)}),this.selectedRange.ranges.push(r),this.highlight.getFocus().add(o).commit().syncWith(r),this.applyAndCommit(r)))}commit(){if(this.highlight.getCustomSelections().forEach(e=>{e.commit()}),this.isSelected()){var e=this.highlight.getFocus(),t=this.getLayerLevel();e.commit().syncWith(this.selectedRange.current());for(let e=0;e<this.selectedRange.size();e+=1){this.highlight.useLayerLevel(e);var r=this.highlight.createArea(),n=this.highlight.createLayeredArea(),i=this.highlight.createRowHeader(),o=this.highlight.createColumnHeader(),s=this.highlight.createActiveRowHeader(),a=this.highlight.createActiveColumnHeader(),l=this.highlight.createActiveCornerHeader(),c=this.highlight.createRowHighlight(),u=this.highlight.createColumnHighlight();r.commit(),n.commit(),i.commit(),o.commit(),s.commit(),a.commit(),l.commit(),c.commit(),u.commit()}this.highlight.useLayerLevel(t)}}}(0,s.mixin)(R,l.default);t.default=R},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),r(286),n(r(487))),o=r(625),s=r(627),a=r(628),l=r(629),c=r(630),u=r(631),d=r(632),h=r(633),p=r(634),f=r(518),g=(t.ACTIVE_HEADER_TYPE=f.HIGHLIGHT_ACTIVE_HEADER_TYPE,t.AREA_TYPE=f.HIGHLIGHT_AREA_TYPE,t.FOCUS_TYPE=f.HIGHLIGHT_FOCUS_TYPE,t.CUSTOM_SELECTION_TYPE=f.HIGHLIGHT_CUSTOM_SELECTION_TYPE,t.FILL_TYPE=f.HIGHLIGHT_FILL_TYPE,t.HEADER_TYPE=f.HIGHLIGHT_HEADER_TYPE,t.ROW_TYPE=f.HIGHLIGHT_ROW_TYPE,t.COLUMN_TYPE=f.HIGHLIGHT_COLUMN_TYPE,r(478));function m(e,t){var r=e;if(t.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object");t.add(e)}function y(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var v=new WeakSet;class b{constructor(e){m(this,v),(0,i.default)(this,"options",void 0),(0,i.default)(this,"layerLevel",0),(0,i.default)(this,"focus",void 0),(0,i.default)(this,"fill",void 0),(0,i.default)(this,"layeredAreas",new Map),(0,i.default)(this,"areas",new Map),(0,i.default)(this,"rowHeaders",new Map),(0,i.default)(this,"columnHeaders",new Map),(0,i.default)(this,"activeRowHeaders",new Map),(0,i.default)(this,"activeColumnHeaders",new Map),(0,i.default)(this,"activeCornerHeaders",new Map),(0,i.default)(this,"rowHighlights",new Map),(0,i.default)(this,"columnHighlights",new Map),(0,i.default)(this,"customSelections",[]),this.options=e,this.focus=(0,c.createHighlight)(e),this.fill=(0,d.createHighlight)(e)}isEnabledFor(e,t){let r=e,n=(e===f.HIGHLIGHT_FOCUS_TYPE&&(r="current"),this.options.disabledCellSelection(t.row,t.col));return!1===(n="string"==typeof n?[n]:n)||Array.isArray(n)&&!n.includes(r)}useLayerLevel(){return this.layerLevel=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return y(v,this,w).call(this,this.layeredAreas,s.createHighlight)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return y(v,this,w).call(this,this.areas,a.createHighlight)}getAreas(){return[...this.areas.values()]}createRowHeader(){return y(v,this,w).call(this,this.rowHeaders,h.createHighlight)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return y(v,this,w).call(this,this.columnHeaders,h.createHighlight)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return y(v,this,w).call(this,this.activeRowHeaders,o.createHighlight)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return y(v,this,w).call(this,this.activeColumnHeaders,o.createHighlight)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return y(v,this,w).call(this,this.activeCornerHeaders,o.createHighlight)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return y(v,this,w).call(this,this.rowHighlights,p.createHighlight)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return y(v,this,w).call(this,this.columnHighlights,l.createHighlight)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push((0,u.createHighlight)({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),(0,g.arrayEach)(this.areas.values(),e=>{e.clear()}),(0,g.arrayEach)(this.layeredAreas.values(),e=>{e.clear()}),(0,g.arrayEach)(this.rowHeaders.values(),e=>{e.clear()}),(0,g.arrayEach)(this.columnHeaders.values(),e=>{e.clear()}),(0,g.arrayEach)(this.activeRowHeaders.values(),e=>{e.clear()}),(0,g.arrayEach)(this.activeColumnHeaders.values(),e=>{e.clear()}),(0,g.arrayEach)(this.activeCornerHeaders.values(),e=>{e.clear()}),(0,g.arrayEach)(this.rowHighlights.values(),e=>{e.clear()}),(0,g.arrayEach)(this.columnHighlights.values(),e=>{e.clear()})}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function w(e,t){var r=this.layerLevel;return e.has(r)?e.get(r):(t=t({layerLevel:r,...this.options}),e.set(r,t),t)}t.default=b},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,t.createHighlight=function(e){let{activeHeaderClassName:t,...r}=e;return new o.default({className:t,...r,selectionType:i.HIGHLIGHT_ACTIVE_HEADER_TYPE})},r(518)),o=n(r(626))},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(487)));class o extends r(518).Selection{constructor(e,t){super(e,null),(0,i.default)(this,"visualCellRange",null),this.visualCellRange=t||null,this.commit()}add(e){return null===this.visualCellRange?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){var{from:e,to:t}=e;let r=this.getNearestNotHiddenCoords(e,1),n=this.getNearestNotHiddenCoords(t,-1);return null===r||null===n?null:((r.row>n.row||r.col>n.col)&&(r=e,n=t),this.settings.createCellRange(r,r,n))}getNearestNotHiddenCoords(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:t,t=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,t);return null===t||null===(e=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r))?null:this.settings.createCellCoords(t,e)}getNearestNotHiddenIndex(e,t,r){return t<0?t:e.getNearestNotHiddenIndex(t,r)}commit(){var e;return null!==this.visualCellRange&&(e=this.trimToVisibleCellsRangeOnly(this.visualCellRange),this.cellRange=null===e?null:this.createRenderableCellRange(e.from,e.to)),this}syncWith(e){var t=e.from.clone().normalize(),r="N-S"===e.getVerticalDirection()?1:-1,n="W-E"===e.getHorizontalDirection()?1:-1,i=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let o=null;return null!==(o=null!==i&&null!==i.col&&null!==i.row?o:this.getNearestNotHiddenCoords(t,r,n))&&e.overlaps(o)&&(0<=(t=e.highlight.clone()).row&&(t.row=o.row),0<=t.col&&(t.col=o.col),null===this.cellRange&&(r=this.settings.visualToRenderableCoords(t),this.cellRange=this.settings.createCellRange(r)),e.setHighlight(t)),"focus"===this.settings.selectionType&&null!==i&&null===o&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){var{from:e,to:t}=this.cellRange;return[Math.min(e.row,t.row),Math.min(e.col,t.col),Math.max(e.row,t.row),Math.max(e.col,t.col)]}getVisualCorners(){var e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),t=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,t.row,t.col]}createRenderableCellRange(e,t){e=this.settings.visualToRenderableCoords(e),t=this.settings.visualToRenderableCoords(t);return null===e.row||null===e.col||null===t.row||null===t.col?null:this.settings.createCellRange(e,e,t)}}t.default=o},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,t.createHighlight=function(e){let{areaCornerVisible:t,...r}=e;return new o.default({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:t},...r,selectionType:i.HIGHLIGHT_AREA_TYPE})},r(518)),o=n(r(626))},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,t.createHighlight=function(e){let{...t}=e;return new o.default({className:"highlight",...t,selectionType:i.HIGHLIGHT_AREA_TYPE})},r(518)),o=n(r(626))},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,t.createHighlight=function(e){let{columnClassName:t,...r}=e;return new o.default({className:t,...r,selectionType:i.HIGHLIGHT_COLUMN_TYPE})},r(518)),o=n(r(626))},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,t.createHighlight=function(e){let{cellCornerVisible:t,...r}=e;return new o.default({className:"current",headerAttributes:[(0,s.A11Y_SELECTED)()],border:{width:2,color:"#4b89ff",cornerVisible:t},...r,selectionType:i.HIGHLIGHT_FOCUS_TYPE})},r(518)),o=n(r(626)),s=r(479)},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,t.createHighlight=function(e){let{border:t,visualCellRange:r,...n}=e;return new o.default({...t,...n,selectionType:i.HIGHLIGHT_CUSTOM_SELECTION_TYPE},r)},r(518)),o=n(r(626))},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,t.createHighlight=function(e){let{...t}=e;return new o.default({className:"fill",border:{width:1,color:"#ff0000"},...t,selectionType:i.HIGHLIGHT_FILL_TYPE})},r(518)),o=n(r(626))},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,t.createHighlight=function(e){let{headerClassName:t,...r}=e;return new o.default({className:t,...r,selectionType:i.HIGHLIGHT_HEADER_TYPE})},r(518)),o=n(r(626))},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,t.createHighlight=function(e){let{rowClassName:t,...r}=e;return new o.default({className:t,...r,selectionType:i.HIGHLIGHT_ROW_TYPE})},r(518)),o=n(r(626))},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(286),n(r(487)));class o{constructor(e){(0,i.default)(this,"ranges",[]),(0,i.default)(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return 0===this.size()}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(t){return this.ranges.some(e=>e.includes(t))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;let t;return t=0<=e&&e<this.size()?this.ranges[e]:t}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}t.default=o},(e,t,r)=>{"use strict";var n=r(197),f=(t.__esModule=!0,r(204),r(482)),n=n(r(578));function i(e,t,r){o(e,t),t.set(e,r)}function o(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function g(e,t){return e.get(m(e,t))}function s(e,t,r){e.set(m(e,t),r)}function m(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var y=new WeakMap,v=new WeakMap,a=new WeakMap,b=new WeakSet;class l{constructor(e,t){var r,n;o(r=this,n=b),n.add(r),i(this,y,void 0),i(this,v,void 0),i(this,a,{x:0,y:0}),s(y,this,e),s(v,this,t)}transformStart(e,t){var r=2<arguments.length&&void 0!==arguments[2]&&arguments[2],e=g(v,this).createCellCoords(e,t);let n=g(y,this).current().highlight;var i,o,s,a,l,c,u,d,t=g(v,this).visualToRenderableCoords(n);let h=0,p=0;return this.runLocalHooks("beforeTransformStart",e),null!==t.row&&null!==t.col&&({width:t,height:i}=m(b,this,C).call(this),{row:s,col:c}=m(b,this,T).call(this,n),d=g(v,this).fixedRowsBottom(),a=g(v,this).minSpareRows(),u=g(v,this).minSpareCols(),o=g(v,this).autoWrapRow(),l=g(v,this).autoWrapCol(),{rowDir:u,colDir:d}=((s=g(v,this).createCellCoords(s+e.row,c+e.col)).row>=i?(c=(0,f.createObjectPropListener)(r&&0<a&&0===d),e=s.col+1,a=g(v,this).createCellCoords(s.row-i,t<=e?e-t:e),this.runLocalHooks("beforeColumnWrap",c,m(b,this,S).call(this,a),t<=e),c.value?this.runLocalHooks("insertRowRequire",g(v,this).countRenderableRows()):l&&s.assign(a)):s.row<0&&(d=(0,f.createObjectPropListener)(l),e=s.col-1,c=g(v,this).createCellCoords(i+s.row,e<0?t+e:e),this.runLocalHooks("beforeColumnWrap",d,m(b,this,S).call(this,c),e<0),l)&&s.assign(c),s.col>=t?(a=(0,f.createObjectPropListener)(r&&0<u),d=s.row+1,e=g(v,this).createCellCoords(i<=d?d-i:d,s.col-t),this.runLocalHooks("beforeRowWrap",a,m(b,this,S).call(this,e),i<=d),a.value?this.runLocalHooks("insertColRequire",g(v,this).countRenderableColumns()):o&&s.assign(e)):s.col<0&&(l=(0,f.createObjectPropListener)(o),c=s.row-1,r=g(v,this).createCellCoords(c<0?i+c:c,t+s.col),this.runLocalHooks("beforeRowWrap",l,m(b,this,S).call(this,r),c<0),o)&&s.assign(r),m(b,this,w).call(this,s)),h=u,p=d,n=m(b,this,S).call(this,s)),this.runLocalHooks("afterTransformStart",n,h,p),n}transformEnd(e,t){var r,n,i,o,s,e=g(v,this).createCellCoords(e,t),t=g(y,this).current(),a=g(v,this).visualToRenderableCoords(t.highlight),l=m(b,this,p).call(this,t.to.row,t.from.row),c=m(b,this,E).call(this,t.to.col,t.from.col),u=t.to.clone();let d=0,h=0;return this.runLocalHooks("beforeTransformEnd",e),null!==a.row&&null!==a.col&&null!==l&&null!==c&&({row:a,col:s}=m(b,this,T).call(this,t.highlight),r=g(v,this).createCellCoords(l+e.row,c+e.col),n=t.getTopStartCorner(),i=t.getTopEndCorner(),t=t.getBottomEndCorner(),{rowDir:c,colDir:s}=(e.col<0&&s<=c&&r.col<s?(o=r.col-s,r.col=m(b,this,E).call(this,n.col,i.col)+o):0<e.col&&c<=s&&r.col>s&&(o=m(b,this,E).call(this,i.col,n.col),c=Math.max(r.col-o,1),r.col=o+c),e.row<0&&a<=l&&r.row<a?(s=r.row-a,r.row=m(b,this,p).call(this,n.row,t.row)+s):0<e.row&&l<=a&&r.row>a&&(i=m(b,this,p).call(this,t.row,n.row),o=Math.max(r.row-i,1),r.row=i+o),m(b,this,w).call(this,r)),d=c,h=s,l=m(b,this,S).call(this,r),0===e.row&&0!==e.col?u.col=l.col:0!==e.row&&0===e.col?u.row=l.row:(u.row=l.row,u.col=l.col)),this.runLocalHooks("afterTransformEnd",u,d,h),u}setOffsetSize(e){var{x:e,y:t}=e;s(a,this,{x:e,y:t})}resetOffsetSize(){s(a,this,{x:0,y:0})}}function w(e){var{width:t,height:r}=m(b,this,C).call(this);let n=0,i=0;return e.row<0?(n=-1,e.row=0):0<e.row&&e.row>=r&&(n=1,e.row=r-1),e.col<0?(i=-1,e.col=0):0<e.col&&e.col>=t&&(i=1,e.col=t-1),{rowDir:n,colDir:i}}function C(){return{width:g(a,this).x+g(v,this).countRenderableColumns(),height:g(a,this).y+g(v,this).countRenderableRows()}}function p(e,t){e=g(v,this).findFirstNonHiddenRenderableRow(e,t);return null===e?null:g(a,this).y+e}function E(e,t){e=g(v,this).findFirstNonHiddenRenderableColumn(e,t);return null===e?null:g(a,this).x+e}function T(e){var{row:e,col:t}=g(v,this).visualToRenderableCoords(e);if(null===e||null===t)throw new Error("Renderable coords are not visible.");return g(v,this).createCellCoords(g(a,this).y+e,g(a,this).x+t)}function S(e){var t=e.clone();return t.col=e.col-g(a,this).x,t.row=e.row-g(a,this).y,g(v,this).renderableToVisualCoords(t)}(0,f.mixin)(l,n.default);t.default=l},(e,t,r)=>{"use strict";t.__esModule=!0,t.detectSelectionType=h,t.normalizeSelectionFactory=g,t.transformSelectionToColumnDistance=function(e){var t=h(e.getSelected());if(t===a||t===l)return[];const n=g(t,{createCellCoords:e._createCellCoords.bind(e),createCellRange:e._createCellRange.bind(e)}),i=new Set,r=((0,s.arrayEach)(e.getSelected(),e=>{var{from:e,to:t}=n(e);const r=Math.max(e.col,0);e=t.col-r+1;(0,s.arrayEach)(Array.from(new Array(e),(e,t)=>r+t),e=>{i.has(e)||i.add(e)})}),Array.from(i).sort((e,t)=>e-t)),o=(0,s.arrayReduce)(r,(e,t,r,n)=>(0!==r&&t===n[r-1]+1?e[e.length-1][1]+=1:e.push([t,1]),e),[]);return o},t.transformSelectionToRowDistance=function(e){var t=h(e.getSelected());if(t===a||t===l)return[];const n=g(t,{createCellCoords:e._createCellCoords.bind(e),createCellRange:e._createCellRange.bind(e)}),i=new Set,r=((0,s.arrayEach)(e.getSelected(),e=>{var{from:e,to:t}=n(e);const r=Math.max(e.row,0);e=t.row-r+1;(0,s.arrayEach)(Array.from(new Array(e),(e,t)=>r+t),e=>{i.has(e)||i.add(e)})}),Array.from(i).sort((e,t)=>e-t)),o=(0,s.arrayReduce)(r,(e,t,r,n)=>(0!==r&&t===n[r-1]+1?e[e.length-1][1]+=1:e.push([t,1]),e),[]);return o},r(204),r(286),r(290),r(302),r(305),r(309),r(312),r(315),r(318);var i=r(518),s=r(478),p=r(337);const a=t.SELECTION_TYPE_UNRECOGNIZED=0,l=t.SELECTION_TYPE_EMPTY=1,o=t.SELECTION_TYPE_ARRAY=2,f=t.SELECTION_TYPE_OBJECT=3,n=t.SELECTION_TYPES=[f,o],c=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],u=Symbol("root"),d=Symbol("child");function h(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:u;if(t!==u&&t!==d)throw new Error("The second argument is used internally only and cannot be overwritten.");var r=Array.isArray(e),t=t===u;let n=a;return r&&(r=e[0],0===e.length?n=l:t&&r instanceof i.CellRange?n=f:t&&Array.isArray(r)?n=h(r,d):2<=e.length&&e.length<=4&&!e.some((e,t)=>!c[t].includes(typeof e))&&(n=o)),n}function g(l){let{createCellCoords:c,createCellRange:u,keepDirection:d=!1,propToCol:h}=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(n.includes(l))return function(e){var t,r=l===f;let n=r?e.from.row:e[0],i=r?e.from.col:e[1],o=r?e.to.row:e[2],s=r?e.to.col:e[3];"function"==typeof h&&("string"==typeof i&&(i=h(i)),"string"==typeof s)&&(s=h(s)),(0,p.isUndefined)(o)&&(o=n),(0,p.isUndefined)(s)&&(s=i),d||(r=n,e=i,a=o,t=s,n=Math.min(r,a),i=Math.min(e,t),o=Math.max(r,a),s=Math.max(e,t));var r=c(n,i),a=c(o,s);return u(r,r,a)};throw new Error("Unsupported selection ranges schema type was provided.")}},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(639))),i=(t.DataMap=i.default,n(r(642))),i=(t.MetaManager=i.default,n(r(646))),n=(t.metaSchemaFactory=i.default,r(651)),i=(t.replaceData=n.replaceData,r(652)),n=(t.DynamicCellMetaMod=i.DynamicCellMetaMod,r(653));t.ExtendMetaPropertiesMod=n.ExtendMetaPropertiesMod},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),r(286),n(r(487))),o=r(640),s=r(596),d=r(482),c=r(478),h=r(512),a=r(337);t.default=class p{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,t,r){(0,i.default)(this,"hot",void 0),(0,i.default)(this,"metaManager",void 0),(0,i.default)(this,"tableMeta",void 0),(0,i.default)(this,"dataSource",void 0),(0,i.default)(this,"duckSchema",void 0),(0,i.default)(this,"colToPropCache",void 0),(0,i.default)(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=t,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){var n=this.getSchema();if(void 0===n)throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var i,o=this.tableMeta.columns;let s;if(this.colToPropCache=[],this.propToColCache=new Map,o){let e=0,t=0,r=!1;for("function"==typeof o?(i=(0,d.deepObjectSize)(n),e=0<i?i:this.countFirstRowKeys(),r=!0):(i=this.tableMeta.maxCols,e=Math.min(i,o.length)),s=0;s<e;s++){var a,l=r?o(s):o[s];(0,d.isObject)(l)&&(void 0!==l.data&&(a=r?t:s,this.colToPropCache[a]=l.data,this.propToColCache.set(l.data,a)),t+=1)}}else this.recursiveDuckColumns(n)}countFirstRowKeys(){return(0,s.countFirstRowKeys)(this.dataSource)}recursiveDuckColumns(e,t,r){let n=t,i=r,o;return void 0===n&&(n=0,i=""),"object"!=typeof e||Array.isArray(e)||(0,d.objectEach)(e,(e,t)=>{null===e?(o=i+t,this.colToPropCache.push(o),this.propToColCache.set(o,n),n+=1):n=this.recursiveDuckColumns(e,n,t+".")}),n}colToProp(e){var t;return!1===Number.isInteger(e)||null===(t=this.hot.toPhysicalColumn(e))?e:this.colToPropCache&&(0,a.isDefined)(this.colToPropCache[t])?this.colToPropCache[t]:t}propToCol(e){var t=this.propToColCache.get(e);return(0,a.isDefined)(t)?this.hot.toVisualColumn(t):null===(t=this.hot.toVisualColumn(e))?e:t}getSchema(){var e=this.tableMeta.dataSchema;return e?"function"==typeof e?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?(0,d.duckSchema)(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,{source:r,mode:n="above"}=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},i=this.hot.countSourceRows();let o=i,s=0,a=e;if((a="number"!=typeof a||a>=i?i:a)<this.hot.countRows()&&(o=this.hot.toPhysicalRow(a)),!1===this.hot.runHooks("beforeCreateRow",a,t,r)||null===o)return{delta:0};for(var l=this.tableMeta.maxRows,c=this.getSchema().length,u=[];s<t&&i+s<l;){let e=null;"array"===this.hot.dataType?this.tableMeta.dataSchema?e=(0,d.deepClone)(this.getSchema()):(e=[],(0,h.rangeEach)(c-1,()=>e.push(null))):"function"===this.hot.dataType?e=this.tableMeta.dataSchema(a+s):(e={},(0,d.deepExtend)(e,this.getSchema())),u.push(e),s+=1}return this.hot.rowIndexMapper.insertIndexes(a,s),"below"===n&&(o=Math.min(o+1,i)),this.spliceData(o,0,u),n=this.hot.toVisualRow(o),this.hot.countSourceRows()===u.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),0<s&&(null==e?this.metaManager.createRow(null,s):"auto"!==r&&this.metaManager.createRow(o,t)),this.hot.runHooks("afterCreateRow",n,s,r),this.hot.forceFullRender=!0,{delta:s,startPhysicalIndex:o}}createCol(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,{source:r,mode:n="start"}=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var i=this.dataSource,o=this.tableMeta.maxCols,s=this.hot.countSourceCols();let a=e;if(("number"!=typeof a||a>=s)&&(a=s),!1===this.hot.runHooks("beforeCreateCol",a,t,r))return{delta:0};let l=s;a<this.hot.countCols()&&(l=this.hot.toPhysicalColumn(a));var c=this.hot.countSourceRows();let u=this.hot.countCols(),d=0,h=l;for(n=h="end"===n?Math.min(h+1,s):h;d<t&&u<o;){if("number"!=typeof a||a>=u)if(0<c)for(let e=0;e<c;e+=1)void 0===i[e]&&(i[e]=[]),i[e].push(null);else i.push([null]);else for(let e=0;e<c;e++)i[e].splice(h,0,null);d+=1,h+=1,u+=1}return this.hot.columnIndexMapper.insertIndexes(a,d),0<d&&(null==e?this.metaManager.createColumn(null,d):"auto"!==r&&this.metaManager.createColumn(n,t)),s=this.hot.toVisualColumn(n),this.hot.runHooks("afterCreateCol",s,d,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:d,startPhysicalIndex:n}}removeRow(e){var t,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,n=2<arguments.length?arguments[2]:void 0,e=Number.isInteger(e)?e:-r,r=this.visualRowsToPhysical(e,r),i=this.hot.countSourceRows();return!1!==this.hot.runHooks("beforeRemoveRow",e=(i+e)%i,r.length,r,n)&&(i=r.length,this.filterData(e,i,r),e<this.hot.countRows()&&(this.hot.rowIndexMapper.removeIndexes(r),t=(0,a.isDefined)(this.tableMeta.columns)||(0,a.isDefined)(this.tableMeta.dataSchema),0===this.hot.rowIndexMapper.getNotTrimmedIndexesLength())&&!1===t&&this.hot.columnIndexMapper.setIndexesSequence([]),r.slice(0).sort((e,t)=>t-e).forEach(e=>{this.metaManager.removeRow(e,1)}),this.hot.runHooks("afterRemoveRow",e,i,r,n),this.hot.forceFullRender=!0)}removeCol(e){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,t=2<arguments.length?arguments[2]:void 0;if("object"===this.hot.dataType||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var e="number"!=typeof e?-r:e,e=(this.hot.countCols()+e)%this.hot.countCols(),n=this.visualColumnsToPhysical(e,r),i=n.slice(0).sort((e,t)=>t-e);if(!1===this.hot.runHooks("beforeRemoveCol",e,r,n,t))return!1;let o=!0;var s=i.length,a=this.dataSource;for(let e=0;e<s;e++)o&&n[0]!==n[e]-e&&(o=!1);if(o)for(let e=0,t=this.hot.countSourceRows();e<t;e++)a[e].splice(n[0],r),0===e&&this.metaManager.removeColumn(n[0],r);else for(let t=0,e=this.hot.countSourceRows();t<e;t++)for(let e=0;e<s;e++)a[t].splice(i[e],1),0===t&&this.metaManager.removeColumn(i[e],1);return e<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(n),0===this.hot.columnIndexMapper.getNotTrimmedIndexesLength())&&this.hot.rowIndexMapper.setIndexesSequence([]),this.hot.runHooks("afterRemoveCol",e,r,n,t),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,t,r){for(var n=(i=this.hot.getDataAtCol(e)).slice(t,t+r),i=i.slice(t+r),o=arguments.length,s=new Array(3<o?o-3:0),a=3;a<o;a++)s[a-3]=arguments[a];(0,c.extendArray)(s,i);let l=0;for(;l<r;)s.push(null),l+=1;return(0,c.to2dArray)(s),this.hot.populateFromArray(t,e,s,null,null,"spliceCol"),n}spliceRow(e,t,r){for(var n=(i=this.hot.getSourceDataAtRow(e)).slice(t,t+r),i=i.slice(t+r),o=arguments.length,s=new Array(3<o?o-3:0),a=3;a<o;a++)s[a-3]=arguments[a];(0,c.extendArray)(s,i);let l=0;for(;l<r;)s.push(null),l+=1;return this.hot.populateFromArray(e,t,[s],null,null,"spliceRow"),n}spliceData(e,t,r){!1!==this.hot.runHooks("beforeDataSplice",e,t,r)&&(t=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)],this.dataSource.length=0,t.forEach(e=>this.dataSource.push(e)))}filterData(e,t,r){let n=this.hot.runHooks("filterData",e,t,r);!1===Array.isArray(n)&&(n=this.dataSource.filter((e,t)=>-1===r.indexOf(t))),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,n)}get(e,t){var e=this.hot.toPhysicalRow(e),n=this.dataSource[e],r=this.hot.runHooks("modifyRowData",e),n=isNaN(r)?r:n,r=this.hot.getSettings().dataDotNotation;let i=null;if(n&&n.hasOwnProperty&&(0,d.hasOwnProperty)(n,t))i=n[t];else if(r&&"string"==typeof t&&-1<t.indexOf(".")){let r=n;if(!r)return null;var o=t.split(".");for(let e=0,t=o.length;e<t;e++)if(void 0===(r=r[o[e]]))return null;i=r}else"function"==typeof t&&(i=t(this.dataSource.slice(e,e+1)[0]));return i=this.hot.hasHook("modifyData")&&(r=(0,d.createObjectPropListener)(i),this.hot.runHooks("modifyData",e,this.propToCol(t),r,"get"),r.isTouched())?r.value:i}getCopyable(e,t){return this.hot.getCellMeta(e,this.propToCol(t)).copyable?this.get(e,t):""}set(e,r,n){e=this.hot.toPhysicalRow(e);let i=n;var n=this.dataSource[e],t=this.hot.runHooks("modifyRowData",e),n=isNaN(t)?t:n,t=(this.hot.hasHook("modifyData")&&(t=(0,d.createObjectPropListener)(i),this.hot.runHooks("modifyData",e,this.propToCol(r),t,"set"),t.isTouched())&&(i=t.value),this.hot.getSettings().dataDotNotation);if(n&&n.hasOwnProperty&&(0,d.hasOwnProperty)(n,r))n[r]=i;else if(t&&"string"==typeof r&&-1<r.indexOf(".")){let e=n,t=0;var o,s=r.split(".");for(t=0,o=s.length-1;t<o;t++)void 0===e[s[t]]&&(e[s[t]]={}),e=e[s[t]];e[s[t]]=i}else"function"==typeof r?r(this.dataSource.slice(e,e+1)[0],i):n[r]=i}visualRowsToPhysical(e,t){var r,n=this.hot.countSourceRows(),i=[];let o=(n+e)%n,s=t;for(;o<n&&s;)r=this.hot.toPhysicalRow(o),i.push(r),--s,o+=1;return i}visualColumnsToPhysical(e,t){var r=this.hot.countCols(),n=[];let i=(r+e)%r,o=t;for(;i<r&&o;){var s=this.hot.toPhysicalColumn(i);n.push(s),--o,i+=1}return n}clear(){for(let t=0;t<this.hot.countSourceRows();t++)for(let e=0;e<this.hot.countCols();e++)this.set(t,this.colToProp(e),"")}getLength(){var e=this.tableMeta.maxRows;let t;return t=e<0||0===e?0:e||1/0,e=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),Math.min(e,t)}getAll(){var e={row:0,col:0},t={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-t.row!=0||this.hot.countSourceRows()?this.getRange(e,t,p.DESTINATION_RENDERER):[]}countCachedColumns(){return this.colToPropCache.length}getRange(e,t,r){var n=[];let i,o;var s=this.tableMeta.maxRows,a=this.tableMeta.maxCols;if(0===s||0===a)return[];var l=r===p.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,c=Math.min(Math.max(s-1,0),Math.max(e.row,t.row)),u=Math.min(Math.max(a-1,0),Math.max(e.col,t.col));for(i=Math.min(e.row,t.row);i<=c;i++){var d=[],h=0<=i?this.hot.toPhysicalRow(i):i;for(o=Math.min(e.col,t.col);o<=u&&null!==h;o++)d.push(l.call(this,i,this.colToProp(o)));null!==h&&n.push(d)}return n}getText(e,t){return(0,o.stringify)(this.getRange(e,t,p.DESTINATION_RENDERER))}getCopyableText(e,t){return(0,o.stringify)(this.getRange(e,t,p.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(641);t.parse=r.parse,t.stringify=r.stringify},(e,t)=>{"use strict";t.__esModule=!0,t.parse=function(n){var i=[[""]];if(0!==n.length){let e=0,t=0,r;for(;0<n.length&&r!==n.length;)if(r=n.length,n.match(c))n=n.replace(c,""),e+=1,i[t][e]="";else if(n.match(a))n=n.replace(a,""),e=0,t+=1,i[t]=[""];else{let r="";if(n.startsWith('"')){let e=0,t=!0;for(;t;){var o=n.slice(0,1);'"'===o&&(e+=1),r+=o,(0===(n=n.slice(1)).length||n.match(/^[\t\r\n]/)&&e%2==0)&&(t=!1)}r=r.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,e=>new Array(Math.floor(e.length/2)).fill('"').join(""))}else{var s=n.match(l);r=s?s[0]:"",n=n.slice(r.length)}i[t][e]=r}}return i},t.stringify=function(e){let t,r,n,i,o="",s;for(t=0,r=e.length;t<r;t+=1){for(i=e[t].length,n=0;n<i;n+=1)0<n&&(o+="\t"),"string"==typeof(s=e[t][n])?-1<s.indexOf("\n")?o+=`"${s.replace(/"/g,'""')}"`:o+=s:o+=null==s?"":s;t!==r-1&&(o+="\n")}return o};const a=/^(\r\n|\n\r|\r|\n)/,l=/^[^\t\r\n]+/,c=/^\t/},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),n(r(643))),o=n(r(647)),s=n(r(648)),a=n(r(650)),n=n(r(578)),r=r(482);class l{constructor(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[];this.hot=e,this.globalMeta=new i.default(e),this.tableMeta=new o.default(this.globalMeta),this.columnMeta=new s.default(this.globalMeta),this.cellMeta=new a.default(this.columnMeta),r.forEach(e=>new e(this)),this.globalMeta.updateMeta(t)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,t){this.columnMeta.updateMeta(e,t)}getCellMeta(e,t,r){var{visualRow:r,visualColumn:n}=r,i=this.cellMeta.getMeta(e,t);return i.visualRow=r,i.visualCol=n,i.row=e,i.col=t,this.runLocalHooks("afterGetCellMeta",i),i}getCellMetaKeyValue(e,t,r){if("string"!=typeof r)throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,t,r)}setCellMeta(e,t,r,n){this.cellMeta.setMeta(e,t,r,n)}updateCellMeta(e,t,r){this.cellMeta.updateMeta(e,t,r)}removeCellMeta(e,t,r){this.cellMeta.removeMeta(e,t,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){this.cellMeta.createRow(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:1)}removeRow(e){this.cellMeta.removeRow(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:1)}createColumn(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createColumn(e,t),this.columnMeta.createColumn(e,t)}removeColumn(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeColumn(e,t),this.columnMeta.removeColumn(e,t)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}t.default=l,(0,r.mixin)(l,n.default)},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(487))),o=r(482),s=r(644),a=n(r(646));t.default=class{constructor(e){(0,i.default)(this,"metaCtor",class{}),(0,i.default)(this,"meta",void 0),this.meta=this.metaCtor.prototype,(0,o.extend)(this.meta,(0,a.default)()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var t;(0,o.extend)(this.meta,e),(0,s.extendByMetaType)(this.meta,{...e,type:null!=(t=e.type)?t:this.meta.type},e)}}},(e,t,r)=>{"use strict";t.__esModule=!0,t.assert=function(e,t){if(!e())throw new Error("Assertion failed: "+t)},t.columnFactory=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];function r(){}(0,l.inherit)(r,e);for(let e=0;e<t.length;e++)r.prototype[t[e]]=void 0;return r},t.extendByMetaType=function(o,e){let s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:o;var t="string"==typeof e.type?(0,n.getCellType)(e.type):e.type;o._automaticallyAssignedMetaProps&&(0,l.objectEach)(e,(e,t)=>{o._automaticallyAssignedMetaProps.delete(t)});if((0,l.isObject)(t)){s!==o||o._automaticallyAssignedMetaProps||(o._automaticallyAssignedMetaProps=new Set);const a={};(0,l.objectEach)(t,(e,t)=>{var r,n,i;r=t,n=s,"CELL_TYPE"!==r&&(null!=(i=n._automaticallyAssignedMetaProps)&&i.has(r)||!(0,l.hasOwnProperty)(n,r))&&(a[t]=e,null!=(i=o._automaticallyAssignedMetaProps))&&i.add(t)}),(0,l.extend)(o,a)}},t.isNullish=function(e){return null==e},t.isUnsignedNumber=function(e){return Number.isInteger(e)&&0<=e},r(204),r(290),r(302),r(305),r(309),r(312),r(315),r(318);var l=r(482),n=r(645)},(e,t,r)=>{"use strict";var n=r(197),n=(t.__esModule=!0,t.getCellType=function(e){if(c(e))return i(e);throw Error(`You declared cell type "${e}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`)},t.registerCellType=function(e,t){"string"!=typeof e&&(e=(t=e).CELL_TYPE);var{editor:r,renderer:n,validator:i}=t;r&&(0,o.registerEditor)(e,r);n&&(0,s.registerRenderer)(e,n);i&&(0,a.registerValidator)(e,i);l(e,t)},r(204),n(r(501))),o=r(493),s=r(515),a=r(516);const{register:l,getItem:i,hasItem:c,getNames:u,getValues:d}=(0,n.default)("cellTypes");t.getRegisteredCellTypes=d,t.getRegisteredCellTypeNames=u,t.hasCellType=c},(e,t,r)=>{"use strict";t.__esModule=!0;var o=r(337),s=r(482);t.default=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(e){let t;var r,n;for(t=0,r=this.countRows();t<r;t++)if(n=this.getDataAtCell(t,e),!1===(0,o.isEmpty)(n))return!1;return!0},isEmptyRow(e){let t;var r,n,i;for(t=0,r=this.countCols();t<r;t++)if(n=this.getDataAtCell(e,t),!1===(0,o.isEmpty)(n))return"object"==typeof n&&(i=this.getCellMeta(e,t),(0,s.isObjectEqual)(this.getSchema()[i.prop],n));return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0})},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(487))),o=r(482),s=r(644);t.default=class{constructor(e){(0,i.default)(this,"meta",void 0);e=e.getMetaConstructor();this.meta=new e}getMeta(){return this.meta}updateMeta(e){(0,o.extend)(this.meta,e),(0,s.extendByMetaType)(this.meta,e,e)}}},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(487))),o=r(482),s=r(644),a=n(r(649));const l=["data","width"];t.default=class{constructor(e){(0,i.default)(this,"globalMeta",void 0),(0,i.default)(this,"metas",new a.default(()=>this._createMeta())),this.globalMeta=e,this.metas=new a.default(()=>this._createMeta())}updateMeta(e,t){e=this.getMeta(e);(0,o.extend)(e,t),(0,s.extendByMetaType)(e,t)}createColumn(e,t){this.metas.insert(e,t)}removeColumn(e,t){this.metas.remove(e,t)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return(0,s.columnFactory)(this.globalMeta.getMetaConstructor(),l).prototype}}},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(286),r(290),r(302),r(305),r(309),r(312),r(315),r(318),n(r(487))),o=r(478),s=r(644);class a{constructor(e){(0,i.default)(this,"valueFactory",void 0),(0,i.default)(this,"data",[]),(0,i.default)(this,"index",[]),(0,i.default)(this,"holes",new Set),this.valueFactory=e}obtain(e){(0,s.assert)(()=>(0,s.isUnsignedNumber)(e),"Expecting an unsigned number.");var t=this._getStorageIndexByKey(e);let r;return 0<=t?void 0===(r=this.data[t])&&(r=this.valueFactory(e),this.data[t]=r):(r=this.valueFactory(e),0<this.holes.size?(t=this.holes.values().next().value,this.holes.delete(t),this.data[t]=r,this.index[e]=t):(this.data.push(r),this.index[e]=this.data.length-1)),r}insert(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,r=((0,s.assert)(()=>(0,s.isUnsignedNumber)(e)||(0,s.isNullish)(e),"Expecting an unsigned number or null/undefined argument."),[]),n=this.data.length;for(let e=0;e<t;e++)r.push(n+e),this.data.push(void 0);var i=(0,s.isNullish)(e)?this.index.length:e;this.index=[...this.index.slice(0,i),...r,...this.index.slice(i)]}remove(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,r=((0,s.assert)(()=>(0,s.isUnsignedNumber)(e)||(0,s.isNullish)(e),"Expecting an unsigned number or null/undefined argument."),this.index.splice((0,s.isNullish)(e)?this.index.length-t:e,t));for(let e=0;e<r.length;e++){var n=r[e];"number"==typeof n&&this.holes.add(n)}}size(){return this.data.length-this.holes.size}values(){return(0,o.arrayFilter)(this.data,(e,t)=>!this.holes.has(t))[Symbol.iterator]()}entries(){const t=[];for(let e=0;e<this.data.length;e++){var r=this._getKeyByStorageIndex(e);-1!==r&&t.push([r,this.data[e]])}let n=0;return{next:()=>{var e;return n<t.length?(e=t[n],n+=1,{value:e,done:!1}):{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}t.default=a},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(286),n(r(487))),o=r(482),s=r(644),a=n(r(649)),l=r(337);t.default=class{constructor(e){(0,i.default)(this,"columnMeta",void 0),(0,i.default)(this,"metas",new a.default(()=>this._createRow())),this.columnMeta=e}updateMeta(e,t,r){e=this.getMeta(e,t);(0,o.extend)(e,r),(0,s.extendByMetaType)(e,r)}createRow(e,t){this.metas.insert(e,t)}createColumn(t,r){for(let e=0;e<this.metas.size();e++)this.metas.obtain(e).insert(t,r)}removeRow(e,t){this.metas.remove(e,t)}removeColumn(t,r){for(let e=0;e<this.metas.size();e++)this.metas.obtain(e).remove(t,r)}getMeta(e,t,r){e=this.metas.obtain(e).obtain(t);return void 0===r?e:e[r]}setMeta(e,t,r,n){e=this.metas.obtain(e).obtain(t);null!=(t=e._automaticallyAssignedMetaProps)&&t.delete(r),e[r]=n}removeMeta(e,t,r){delete this.metas.obtain(e).obtain(t)[r]}getMetas(){var t=[],r=Array.from(this.metas.values());for(let e=0;e<r.length;e++)(0,l.isDefined)(r[e])&&t.push(...r[e].values());return t}getMetasAtRow(e){(0,s.assert)(()=>(0,s.isUnsignedNumber)(e),"Expecting an unsigned number.");var t=new Map(this.metas);return t.has(e)?Array.from(t.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new a.default(e=>this._createMeta(e))}_createMeta(e){return new(this.columnMeta.getMetaConstructor(e))}}},(e,t,r)=>{"use strict";var n=r(197),f=(t.__esModule=!0,t.replaceData=function(t,e,r,n){var{hotInstance:i,dataMap:n,dataSource:o,internalSource:s,source:a,metaManager:l,firstRun:c}=n,u=(0,f.toUpperCaseFirst)(s),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":(0,g.isFunction)(d.dataSchema)?i.dataType="function":i.dataType="object";n&&n.destroy();t=i.runHooks("before"+u,t,c,a);n=new m.default(i,t,l);if(e(n),"object"==typeof t&&null!==t)t.push&&t.splice||(t=[t]);else{if(null!==t)throw new Error(s+` only accepts array of objects or array of arrays (${typeof t} given)`);{var h=n.getSchema();t=[];let r,e=0;var p;for(e=0,p=d.startRows;e<p;e++){if("object"!==i.dataType&&"function"!==i.dataType||!d.dataSchema)if("array"===i.dataType)r=(0,y.deepClone)(h[0]);else{r=[];for(let e=0,t=d.startCols;e<t;e++)r.push(null)}else r=(0,y.deepClone)(h);t.push(r)}}}Array.isArray(t[0])&&(i.dataType="array");d.data=t,n.dataSource=t,o.data=t,o.dataType=i.dataType,o.colToProp=n.colToProp.bind(n),o.propToCol=n.propToCol.bind(n),o.countCachedColumns=n.countCachedColumns.bind(n),r(n),i.runHooks("after"+u,t,c,a),c||(i.runHooks("afterChange",null,s),i.render());i.getSettings().ariaTags&&(0,v.setAttribute)(i.rootElement,[(0,b.A11Y_ROWCOUNT)(-1),(0,b.A11Y_COLCOUNT)(i.countCols()+(i.view?i.countRowHeaders():0))])},r(204),r(286),r(335)),g=r(480),m=n(r(639)),y=r(482),v=r(334),b=r(479)},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(290),r(302),r(305),r(309),r(312),r(315),r(318),n(r(487))),o=n(r(494)),c=r(482),u=r(480);t.DynamicCellMetaMod=class{constructor(e){(0,i.default)(this,"metaManager",void 0),(0,i.default)(this,"metaSyncMemo",new Map),(this.metaManager=e).addLocalHook("afterGetCellMeta",e=>this.extendCellMeta(e)),o.default.getSingleton().add("beforeRender",e=>{e&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(t){var{row:r,col:n}=t;if(null==(i=this.metaSyncMemo.get(r))||!i.has(n)){var{visualRow:i,visualCol:o}=t,s=this.metaManager.hot,a=s.colToProp(o),l=(t.prop=a,s.runHooks("beforeGetCellMeta",i,o,t),(0,c.hasOwnProperty)(t,"type")?t.type:null);let e=(0,u.isFunction)(t.cells)?t.cells(r,n,a):null;l&&(e?e.type=null!=(a=e.type)?a:l:e={type:l}),e&&this.metaManager.updateCellMeta(r,n,e),s.runHooks("afterGetCellMeta",i,o,t),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(n)}}}},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),r(286),r(290),r(302),r(305),r(309),r(312),r(315),r(318),n(r(487)));function o(e,t,r){var n=e;if(t.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object");t.set(e,r)}function a(e,t){return e.get(function(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}(e,t))}var l=new WeakMap;t.ExtendMetaPropertiesMod=class{constructor(e){(0,i.default)(this,"metaManager",void 0),(0,i.default)(this,"usageTracker",new Set),(0,i.default)(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(e){if(this.metaManager.hot.isRtl()&&"fixedColumnsLeft"===e)throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),o(this,l,(e,t,r)=>{if(!r)throw new Error(`The \`${e}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,t)=>{var{initOnly:e,target:r,onChange:n}=e,i="string"==typeof r,o=i?r:t,s="_"+o;this.metaManager.globalMeta.meta[s]=this.metaManager.globalMeta.meta[o],n?(this.installPropWatcher(t,s,n),i&&this.installPropWatcher(r,s,n)):e&&(this.installPropWatcher(t,s,a(l,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(t))})}installPropWatcher(r,n,i){const o=this;Object.defineProperty(this.metaManager.globalMeta.meta,r,{get(){return this[n]},set(e){var t=!o.usageTracker.has(r);o.usageTracker.add(r),i.call(o,r,e,t),this[n]=e},enumerable:!0,configurable:!0})}}},(e,t,r)=>{"use strict";t.__esModule=!0;var n=r(655),i=(Object.keys(n).forEach(function(e){"default"===e||"__esModule"===e||e in t&&t[e]===n[e]||(t[e]=n[e])}),r(709));Object.keys(i).forEach(function(e){"default"===e||"__esModule"===e||e in t&&t[e]===i[e]||(t[e]=i[e])})},(e,t,r)=>{"use strict";t.__esModule=!0,t.installFocusCatcher=function(o){const t=function(n){return e=>{var t,r;return e?(t=h(n),r=p(n),e.col<t.col&&(e.col=t.col),e.col>r.col&&(e.col=r.col),e.row<t.row&&(e.row=t.row),e.row>r.row&&(e.row=r.row),e):null}}(o);let s;const{activate:e,deactivate:r}=(0,d.installFocusDetector)(o,{onFocusFromTop(){var e=null!=(e=t(s))?e:h(o);e&&(o.runHooks("modifyFocusOnTabNavigation","from_above",e),o.selectCell(e.row,e.col)),o.listen()},onFocusFromBottom(){var e=null!=(e=t(s))?e:p(o);e&&(o.runHooks("modifyFocusOnTabNavigation","from_below",e),o.selectCell(e.row,e.col)),o.listen()}}),a={wrapped:!1,flipped:!1};let l=!0,c=!1,u=!1;o.addHook("afterListen",()=>r()),o.addHook("afterUnlisten",()=>e()),o.addHook("afterSelection",(e,t,r,n,i)=>{c&&(a.wrapped&&a.flipped||u)&&(u=!1,i.value=!0),l&&(s=null==(i=o.getSelectedRangeLast())?void 0:i.highlight)}),o.addHook("beforeRowWrap",(e,t,r)=>{a.wrapped=!0,a.flipped=r});var n={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:i.GRID_GROUP,group:"focusCatcher"};o.getShortcutManager().getContext("grid").addShortcuts([{...n,callback:()=>{var e=o.getSettings()["tabNavigation"];c=!0,o.getSelectedRangeLast()&&!e&&(l=!1),e||(u=!0)},position:"before"},{...n,callback:e=>{var{tabNavigation:t,autoWrapRow:r}=o.getSettings();if(c=!1,l=!0,!t||!o.selection.isSelected()||r&&a.wrapped&&a.flipped||!r&&a.wrapped)return r&&a.wrapped&&a.flipped&&(s=(e.shiftKey?h:p)(o)),a.wrapped=!1,a.flipped=!1,o.deselectCell(),o.unlisten(),!1;e.preventDefault()},position:"after"}])};var i=r(656),d=r(708);function h(e){var{rowIndexMapper:t,columnIndexMapper:r}=e,n=e.getSettings()["navigableHeaders"];let i=n&&0<e.countColHeaders()?-e.countColHeaders():0,o=n&&0<e.countRowHeaders()?-e.countRowHeaders():0;return 0===i&&(i=t.getVisualFromRenderableIndex(i)),0===o&&(o=r.getVisualFromRenderableIndex(o)),null===i||null===o?null:e._createCellCoords(i,o)}function p(e){var{rowIndexMapper:t,columnIndexMapper:r}=e,n=e.getSettings()["navigableHeaders"];let i=t.getRenderableIndexesLength()-1,o=r.getRenderableIndexesLength()-1;if(i<0){if(!n||0===e.countColHeaders())return null;i=-1}if(o<0){if(!n||0===e.countColHeaders())return null;o=-1}return e._createCellCoords(null!=(n=t.getVisualFromRenderableIndex(i))?n:i,null!=(e=r.getVisualFromRenderableIndex(o))?e:o)}},(e,t,r)=>{"use strict";var n={registerAllShortcutContexts:t.__esModule=!0},i=(t.registerAllShortcutContexts=function(t){[o.shortcutsGridContext,i.shortcutsEditorContext].forEach(e=>e(t))},r(657)),o=r(707),s=r(658);Object.keys(s).forEach(function(e){"default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(n,e)||e in t&&t[e]===s[e]||(t[e]=s[e])})},(e,t,r)=>{"use strict";t.__esModule=!0,t.shortcutsEditorContext=function(e){const t=e.getShortcutManager().addContext("editor"),r=(0,o.createKeyboardShortcutCommandsPool)(e),n={group:i.EDITOR_EDIT_GROUP};t.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(e,t)=>r.editorCloseAndSaveByEnter(e,t)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(e,t)=>r.editorCloseAndSaveByEnter(e,t)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:(e,t)=>r.editorCloseAndSave(e,t)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(e,t)=>r.editorCloseAndSaveByArrowKeys(e,t)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>r.editorCloseWithoutSaving()}],n)};var i=r(658),o=r(659)},(e,t)=>{"use strict";t.__esModule=!0;t.GRID_GROUP="gridDefault",t.EDITOR_EDIT_GROUP="editorManager.handlingEditor"},(e,t,r)=>{"use strict";t.__esModule=!0,t.createKeyboardShortcutCommandsPool=function(i){const r={};return c.forEach(e=>{let{name:t,callback:n}=e;r[t]=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n(i,...t)}}),r};var t=r(660),n=r(670),i=r(685),o=r(702),s=r(703),a=r(704),l=r(705),r=r(706);const c=[...(0,t.getAllCommands)(),...(0,n.getAllCommands)(),...(0,i.getAllCommands)(),o.command,s.command,a.command,l.command,r.command]},(e,t,r)=>{"use strict";t.__esModule=!0,t.getAllCommands=function(){return[n.command,i.command,o.command,s.command,a.command,l.command]};var n=r(661),i=r(662),o=r(666),s=r(667),a=r(668),l=r(669)},(e,t)=>{"use strict";t.__esModule=!0;t.command={name:"editorCloseAndSave",callback(e){e._getEditorManager().closeEditorAndSaveChanges()}}},(e,t,r)=>{"use strict";t.__esModule=!0;var o=r(663);t.command={name:"editorCloseAndSaveByArrowKeys",callback(e,t,r){var n=e._getEditorManager(),i=n.getActiveEditor();i.isInFullEditMode()&&i.state===o.EDITOR_STATE.EDITING||(n.closeEditorAndSaveChanges(),e.getSelected()&&(r.includes("arrowdown")?e.selection.transformStart(1,0):r.includes("arrowup")?e.selection.transformStart(-1,0):r.includes("arrowleft")?e.selection.transformStart(0,-1*e.getDirectionFactor()):r.includes("arrowright")&&e.selection.transformStart(0,e.getDirectionFactor())),t.preventDefault())}}},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(664);t.EDITOR_STATE=r.EDITOR_STATE,t.EDITOR_TYPE=r.EDITOR_TYPE,t.BaseEditor=r.BaseEditor},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),n(r(487))),o=r(337),s=r(482),n=n(r(665)),b=r(334);t.EDITOR_TYPE="base";const a=t.EDITOR_STATE=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class l{static get EDITOR_TYPE(){return"base"}constructor(e){(0,i.default)(this,"hot",void 0),(0,i.default)(this,"state",a.VIRGIN),(0,i.default)(this,"_opened",!1),(0,i.default)(this,"_fullEditMode",!1),(0,i.default)(this,"_closeCallback",null),(0,i.default)(this,"TD",null),(0,i.default)(this,"row",null),(0,i.default)(this,"col",null),(0,i.default)(this,"prop",null),(0,i.default)(this,"originalValue",null),(0,i.default)(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,t,r,n,i,o){this.TD=n,this.row=e,this.col=t,this.prop=r,this.originalValue=i,this.cellProperties=o,this.state=this.isOpened()?this.state:a.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,t){let r,n,i,o;t?(t=this.hot.getSelectedLast(),r=Math.max(Math.min(t[0],t[2]),0),n=Math.max(Math.min(t[1],t[3]),0),i=Math.max(t[0],t[2]),o=Math.max(t[1],t[3])):[r,n,i,o]=[this.row,this.col,null,null];t=this.hot.runHooks("modifyGetCellCoords",r,n);Array.isArray(t)&&([r,n]=t),this.hot.populateFromArray(r,n,e,i,o,"edit")}beginEditing(e,t){var r,n,i;this.state===a.VIRGIN&&(i=(r=this.hot).rowIndexMapper.getRenderableFromVisualIndex(this.row),n=r.columnIndexMapper.getRenderableFromVisualIndex(this.col),r.view.scrollViewport(r._createCellCoords(i,n)),this.state=a.EDITING,this.isInFullEditMode()&&(i="string"==typeof e?e:(0,o.stringify)(this.originalValue),this.setValue(i)),this.open(t),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col))}finishEditing(e,t,r){let n;if(r){const i=this._closeCallback;this._closeCallback=e=>{i&&i(e),r(e),this.hot.view.render()}}this.isWaiting()||(this.state===a.VIRGIN?this.hot._registerTimeout(()=>{this._fireCallbacks(!0)}):this.state===a.EDITING&&(e?(this.cancelChanges(),this.hot.view.render()):(e=this.getValue(),n=this.cellProperties.trimWhitespace?[["string"==typeof e?String.prototype.trim.call(e||""):e]]:[[e]],this.state=a.WAITING,this.saveValue(n,t),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",e=>{this.state=a.FINISHED,this.discardEditor(e)}):(this.state=a.FINISHED,this.discardEditor(!0)))))}cancelChanges(){this.state=a.FINISHED,this.discardEditor()}discardEditor(e){this.state===a.FINISHED&&(!1===e&&!0!==this.cellProperties.allowInvalid?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=a.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=a.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===a.WAITING}getEditedCellRect(){var i=this.getEditedCell();if(i){var{wtOverlays:o,wtViewport:s}=this.hot.view._wt,a=this.hot.rootWindow,l=(0,b.offset)(i),c=(0,b.outerWidth)(i),u=(0,b.offset)(this.hot.rootElement),d=(0,b.outerWidth)(this.hot.rootElement),h=o.topOverlay.holder,p=o.inlineStartOverlay.holder,f=h!==a?h.scrollTop:0,g=p!==a?p.scrollLeft:0,d=a.innerWidth-u.left-d,m=(null!=(m=o.getParentOverlay(i))?m:this.hot.view._wt)["wtTable"],y=m.name,f=["master","inline_start"].includes(y)?f:0,g=["master","top","bottom"].includes(y)?g:0,v=l.top===u.top?0:1;let e=l.top-u.top-v-f,t=0;t=this.hot.isRtl()?a.innerWidth-l.left-c-d-1+g:l.left-u.left-1-g,["top","top_inline_start_corner"].includes(y)&&(e+=o.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(y)&&(t+=Math.abs(o.inlineStartOverlay.getOverlayOffset()));var v=this.hot.hasColHeaders(),f=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),a=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),d=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom"),l=((v&&f<=0||f===d)&&(e+=1),a<=0&&(t+=1),s.rowsRenderCalculator.startPosition),u=s.columnsRenderCalculator.startPosition,g=Math.abs(o.inlineStartOverlay.getScrollPosition()),v=o.topOverlay.getScrollPosition(),f=(0,b.getScrollbarWidth)(this.hot.rootDocument);let r=i.offsetTop,n=(["inline_start","master"].includes(y)&&(r+=l-v),["bottom","bottom_inline_start_corner"].includes(y)&&({wtViewport:d,wtTable:a}=o.bottomOverlay.clone,r+=d.getWorkspaceHeight()-a.getHeight()-f),i.offsetLeft);this.hot.isRtl()?(n=0<=n?m.getWidth()-i.offsetLeft:Math.abs(n),n+=u-g-c):["top","master","bottom"].includes(y)&&(n+=u-g);s=(0,b.getComputedStyle)(this.TD,this.hot.rootWindow),l=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",v=0<parseInt(s[l],10)?0:1,o=0<parseInt(s.borderTopWidth,10)?0:1,d=(0,b.outerWidth)(i)+v,a=(0,b.outerHeight)(i)+o,m=(0,b.hasVerticalScrollbar)(h)?f:0,c=(0,b.hasHorizontalScrollbar)(p)?f:0,y=this.hot.view.maximumVisibleElementWidth(n)-m+v,u=Math.max(this.hot.view.maximumVisibleElementHeight(r)-c+o,23);return{top:e,start:t,height:a,maxHeight:u,width:d,maxWidth:y}}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){var e=this.hot.countRows();let t="";return this.row<this.hot.getSettings().fixedRowsTop?t=this.col<this.hot.getSettings().fixedColumnsStart?"top-inline-start-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?t=this.col<this.hot.getSettings().fixedColumnsStart?"bottom-inline-start-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(t="inline-start"),t}}t.BaseEditor=l,(0,s.mixin)(l,n.default)},(e,t,r)=>{"use strict";t.__esModule=!0,r(286);var n=r(478),i=r(482),r={_hooksStorage:Object.create(null),addHook(e,t){return this._hooksStorage[e]||(this._hooksStorage[e]=[]),this.hot.addHook(e,t),this._hooksStorage[e].push(t),this},removeHooksByKey(t){(0,n.arrayEach)(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){(0,i.objectEach)(this._hooksStorage,(e,t)=>this.removeHooksByKey(t)),this._hooksStorage={}}};(0,i.defineGetter)(r,"MIXIN_NAME","hooksRefRegisterer",{writable:!1,enumerable:!1}),t.default=r},(e,t)=>{"use strict";t.__esModule=!0;t.command={name:"editorCloseAndSaveByEnter",callback(e,t){e=e._getEditorManager();e.closeEditorAndSaveChanges(t.ctrlKey||t.metaKey),e.moveSelectionAfterEnter(t)}}},(e,t)=>{"use strict";t.__esModule=!0;t.command={name:"editorCloseWithoutSaving",callback(e){var t=e._getEditorManager();t.closeEditorAndRestoreOriginalValue(e.getShortcutManager().isCtrlPressed()),t.activeEditor.focus()}}},(e,t)=>{"use strict";t.__esModule=!0;t.command={name:"editorFastOpen",callback(e,t){var r=e.getSelectedRangeLast()["highlight"];r.isHeader()||e._getEditorManager().openEditor(null,t,!0)}}},(e,t,r)=>{"use strict";t.__esModule=!0;var s=r(492);t.command={name:"editorOpen",callback(e,t,r){var n=e._getEditorManager(),i=e.getSelectedRangeLast(),o=i["highlight"];e.selection.isMultiple()&&!i.isHeader()&&0<e.countRenderedCols()&&0<e.countRenderedRows()?(i="function"==typeof(i=e.getSettings()).enterMoves?i.enterMoves(t):i.enterMoves,r.includes("shift")?e.selection.transformFocus(-i.row,-i.col):e.selection.transformFocus(i.row,i.col)):o.isHeader()||(!e.getSettings().enterBeginsEditing||n.cellProperties.readOnly?n.moveSelectionAfterEnter(t):n.openEditor(null,t,!0),(0,s.stopImmediatePropagation)(t))}}},(e,t,r)=>{"use strict";t.__esModule=!0,t.getAllCommands=function(){return[n.command,i.command,o.command,s.command,a.command,l.command,c.command,u.command,d.command,h.command,p.command,f.command,g.command,m.command]};var n=r(671),i=r(672),o=r(673),s=r(674),a=r(675),l=r(676),c=r(677),u=r(678),d=r(679),h=r(680),p=r(681),f=r(682),g=r(683),m=r(684)},(e,t)=>{"use strict";t.__esModule=!0;t.command={name:"extendCellsSelectionDown",callback(e){var t=e.getSelectedRangeLast()["highlight"];e.selection.isSelectedByColumnHeader()||e.selection.isSelectedByCorner()||!(t.isCell()||t.isHeader()&&e.selection.isSelectedByRowHeader())||e.selection.transformEnd(1,0)}}},(e,t)=>{"use strict";t.__esModule=!0;t.command={name:"extendCellsSelectionDownByViewportHeight",callback(e){var t=e.getSelectedRangeLast()["to"],r=Math.min(t.row+e.countVisibleRows(),e.countRows()-1),r=e.rowIndexMapper.getNearestNotHiddenIndex(r,-1);null!==r&&(r=e._createCellCoords(r,t.col),t=t.row-e.view.getFirstFullyVisibleRow(),t=Math.min(r.row-t,e.countRows()-1),e.selection.setRangeEnd(r),e.scrollViewportTo({row:t,verticalSnap:"top",horizontalSnap:"start"}))}}},(e,t)=>{"use strict";t.__esModule=!0;t.command={name:"extendCellsSelectionLeft",callback(e){var t=e.getSelectedRangeLast()["highlight"];e.selection.isSelectedByRowHeader()||e.selection.isSelectedByCorner()||!(t.isCell()||t.isHeader()&&e.selection.isSelectedByColumnHeader())||e.selection.transformEnd(0,-1*e.getDirectionFactor())}}},(e,t)=>{"use strict";t.__esModule=!0;t.command={name:"extendCellsSelectionRight",callback(e){var t=e.getSelectedRangeLast()["highlight"];e.selection.isSelectedByRowHeader()||e.selection.isSelectedByCorner()||!(t.isCell()||t.isHeader()&&e.selection.isSelectedByColumnHeader())||e.selection.transformEnd(0,e.getDirectionFactor())}}},(e,t)=>{"use strict";t.__esModule=!0;t.command={name:"extendCellsSelectionToColumns",callback(e){var{highlight:t,from:r,to:n}=e.getSelectedRangeLast();e.selection.isSelectedByRowHeader()?e.selection.selectAll(!0,!0):e.selectColumns(r.col,n.col,t)}}},(e,t)=>{"use strict";t.__esModule=!0;t.command={name:"extendCellsSelectionToMostBottom",callback(e){var{selection:t,rowIndexMapper:r}=e,{highlight:n,from:i,to:o}=e.getSelectedRangeLast(),s=n.isHeader()&&e.selection.isSelectedByRowHeader();(n.isCell()||s)&&(r=r.getNearestNotHiddenIndex(e.countRows()-1,-1),(i=i.clone()).row=n.row,t.setRangeStart(i,void 0,!1,n.clone()),s&&t.selectedByRowHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(r,o.col)))}}},(e,t)=>{"use strict";t.__esModule=!0;t.command={name:"extendCellsSelectionToMostInlineEnd",callback(e){var{selection:t,columnIndexMapper:r}=e,{highlight:n,from:i,to:o}=e.getSelectedRangeLast();e.selection.isSelectedByRowHeader()||e.selection.isSelectedByCorner()||!n.isCell()||(r=r.getNearestNotHiddenIndex(e.countCols()-1,-1),(i=i.clone()).col=n.col,t.setRangeStart(i,void 0,!1,n.clone()),t.setRangeEnd(e._createCellCoords(o.row,r)))}}},(e,t)=>{"use strict";t.__esModule=!0;t.command={name:"extendCellsSelectionToMostInlineStart",callback(e){var t,{selection:r,columnIndexMapper:n}=e,{highlight:i,from:o,to:s}=e.getSelectedRangeLast();e.selection.isSelectedByRowHeader()||e.selection.isSelectedByCorner()||!i.isCell()||(t=parseInt(e.getSettings().fixedColumnsStart,10),n=n.getNearestNotHiddenIndex(t,1),(t=o.clone()).col=i.col,r.setRangeStart(t,void 0,!1,i.clone()),r.setRangeEnd(e._createCellCoords(s.row,n)))}}},(e,t)=>{"use strict";t.__esModule=!0;t.command={name:"extendCellsSelectionToMostLeft",callback(e){var{selection:t,columnIndexMapper:r}=e,{highlight:n,from:i,to:o}=e.getSelectedRangeLast(),s=n.isHeader()&&e.selection.isSelectedByColumnHeader();(n.isCell()||s)&&(r=r.getNearestNotHiddenIndex(...e.isRtl()?[e.countCols()-1,-1]:[0,1]),(i=i.clone()).col=n.col,t.setRangeStart(i,void 0,!1,n.clone()),s&&t.selectedByColumnHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(o.row,r)))}}},(e,t)=>{"use strict";t.__esModule=!0;t.command={name:"extendCellsSelectionToMostRight",callback(e){var{selection:t,columnIndexMapper:r}=e,{highlight:n,from:i,to:o}=e.getSelectedRangeLast(),s=n.isHeader()&&e.selection.isSelectedByColumnHeader();(n.isCell()||s)&&(r=r.getNearestNotHiddenIndex(...e.isRtl()?[0,1]:[e.countCols()-1,-1]),(i=i.clone()).col=n.col,t.setRangeStart(i,void 0,!1,n.clone()),s&&t.selectedByColumnHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(o.row,r)))}}},(e,t)=>{"use strict";t.__esModule=!0;t.command={name:"extendCellsSelectionToMostTop",callback(e){var{selection:t,rowIndexMapper:r}=e,{highlight:n,from:i,to:o}=e.getSelectedRangeLast(),s=n.isHeader()&&e.selection.isSelectedByRowHeader();(n.isCell()||s)&&(r=r.getNearestNotHiddenIndex(0,1),(i=i.clone()).row=n.row,t.setRangeStart(i,void 0,!1,n.clone()),s&&t.selectedByRowHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(r,o.col)))}}},(e,t)=>{"use strict";t.__esModule=!0;t.command={name:"extendCellsSelectionToRows",callback(e){var{highlight:t,from:r,to:n}=e.getSelectedRangeLast();e.selection.isSelectedByColumnHeader()?e.selection.selectAll(!0,!0):e.selectRows(r.row,n.row,t)}}},(e,t)=>{"use strict";t.__esModule=!0;t.command={name:"extendCellsSelectionUp",callback(e){var t=e.getSelectedRangeLast()["highlight"];e.selection.isSelectedByColumnHeader()||e.selection.isSelectedByCorner()||!(t.isCell()||t.isHeader()&&e.selection.isSelectedByRowHeader())||e.selection.transformEnd(-1,0)}}},(e,t)=>{"use strict";t.__esModule=!0;t.command={name:"extendCellsSelectionUpByViewportHeight",callback(e){var t=e.getSelectedRangeLast()["to"],r=Math.max(t.row-e.countVisibleRows(),0),r=e.rowIndexMapper.getNearestNotHiddenIndex(r,1);null!==r&&(r=e._createCellCoords(r,t.col),t=t.row-e.view.getFirstFullyVisibleRow(),t=Math.max(r.row-t,0),e.selection.setRangeEnd(r),e.scrollViewportTo({row:t,verticalSnap:"top",horizontalSnap:"start"}))}}},(e,t,r)=>{"use strict";t.__esModule=!0,t.getAllCommands=function(){return[n.command,i.command,o.command,s.command,a.command,l.command,c.command,u.command,d.command,h.command,p.command,f.command,g.command,m.command,y.command,v.command]};var n=r(686),i=r(687),o=r(688),s=r(689),a=r(690),l=r(691),c=r(692),u=r(693),d=r(694),h=r(695),p=r(696),f=r(697),g=r(698),m=r(699),y=r(700),v=r(701)},(e,t)=>{"use strict";t.__esModule=!0;t.command={name:"moveCellSelectionDown",callback(e){e=e.selection;e.transformStart(1,0)}}},(e,t)=>{"use strict";t.__esModule=!0;t.command={name:"moveCellSelectionDownByViewportHeight",callback(e){var t=e.getSettings()["navigableHeaders"],t=t?e.countColHeaders():0,r=e.getSelectedRangeLast().highlight["row"];let n=e.countVisibleRows()+t;r===e.countRows()-1?n=1:r+n>e.countRows()&&(n=e.countRows()-r-1),e.selection.transformStart(n,0),e.getSelectedRangeLast().highlight.row<0&&e.scrollViewportTo({row:0})}}},(e,t)=>{"use strict";t.__esModule=!0;t.command={name:"moveCellSelectionInlineEnd",callback(e,t){var r=e.getSettings(),n=e.getSelectedRangeLast(),t="function"==typeof r.tabMoves?r.tabMoves(t):r.tabMoves;e.selection.isMultiple()&&!n.isHeader()&&0<e.countRenderedCols()&&0<e.countRenderedRows()?e.selection.transformFocus(-t.row,-t.col):e.selection.transformStart(-t.row,-t.col)}}},(e,t)=>{"use strict";t.__esModule=!0;t.command={name:"moveCellSelectionInlineStart",callback(e,t){var r=e.getSettings(),n=e.getSelectedRangeLast(),t="function"==typeof r.tabMoves?r.tabMoves(t):r.tabMoves;e.selection.isMultiple()&&!n.isHeader()&&0<e.countRenderedCols()&&0<e.countRenderedRows()?e.selection.transformFocus(t.row,t.col):e.selection.transformStart(t.row,t.col)}}},(e,t)=>{"use strict";t.__esModule=!0;t.command={name:"moveCellSelectionLeft",callback(e){e.selection.transformStart(0,-1*e.getDirectionFactor())}}},(e,t)=>{"use strict";t.__esModule=!0;t.command={name:"moveCellSelectionRight",callback(e){e.selection.transformStart(0,e.getDirectionFactor())}}},(e,t)=>{"use strict";t.__esModule=!0;t.command={name:"moveCellSelectionToMostBottom",callback(e){var t=e.getSelectedRangeLast().highlight["col"];let r=e.rowIndexMapper.getNearestNotHiddenIndex(e.countRows()-1,-1);null===r&&(r=-1),e.selection.setRangeStart(e._createCellCoords(r,t))}}},(e,t)=>{"use strict";t.__esModule=!0;t.command={name:"moveCellSelectionToMostBottomInlineEnd",callback(e){var{selection:t,rowIndexMapper:r,columnIndexMapper:n}=e,i=parseInt(e.getSettings().fixedRowsBottom,10),r=r.getNearestNotHiddenIndex(e.countRows()-i-1,-1),i=n.getNearestNotHiddenIndex(e.countCols()-1,-1);t.setRangeStart(e._createCellCoords(r,i))}}},(e,t)=>{"use strict";t.__esModule=!0;t.command={name:"moveCellSelectionToMostInlineEnd",callback(e){var{selection:t,columnIndexMapper:r}=e;t.setRangeStart(e._createCellCoords(e.getSelectedRangeLast().highlight.row,r.getNearestNotHiddenIndex(e.countCols()-1,-1)))}}},(e,t)=>{"use strict";t.__esModule=!0;t.command={name:"moveCellSelectionToMostInlineStart",callback(e){var{selection:t,columnIndexMapper:r}=e,n=parseInt(e.getSettings().fixedColumnsStart,10),i=e.getSelectedRangeLast().highlight.row,r=r.getNearestNotHiddenIndex(n,1);t.setRangeStart(e._createCellCoords(i,r))}}},(e,t)=>{"use strict";t.__esModule=!0;t.command={name:"moveCellSelectionToMostLeft",callback(e){var{selection:t,columnIndexMapper:r}=e,n=e.getSelectedRangeLast().highlight.row;let i=r.getNearestNotHiddenIndex(...e.isRtl()?[e.countCols()-1,-1]:[0,1]);null===i&&(i=e.isRtl()?-1:-e.countRowHeaders()),t.setRangeStart(e._createCellCoords(n,i))}}},(e,t)=>{"use strict";t.__esModule=!0;t.command={name:"moveCellSelectionToMostRight",callback(e){var{selection:t,columnIndexMapper:r}=e,n=e.getSelectedRangeLast().highlight["row"];let i=r.getNearestNotHiddenIndex(...e.isRtl()?[0,1]:[e.countCols()-1,-1]);null===i&&(i=e.isRtl()?-e.countRowHeaders():-1),t.setRangeStart(e._createCellCoords(n,i))}}},(e,t)=>{"use strict";t.__esModule=!0;t.command={name:"moveCellSelectionToMostTop",callback(e){var t=e.getSelectedRangeLast().highlight["col"];let r=e.rowIndexMapper.getNearestNotHiddenIndex(0,1);null===r&&(r=-e.countColHeaders()),e.selection.setRangeStart(e._createCellCoords(r,t))}}},(e,t)=>{"use strict";t.__esModule=!0;t.command={name:"moveCellSelectionToMostTopInlineStart",callback(e){var{selection:t,rowIndexMapper:r,columnIndexMapper:n}=e,i=parseInt(e.getSettings().fixedRowsTop,10),o=parseInt(e.getSettings().fixedColumnsStart,10),r=r.getNearestNotHiddenIndex(i,1),i=n.getNearestNotHiddenIndex(o,1);t.setRangeStart(e._createCellCoords(r,i))}}},(e,t)=>{"use strict";t.__esModule=!0;t.command={name:"moveCellSelectionUp",callback(e){e=e.selection;e.transformStart(-1,0)}}},(e,t)=>{"use strict";t.__esModule=!0;t.command={name:"moveCellSelectionUpByViewportHight",callback(e){var t=e.getSettings()["navigableHeaders"],t=t?e.countColHeaders():0,r=e.getSelectedRangeLast().highlight["row"];let n=-(e.countVisibleRows()+t);r===-t?n=-1:r+n<t&&(n=-(r+t)),e.selection.transformStart(n,0),e.getSelectedRangeLast().highlight.row<0&&e.scrollViewportTo({row:0})}}},(e,t)=>{"use strict";t.__esModule=!0;t.command={name:"emptySelectedCells",callback(e){e.emptySelectedCells(),e._getEditorManager().prepareEditor()}}},(e,t)=>{"use strict";t.__esModule=!0;t.command={name:"scrollToFocusedCell",callback(e){var t=e.getSelectedRangeLast()["highlight"],r=e.view.getFirstFullyVisibleRow()-1,n=e.view.getFirstFullyVisibleColumn()-1,i=e.view.getLastFullyVisibleRow()+1,o=e.view.getLastFullyVisibleColumn()+1,r=e._createCellCoords(r,n),n=e._createCellCoords(i,o);!e._createCellRange(r,r,n).includes(t)&&(0<=t.row||0<=t.col)&&(i={},0<=t.col&&(o=Math.floor(e.countVisibleCols()/2),i.col=Math.max(t.col-o,0)),0<=t.row&&(r=Math.floor(e.countVisibleRows()/2),i.row=Math.max(t.row-r,0)),e.scrollViewportTo({...i,verticalSnap:"top",horizontalSnap:"start"}))}}},(e,t)=>{"use strict";t.__esModule=!0;t.command={name:"selectAllCells",callback(e){e.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}}},(e,t)=>{"use strict";t.__esModule=!0;t.command={name:"selectAllCellsAndHeaders",callback(e){e.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}}},(e,t)=>{"use strict";t.__esModule=!0;t.command={name:"populateSelectedCellsData",callback(n){var t=n.getSelectedRange();const{row:i,col:o}=t[t.length-1].highlight.normalize(),s=n.getDataAtCell(i,o),a=new Map;for(let e=0;e<t.length;e++)t[e].forAll((e,t)=>{var r;0<=e&&0<=t&&(e!==i||t!==o)&&(r=n.getCellMeta(e,t)["readOnly"],r||a.set(e+"x"+t,[e,t,s]))});n.setDataAtCell(Array.from(a.values()))}}},(e,t,r)=>{"use strict";t.__esModule=!0,t.shortcutsGridContext=function(t){const e=t.getShortcutManager().addContext("grid"),r=(0,s.createKeyboardShortcutCommandsPool)(t),n={runOnlyIf:()=>{var e=t.getSettings()["navigableHeaders"];return(0,i.isDefined)(t.getSelected())&&(e||!e&&0<t.countRenderedRows()&&0<t.countRenderedCols())},group:o.GRID_GROUP};e.addShortcuts([{keys:[["F2"]],callback:e=>r.editorFastOpen(e)},{keys:[["Enter"],["Enter","Shift"]],callback:(e,t)=>r.editorOpen(e,t)},{keys:[["Backspace"],["Delete"]],callback:()=>r.emptySelectedCells()}],{group:o.EDITOR_EDIT_GROUP,runOnlyIf:()=>(0,i.isDefined)(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>r.selectAllCells(),runOnlyIf:()=>!t.getSelectedRangeLast().highlight.isHeader()},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>t.getSelectedRangeLast().highlight.isHeader(),preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>r.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>r.populateSelectedCellsData(),runOnlyIf:()=>!t.getSelectedRangeLast().highlight.isHeader()&&1<t.getSelectedRangeLast().getCellsCount()},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>r.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>r.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>r.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>r.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>r.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>r.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>r.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>r.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>r.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>r.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>r.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>r.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>r.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:e=>r.moveCellSelectionInlineStart(e)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:e=>r.moveCellSelectionInlineEnd(e)},{keys:[["Control/Meta","Backspace"]],callback:()=>r.scrollToFocusedCell()}],n)};var i=r(337),o=r(658),s=r(659)},(e,t,r)=>{"use strict";t.__esModule=!0,t.installFocusDetector=function(e){let t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};const r=e.rootElement,n=o(e),i=o(e);return n.addEventListener("focus",()=>null===t||void 0===t?void 0:t.onFocusFromTop()),i.addEventListener("focus",()=>null===t||void 0===t?void 0:t.onFocusFromBottom()),r.firstChild.before(n),r.lastChild.after(i),{activate(){e._registerTimeout(()=>{n.tabIndex=0,i.tabIndex=0},10)},deactivate(){e._registerTimeout(()=>{n.tabIndex=-1,i.tabIndex=-1},10)}}};var n=r(334),i=r(479);function o(e){var t=e.rootDocument.createElement("input");return t.type="text",t.classList.add("htFocusCatcher"),e.getSettings().ariaTags&&(0,n.setAttribute)(t,[(0,i.A11Y_PRESENTATION)(),(0,i.A11Y_HIDDEN)()]),t}},(e,t,r)=>{"use strict";t.__esModule=!0,t.createViewportScroller=function(n){const i=n["selection"];let e=!1,o=!1;return{resume(){o=!1},suspend(){o=!0},skipNextScrollCycle(){e=!0},scrollTo(t){var r;if(e||o)e=!1;else{let e;i.isFocusSelectionChanged()?e=(0,l.focusScrollStrategy)(n):i.isSelectedByCorner()?e=(0,a.cornerHeaderScrollStrategy)(n):i.isSelectedByRowHeader()?e=(0,d.rowHeaderScrollStrategy)(n):i.isSelectedByColumnHeader()?e=(0,s.columnHeaderScrollStrategy)(n):1===i.getSelectedRange().size()&&i.isMultiple()?e=(0,c.multipleScrollStrategy)(n):1!==i.getSelectedRange().size()||i.isMultiple()?1<i.getSelectedRange().size()&&(e=(0,u.noncontiguousScrollStrategy)(n)):e=(0,h.singleScrollStrategy)(n),null!=(r=e)&&r(t)}}}};var s=r(710),a=r(711),l=r(712),c=r(713),u=r(714),d=r(715),h=r(716)},(e,t)=>{"use strict";t.__esModule=!0,t.columnHeaderScrollStrategy=function(t){return e=>{e=e.col;t.scrollViewportTo({col:e})}}},(e,t)=>{"use strict";t.__esModule=!0,t.cornerHeaderScrollStrategy=function(){return()=>{}}},(e,t)=>{"use strict";t.__esModule=!0,t.focusScrollStrategy=function(t){return e=>{t.scrollViewportTo(e.toObject())}}},(e,t)=>{"use strict";t.__esModule=!0,t.multipleScrollStrategy=function(t){return e=>{t.scrollViewportTo(e.toObject())}}},(e,t)=>{"use strict";t.__esModule=!0,t.noncontiguousScrollStrategy=function(t){return e=>{t.scrollViewportTo(e.toObject())}}},(e,t)=>{"use strict";t.__esModule=!0,t.rowHeaderScrollStrategy=function(t){return e=>{e=e.row;t.scrollViewportTo({row:e})}}},(e,t)=>{"use strict";t.__esModule=!0,t.singleScrollStrategy=function(n){return e=>{var t=n.selection.getSelectionSource(),{row:e,col:r}=e;e<0&&0<=r?n.scrollViewportTo({col:r}):r<0&&0<=e?n.scrollViewportTo({row:e}):("mouse"!==t||r!==n.view.getLastPartiallyVisibleColumn()&&e!==n.view.getLastPartiallyVisibleRow())&&n.scrollViewportTo({row:e,col:r})}}},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(718);t.createShortcutManager=r.createShortcutManager},(e,t,r)=>{"use strict";t.__esModule=!0,r(204);var a=r(513),g=r(492),m=r(719),l=r(721),c=r(477);t.createShortcutManager=e=>{var{ownerWindow:e,handleEvent:t,beforeKeyDown:r,afterKeyDown:n}=e;const i=(0,a.createUniqueMap)({errorIdExists:e=>`The "${e}" context name is already registered.`});let d="grid";const o=()=>d,h=e=>i.getItem(e);let p=!1;function f(t,r){var e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:d,e=(0,m.isContextObject)(e)?e:h(e);let n=!1;if(e.hasShortcut(r)){var i=e.getShortcuts(r);for(let e=0;e<i.length;e++){var{callback:o,runOnlyIf:s,preventDefault:a,stopPropagation:l,captureCtrl:c,forwardToContext:u}=i[e];if(!0===s(t)){if(p=c,n=!1===o(t,r),p=!1,a&&t.preventDefault(),l&&((0,g.stopImmediatePropagation)(t),t.stopPropagation()),n)break;u&&f(t,r,u)}}}return n}const s=(0,l.useRecorder)(e,t,r,n,f);return s.mount(),{addContext:e=>{var t=(0,m.createContext)(e);return i.addItem(e,t),t},getActiveContextName:o,getContext:h,setActiveContextName:e=>{if(!i.hasItem(e))throw new Error((0,c.toSingleLine)`You've tried to activate the "${e}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);d=e},isCtrlPressed:()=>!p&&(s.isPressed("control")||s.isPressed("meta")),releasePressedKeys:()=>s.releasePressedKeys(),destroy:()=>s.unmount()}}},(e,t,r)=>{"use strict";t.__esModule=!0,t.isContextObject=m,r(204),r(286);var n=r(513),h=r(720),p=r(337),f=r(480),s=r(482),g=r(477);const a=Symbol("shortcut-context");function m(e){return(0,s.isObject)(e)&&e.__kindOf===a}t.createContext=t=>{function i(){let{keys:e,callback:t,group:r,runOnlyIf:n=()=>!0,captureCtrl:i=!1,preventDefault:o=!0,stopPropagation:s=!1,relativeToGroup:a,position:l,forwardToContext:c}=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if((0,p.isUndefined)(r))throw new Error("You need to define the shortcut's group.");if(!1===(0,f.isFunction)(t))throw new Error("The shortcut's callback needs to be a function.");if(!1===Array.isArray(e))throw new Error((0,g.toSingleLine)`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const u={callback:t,group:r,runOnlyIf:n,captureCtrl:i,preventDefault:o,stopPropagation:s};(0,p.isDefined)(a)&&(u.relativeToGroup=a,u.position=l),m(c)&&(u.forwardToContext=c),e.forEach(t=>{t=(0,h.normalizeKeys)(t);if(d.hasItem(t)){var r=d.getItem(t);let e=r.findIndex(e=>e.group===a);-1!==e?"before"===l?--e:e+=1:e=r.length,r.splice(e,0,u)}else d.addItem(t,[u])})}const d=(0,n.createUniqueMap)({errorIdExists:e=>`The "${e}" shortcut is already registered in the "${t}" context.`});const o=e=>{e=(0,h.normalizeKeys)(e);d.removeItem(e)};return{__kindOf:a,addShortcut:i,addShortcuts:function(e){let n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};e.forEach(r=>{(0,s.objectEach)(n,(e,t)=>{!1===Object.prototype.hasOwnProperty.call(r,t)&&(r[t]=n[t])}),i(r)})},getShortcuts:e=>{e=(0,h.normalizeKeys)(e),e=d.getItem(e);return(0,p.isDefined)(e)?e.slice():[]},hasShortcut:e=>{e=(0,h.normalizeKeys)(e);return d.hasItem(e)},removeShortcutsByKeys:o,removeShortcutsByGroup:n=>{d.getItems().forEach(e=>{var[e,t]=e,r=t.filter(e=>e.group!==n);0===r.length?o((0,h.getKeysList)(e)):(t.length=0,t.push(...r))})}}}},(e,t)=>{"use strict";t.__esModule=!0;const r=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]);t.normalizeKeys=e=>e.map(e=>{e=e.toLowerCase();return r.has(e)?r.get(e):e}).sort().join("+");t.getKeysList=e=>e.split("+");const n=new Map([[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]);t.normalizeEventKey=e=>{var{which:e,key:t}=e;return n.has(e)?n.get(e):(e=String.fromCharCode(e).toLowerCase(),/^[a-z0-9]$/.test(e)?e:t.toLowerCase())}},(e,t,r)=>{"use strict";t.__esModule=!0,t.useRecorder=function(i,e,o,s,a){const l=e=>n.includes(e),c=function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],r=[];return e.altKey&&r.push("alt"),t&&(e.ctrlKey||e.metaKey)?r.push("control/meta"):(e.ctrlKey&&r.push("control"),e.metaKey&&r.push("meta")),e.shiftKey&&r.push("shift"),r},u=t=>{if(!1!==e(t)){var r=o(t);if(229!==t.keyCode&&!1!==r&&!(0,p.isImmediatePropagationStopped)(t)){r=(0,h.normalizeEventKey)(t);let e=[];l(r)||(e=c(t));var n=[r].concat(e);!a(t,n)&&((0,g.isMacOS)()&&e.includes("meta")||!(0,g.isMacOS)()&&e.includes("control"))&&a(t,[r].concat(c(t,!0))),s(t)}}},t=e=>{e.key&&(e=(0,h.normalizeEventKey)(e),l(e))&&m.press(e)},r=e=>{e.key&&(e=(0,h.normalizeEventKey)(e),l(e))&&m.release(e)},d=()=>{m.releaseAll()};return{mount:()=>{let e=i;for(v+=1;e;)1===v&&(e.document.documentElement.addEventListener("keydown",t),y.push({event:"keydown",listener:t}),e.document.documentElement.addEventListener("keyup",r),y.push({event:"keyup",listener:r})),e.document.documentElement.addEventListener("keydown",u),e.document.documentElement.addEventListener("blur",d),e=(0,f.getParentWindow)(e)},unmount:()=>{let t=i;for(--v;t;){if(0===v){for(let e=0;e<y.length;e++){var{event:r,listener:n}=y[e];t.document.documentElement.removeEventListener(r,n)}y.length=0}t.document.documentElement.removeEventListener("keydown",u),t.document.documentElement.removeEventListener("blur",d),t=(0,f.getParentWindow)(t)}},isPressed:e=>m.isPressed(e),releasePressedKeys:()=>m.releaseAll()}},r(286);var t=r(722),h=r(720),p=r(492),f=r(334),g=r(481);const n=["meta","alt","shift","control"],m=(0,t.createKeysObserver)(),y=[];let v=0},(e,t,r)=>{"use strict";t.__esModule=!0,t.createKeysObserver=function(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}},r(290),r(302),r(305),r(309),r(312),r(315),r(318)},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(724);t.CELL_TYPE=r.CELL_TYPE,t.TextCellType=r.TextCellType},(e,t,r)=>{"use strict";t.__esModule=!0;var n=r(725),r=r(729);t.CELL_TYPE="text",t.TextCellType={CELL_TYPE:"text",editor:n.TextEditor,renderer:r.textRenderer}},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(726);t.EDITOR_TYPE=r.EDITOR_TYPE,t.TextEditor=r.TextEditor},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(487))),a=r(663),o=n(r(502)),s=r(481),l=r(334),c=r(512),u=r(727),d=r(337),h=r(728),p=r(479);const f="ht_editor_hidden",g="textEditor";t.EDITOR_TYPE="text";class m extends a.BaseEditor{static get EDITOR_TYPE(){return"text"}constructor(e){super(e),(0,i.default)(this,"eventManager",new o.default(this)),(0,i.default)(this,"autoResize",(0,u.createInputElementResizer)(this.hot.rootDocument)),(0,i.default)(this,"TEXTAREA",void 0),(0,i.default)(this,"textareaStyle",void 0),(0,i.default)(this,"TEXTAREA_PARENT",void 0),(0,i.default)(this,"textareaParentStyle",void 0),(0,i.default)(this,"layerClass",void 0),this.eventManager=new o.default(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),(0,l.isThisHotChild)(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,t,r,n,i,o){var s=this.state;super.prepare(e,t,r,n,i,o),o.readOnly||(this.refreshDimensions(!0),e=o["allowInvalid"],e&&!this.isOpened()&&(this.TEXTAREA.value=""),s===a.EDITOR_STATE.FINISHED)||this.isOpened()||this.hideEditableElement()}beginEditing(e,t){this.state===a.EDITOR_STATE.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,t))}focus(){this.TEXTAREA.select(),(0,l.setCaretPosition)(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){var e=this.hot["rootDocument"];this.TEXTAREA=e.createElement("TEXTAREA"),(0,l.setAttribute)(this.TEXTAREA,[["data-hot-input",""],(0,p.A11Y_TABINDEX)(-1)]),this.hot.getSettings().ariaTags&&(0,l.setAttribute)(this.TEXTAREA,[(0,p.A11Y_HIDDEN)()]),(0,l.addClass)(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),(0,l.addClass)(this.TEXTAREA_PARENT,"handsontableInputHolder"),(0,l.hasClass)(this.TEXTAREA_PARENT,this.layerClass)&&(0,l.removeClass)(this.TEXTAREA_PARENT,this.layerClass),(0,l.addClass)(this.TEXTAREA_PARENT,f),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){(0,s.isEdge)()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",(0,l.removeClass)(this.TEXTAREA_PARENT,this.layerClass),(0,l.addClass)(this.TEXTAREA_PARENT,f)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const t=this.TEXTAREA_PARENT.childNodes;let r=!1;(0,c.rangeEach)(t.length-1,e=>{e=t[e];if((0,l.hasClass)(e,"handsontableEditor"))return!(r=!0)}),(0,l.hasClass)(this.TEXTAREA_PARENT,f)&&(0,l.removeClass)(this.TEXTAREA_PARENT,f),r?this.layerClass="ht_editor_visible":this.layerClass=this.getEditedCellsLayerClass(),(0,l.addClass)(this.TEXTAREA_PARENT,this.layerClass)}refreshValue(){var e=this.hot.toPhysicalRow(this.row),e=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){var e,t,r,n,i,o,s=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.state!==a.EDITOR_STATE.EDITING&&!s||(this.TD=this.getEditedCell(),this.TD?({top:t,start:n,width:e,maxWidth:i,height:r,maxHeight:o}=this.getEditedCellRect(),this.textareaParentStyle.top=t+"px",this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=n+"px",this.showEditableElement(),t=(0,l.getComputedStyle)(this.TD,this.hot.rootWindow),this.TEXTAREA.style.fontSize=t.fontSize,this.TEXTAREA.style.fontFamily=t.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,n=(0,l.getComputedStyle)(this.TEXTAREA),t=parseInt(n.paddingLeft,10)+parseInt(n.paddingRight,10),n=r-(r=parseInt(n.paddingTop,10)+parseInt(n.paddingBottom,10)),i=i-t,o=o-r,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(e-t,i),minHeight:Math.min(n,o),maxWidth:i,maxHeight:o},!0)):s||this.close())}bindEvents(){(0,s.isIOS)()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===a.EDITOR_STATE.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===a.EDITOR_STATE.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){var e=this.hot.getShortcutManager().getContext("editor"),t={runOnlyIf:()=>(0,d.isDefined)(this.hot.getSelected()),group:g};const r=()=>{this.hot.rootDocument.execCommand("insertText",!1,"\n")};e.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(r(),!1),runOnlyIf:e=>!this.hot.selection.isMultiple()&&!e.altKey},{keys:[["Meta","Enter"]],callback:()=>(r(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(r(),!1)},{keys:[["Home"]],callback:(e,t)=>{var[t]=t;(0,h.updateCaretPosition)(t,this.TEXTAREA)}},{keys:[["End"]],callback:(e,t)=>{var[t]=t;(0,h.updateCaretPosition)(t,this.TEXTAREA)}}],t)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(g)}}t.TextEditor=m},(e,t)=>{"use strict";function u(e,t,r){e.addEventListener(t,r,!1)}function n(e,t,r){e.removeEventListener(t,r,!1)}function d(e){return e.ownerDocument.defaultView.getComputedStyle(e)}t.__esModule=!0,t.createInputElementResizer=function(e){const i={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},r=e.body,o=e.createTextNode(""),s=e.createElement("span");let a;function l(){o.textContent=a.value,s.style.position="absolute",s.style.fontSize=d(a).fontSize,s.style.fontFamily=d(a).fontFamily,s.style.whiteSpace="pre",r.appendChild(s);var e=s.clientWidth+2,t=(r.removeChild(s),a.style),e=(t.height=i.minHeight+"px",i.minWidth>e?t.width=i.minWidth+"px":e>i.maxWidth?t.width=i.maxWidth+"px":t.width=e+"px",a.scrollHeight?a.scrollHeight-1:0);i.minHeight>e?t.height=i.minHeight+"px":i.maxHeight<e?(t.height=i.maxHeight+"px",t.overflowY="visible"):t.height=e+"px"}function c(){e.defaultView.setTimeout(l,0)}return{init:function(e,t){var r,n=2<arguments.length&&void 0!==arguments[2]&&arguments[2];a=e,(e=t)&&e.minHeight&&("inherit"===e.minHeight?i.minHeight=a.clientHeight:(r=parseInt(e.minHeight,10),isNaN(r)||(i.minHeight=r))),e&&e.maxHeight&&("inherit"===e.maxHeight?i.maxHeight=a.clientHeight:(r=parseInt(e.maxHeight,10),isNaN(r)||(i.maxHeight=r))),e&&e.minWidth&&("inherit"===e.minWidth?i.minWidth=a.clientWidth:(r=parseInt(e.minWidth,10),isNaN(r)||(i.minWidth=r))),e&&e.maxWidth&&("inherit"===e.maxWidth?i.maxWidth=a.clientWidth:(r=parseInt(e.maxWidth,10),isNaN(r)||(i.maxWidth=r))),s.firstChild||(s.className="autoResize",s.style.display="inline-block",s.appendChild(o)),"TEXTAREA"===a.nodeName&&(a.style.resize="none",a.style.height=i.minHeight+"px",a.style.minWidth=i.minWidth+"px",a.style.maxWidth=i.maxWidth+"px",a.style.overflowY="hidden"),n&&(u(a,"input",l),u(a,"keydown",c)),l()},resize:l,unObserve(){n(a,"input",l),n(a,"keydown",c)}}}},(e,t,r)=>{"use strict";t.__esModule=!0,t.updateCaretPosition=function(t,e){var r=(0,a.getCaretPosition)(e),n=e.value.split("\n");let i=r,o=0;for(let e=0;e<n.length;e++){var s=n[e],s=(0!==e&&(o+=n[e-1].length+1),o+s.length);if("home"===t?i=o:"end"===t&&(i=s),r<=s)break}(0,a.setCaretPosition)(e,i)};var a=r(334)},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(730);t.RENDERER_TYPE=r.RENDERER_TYPE,t.textRenderer=r.textRenderer},(e,t,r)=>{"use strict";t.__esModule=!0,t.textRenderer=n;var l=r(731),c=r(334),u=r(337);t.RENDERER_TYPE="text";function n(e,t,r,n,i,o,s){l.baseRenderer.apply(this,[e,t,r,n,i,o,s]);let a=o;!a&&s.placeholder&&(a=s.placeholder),a=(0,u.stringify)(a),s.trimWhitespace&&(a=a.trim()),s.rendererTemplate?((0,c.empty)(t),(n=e.rootDocument.createElement("TEMPLATE")).setAttribute("bind","{{}}"),n.innerHTML=s.rendererTemplate,HTMLTemplateElement.decorate(n),n.model=e.getSourceDataAtRow(r),t.appendChild(n)):(0,c.fastInnerText)(t,a)}n.RENDERER_TYPE="text"},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(732);t.RENDERER_TYPE=r.RENDERER_TYPE,t.baseRenderer=r.baseRenderer},(e,t,r)=>{"use strict";t.__esModule=!0,t.baseRenderer=n,r(286);var h=r(334),p=r(479);t.RENDERER_TYPE="base";function n(e,t,r,n,i,o,s){var a=s.ariaTags,l=[],c=[],u=[],d=[];s.className&&(0,h.addClass)(t,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&d.push((0,p.A11Y_READONLY)())):a&&u.push((0,p.A11Y_READONLY)()[0]),!1===s.valid&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&d.push((0,p.A11Y_INVALID)())):(c.push(s.invalidCellClassName),a&&u.push((0,p.A11Y_INVALID)()[0])),!1===s.wordWrap&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),(0,h.removeClass)(t,c),(0,h.addClass)(t,l),(0,h.removeAttribute)(t,u),(0,h.setAttribute)(t,d)}n.RENDERER_TYPE="base"},(e,t,r)=>{"use strict";t.__esModule=!0,t.registerAllModules=function(){(0,n.registerAllEditors)(),(0,i.registerAllRenderers)(),(0,o.registerAllValidators)(),(0,s.registerAllCellTypes)(),(0,a.registerAllPlugins)()};var n=r(734),i=(t.registerAllEditors=n.registerAllEditors,r(755)),o=(t.registerAllRenderers=i.registerAllRenderers,r(777)),s=(t.registerAllValidators=o.registerAllValidators,r(789)),a=(t.registerAllCellTypes=s.registerAllCellTypes,r(810));t.registerAllPlugins=a.registerAllPlugins},(e,t,r)=>{"use strict";t.__esModule=!0,t.registerAllEditors=function(){(0,f.registerEditor)(i.BaseEditor),(0,f.registerEditor)(n.AutocompleteEditor),(0,f.registerEditor)(o.CheckboxEditor),(0,f.registerEditor)(s.DateEditor),(0,f.registerEditor)(a.DropdownEditor),(0,f.registerEditor)(l.HandsontableEditor),(0,f.registerEditor)(c.NumericEditor),(0,f.registerEditor)(u.PasswordEditor),(0,f.registerEditor)(d.SelectEditor),(0,f.registerEditor)(h.TextEditor),(0,f.registerEditor)(p.TimeEditor)};var n=r(735),i=(t.AutocompleteEditor=n.AutocompleteEditor,t.AUTOCOMPLETE_EDITOR=n.EDITOR_TYPE,r(663)),o=(t.BaseEditor=i.BaseEditor,t.BASE_EDITOR=i.EDITOR_TYPE,r(739)),s=(t.CheckboxEditor=o.CheckboxEditor,t.CHECKBOX_EDITOR=o.EDITOR_TYPE,r(741)),a=(t.DateEditor=s.DateEditor,t.DATE_EDITOR=s.EDITOR_TYPE,r(745)),l=(t.DropdownEditor=a.DropdownEditor,t.DROPDOWN_EDITOR=a.EDITOR_TYPE,r(737)),c=(t.HandsontableEditor=l.HandsontableEditor,t.HANDSONTABLE_EDITOR=l.EDITOR_TYPE,r(747)),u=(t.NumericEditor=c.NumericEditor,t.NUMERIC_EDITOR=c.EDITOR_TYPE,r(749)),d=(t.PasswordEditor=u.PasswordEditor,t.PASSWORD_EDITOR=u.EDITOR_TYPE,r(751)),h=(t.SelectEditor=d.SelectEditor,t.SELECT_EDITOR=d.EDITOR_TYPE,r(725)),p=(t.TextEditor=h.TextEditor,t.TEXT_EDITOR=h.EDITOR_TYPE,r(753)),f=(t.TimeEditor=p.TimeEditor,t.TIME_EDITOR=p.EDITOR_TYPE,r(493));t.registerEditor=f.registerEditor,t.RegisteredEditor=f.RegisteredEditor,t._getEditorInstance=f._getEditorInstance,t.getEditor=f.getEditor,t.getEditorInstance=f.getEditorInstance,t.getRegisteredEditorNames=f.getRegisteredEditorNames,t.getRegisteredEditors=f.getRegisteredEditors,t.hasEditor=f.hasEditor},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(736);t.EDITOR_TYPE=r.EDITOR_TYPE,t.AutocompleteEditor=r.AutocompleteEditor},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),r(286),n(r(487))),n=r(737),u=r(478),h=r(334),p=r(337),d=r(335),o=r(491),s=r(481),f=r(729),g=r(479);function a(e,t,r){var n=e;if(t.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object");t.set(e,r)}function l(e,t){return e.get(function(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}(e,t))}t.EDITOR_TYPE="autocomplete";var m=new WeakMap;class c extends n.HandsontableEditor{constructor(){super(...arguments),(0,i.default)(this,"query",null),(0,i.default)(this,"strippedChoices",[]),(0,i.default)(this,"rawChoices",[]),a(this,m,this.hot.guid.slice(0,9)),(0,i.default)(this,"sortByRelevance",function(e,t,r){var n=[],i=[],o=e.length;let s=t.length,a,l;if(0===o)for(a=0;a<s;a++)i.push(a);else{for(a=0;a<s;a++){var c,u=(0,d.stripTags)((0,p.stringify)(t[a]));-1!==(l=r?u.indexOf(e):(c=this.cellProperties.locale,u.toLocaleLowerCase(c).indexOf(e.toLocaleLowerCase(c))))&&(c=u.length-l-o,n.push({baseIndex:a,index:l,charsLeft:c,value:u}))}for(n.sort((e,t)=>{if(-1===t.index)return-1;if(-1===e.index)return 1;if(e.index<t.index)return-1;if(t.index<e.index)return 1;if(e.index===t.index){if(e.charsLeft<t.charsLeft)return-1;if(e.charsLeft>t.charsLeft)return 1}return 0}),a=0,s=n.length;a<s;a++)i.push(n[a].baseIndex)}return i})}static get EDITOR_TYPE(){return"autocomplete"}getValue(){var e=this.rawChoices.find(e=>{return this.stripValueIfNeeded(e)===this.TEXTAREA.value});return(0,p.isDefined)(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),(0,h.addClass)(this.htContainer,"autocompleteEditor"),(0,h.addClass)(this.htContainer,-1===this.hot.rootWindow.navigator.platform.indexOf("Mac")?"":"htMacScroll"),this.hot.getSettings().ariaTags&&(0,h.setAttribute)(this.TEXTAREA,[(0,g.A11Y_TEXT)(),(0,g.A11Y_COMBOBOX)(),(0,g.A11Y_HASPOPUP)("listbox"),(0,g.A11Y_AUTOCOMPLETE)()])}prepare(e,t,r,n,i,o){super.prepare(e,t,r,n,i,o),this.hot.getSettings().ariaTags&&(0,h.setAttribute)(this.TEXTAREA,[(0,g.A11Y_EXPANDED)("false"),(0,g.A11Y_CONTROLS)(l(m,this)+`-listbox-${e}-`+t)])}open(){super.open();var e=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown;const c=this.hot.getSettings().ariaTags,u=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,d=null===u||void 0===u?void 0:u.length;var{row:t,col:r}=this;this.showEditableElement(),this.focus();let n=(0,h.getScrollbarWidth)();0===n&&(0,s.isMacOS)()&&(n+=15),this.addHook("beforeKeyDown",e=>this.onBeforeKeyDown(e)),this.htEditor.updateSettings({colWidths:e?[(0,h.outerWidth)(this.TEXTAREA)-2]:void 0,width:e?(0,h.outerWidth)(this.TEXTAREA)+n:void 0,autoColumnSize:!0,renderer:(e,t,r,n,i,o,s)=>{(0,f.textRenderer)(e,t,r,n,i,o,s);var{filteringCaseSensitive:e,allowHtml:i,locale:s}=this.cellProperties,a=this.query;let l=(0,p.stringify)(o);l&&!i&&-1!==(i=!0===e?l.indexOf(a):l.toLocaleLowerCase(s).indexOf(a.toLocaleLowerCase(s)))&&(e=l.substr(i,a.length),l=l.replace(e,`<strong>${e}</strong>`)),c&&(0,h.setAttribute)(t,[(0,g.A11Y_OPTION)(),...u?[(0,g.A11Y_SETSIZE)(d)]:[],...u?[(0,g.A11Y_POSINSET)(u.indexOf(o)+1)]:[],["id",this.htEditor.rootElement.id+`_${r}-`+n]]),t.innerHTML=l},afterSelectionEnd:(e,t)=>{c&&(e=this.htEditor.getCell(e,t,!0),(0,h.setAttribute)(e,[(0,g.A11Y_SELECTED)()]),(0,h.setAttribute)(this.TEXTAREA,...(0,g.A11Y_ACTIVEDESCENDANT)(e.id)))}}),c&&((0,h.setAttribute)(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...(0,g.A11Y_PRESENTATION)()),(0,h.setAttribute)(this.htEditor.rootElement,[(0,g.A11Y_LISTBOX)(),(0,g.A11Y_LIVE)("polite"),(0,g.A11Y_RELEVANT)("text"),["id",l(m,this)+`-listbox-${t}-`+r]]),(0,h.setAttribute)(this.TEXTAREA,...(0,g.A11Y_EXPANDED)("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&(0,h.setAttribute)(this.TEXTAREA,[(0,g.A11Y_EXPANDED)("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){var t=this.cellProperties.source;this.query=e,"function"==typeof t?t.call(this.cellProperties,e,e=>{this.rawChoices=e,this.updateChoicesList(this.stripValuesIfNeeded(e))}):Array.isArray(t)?(this.rawChoices=t,this.updateChoicesList(this.stripValuesIfNeeded(t))):this.updateChoicesList([])}updateChoicesList(e){var t=(0,h.getCaretPosition)(this.TEXTAREA),r=(0,h.getSelectionEndPosition)(this.TEXTAREA),n=this.cellProperties.sortByRelevance,i=this.cellProperties.filter;let o=null,s=null,a=e;n&&(o=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),a,this.cellProperties.filteringCaseSensitive));var l=Array.isArray(o)?o.length:0;if(!1===i)l&&(s=o[0]);else{var c=[];for(let e=0,t=a.length;e<t&&!(n&&l<=e);e++)c.push(l?a[o[e]]:a[e]);s=0,a=c}0===(this.strippedChoices=a).length?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData((0,u.pivot)([a])),0<a.length&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),!0===this.cellProperties.strict)&&this.highlightBestMatchingChoice(s),this.hot.listen(),(0,h.setCaretPosition)(this.TEXTAREA,t,t===r?void 0:r)}flipDropdownIfNeeded(){var e,t,r,n,i=(0,h.getTrimmingContainer)(this.hot.view._wt.wtTable.TABLE),o=i===this.hot.rootWindow,s=this.cellProperties.preventOverflow;return!o&&(o||!s&&"horizontal"!==s)&&(o=(0,h.offset)(this.TEXTAREA),s=(0,h.outerHeight)(this.TEXTAREA),e=this.getDropdownHeight(),n=i.scrollTop,t=(0,h.outerHeight)(this.hot.view._wt.wtTable.THEAD),r=(0,h.offset)(i),o=o.top-r.top-t+n,(n=(r=i.scrollHeight-o-t-s)<e&&r<o)?this.flipDropdown(e):this.unflipDropdown(),this.limitDropdownIfNeeded(n?o:r,e),n)}limitDropdownIfNeeded(n,i){if(n<i){let e=0,t=0,r=0;for(var o;r=this.htEditor.getRowHeight(t)||this.htEditor.view._wt.getSetting("defaultRowHeight"),e+=r,t+=1,e<n;);o=e-r,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=parseInt(this.htEditor.rootElement.style.top,10)+i-o+"px"),this.setDropdownHeight(e-r)}}flipDropdown(e){var t=this.htEditor.rootElement.style;t.position="absolute",t.top=-e+"px",this.htEditor.flipped=!0}unflipDropdown(){var e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){var e=this.htEditor.getColWidth(0)+(0,h.getScrollbarWidth)(this.hot.rootDocument)+2,t=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:t?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){"number"==typeof e?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){var e=this.htEditor.getRowHeight(0)||23,t=this.cellProperties.visibleRows;return this.strippedChoices.length>=t?t*e:this.strippedChoices.length*e+8}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const t=this.cellProperties["allowHtml"];e=(0,u.arrayMap)(e,e=>(0,p.stringify)(e));return(0,u.arrayMap)(e,e=>t?e:(0,d.stripTags)(e))}allowKeyEventPropagation(e){var t=this.htEditor.getSelectedRangeLast();const r=t?t.from.row:-1;let n=!1;return e===o.KEY_CODES.ARROW_DOWN&&0<r&&r<this.htEditor.countRows()-1&&(n=!0),n=e===o.KEY_CODES.ARROW_UP&&-1<r?!0:n}onBeforeKeyDown(t){if((0,o.isPrintableChar)(t.keyCode)||t.keyCode===o.KEY_CODES.BACKSPACE||t.keyCode===o.KEY_CODES.DELETE||t.keyCode===o.KEY_CODES.INSERT){let e=10;t.keyCode===o.KEY_CODES.C&&(t.ctrlKey||t.metaKey)||(this.isOpened()||(e+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},e))}}}t.AutocompleteEditor=c},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(738);t.EDITOR_TYPE=r.EDITOR_TYPE,t.HandsontableEditor=r.HandsontableEditor},(e,t,r)=>{"use strict";t.__esModule=!0;var n=r(725),i=r(334),o=r(492),a=r(482),s=r(656);const l="handsontableEditor";t.EDITOR_TYPE="handsontable";class c extends n.TextEditor{static get EDITOR_TYPE(){return"handsontable"}open(){super.open(),this.htEditor&&this.htEditor.destroy(),"none"===this.htContainer.style.display&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),(0,i.setCaretPosition)(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,t,r,n,i,o){super.prepare(e,t,r,n,i,o);const s=this;e={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,afterOnCellMouseDown(e,t){t=this.getSourceData(t.row,t.col);void 0!==t&&s.setValue(t),s.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&(0,a.extend)(e,o.handsontable),this.htOptions=e}beginEditing(e,t){var r=this.hot.getSettings().onBeginEditing;r&&!1===r()||super.beginEditing(e,t)}createElements(){super.createElements();var e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,t,r){var n;this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()&&void 0!==(n=this.htEditor.getValue())&&this.setValue(n),super.finishEditing(e,t,r)}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()})}registerShortcuts(){var e=this.hot.getShortcutManager().getContext("editor"),t=(super.registerShortcuts(),{group:l,relativeToGroup:s.EDITOR_EDIT_GROUP,position:"before"});const i=(e,t)=>{var r=this.htEditor;if(void 0!==e&&(e<0||r.flipped&&e>r.countRows()-1?r.deselectCell():r.selectCell(e,0),r.getData().length))return t.preventDefault(),(0,o.stopImmediatePropagation)(t),this.hot.listen(),this.TEXTAREA.focus(),!1};e.addShortcuts([{keys:[["ArrowUp"]],callback:e=>{var t=this.htEditor;let r,n;return!t.getSelectedLast()&&t.flipped?r=t.countRows()-1:t.getSelectedLast()&&(r=t.flipped?(n=t.getSelectedLast()[0],Math.max(0,n-1)):(n=t.getSelectedLast()[0])-1),i(r,e)},preventDefault:!1},{keys:[["ArrowDown"]],callback:e=>{var t,r=this.htEditor;let n;return r.getSelectedLast()||r.flipped?r.getSelectedLast()&&(r.flipped?n=r.getSelectedLast()[0]+1:r.flipped||(t=r.countRows()-1,r=r.getSelectedLast()[0],n=Math.min(t,r+1))):n=0,i(n,e)},preventDefault:!1}],t)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(l)}}t.HandsontableEditor=c},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(740);t.EDITOR_TYPE=r.EDITOR_TYPE,t.CheckboxEditor=r.CheckboxEditor},(e,t,r)=>{"use strict";t.__esModule=!0;var n=r(663),i=r(334);t.EDITOR_TYPE="checkbox";class o extends n.BaseEditor{static get EDITOR_TYPE(){return"checkbox"}beginEditing(e,t){t&&"mouseup"===t.type&&"TD"===t.target.nodeName&&(t=this.TD.querySelector('input[type="checkbox"]'),(0,i.hasClass)(t,"htBadValue")||t.click())}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}t.CheckboxEditor=o},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(742);t.EDITOR_TYPE=r.EDITOR_TYPE,t.DateEditor=r.DateEditor},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),n(r(487))),o=n(r(338)),s=n(r(743)),a=r(663),n=r(725),l=r(334),c=r(482),u=r(491);r(744);t.EDITOR_TYPE="date";const d="dateEditor";class h extends n.TextEditor{constructor(){super(...arguments),(0,i.default)(this,"defaultDateFormat","DD/MM/YYYY"),(0,i.default)(this,"parentDestroyed",!1),(0,i.default)(this,"$datePicker",null)}static get EDITOR_TYPE(){return"date"}init(){if("function"!=typeof o.default)throw new Error("You need to include moment.js to your project.");if("function"!=typeof s.default)throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),(0,l.addClass)(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",e=>{(0,l.hasClass)(e.target,"pika-day")&&this.hideDatepicker(),e.stopPropagation()})}destroyElements(){var e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,t,r,n,i,o){super.prepare(e,t,r,n,i,o)}open(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),t.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:d})}close(){var e;this._opened=!1,null!=(e=this.$datePicker)&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{var e=this.hot._getEditorManager();e.closeEditor(),this.hot.view.render(),e.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(d),super.close()}finishEditing(){super.finishEditing(0<arguments.length&&void 0!==arguments[0]&&arguments[0],1<arguments.length&&void 0!==arguments[1]&&arguments[1])}showDatepicker(e){var t=this.cellProperties.dateFormat||this.defaultDateFormat,r=this.hot.view.isMouseDown(),e=!!e&&(0,u.isFunctionKey)(e.keyCode);let n;this.datePicker.style.display="block",this.$datePicker=new s.default(this.getDatePickerConfig()),"function"==typeof this.$datePicker.useMoment&&this.$datePicker.useMoment(o.default),this.$datePicker._onInputFocus=function(){},this.originalValue?(n=this.originalValue,(0,o.default)(n,t,!0).isValid()&&this.$datePicker.setMoment((0,o.default)(n,t),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),e||r||this.setValue("")):this.cellProperties.defaultDate?(n=this.cellProperties.defaultDate,(0,o.default)(n,t,!0).isValid()&&this.$datePicker.setMoment((0,o.default)(n,t),!0),e||r||this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var e=this.TEXTAREA,t={};this.cellProperties&&this.cellProperties.datePickerConfig&&(0,c.deepExtend)(t,this.cellProperties.datePickerConfig);const r=t.onSelect,n=t.onClose;return t.field=e,t.trigger=e,t.container=this.datePicker,t.bound=!1,t.keyboardInput=!1,t.format=t.format||this.defaultDateFormat,t.reposition=t.reposition||!1,t.isRTL=!1,t.onSelect=e=>{let t=e;isNaN(t.getTime())||(t=(0,o.default)(t).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(t),r&&r()},t.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),n&&n()},t}refreshDimensions(e){if(super.refreshDimensions(e),this.state===a.EDITOR_STATE.EDITING)if(this.TD=this.getEditedCell(),this.TD){var{rowIndexMapper:e,columnIndexMapper:t}=this.hot,r=this.hot.view._wt["wtOverlays"],r=(null!=(r=r.getParentOverlay(this.TD))?r:this.hot.view._wt)["wtTable"],n=e.getVisualFromRenderableIndex(r.getFirstPartiallyVisibleRow()),e=e.getVisualFromRenderableIndex(r.getLastPartiallyVisibleRow()),i=t.getVisualFromRenderableIndex(r.getFirstPartiallyVisibleColumn()),t=t.getVisualFromRenderableIndex(r.getLastPartiallyVisibleColumn());if(this.row>=n&&this.row<=e&&this.col>=i&&this.col<=t){r=this.TD.getBoundingClientRect();this.datePickerStyle.top=this.hot.rootWindow.pageYOffset+r.top+(0,l.outerHeight)(this.TD)+"px";let e=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?e+=r.right-(0,l.outerWidth)(this.datePicker):e+=r.left,this.datePickerStyle.left=e+"px"}else this.hideDatepicker()}else this.hideDatepicker()}}t.DateEditor=h},e=>{"use strict";function o(e,t,r,n){e.addEventListener(t,r,!!n)}function t(e,t,r,n){e.removeEventListener(t,r,!!n)}function s(e,t){return-1!==(" "+e.className+" ").indexOf(" "+t+" ")}function d(e,t){s(e,t)||(e.className=""===e.className?t:e.className+" "+t)}function h(e,t){e.className=(e=(" "+e.className+" ").replace(" "+t+" "," ")).trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function y(e){return/Array/.test(Object.prototype.toString.call(e))}function M(e){return/Date/.test(Object.prototype.toString.call(e))&&!isNaN(e.getTime())}function n(e,t){return[31,(e=e)%4==0&&e%100!=0||e%400==0?29:28,31,30,31,30,31,31,30,31,30,31][t]}function i(e){M(e)&&e.setHours(0,0,0,0)}function k(e,t){return e.getTime()===t.getTime()}function a(e,t,r){let n,i;for(n in t)(i=void 0!==e[n])&&"object"==typeof t[n]&&null!==t[n]&&void 0===t[n].nodeName?M(t[n])?r&&(e[n]=new Date(t[n].getTime())):y(t[n])?r&&(e[n]=t[n].slice(0)):e[n]=a({},t[n],r):!r&&i||(e[n]=t[n]);return e}function l(e,t,r){let n=f().createEvent("HTMLEvents");n.initEvent(t,!0,!1),n=a(n,r),e.dispatchEvent(n)}function r(e){return e.month<0&&(e.year-=Math.ceil(Math.abs(e.month)/12),e.month+=12),11<e.month&&(e.year+=Math.floor(Math.abs(e.month)/12),e.month-=12),e}function D(e,t){function r(e){return(e+7-1)%7}e.setHours(0,0,0,0);let n=e.getDate(),i=e.getDay(),o=t,s=o-1;return e.setDate(n+s-r(i)),t=new Date(e.getFullYear(),0,o),e=(e.getTime()-t.getTime())/864e5,1+Math.round((e-s+r(t.getDay()))/7)}function c(e,t,r){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+r+'">'+function(e){let t,r=[];for(e.showWeekNumber&&r.push("<th></th>"),t=0;t<7;t++)r.push('<th scope="col"><abbr title="'+m(e,t)+'">'+m(e,t,!0)+"</abbr></th>");return"<thead><tr>"+(e.isRTL?r.reverse():r).join("")+"</tr></thead>"}(e)+"<tbody>"+t.join("")+"</tbody></table>"}const p=()=>window,f=()=>window.document,u=(e,t)=>window.setTimeout(e,t),g={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},m=function(e,t,r){for(t+=e.firstDay;7<=t;)t-=7;return(r?e.i18n.weekdaysShort:e.i18n.weekdays)[t]};function v(e){let n=this,i=n.config(e);n._onMouseDown=function(e){if(n._v){var t=(e=e||p().event).target||e.srcElement;if(t)if(s(t,"is-disabled")||(!s(t,"pika-button")||s(t,"is-empty")||s(t.parentNode,"is-disabled")?s(t,"pika-prev")?n.prevMonth():s(t,"pika-next")&&n.nextMonth():(n.setDate(new Date(t.getAttribute("data-pika-year"),t.getAttribute("data-pika-month"),t.getAttribute("data-pika-day"))),i.bound&&u(function(){n.hide(),i.blurFieldOnSelect&&i.field&&i.field.blur()},100))),s(t,"pika-select"))n._c=!0;else{if(!e.preventDefault)return e.returnValue=!1;e.preventDefault()}}},n._onChange=function(e){e=(e=e||p().event).target||e.srcElement;e&&(s(e,"pika-select-month")?n.gotoMonth(e.value):s(e,"pika-select-year")&&n.gotoYear(e.value))},n._onKeyChange=function(e){if(e=e||p().event,n.isVisible())switch(e.keyCode){case 13:case 27:i.field&&i.field.blur();break;case 37:n.adjustDate("subtract",1);break;case 38:n.adjustDate("subtract",7);break;case 39:n.adjustDate("add",1);break;case 40:n.adjustDate("add",7);break;case 8:case 46:n.setDate(null)}},n._parseFieldValue=function(){var e;return i.parse?i.parse(i.field.value,i.format):this.hasMoment?(e=this.moment(i.field.value,i.format,i.formatStrict))&&e.isValid()?e.toDate():null:new Date(Date.parse(i.field.value))},n._onInputChange=function(e){e.firedBy===n||(e=n._parseFieldValue(),M(e)&&n.setDate(e),n._v)||n.show()},n._onInputFocus=function(){n.show()},n._onInputClick=function(){n.show()},n._onInputBlur=function(){let e=f().activeElement;do{if(s(e,"pika-single"))return}while(e=e.parentNode);n._c||(n._b=u(function(){n.hide()},50)),n._c=!1},n._onClick=function(e){let t=(e=e||p().event).target||e.srcElement,r=t;if(t){hasEventListeners||!s(t,"pika-select")||t.onchange||(t.setAttribute("onchange","return;"),o(t,"change",n._onChange));do{if(s(r,"pika-single")||r===i.trigger)return}while(r=r.parentNode);n._v&&t!==i.trigger&&r!==i.trigger&&n.hide()}},n.el=f().createElement("div"),n.el.className="pika-single"+(i.isRTL?" is-rtl":"")+(i.theme?" "+i.theme:""),o(n.el,"mousedown",n._onMouseDown,!0),o(n.el,"touchend",n._onMouseDown,!0),o(n.el,"change",n._onChange),i.keyboardInput&&o(f(),"keydown",n._onKeyChange),i.field&&(i.container?i.container.appendChild(n.el):i.bound?f().body.appendChild(n.el):i.field.parentNode.insertBefore(n.el,i.field.nextSibling),o(i.field,"change",n._onInputChange),i.defaultDate||(i.defaultDate=n._parseFieldValue(),i.setDefaultDate=!0));e=i.defaultDate;M(e)?i.setDefaultDate?n.setDate(e,!0):n.gotoDate(e):n.gotoDate(new Date),i.bound?(this.hide(),n.el.className+=" is-bound",o(i.trigger,"click",n._onInputClick),o(i.trigger,"focus",n._onInputFocus),o(i.trigger,"blur",n._onInputBlur)):this.show()}v.prototype={config:function(e){this._o||(this._o=a({},g,!0));var e=a(this._o,e,!0),t=(e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme="string"==typeof e.theme&&e.theme?e.theme:null,e.bound=!!(void 0!==e.bound?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn="function"==typeof e.disableDayFn?e.disableDayFn:null,parseInt(e.numberOfMonths,10)||1);return e.numberOfMonths=4<t?4:t,M(e.minDate)||(e.minDate=!1),M(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),y(e.yearRange)?(t=(new Date).getFullYear()-10,e.yearRange[0]=parseInt(e.yearRange[0],10)||t,e.yearRange[1]=parseInt(e.yearRange[1],10)||t):(e.yearRange=Math.abs(parseInt(e.yearRange,10))||g.yearRange,100<e.yearRange&&(e.yearRange=100)),e},toString:function(e){return e=e||this._o.format,M(this._d)?this._o.toString?this._o.toString(this._d,e):this.hasMoment?this.moment(this._d).format(e):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(e,t){this.hasMoment&&this.moment.isMoment(e)&&this.setDate(e.toDate(),t)},useMoment:function(e){this.hasMoment=!0,this.moment=e},getDate:function(){return M(this._d)?new Date(this._d.getTime()):null},setDate:function(e,t){if(!e)return this._d=null,this._o.field&&(this._o.field.value="",l(this._o.field,"change",{firedBy:this})),this.draw();var r,n;"string"==typeof e&&(e=new Date(Date.parse(e))),M(e)&&(r=this._o.minDate,n=this._o.maxDate,M(r)&&e<r?e=r:M(n)&&n<e&&(e=n),this._d=new Date(e.getTime()),i(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),l(this._o.field,"change",{firedBy:this})),t||"function"!=typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate()))},clear:function(){this.setDate(null)},gotoDate:function(e){let t=!0;var r,n,i;M(e)&&(this.calendars&&(r=new Date(this.calendars[0].year,this.calendars[0].month,1),n=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=e.getTime(),n.setMonth(n.getMonth()+1),n.setDate(n.getDate()-1),t=i<r.getTime()||n.getTime()<i),t&&(this.calendars=[{month:e.getMonth(),year:e.getFullYear()}],"right"===this._o.mainCalendar)&&(this.calendars[0].month+=1-this._o.numberOfMonths),this.adjustCalendars())},adjustDate:function(e,t){var r=this.getDate()||new Date,t=24*parseInt(t)*60*60*1e3;let n;"add"===e?n=new Date(r.valueOf()+t):"subtract"===e&&(n=new Date(r.valueOf()-t)),this.setDate(n)},adjustCalendars:function(){this.calendars[0]=r(this.calendars[0]);for(let e=1;e<this._o.numberOfMonths;e++)this.calendars[e]=r({month:this.calendars[0].month+e,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(e){isNaN(e)||(this.calendars[0].month=parseInt(e,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(e){isNaN(e)||(this.calendars[0].year=parseInt(e,10),this.adjustCalendars())},setMinDate:function(e){e instanceof Date?(i(e),this._o.minDate=e,this._o.minYear=e.getFullYear(),this._o.minMonth=e.getMonth()):(this._o.minDate=g.minDate,this._o.minYear=g.minYear,this._o.minMonth=g.minMonth,this._o.startRange=g.startRange),this.draw()},setMaxDate:function(e){e instanceof Date?(i(e),this._o.maxDate=e,this._o.maxYear=e.getFullYear(),this._o.maxMonth=e.getMonth()):(this._o.maxDate=g.maxDate,this._o.maxYear=g.maxYear,this._o.maxMonth=g.maxMonth,this._o.endRange=g.endRange),this.draw()},setStartRange:function(e){this._o.startRange=e},setEndRange:function(e){this._o.endRange=e},draw:function(e){if(this._v||e){let t=this._o,e=t.minYear,r=t.maxYear,n=t.minMonth,i=t.maxMonth,o="",s;this._y<=e&&(this._y=e,!isNaN(n))&&this._m<n&&(this._m=n),this._y>=r&&(this._y=r,!isNaN(i))&&this._m>i&&(this._m=i);for(let e=0;e<t.numberOfMonths;e++)s="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),o+='<div class="pika-lendar">'+function(e,t,r,n,i,o){let s,a,l,c=e._o,u=r===c.minYear,d=r===c.maxYear,h='<div id="'+o+'" class="pika-title" role="heading" aria-live="polite">',p,f,g=!0,m=!0;for(l=[],s=0;s<12;s++)l.push('<option value="'+(r===i?s-t:12+s-t)+'"'+(s===n?' selected="selected"':"")+(u&&s<c.minMonth||d&&s>c.maxMonth?' disabled="disabled"':"")+">"+c.i18n.months[s]+"</option>");for(p='<div class="pika-label">'+c.i18n.months[n]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",a=y(c.yearRange)?(s=c.yearRange[0],c.yearRange[1]+1):(s=r-c.yearRange,1+r+c.yearRange),l=[];s<a&&s<=c.maxYear;s++)s>=c.minYear&&l.push('<option value="'+s+'"'+(s===r?' selected="selected"':"")+">"+s+"</option>");return f='<div class="pika-label">'+r+c.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",c.showMonthAfterYear?h+=f+p:h+=p+f,u&&(0===n||c.minMonth>=n)&&(g=!1),d&&(11===n||c.maxMonth<=n)&&(m=!1),0===t&&(h+='<button class="pika-prev'+(g?"":" is-disabled")+'" type="button">'+c.i18n.previousMonth+"</button>"),t===e._o.numberOfMonths-1&&(h+='<button class="pika-next'+(m?"":" is-disabled")+'" type="button">'+c.i18n.nextMonth+"</button>"),h+="</div>"}(this,e,this.calendars[e].year,this.calendars[e].month,this.calendars[0].year,s)+this.render(this.calendars[e].year,this.calendars[e].month,s)+"</div>";this.el.innerHTML=o,t.bound&&"hidden"!==t.field.type&&u(function(){t.trigger.focus()},1),"function"==typeof this._o.onDraw&&this._o.onDraw(this),t.bound&&t.field.setAttribute("aria-label",t.ariaLabel)}},adjustPosition:function(){let e,t,r,n,i,o,s,a,l,c,u;this._o.container||(this.el.style.position="absolute",e=this._o.trigger,t=this.el.offsetWidth,r=this.el.offsetHeight,n=p().innerWidth||f().documentElement.clientWidth,i=p().innerHeight||f().documentElement.clientHeight,o=f().body.scrollTop||f().documentElement.scrollTop,c=!0,u=!0,l=e.getBoundingClientRect(),s=l.left+p().pageXOffset,a=l.bottom+p().pageYOffset,(this._o.reposition&&s+t>n||-1<this._o.position.indexOf("right")&&0<s-t+e.offsetWidth)&&(s=s-t+e.offsetWidth,c=!1),(this._o.reposition&&a+r>i+o||-1<this._o.position.indexOf("top")&&0<a-r-e.offsetHeight)&&(a=a-r-e.offsetHeight,u=!1),s<0&&(s=0),a<0&&(a=0),this.el.style.left=s+"px",this.el.style.top=a+"px",d(this.el,c?"left-aligned":"right-aligned"),d(this.el,u?"bottom-aligned":"top-aligned"),h(this.el,c?"right-aligned":"left-aligned"),h(this.el,u?"top-aligned":"bottom-aligned"))},render:function(f,g,e){let m=this._o,y=new Date,v=n(f,g),b=new Date(f,g,1).getDay(),w=[],C=[];i(y),0<m.firstDay&&(b-=m.firstDay)<0&&(b+=7);var E,T,S,_=0===g?11:g-1,x=11===g?0:g+1,R=0===g?f-1:f,A=11===g?f+1:f,N=n(R,_);let t=v+b,r=t;for(;7<r;)r-=7;t+=7-r;let O=!1;for(let h=0,p=0;h<t;h++){let e=new Date(f,g,h-b+1),t=!!M(this._d)&&k(e,this._d),r=k(e,y),n=-1!==m.events.indexOf(e.toDateString()),i=h<b||h>=v+b,o=h-b+1,s=g,a=f,l=m.startRange&&k(m.startRange,e),c=m.endRange&&k(m.endRange,e),u=m.startRange&&m.endRange&&m.startRange<e&&e<m.endRange,d=m.minDate&&e<m.minDate||m.maxDate&&e>m.maxDate||m.disableWeekends&&function(e){e=e.getDay();return 0===e||6===e}(e)||m.disableDayFn&&m.disableDayFn(e);i&&(a=h<b?(o=N+o,s=_,R):(o-=v,s=x,A));var I={day:o,month:s,year:a,hasEvent:n,isSelected:t,isToday:r,isDisabled:d,isEmpty:i,isStartRange:l,isEndRange:c,isInRange:u,showDaysInNextAndPreviousMonths:m.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:m.enableSelectionDaysInNextAndPreviousMonths};m.pickWholeWeek&&t&&(O=!0),C.push(function(e){var t=[];let r="false";if(e.isEmpty){if(!e.showDaysInNextAndPreviousMonths)return'<td class="is-empty"></td>';t.push("is-outside-current-month"),e.enableSelectionDaysInNextAndPreviousMonths||t.push("is-selection-disabled")}return e.isDisabled&&t.push("is-disabled"),e.isToday&&t.push("is-today"),e.isSelected&&(t.push("is-selected"),r="true"),e.hasEvent&&t.push("has-event"),e.isInRange&&t.push("is-inrange"),e.isStartRange&&t.push("is-startrange"),e.isEndRange&&t.push("is-endrange"),'<td data-day="'+e.day+'" class="'+t.join(" ")+'" aria-selected="'+r+'"><button class="pika-button pika-day" type="button" data-pika-year="'+e.year+'" data-pika-month="'+e.month+'" data-pika-day="'+e.day+'">'+e.day+"</button></td>"}(I)),7==++p&&(m.showWeekNumber&&C.unshift(function(e,t,r,n,i){n=new Date(n,r,t);return'<td class="pika-week">'+(e.hasMoment?e.moment(n).isoWeek():D(n,i))+"</td>"}(this,h-b,g,f,m.firstWeekOfYearMinDays)),w.push((I=C,E=m.isRTL,T=m.pickWholeWeek,S=O,'<tr class="pika-row'+(T?" pick-whole-week":"")+(S?" is-selected":"")+'">'+(E?I.reverse():I).join("")+"</tr>")),C=[],p=0,O=!1)}return c(m,w,e)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),h(this.el,"is-hidden"),this._o.bound&&(o(f(),"click",this._onClick),this.adjustPosition()),"function"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){var e=this._v;!1!==e&&(this._o.bound&&t(f(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),d(this.el,"is-hidden"),this._v=!1,void 0!==e)&&"function"==typeof this._o.onClose&&this._o.onClose.call(this)},destroy:function(){var e=this._o;this.hide(),t(this.el,"mousedown",this._onMouseDown,!0),t(this.el,"touchend",this._onMouseDown,!0),t(this.el,"change",this._onChange),e.keyboardInput&&t(f(),"keydown",this._onKeyChange),e.field&&(t(e.field,"change",this._onInputChange),e.bound)&&(t(e.trigger,"click",this._onInputClick),t(e.trigger,"focus",this._onInputFocus),t(e.trigger,"blur",this._onInputBlur)),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},e.exports=v},(e,t,r)=>{"use strict";r.r(t)},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(746);t.EDITOR_TYPE=r.EDITOR_TYPE,t.DropdownEditor=r.DropdownEditor},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(735)),n=n(r(494));t.EDITOR_TYPE="dropdown";class o extends i.AutocompleteEditor{static get EDITOR_TYPE(){return"dropdown"}prepare(e,t,r,n,i,o){super.prepare(e,t,r,n,i,o),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}t.DropdownEditor=o,n.default.getSingleton().add("beforeValidate",function(e,t,r){r=this.propToCol(r);Number.isInteger(r)&&(t=this.getCellMeta(t,r)).editor===o&&void 0===t.strict&&(t.filter=!1,t.strict=!0)})},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(748);t.EDITOR_TYPE=r.EDITOR_TYPE,t.NumericEditor=r.NumericEditor},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(725);t.EDITOR_TYPE="numeric";class n extends r.TextEditor{static get EDITOR_TYPE(){return"numeric"}}t.NumericEditor=n},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(750);t.EDITOR_TYPE=r.EDITOR_TYPE,t.PasswordEditor=r.PasswordEditor},(e,t,r)=>{"use strict";t.__esModule=!0;var n=r(725),i=r(334),o=r(479);t.EDITOR_TYPE="password";class s extends n.TextEditor{static get EDITOR_TYPE(){return"password"}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.hot.getSettings().ariaTags&&(0,i.setAttribute)(this.TEXTAREA,[(0,o.A11Y_HIDDEN)()]),(0,i.empty)(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}t.PasswordEditor=s},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(752);t.EDITOR_TYPE=r.EDITOR_TYPE,t.SelectEditor=r.SelectEditor},(e,t,r)=>{"use strict";t.__esModule=!0;var o=r(663),a=r(334),l=r(482);const s="ht_editor_visible",n="selectEditor";t.EDITOR_TYPE="select";class i extends o.BaseEditor{static get EDITOR_TYPE(){return"select"}init(){this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.select.style.display="none",(0,a.addClass)(this.select,"htSelectEditor"),this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",(0,a.hasClass)(this.select,s)&&(0,a.removeClass)(this.select,s),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,t,r,n,i,o){super.prepare(e,t,r,n,i,o);e=this.cellProperties.selectOptions;let s;s="function"==typeof e?this.prepareOptions(e(this.row,this.col,this.prop)):this.prepareOptions(e),(0,a.empty)(this.select),(0,l.objectEach)(s,(e,t)=>{var r=this.hot.rootDocument.createElement("OPTION");r.value=t,(0,a.fastInnerHTML)(r,e),this.select.appendChild(r)})}prepareOptions(r){let n={};if(Array.isArray(r))for(let e=0,t=r.length;e<t;e++)n[r[e]]=r[e];else"object"==typeof r&&(n=r);return n}refreshValue(){var e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){var e,t,r,n,i;this.state===o.EDITOR_STATE.EDITING&&(this.TD=this.getEditedCell(),this.TD?({top:e,start:t,width:r,height:n}=this.getEditedCellRect(),(i=this.select.style).height=n+"px",i.width=r+"px",i.top=e+"px",i[this.hot.isRtl()?"right":"left"]=t+"px",i.margin="0px",(0,a.addClass)(this.select,s)):this.close())}registerShortcuts(){var e=this.hot.getShortcutManager().getContext("editor"),t={group:n};this.isInFullEditMode()&&e.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{var e=this.select.selectedIndex-1;0<=e&&(this.select[e].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{var e=this.select.selectedIndex+1;e<=this.select.length-1&&(this.select[e].selected=!0)}}],t)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(n)}}t.SelectEditor=i},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(754);t.EDITOR_TYPE=r.EDITOR_TYPE,t.TimeEditor=r.TimeEditor},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(725);t.EDITOR_TYPE="time";class n extends r.TextEditor{static get EDITOR_TYPE(){return"time"}prepare(e,t,r,n,i,o){super.prepare(e,t,r,n,i,o),this.TEXTAREA.dir="ltr"}}t.TimeEditor=n},(e,t,r)=>{"use strict";t.__esModule=!0,t.registerAllRenderers=function(){(0,f.registerRenderer)(n.autocompleteRenderer),(0,f.registerRenderer)(i.baseRenderer),(0,f.registerRenderer)(s.checkboxRenderer),(0,f.registerRenderer)(o.dropdownRenderer),(0,f.registerRenderer)(a.handsontableRenderer),(0,f.registerRenderer)(l.htmlRenderer),(0,f.registerRenderer)(c.numericRenderer),(0,f.registerRenderer)(u.passwordRenderer),(0,f.registerRenderer)(d.selectRenderer),(0,f.registerRenderer)(h.textRenderer),(0,f.registerRenderer)(p.timeRenderer)};var n=r(756),i=(t.autocompleteRenderer=n.autocompleteRenderer,t.AUTOCOMPLETE_RENDERER=n.RENDERER_TYPE,r(731)),o=(t.baseRenderer=i.baseRenderer,t.BASE_RENDERER=i.RENDERER_TYPE,r(761)),s=(t.dropdownRenderer=o.dropdownRenderer,t.DROPDOWN_RENDERER=o.RENDERER_TYPE,r(763)),a=(t.checkboxRenderer=s.checkboxRenderer,t.CHECKBOX_RENDERER=s.RENDERER_TYPE,r(766)),l=(t.handsontableRenderer=a.handsontableRenderer,t.HANDSONTABLE_RENDERER=a.RENDERER_TYPE,r(758)),c=(t.htmlRenderer=l.htmlRenderer,t.HTML_RENDERER=l.RENDERER_TYPE,r(768)),u=(t.numericRenderer=c.numericRenderer,t.NUMERIC_RENDERER=c.RENDERER_TYPE,r(771)),d=(t.passwordRenderer=u.passwordRenderer,t.PASSWORD_RENDERER=u.RENDERER_TYPE,r(773)),h=(t.selectRenderer=d.selectRenderer,t.SELECT_RENDERER=d.RENDERER_TYPE,r(729)),p=(t.textRenderer=h.textRenderer,t.TEXT_RENDERER=h.RENDERER_TYPE,r(775)),f=(t.timeRenderer=p.timeRenderer,t.TIME_RENDERER=p.RENDERER_TYPE,r(515));t.registerRenderer=f.registerRenderer,t.getRegisteredRendererNames=f.getRegisteredRendererNames,t.getRegisteredRenderers=f.getRegisteredRenderers,t.getRenderer=f.getRenderer,t.hasRenderer=f.hasRenderer},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(757);t.RENDERER_TYPE=r.RENDERER_TYPE,t.autocompleteRenderer=r.autocompleteRenderer},(e,t,r)=>{"use strict";var n=r(197),h=(t.__esModule=!0,t.autocompleteRenderer=i,r(758)),p=r(729),f=n(r(502)),g=r(334),m=(r(760),r(479));t.RENDERER_TYPE="autocomplete";function i(t,r,n,i,e,o,s){var a=t["rootDocument"],l=s.allowHtml?h.htmlRenderer:p.textRenderer,c=a.createElement("DIV"),u=t.getSettings().ariaTags;if(c.className="htAutocompleteArrow",u&&c.setAttribute(...(0,m.A11Y_HIDDEN)()),c.appendChild(a.createTextNode(String.fromCharCode(9660))),l.apply(this,[t,r,n,i,e,o,s]),r.firstChild||r.appendChild(a.createTextNode(String.fromCharCode(160))),r.insertBefore(c,r.firstChild),(0,g.addClass)(r,"htAutocomplete"),!t.acArrowListener){const d=new f.default(t);t.acArrowListener=function(e){(0,g.hasClass)(e.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,i),r)},d.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{d.destroy()})}}i.RENDERER_TYPE="autocomplete"},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(759);t.RENDERER_TYPE=r.RENDERER_TYPE,t.htmlRenderer=r.htmlRenderer},(e,t,r)=>{"use strict";t.__esModule=!0,t.htmlRenderer=n;var a=r(731),l=r(334);t.RENDERER_TYPE="html";function n(e,t,r,n,i,o,s){a.baseRenderer.apply(this,[e,t,r,n,i,o,s]),(0,l.fastInnerHTML)(t,null==o?"":o,!1)}n.RENDERER_TYPE="html"},(e,t,r)=>{"use strict";r.r(t)},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(762);t.RENDERER_TYPE=r.RENDERER_TYPE,t.dropdownRenderer=r.dropdownRenderer},(e,t,r)=>{"use strict";t.__esModule=!0,t.dropdownRenderer=n;var a=r(756);t.RENDERER_TYPE="dropdown";function n(e,t,r,n,i,o,s){a.autocompleteRenderer.apply(this,[e,t,r,n,i,o,s])}n.RENDERER_TYPE="dropdown"},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(764);t.RENDERER_TYPE=r.RENDERER_TYPE,t.checkboxRenderer=r.checkboxRenderer},(e,t,r)=>{"use strict";var n=r(197),g=(t.__esModule=!0,t.checkboxRenderer=i,r(286),r(731)),m=n(r(502)),y=r(334),v=r(337),b=r(656),n=n(r(494)),w=r(479),C=r(621);r(765);const E=new WeakMap,T=new WeakMap,S="htBadValue",_="data-row",x="data-col",R="checkboxRenderer";t.RENDERER_TYPE="checkbox";function i(p,t,r,n,i,o,s){var a=p["rootDocument"],l=p.getSettings().ariaTags;g.baseRenderer.apply(this,[p,t,r,n,i,o,s]);{var c=p;let e=T.get(c);e||(d=c["rootElement"],(e=new m.default(c)).addEventListener(d,"click",e=>{var t,r,n;t=c,A(r=(e=e).target)&&r.hasAttribute(_)&&r.hasAttribute(x)&&(n=parseInt(r.getAttribute(_),10),r=parseInt(r.getAttribute(x),10),t.getCellMeta(n,r).readOnly)&&e.preventDefault()}),e.addEventListener(d,"mouseup",e=>{var t=c;A(e=e.target)&&e.hasAttribute(_)&&e.hasAttribute(x)&&setTimeout(t.listen,10)}),e.addEventListener(d,"change",t=>{var r=c,n=t.target;if(A(n)&&n.hasAttribute(_)&&n.hasAttribute(x)){var i=parseInt(n.getAttribute(_),10),n=parseInt(n.getAttribute(x),10),o=r.getCellMeta(i,n);if(!o.readOnly){let e=null;e=t.target.checked?void 0===o.uncheckedTemplate||o.checkedTemplate:void 0!==o.uncheckedTemplate&&o.uncheckedTemplate,r.setDataAtCell(i,n,e)}}}),T.set(c,e)),e}let u=function(e){e=e.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}(a);var d=s.label;let e=!1;if(void 0===s.checkedTemplate&&(s.checkedTemplate=!0),void 0===s.uncheckedTemplate&&(s.uncheckedTemplate=!1),(0,y.empty)(t),o===s.checkedTemplate||(0,v.stringify)(o).toLocaleLowerCase(s.locale)===(0,v.stringify)(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:o===s.uncheckedTemplate||(0,v.stringify)(o).toLocaleLowerCase(s.locale)===(0,v.stringify)(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:(0,v.isEmpty)(o)?(0,y.addClass)(u,"noValue"):(u.style.display="none",(0,y.addClass)(u,S),e=!0),(0,y.setAttribute)(u,[[_,r],[x,n]]),l&&(0,y.setAttribute)(u,[(0,w.A11Y_LABEL)(u.checked?p.getTranslatedPhrase(C.CHECKBOX_CHECKED):p.getTranslatedPhrase(C.CHECKBOX_UNCHECKED)),(0,w.A11Y_CHECKED)(u.checked),(0,w.A11Y_CHECKBOX)()]),!e&&d){let e="";d.value?e="function"==typeof d.value?d.value.call(this,r,n,i,o):d.value:d.property&&(s=p.getDataAtRowProp(r,d.property),e=null!==s?s:""),l=a,n=e,i=!0!==d.separated,(o=l.createElement("label")).className="htCheckboxRendererLabel "+(i?"fullWidth":""),o.appendChild(l.createTextNode(n));r=o.cloneNode(!0);"before"===d.position?d.separated?(t.appendChild(r),t.appendChild(u)):(r.appendChild(u),u=r):d.position&&"after"!==d.position||(d.separated?(t.appendChild(u),t.appendChild(r)):(r.insertBefore(u,r.firstChild),u=r))}function h(e){var r=0<arguments.length&&void 0!==e&&e,t=p.getSelectedRange(),n=[];let i=[],o=0;if(t){for(let e=0;e<t.length;e++){var{row:s,col:a}=t[e].getTopStartCorner(),{row:l,col:c}=t[e].getBottomEndCorner();for(let t=s;t<=l;t+=1)for(let e=a;e<=c;e+=1){var u,d=p.getCellMeta(t,e),h={checkedTemplate:d.checkedTemplate,uncheckedTemplate:d.uncheckedTemplate};if("checkbox"!==d.type)return;!0!==d.readOnly&&(void 0===d.checkedTemplate&&(d.checkedTemplate=!0),void 0===d.uncheckedTemplate&&(d.uncheckedTemplate=!1),u=p.getDataAtCell(t,e),!1!==r||[d.checkedTemplate,d.checkedTemplate.toString()].includes(u)?i.push([t,e,d.uncheckedTemplate,h]):[d.uncheckedTemplate,d.uncheckedTemplate.toString(),null,void 0].includes(u)&&i.push([t,e,d.checkedTemplate,h]),o+=1)}n.push(o),o=0}0<(i=i.every(e=>{var[,,e]=e;return e===i[0][2]})?i.map(e=>{var[e,t,r]=e;return[e,t,r]}):i.map(e=>{var[e,t,,r]=e;return[e,t,r.checkedTemplate]})).length&&n.forEach(e=>{e=i.splice(0,e);p.setDataAtCell(e)})}}function f(){var t=p.getSelectedRange();if(t)for(let e=0;e<t.length;e++){var r=t[e].getTopStartCorner(),n=t[e].getBottomEndCorner();for(let t=r.row;t<=n.row;t++)for(let e=r.col;e<=n.col;e++){var i=p.getCellMeta(t,e);if("checkbox"!==i.type)return;var o=p.getCell(t,e);if(null==o)return 1;if(0<o.querySelectorAll("input[type=checkbox]").length&&!i.readOnly)return 1}}}d&&d.separated||t.appendChild(u),e&&t.appendChild(a.createTextNode("#bad-value#")),E.has(p)||(E.set(p,!0),s=(s=p.getShortcutManager()).getContext("grid"),i={group:R,relativeToGroup:b.EDITOR_EDIT_GROUP,position:"before"},s.addShortcuts([{keys:[["space"]],callback:()=>(h(),!f()),runOnlyIf:()=>{var e;return null==(e=p.getSelectedRangeLast())?void 0:e.highlight.isCell()}},{keys:[["enter"]],callback:()=>(h(),!f()),runOnlyIf:()=>{var e=p.getSelectedRangeLast();return p.getSettings().enterBeginsEditing&&(null==e?void 0:e.isSingle())&&e.highlight.isCell()}},{keys:[["delete"],["backspace"]],callback:()=>(h(!0),!f()),runOnlyIf:()=>{var e;return null==(e=p.getSelectedRangeLast())?void 0:e.highlight.isCell()}}],i))}function A(e){return"INPUT"===e.tagName&&"checkbox"===e.getAttribute("type")}n.default.getSingleton().add("modifyAutoColumnSizeSeed",function(t,r,n){var{label:r,type:i,row:o,column:s,prop:a}=r;if("checkbox"===i){if(r){var{value:i,property:r}=r;let e=n;i?e="function"==typeof i?i(o,s,a,n):i:r&&(s=this.getDataAtRowProp(o,r),e=null!==s?s:n),t=e}return t}}),i.RENDERER_TYPE="checkbox"},(e,t,r)=>{"use strict";r.r(t)},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(767);t.RENDERER_TYPE=r.RENDERER_TYPE,t.handsontableRenderer=r.handsontableRenderer},(e,t,r)=>{"use strict";t.__esModule=!0,t.handsontableRenderer=n;var a=r(756);t.RENDERER_TYPE="handsontable";function n(e,t,r,n,i,o,s){a.autocompleteRenderer.apply(this,[e,t,r,n,i,o,s])}n.RENDERER_TYPE="handsontable"},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(769);t.RENDERER_TYPE=r.RENDERER_TYPE,t.numericRenderer=r.numericRenderer,t.getRenderedValue=r.getRenderedValue},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,t.getRenderedValue=u,t.numericRenderer=o,r(286),n(r(770))),l=r(729),c=r(512);t.RENDERER_TYPE="numeric";function u(e,t){var r,n;return(0,c.isNumeric)(e)&&(r=(t=t.numericFormat)&&t.culture||"-",t=t&&t.pattern,void 0!==r&&!i.default.languages()[r]&&(n=r.replace("-",""),n=i.default.allLanguages?i.default.allLanguages[r]:i.default[n])&&i.default.registerLanguage(n),i.default.setLanguage(r),e=(0,i.default)(e).format(t||"0")),e}function o(e,t,r,n,i,o,s){let a=o;(0,c.isNumeric)(a)&&(o=(o=s.className||"").length?o.split(" "):[],a=u(a,s),o.indexOf("htLeft")<0&&o.indexOf("htCenter")<0&&o.indexOf("htRight")<0&&o.indexOf("htJustify")<0&&o.push("htRight"),o.indexOf("htNumeric")<0&&o.push("htNumeric"),s.className=o.join(" "),t.dir="ltr"),(0,l.textRenderer)(e,t,r,n,i,a,s)}o.RENDERER_TYPE="numeric"},(e,t,r)=>{e.exports=function n(i,o,s){function a(t,e){if(!o[t]){if(!i[t]){if(l)return l(t,!0);var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}r=o[t]={exports:{}};i[t][0].call(r.exports,function(e){return a(i[t][1][e]||e)},r,r.exports,n,i,o,s)}return o[t].exports}for(var l=void 0,e=0;e<s.length;e++)a(s[e]);return a}({1:[function(e,r,t){!function(e){"use strict";var t,L=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,F=Math.ceil,H=Math.floor,U="[BigNumber Error] ",V=U+"Number primitive has more than 15 significant digits: ",W=1e14,$=9007199254740991,B=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13];function j(e){var t=0|e;return 0<e||e===t?t:t-1}function z(e){for(var t,r,n=1,i=e.length,o=e[0]+"";n<i;){for(r=14-(t=e[n++]+"").length;r--;t="0"+t);o+=t}for(i=o.length;48===o.charCodeAt(--i););return o.slice(0,i+1||1)}function Y(e,t){var r,n,i=e.c,o=t.c,s=e.s,a=t.s,e=e.e,t=t.e;if(!s||!a)return null;if(r=i&&!i[0],n=o&&!o[0],r||n)return r?n?0:-a:s;if(s!=a)return s;if(r=s<0,n=e==t,!i||!o)return n?0:!i^r?1:-1;if(!n)return t<e^r?1:-1;for(a=(e=i.length)<(t=o.length)?e:t,s=0;s<a;s++)if(i[s]!=o[s])return i[s]>o[s]^r?1:-1;return e==t?0:t<e^r?1:-1}function G(e,t,r,n){if(e<t||r<e||e!==(e<0?F:H)(e))throw Error(U+(n||"Argument")+("number"==typeof e?e<t||r<e?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function q(e){var t=e.c.length-1;return j(e.e/14)==t&&e.c[t]%2!=0}function K(e,t){return(1<e.length?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function X(e,t,r){var n,i;if(t<0){for(i=r+".";++t;i+=r);e=i+e}else if(++t>(n=e.length)){for(i=r,t-=n;--t;i+=r);e+=i}else t<n&&(e=e.slice(0,t)+"."+e.slice(t));return e}(t=function e(t){var m,d,h,r,c,s,a,l,u,p,y,n=R.prototype={constructor:R,toString:null,valueOf:null},f=new R(1),v=20,b=4,g=-7,w=21,C=-1e7,E=1e7,T=!1,i=1,S=0,_={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},x="0123456789abcdefghijklmnopqrstuvwxyz";function R(e,t){var r,n,i,o,s,a,l,c,u=this;if(!(u instanceof R))return new R(e,t);if(null==t){if(e instanceof R)return u.s=e.s,u.e=e.e,void(u.c=(e=e.c)&&e.slice());if((a="number"==typeof e)&&0*e==0){if(u.s=1/e<0?(e=-e,-1):1,e===~~e){for(o=0,s=e;10<=s;s/=10,o++);return u.e=o,void(u.c=[e])}c=String(e)}else{if(c=String(e),!L.test(c))return h(u,c,a);u.s=45==c.charCodeAt(0)?(c=c.slice(1),-1):1}0<(s=(c=-1<(o=c.indexOf("."))?c.replace(".",""):c).search(/e/i))?(o<0&&(o=s),o+=+c.slice(s+1),c=c.substring(0,s)):o<0&&(o=c.length)}else{if(G(t,2,x.length,"Base"),c=String(e),10==t)return O(u=new R(e instanceof R?e:c),v+u.e+1,b);if(a="number"==typeof e){if(0*e!=0)return h(u,c,a,t);if(u.s=1/e<0?(c=c.slice(1),-1):1,R.DEBUG&&15<c.replace(/^0\.0*|\./,"").length)throw Error(V+e);a=!1}else u.s=45===c.charCodeAt(0)?(c=c.slice(1),-1):1;for(r=x.slice(0,t),o=s=0,l=c.length;s<l;s++)if(r.indexOf(n=c.charAt(s))<0){if("."==n){if(o<s){o=l;continue}}else if(!i&&(c==c.toUpperCase()&&(c=c.toLowerCase())||c==c.toLowerCase()&&(c=c.toUpperCase()))){i=!0,s=-1,o=0;continue}return h(u,String(e),a,t)}-1<(o=(c=d(c,t,10,u.s)).indexOf("."))?c=c.replace(".",""):o=c.length}for(s=0;48===c.charCodeAt(s);s++);for(l=c.length;48===c.charCodeAt(--l););if(c=c.slice(s,++l)){if(l-=s,a&&R.DEBUG&&15<l&&($<e||e!==H(e)))throw Error(V+u.s*e);if(E<(o=o-s-1))u.c=u.e=null;else if(o<C)u.c=[u.e=0];else{if(u.e=o,u.c=[],s=(o+1)%14,o<0&&(s+=14),s<l){for(s&&u.c.push(+c.slice(0,s)),l-=14;s<l;)u.c.push(+c.slice(s,s+=14));s=14-(c=c.slice(s)).length}else s-=l;for(;s--;c+="0");u.c.push(+c)}}else u.c=[u.e=0]}function o(e,t,r,n){var i,o,s,a;if(null==r?r=b:G(r,0,8),!e.c)return e.toString();if(i=e.c[0],o=e.e,null==t)a=z(e.c),a=1==n||2==n&&(o<=g||w<=o)?K(a,o):X(a,o,"0");else if(r=(e=O(new R(e),t,r)).e,s=(a=z(e.c)).length,1==n||2==n&&(t<=r||r<=g)){for(;s<t;a+="0",s++);a=K(a,r)}else if(t-=o,a=X(a,r,"0"),s<r+1){if(0<--t)for(a+=".";t--;a+="0");}else if(0<(t+=r-s))for(r+1==s&&(a+=".");t--;a+="0");return e.s<0&&i?"-"+a:a}function A(e,t){for(var r,n=1,i=new R(e[0]);n<e.length;n++){if(!(r=new R(e[n])).s){i=r;break}t.call(i,r)&&(i=r)}return i}function N(e,t,r){for(var n=1,i=t.length;!t[--i];t.pop());for(i=t[0];10<=i;i/=10,n++);return(r=n+14*r-1)>E?e.c=e.e=null:e.c=r<C?[e.e=0]:(e.e=r,t),e}function O(e,t,r,n){var i,o,s,a,l,c,u,d=e.c,h=B;if(d){e:{for(i=1,a=d[0];10<=a;a/=10,i++);if((o=t-i)<0)o+=14,s=t,u=(l=d[c=0])/h[i-s-1]%10|0;else if((c=F((o+1)/14))>=d.length){if(!n)break e;for(;d.length<=c;d.push(0));l=u=0,s=(o%=14)-14+(i=1)}else{for(l=a=d[c],i=1;10<=a;a/=10,i++);u=(s=(o%=14)-14+i)<0?0:l/h[i-s-1]%10|0}if(n=n||t<0||null!=d[c+1]||(s<0?l:l%h[i-s-1]),n=r<4?(u||n)&&(0==r||r==(e.s<0?3:2)):5<u||5==u&&(4==r||n||6==r&&(0<o?0<s?l/h[i-s]:0:d[c-1])%10&1||r==(e.s<0?8:7)),t<1||!d[0])return d.length=0,n?(t-=e.e+1,d[0]=h[(14-t%14)%14],e.e=-t||0):d[0]=e.e=0,e;if(0==o?(d.length=c,a=1,c--):(d.length=c+1,a=h[14-o],d[c]=0<s?H(l/h[i-s]%h[s])*a:0),n)for(;;){if(0==c){for(o=1,s=d[0];10<=s;s/=10,o++);for(s=d[0]+=a,a=1;10<=s;s/=10,a++);o!=a&&(e.e++,d[0]==W)&&(d[0]=1);break}if(d[c]+=a,d[c]!=W)break;d[c--]=0,a=1}for(o=d.length;0===d[--o];d.pop());}e.e>E?e.c=e.e=null:e.e<C&&(e.c=[e.e=0])}return e}function I(e){var t,r=e.e;return null===r?e.toString():(t=z(e.c),t=r<=g||w<=r?K(t,r):X(t,r,"0"),e.s<0?"-"+t:t)}return R.clone=e,R.ROUND_UP=0,R.ROUND_DOWN=1,R.ROUND_CEIL=2,R.ROUND_FLOOR=3,R.ROUND_HALF_UP=4,R.ROUND_HALF_DOWN=5,R.ROUND_HALF_EVEN=6,R.ROUND_HALF_CEIL=7,R.ROUND_HALF_FLOOR=8,R.EUCLID=9,R.config=R.set=function(e){var t,r;if(null!=e){if("object"!=typeof e)throw Error(U+"Object expected: "+e);if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(G(r=e[t],0,1e9,t),v=r),e.hasOwnProperty(t="ROUNDING_MODE")&&(G(r=e[t],0,8,t),b=r),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((r=e[t])&&r.pop?(G(r[0],-1e9,0,t),G(r[1],0,1e9,t),g=r[0],w=r[1]):(G(r,-1e9,1e9,t),g=-(w=r<0?-r:r))),e.hasOwnProperty(t="RANGE"))if((r=e[t])&&r.pop)G(r[0],-1e9,-1,t),G(r[1],1,1e9,t),C=r[0],E=r[1];else{if(G(r,-1e9,1e9,t),!r)throw Error(U+t+" cannot be zero: "+r);C=-(E=r<0?-r:r)}if(e.hasOwnProperty(t="CRYPTO")){if((r=e[t])!==!!r)throw Error(U+t+" not true or false: "+r);if(r&&("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes))throw T=!r,Error(U+"crypto unavailable");T=r}if(e.hasOwnProperty(t="MODULO_MODE")&&(G(r=e[t],0,9,t),i=r),e.hasOwnProperty(t="POW_PRECISION")&&(G(r=e[t],0,1e9,t),S=r),e.hasOwnProperty(t="FORMAT")){if("object"!=typeof(r=e[t]))throw Error(U+t+" not an object: "+r);_=r}if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(r=e[t])||/^.$|[+-.\s]|(.).*\1/.test(r))throw Error(U+t+" invalid: "+r);x=r}}return{DECIMAL_PLACES:v,ROUNDING_MODE:b,EXPONENTIAL_AT:[g,w],RANGE:[C,E],CRYPTO:T,MODULO_MODE:i,POW_PRECISION:S,FORMAT:_,ALPHABET:x}},R.isBigNumber=function(e){return e instanceof R||e&&!0===e._isBigNumber||!1},R.maximum=R.max=function(){return A(arguments,n.lt)},R.minimum=R.min=function(){return A(arguments,n.gt)},R.random=(r=9007199254740992,c=Math.random()*r&2097151?function(){return H(Math.random()*r)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(e){var t,r,n,i,o,s=0,a=[],l=new R(f);if(null==e?e=v:G(e,0,1e9),i=F(e/14),T)if(crypto.getRandomValues){for(t=crypto.getRandomValues(new Uint32Array(i*=2));s<i;)9e15<=(o=131072*t[s]+(t[s+1]>>>11))?(r=crypto.getRandomValues(new Uint32Array(2)),t[s]=r[0],t[s+1]=r[1]):(a.push(o%1e14),s+=2);s=i/2}else{if(!crypto.randomBytes)throw T=!1,Error(U+"crypto unavailable");for(t=crypto.randomBytes(i*=7);s<i;)9e15<=(o=281474976710656*(31&t[s])+1099511627776*t[s+1]+4294967296*t[s+2]+16777216*t[s+3]+(t[s+4]<<16)+(t[s+5]<<8)+t[s+6])?crypto.randomBytes(7).copy(t,s):(a.push(o%1e14),s+=7);s=i/7}if(!T)for(;s<i;)(o=c())<9e15&&(a[s++]=o%1e14);for(e%=14,(i=a[--s])&&e&&(a[s]=H(i/(o=B[14-e]))*o);0===a[s];a.pop(),s--);if(s<0)a=[n=0];else{for(n=-1;0===a[0];a.splice(0,1),n-=14);for(s=1,o=a[0];10<=o;o/=10,s++);s<14&&(n-=14-s)}return l.e=n,l.c=a,l}),R.sum=function(){for(var e=1,t=arguments,r=new R(t[0]);e<t.length;)r=r.plus(t[e++]);return r},y="0123456789",d=function(e,t,r,n,i){var o,s,a,l,c,u,d,h,p=e.indexOf("."),f=v,g=b;for(0<=p&&(l=S,S=0,e=e.replace(".",""),u=(h=new R(t)).pow(e.length-p),S=l,h.c=P(X(z(u.c),u.e,"0"),10,r,y),h.e=h.c.length),a=l=(d=P(e,t,r,i?(o=x,y):(o=y,x))).length;0==d[--l];d.pop());if(!d[0])return o.charAt(0);if(p<0?--a:(u.c=d,u.e=a,u.s=n,d=(u=m(u,h,f,g,r)).c,c=u.r,a=u.e),p=d[s=a+f+1],l=r/2,c=c||s<0||null!=d[s+1],c=g<4?(null!=p||c)&&(0==g||g==(u.s<0?3:2)):l<p||p==l&&(4==g||c||6==g&&1&d[s-1]||g==(u.s<0?8:7)),s<1||!d[0])e=c?X(o.charAt(1),-f,o.charAt(0)):o.charAt(0);else{if(d.length=s,c)for(--r;++d[--s]>r;)d[s]=0,s||(++a,d=[1].concat(d));for(l=d.length;!d[--l];);for(p=0,e="";p<=l;e+=o.charAt(d[p++]));e=X(e,a,o.charAt(0))}return e},m=function(e,t,r,n,i){var o,s,a,l,c,u,d,h,p,f,g,m,y,v,b,w,C,E=e.s==t.s?1:-1,T=e.c,S=t.c;if(!(T&&T[0]&&S&&S[0]))return new R(e.s&&t.s&&(T?!S||T[0]!=S[0]:S)?T&&0==T[0]||!S?0*E:E/0:NaN);for(p=(h=new R(E)).c=[],E=r+(s=e.e-t.e)+1,i||(i=W,s=j(e.e/14)-j(t.e/14),E=E/14|0),a=0;S[a]==(T[a]||0);a++);if(S[a]>(T[a]||0)&&s--,E<0)p.push(1),l=!0;else{for(v=T.length,w=S.length,E+=2,1<(c=H(i/(S[a=0]+1)))&&(S=M(S,c,i),T=M(T,c,i),w=S.length,v=T.length),y=w,g=(f=T.slice(0,w)).length;g<w;f[g++]=0);C=S.slice(),C=[0].concat(C),b=S[0],S[1]>=i/2&&b++;do{if(c=0,(o=k(S,f,w,g))<0){if(m=f[0],w!=g&&(m=m*i+(f[1]||0)),1<(c=H(m/b)))for(d=(u=M(S,c=i<=c?i-1:c,i)).length,g=f.length;1==k(u,f,d,g);)c--,D(u,w<d?C:S,d,i),d=u.length,o=1;else 0==c&&(o=c=1),d=(u=S.slice()).length;if(D(f,u=d<g?[0].concat(u):u,g,i),g=f.length,-1==o)for(;k(S,f,w,g)<1;)c++,D(f,w<g?C:S,g,i),g=f.length}else 0===o&&(c++,f=[0])}while(p[a++]=c,f[0]?f[g++]=T[y]||0:(f=[T[y]],g=1),(y++<v||null!=f[0])&&E--);l=null!=f[0],p[0]||p.splice(0,1)}if(i==W){for(a=1,E=p[0];10<=E;E/=10,a++);O(h,r+(h.e=a+14*s-1)+1,n,l)}else h.e=s,h.r=+l;return h},s=/^(-?)0([xbo])(?=\w[\w.]*$)/i,a=/^([^.]+)\.$/,l=/^\.([^.]+)$/,u=/^-?(Infinity|NaN)$/,p=/^\s*\+(?=[\w.])|^\s+|\s+$/g,h=function(e,t,r,n){var i,o=r?t:t.replace(p,"");if(u.test(o))e.s=isNaN(o)?null:o<0?-1:1,e.c=e.e=null;else{if(!r&&(o=o.replace(s,function(e,t,r){return i="x"==(r=r.toLowerCase())?16:"b"==r?2:8,n&&n!=i?e:t}),n&&(i=n,o=o.replace(a,"$1").replace(l,"0.$1")),t!=o))return new R(o,i);if(R.DEBUG)throw Error(U+"Not a"+(n?" base "+n:"")+" number: "+t);e.c=e.e=e.s=null}},n.absoluteValue=n.abs=function(){var e=new R(this);return e.s<0&&(e.s=1),e},n.comparedTo=function(e,t){return Y(this,new R(e,t))},n.decimalPlaces=n.dp=function(e,t){var r,n;if(null!=e)return G(e,0,1e9),null==t?t=b:G(t,0,8),O(new R(this),e+this.e+1,t);if(!(e=this.c))return null;if(r=14*((n=e.length-1)-j(this.e/14)),n=e[n])for(;n%10==0;n/=10,r--);return r=r<0?0:r},n.dividedBy=n.div=function(e,t){return m(this,new R(e,t),v,b)},n.dividedToIntegerBy=n.idiv=function(e,t){return m(this,new R(e,t),0,1)},n.exponentiatedBy=n.pow=function(e,t){var r,n,i,o,s,a,l,c,u=this;if((e=new R(e)).c&&!e.isInteger())throw Error(U+"Exponent not an integer: "+I(e));if(null!=t&&(t=new R(t)),s=14<e.e,!u.c||!u.c[0]||1==u.c[0]&&!u.e&&1==u.c.length||!e.c||!e.c[0])return c=new R(Math.pow(+I(u),s?2-q(e):+I(e))),t?c.mod(t):c;if(a=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new R(NaN);(n=!a&&u.isInteger()&&t.isInteger())&&(u=u.mod(t))}else{if(9<e.e&&(0<u.e||u.e<-1||(0==u.e?1<u.c[0]||s&&24e7<=u.c[1]:u.c[0]<8e13||s&&u.c[0]<=9999975e7)))return o=u.s<0&&q(e)?-0:0,-1<u.e&&(o=1/o),new R(a?1/o:o);S&&(o=F(S/14+2))}for(l=s?(r=new R(.5),a&&(e.s=1),q(e)):(i=Math.abs(+I(e)))%2,c=new R(f);;){if(l){if(!(c=c.times(u)).c)break;o?c.c.length>o&&(c.c.length=o):n&&(c=c.mod(t))}if(i){if(0===(i=H(i/2)))break;l=i%2}else if(O(e=e.times(r),e.e+1,1),14<e.e)l=q(e);else{if(0==(i=+I(e)))break;l=i%2}u=u.times(u),o?u.c&&u.c.length>o&&(u.c.length=o):n&&(u=u.mod(t))}return n?c:(a&&(c=f.div(c)),t?c.mod(t):o?O(c,S,b,void 0):c)},n.integerValue=function(e){var t=new R(this);return null==e?e=b:G(e,0,8),O(t,t.e+1,e)},n.isEqualTo=n.eq=function(e,t){return 0===Y(this,new R(e,t))},n.isFinite=function(){return!!this.c},n.isGreaterThan=n.gt=function(e,t){return 0<Y(this,new R(e,t))},n.isGreaterThanOrEqualTo=n.gte=function(e,t){return 1===(t=Y(this,new R(e,t)))||0===t},n.isInteger=function(){return!!this.c&&j(this.e/14)>this.c.length-2},n.isLessThan=n.lt=function(e,t){return Y(this,new R(e,t))<0},n.isLessThanOrEqualTo=n.lte=function(e,t){return-1===(t=Y(this,new R(e,t)))||0===t},n.isNaN=function(){return!this.s},n.isNegative=function(){return this.s<0},n.isPositive=function(){return 0<this.s},n.isZero=function(){return!!this.c&&0==this.c[0]},n.minus=function(e,t){var r,n,i,o,s=this.s;if(t=(e=new R(e,t)).s,!s||!t)return new R(NaN);if(s!=t)return e.s=-t,this.plus(e);var a=this.e/14,l=e.e/14,c=this.c,u=e.c;if(!a||!l){if(!c||!u)return c?(e.s=-t,e):new R(u?this:NaN);if(!c[0]||!u[0])return u[0]?(e.s=-t,e):new R(c[0]?this:3==b?-0:0)}if(a=j(a),l=j(l),c=c.slice(),s=a-l){for((i=(o=s<0)?(s=-s,c):(l=a,u)).reverse(),t=s;t--;i.push(0));i.reverse()}else for(n=(o=(s=c.length)<(t=u.length))?s:t,s=t=0;t<n;t++)if(c[t]!=u[t]){o=c[t]<u[t];break}if(o&&(i=c,c=u,u=i,e.s=-e.s),0<(t=(n=u.length)-(r=c.length)))for(;t--;c[r++]=0);for(t=W-1;s<n;){if(c[--n]<u[n]){for(r=n;r&&!c[--r];c[r]=t);--c[r],c[n]+=W}c[n]-=u[n]}for(;0==c[0];c.splice(0,1),--l);return c[0]?N(e,c,l):(e.s=3==b?-1:1,e.c=[e.e=0],e)},n.modulo=n.mod=function(e,t){var r;return e=new R(e,t),!this.c||!e.s||e.c&&!e.c[0]?new R(NaN):!e.c||this.c&&!this.c[0]?new R(this):(9==i?(t=e.s,e.s=1,r=m(this,e,0,3),e.s=t,r.s*=t):r=m(this,e,0,i),(e=this.minus(r.times(e))).c[0]||1!=i||(e.s=this.s),e)},n.multipliedBy=n.times=function(e,t){var r,n,i,o,s,a,l,c,u,d,h,p,f=this.c,g=(e=new R(e,t)).c;if(!(f&&g&&f[0]&&g[0]))return!this.s||!e.s||f&&!f[0]&&!g||g&&!g[0]&&!f?e.c=e.e=e.s=null:(e.s*=this.s,f&&g?(e.c=[0],e.e=0):e.c=e.e=null),e;for(t=j(this.e/14)+j(e.e/14),e.s*=this.s,(a=f.length)<(u=g.length)&&(p=f,f=g,g=p,n=a,a=u,u=n),n=a+u,p=[];n--;p.push(0));for(n=u;0<=--n;){for(d=g[n]%1e7,h=g[n]/1e7|(r=0),i=n+(o=a);n<i;)r=((l=d*(l=f[--o]%1e7)+(s=h*l+(c=f[o]/1e7|0)*d)%1e7*1e7+p[i]+r)/1e14|0)+(s/1e7|0)+h*c,p[i--]=l%1e14;p[i]=r}return r?++t:p.splice(0,1),N(e,p,t)},n.negated=function(){var e=new R(this);return e.s=-e.s||null,e},n.plus=function(e,t){var r,n=this.s;if(t=(e=new R(e,t)).s,!n||!t)return new R(NaN);if(n!=t)return e.s=-t,this.minus(e);var i=this.e/14,o=e.e/14,s=this.c,a=e.c;if(!i||!o){if(!s||!a)return new R(n/0);if(!s[0]||!a[0])return a[0]?e:new R(s[0]?this:0*n)}if(i=j(i),o=j(o),s=s.slice(),n=i-o){for((r=0<n?(o=i,a):(n=-n,s)).reverse();n--;r.push(0));r.reverse()}for((n=s.length)-(t=a.length)<0&&(r=a,a=s,s=r,t=n),n=0;t;)n=(s[--t]=s[t]+a[t]+n)/W|0,s[t]=W===s[t]?0:s[t]%W;return n&&(s=[n].concat(s),++o),N(e,s,o)},n.precision=n.sd=function(e,t){var r,n;if(null!=e&&e!==!!e)return G(e,1,1e9),null==t?t=b:G(t,0,8),O(new R(this),e,t);if(!(t=this.c))return null;if(r=14*(n=t.length-1)+1,n=t[n]){for(;n%10==0;n/=10,r--);for(n=t[0];10<=n;n/=10,r++);}return r=e&&this.e+1>r?this.e+1:r},n.shiftedBy=function(e){return G(e,-$,$),this.times("1e"+e)},n.squareRoot=n.sqrt=function(){var e,t,r,n,i,o=this.c,s=this.s,a=this.e,l=v+4,c=new R("0.5");if(1!==s||!o||!o[0])return new R(!s||s<0&&(!o||o[0])?NaN:o?this:1/0);if((r=0==(s=Math.sqrt(+I(this)))||s==1/0?(((t=z(o)).length+a)%2==0&&(t+="0"),s=Math.sqrt(+t),a=j((a+1)/2)-(a<0||a%2),new R(t=s==1/0?"1e"+a:(t=s.toExponential()).slice(0,t.indexOf("e")+1)+a)):new R(s+"")).c[0])for((s=(a=r.e)+l)<3&&(s=0);;)if(i=r,r=c.times(i.plus(m(this,i,l,1))),z(i.c).slice(0,s)===(t=z(r.c)).slice(0,s)){if(r.e<a&&--s,"9999"!=(t=t.slice(s-3,s+1))&&(n||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(O(r,r.e+v+2,1),e=!r.times(r).eq(this));break}if(!n&&(O(i,i.e+v+2,0),i.times(i).eq(this))){r=i;break}l+=4,s+=4,n=1}return O(r,r.e+v+1,b,e)},n.toExponential=function(e,t){return null!=e&&(G(e,0,1e9),e++),o(this,e,t,1)},n.toFixed=function(e,t){return null!=e&&(G(e,0,1e9),e=e+this.e+1),o(this,e,t)},n.toFormat=function(e,t,r){if(null==r)null!=e&&t&&"object"==typeof t?(r=t,t=null):e&&"object"==typeof e?(r=e,e=t=null):r=_;else if("object"!=typeof r)throw Error(U+"Argument not an object: "+r);if(e=this.toFixed(e,t),this.c){var n,t=e.split("."),i=+r.groupSize,o=+r.secondaryGroupSize,s=r.groupSeparator||"",a=t[0],t=t[1],l=this.s<0,c=l?a.slice(1):a,u=c.length;if(o&&(n=i,i=o,u-=o=n),0<i&&0<u){for(a=c.substr(0,n=u%i||i);n<u;n+=i)a+=s+c.substr(n,i);0<o&&(a+=s+c.slice(n)),l&&(a="-"+a)}e=t?a+(r.decimalSeparator||"")+((o=+r.fractionGroupSize)?t.replace(new RegExp("\\d{"+o+"}\\B","g"),"$&"+(r.fractionGroupSeparator||"")):t):a}return(r.prefix||"")+e+(r.suffix||"")},n.toFraction=function(e){var t,r,n,i,o,s,a,l,c,u,d=this.c;if(null!=e&&(!(a=new R(e)).isInteger()&&(a.c||1!==a.s)||a.lt(f)))throw Error(U+"Argument "+(a.isInteger()?"out of range: ":"not an integer: ")+I(a));if(!d)return new R(this);for(t=new R(f),c=r=new R(f),n=l=new R(f),d=z(d),o=t.e=d.length-this.e-1,t.c[0]=B[(s=o%14)<0?14+s:s],e=!e||0<a.comparedTo(t)?0<o?t:c:a,s=E,E=1/0,a=new R(d),l.c[0]=0;u=m(a,t,0,1),1!=(i=r.plus(u.times(n))).comparedTo(e);)r=n,n=i,c=l.plus(u.times(i=c)),l=i,t=a.minus(u.times(i=t)),a=i;return i=m(e.minus(r),n,0,1),l=l.plus(i.times(c)),r=r.plus(i.times(n)),l.s=c.s=this.s,d=m(c,n,o*=2,b).minus(this).abs().comparedTo(m(l,r,o,b).minus(this).abs())<1?[c,n]:[l,r],E=s,d},n.toNumber=function(){return+I(this)},n.toPrecision=function(e,t){return null!=e&&G(e,1,1e9),o(this,e,t,2)},n.toString=function(e){var t,r=this,n=r.s,i=r.e;return null===i?n?(t="Infinity",n<0&&(t="-"+t)):t="NaN":(t=null==e?i<=g||w<=i?K(z(r.c),i):X(z(r.c),i,"0"):10===e?X(z((r=O(new R(r),v+i+1,b)).c),r.e,"0"):(G(e,2,x.length,"Base"),d(X(z(r.c),i,"0"),10,e,n,!0)),n<0&&r.c[0]&&(t="-"+t)),t},n.valueOf=n.toJSON=function(){return I(this)},n._isBigNumber=!0,"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator&&(n[Symbol.toStringTag]="BigNumber",n[Symbol.for("nodejs.util.inspect.custom")]=n.valueOf),null!=t&&R.set(t),R;function M(e,t,r){var n,i,o,s=0,a=e.length,l=t%1e7,c=t/1e7|0;for(e=e.slice();a--;)s=((i=l*(o=e[a]%1e7)+(n=c*o+(o=e[a]/1e7|0)*l)%1e7*1e7+s)/r|0)+(n/1e7|0)+c*o,e[a]=i%r;return e=s?[s].concat(e):e}function k(e,t,r,n){var i,o;if(r!=n)o=n<r?1:-1;else for(i=o=0;i<r;i++)if(e[i]!=t[i]){o=e[i]>t[i]?1:-1;break}return o}function D(e,t,r,n){for(var i=0;r--;)e[r]-=i,i=e[r]<t[r]?1:0,e[r]=i*n+e[r]-t[r];for(;!e[0]&&1<e.length;e.splice(0,1));}function P(e,t,r,n){for(var i,o,s=[0],a=0,l=e.length;a<l;){for(o=s.length;o--;s[o]*=t);for(s[0]+=n.indexOf(e.charAt(a++)),i=0;i<s.length;i++)r-1<s[i]&&(null==s[i+1]&&(s[i+1]=0),s[i+1]+=s[i]/r|0,s[i]%=r)}return s.reverse()}}()).default=t.BigNumber=t,void 0!==r&&r.exports?r.exports=t:(e=e||("undefined"!=typeof self&&self?self:window)).BigNumber=t}(this)},{}],2:[function(e,t,r){"use strict";t.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(e){var t=e%10;return 1==~~(e%100/10)?"th":1==t?"st":2==t?"nd":3==t?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(e,t,r){"use strict";function M(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(n=(s=a.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var k=e("./globalState"),o=e("./validating"),s=e("./parsing"),e=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],y={general:{scale:1024,suffixes:e,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:e,marker:"d"}},D={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function i(e){var t,r,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=2<arguments.length?arguments[2]:void 0;return"string"==typeof n&&(n=s.parseFormat(n)),o.validateFormat(n)?(t=n.prefix||"",r=n.postfix||"",t+function(e,t,r){switch(t.output){case"currency":return t=w(t,k.currentCurrencyDefaultFormat()),n=e,p=t,h=(i=k).currentCurrency(),o=Object.assign({},D,p),s=void 0,c="",d=!!o.totalLength||!!o.forceAverage||o.average,u=p.currencyPosition||h.position,h=p.currencySymbol||h.symbol,o.spaceSeparated&&(c=" "),p=b({instance:n,providedFormat:p,state:i,decimalSeparator:s="infix"===u?c+h+c:s}),"prefix"===u&&(p=n._value<0&&"sign"===o.negative?"-".concat(c).concat(h).concat(p.slice(1)):h+c+p),p=u&&"postfix"!==u?p:p+(c=d?"":c)+h;case"percent":return t=w(t,k.currentPercentageDefaultFormat()),i=k,s=r,o=(n=t).prefixSymbol,s=b({instance:s(100*e._value),providedFormat:n,state:i}),i=Object.assign({},D,n),o?"%".concat(i.spaceSeparated?" ":"").concat(s):"".concat(s).concat(i.spaceSeparated?" ":"","%");case"byte":return t=w(t,k.currentByteDefaultFormat()),u=k,d=r,h=(c=t).base||"binary",g=(f=v(e._value,(p=y[h]).suffixes,p.scale)).value,f=f.suffix,g=b({instance:d(g),providedFormat:c,state:u,defaults:u.currentByteDefaultFormat()}),m=u.currentAbbreviations(),"".concat(g).concat(m.spaced?" ":"").concat(f);case"time":return t=w(t,k.currentTimeDefaultFormat()),g=e,m=Math.floor(g._value/60/60),f=Math.floor((g._value-60*m*60)/60),g=Math.round(g._value-60*m*60-60*f),"".concat(m,":").concat(f<10?"0":"").concat(f,":").concat(g<10?"0":"").concat(g);case"ordinal":return t=w(t,k.currentOrdinalDefaultFormat()),m=e,f=t,a=(g=k).currentOrdinal(),l=Object.assign({},D,f),f=b({instance:m,providedFormat:f,state:g}),g=a(m._value),"".concat(f).concat(l.spaceSeparated?" ":"").concat(g);default:return b({instance:e,providedFormat:t,numbro:r})}var n,i,o,s,a,l,c,u,d,h,p,f,g,m}(e,n,i)+r):"ERROR: invalid format"}function v(e,t,r){var n=t[0],i=Math.abs(e);if(r<=i){for(var o=1;o<t.length;++o){var s=Math.pow(r,o),a=Math.pow(r,o+1);if(s<=i&&i<a){n=t[o],e/=s;break}}n===t[0]&&(e/=Math.pow(r,t.length-1),n=t[t.length-1])}return{value:e,suffix:n}}function P(e){for(var t="",r=0;r<e;r++)t+="0";return t}function b(e){var t=e.instance,r=e.providedFormat,n=e.state,n=void 0===n?k:n,i=e.decimalSeparator,e=e.defaults,e=void 0===e?n.currentDefaults():e,t=t._value;if(0===t&&n.hasZeroFormat())return n.getZeroFormat();if(!isFinite(t))return t.toString();var o,s,a,l,c,u,e=Object.assign({},D,e,r),d=e.totalLength,h=d?0:e.characteristic,p=e.optionalCharacteristic,f=e.forceAverage,g=!!d||!!f||e.average,m=d?-1:g&&void 0===r.mantissa?0:e.mantissa,r=!d&&(void 0===r.optionalMantissa?-1===m:e.optionalMantissa),y=e.trimMantissa,v=e.thousandSeparated,b=e.spaceSeparated,w=e.negative,C=e.forceSign,e=e.exponential,E="";g&&(f={value:t,forceAverage:f,abbreviations:n.currentAbbreviations(),spaceSeparated:b,totalLength:d},b=f.value,u=f.forceAverage,o=f.abbreviations,s=void 0!==(s=f.spaceSeparated)&&s,f=void 0===(f=f.totalLength)?0:f,a="",l=Math.abs(b),c=-1,l>=Math.pow(10,12)&&!u||"trillion"===u?(a=o.trillion,b/=Math.pow(10,12)):l<Math.pow(10,12)&&l>=Math.pow(10,9)&&!u||"billion"===u?(a=o.billion,b/=Math.pow(10,9)):l<Math.pow(10,9)&&l>=Math.pow(10,6)&&!u||"million"===u?(a=o.million,b/=Math.pow(10,6)):(l<Math.pow(10,6)&&l>=Math.pow(10,3)&&!u||"thousand"===u)&&(a=o.thousand,b/=Math.pow(10,3)),a=a&&(s?" ":"")+a,f&&(l=b.toString().split(".")[0],c=Math.max(f-l.length,0)),t=(u={value:b,abbreviation:a,mantissaPrecision:c}).value,E+=u.abbreviation,d)&&(m=u.mantissaPrecision),e&&(s=(o={value:t,characteristicPrecision:h}).value,l=void 0===(f=o.characteristicPrecision)?0:f,a=(b=M(s.toExponential().split("e"),2))[0],c=b[1],d=+a,l&&1<l&&(d*=Math.pow(10,l-1),c=0<=(c=+c-(l-1))?"+".concat(c):c),t=(u={value:d,abbreviation:"e".concat(c)}).value,E=u.abbreviation+E);f=t.toString(),b=r,d=y;var T,S,_,x,R,A,N,O,I=-1===m?f:(f=m,x=-1!==(r=t).toString().indexOf("e")?(T=f,_=M((A=r.toString()).split("e"),2),x=_[0],_=_[1],x=M(x.split("."),2),R=x[0],x=void 0===(x=x[1])?"":x,A=0<+_?R+x+P(_-x.length):(S=(+R<0?"-0":"0").concat(S="."),(R=(P(-_-1)+Math.abs(R)+x).substr(0,T)).length<T&&(R+=P(T-R.length)),S+R),0<+_&&0<T&&(A+=".".concat(P(T))),A):(Math.round(+"".concat(r,"e+").concat(f))/Math.pow(10,f)).toFixed(f),R=(S=M(x.toString().split("."),2))[0],(T=void 0===(_=S[1])?"":_).match(/^0+$/)&&(b||d)?R:(A=T.match(/0+$/),d&&A?"".concat(R,".").concat(T.toString().slice(0,A.index)):x.toString()));return y=I=function(e,t){var r=I,n=M(r.toString().split("."),2),i=n[0],n=n[1];if(i.match(/^-?0$/)&&e)return n?"".concat(i.replace("0",""),".").concat(n):i.replace("0","");if(i.length<t)for(var o=t-i.length,s=0;s<o;s++)r="0".concat(r);return r.toString()}(p,h),m=t,r=v,f=i,b=n.currentDelimiters(),N=b.thousands,f=f||b.decimal,b=b.thousandsSize||3,y=y.toString(),O=y.split(".")[0],y=y.split(".")[1],r&&(function(e,t){for(var r=[],n=0,i=e;0<i;i--)n===t&&(r.unshift(i),n=0),n++;return r}((O=m<0?O.slice(1):O).length,b).forEach(function(e,t){O=O.slice(0,e+t)+N+O.slice(e+t)}),m<0)&&(O="-".concat(O)),I=y?O+f+y:O,(g||e)&&(I+=E),(C||t<0)&&(d=I,p=w,I=0===(h=t)?d:0==+d?d.replace("-",""):0<h?"+".concat(d):"sign"===p?d:"(".concat(d.replace("-",""),")")),I}function w(e,t){var r;return!e||1===(r=Object.keys(e)).length&&"output"===r[0]?t:e}t.exports=function(n){return{format:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return i.apply(void 0,t.concat([n]))},getByteUnit:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){var t=y.general;return v(e._value,t.suffixes,t.scale).suffix}.apply(void 0,t.concat([n]))},getBinaryByteUnit:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){var t=y.binary;return v(e._value,t.suffixes,t.scale).suffix}.apply(void 0,t.concat([n]))},getDecimalByteUnit:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){var t=y.decimal;return v(e._value,t.suffixes,t.scale).suffix}.apply(void 0,t.concat([n]))},formatOrDefault:w}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(e,t,r){"use strict";var i=e("./en-US"),n=e("./validating"),o=e("./parsing"),s={},a=void 0,l={},c=null,u={};function d(e){a=e}function h(){return l[a]}s.languages=function(){return Object.assign({},l)},s.currentLanguage=function(){return a},s.currentCurrency=function(){return h().currency},s.currentAbbreviations=function(){return h().abbreviations},s.currentDelimiters=function(){return h().delimiters},s.currentOrdinal=function(){return h().ordinal},s.currentDefaults=function(){return Object.assign({},h().defaults,u)},s.currentOrdinalDefaultFormat=function(){return Object.assign({},s.currentDefaults(),h().ordinalFormat)},s.currentByteDefaultFormat=function(){return Object.assign({},s.currentDefaults(),h().byteFormat)},s.currentPercentageDefaultFormat=function(){return Object.assign({},s.currentDefaults(),h().percentageFormat)},s.currentCurrencyDefaultFormat=function(){return Object.assign({},s.currentDefaults(),h().currencyFormat)},s.currentTimeDefaultFormat=function(){return Object.assign({},s.currentDefaults(),h().timeFormat)},s.setDefaults=function(e){e=o.parseFormat(e),n.validateFormat(e)&&(u=e)},s.getZeroFormat=function(){return c},s.setZeroFormat=function(e){return c="string"==typeof e?e:null},s.hasZeroFormat=function(){return null!==c},s.languageData=function(e){if(e){if(l[e])return l[e];throw new Error('Unknown tag "'.concat(e,'"'))}return h()},s.registerLanguage=function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!n.validateLanguage(e))throw new Error("Invalid language data");l[e.languageTag]=e,t&&d(e.languageTag)},s.setLanguage=function(e){var t,r,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:i.languageTag;if(!l[e])return t=e.split("-")[0],r=Object.keys(l).find(function(e){return e.split("-")[0]===t}),l[r]?void d(r):void d(n);d(e)},s.registerLanguage(i),a=i.languageTag,t.exports=s},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(n,e,t){"use strict";e.exports=function(t){return{loadLanguagesInNode:function(e){var r=t;e.forEach(function(e){var t=void 0;try{t=n("../languages/".concat(e))}catch(t){console.error('Unable to load "'.concat(e,'". No matching language file found.'))}t&&r.registerLanguage(t)})}}}},{}],6:[function(e,t,r){"use strict";var o=e("bignumber.js");function n(e,t,r){var n=new o(e._value),i=t;return r.isNumbro(t)&&(i=t._value),i=new o(i),e._value=n.minus(i).toNumber(),e}t.exports=function(i){return{add:function(e,t){return t=t,n=i,r=new o((e=e)._value),n.isNumbro(n=t)&&(n=t._value),n=new o(n),e._value=r.plus(n).toNumber(),e;var r,n},subtract:function(e,t){return n(e,t,i)},multiply:function(e,t){return t=t,n=i,r=new o((e=e)._value),n.isNumbro(n=t)&&(n=t._value),n=new o(n),e._value=r.times(n).toNumber(),e;var r,n},divide:function(e,t){return t=t,n=i,r=new o((e=e)._value),n.isNumbro(n=t)&&(n=t._value),n=new o(n),e._value=r.dividedBy(n).toNumber(),e;var r,n},set:function(e,t){return e=e,r=t=t,i.isNumbro(t)&&(r=t._value),e._value=r,e;var r},difference:function(e,t){return t=t,n(e=(r=i)(e._value),t,r),Math.abs(e._value);var r}}}},{"bignumber.js":1}],7:[function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=e("./globalState"),o=e("./validating"),s=e("./loading")(f),a=e("./unformatting"),l=e("./formatting")(f),c=e("./manipulating")(f),u=e("./parsing"),d=(n(h.prototype,[{key:"clone",value:function(){return f(this._value)}},{key:"format",value:function(){return l.format(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})}},{key:"formatCurrency",value:function(e){return"string"==typeof e&&(e=u.parseFormat(e)),(e=l.formatOrDefault(e,i.currentCurrencyDefaultFormat())).output="currency",l.format(this,e)}},{key:"formatTime",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return e.output="time",l.format(this,e)}},{key:"binaryByteUnits",value:function(){return l.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return l.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return l.getByteUnit(this)}},{key:"difference",value:function(e){return c.difference(this,e)}},{key:"add",value:function(e){return c.add(this,e)}},{key:"subtract",value:function(e){return c.subtract(this,e)}},{key:"multiply",value:function(e){return c.multiply(this,e)}},{key:"divide",value:function(e){return c.divide(this,e)}},{key:"set",value:function(e){return c.set(this,p(e))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}]),h);function h(e){if(!(this instanceof h))throw new TypeError("Cannot call a class as a function");this._value=e}function p(e){var t=e;return f.isNumbro(e)?t=e._value:"string"==typeof e?t=f.unformat(e):isNaN(e)&&(t=NaN),t}function f(e){return new d(p(e))}f.version="2.1.2",f.isNumbro=function(e){return e instanceof d},f.language=i.currentLanguage,f.registerLanguage=i.registerLanguage,f.setLanguage=i.setLanguage,f.languages=i.languages,f.languageData=i.languageData,f.zeroFormat=i.setZeroFormat,f.defaultFormat=i.currentDefaults,f.setDefaults=i.setDefaults,f.defaultCurrencyFormat=i.currentCurrencyDefaultFormat,f.validate=o.validate,f.loadLanguagesInNode=s.loadLanguagesInNode,f.unformat=a.unformat,t.exports=f},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(e,t,r){"use strict";t.exports={parseFormat:function(e){var t,r,n,i,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return"string"!=typeof e?e:(n=t=o,function(e,t){if(-1===e.indexOf("$")){if(-1===e.indexOf("%"))return-1!==e.indexOf("bd")?(t.output="byte",t.base="general"):-1!==e.indexOf("b")?(t.output="byte",t.base="binary"):-1!==e.indexOf("d")?(t.output="byte",t.base="decimal"):-1===e.indexOf(":")?-1!==e.indexOf("o")&&(t.output="ordinal"):t.output="time";t.output="percent"}else t.output="currency"}(e=(r=(t=e=(r=(i=e).match(/^{([^}]*)}/))?(t.prefix=r[1],i.slice(r[0].length)):i).match(/{([^}]*)}$/))?(n.postfix=r[1],t.slice(0,-r[0].length)):t,o),i=o,(n=e.match(/[1-9]+[0-9]*/))&&(i.totalLength=+n[0]),r=o,(t=e.split(".")[0].match(/0+/))&&(r.characteristic=t[0].length),i=o,-1!==(n=e).indexOf(".")&&(n=n.split(".")[0],i.optionalCharacteristic=-1===n.indexOf("0")),r=o,-1!==e.indexOf("a")&&(r.average=!0),t=o,-1!==(i=e).indexOf("K")?t.forceAverage="thousand":-1!==i.indexOf("M")?t.forceAverage="million":-1!==i.indexOf("B")?t.forceAverage="billion":-1!==i.indexOf("T")&&(t.forceAverage="trillion"),n=o,(r=e.split(".")[1])&&(r=r.match(/0+/))&&(n.mantissa=r[0].length),i=o,(t=e).match(/\[\.]/)?i.optionalMantissa=!0:t.match(/\./)&&(i.optionalMantissa=!1),n=o,-1!==e.indexOf(",")&&(n.thousandSeparated=!0),r=o,-1!==e.indexOf(" ")&&(r.spaceSeparated=!0),t=o,(i=e).match(/^\+?\([^)]*\)$/)&&(t.negative="parenthesis"),i.match(/^\+?-/)&&(t.negative="sign"),n=o,e.match(/^\+/)&&(n.forceSign=!0),o)}}},{}],9:[function(d,e,t){"use strict";var b=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function w(e){return e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}e.exports={unformat:function(e,t){var r,n,i,o=d("./globalState"),s=o.currentDelimiters(),a=o.currentCurrency().symbol,l=o.currentOrdinal(),c=o.getZeroFormat(),o=o.currentAbbreviations(),u=void 0;if("string"==typeof e)u=function(e,t){if(e.indexOf(":")&&":"!==t.thousands){var r,t=e.split(":");if(3===t.length)return e=+t[0],r=+t[1],t=+t[2],!isNaN(e)&&!isNaN(r)&&!isNaN(t)}}(e,s)?(n=+(r=e.split(":"))[0],i=+r[1],+r[2]+60*i+3600*n):function(e,t,r,n,i,o,s){if(r=2<arguments.length&&void 0!==r?r:"",n=3<arguments.length?n:void 0,i=4<arguments.length?i:void 0,o=5<arguments.length?o:void 0,s=6<arguments.length?s:void 0,""!==e)return e===i?0:function e(t,r){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",i=3<arguments.length?arguments[3]:void 0,o=4<arguments.length?arguments[4]:void 0,s=5<arguments.length?arguments[5]:void 0,a=6<arguments.length?arguments[6]:void 0;if(!isNaN(+t))return+t;var l="",c=t.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(c!==t)return-1*e(c,r,n,i,o,s,a);for(var u=0;u<b.length;u++){var d=b[u];if((l=t.replace(d.key,""))!==t)return e(l,r,n,i,o,s,a)*d.factor}if((l=t.replace("%",""))!==t)return e(l,r,n,i,o,s,a)/100;c=parseFloat(t);if(!isNaN(c)){c=i(c);if(c&&"."!==c&&(l=t.replace(new RegExp("".concat(w(c),"$")),""))!==t)return e(l,r,n,i,o,s,a);var h={};Object.keys(s).forEach(function(e){h[s[e]]=e});for(var p=Object.keys(h).sort().reverse(),f=p.length,g=0;g<f;g++){var m=p[g],y=h[m];if((l=t.replace(m,""))!==t){var v=void 0;switch(y){case"thousand":v=Math.pow(10,3);break;case"million":v=Math.pow(10,6);break;case"billion":v=Math.pow(10,9);break;case"trillion":v=Math.pow(10,12)}return e(l,r,n,i,o,s,a)*v}}}}(function(e,t,r){e=e.replace(2<arguments.length&&void 0!==r?r:"","");return(e=e.replace(new RegExp("([0-9])".concat(w(t.thousands),"([0-9])"),"g"),"$1$2")).replace(t.decimal,".")}(e,t,r),t,r,n,i,o,s)}(e,s,a,l,c,o,t);else{if("number"!=typeof e)return;u=e}if(void 0!==u)return u}}},{"./globalState":4}],10:[function(e,t,r){"use strict";function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var n=e("./unformatting"),i=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,d={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(e,t){return"byte"===t.output},message:"`base` must be provided only when the output is `byte`",mandatory:function(e){return"byte"===e.output}},characteristic:{type:"number",restriction:function(e){return 0<=e},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(e){return 0<=e},message:"value must be positive"},{restriction:function(e,t){return!t.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(e){return 0<=e},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(e,t){return"percent"===t.output},message:"`prefixSymbol` can be provided only when the output is `percent`"}},o={languageTag:{type:"string",mandatory:!0,restriction:function(e){return e.match(i)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function s(e){return!!n.unformat(e)}function h(a,l,c,e){var e=3<arguments.length&&void 0!==e&&e,t=Object.keys(a).map(function(e){if(!l[e])return console.error("".concat(c," Invalid key: ").concat(e)),!1;var t=a[e],r=l[e];if("format"===(r="string"==typeof r?{type:r}:r).type){if(!h(t,d,"[Validate ".concat(e,"]"),!0))return!1}else if(u(t)!==r.type)return console.error("".concat(c," ").concat(e,' type mismatched: "').concat(r.type,'" expected, "').concat(u(t),'" provided')),!1;if(r.restrictions&&r.restrictions.length)for(var n=r.restrictions.length,i=0;i<n;i++){var o=r.restrictions[i],s=o.restriction,o=o.message;if(!s(t,a))return console.error("".concat(c," ").concat(e," invalid value: ").concat(o)),!1}return r.restriction&&!r.restriction(t,a)?(console.error("".concat(c," ").concat(e," invalid value: ").concat(r.message)),!1):r.validValues&&-1===r.validValues.indexOf(t)?(console.error("".concat(c," ").concat(e," invalid value: must be among ").concat(JSON.stringify(r.validValues),', "').concat(t,'" provided')),!1):!(r.children&&!h(t,r.children,"[Validate ".concat(e,"]")))});return e||t.push.apply(t,function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e=Object.keys(l).map(function(e){var t=l[e];if((t="string"==typeof t?{type:t}:t).mandatory){t=t.mandatory;if((t="function"==typeof t?t(a):t)&&void 0===a[e])return console.error("".concat(c,' Missing mandatory key "').concat(e,'"')),!1}return!0}))||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()),t.reduce(function(e,t){return e&&t},!0)}function a(e){return h(e,d,"[Validate format]")}t.exports={validate:function(e,t){e=s(e),t=a(t);return e&&t},validateFormat:a,validateInput:s,validateLanguage:function(e){return h(e,o,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7),window.numbro=r(770)},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(772);t.RENDERER_TYPE=r.RENDERER_TYPE,t.passwordRenderer=r.passwordRenderer},(e,t,r)=>{"use strict";t.__esModule=!0,t.passwordRenderer=n;var c=r(729),u=r(334),d=r(512);t.RENDERER_TYPE="password";function n(e,t,r,n,i,o,s){c.textRenderer.apply(this,[e,t,r,n,i,o,s]);e=s.hashLength||t.innerHTML.length;const a=s.hashSymbol||"*";let l="";(0,d.rangeEach)(e-1,()=>{l+=a}),(0,u.fastInnerHTML)(t,l)}n.RENDERER_TYPE="password"},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(774);t.RENDERER_TYPE=r.RENDERER_TYPE,t.selectRenderer=r.selectRenderer},(e,t,r)=>{"use strict";t.__esModule=!0,t.selectRenderer=n;var a=r(729);t.RENDERER_TYPE="select";function n(e,t,r,n,i,o,s){a.textRenderer.apply(this,[e,t,r,n,i,o,s])}n.RENDERER_TYPE="select"},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(776);t.RENDERER_TYPE=r.RENDERER_TYPE,t.timeRenderer=r.timeRenderer},(e,t,r)=>{"use strict";t.__esModule=!0,t.timeRenderer=n;var a=r(729);t.RENDERER_TYPE="time";function n(e,t,r,n,i,o,s){a.textRenderer.apply(this,[e,t,r,n,i,o,s]),t.dir="ltr"}n.RENDERER_TYPE="time"},(e,t,r)=>{"use strict";t.__esModule=!0,t.registerAllValidators=function(){(0,l.registerValidator)(n.autocompleteValidator),(0,l.registerValidator)(o.dropdownValidator),(0,l.registerValidator)(i.dateValidator),(0,l.registerValidator)(s.numericValidator),(0,l.registerValidator)(a.timeValidator)};var n=r(778),i=(t.autocompleteValidator=n.autocompleteValidator,t.AUTOCOMPLETE_VALIDATOR=n.VALIDATOR_TYPE,r(780)),o=(t.dateValidator=i.dateValidator,t.DATE_VALIDATOR=i.VALIDATOR_TYPE,r(783)),s=(t.dropdownValidator=o.dropdownValidator,t.DROPDOWN_VALIDATOR=o.VALIDATOR_TYPE,r(785)),a=(t.numericValidator=s.numericValidator,t.NUMERIC_VALIDATOR=s.VALIDATOR_TYPE,r(787)),l=(t.timeValidator=a.timeValidator,t.TIME_VALIDATOR=a.VALIDATOR_TYPE,r(516));t.registerValidator=l.registerValidator,t.getRegisteredValidatorNames=l.getRegisteredValidatorNames,t.getRegisteredValidators=l.getRegisteredValidators,t.getValidator=l.getValidator,t.hasValidator=l.hasValidator},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(779);t.VALIDATOR_TYPE=r.VALIDATOR_TYPE,t.autocompleteValidator=r.autocompleteValidator},(e,t)=>{"use strict";t.__esModule=!0,t.autocompleteValidator=r;t.VALIDATOR_TYPE="autocomplete";function r(e,t){let r=e;null!==r&&void 0!==r||(r=""),(!this.allowEmpty||""!==r)&&this.strict&&this.source?"function"==typeof this.source?this.source(r,n(r,t)):n(r,t)(this.source):t(!0)}function n(e,t){const i=e;return function(r){let n=!1;for(let e=0,t=r.length;e<t;e++)if(i===r[e]){n=!0;break}t(n)}}r.VALIDATOR_TYPE="autocomplete"},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(781);t.VALIDATOR_TYPE=r.VALIDATOR_TYPE,t.correctFormat=r.correctFormat,t.dateValidator=r.dateValidator},(e,t,r)=>{"use strict";var n=r(197),a=(t.__esModule=!0,t.correctFormat=u,t.dateValidator=i,n(r(338))),l=r(493),c=r(741),o=r(782);t.VALIDATOR_TYPE="date";function i(e,t){var r=(0,l.getEditorInstance)(c.EDITOR_TYPE,this.instance);let n=e,i=!0,o=(null!==n&&void 0!==n||(n=""),(0,a.default)(n,this.dateFormat||r.defaultDateFormat,!0).isValid()),s=(0,a.default)(new Date(n)).isValid()||o;this.allowEmpty&&""===n&&(s=!0,o=!0),s||(i=!1),!s&&o&&(i=!0),t(i=s&&!o?!0===this.correctFormat&&(e=u(n,this.dateFormat),this.instance.setDataAtCell(this.visualRow,this.visualCol,e,"dateValidator"),!0):i)}function u(e,t){var r=(0,a.default)((0,o.getNormalizedDate)(e)),n=(0,a.default)(e,t),e=-1<e.search(/[A-z]/g);let i;return(i=r.isValid()&&r.format("x")===n.format("x")||!n.isValid()||e?r:n).format(t)}i.VALIDATOR_TYPE="date"},(e,t)=>{"use strict";t.__esModule=!0,t.getNormalizedDate=function(e){var t=new Date(e);return isNaN(new Date(e+"T00:00").getDate())?t:new Date(t.getTime()+6e4*t.getTimezoneOffset())}},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(784);t.VALIDATOR_TYPE=r.VALIDATOR_TYPE,t.dropdownValidator=r.dropdownValidator},(e,t,r)=>{"use strict";t.__esModule=!0,t.dropdownValidator=i;var n=r(779);t.VALIDATOR_TYPE="dropdown";function i(e,t){n.autocompleteValidator.apply(this,[e,t])}i.VALIDATOR_TYPE="dropdown"},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(786);t.VALIDATOR_TYPE=r.VALIDATOR_TYPE,t.numericValidator=r.numericValidator},(e,t,r)=>{"use strict";t.__esModule=!0,t.numericValidator=i;var n=r(512);t.VALIDATOR_TYPE="numeric";function i(e,t){let r=e;null!==r&&void 0!==r||(r=""),this.allowEmpty&&""===r?t(!0):""===r?t(!1):t((0,n.isNumeric)(e))}i.VALIDATOR_TYPE="numeric"},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(788);t.VALIDATOR_TYPE=r.VALIDATOR_TYPE,t.timeValidator=r.timeValidator},(e,t,r)=>{"use strict";var n=r(197),l=(t.__esModule=!0,t.timeValidator=i,n(r(338)));const c=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"];t.VALIDATOR_TYPE="time";function i(e,t){var r=this.timeFormat||"h:mm:ss a";let n=!0,i=e;null===i&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;var e=/^\d{1,2}$/.test(i),o=(e&&(i+=":00"),(0,l.default)(i,c,!0).isValid()?(0,l.default)(i):(0,l.default)(i,r));let s=o.isValid(),a=(0,l.default)(i,r,!0).isValid()&&!e;this.allowEmpty&&""===i&&(s=!0,a=!0),s||(n=!1),!s&&a&&(n=!0),t(n=s&&!a?!0===this.correctFormat&&(e=o.format(r),this.instance.setDataAtCell(this.visualRow,this.visualCol,e,"timeValidator"),!0):n)}i.VALIDATOR_TYPE="time"},(e,t,r)=>{"use strict";t.__esModule=!0,t.registerAllCellTypes=function(){(0,p.registerCellType)(n.AutocompleteCellType),(0,p.registerCellType)(i.CheckboxCellType),(0,p.registerCellType)(o.DateCellType),(0,p.registerCellType)(s.DropdownCellType),(0,p.registerCellType)(a.HandsontableCellType),(0,p.registerCellType)(l.NumericCellType),(0,p.registerCellType)(c.PasswordCellType),(0,p.registerCellType)(u.SelectCellType),(0,p.registerCellType)(d.TextCellType),(0,p.registerCellType)(h.TimeCellType)};var n=r(790),i=(t.AutocompleteCellType=n.AutocompleteCellType,t.AUTOCOMPLETE_TYPE=n.CELL_TYPE,r(792)),o=(t.CheckboxCellType=i.CheckboxCellType,t.CHECKBOX_TYPE=i.CELL_TYPE,r(794)),s=(t.DateCellType=o.DateCellType,t.DATE_TYPE=o.CELL_TYPE,r(798)),a=(t.DropdownCellType=s.DropdownCellType,t.DROPDOWN_TYPE=s.CELL_TYPE,r(800)),l=(t.HandsontableCellType=a.HandsontableCellType,t.HANDSONTABLE_TYPE=a.CELL_TYPE,r(802)),c=(t.NumericCellType=l.NumericCellType,t.NUMERIC_TYPE=l.CELL_TYPE,r(804)),u=(t.PasswordCellType=c.PasswordCellType,t.PASSWORD_TYPE=c.CELL_TYPE,r(806)),d=(t.SelectCellType=u.SelectCellType,t.SELECT_TYPE=u.CELL_TYPE,r(723)),h=(t.TextCellType=d.TextCellType,t.TEXT_TYPE=d.CELL_TYPE,r(808)),p=(t.TimeCellType=h.TimeCellType,t.TIME_TYPE=h.CELL_TYPE,r(645));t.registerCellType=p.registerCellType,t.getCellType=p.getCellType,t.getRegisteredCellTypeNames=p.getRegisteredCellTypeNames,t.getRegisteredCellTypes=p.getRegisteredCellTypes,t.hasCellType=p.hasCellType},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(791);t.AutocompleteCellType=r.AutocompleteCellType,t.CELL_TYPE=r.CELL_TYPE},(e,t,r)=>{"use strict";t.__esModule=!0;var n=r(735),i=r(756),r=r(778);t.CELL_TYPE="autocomplete",t.AutocompleteCellType={CELL_TYPE:"autocomplete",editor:n.AutocompleteEditor,renderer:i.autocompleteRenderer,validator:r.autocompleteValidator}},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(793);t.CELL_TYPE=r.CELL_TYPE,t.CheckboxCellType=r.CheckboxCellType},(e,t,r)=>{"use strict";t.__esModule=!0;var n=r(739),r=r(763);t.CELL_TYPE="checkbox",t.CheckboxCellType={CELL_TYPE:"checkbox",editor:n.CheckboxEditor,renderer:r.checkboxRenderer}},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(795);t.CELL_TYPE=r.CELL_TYPE,t.DateCellType=r.DateCellType},(e,t,r)=>{"use strict";t.__esModule=!0;var n=r(741),i=r(796),r=r(780);t.CELL_TYPE="date",t.DateCellType={CELL_TYPE:"date",editor:n.DateEditor,renderer:i.dateRenderer,validator:r.dateValidator}},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(797);t.RENDERER_TYPE=r.RENDERER_TYPE,t.dateRenderer=r.dateRenderer},(e,t,r)=>{"use strict";t.__esModule=!0,t.dateRenderer=n;var a=r(756);t.RENDERER_TYPE="date";function n(e,t,r,n,i,o,s){a.autocompleteRenderer.apply(this,[e,t,r,n,i,o,s])}n.RENDERER_TYPE="date"},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(799);t.CELL_TYPE=r.CELL_TYPE,t.DropdownCellType=r.DropdownCellType},(e,t,r)=>{"use strict";t.__esModule=!0;var n=r(745),i=r(761),r=r(783);t.CELL_TYPE="dropdown",t.DropdownCellType={CELL_TYPE:"dropdown",editor:n.DropdownEditor,renderer:i.dropdownRenderer,validator:r.dropdownValidator}},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(801);t.CELL_TYPE=r.CELL_TYPE,t.HandsontableCellType=r.HandsontableCellType},(e,t,r)=>{"use strict";t.__esModule=!0;var n=r(737),r=r(766);t.CELL_TYPE="handsontable",t.HandsontableCellType={CELL_TYPE:"handsontable",editor:n.HandsontableEditor,renderer:r.handsontableRenderer}},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(803);t.CELL_TYPE=r.CELL_TYPE,t.NumericCellType=r.NumericCellType},(e,t,r)=>{"use strict";t.__esModule=!0;var n=r(747),i=r(768),r=r(785);t.CELL_TYPE="numeric",t.NumericCellType={CELL_TYPE:"numeric",editor:n.NumericEditor,renderer:i.numericRenderer,validator:r.numericValidator,dataType:"number"}},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(805);t.CELL_TYPE=r.CELL_TYPE,t.PasswordCellType=r.PasswordCellType},(e,t,r)=>{"use strict";t.__esModule=!0;var n=r(749),r=r(771);t.CELL_TYPE="password",t.PasswordCellType={CELL_TYPE:"password",editor:n.PasswordEditor,renderer:r.passwordRenderer,copyable:!1}},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(807);t.CELL_TYPE=r.CELL_TYPE,t.SelectCellType=r.SelectCellType},(e,t,r)=>{"use strict";t.__esModule=!0;var n=r(751),r=r(773);t.CELL_TYPE="select",t.SelectCellType={CELL_TYPE:"select",editor:n.SelectEditor,renderer:r.selectRenderer}},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(809);t.CELL_TYPE=r.CELL_TYPE,t.TimeCellType=r.TimeCellType},(e,t,r)=>{"use strict";t.__esModule=!0;var n=r(753),i=r(775),r=r(787);t.CELL_TYPE="time",t.TimeCellType={CELL_TYPE:"time",editor:n.TimeEditor,renderer:i.timeRenderer,validator:r.timeValidator}},(L,e,t)=>{"use strict";e.__esModule=!0,e.registerAllPlugins=function(){(0,P.registerPlugin)(r.AutoColumnSize),(0,P.registerPlugin)(n.Autofill),(0,P.registerPlugin)(i.AutoRowSize),(0,P.registerPlugin)(o.BindRowsWithHeaders),(0,P.registerPlugin)(s.CollapsibleColumns),(0,P.registerPlugin)(a.ColumnSorting),(0,P.registerPlugin)(l.ColumnSummary),(0,P.registerPlugin)(c.Comments),(0,P.registerPlugin)(u.ContextMenu),(0,P.registerPlugin)(d.CopyPaste),(0,P.registerPlugin)(h.CustomBorders),(0,P.registerPlugin)(p.DragToScroll),(0,P.registerPlugin)(f.DropdownMenu),(0,P.registerPlugin)(g.ExportFile),(0,P.registerPlugin)(m.Filters),(0,P.registerPlugin)(y.Formulas),(0,P.registerPlugin)(v.HiddenColumns),(0,P.registerPlugin)(b.HiddenRows),(0,P.registerPlugin)(w.ManualColumnFreeze),(0,P.registerPlugin)(C.ManualColumnMove),(0,P.registerPlugin)(E.ManualColumnResize),(0,P.registerPlugin)(T.ManualRowMove),(0,P.registerPlugin)(S.ManualRowResize),(0,P.registerPlugin)(_.MergeCells),(0,P.registerPlugin)(x.MultiColumnSorting),(0,P.registerPlugin)(R.MultipleSelectionHandles),(0,P.registerPlugin)(A.NestedHeaders),(0,P.registerPlugin)(N.NestedRows),(0,P.registerPlugin)(O.PersistentState),(0,P.registerPlugin)(I.Search),(0,P.registerPlugin)(M.TouchScroll),(0,P.registerPlugin)(k.TrimRows),(0,P.registerPlugin)(D.UndoRedo)};var r=t(811),n=(e.AutoColumnSize=r.AutoColumnSize,t(817)),i=(e.Autofill=n.Autofill,t(820)),F=(e.AutoRowSize=i.AutoRowSize,t(813)),o=(e.BasePlugin=F.BasePlugin,t(822)),s=(e.BindRowsWithHeaders=o.BindRowsWithHeaders,t(826)),a=(e.CollapsibleColumns=s.CollapsibleColumns,t(829)),l=(e.ColumnSorting=a.ColumnSorting,t(844)),c=(e.ColumnSummary=l.ColumnSummary,t(848)),u=(e.Comments=c.Comments,t(872)),d=(e.ContextMenu=u.ContextMenu,t(889)),h=(e.CopyPaste=d.CopyPaste,t(900)),p=(e.CustomBorders=h.CustomBorders,t(909)),f=(e.DragToScroll=p.DragToScroll,t(911)),g=(e.DropdownMenu=f.DropdownMenu,t(914)),m=(e.ExportFile=g.ExportFile,t(920)),y=(e.Filters=m.Filters,t(969)),v=(e.Formulas=y.Formulas,t(977)),b=(e.HiddenColumns=v.HiddenColumns,t(982)),w=(e.HiddenRows=b.HiddenRows,t(987)),C=(e.ManualColumnFreeze=w.ManualColumnFreeze,t(992)),E=(e.ManualColumnMove=C.ManualColumnMove,t(998)),T=(e.ManualColumnResize=E.ManualColumnResize,t(1e3)),S=(e.ManualRowMove=T.ManualRowMove,t(1006)),_=(e.ManualRowResize=S.ManualRowResize,t(1008)),x=(e.MergeCells=_.MergeCells,t(1019)),R=(e.MultiColumnSorting=x.MultiColumnSorting,t(1025)),A=(e.MultipleSelectionHandles=R.MultipleSelectionHandles,t(1027)),N=(e.NestedHeaders=A.NestedHeaders,t(1044)),O=(e.NestedRows=N.NestedRows,t(1053)),I=(e.PersistentState=O.PersistentState,t(1056)),M=(e.Search=I.Search,t(1058)),k=(e.TouchScroll=M.TouchScroll,t(1060)),D=(e.TrimRows=k.TrimRows,t(1062)),P=(e.UndoRedo=D.UndoRedo,t(510));e.registerPlugin=P.registerPlugin,e.getPlugin=P.getPlugin,e.getPluginsNames=P.getPluginsNames},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(812);t.PLUGIN_KEY=r.PLUGIN_KEY,t.PLUGIN_PRIORITY=r.PLUGIN_PRIORITY,t.AutoColumnSize=r.AutoColumnSize},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),r(286),n(r(487))),o=r(813),a=r(485),s=n(r(815)),l=n(r(494)),c=r(482),u=r(512),d=n(r(816)),h=r(335),p=r(518),f=r(597);function g(e,t,r){m(e,t),t.set(e,r)}function m(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function y(e,t){return e.get(b(e,t))}function v(e,t,r){e.set(b(e,t),r)}function b(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}l.default.getSingleton().register("modifyAutoColumnSizeSeed");const w=t.PLUGIN_KEY="autoColumnSize";t.PLUGIN_PRIORITY=10;var C=new WeakMap,E=new WeakMap,T=new WeakSet;class S extends o.BasePlugin{static get PLUGIN_KEY(){return w}static get PLUGIN_PRIORITY(){return 10}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){var t;super(e),m(e=this,t=T),t.add(e),(0,i.default)(this,"ghostTable",new s.default(this.hot)),(0,i.default)(this,"samplesGenerator",new d.default((e,t)=>{var r=this.hot.toPhysicalRow(e),n=this.hot.toPhysicalColumn(t);if(this.hot.rowIndexMapper.isHidden(r)||this.hot.columnIndexMapper.isHidden(n))return!1;r=this.hot.getCellMeta(e,t);let i="",o=(r.spanned||(i=this.hot.getDataAtCell(e,t)),"");return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(o=this.hot.runHooks("modifyAutoColumnSizeSeed",o,r,i)),{value:i,bundleSeed:o}})),(0,i.default)(this,"inProgress",!1),(0,i.default)(this,"measuredColumns",0),(0,i.default)(this,"columnWidthsMap",new f.PhysicalIndexToValueMap),g(this,C,[]),g(this,E,[]),this.hot.columnIndexMapper.registerMap("autoColumnSize",this.columnWidthsMap),this.addHook("beforeColumnResize",(e,t,r)=>b(T,this,N).call(this,e,t,r))}isEnabled(){return!1!==this.hot.getSettings()[w]&&!this.hot.getSettings().colWidths}enablePlugin(){var e,n=this;this.enabled||((e=this.hot.getSettings()[w])&&null!==e.useHeaders&&void 0!==e.useHeaders&&this.ghostTable.setSetting("useHeaders",e.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return b(T,n,R).call(n,...t)}),this.addHook("beforeChangeRender",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return b(T,n,A).call(n,...t)}),this.addHook("afterFormulasValuesUpdate",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return b(T,n,I).call(n,...t)}),this.addHook("beforeRender",()=>b(T,this,x).call(this)),this.addHook("modifyColWidth",(e,t)=>this.getColumnWidth(t,e)),this.addHook("init",()=>b(T,this,O).call(this)),super.enablePlugin())}updatePlugin(){v(E,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,t,r)=>b(T,this,N).call(this,e,t,r))}calculateVisibleColumnsWidth(){var e,t,r;this.hot.countRows()&&(e=this.getFirstVisibleColumn(),t=this.getLastVisibleColumn(),-1!==e)&&-1!==t&&(r=this.hot.renderCall,this.calculateColumnsWidth({from:e,to:t},void 0,r))}calculateColumnsWidth(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1};let r=2<arguments.length&&void 0!==arguments[2]&&arguments[2];e="number"==typeof e?{from:e,to:e}:e;const n="number"==typeof t?{from:t,to:t}:t;(0,u.rangeEach)(e.from,e.to,e=>{let t=this.hot.toPhysicalColumn(e);null===t&&(t=e),(r||null===this.columnWidthsMap.getValueAtIndex(t)&&!this.hot._getColWidthFromSettings(t))&&this.samplesGenerator.generateColumnSamples(e,n).forEach((e,t)=>this.ghostTable.addColumn(t,e))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((e,t)=>{e=this.hot.toPhysicalColumn(e);this.columnWidthsMap.setValueAtIndex(e,t)})},!0),this.measuredColumns=e.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],r=0;const n=this.hot.countCols()-1;let i=null;this.inProgress=!0;const o=()=>{this.hot?(this.calculateColumnsWidth({from:r,to:Math.min(r+S.CALCULATION_STEP,n)},e,t),(r=r+S.CALCULATION_STEP+1)<n?i=(0,a.requestAnimationFrame)(o):((0,a.cancelAnimationFrame)(i),this.inProgress=!1,this.hot.view.adjustElementsSize())):((0,a.cancelAnimationFrame)(i),this.inProgress=!1)};var s=this.getSyncCalculationLimit();0<=s&&(this.calculateColumnsWidth({from:0,to:s},e,t),r=s+1),r<n?o():this.inProgress=!1}setSamplingOptions(){var e=this.hot.getSettings()[w],t=e&&(0,c.hasOwnProperty)(e,"samplingRatio")?e.samplingRatio:void 0,e=e&&(0,c.hasOwnProperty)(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),e&&this.samplesGenerator.setAllowDuplicates(e)}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){var e=this.hot.getSettings()[w];let t=S.SYNC_CALCULATION_LIMIT;var r=this.hot.countCols()-1;return(0,c.isObject)(e)&&(t=e.syncLimit,(0,h.isPercentValue)(t)?t=(0,u.valueAccordingPercent)(r,t):t>>=0),Math.min(t,r)}getColumnWidth(e,t){var r=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];let n=t;return n=void 0===n&&(n=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r)&&"number"==typeof n?Math.max(n,p.DEFAULT_COLUMN_WIDTH):n}getFirstVisibleColumn(){var e;return null!=(e=this.hot.view.getFirstRenderedVisibleColumn())?e:-1}getLastVisibleColumn(){var e;return null!=(e=this.hot.view.getLastRenderedVisibleColumn())?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((e,t,r)=>{var n=y(C,this).length;return(n-1<r||y(C,this)[r]!==t)&&e.push(this.hot.toVisualColumn(r)),n-1<r?y(C,this).push(t):y(C,this)[r]=t,e},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(e=>{this.columnWidthsMap.setValueAtIndex(e,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>null===e).length}destroy(){this.ghostTable.clean(),super.destroy()}}function _(e){const r={from:0,to:this.hot.countRows()-1};e.forEach(e=>{var t=this.hot.toPhysicalColumn(e);null===t||this.hot._getColWidthFromSettings(t)||this.samplesGenerator.generateColumnSamples(e,r).forEach((e,t)=>this.ghostTable.addColumn(t,e))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((e,t)=>{e=this.hot.toPhysicalColumn(e);this.columnWidthsMap.setValueAtIndex(e,t)})},!0),this.ghostTable.clean())}function x(){this.calculateVisibleColumnsWidth(),this.inProgress||(b(T,this,_).call(this,y(E,this)),v(E,this,[]))}function R(e,t){t||this.recalculateAllColumnsWidth()}function A(e){e=e.reduce((e,t)=>{var[,t]=t,t=this.hot.propToCol(t);return Number.isInteger(t)&&-1===e.indexOf(t)&&e.push(t),e},[]);y(E,this).push(...e)}function N(e,t,r){let n=e;return r&&(this.calculateColumnsWidth(t,void 0,!0),n=this.getColumnWidth(t,void 0,!1)),n}function O(){v(C,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth()}function I(e){e=e.reduce((e,t)=>{var t=null==(t=t.address)?void 0:t.col;return Number.isInteger(t)&&(t=this.hot.toVisualColumn(t),-1===e.indexOf(t))&&e.push(t),e},[]);y(E,this).push(...e)}t.AutoColumnSize=S},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(814);t.PLUGIN_KEY=r.PLUGIN_KEY,t.BasePlugin=r.BasePlugin},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),r(286),n(r(487))),o=r(482),s=r(478),a=r(510),l=r(645),c=r(493),u=r(515),d=r(516),h=n(r(502));function p(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function f(e,t){return e.get(g(e,t))}function g(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}const m=new Map([["plugin",a.hasPlugin],["cell-type",l.hasCellType],["editor",c.hasEditor],["renderer",u.hasRenderer],["validator",d.hasValidator]]),y=(t.PLUGIN_KEY="base",[]);let v=null;var b=new WeakMap,w=new WeakSet;function C(t){if(t){var r=this.constructor.SETTING_KEYS;if("boolean"==typeof r)return r;for(let e=0;e<r.length;e++)if(void 0!==t[r[e]])return!0}return!1}t.BasePlugin=class{static get PLUGIN_KEY(){return"base"}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(e){var t,r,n;p(t=this,n=w),n.add(t),(0,i.default)(this,"eventManager",new h.default(this)),(0,i.default)(this,"pluginName",null),(0,i.default)(this,"pluginsInitializedCallbacks",[]),(0,i.default)(this,"isPluginsReady",!1),(0,i.default)(this,"enabled",!1),(0,i.default)(this,"initialized",!1),n={},p(t=this,r=b),r.set(t,n),(0,o.defineGetter)(this,"hot",e,{writable:!1}),v=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",e=>this.onUpdateSettings(e)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);var e=this.constructor.PLUGIN_DEPS,e=Array.isArray(e)?e:[];if(0<e.length){const r=[];e.forEach(e=>{var[e,t]=e.split(":");if(!m.has(e))throw new Error(`Unknown plugin dependency type "${e}" was found.`);m.get(e)(t)||r.push(` - ${t} (${e})`)}),0<r.length&&(e=[`The ${this.pluginName} plugin requires the following modules:
`,r.join("\n")+`
`].join(""),y.push(e))}if(0<=(v=v||(0,a.getPluginsNames)()).indexOf("UndoRedo")&&v.splice(v.indexOf("UndoRedo"),1),0<=v.indexOf(this.pluginName)&&v.splice(v.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),0===v.length){if(0<y.length)throw e=[y.join("\n")+`
`,"You have to import and register them manually."].join(""),new Error(e);this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;null!=(e=this.eventManager)&&e.clear(),this.clearHooks(),this.enabled=!1}addHook(e,t,r){f(b,this)[e]=f(b,this)[e]||[];var n=f(b,this)[e];this.hot.addHook(e,t,r),n.push(t),f(b,this)[e]=n}removeHooks(t){(0,s.arrayEach)(f(b,this)[t]||[],e=>{this.hot.removeHook(t,e)})}clearHooks(){var e=f(b,this);(0,o.objectEach)(e,(e,t)=>this.removeHooks(t)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){(0,s.arrayEach)(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){var t=g(w,this,C).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled)&&this.isEnabled()&&t&&this.updatePlugin(e)}updatePlugin(){}destroy(){var e;null!=(e=this.eventManager)&&e.destroy(),this.clearHooks(),(0,o.objectEach)(this,(e,t)=>{"hot"!==t&&(this[t]=null)}),delete this.t,delete this.hot}}},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),r(286),n(r(487))),l=r(334),c=r(478);t.default=class{constructor(e){(0,i.default)(this,"hot",null),(0,i.default)(this,"container",null),(0,i.default)(this,"injected",!1),(0,i.default)(this,"rows",[]),(0,i.default)(this,"columns",[]),(0,i.default)(this,"samples",null),(0,i.default)(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,t){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var r={row:e};this.rows.push(r),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){var t=this.hot.getColHeader(0);null!=t&&(this.rows.push(t={row:-1}),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),t.table=this.table.table)}addColumn(e,t){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var r={col:e};this.columns.push(r),this.samples=t,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(e)&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(t){this.injected||this.injectTable(),(0,c.arrayEach)(this.rows,e=>{t(e.row,(0,l.outerHeight)(e.table)-1)})}getWidths(r){this.injected||this.injectTable(),(0,c.arrayEach)(this.columns,e=>{var t=e.table.getBoundingClientRect()["width"];r(e.col,Math.ceil(t))})}setSettings(e){this.settings=e}setSetting(e,t){this.settings||(this.settings={}),this.settings[e]=t}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(t){const r=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&r.appendChild(this.createColElement(-1,-1)),this.samples.forEach(e=>{(0,c.arrayEach)(e.strings,e=>{r.appendChild(this.createColElement(e.col,t))})}),r}createRow(o){const s=this.hot["rootDocument"],a=s.createDocumentFragment();var e=s.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(o,e),a.appendChild(e)),this.samples.forEach(e=>{(0,c.arrayEach)(e.strings,e=>{var t=e.col,r=this.hot.getCellMeta(o,t),n=this.hot.getCellRenderer(r),i=s.createElement("td");i.setAttribute("ghost-table",1),n(this.hot,i,o,t,this.hot.colToProp(t),e.value,r),a.appendChild(i)})}),a}appendColumnHeadersRow(){const r=this.hot["rootDocument"],n=r.createDocumentFragment(),i=[];var e;this.hot.hasRowHeaders()&&(e=r.createElement("th"),i.push([-1,e]),n.appendChild(e)),this.samples.forEach(e=>{(0,c.arrayEach)(e.strings,e=>{var e=e.col,t=r.createElement("th");i.push([e,t]),n.appendChild(t)})}),this.table.tHead.appendChild(n),(0,c.arrayEach)(i,e=>{var[e,t]=e;this.hot.view.appendColHeader(e,t)})}createCol(s){const a=this.hot["rootDocument"],l=a.createDocumentFragment();return this.samples.forEach(e=>{(0,c.arrayEach)(e.strings,e=>{var t=e.row,r=this.hot.getCellMeta(t,s),n=this.hot.getCellRenderer(r),i=a.createElement("td"),o=a.createElement("tr");i.setAttribute("ghost-table",1),n(this.hot,i,t,s,this.hot.colToProp(s),e.value,r),o.appendChild(i),l.appendChild(o)})}),l}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(t,e){var r=this.hot.rootDocument.createElement("col");let n=0,i=(0<=e&&0<=t&&(n=this.hot.getCellMeta(e,t).colspan),this.hot.getColWidth(t));if(1<n)for(let e=t+1;e<t+n;e++)i+=this.hot.getColWidth(e);return r.style.width=i+"px",r}createTable(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=this.hot["rootDocument"],r=t.createDocumentFragment(),n=t.createElement("table"),i=t.createElement("thead"),o=t.createElement("tbody"),s=t.createElement("colgroup"),a=t.createElement("tr"),t=t.createElement("th");return this.isVertical()&&n.appendChild(s),this.isHorizontal()&&(a.appendChild(t),i.appendChild(a),n.style.tableLayout="auto",n.style.width="auto"),n.appendChild(i),this.isVertical()&&o.appendChild(a),n.appendChild(o),(0,l.addClass)(n,e),r.appendChild(n),{fragment:r,table:n,tHead:i,tBody:o,colGroup:s,tr:a,th:t}}createContainer(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=this.hot["rootDocument"],r=t.createDocumentFragment(),t=t.createElement("div"),e="htGhostTable htAutoSize "+e.trim();return(0,l.addClass)(t,e),r.appendChild(t),{fragment:r,container:t}}isVertical(){return!(!this.rows.length||this.columns.length)}isHorizontal(){return!(!this.columns.length||this.rows.length)}}},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),r(286),n(r(487))),c=r(482),u=r(512),d=r(337);t.default=class o{static get SAMPLE_COUNT(){return 3}constructor(e){(0,i.default)(this,"samples",null),(0,i.default)(this,"dataFactory",null),(0,i.default)(this,"customSampleCount",null),(0,i.default)(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount||o.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,t){return this.generateSamples("row",t,e)}generateColumnSamples(e,t){return this.generateSamples("col",t,e)}generateSamples(r,n,e){const i=new Map;var{from:e,to:t}="number"==typeof e?{from:e,to:e}:e;return(0,u.rangeEach)(e,t,e=>{var t=this.generateSample(r,n,e);i.set(e,t)}),i}generateSample(e,t,o){if("row"!==e&&"col"!==e)throw new Error("Unsupported sample type");const s=new Map,a="row"===e?"col":"row",l=[];return(0,u.rangeEach)(t.from,t.to,t=>{var r="row"===e?this.dataFactory(o,t):this.dataFactory(t,o);if(!1!==r){var{value:r,bundleSeed:n}=r,i="string"==typeof n&&0<n.length;let e;e=i?n:(0,c.isObject)(r)?""+Object.keys(r).length:Array.isArray(r)?""+r.length:""+(0,d.stringify)(r).length,s.has(e)||s.set(e,{needed:this.getSampleCount(),strings:[]}),!(n=s.get(e)).needed||-1<l.indexOf(r)&&!this.allowDuplicates&&!i||(n.strings.push({value:r,[a]:t}),l.push(r),--n.needed)}}),s}}},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(818);t.PLUGIN_KEY=r.PLUGIN_KEY,t.PLUGIN_PRIORITY=r.PLUGIN_PRIORITY,t.Autofill=r.Autofill},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),r(286),n(r(487))),o=r(813),n=n(r(494)),s=r(334),a=r(478),l=r(337),f=r(819);function c(e,t){var r=e;if(t.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object");t.add(e)}function u(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}n.default.getSingleton().register("modifyAutofillRange"),n.default.getSingleton().register("beforeAutofill"),n.default.getSingleton().register("afterAutofill");t.PLUGIN_KEY="autofill",t.PLUGIN_PRIORITY=20;const d=["fillHandle"];var h=new WeakSet;class p extends o.BasePlugin{constructor(){super(...arguments),c(this,h),(0,i.default)(this,"addingStarted",!1),(0,i.default)(this,"mouseDownOnCellCorner",!1),(0,i.default)(this,"mouseDragOutside",!1),(0,i.default)(this,"handleDraggedCells",0),(0,i.default)(this,"directions",[]),(0,i.default)(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return"autofill"}static get PLUGIN_PRIORITY(){return 20}static get SETTING_KEYS(){return["autofill",...d]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>u(h,this,m).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>u(h,this,g).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,t)=>u(h,this,y).call(this,t)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){var e=this.hot.getSelectedRangeLast(),{row:t,col:r}=e.getTopStartCorner(),{row:e,col:n}=e.getBottomEndCorner(),t=this.hot.runHooks("modifyCopyableRange",[{startRow:t,startCol:r,endRow:e,endCol:n}]);const i=[],o=[],s=[];return(0,a.arrayEach)(t,t=>{for(let e=t.startRow;e<=t.endRow;e+=1)-1===i.indexOf(e)&&i.push(e);for(let e=t.startCol;e<=t.endCol;e+=1)-1===o.indexOf(e)&&o.push(e)}),(0,a.arrayEach)(i,t=>{const r=[];(0,a.arrayEach)(o,e=>{r.push(this.hot.getCopyableData(t,e))}),s.push(r)}),s}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;var[e,t,n,i]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=o.getBottomEndCorner(),l=(this.resetSelectionOfDraggedArea(),[s.row,s.col,a.row,a.col]),e=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,t),Math.max(a.row,n),Math.max(a.col,i)],l),{directionOfDrag:s,startOfDragCoords:t,endOfDragCoords:n}=(0,f.getDragDirectionAndRange)(l,e,(e,t)=>this.hot._createCellCoords(e,t));if(t&&-1<t.row&&-1<t.col){a=this.getSelectionData(),i=o.clone(),l=this.hot._createCellRange(t,t,n),o=this.hot.runHooks("beforeAutofill",a,i,l,s);if(!1===o)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let r=o;var c=o;if(-1<["up","left"].indexOf(s)&&(1!==c.length||0!==c[0].length))if(r=[],"up"===s){var u=n.row-t.row+1,d=u%c.length;for(let e=0;e<u;e++)r.push(c[(e+(c.length-d))%c.length])}else{var h=n.col-t.col+1,p=h%c[0].length;for(let t=0;t<c.length;t++){r.push([]);for(let e=0;e<h;e++)r[t].push(c[t][(e+(c[t].length-p))%c[t].length])}}this.hot.populateFromArray(t.row,t.col,r,n.row,n.col,this.pluginName+".fill",null),this.setSelection(e),this.hot.runHooks("afterAutofill",r,i,l,s),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){var t=this.hot.getSelectedRangeLast(),r=t.getBottomEndCorner();let n=e;if(this.directions.includes(f.DIRECTIONS.vertical)&&this.directions.includes(f.DIRECTIONS.horizontal)){t=t.getTopStartCorner();(r.col<=e.col||t.col>=e.col)&&(n=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||t.row>e.row)&&(n=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(f.DIRECTIONS.vertical))n=this.hot._createCellCoords(e.row,r.col);else{if(!this.directions.includes(f.DIRECTIONS.horizontal))return;n=this.hot._createCellCoords(r.row,e.col)}return this.reduceSelectionAreaIfNeeded(n)}showBorder(e){e=this.getCoordsOfDragAndDropBorders(e);e&&this.redrawBorders(e)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter("insert_row_below",void 0,1,this.pluginName+".fill"),this.addingStarted=!1},200)}addNewRowIfNeeded(){var e,t,r;!this.hot.selection.highlight.getFill().isEmpty()&&!1===this.addingStarted&&this.autoInsertRow&&(e=this.hot.getSelectedLast(),t=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows(),e[2]<r-1)&&t[2]===r-1&&(this.addingStarted=!0,this.addRow())}getIndexOfLastAdjacentFilledInRow(r){var n=this.hot.getData(),e=this.hot.countRows();let i;for(let t=r[2]+1;t<e;t++){for(let e=r[1];e<=r[3];e++){var o=n[t][e];if(!(0,l.isEmpty)(o))return-1}var s=n[t][r[1]-1],a=n[t][r[3]+1];(0,l.isEmpty)(s)&&(0,l.isEmpty)(a)||(i=t)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,t){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(t,e[3])).commit()}setSelection(e){this.hot.selectCell(...(0,a.arrayMap)(e,e=>Math.max(e,0)),!1,!1)}selectAdjacent(){var e=this.hot.getSelectedLast(),t=this.getIndexOfLastAdjacentFilledInRow(e);return-1!==t&&void 0!==t&&(this.addSelectionFromStartAreaToSpecificRowIndex(e,t),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){var t=this.hot.rootDocument["documentElement"],r=(0,s.offset)(this.hot.table).top-(this.hot.rootWindow.pageYOffset||t.scrollTop)+(0,s.outerHeight)(this.hot.table),t=(0,s.offset)(this.hot.table).left-(this.hot.rootWindow.pageXOffset||t.scrollLeft)+(0,s.outerWidth)(this.hot.table);return e.clientY>r&&e.clientX<=t}registerEvents(){var e=this.hot.rootDocument["documentElement"];this.eventManager.addEventListener(e,"mouseup",()=>u(h,this,v).call(this)),this.eventManager.addEventListener(e,"mousemove",e=>u(h,this,b).call(this,e))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){var e=(0,f.getMappedFillHandleSetting)(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function g(){this.selectAdjacent()&&this.fillIn()}function m(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function y(e){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(e),this.addNewRowIfNeeded())}function v(){this.handleDraggedCells&&(1<this.handleDraggedCells&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function b(e){e=this.getIfMouseWasDraggedOutside(e);!1===this.addingStarted&&0<this.handleDraggedCells&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}t.Autofill=p},(e,t,r)=>{"use strict";t.__esModule=!0,t.getDragDirectionAndRange=function(e,t,r){let n,i,o;t[0]===e[0]&&t[1]<e[1]?(o="left",n=r(t[0],t[1]),i=r(t[2],e[1]-1)):t[2]===e[2]&&t[0]===e[0]&&t[3]>e[3]?(o="right",n=r(t[0],e[3]+1),i=r(t[2],t[3])):t[0]<e[0]&&t[1]===e[1]?(o="up",n=r(t[0],t[1]),i=r(e[0]-1,t[3])):t[2]>e[2]&&t[1]===e[1]&&(o="down",n=r(e[2]+1,t[1]),i=r(t[2],t[3]));n&&n.normalize();i&&i.normalize();return{directionOfDrag:o,startOfDragCoords:n,endOfDragCoords:i}},t.getMappedFillHandleSetting=function(e){var t={};!0===e?(t.directions=Object.keys(o),t.autoInsertRow=!0):(0,n.isObject)(e)?(!(0,i.isDefined)(e.autoInsertRow)||e.direction===o.horizontal?t.autoInsertRow=!1:t.autoInsertRow=e.autoInsertRow,(0,i.isDefined)(e.direction)?t.directions=[e.direction]:t.directions=Object.keys(o)):"string"==typeof e?(t.directions=[e],t.autoInsertRow=!0):(t.directions=[],t.autoInsertRow=!1);return t};var n=r(482),i=r(337);const o=t.DIRECTIONS={horizontal:"horizontal",vertical:"vertical"}},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(821);t.PLUGIN_KEY=r.PLUGIN_KEY,t.PLUGIN_PRIORITY=r.PLUGIN_PRIORITY,t.AutoRowSize=r.AutoRowSize},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),r(286),n(r(487))),o=r(813),a=r(485),s=n(r(815)),l=r(482),c=r(512),u=n(r(816)),d=r(335),h=r(597);function p(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function f(e,t){return e.get(g(e,t))}function g(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}const m=t.PLUGIN_KEY="autoRowSize";t.PLUGIN_PRIORITY=40;var y=new WeakMap,v=new WeakSet;class b extends o.BasePlugin{static get PLUGIN_KEY(){return m}static get PLUGIN_PRIORITY(){return 40}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){var t,r;super(e),p(e=this,r=v),r.add(e),(0,i.default)(this,"headerHeight",null),(0,i.default)(this,"ghostTable",new s.default(this.hot)),(0,i.default)(this,"samplesGenerator",new u.default((e,t)=>{var r=this.hot.toPhysicalRow(e),n=this.hot.toPhysicalColumn(t);if(this.hot.rowIndexMapper.isHidden(r)||this.hot.columnIndexMapper.isHidden(n))return!1;if(0<=e&&0<=t&&this.hot.getCellMeta(e,t).hidden)return!1;let i;return 0<=e?i=this.hot.getDataAtCell(e,t):-1===e&&(i=this.hot.getColHeader(t)),{value:i}})),(0,i.default)(this,"inProgress",!1),(0,i.default)(this,"measuredRows",0),(0,i.default)(this,"rowHeightsMap",new h.PhysicalIndexToValueMap),r=[],p(e=this,t=y),t.set(e,r),this.hot.rowIndexMapper.registerMap("autoRowSize",this.rowHeightsMap),this.addHook("beforeRowResize",(e,t,r)=>g(v,this,E).call(this,e,t,r))}isEnabled(){var e=this.hot.getSettings()[m];return!0===e||(0,l.isObject)(e)}enablePlugin(){var n=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return g(v,n,T).call(n,...t)}),this.addHook("beforeChangeRender",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return g(v,n,S).call(n,...t)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return g(v,n,x).call(n,...t)}),this.addHook("beforeRender",()=>g(v,this,C).call(this)),this.addHook("modifyRowHeight",(e,t)=>this.getRowHeight(t,e)),this.addHook("init",()=>g(v,this,_).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,t,r)=>g(v,this,E).call(this,e,t,r))}calculateVisibleRowsHeight(){var e,t,r;this.hot.countCols()&&(e=this.getFirstVisibleRow(),t=this.getLastVisibleRow(),-1!==e)&&-1!==t&&(r=this.hot.renderCall,this.calculateRowsHeight({from:e,to:t},void 0,r))}calculateRowsHeight(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countCols()-1};let r=2<arguments.length&&void 0!==arguments[2]&&arguments[2];e="number"==typeof e?{from:e,to:e}:e;const n="number"==typeof t?{from:t,to:t}:t;null!==this.hot.getColHeader(0)&&(t=this.samplesGenerator.generateRowSamples(-1,n),this.ghostTable.addColumnHeadersRow(t.get(-1))),(0,c.rangeEach)(e.from,e.to,e=>{let t=this.hot.toPhysicalRow(e);null===t&&(t=e),!r&&null!==this.rowHeightsMap.getValueAtIndex(t)||this.samplesGenerator.generateRowSamples(e,n).forEach((e,t)=>this.ghostTable.addRow(t,e))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((e,t)=>{e<0?this.headerHeight=t:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(e),t)})},!0),this.measuredRows=e.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],r=0;const n=this.hot.countRows()-1;let i=null;this.inProgress=!0;const o=()=>{this.hot?(this.calculateRowsHeight({from:r,to:Math.min(r+b.CALCULATION_STEP,n)},e,t),(r=r+b.CALCULATION_STEP+1)<n?i=(0,a.requestAnimationFrame)(o):((0,a.cancelAnimationFrame)(i),this.inProgress=!1,this.hot.view.adjustElementsSize(),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())):((0,a.cancelAnimationFrame)(i),this.inProgress=!1)};var s=this.getSyncCalculationLimit();0<=s&&(this.calculateRowsHeight({from:0,to:s},e,t),r=s+1),r<n?o():(this.inProgress=!1,this.hot.view.adjustElementsSize())}setSamplingOptions(){var e=this.hot.getSettings()[m],t=e&&(0,l.hasOwnProperty)(e,"samplingRatio")?e.samplingRatio:void 0,e=e&&(0,l.hasOwnProperty)(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),e&&this.samplesGenerator.setAllowDuplicates(e)}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){var e=this.hot.getSettings()[m];let t=b.SYNC_CALCULATION_LIMIT;var r=this.hot.countRows()-1;return(0,l.isObject)(e)&&(t=e.syncLimit,(0,d.isPercentValue)(t)?t=(0,c.valueAccordingPercent)(r,t):t>>=0),Math.min(t,r)}getRowHeight(e,t){e=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let r=null!==e&&(t||0)<e?e:t;return r}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return null!=(e=this.hot.view.getFirstRenderedVisibleRow())?e:-1}getLastVisibleRow(){var e;return null!=(e=this.hot.view.getLastRenderedVisibleRow())?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(e=>{this.rowHeightsMap.setValueAtIndex(e,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:t,to:r}="number"==typeof e?{from:e,to:e}:e;this.hot.batchExecution(()=>{(0,c.rangeEach)(Math.min(t,r),Math.max(t,r),e=>{this.rowHeightsMap.setValueAtIndex(e,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>null===e).length}destroy(){this.ghostTable.clean(),super.destroy()}}function w(e){const t={from:0,to:this.hot.countCols()-1};e.forEach(e=>{this.samplesGenerator.generateRowSamples(e,t).forEach((e,t)=>this.ghostTable.addRow(t,e))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((e,t)=>{e=this.hot.toPhysicalRow(e);this.rowHeightsMap.setValueAtIndex(e,t)})},!0),this.ghostTable.clean())}function C(){var e,t;this.calculateVisibleRowsHeight(),this.inProgress||(g(v,this,w).call(this,f(y,this)),e=this,t=[],y.set(g(y,e),t))}function E(e,t,r){let n=e;return r&&(this.calculateRowsHeight(t,void 0,!0),n=this.getRowHeight(t)),n}function T(e,t){t||this.recalculateAllRowsHeight()}function S(e){e=e.reduce((e,t)=>{var[t]=t;return-1===e.indexOf(t)&&e.push(t),e},[]);f(y,this).push(...e)}function _(){this.recalculateAllRowsHeight()}function x(e){e=e.reduce((e,t)=>{var t=null==(t=t.address)?void 0:t.row;return Number.isInteger(t)&&(t=this.hot.toVisualRow(t),-1===e.indexOf(t))&&e.push(t),e},[]);f(y,this).push(...e)}t.AutoRowSize=b},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(823);t.PLUGIN_KEY=r.PLUGIN_KEY,t.PLUGIN_PRIORITY=r.PLUGIN_PRIORITY,t.BindRowsWithHeaders=r.BindRowsWithHeaders},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),n(r(487))),o=r(813),s=n(r(824)),n=n(r(825));function a(e,t){var r=e;if(t.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object");t.add(e)}const l=t.PLUGIN_KEY="bindRowsWithHeaders",c=(t.PLUGIN_PRIORITY=210,new Map([["loose",s.default],["strict",n.default]]));var u=new WeakSet;class d extends o.BasePlugin{constructor(){super(...arguments),a(this,u),(0,i.default)(this,"headerIndexes",null)}static get PLUGIN_KEY(){return l}static get PLUGIN_PRIORITY(){return 210}isEnabled(){return!!this.hot.getSettings()[l]}enablePlugin(){if(!this.enabled){let e=this.hot.getSettings()[l];"string"!=typeof e&&(e="loose");var t=c.get(e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new t),this.addHook("modifyRowHeader",e=>function(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}(u,this,h).call(this,e)),super.enablePlugin()}}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function h(e){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(e))}t.BindRowsWithHeaders=d},(e,t,r)=>{"use strict";t.__esModule=!0;var n=r(597);const{getListWithInsertedItems:i,getListWithRemovedItems:o}=(0,n.alterUtilsFactory)("physicallyIndexed");class s extends n.IndexMap{constructor(){super(e=>e)}insert(e,t){var r=(0,n.getIncreasedIndexes)(this.indexedValues,t);this.indexedValues=i(r,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){var t=o(this.indexedValues,e);this.indexedValues=(0,n.getDecreasedIndexes)(t,e),super.remove(e)}}t.default=s},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(597);const{getListWithInsertedItems:n,getListWithRemovedItems:i}=(0,r.alterUtilsFactory)("physicallyIndexed");class o extends r.IndexMap{constructor(){super(e=>e)}insert(e,t){this.indexedValues=n(this.indexedValues,e,t,(e,t)=>this.getNextValue(t)),super.insert(e,t)}remove(e){this.indexedValues=i(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}t.default=o},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(827);t.PLUGIN_KEY=r.PLUGIN_KEY,t.PLUGIN_PRIORITY=r.PLUGIN_PRIORITY,t.CollapsibleColumns=r.CollapsibleColumns},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),r(286),n(r(487))),n=r(813),u=r(478),l=r(512),o=r(500),s=r(334),a=r(492),c=r(656),d=r(479);function h(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function p(e,t){return e.get(g(e,t))}function f(e,t,r){e.set(g(e,t),r)}function g(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}r(828);const m=t.PLUGIN_KEY="collapsibleColumns",y=(t.PLUGIN_PRIORITY=290,["nestedHeaders"]),v="collapsibleIndicator",b=m,w=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var C=new WeakMap,E=new WeakSet;class T extends n.BasePlugin{constructor(){var e,t,r;super(...arguments),h(e=this,r=E),r.add(e),(0,i.default)(this,"nestedHeadersPlugin",null),(0,i.default)(this,"headerStateManager",null),r=null,h(e=this,t=C),t.set(e,r)}static get PLUGIN_KEY(){return m}static get PLUGIN_PRIORITY(){return 290}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[m,...y]}isEnabled(){return!!this.hot.getSettings()[m]}enablePlugin(){var e,n=this;this.enabled||(e=this.hot.getSettings()["nestedHeaders"],e||(0,o.warn)("You need to configure the Nested Headers plugin in order to use collapsible headers."),f(C,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>g(E,this,x).call(this)),this.addHook("afterLoadData",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return g(E,n,R).call(n,...t)}),this.addHook("afterGetColHeader",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return g(E,n,S).call(n,...t)}),this.addHook("beforeOnCellMouseDown",(e,t,r)=>g(E,this,_).call(this,e,t,r)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin())}updatePlugin(){var e;this.hot.view&&(this.nestedHeadersPlugin.detectedOverlappedHeaders||(e=this.hot.getSettings()["collapsibleColumns"],"boolean"==typeof e?this.headerStateManager.mapState(e=>({collapsible:1<e.origColspan})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))),super.updatePlugin())}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),f(C,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var{row:e,col:t}=this.hot.getSelectedRangeLast().highlight,{collapsible:t,isCollapsed:r,columnIndex:n}=null!=(t=this.headerStateManager.getHeaderTreeNodeData(e,t))?t:{};if(t)return r?this.expandSection({row:e,col:n}):this.collapseSection({row:e,col:n}),!1},runOnlyIf:()=>{var e;return(null==(e=this.hot.getSelectedRangeLast())?void 0:e.isSingle())&&(null==(e=this.hot.getSelectedRangeLast())?void 0:e.highlight.isHeader())},group:b,relativeToGroup:c.EDITOR_EDIT_GROUP,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(b)}clearButtons(){if(this.hot.view){var e=this.hot.view._wt.getSetting("columnHeaders").length;const t=this.hot.view._wt.wtTable.THEAD,o=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,s=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,a=function(e){e&&e.parentNode.removeChild(e)};(0,l.rangeEach)(0,e-1,e=>{const r=t.childNodes[e],n=o.childNodes[e],i=s?s.childNodes[e]:null;(0,l.rangeEach)(0,r.childNodes.length-1,e=>{let t=r.childNodes[e].querySelector("."+v);a(t),n&&n.childNodes[e]&&(t=n.childNodes[e].querySelector("."+v),a(t)),s&&i&&i.childNodes[e]&&(t=i.childNodes[e].querySelector("."+v),a(t))})},!0)}}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(o){var e=this.headerStateManager.mapNodes(e=>{var{collapsible:e,origColspan:t,headerLevel:r,columnIndex:n,isCollapsed:i}=e;if(!0===e&&1<t&&(i&&"expand"===o||!i&&"collapse"===o))return{row:this.headerStateManager.levelToRowCoords(r),col:n}});this.toggleCollapsibleSection(e,o)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(t,n){if(!w.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(Array.isArray(t)){t=(0,u.arrayFilter)(t,e=>{e=e.row;return e<0});let r=0<t.length;(0,u.arrayEach)(t,e=>{var{row:e,col:t}=e,{collapsible:t,isCollapsed:e}=null!=(e=this.headerStateManager.getHeaderSettings(e,t))?e:{};if(!t||e&&"collapse"===n||!e&&"expand"===n)return r=!1});const a=[],l=[];r&&(0,u.arrayEach)(t,e=>{var{row:e,col:t}=e,{colspanCompensation:e,affectedColumns:t,rollbackModification:r}=this.headerStateManager.triggerNodeModification(n,e,t);0<e&&(l.push(...t),a.push(r))});var i,o,s,t=this.getCollapsedColumns();let e=[];"collapse"===n?e=(0,u.arrayUnique)([...t,...l]):"expand"===n&&(e=(0,u.arrayFilter)(t,e=>!l.includes(e)));const c=w.get(n);!1===this.hot.runHooks(c.beforeHook,t,e,r)?(0,u.arrayEach)(a,e=>{e()}):(this.hot.batchExecution(()=>{(0,u.arrayEach)(l,e=>{p(C,this).setValueAtIndex(this.hot.toPhysicalColumn(e),c.hideColumn)})},!0),i=this.getCollapsedColumns().length!==t.length,o=this.hot.getSelectedRangeLast(),"collapse"===n&&i&&o&&({row:o,col:s}=o.highlight,this.hot.rowIndexMapper.isHidden(o)||this.hot.columnIndexMapper.isHidden(s))&&l.includes(s)&&(o=0<=o?this.hot.rowIndexMapper.getNearestNotHiddenIndex(o,1,!0):o,s=0<=s?this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0):s,null!==o)&&null!==s&&this.hot.selectCell(o,s),this.hot.runHooks(c.afterHook,t,e,r,i),this.hot.render(),this.hot.view.adjustElementsSize())}}getCollapsedColumns(){return p(C,this).getHiddenIndexes()}destroy(){f(C,this,null),super.destroy()}}function S(e,t,r){var{collapsible:r,origColspan:n,isCollapsed:i}=null!=(r=this.headerStateManager.getHeaderSettings(r,e))?r:{},r=r&&1<n&&e>=this.hot.getSettings().fixedColumnsStart,n=this.hot.getSettings().ariaTags;let o=t.querySelector("."+v);(0,s.removeAttribute)(t,[(0,d.A11Y_EXPANDED)("")[0]]),r?(o||(o=this.hot.rootDocument.createElement("div"),(0,s.addClass)(o,v),t.querySelector("div:first-child").appendChild(o)),(0,s.removeClass)(o,["collapsed","expanded"]),i?((0,s.addClass)(o,"collapsed"),(0,s.fastInnerText)(o,"+"),n&&(0,s.setAttribute)(t,...(0,d.A11Y_EXPANDED)(!1))):((0,s.addClass)(o,"expanded"),(0,s.fastInnerText)(o,"-"),n&&(0,s.setAttribute)(t,...(0,d.A11Y_EXPANDED)(!0))),n&&(0,s.setAttribute)(o,...(0,d.A11Y_HIDDEN)())):null!=(e=o)&&e.remove()}function _(e,t){(0,s.hasClass)(e.target,v)&&((0,s.hasClass)(e.target,"expanded")?(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"collapse")):(0,s.hasClass)(e.target,"collapsed")&&(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"expand")),(0,a.stopImmediatePropagation)(e))}function x(){this.updatePlugin()}function R(e,t){t||this.updatePlugin()}t.CollapsibleColumns=T},(e,t,r)=>{"use strict";r.r(t)},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(830);t.PLUGIN_KEY=r.PLUGIN_KEY,t.PLUGIN_PRIORITY=r.PLUGIN_PRIORITY,t.ColumnSorting=r.ColumnSorting,t.APPEND_COLUMN_CONFIG_STRATEGY=r.APPEND_COLUMN_CONFIG_STRATEGY,t.REPLACE_COLUMN_CONFIG_STRATEGY=r.REPLACE_COLUMN_CONFIG_STRATEGY},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),r(286),n(r(487))),o=r(334),s=r(337),a=r(482),l=r(480),c=r(478),u=r(813),d=r(597),n=n(r(494)),h=r(831),p=r(656),f=r(832),g=r(841),m=r(842),y=r(833),v=r(479);function b(e,t){var r=e;if(t.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object");t.add(e)}function w(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}r(843);const C=t.PLUGIN_KEY="columnSorting",E=(t.PLUGIN_PRIORITY=50,t.APPEND_COLUMN_CONFIG_STRATEGY="append",t.REPLACE_COLUMN_CONFIG_STRATEGY="replace",C);(0,y.registerRootComparator)(C,m.rootComparator),n.default.getSingleton().register("beforeColumnSort"),n.default.getSingleton().register("afterColumnSort");var T=new WeakSet;class S extends u.BasePlugin{constructor(){super(...arguments),b(this,T),(0,i.default)(this,"columnStatesManager",null),(0,i.default)(this,"columnMetaCache",null),(0,i.default)(this,"pluginKey",C),(0,i.default)(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return C}static get PLUGIN_PRIORITY(){return 50}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var n=this;this.enabled||(this.columnStatesManager=new h.ColumnStatesManager(this.hot,this.pluginKey+".sortingStates"),this.columnMetaCache=new d.PhysicalIndexToValueMap(e=>{let t=this.hot.toVisualColumn(e);return null===t&&(t=e),this.getMergedPluginSettings(t)}),this.hot.columnIndexMapper.registerMap(this.pluginKey+".columnMeta",this.columnMetaCache),this.addHook("afterGetColHeader",(e,t)=>w(T,this,x).call(this,e,t)),this.addHook("beforeOnCellMouseDown",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return w(T,n,A).call(n,...t)}),this.addHook("afterOnCellMouseDown",(e,t)=>this.onAfterOnCellMouseDown(e,t)),this.addHook("afterInit",()=>w(T,this,_).call(this)),this.addHook("afterLoadData",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return w(T,n,R).call(n,...t)}),this.hot.view&&w(T,this,_).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(e,t)=>{var r=(0,f.getHeaderSpanElement)(t);!1!==(0,f.isFirstLevelColumnHeader)(e,t)&&null!==r&&this.updateHeaderClasses(r)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{null!==this.indexesSequenceCache&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(this.pluginKey+".columnMeta"),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e=this.hot.getSelectedRangeLast()["highlight"];return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,t=null==(t=this.hot.getSelectedRangeLast())?void 0:t.highlight;return t&&(null==(e=this.hot.getSelectedRangeLast())?void 0:e.isSingle())&&this.hot.selection.isCellVisible(t)&&-1===t.row&&0<=t.col},relativeToGroup:p.EDITOR_EDIT_GROUP,position:"before",group:E})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(E)}sort(e){var t=this.getSortConfig(),e=this.getNormalizedSortConfigs(e),r=this.areValidSortConfigs(e);!1!==this.hot.runHooks("beforeColumnSort",t,e,r)&&(0===t.length&&null===this.indexesSequenceCache&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new d.IndexesSequence),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),r&&(this.columnStatesManager.setSortStates(e),this.sortByPresetSortStates(e),this.saveAllSortSettings(e)),this.hot.runHooks("afterColumnSort",t,r?e:t,r),r)&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render())}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return(0,s.isDefined)(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){e=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(e)&&this.columnStatesManager.setSortStates(e)}getNormalizedSortConfigs(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const t=this.hot.countCols();return(0,f.areValidSortStates)(e)&&e.every(e=>{e=e.column;return e<=t&&0<=e})}saveAllSortSettings(e){var t=this.columnStatesManager.getAllColumnsProperties();t.initialConfig=(0,c.arrayMap)(e,e=>{let{column:t,...r}=e;return{column:this.hot.toPhysicalColumn(t),...r}}),this.hot.runHooks("persistentStateSave","columnSorting",t)}getAllSavedSortSettings(){var e={},e=(this.hot.runHooks("persistentStateLoad","columnSorting",e),e.value),t=e=>{let{column:t,...r}=e;return{column:this.hot.toVisualColumn(t),...r}};return(0,s.isDefined)(e)&&Array.isArray(e.initialConfig)&&(e.initialConfig=(0,c.arrayMap)(e.initialConfig,t)),e}getColumnNextConfig(e){var t=this.columnStatesManager.getSortOrderOfColumn(e);return(0,s.isDefined)(t)?(t=(0,f.getNextSortOrder)(t),(0,s.isDefined)(t)?{column:e,sortOrder:t}:void 0):(t=this.hot.countCols(),Number.isInteger(e)&&0<=e&&e<t?{column:e,sortOrder:(0,f.getNextSortOrder)()}:void 0)}getNextSortConfig(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"append",r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),n=-1!==r,i=this.getSortConfig(),e=this.getColumnNextConfig(e);if(n){if((0,s.isUndefined)(e))return[...i.slice(0,r),...i.slice(r+1)];if("append"===t)return[...i.slice(0,r),...i.slice(r+1),e];if("replace"===t)return[...i.slice(0,r),e,...i.slice(r+1)]}return(0,s.isDefined)(e)?i.concat(e):i}getPluginColumnConfig(e){if((0,a.isObject)(e)){e=e[this.pluginKey];if((0,a.isObject)(e))return e}return{}}getMergedPluginSettings(e){var t=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),n=this.hot.getCellMeta(0,e),n=Object.getPrototypeOf(n);return Array.isArray(n.columns)?Object.assign(r,t,this.getPluginColumnConfig(n.columns[e])):(0,l.isFunction)(n.columns)?Object.assign(r,t,this.getPluginColumnConfig(n.columns(e))):Object.assign(r,t)}getFirstCellSettings(e){var t=this.hot.getCellMeta(0,e),t=Object.create(t);return t[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),t}getNumberOfRowsToSort(e){var t=this.hot.getSettings();return t.maxRows<=e?t.maxRows:e-t.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),0!==e.length){var t=[],r=this.hot.countRows(),n=t=>(0,c.arrayMap)(e,e=>this.hot.getDataAtCell(t,e.column));for(let e=0;e<this.getNumberOfRowsToSort(r);e+=1)t.push([this.hot.toPhysicalRow(e)].concat(n(e)));var i=(0,c.arrayMap)(t,e=>e[0]);(0,y.sort)(t,this.pluginKey,(0,c.arrayMap)(e,e=>e.sortOrder),(0,c.arrayMap)(e,e=>this.getFirstCellSettings(e.column)));for(let e=t.length;e<r;e+=1)t.push([e].concat(n(e)));const o=(0,c.arrayMap)(t,e=>e[0]),s=new Map((0,c.arrayMap)(i,(e,t)=>[e,o[t]]));i=(0,c.arrayMap)(this.hot.rowIndexMapper.getIndexesSequence(),e=>s.has(e)?s.get(e):e);this.hot.rowIndexMapper.setIndexesSequence(i)}}sortBySettings(e){(0,a.isObject)(e)?(this.columnStatesManager.updateAllColumnsProperties(e),e=e.initialConfig,(Array.isArray(e)||(0,a.isObject)(e))&&this.sort(e)):this.hot.render()}updateHeaderClasses(e){if((0,o.removeClass)(e,(0,g.getClassesToRemove)(e)),!1!==this.enabled){for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];(0,o.addClass)(e,(0,g.getClassesToAdd)(...r))}}onUpdateSettings(e){super.onUpdateSettings(),null!==this.columnMetaCache&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),(0,s.isDefined)(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,t){return this.getFirstCellSettings(t)[this.pluginKey].headerAction&&(0,o.hasClass)(e.target,f.HEADER_SPAN_CLASS)}onAfterOnCellMouseDown(e,t){!1!==(0,f.wasHeaderClickedProperly)(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(t.col)),this.sort(this.getColumnNextConfig(t.col)))}destroy(){var e;null!=(e=this.columnStatesManager)&&e.destroy(),super.destroy()}}function _(){var e=this.getAllSavedSortSettings();(0,a.isObject)(e)?this.sortBySettings(e):(e=this.hot.getSettings()[this.pluginKey],this.sortBySettings(e))}function x(e,t){var r,n,i=(0,f.getHeaderSpanElement)(t);!1!==(0,f.isFirstLevelColumnHeader)(e,t)&&null!==i&&(r=(n=this.getFirstCellSettings(e)[this.pluginKey]).indicator,n=n.headerAction,this.updateHeaderClasses(i,this.columnStatesManager,e,r,n),this.hot.getSettings().ariaTags)&&(i=this.columnStatesManager.getSortOrderOfColumn(e),(0,o.setAttribute)(t,...(0,v.A11Y_SORT)(i?i+"ending":"none")))}function R(e){!0===e&&this.hot.view&&w(T,this,_).call(this)}function A(e,t,r,n){!1!==(0,f.wasHeaderClickedProperly)(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(n.column=!0)}t.ColumnSorting=S},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(487))),o=r(482),s=r(597),a=r(337);const l=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"];t.ColumnStatesManager=class{constructor(e,t){(0,i.default)(this,"hot",void 0),(0,i.default)(this,"sortingStates",new s.LinkedPhysicalIndexToValueMap),(0,i.default)(this,"sortEmptyCells",!1),(0,i.default)(this,"indicator",!0),(0,i.default)(this,"headerAction",!0),(0,i.default)(this,"compareFunctionFactory",void 0),(0,i.default)(this,"mapName",void 0),this.hot=e,this.mapName=t,this.hot.columnIndexMapper.registerMap(t,this.sortingStates)}updateAllColumnsProperties(e){(0,o.isObject)(e)&&(0,o.objectEach)(e,(e,t)=>{l.includes(t)&&(this[t]=e)})}getAllColumnsProperties(){var e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return"function"==typeof this.compareFunctionFactory&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){return null==(e=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))?void 0:e.sortOrder}getIndexOfColumnInSortQueue(t){return t=this.hot.toPhysicalColumn(t),this.sortingStates.getEntries().findIndex(e=>{var[e]=e;return e===t})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return 0===this.getNumberOfSortedColumns()}isColumnSorted(e){return(0,o.isObject)(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return null===this.sortingStates?[]:this.sortingStates.getEntries().map(e=>{var[e,t]=e;return{column:this.hot.toVisualColumn(e),...t}})}getColumnSortState(e){var t=this.getSortOrderOfColumn(e);if((0,a.isDefined)(t))return{column:e,sortOrder:t}}setSortStates(t){this.sortingStates.clear();for(let e=0;e<t.length;e+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(t[e].column),{sortOrder:t[e].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}},(e,t,r)=>{"use strict";var n=r(197),s=(t.__esModule=!0,t.areValidSortStates=function(e){if(e.some(e=>!1===function(e){if(!1===(0,i.isObject)(e))return!1;var{column:e,sortOrder:t}=e;return Number.isInteger(e)&&[c,u].includes(t)}(e)))return!1;e=e.map(e=>{e=e.column;return e});return new Set(e).size===e.length},t.createDateTimeCompareFunction=function(n,i,o){return function(e,t){var r=o["sortEmptyCells"];return e===t?l.DO_NOT_SWAP:(0,a.isEmpty)(e)?(0,a.isEmpty)(t)?l.DO_NOT_SWAP:r&&"asc"===n?l.FIRST_BEFORE_SECOND:l.FIRST_AFTER_SECOND:(0,a.isEmpty)(t)?r&&"asc"===n?l.FIRST_AFTER_SECOND:l.FIRST_BEFORE_SECOND:(r=(0,s.default)(e,i),e=(0,s.default)(t,i),r.isValid()?e.isValid()?e.isAfter(r)?"asc"===n?l.FIRST_BEFORE_SECOND:l.FIRST_AFTER_SECOND:e.isBefore(r)?"asc"===n?l.FIRST_AFTER_SECOND:l.FIRST_BEFORE_SECOND:l.DO_NOT_SWAP:l.FIRST_BEFORE_SECOND:l.FIRST_AFTER_SECOND)}},t.getHeaderSpanElement=function(e){e=e.querySelector("."+d);return e},t.getNextSortOrder=function(e){if(e!==u)return e===c?u:c},t.isFirstLevelColumnHeader=function(e,t){if(e<0||!t.parentNode)return!1;e=t.parentNode.parentNode.childNodes,t=Array.from(e).indexOf(t.parentNode)-e.length;return-1==t},t.wasHeaderClickedProperly=function(e,t,r){return-1===e&&0<=t&&!1===(0,o.isRightClick)(r)},r(290),r(302),r(305),r(309),r(312),r(315),r(318),n(r(338))),i=r(482),o=r(492),a=r(337),l=r(833);const c=t.ASC_SORT_STATE="asc",u=t.DESC_SORT_STATE="desc",d=t.HEADER_SPAN_CLASS="colHeader"},(e,t,r)=>{"use strict";t.__esModule=!0;var n=r(834),n=(t.registerRootComparator=n.registerRootComparator,t.getRootComparator=n.getRootComparator,t.getCompareFunctionFactory=n.getCompareFunctionFactory,r(840));t.FIRST_AFTER_SECOND=n.FIRST_AFTER_SECOND,t.FIRST_BEFORE_SECOND=n.FIRST_BEFORE_SECOND,t.DO_NOT_SWAP=n.DO_NOT_SWAP,t.sort=n.sort},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,t.getCompareFunctionFactory=function(e){if(d(e))return u(e);return u(i.COLUMN_DATA_TYPE)},r(835)),o=r(836),s=r(837),a=r(838),l=r(839),n=n(r(501));const{register:c,getItem:u,hasItem:d}=(0,n.default)("sorting.compareFunctionFactory");var{register:r,getItem:n}=(0,n.default)("sorting.mainSortComparator");t.getRootComparator=n,t.registerRootComparator=r,c(s.COLUMN_DATA_TYPE,s.compareFunctionFactory),c(a.COLUMN_DATA_TYPE,a.compareFunctionFactory),c(i.COLUMN_DATA_TYPE,i.compareFunctionFactory),c(o.COLUMN_DATA_TYPE,o.compareFunctionFactory),c(l.COLUMN_DATA_TYPE,l.compareFunctionFactory)},(e,t,r)=>{"use strict";t.__esModule=!0,t.compareFunctionFactory=function(n,e,i){const o=e.locale;return function(e,t){var r=i["sortEmptyCells"];return(e="string"==typeof e?e.toLocaleLowerCase(o):e)===(t="string"==typeof t?t.toLocaleLowerCase(o):t)?a.DO_NOT_SWAP:(0,s.isEmpty)(e)?(0,s.isEmpty)(t)?a.DO_NOT_SWAP:r&&"asc"===n?a.FIRST_BEFORE_SECOND:a.FIRST_AFTER_SECOND:(0,s.isEmpty)(t)?r&&"asc"===n?a.FIRST_AFTER_SECOND:a.FIRST_BEFORE_SECOND:isNaN(e)&&!isNaN(t)?"asc"===n?a.FIRST_AFTER_SECOND:a.FIRST_BEFORE_SECOND:!isNaN(e)&&isNaN(t)||(isNaN(e)||isNaN(t)||(e=parseFloat(e),t=parseFloat(t)),e<t)?"asc"===n?a.FIRST_BEFORE_SECOND:a.FIRST_AFTER_SECOND:t<e?"asc"===n?a.FIRST_AFTER_SECOND:a.FIRST_BEFORE_SECOND:a.DO_NOT_SWAP}};var s=r(337),a=r(833);t.COLUMN_DATA_TYPE="default"},(e,t,r)=>{"use strict";t.__esModule=!0,t.compareFunctionFactory=function(o,e,s){return function(e,t){var r=parseFloat(e),n=parseFloat(t),i=s["sortEmptyCells"];if(r===n||isNaN(r)&&isNaN(n))return l.DO_NOT_SWAP;if(i){if((0,a.isEmpty)(e))return"asc"===o?l.FIRST_BEFORE_SECOND:l.FIRST_AFTER_SECOND;if((0,a.isEmpty)(t))return"asc"===o?l.FIRST_AFTER_SECOND:l.FIRST_BEFORE_SECOND}return isNaN(r)?l.FIRST_AFTER_SECOND:isNaN(n)?l.FIRST_BEFORE_SECOND:r<n?"asc"===o?l.FIRST_BEFORE_SECOND:l.FIRST_AFTER_SECOND:n<r?"asc"===o?l.FIRST_AFTER_SECOND:l.FIRST_BEFORE_SECOND:l.DO_NOT_SWAP}};var a=r(337),l=r(833);t.COLUMN_DATA_TYPE="numeric"},(e,t,r)=>{"use strict";t.__esModule=!0,t.compareFunctionFactory=function(l,c,u){const d=c.checkedTemplate,h=c.uncheckedTemplate,p=u["sortEmptyCells"];return function(e,t){var r=(0,m.isEmpty)(e),n=(0,m.isEmpty)(t),i=r?h:e,o=n?h:t,s=i===h||i===d,a=o===h||o===d;if(!1===p){if(r&&!1===n)return f.FIRST_AFTER_SECOND;if(!1===r&&n)return f.FIRST_BEFORE_SECOND}return!1==s&&a?"asc"===l?f.FIRST_BEFORE_SECOND:f.FIRST_AFTER_SECOND:s&&!1==a?"asc"===l?f.FIRST_AFTER_SECOND:f.FIRST_BEFORE_SECOND:!1==s&&!1==a?(0,g.compareFunctionFactory)(l,c,u)(e,t):i===h&&o===d?"asc"===l?f.FIRST_BEFORE_SECOND:f.FIRST_AFTER_SECOND:i===d&&o===h?"asc"===l?f.FIRST_AFTER_SECOND:f.FIRST_BEFORE_SECOND:f.DO_NOT_SWAP}};var f=r(833),g=r(835),m=r(337);t.COLUMN_DATA_TYPE="checkbox"},(e,t,r)=>{"use strict";t.__esModule=!0,t.compareFunctionFactory=function(e,t,r){return(0,n.createDateTimeCompareFunction)(e,t.dateFormat,r)};var n=r(832);t.COLUMN_DATA_TYPE="date"},(e,t,r)=>{"use strict";t.__esModule=!0,t.compareFunctionFactory=function(e,t,r){return(0,n.createDateTimeCompareFunction)(e,t.timeFormat,r)};var n=r(832);t.COLUMN_DATA_TYPE="time"},(e,t,r)=>{"use strict";t.__esModule=!0,t.sort=function(e,t){t=(0,o.getRootComparator)(t);for(var r=arguments.length,n=new Array(2<r?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];e.sort(t(...n))};var o=r(834);t.DO_NOT_SWAP=0,t.FIRST_BEFORE_SECOND=-1,t.FIRST_AFTER_SECOND=1},(e,t,r)=>{"use strict";t.__esModule=!0,t.getClassesToAdd=function(e,t,r,n){var i=[a];n&&i.push(l);return!1===r?i.push(s):(n=e.getSortOrderOfColumn(t),(0,o.isDefined)(n)&&i.push(c.get(n))),i},t.getClassesToRemove=function(){return Array.from(c.values()).concat(l,s,a)},r(286);var o=r(337),t=r(832);const s="indicatorDisabled",a="columnSorting",l="sortAction",c=new Map([[t.ASC_SORT_STATE,"ascending"],[t.DESC_SORT_STATE,"descending"]])},(e,t,r)=>{"use strict";t.__esModule=!0,t.rootComparator=function(a,l){return function(e,t){const[,...r]=e,[,...n]=t;return t=a[e=0],i=l[e],o=r[e],e=n[e],((s=i.columnSorting).compareFunctionFactory||(0,c.getCompareFunctionFactory)(i.type))(t,i,s)(o,e);var i,o,s}};var c=r(833)},(e,t,r)=>{"use strict";r.r(t)},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(845);t.PLUGIN_KEY=r.PLUGIN_KEY,t.PLUGIN_PRIORITY=r.PLUGIN_PRIORITY,t.ColumnSummary=r.ColumnSummary},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),n(r(487))),o=r(813),s=r(482),a=n(r(846)),l=r(477),c=r(847);function u(e,t){var r=e;if(t.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object");t.add(e)}function d(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}const h=t.PLUGIN_KEY="columnSummary";t.PLUGIN_PRIORITY=220;var p=new WeakSet;class f extends o.BasePlugin{constructor(){super(...arguments),u(this,p),(0,i.default)(this,"endpoints",null)}static get PLUGIN_KEY(){return h}static get PLUGIN_PRIORITY(){return 220}isEnabled(){return!!this.hot.getSettings()[h]}enablePlugin(){var n=this;this.enabled||(this.settings=this.hot.getSettings()[h],this.endpoints=new a.default(this,this.settings),this.addHook("afterInit",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return d(p,n,g).call(n,...t)}),this.addHook("afterChange",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return d(p,n,y).call(n,...t)}),this.addHook("afterUpdateSettings",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return d(p,n,m).call(n,...t)}),this.addHook("beforeCreateRow",(e,t,r)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",e,t,null,r)),this.addHook("beforeCreateCol",(e,t,r)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",e,t,null,r)),this.addHook("beforeRemoveRow",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.endpoints.resetSetupBeforeStructureAlteration("remove_row",...t)}),this.addHook("beforeRemoveCol",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.endpoints.resetSetupBeforeStructureAlteration("remove_col",...t)}),this.addHook("afterCreateRow",(e,t,r)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",e,t,null,r)),this.addHook("afterCreateCol",(e,t,r)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",e,t,null,r)),this.addHook("afterRemoveRow",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.endpoints.resetSetupAfterStructureAlteration("remove_row",...t)}),this.addHook("afterRemoveCol",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.endpoints.resetSetupAfterStructureAlteration("remove_col",...t)}),this.addHook("afterRowMove",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return d(p,n,v).call(n,...t)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e)}}calculateSum(t){let r=0;return(0,s.objectEach)(t.ranges,e=>{r+=this.getPartialSum(e,t.sourceColumn)}),r}getPartialSum(e,t){let r=0,n=e[1]||e[0];let i=0;do{var o,s=this.getCellValue(n,t);null!==(s=(0,c.isNullishOrNaN)(s)?null:s)&&(o=((""+s).split(".")[1]||[]).length||1)>i&&(i=o),r+=s||0,--n}while(n>=e[0]);return Math.round(r*10**i)/10**i}calculateMinMax(r,n){let i=null;return(0,s.objectEach)(r.ranges,e=>{var t=this.getPartialMinMax(e,r.sourceColumn,n);if(null===i&&null!==t&&(i=t),null!==t)switch(n){case"min":i=Math.min(i,t);break;case"max":i=Math.max(i,t)}}),null===i?"Not enough data":i}getPartialMinMax(e,t,r){let n=null,i=e[1]||e[0];var o;do{if(o=this.getCellValue(i,t),o=(0,c.isNullishOrNaN)(o)?null:o,null===n)n=o;else if(null!==o)switch(r){case"min":n=Math.min(n,o);break;case"max":n=Math.max(n,o)}}while(--i>=e[0]);return n}countEmpty(e,t){var r;let n=0,i=e[1]||e[0];for(;r=this.getCellValue(i,t),null===((0,c.isNullishOrNaN)(r)?null:r)&&(n+=1),--i>=e[0];);return n}countEntries(r){let n=0;var e=r.ranges;return(0,s.objectEach)(e,e=>{var t=void 0===e[1]?1:e[1]-e[0]+1,e=this.countEmpty(e,r.sourceColumn);n=n+t-e}),n}calculateAverage(e){return this.calculateSum(e)/this.countEntries(e)}getCellValue(e,t){var r=this.hot.toVisualRow(e),n=this.hot.toVisualColumn(t);let i=this.hot.getSourceDataAtCell(e,t),o="";if(-1<(o=null!==r&&null!==n?this.hot.getCellMeta(r,n).className||"":o).indexOf("columnSummaryResult"))return null;if(this.endpoints.currentEndpoint.forceNumeric&&("string"==typeof i&&(i=i.replace(/,/,".")),i=parseFloat(i)),isNaN(i)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error((0,l.toSingleLine)`ColumnSummary plugin: cell at (${e}, ${t}) is not in a\x20
          numeric format. Cannot do the calculation.`);return i}}function g(){this.endpoints.initEndpoints()}function m(e){void 0!==e.columns&&this.endpoints.refreshCellMetas()}function y(e,t){e&&"ColumnSummary.reset"!==t&&"ColumnSummary.set"!==t&&"loadData"!==t&&this.endpoints.refreshChangedEndpoints(e)}function v(e,t){this.endpoints.resetSetupBeforeStructureAlteration("move_row",e[0],e.length,e,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",t,e.length,e,this.pluginName)}t.ColumnSummary=f},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),r(286),n(r(487))),d=r(478),o=r(500);t.default=class{constructor(e,t){(0,i.default)(this,"plugin",void 0),(0,i.default)(this,"hot",void 0),(0,i.default)(this,"endpoints",[]),(0,i.default)(this,"settings",void 0),(0,i.default)(this,"settingsType","array"),(0,i.default)(this,"currentEndpoint",null),(0,i.default)(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=t}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return("function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints)[e]}getAllEndpoints(){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const r=[];let t=e;if(t||"function"!=typeof this.settings)return t=t||this.settings,(0,d.arrayEach)(t,e=>{var t={};this.assignSetting(e,t,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(e,t,"reversedRowCoords",!1),this.assignSetting(e,t,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(e,t,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(e,t,"sourceColumn",e.destinationColumn),this.assignSetting(e,t,"type","sum"),this.assignSetting(e,t,"forceNumeric",!1),this.assignSetting(e,t,"suppressDataTypeErrors",!0),this.assignSetting(e,t,"customFunction",null),this.assignSetting(e,t,"readOnly",!0),this.assignSetting(e,t,"roundFloat",!1),r.push(t)}),r;this.settingsType="function"}assignSetting(e,t,r,n){if("ranges"===r&&void 0===e[r])t[r]=n;else if("ranges"!==r||0!==e[r].length)if(void 0===e[r]){if(n instanceof Error)throw n;t[r]=n}else"destinationRow"===r&&t.reversedRowCoords?t[r]=this.hot.countRows()-e[r]-1:t[r]=e[r]}resetSetupBeforeStructureAlteration(t,r,n){if("function"===this.settingsType){const i=-1<t.indexOf("row")?"row":"col";var e=this.getAllEndpoints();(0,d.arrayEach)(e,e=>{"row"==i&&e.destinationRow>=r&&("insert_row"===t?e.alterRowOffset=n:"remove_row"===t&&(e.alterRowOffset=-1*n)),"col"==i&&e.destinationColumn>=r&&("insert_col"===t?e.alterColumnOffset=n:"remove_col"===t&&(e.alterColumnOffset=-1*n))}),this.resetAllEndpoints(e,!1)}}resetSetupAfterStructureAlteration(e,t,r,n,i){var o=!(5<arguments.length&&void 0!==arguments[5])||arguments[5];if("function"===this.settingsType){const a=()=>(this.hot.removeHook("beforeViewRender",a),this.refreshAllEndpoints());void this.hot.addHookOnce("beforeViewRender",a)}else{const l=-1<e.indexOf("row")?"row":"col",c=-1<e.indexOf("remove")?-1:1;var s=this.getAllEndpoints(),e=0===e.indexOf("move_row");const u=t;(0,d.arrayEach)(s,e=>{"row"==l&&e.destinationRow>=u&&(e.alterRowOffset=c*r),"col"==l&&e.destinationColumn>=u&&(e.alterColumnOffset=c*r)}),this.resetAllEndpoints(s,!e),e?(0,d.arrayEach)(s,e=>{this.extendEndpointRanges(e,u,n[0],n.length),this.recreatePhysicalRanges(e),this.clearOffsetInformation(e)}):(0,d.arrayEach)(s,e=>{this.shiftEndpointCoordinates(e,u)}),o&&this.refreshAllEndpoints()}}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,t,r,n){(0,d.arrayEach)(e.ranges,e=>{e[1]&&(t>=e[0]&&t<=e[1]?r>e[1]?e[1]+=n:r<e[0]&&(e[0]-=n):r>=e[0]&&r<=e[1]&&(e[1]-=n,t<=e[0])&&(e[0]+=1,e[1]+=1))})}recreatePhysicalRanges(e){var t=e.ranges;const i=[],n=[];(0,d.arrayEach)(t,t=>{var r=[];if(t[1])for(let e=t[0];e<=t[1];e++)r.push(this.hot.toPhysicalRow(e));else r.push(this.hot.toPhysicalRow(t[0]));n.push(r)}),(0,d.arrayEach)(n,r=>{let n=[];(0,d.arrayEach)(r,(e,t)=>{0===t?n.push(e):r[t]!==r[t-1]+1&&(n.push(r[t-1]),i.push(n),(n=[]).push(e)),t===r.length-1&&(n.push(e),i.push(n))})}),e.ranges=i}shiftEndpointCoordinates(n,i){n.alterRowOffset&&0!==n.alterRowOffset?(n.destinationRow+=n.alterRowOffset||0,(0,d.arrayEach)(n.ranges,r=>{(0,d.arrayEach)(r,(e,t)=>{i<=e&&(r[t]+=n.alterRowOffset||0)})})):n.alterColumnOffset&&0!==n.alterColumnOffset&&(n.destinationColumn+=n.alterColumnOffset||0,n.sourceColumn+=n.alterColumnOffset||0)}resetAllEndpoints(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.getAllEndpoints();let t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];e.some(e=>{var t=e.alterRowOffset||0,r=e.alterColumnOffset||0;return e.destinationRow+t>=this.hot.countRows()||e.destinationColumn+r>=this.hot.countCols()})||(this.cellsToSetCache=[],(0,d.arrayEach)(e,e=>{this.resetEndpointValue(e,t)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],(0,d.arrayEach)(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const i=[];this.cellsToSetCache=[],(0,d.arrayEach)(e,(e,r,n)=>{""+(e[2]||"")!=""+e[3]&&(0,d.arrayEach)(this.getAllEndpoints(),(e,t)=>{this.hot.propToCol(n[r][1])===e.sourceColumn&&-1===i.indexOf(t)&&i.push(t)})}),(0,d.arrayEach)(i,e=>{this.refreshEndpoint(this.getEndpoint(e))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{var t=this.hot.toVisualRow(e.destinationRow);null!==t&&((t=this.hot.getCellMeta(t,e.destinationColumn)).readOnly=e.readOnly,t.className="columnSummaryResult")})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],r=e.alterRowOffset||0,n=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(t?r:0)),this.hot.toVisualColumn(e.destinationColumn+(t?n:0)),""])}setEndpointValue(t,r){var e=2<arguments.length&&void 0!==arguments[2]&&arguments[2],n=this.hot.toVisualRow(t.destinationRow);if(t.destinationRow>=this.hot.countRows()||t.destinationColumn>=this.hot.countCols())this.throwOutOfBoundsWarning();else{var i=this.hot.toVisualRow(t.destinationRow);if(null!==i&&(i=this.hot.getCellMeta(i,t.destinationColumn),"init"!==r&&i.readOnly===t.readOnly||(i.readOnly=t.readOnly,i.className="columnSummaryResult")),(!0===t.roundFloat||Number.isInteger(t.roundFloat))&&!isNaN(t.result)){r=t.roundFloat;let e=0;Number.isInteger(r)&&(e=Math.min(Math.max(0,r),100)),t.result=t.result.toFixed(e)}e?this.hot.setDataAtCell(n,t.destinationColumn,t.result,"ColumnSummary.set"):this.cellsToSetCache.push([n,t.destinationColumn,t.result]),t.alterRowOffset=void 0,t.alterColumnOffset=void 0}}throwOutOfBoundsWarning(){(0,o.warn)("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}},(e,t)=>{"use strict";t.__esModule=!0,t.isNullishOrNaN=function(e){return null==e||isNaN(e)}},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(849);t.PLUGIN_KEY=r.PLUGIN_KEY,t.PLUGIN_PRIORITY=r.PLUGIN_PRIORITY,t.Comments=r.Comments},(L,e,t)=>{"use strict";var r=t(197),n=(e.__esModule=!0,t(204),t(286),r(t(487))),v=t(334),i=t(492),o=t(482),s=t(813),a=r(t(850)),l=r(t(852)),c=t(853),u=r(t(868)),d=r(t(869)),h=r(t(870));function p(e,t,r){f(e,t),t.set(e,r)}function f(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function g(e,t,r){e.set(m(e,t),r)}function b(e,t){return e.get(m(e,t))}function m(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}t(871);const y=e.PLUGIN_KEY="comments",w=(e.PLUGIN_PRIORITY=60,e.META_COMMENT="comment"),C=e.META_COMMENT_VALUE="value",E=(e.META_STYLE="style",e.META_READONLY="readOnly",y),T="plugin:"+y;var S=new WeakMap,_=new WeakMap,x=new WeakMap,R=new WeakMap,A=new WeakMap,N=new WeakMap,O=new WeakSet;class I extends s.BasePlugin{constructor(){var e,t;super(...arguments),f(e=this,t=O),t.add(e),(0,n.default)(this,"range",{}),p(this,S,null),p(this,_,null),p(this,x,!1),p(this,R,!1),p(this,A,null),p(this,N,"")}static get PLUGIN_KEY(){return y}static get PLUGIN_PRIORITY(){return 60}isEnabled(){return!!this.hot.getSettings()[y]}enablePlugin(){var n=this;this.enabled||(b(S,this)||(g(S,this,new a.default(this.hot.rootDocument,this.hot.isRtl())),b(S,this).addLocalHook("resize",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return m(O,n,U).call(n,...t)})),b(_,this)||g(_,this,new l.default(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",e=>this.addToContextMenu(e)),this.addHook("afterRenderer",(e,t,r,n,i,o)=>m(O,this,P).call(this,e,o)),this.addHook("afterScroll",()=>m(O,this,W).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",e=>m(O,this,V).call(this,e)),b(_,this).addLocalHook("hide",()=>this.hide()),b(_,this).addLocalHook("show",(e,t)=>this.showAtCell(e,t)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){b(_,this).updateDelay(this.getDisplayDelaySetting()),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const t=this.hot.getShortcutManager();var e=t.getContext("grid"),r=t.addContext(T);e.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const e=this.hot.getSelectedRangeLast();g(R,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(e),this.show(),this.focusEditor(),t.setActiveContextName(T),this.hot._registerTimeout(()=>{g(R,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var e;return(null==(e=this.hot.getSelectedRangeLast())?void 0:e.highlight.isCell())&&!b(S,this).isVisible()},group:E}),r.addShortcut({keys:[["Escape"]],callback:()=>{b(S,this).setValue(b(N,this)),this.hide(),t.setActiveContextName("grid")},runOnlyIf:()=>b(S,this).isVisible()&&b(S,this).isFocused(),group:E}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),t.setActiveContextName("grid")},runOnlyIf:()=>b(S,this).isVisible()&&b(S,this).isFocused(),group:E})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(E)}registerListeners(){var e=this.hot["rootDocument"],t=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",e=>m(O,this,k).call(this,e)),this.eventManager.addEventListener(e,"mousedown",e=>m(O,this,M).call(this,e)),this.eventManager.addEventListener(e,"mouseup",()=>m(O,this,D).call(this)),this.eventManager.addEventListener(t,"focus",()=>m(O,this,H).call(this)),this.eventManager.addEventListener(t,"blur",()=>m(O,this,F).call(this))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){e=(0,v.closest)(e.target,"TD","TBODY");return!!(e&&(0,v.hasClass)(e,"htCommentCell")&&(0,v.closest)(e,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var t=b(S,this).getValue();let r="";null!=e?r=e:null!=t&&(r=t);e=this.range.from.row,t=this.range.from.col;this.updateCommentMeta(e,t,{[C]:r}),this.hot.render()}setCommentAtCell(e,t,r){this.setRange({from:this.hot._createCellCoords(e,t)}),this.setComment(r)}removeComment(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,w),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,t){var r=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];this.setRange({from:this.hot._createCellCoords(e,t)}),this.removeComment(r)}getComment(){var e=this.range.from.row,t=this.range.from.col;return this.getCommentMeta(e,t,C)}getCommentAtCell(e,t){return this.getCommentMeta(e,t,C)}show(){var e,t;if(this.range.from)return{row:t,col:e}=this.range["from"],!(t<0||t>this.hot.countSourceRows()-1||e<0||e>this.hot.countSourceCols()-1||(t=this.hot.getCellMeta(this.range.from.row,this.range.from.col),b(_,this).cancelHiding(),b(S,this).setValue(null!=(e=t[w]?t[w][C]:null)?e:""),b(S,this).show(),this.refreshEditor(!0),0));throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())')}showAtCell(e,t){return this.setRange({from:this.hot._createCellCoords(e,t)}),this.show()}hide(){b(S,this).hide()}refreshEditor(){if(0<arguments.length&&void 0!==arguments[0]&&arguments[0]||this.range.from&&b(S,this).isVisible()){var{rowIndexMapper:i,columnIndexMapper:o}=this.hot,{row:s,col:a}=this.range.from;let e=i.getRenderableFromVisualIndex(s),t=o.getRenderableFromVisualIndex(a);var l=null===e,i=(b(S,this).setPosition(0,0),null===e&&(e=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s,-1))),null===t&&(t=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(a,-1))),null===e),o=null===t,{rootWindow:c,view:{_wt:u}}=(e=null!=(c=e)?c:0,t=null!=(c=t)?c:0,this.hot),d=u["wtTable"],u=u.getCell({row:e,col:t},!0),h=this.getCommentMeta(s,a,"style"),h=(h?b(S,this).setSize(h.width,h.height):b(S,this).resetSize(),o?0:d.getStretchedColumnWidth(t)),o=l&&!i?(0,v.outerHeight)(u):0,{left:d,top:l,width:i,height:u}=u.getBoundingClientRect(),{width:p,height:f}=b(S,this).getSize(),{innerWidth:g,innerHeight:m}=this.hot.rootWindow,y=this.hot.rootDocument.documentElement;let r=d+c.scrollX+h,n=l+c.scrollY+o;this.hot.isRtl()&&(r-=p+h),this.hot.isLtr()&&g<d+i+p?r=d+c.scrollX-p-1:this.hot.isRtl()&&r<-(y.scrollWidth-y.clientWidth)&&(r=d+c.scrollX+h+1),m<l+f&&(n-=f-u+1),b(S,this).setPosition(r,n),b(S,this).setReadOnlyState(this.getCommentMeta(s,a,"readOnly")),b(S,this).observeSize()}}focusEditor(){b(S,this).focus()}updateCommentMeta(e,t,r){var n=this.hot.getCellMeta(e,t)[w];let i;n?(i=(0,o.deepClone)(n),(0,o.deepExtend)(i,r)):i=r,this.hot.setCellMeta(e,t,w,i)}getCommentMeta(e,t,r){e=this.hot.getCellMeta(e,t);if(e[w])return e[w][r]}addToContextMenu(e){e.items.push({name:c.SEPARATOR},(0,u.default)(this),(0,d.default)(this),(0,h.default)(this))}getDisplayDelaySetting(){var e=this.hot.getSettings()[y];if((0,o.isObject)(e))return e.displayDelay}getEditorInputElement(){return b(S,this).getInputElement()}destroy(){var e;null!=(e=b(S,this))&&e.destroy(),null!=(e=b(_,this))&&e.destroy(),super.destroy()}}function M(t){if(this.hot.view&&this.hot.view._wt&&!b(x,this)&&!this.targetIsCommentTextArea(t)){t=(0,v.closest)(t.target,"TD","TBODY");let e=null;t&&(e=this.hot.getCoords(t)),t&&(!this.range.from||!e||this.range.from.row===e.row&&this.range.from.col===e.col)||this.hide()}}function k(e){var t,r=this.hot["rootDocument"];b(x,this)||b(S,this).isFocused()||(0,v.hasClass)(e.target,"wtBorder")||b(A,this)===e.target||!b(S,this)||(g(A,this,r.elementFromPoint(e.clientX,e.clientY)),this.targetIsCellWithComment(e)?(t=this.hot._createCellRange(this.hot.getCoords(e.target)),b(_,this).show(t)):(0,v.isChildOf)(e.target,r)&&!this.targetIsCommentTextArea(e)&&b(_,this).hide())}function D(){g(x,this,!1)}function P(e,t){t[w]&&t[w][C]&&(0,v.addClass)(e,t.commentedCellClassName)}function F(){g(N,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function H(){g(N,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(T)}function U(e,t){this.updateCommentMeta(this.range.from.row,this.range.from.col,{style:{width:e,height:t}})}function V(e){b(S,this).isVisible()&&(0,i.stopImmediatePropagation)(e)}function W(){b(R,this)||this.hide()}e.Comments=I},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),r(334)),o=r(482),n=n(r(578)),s=r(851);function a(e,t,r){var n=e;if(t.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object");t.set(e,r)}function l(e,t){return e.get(u(e,t))}function c(e,t,r){e.set(u(e,t),r)}function u(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var d=new WeakMap,h=new WeakMap,p=new WeakMap,f=new WeakMap,g=new WeakMap,m=new WeakMap,y=new WeakMap;class v{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,t){var n=this;a(this,d,void 0),a(this,h,!1),a(this,p,null),a(this,f,void 0),a(this,g,void 0),a(this,m,!0),a(this,y,new s.EditorResizeObserver),c(d,this,e),c(h,this,t),c(f,this,this.createEditor()),c(g,this,l(f,this).style),l(y,this).setObservedElement(this.getInputElement()),l(y,this).addLocalHook("resize",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("resize",...t)}),this.hide()}setPosition(e,t){l(g,this).left=e+"px",l(g,this).top=t+"px"}setSize(e,t){var r;e&&t&&((r=this.getInputElement()).style.width=e+"px",r.style.height=t+"px")}getSize(){return{width:(0,i.outerWidth)(this.getInputElement()),height:(0,i.outerHeight)(this.getInputElement())}}observeSize(){l(y,this).observe()}resetSize(){var e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){this.getInputElement().readOnly=e}show(){l(g,this).display="block",c(m,this,!1)}hide(){l(y,this).unobserve(),l(m,this)||(l(g,this).display="none"),c(m,this,!0)}isVisible(){return"block"===l(g,this).display}setValue(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"")||"";this.getInputElement().value=e}getValue(){return this.getInputElement().value}isFocused(){return l(d,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){var e=l(d,this).createElement("div"),t=l(d,this).createElement("textarea");return e.style.display="none",c(p,this,l(d,this).createElement("div")),l(p,this).setAttribute("dir",l(h,this)?"rtl":"ltr"),(0,i.addClass)(l(p,this),v.CLASS_EDITOR_CONTAINER),l(d,this).body.appendChild(l(p,this)),(0,i.addClass)(e,v.CLASS_EDITOR),(0,i.addClass)(t,v.CLASS_INPUT),t.setAttribute("data-hot-input",!0),e.appendChild(t),l(p,this).appendChild(e),e}getInputElement(){return l(f,this).querySelector("."+v.CLASS_INPUT)}destroy(){var e=l(p,this)?l(p,this).parentNode:null;l(f,this).parentNode.removeChild(l(f,this)),c(f,this,null),c(g,this,null),l(y,this).destroy(),e&&e.removeChild(l(p,this))}}(0,o.mixin)(v,n.default);t.default=v},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),r(482)),n=n(r(578));function o(e,t,r){s(e,t),t.set(e,r)}function s(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function a(e,t){return e.get(c(e,t))}function l(e,t,r){e.set(c(e,t),r)}function c(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var u=new WeakMap,d=new WeakMap,h=new WeakMap,p=new WeakSet;class f{constructor(){var e,t;s(e=this,t=p),t.add(e),o(this,u,!0),o(this,d,null),o(this,h,new ResizeObserver(e=>c(p,this,g).call(this,e)))}setObservedElement(e){l(d,this,e)}unobserve(){a(h,this).unobserve(a(d,this))}observe(){l(u,this,!0),a(h,this).observe(a(d,this))}destroy(){a(h,this).disconnect()}}function g(e){!a(u,this)&&Array.isArray(e)&&e.length?e.forEach(e=>{var e=e["borderBoxSize"],{inlineSize:e,blockSize:t}=e[0];this.runLocalHooks("resize",e,t)}):l(u,this,!1)}t.EditorResizeObserver=f,(0,i.mixin)(f,n.default)},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(487))),o=r(480),s=r(482),n=n(r(578));class a{constructor(e){(0,i.default)(this,"wasLastActionShow",!0),(0,i.default)(this,"showDebounced",null),(0,i.default)(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{!1===this.wasLastActionShow&&this.runLocalHooks("hide")},250)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){this.showDebounced=(0,o.debounce)(e=>{this.wasLastActionShow&&this.runLocalHooks("show",e.from.row,e.from.col)},0<arguments.length&&void 0!==arguments[0]?arguments[0]:250)}destroy(){this.clearLocalHooks()}}(0,s.mixin)(a,n.default);t.default=a},(e,t,r)=>{"use strict";t.__esModule=!0,t.addItem=function(e,t){-1===v.indexOf(e)&&(b[e]=t)},t.predefinedItems=function(){const r={};return(0,n.objectEach)(b,(e,t)=>{r[t]=e()}),r};var n=r(482),i=y(r(854)),o=(t.ALIGNMENT=i.KEY,y(r(857))),s=(t.CLEAR_COLUMN=o.KEY,y(r(858))),a=(t.COLUMN_LEFT=s.KEY,y(r(859))),l=(t.COLUMN_RIGHT=a.KEY,y(r(860))),c=(t.READ_ONLY=l.KEY,y(r(861))),u=(t.REDO=c.KEY,y(r(862))),d=(t.REMOVE_COLUMN=u.KEY,y(r(863))),h=(t.REMOVE_ROW=d.KEY,y(r(864))),p=(t.ROW_ABOVE=h.KEY,y(r(865))),f=(t.ROW_BELOW=p.KEY,y(r(856))),g=(t.SEPARATOR=f.KEY,y(r(866))),r=(t.NO_ITEMS=g.KEY,y(r(867)));function m(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(m=function(e){return e?r:t})(e))}function y(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=m(t);if(t&&t.has(e))return t.get(e);var r,n,i={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e)"default"!==r&&{}.hasOwnProperty.call(e,r)&&((n=o?Object.getOwnPropertyDescriptor(e,r):null)&&(n.get||n.set)?Object.defineProperty(i,r,n):i[r]=e[r]);return i.default=e,t&&t.set(e,i),i}t.UNDO=r.KEY;const v=t.ITEMS=[h.KEY,p.KEY,s.KEY,a.KEY,o.KEY,d.KEY,u.KEY,r.KEY,c.KEY,l.KEY,i.KEY,f.KEY,g.KEY],b={[f.KEY]:f.default,[g.KEY]:g.default,[h.KEY]:h.default,[p.KEY]:p.default,[s.KEY]:s.default,[a.KEY]:a.default,[o.KEY]:o.default,[d.KEY]:d.default,[u.KEY]:u.default,[r.KEY]:r.default,[c.KEY]:c.default,[l.KEY]:l.default,[i.KEY]:i.default}},(e,t,r)=>{"use strict";t.__esModule=!0,t.default=function(){return{key:a,name(){return this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_ALIGNMENT)},disabled(){var e;return 0===this.countRows()||0===this.countCols()||!(e=this.getSelectedRangeLast())||!!e.isSingleHeader()||!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:a+":left",name(){let e=this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT);var t=(0,n.checkSelectionConsistency)(this.getSelectedRange(),(e,t)=>{e=this.getCellMeta(e,t).className;if(e&&-1!==e.indexOf("htLeft"))return!0});return e=t?(0,n.markLabelAsSelected)(e):e},callback(){var e=this.getSelectedRange(),t=(0,n.getAlignmentClasses)(e,(e,t)=>this.getCellMeta(e,t).className),r="horizontal";this.runHooks("beforeCellAlignment",t,e,r,"htLeft"),(0,n.align)(e,r,"htLeft",(e,t)=>this.getCellMeta(e,t),(e,t,r,n)=>this.setCellMeta(e,t,r,n)),this.render()},disabled:!1},{key:a+":center",name(){let e=this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER);var t=(0,n.checkSelectionConsistency)(this.getSelectedRange(),(e,t)=>{e=this.getCellMeta(e,t).className;if(e&&-1!==e.indexOf("htCenter"))return!0});return e=t?(0,n.markLabelAsSelected)(e):e},callback(){var e=this.getSelectedRange(),t=(0,n.getAlignmentClasses)(e,(e,t)=>this.getCellMeta(e,t).className),r="horizontal";this.runHooks("beforeCellAlignment",t,e,r,"htCenter"),(0,n.align)(e,r,"htCenter",(e,t)=>this.getCellMeta(e,t),(e,t,r,n)=>this.setCellMeta(e,t,r,n)),this.render()},disabled:!1},{key:a+":right",name(){let e=this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT);var t=(0,n.checkSelectionConsistency)(this.getSelectedRange(),(e,t)=>{e=this.getCellMeta(e,t).className;if(e&&-1!==e.indexOf("htRight"))return!0});return e=t?(0,n.markLabelAsSelected)(e):e},callback(){var e=this.getSelectedRange(),t=(0,n.getAlignmentClasses)(e,(e,t)=>this.getCellMeta(e,t).className),r="horizontal";this.runHooks("beforeCellAlignment",t,e,r,"htRight"),(0,n.align)(e,r,"htRight",(e,t)=>this.getCellMeta(e,t),(e,t,r,n)=>this.setCellMeta(e,t,r,n)),this.render()},disabled:!1},{key:a+":justify",name(){let e=this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY);var t=(0,n.checkSelectionConsistency)(this.getSelectedRange(),(e,t)=>{e=this.getCellMeta(e,t).className;if(e&&-1!==e.indexOf("htJustify"))return!0});return e=t?(0,n.markLabelAsSelected)(e):e},callback(){var e=this.getSelectedRange(),t=(0,n.getAlignmentClasses)(e,(e,t)=>this.getCellMeta(e,t).className),r="horizontal";this.runHooks("beforeCellAlignment",t,e,r,"htJustify"),(0,n.align)(e,r,"htJustify",(e,t)=>this.getCellMeta(e,t),(e,t,r,n)=>this.setCellMeta(e,t,r,n)),this.render()},disabled:!1},{name:i.KEY},{key:a+":top",name(){let e=this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_ALIGNMENT_TOP);var t=(0,n.checkSelectionConsistency)(this.getSelectedRange(),(e,t)=>{e=this.getCellMeta(e,t).className;if(e&&-1!==e.indexOf("htTop"))return!0});return e=t?(0,n.markLabelAsSelected)(e):e},callback(){var e=this.getSelectedRange(),t=(0,n.getAlignmentClasses)(e,(e,t)=>this.getCellMeta(e,t).className);this.runHooks("beforeCellAlignment",t,e,"vertical","htTop"),(0,n.align)(e,"vertical","htTop",(e,t)=>this.getCellMeta(e,t),(e,t,r,n)=>this.setCellMeta(e,t,r,n)),this.render()},disabled:!1},{key:a+":middle",name(){let e=this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE);var t=(0,n.checkSelectionConsistency)(this.getSelectedRange(),(e,t)=>{e=this.getCellMeta(e,t).className;if(e&&-1!==e.indexOf("htMiddle"))return!0});return e=t?(0,n.markLabelAsSelected)(e):e},callback(){var e=this.getSelectedRange(),t=(0,n.getAlignmentClasses)(e,(e,t)=>this.getCellMeta(e,t).className);this.runHooks("beforeCellAlignment",t,e,"vertical","htMiddle"),(0,n.align)(e,"vertical","htMiddle",(e,t)=>this.getCellMeta(e,t),(e,t,r,n)=>this.setCellMeta(e,t,r,n)),this.render()},disabled:!1},{key:a+":bottom",name(){let e=this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM);var t=(0,n.checkSelectionConsistency)(this.getSelectedRange(),(e,t)=>{e=this.getCellMeta(e,t).className;if(e&&-1!==e.indexOf("htBottom"))return!0});return e=t?(0,n.markLabelAsSelected)(e):e},callback(){var e=this.getSelectedRange(),t=(0,n.getAlignmentClasses)(e,(e,t)=>this.getCellMeta(e,t).className);this.runHooks("beforeCellAlignment",t,e,"vertical","htBottom"),(0,n.align)(e,"vertical","htBottom",(e,t)=>this.getCellMeta(e,t),(e,t,r,n)=>this.setCellMeta(e,t,r,n)),this.render()},disabled:!1}]}}};var n=r(855),i=r(856),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621));function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}const a=t.KEY="alignment"},(e,t,r)=>{"use strict";t.__esModule=!0,t.align=function(e,a,l,c,u){(0,i.arrayEach)(e,e=>{e.forAll((t,r)=>{if(0<=t&&0<=r){var n=a;var i=l;var o=c;var s=u;o=o(t,r);let e=i;o.className&&(e=("vertical"===n?d:h)(o.className,i));s(t,r,"className",e)}})})},t.checkSelectionConsistency=function(e,r){let n=!1;Array.isArray(e)&&(0,i.arrayEach)(e,e=>(e.forAll((e,t)=>{if(0<=e&&0<=t&&r(e,t))return!(n=!0)}),n));return n},t.getAlignmentClasses=function(e,r){const n={};return(0,i.arrayEach)(e,e=>{e.forAll((e,t)=>{0<=e&&0<=t&&(n[e]||(n[e]=[]),n[e][t]=r(e,t))})}),n},t.getDocumentOffsetByElement=function(e,t){var r={top:0,left:0};t!==e.ownerDocument&&(e=t.defaultView["frameElement"],{top:t,left:e}=e.getBoundingClientRect(),r.top=t,r.left=e);return r},t.markLabelAsSelected=function(e){return`<span class="selected">${String.fromCharCode(10003)}</span>`+e},t.prepareHorizontalAlignClass=h,t.prepareVerticalAlignClass=d;var i=r(478);function d(e,t){return-1!==e.indexOf(t)?e:e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")+" "+t}function h(e,t){return-1!==e.indexOf(t)?e:e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")+" "+t}},(e,t)=>{"use strict";t.__esModule=!0,t.default=function(){return{name:r}};const r=t.KEY="---------"},(e,t,r)=>{"use strict";t.__esModule=!0,t.default=function(){return{key:i,name(){return this.getTranslatedPhrase(n.CONTEXTMENU_ITEMS_CLEAR_COLUMN)},callback(e,t){var r=t[0].start.col,n=t[0].end.col;this.countRows()&&this.populateFromArray(0,r,[[null]],Math.max(t[0].start.row,t[0].end.row),n,"ContextMenu.clearColumn")},disabled(){var e=this.getSelectedRangeLast();return!e||!!(e.isSingleHeader()&&e.highlight.col<0)||!this.selection.isSelectedByColumnHeader()}}};var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621));function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}const i=t.KEY="clear_column"},(e,t,r)=>{"use strict";t.__esModule=!0,t.default=function(){return{key:i,name(){return this.getTranslatedPhrase(n.CONTEXTMENU_ITEMS_INSERT_LEFT)},callback(){var e=this.getSelectedRangeLast().getTopLeftCorner(),t=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(t,e.col,1,"ContextMenu.columnLeft")},disabled(){var e;return!this.isColumnModificationAllowed()||!(e=this.getSelectedRangeLast())||!!(e.isSingleHeader()&&e.highlight.col<0)||(this.selection.isSelectedByCorner()?0===this.countCols():this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}};var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621));function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}const i=t.KEY="col_left"},(e,t,r)=>{"use strict";t.__esModule=!0,t.default=function(){return{key:i,name(){return this.getTranslatedPhrase(n.CONTEXTMENU_ITEMS_INSERT_RIGHT)},callback(){var e=this.getSelectedRangeLast().getTopRightCorner(),t=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(t,e.col,1,"ContextMenu.columnRight")},disabled(){var e;return!this.isColumnModificationAllowed()||!(e=this.getSelectedRangeLast())||!!(e.isSingleHeader()&&e.highlight.col<0)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}};var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621));function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}const i=t.KEY="col_right"},(e,t,r)=>{"use strict";t.__esModule=!0,t.default=function(){return{key:a,name(){let e=this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_READ_ONLY);var t=(0,n.checkSelectionConsistency)(this.getSelectedRange(),(e,t)=>this.getCellMeta(e,t).readOnly);return e=t?(0,n.markLabelAsSelected)(e):e},callback(){var e=this.getSelectedRange();const r=(0,n.checkSelectionConsistency)(e,(e,t)=>this.getCellMeta(e,t).readOnly);(0,i.arrayEach)(e,e=>{e.forAll((e,t)=>{0<=e&&0<=t&&this.setCellMeta(e,t,"readOnly",!r)})}),this.render()},disabled(){var e=this.getSelectedRangeLast();return!(e&&!e.isSingleHeader()&&!this.selection.isSelectedByCorner()&&0!==this.countRows()&&0!==this.countCols()&&this.getSelectedRange()&&0!==this.getSelectedRange().length)}}};var n=r(855),i=r(478),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621));function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}const a=t.KEY="make_read_only"},(e,t,r)=>{"use strict";t.__esModule=!0,t.default=function(){return{key:i,name(){return this.getTranslatedPhrase(n.CONTEXTMENU_ITEMS_REDO)},callback(){this.redo()},hidden(){var e=this.getPlugin("undoRedo");return!e||!e.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}};var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621));function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}const i=t.KEY="redo"},(e,t,r)=>{"use strict";t.__esModule=!0,t.default=function(){return{key:o,name(){var e,t=this.getSelected();let r=0;return t&&(1<t.length||([,t,,e]=t[0],t-e!=0))&&(r=1),this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_REMOVE_COLUMN,r)},callback(){this.alter("remove_col",(0,n.transformSelectionToColumnDistance)(this),null,"ContextMenu.removeColumn")},disabled(){var e;return!this.isColumnModificationAllowed()||!(e=this.getSelectedRangeLast())||!!(e.isSingleHeader()&&e.highlight.col<0)||(e=this.countCols(),!this.selection.isSelectedByCorner()&&this.selection.isSelectedByRowHeader())||0===e},hidden(){return!this.getSettings().allowRemoveColumn}}};var n=r(637),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621));function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}const o=t.KEY="remove_col"},(e,t,r)=>{"use strict";t.__esModule=!0,t.default=function(){return{key:o,name(){var e,t=this.getSelected();let r=0;return t&&(1<t.length||([t,,e]=t[0],t-e!=0))&&(r=1),this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_REMOVE_ROW,r)},callback(){this.alter("remove_row",(0,n.transformSelectionToRowDistance)(this),1,"ContextMenu.removeRow")},disabled(){var e=this.getSelectedRangeLast();return!e||!!(e.isSingleHeader()&&e.highlight.row<0)||(e=this.countRows(),!this.selection.isSelectedByCorner()&&this.selection.isSelectedByColumnHeader())||0===e},hidden(){return!this.getSettings().allowRemoveRow}}};var n=r(637),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621));function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}const o=t.KEY="remove_row"},(e,t,r)=>{"use strict";t.__esModule=!0,t.default=function(){return{key:i,name(){return this.getTranslatedPhrase(n.CONTEXTMENU_ITEMS_ROW_ABOVE)},callback(){var e=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",e.row,1,"ContextMenu.rowAbove")},disabled(){var e=this.getSelectedRangeLast();return!e||!!(e.isSingleHeader()&&e.highlight.row<0)||(this.selection.isSelectedByCorner()?0===this.countRows():this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}};var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621));function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}const i=t.KEY="row_above"},(e,t,r)=>{"use strict";t.__esModule=!0,t.default=function(){return{key:i,name(){return this.getTranslatedPhrase(n.CONTEXTMENU_ITEMS_ROW_BELOW)},callback(){var e=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",e.row,1,"ContextMenu.rowBelow")},disabled(){var e=this.getSelectedRangeLast();return!e||!!(e.isSingleHeader()&&e.highlight.row<0)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}};var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621));function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}const i=t.KEY="row_below"},(e,t,r)=>{"use strict";t.__esModule=!0,t.default=function(){return{key:i,name(){return this.getTranslatedPhrase(n.CONTEXTMENU_ITEMS_NO_ITEMS)},disabled:!0,isCommand:!1}};var n=r(621);const i=t.KEY="no_items"},(e,t,r)=>{"use strict";t.__esModule=!0,t.default=function(){return{key:i,name(){return this.getTranslatedPhrase(n.CONTEXTMENU_ITEMS_UNDO)},callback(){this.undo()},hidden(){var e=this.getPlugin("undoRedo");return!e||!e.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}};var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621));function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}const i=t.KEY="undo"},(e,t,r)=>{"use strict";t.__esModule=!0,t.default=function(t){return{key:"commentsAddEdit",name(){var e=null==(e=this.getSelectedRangeLast())?void 0:e.highlight;return null!=e&&e.isCell()&&t.getCommentAtCell(e.row,e.col)?this.getTranslatedPhrase(n.CONTEXTMENU_ITEMS_EDIT_COMMENT):this.getTranslatedPhrase(n.CONTEXTMENU_ITEMS_ADD_COMMENT)},callback(){var e=this.getSelectedRangeLast();t.setRange(e),t.show(),t.focusEditor()},disabled(){var e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}};var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621));function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}},(e,t,r)=>{"use strict";t.__esModule=!0,t.default=function(r){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(n.CONTEXTMENU_ITEMS_REMOVE_COMMENT)},callback(){this.getSelectedRangeLast().forAll((e,t)=>{0<=e&&0<=t&&r.removeCommentAtCell(e,t,!1)}),this.render()},disabled(){var e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}};var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621));function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}},(e,t,r)=>{"use strict";t.__esModule=!0,t.default=function(n){return{key:"commentsReadOnly",name(){var e=this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT);return(0,o.checkSelectionConsistency)(this.getSelectedRange(),(e,t)=>n.getCommentMeta(e,t,s.META_READONLY))?(0,o.markLabelAsSelected)(e):e},callback(){this.getSelectedRangeLast().forAll((e,t)=>{var r;0<=e&&0<=t&&(r=!!n.getCommentMeta(e,t,s.META_READONLY),n.updateCommentMeta(e,t,{[s.META_READONLY]:!r}))})},disabled(){var e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!n.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}};var i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=a(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621)),o=r(855),s=r(849);function a(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(a=function(e){return e?r:t})(e))}},(e,t,r)=>{"use strict";r.r(t)},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(873);t.PLUGIN_KEY=r.PLUGIN_KEY,t.PLUGIN_PRIORITY=r.PLUGIN_PRIORITY,t.ContextMenu=r.ContextMenu},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),n(r(487))),o=r(813),n=n(r(494)),s=r(478),a=r(482),l=r(874),c=r(877),u=r(878),d=r(855),h=r(334),p=r(853);function f(e,t){var r=e;if(t.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object");t.add(e)}function g(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}r(888);const m=t.PLUGIN_KEY="contextMenu",y=(t.PLUGIN_PRIORITY=70,m);n.default.getSingleton().register("afterContextMenuDefaultOptions"),n.default.getSingleton().register("beforeContextMenuShow"),n.default.getSingleton().register("afterContextMenuShow"),n.default.getSingleton().register("afterContextMenuHide"),n.default.getSingleton().register("afterContextMenuExecute");var v=new WeakSet;class b extends o.BasePlugin{constructor(){super(...arguments),f(this,v),(0,i.default)(this,"commandExecutor",new l.CommandExecutor(this.hot)),(0,i.default)(this,"itemsFactory",null),(0,i.default)(this,"menu",null)}static get PLUGIN_KEY(){return m}static get PLUGIN_PRIORITY(){return 70}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[p.ROW_ABOVE,p.ROW_BELOW,p.SEPARATOR,p.COLUMN_LEFT,p.COLUMN_RIGHT,p.SEPARATOR,p.REMOVE_ROW,p.REMOVE_COLUMN,p.SEPARATOR,p.UNDO,p.REDO,p.SEPARATOR,p.READ_ONLY,p.SEPARATOR,p.ALIGNMENT]}isEnabled(){return!!this.hot.getSettings()[m]}enablePlugin(){var e,n=this;this.enabled||("function"==typeof(e=this.hot.getSettings()[m]).callback&&this.commandExecutor.setCommonCallback(e.callback),this.menu=new u.Menu(this.hot,{className:"htContextMenu",keepInViewport:!0,container:e.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>g(v,this,C).call(this)),this.menu.addLocalHook("afterOpen",()=>g(v,this,E).call(this)),this.menu.addLocalHook("afterClose",()=>g(v,this,T).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.executeCommand.call(n,...t)}),this.addHook("afterOnCellContextMenu",e=>g(v,this,w).call(this,e)),this.registerShortcuts(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{var e=this.hot.getSelectedRangeLast()["highlight"],e=(this.hot.scrollToFocusedCell(),this.hot.getCell(e.row,e.col,!0).getBoundingClientRect()),t=(0,d.getDocumentOffsetByElement)(this.menu.container,this.hot.rootDocument);this.open({left:e.left+t.left,top:e.top+t.top-1+e.height},{left:e.width,above:-e.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e=null==(e=this.hot.getSelectedRangeLast())?void 0:e.highlight;return e&&this.hot.selection.isCellVisible(e)&&!this.menu.isOpened()},group:y})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(y)}open(e){var t,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};null!=(t=this.menu)&&t.isOpened()||(this.prepareMenuItems(),this.menu.open(),(0,a.objectEach)(r,(e,t)=>{this.menu.setOffset(t,e)}),this.menu.setPosition(e))}close(){var e;null!=(e=this.menu)&&e.close(),this.itemsFactory=null}executeCommand(e){null===this.itemsFactory&&this.prepareMenuItems();for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new c.ItemsFactory(this.hot,b.DEFAULT_ITEMS);var e=this.hot.getSettings()[m],t={items:this.itemsFactory.getItems(e)},t=(this.hot.runHooks("afterContextMenuDefaultOptions",t),this.itemsFactory.setPredefinedItems(t.items),this.itemsFactory.getItems(e));this.hot.runHooks("beforeContextMenuSetItems",t),this.menu.setMenuItems(t),(0,s.arrayEach)(t,e=>this.commandExecutor.registerCommand(e.key,e))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function w(e){var t=this.hot.getSettings(),r=t.rowHeaders,t=t.colHeaders;var n=e.target;this.close(),!(0,h.hasClass)(n,"handsontableInput")&&(e.preventDefault(),e.stopPropagation(),r||t||"TD"===(r=n).nodeName||"TD"===r.parentNode.nodeName||(0,h.hasClass)(n,"current")&&(0,h.hasClass)(n,"wtBorder"))&&(t=(0,d.getDocumentOffsetByElement)(this.menu.container,this.hot.rootDocument),this.open({top:e.clientY+t.top,left:e.clientX+t.left}))}function C(){this.hot.runHooks("beforeContextMenuShow",this)}function E(){this.hot.runHooks("afterContextMenuShow",this)}function T(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}(t.ContextMenu=b).SEPARATOR={name:p.SEPARATOR}},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),r(286),r(875),n(r(487))),a=r(478),l=r(482);t.CommandExecutor=class{constructor(e){(0,i.default)(this,"hot",void 0),(0,i.default)(this,"commands",{}),(0,i.default)(this,"commonCallback",null),this.hot=e}registerCommand(e,t){this.commands[e]=t}setCommonCallback(e){this.commonCallback=e}execute(e){for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var e=e.split(":"),i=e[0],o=2===e.length?e[1]:null;let s=this.commands[i];if(!s)throw new Error(`Menu command '${i}' not exists.`);!0===(s=o&&s.submenu?function(r,e){let n;return(0,a.arrayEach)(e,e=>{var t=e.key?e.key.split(":"):null;if(Array.isArray(t)&&t[1]===r)return n=e,!1}),n}(o,s.submenu.items):s).disabled||"function"==typeof s.disabled&&!0===s.disabled.call(this.hot)||(0,l.hasOwnProperty)(s,"submenu")||(i=[],"function"==typeof s.callback&&i.push(s.callback),"function"==typeof this.commonCallback&&i.push(this.commonCallback),r.unshift(e.join(":")),(0,a.arrayEach)(i,e=>e.apply(this.hot,r)))}}},(e,t,r)=>{"use strict";var n=r(205),a=r(241),l=r(265),c=r(287),u=r(876),d=r(289);n({target:"Array",proto:!0,arity:1,forced:1!==[].unshift(0)||!function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(e){return e instanceof TypeError}}()},{unshift:function(e){var t=a(this),r=l(t),n=arguments.length;if(n){d(r+n);for(var i=r;i--;){var o=i+n;i in t?t[o]=t[i]:u(t,o)}for(var s=0;s<n;s++)t[s]=arguments[s]}return c(t,r+n)}})},(e,t,r)=>{"use strict";var n=r(233),i=TypeError;e.exports=function(e,t){if(!delete e[t])throw new i("Cannot delete property "+n(t)+" of "+n(e))}},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(286),n(r(487))),o=r(482),s=r(478),a=r(853);t.ItemsFactory=class{constructor(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;(0,i.default)(this,"hot",void 0),(0,i.default)(this,"predefinedItems",(0,a.predefinedItems)()),(0,i.default)(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=t}setPredefinedItems(e){const n={};(this.defaultOrderPattern.length=0,o.objectEach)(e,(e,t)=>{let r="";r=e.name===a.SEPARATOR?(n[a.SEPARATOR]=e,a.SEPARATOR):(isNaN(parseInt(t,10))?(e.key=void 0===e.key?t:e.key,n[t]=e):n[e.key]=e,e.key),this.defaultOrderPattern.push(r)}),this.predefinedItems=n}getItems(){return function(){let e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};const i=[];let r=e;r&&r.items?r=r.items:Array.isArray(r)||(r=t);(0,o.isObject)(r)?(0,o.objectEach)(r,(e,t)=>{let r=n["string"==typeof e?e:t];r=r||e,(0,o.isObject)(e)?(0,o.extend)(r,e):"string"==typeof r&&(r={name:r}),void 0===r.key&&(r.key=t),i.push(r)}):(0,s.arrayEach)(r,(e,t)=>{let r=n[e];!r&&0<=a.ITEMS.indexOf(e)||(r=r||{name:e,key:""+t},(0,o.isObject)(e)&&(0,o.extend)(r,e),void 0===r.key&&(r.key=t),i.push(r))});return i}(0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,this.defaultOrderPattern,this.predefinedItems)}}},(e,t,r)=>{"use strict";t.__esModule=!0;var n=r(879);Object.keys(n).forEach(function(e){"default"===e||"__esModule"===e||e in t&&t[e]===n[e]||(t[e]=n[e])})},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),r(286),n(r(487))),o=r(880),s=r(882),a=r(885),l=r(853),c=r(884),u=n(r(502)),d=r(478),h=r(481),p=r(334),f=r(492),g=r(480),m=r(337),y=r(482),n=n(r(578)),v=r(887),b=r(479);function w(e,t,r){var n=e;if(t.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object");t.set(e,r)}function C(e,t,r){e.set(T(e,t),r)}function E(e,t){return e.get(T(e,t))}function T(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var S=new WeakMap,_=new WeakMap;class x{constructor(e,t){var n=this;(0,i.default)(this,"hot",void 0),(0,i.default)(this,"options",void 0),(0,i.default)(this,"eventManager",new u.default(this)),(0,i.default)(this,"container",void 0),(0,i.default)(this,"positioner",void 0),(0,i.default)(this,"hotMenu",null),(0,i.default)(this,"hotSubMenus",{}),(0,i.default)(this,"parentMenu",void 0),(0,i.default)(this,"menuItems",null),(0,i.default)(this,"origOutsideClickDeselects",null),w(this,S,void 0),w(this,_,void 0),this.hot=e,this.options=t||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:215,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new o.Positioner(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.parentMenu.runLocalHooks("afterSelectionChange",...t)})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",e=>this.onDocumentMouseDown(e)),this.eventManager.addEventListener(e.document,"touchstart",e=>this.onDocumentMouseDown(e)),this.eventManager.addEventListener(e.document,"contextmenu",e=>this.onDocumentContextMenu(e)),e=(0,p.getParentWindow)(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return E(S,this)}getKeyboardShortcutsCtrl(){return E(_,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return null!==this.parentMenu}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const r=(0,g.debounce)(e=>this.openSubMenu(e),300),t=this.options.minWidth||215;let n=!1,i=(0,d.arrayFilter)(this.menuItems,e=>(e.key===l.NO_ITEMS&&(n=!0),(0,c.isItemHidden)(e,this.hot)));if(i.length<1&&!n)i.push((0,l.predefinedItems)()[l.NO_ITEMS]);else if(0===i.length)return;i=(0,c.filterSeparators)(i,l.SEPARATOR);let o=!1;var e={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(e){return(0,m.isDefined)(e)&&e<t?t:e},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:(0,v.createMenuItemRenderer)(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,beforeOnCellMouseOver:(e,t)=>{E(S,this).setCurrentPage(t.row)},afterOnCellMouseOver:(e,t)=>{this.isAllSubMenusClosed()?r(t.row):this.openSubMenu(t.row)},rowHeights:e=>i[e].name===l.SEPARATOR?1:23,afterOnCellContextMenu:e=>{e.preventDefault(),(0,h.isWindowsOS)()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(e,t,r,n,i)=>{this.hotMenu.view.isMouseDown()&&(i.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:e=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(e))},afterOnCellMouseUp:e=>{(0,h.isWindowsOS)()&&(0,f.isRightClick)(e)||!o||!this.hasSelectedItem()||((0,h.isMobileBrowser)()||(0,h.isIpadOS)()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,e),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),C(S,this,(0,s.createMenuNavigator)(this.hotMenu)),C(_,this,(0,a.createKeyboardShortcutsCtrl)(this)),E(_,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.isOpened()&&(e&&this.isSubMenu()?this.parentMenu.close():(E(S,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()&&(this.hot.getSettings().ariaTags&&(e=this.parentMenu.hotMenu.getSelectedLast())&&(e=this.parentMenu.hotMenu.getCell(e[0],0),(0,p.setAttribute)(e,[(0,b.A11Y_EXPANDED)(!1)])),this.parentMenu.hotMenu.listen())))}openSubMenu(e){var t,r;return!(!this.hotMenu||(t=this.hotMenu.getCell(e,0),this.closeAllSubMenus(),!t)||!(0,c.hasSubMenu)(t))&&(e=this.hotMenu.getSourceDataAtRow(e),(r=new x(this.hot,{parent:this,name:e.name,className:this.options.className,keepInViewport:!0,container:this.options.container})).setMenuItems(e.submenu.items),r.open(),r.setPosition(t.getBoundingClientRect()),this.hotSubMenus[e.key]=r,this.hot.getSettings().ariaTags&&(0,p.setAttribute)(t,[(0,b.A11Y_EXPANDED)(!0)]),r)}closeSubMenu(e){var t=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[t.key];r&&(r.destroy(),delete this.hotSubMenus[t.key],r=this.hotMenu.getCell(e,0),this.hot.getSettings().ariaTags)&&(0,p.setAttribute)(r,[(0,b.A11Y_EXPANDED)(!1)])}closeAllSubMenus(){(0,d.arrayEach)(this.hotMenu.getData(),(e,t)=>this.closeSubMenu(t))}isAllSubMenusClosed(){return 0===Object.keys(this.hotSubMenus).length}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){var e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return null!==this.hotMenu}executeCommand(e){var t,r;this.isOpened()&&this.hasSelectedItem()&&(t=this.getSelectedItem(),this.runLocalHooks("select",t,e),this.isCommandPassive(t)||(r=(r=this.hot.getSelectedRange())?(0,c.normalizeSelection)(r):[],this.runLocalHooks("executeCommand",t.key,r,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",t.key,r,e)))}isCommandPassive(e){return!1===e.isCommand||(0,c.isItemSeparator)(e)||(0,c.isItemDisabled)(e,this.hot)||(0,c.isItemSubMenu)(e)}setOffset(e){this.positioner.setOffset(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:0)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}createContainer(){var e=this.options.container.ownerDocument;let t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,r;return t&&(t=(t=(0,g.isFunction)(t)?null===(t=t.call(this.hot))||(0,m.isUndefined)(t)?"":t.toString():t).replace(/[^A-z0-9]/g,"_"),t=this.options.className+"Sub_"+t,r=e.querySelector(`.${this.options.className}.`+t)),r||(r=e.createElement("div"),(0,p.addClass)(r,"htMenu "+this.options.className),t&&(0,p.addClass)(r,t),this.options.container.appendChild(r)),r}onAfterInit(){var e=this.hotMenu.view._wt["wtTable"],t=this.hotMenu.getSettings().data,r=e.hider.style,e=e.holder.style,n=parseInt(r.width,10),t=(0,d.arrayReduce)(t,(e,t)=>e+(t.name===l.SEPARATOR?1:26),0);e.width=n+3+"px",e.height=t+3+"px",r.height=e.height,this.hot.getSettings().ariaTags&&(0,p.setAttribute)(this.hotMenu.rootElement,[(0,b.A11Y_MENU)(),(0,b.A11Y_TABINDEX)(-1)])}onDocumentMouseDown(e){!this.isOpened()||(this.options.standalone&&this.hotMenu&&!(0,p.isChildOf)(e.target,this.hotMenu.rootElement)||(this.isAllSubMenusClosed()||this.isSubMenu())&&!(0,p.isChildOf)(e.target,".htMenu"))&&this.close(!0)}onDocumentContextMenu(e){this.isOpened()&&(0,p.hasClass)(e.target,"htCore")&&(0,p.isChildOf)(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}t.Menu=x,(0,y.mixin)(x,n.default)},(e,t,r)=>{"use strict";t.__esModule=!0,r(204);var n=r(881);function i(e,t,r){var n=e;if(t.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object");t.set(e,r)}function o(e,t){return e.get(a(e,t))}function s(e,t,r){e.set(a(e,t),r)}function a(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var l=new WeakMap,c=new WeakMap,u=new WeakMap,d=new WeakMap,h=new WeakMap;t.Positioner=class{constructor(e){i(this,l,void 0),i(this,c,void 0),i(this,u,void 0),i(this,d,!1),i(this,h,{above:0,below:0,left:0,right:0}),s(d,this,e)}setOffset(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return o(h,this)[e]=t,this}setElement(e){return s(l,this,e),this}setParentElement(e){return s(c,this,e),this}updatePosition(e){s(u,this,new n.Cursor(e,o(l,this).ownerDocument.defaultView)),o(d,this)?(!o(u,this).fitsBelow(o(l,this))&&o(u,this).fitsAbove(o(l,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){"rtl"===o(l,this).dir?o(u,this).fitsOnLeft(o(l,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():o(u,this).fitsOnRight(o(l,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=o(h,this).above+o(u,this).top-o(l,this).offsetHeight;o(c,this)&&(e=o(u,this).top+o(u,this).cellHeight-o(l,this).offsetHeight+3),o(l,this).style.top=e+"px"}setPositionBelowCursor(){let e=o(h,this).below+o(u,this).top+1;o(c,this)&&(e=o(u,this).top-1),o(l,this).style.top=e+"px"}setPositionOnRightOfCursor(){let e=o(u,this).left;var t;o(c,this)?(t=o(c,this).getBoundingClientRect()["right"],e+=o(u,this).cellWidth+t-(o(u,this).left+o(u,this).cellWidth)):e+=o(h,this).right,o(l,this).style.left=e+"px"}setPositionOnLeftOfCursor(){let e=o(h,this).left+o(u,this).left-o(l,this).offsetWidth;var t;o(c,this)&&(t=o(c,this).getBoundingClientRect()["left"],e-=o(u,this).left-t),o(l,this).style.left=e+"px"}}},(e,t,r)=>{"use strict";var n=r(197),u=(t.__esModule=!0,n(r(487)));t.Cursor=class{constructor(e,t){(0,u.default)(this,"top",void 0),(0,u.default)(this,"topRelative",void 0),(0,u.default)(this,"left",void 0),(0,u.default)(this,"leftRelative",void 0),(0,u.default)(this,"scrollTop",void 0),(0,u.default)(this,"scrollLeft",void 0),(0,u.default)(this,"cellHeight",void 0),(0,u.default)(this,"cellWidth",void 0);var r=t.scrollY,n=t.scrollX;let i,o,s,a,l,c;this.rootWindow=t,this.type=this.getSourceType(e),"literal"===this.type?(i=parseInt(e.top,10),s=parseInt(e.left,10),l=e.height||0,c=e.width||0,o=i,a=s,i+=r,s+=n):"event"===this.type&&(i=parseInt(e.pageY,10),s=parseInt(e.pageX,10),l=e.target.clientHeight,c=e.target.clientWidth,o=i-r,a=s-n),this.top=i,this.topRelative=o,this.left=s,this.leftRelative=a,this.scrollTop=r,this.scrollLeft=n,this.cellHeight=l,this.cellWidth=c}getSourceType(e){let t="literal";return t=e instanceof Event?"event":t}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=t}fitsOnRight(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=t}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}},(e,t,r)=>{"use strict";t.__esModule=!0,t.createMenuNavigator=function(n){return(0,i.createPaginator)({size:()=>n.countRows(),onItemSelect(e,t){var r=n.getCell(e,0);if(!r||(0,o.isSeparator)(r)||(0,o.isDisabled)(r)||(0,o.isSelectionDisabled)(r))return!1;n.selectCell(e,0,...t?[e,0,!1,!1]:[])},onClear(){n.deselectCell()}})};var i=r(883),o=r(884)},(e,t,r)=>{"use strict";t.__esModule=!0,t.createPaginator=function(e){let{initialPage:t=-1,size:r=()=>0,onItemSelect:n=()=>{},onClear:i=()=>{}}=e;const o=new Set;let s=(0,c.clamp)(t,-1,l()-1);function a(e,t){var r=l()-1;return r<(e=e<0?r:e)&&(e=0),o.has(e)?-1:(o.add(e),!1===n(e,!1)?a(1===t?++e:--e,t):e)}function l(){return Math.max(r(),0)}return{setCurrentPage:function(e){-1<e&&e<l()&&!1!==n(e,!0)&&(s=e)},getCurrentPage:function(){return s},toFirstItem:function(){0<l()&&(o.clear(),s=a(0,1))},toLastItem:function(){0<l()&&(o.clear(),s=a(l()-1,-1))},toNextItem:function(){0<l()&&(o.clear(),s=a(++s,1))},toPreviousItem:function(){0<l()&&(o.clear(),s=a(--s,-1))},getSize:l,clear:function(){o.clear(),s=t,i()}}},r(290),r(302),r(305),r(309),r(312),r(315),r(318);var c=r(512)},(e,t,r)=>{"use strict";t.__esModule=!0,t.filterSeparators=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:s.SEPARATOR,e=e.slice(0);return function(e){const r=[];return(0,n.arrayEach)(e,(e,t)=>{(!(0<t)||r[r.length-1].name!==e.name)&&r.push(e)}),r}(e=function(e,t){let r=e.slice(0);return r.reverse(),(r=a(r,t)).reverse(),r}(e=a(e,t),t))},t.hasSubMenu=function(e){return(0,o.hasClass)(e,"htSubmenu")},t.isDisabled=function(e){return(0,o.hasClass)(e,"htDisabled")},t.isItemDisabled=function(e,t){return!0===e.disabled||"function"==typeof e.disabled&&!0===e.disabled.call(t)},t.isItemHidden=function(e,t){return!e.hidden||!("function"==typeof e.hidden&&e.hidden.call(t))},t.isItemSelectionDisabled=function(e){return(0,i.hasOwnProperty)(e,"disableSelection")},t.isItemSeparator=function(e){return new RegExp(s.SEPARATOR,"i").test(e.name)},t.isItemSubMenu=function(e){return(0,i.hasOwnProperty)(e,"submenu")},t.isSelectionDisabled=function(e){return(0,o.hasClass)(e,"htSelectionDisabled")},t.isSeparator=function(e){return(0,o.hasClass)(e,"htSeparator")},t.normalizeSelection=function(e){return(0,n.arrayMap)(e,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))},r(286);var n=r(478),i=r(482),o=r(334),s=r(853);function a(e,t){for(var r=e.slice(0);0<r.length&&r[0].name===t;)r.shift();return r}},(e,t,r)=>{"use strict";t.__esModule=!0,t.createKeyboardShortcutsCtrl=function(n){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];const i=[];function o(e,t){a(t).addShortcuts(e,{group:c})}function r(e,t){const r=a(t);e.forEach(e=>{e=e.keys;e.forEach(e=>r.removeShortcutsByKeys(e))}),i.push({shortcuts:e,contextName:t}),o(e,t)}function s(e){return e?u+":"+e:u}function a(e){var t,r=n.hotMenu.getShortcutManager(),e=s(e);return null!=(t=r.getContext(e))?t:r.addContext(e)}return o((0,l.createDefaultShortcutsList)(n)),e.forEach(e=>{var{shortcuts:e,contextName:t}=e;r(e,t)}),{addCustomShortcuts:r,getCustomShortcuts:function(){return[...i]},getContext:a,listen:function(e){n.hotMenu.getShortcutManager().setActiveContextName(s(e))}}},r(286);var l=r(886);const c="menu",u=c},(e,t)=>{"use strict";t.__esModule=!0,t.createDefaultShortcutsList=function(n){const{hot:i,hotMenu:r}=n;return[{keys:[["Control/Meta","A"]],forwardToContext:i.getShortcutManager().getContext("grid"),callback:()=>n.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(e,t)=>{var r=i.getSettings(),e="function"==typeof r.tabMoves?r.tabMoves(e):r.tabMoves;t.includes("shift")?i.selection.transformStart(-e.row,-e.col):i.selection.transformStart(e.row,e.col),n.close(!0)}},{keys:[["Escape"]],callback:()=>n.close()},{keys:[["ArrowDown"]],callback:()=>n.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>n.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{var e=r.getSelectedLast();e&&(e=n.openSubMenu(e[0]))&&e.getNavigator().toFirstItem()}},{keys:[["ArrowLeft"]],callback:()=>{r.getSelectedLast()&&n.isSubMenu()&&(n.close(),n.isSubMenu())&&n.parentMenu.hotMenu.listen()}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>n.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>n.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:e=>{var t=r.getSelectedLast();t&&(r.getSourceDataAtRow(t[0]).submenu?n.openSubMenu(t[0]).getNavigator().toFirstItem():(n.executeCommand(e),n.close(!0)))}},{keys:[["PageUp"]],callback:()=>{r.getSelectedLast()?r.selection.transformStart(-r.countVisibleRows(),0):n.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{r.getSelectedLast()?r.selection.transformStart(r.countVisibleRows(),0):n.getNavigator().toLastItem()}}]}},(e,t,r)=>{"use strict";t.__esModule=!0,t.createMenuItemRenderer=function(c){return(e,t,r,n,i,o)=>{var s,a,l;t.hasAttribute("ghost-table")||(s=e.getSourceDataAtRow(r),a=c.rootDocument.createElement("div"),o="function"==typeof o?o.call(c):o,(0,d.empty)(t),(0,d.addClass)(a,"htItemWrapper"),c.getSettings().ariaTags&&(l=!(0,u.isItemDisabled)(s,c)&&!(0,u.isItemSelectionDisabled)(s)&&!(0,u.isItemSeparator)(s),(0,d.setAttribute)(t,[(0,h.A11Y_MENU_ITEM)(),(0,h.A11Y_LABEL)(o),...l?[(0,h.A11Y_TABINDEX)(-1)]:[],...(0,u.isItemDisabled)(s,c)?[(0,h.A11Y_DISABLED)()]:[],...(0,u.isItemSubMenu)(s)?[(0,h.A11Y_EXPANDED)(!1)]:[]])),t.className="",t.appendChild(a),(0,u.isItemSeparator)(s)?(0,d.addClass)(t,"htSeparator"):"function"==typeof s.renderer?((0,d.addClass)(t,"htCustomMenuRenderer"),t.appendChild(s.renderer(e,a,r,n,i,o))):(0,d.fastInnerHTML)(a,o),(0,u.isItemDisabled)(s,c)?(0,d.addClass)(t,"htDisabled"):(0,u.isItemSelectionDisabled)(s)?(0,d.addClass)(t,"htSelectionDisabled"):(0,u.isItemSubMenu)(s)&&(0,d.addClass)(t,"htSubmenu"))}};var u=r(884),d=r(334),h=r(479)},(e,t,r)=>{"use strict";r.r(t)},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(890);t.PLUGIN_KEY=r.PLUGIN_KEY,t.PLUGIN_PRIORITY=r.PLUGIN_PRIORITY,t.CopyPaste=r.CopyPaste},(L,e,t)=>{"use strict";var r=t(197),n=(e.__esModule=!0,t(204),t(286),r(t(487))),i=t(813),o=r(t(494)),s=t(640),a=t(478),l=t(335),c=t(334),u=t(481),d=r(t(891)),h=r(t(892)),p=r(t(893)),f=r(t(894)),g=r(t(895)),F=r(t(896)),m=t(898),y=t(504);function v(e,t,r){b(e,t),t.set(e,r)}function b(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function w(e,t){return e.get(E(e,t))}function C(e,t,r){e.set(E(e,t),r)}function E(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}t(899),o.default.getSingleton().register("afterCopyLimit"),o.default.getSingleton().register("modifyCopyableRange"),o.default.getSingleton().register("beforeCut"),o.default.getSingleton().register("afterCut"),o.default.getSingleton().register("beforePaste"),o.default.getSingleton().register("afterPaste"),o.default.getSingleton().register("beforeCopy"),o.default.getSingleton().register("afterCopy");const T=e.PLUGIN_KEY="copyPaste",H=(e.PLUGIN_PRIORITY=80,["fragmentSelection"]),S=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var _=new WeakMap,x=new WeakMap,R=new WeakMap,A=new WeakMap,N=new WeakMap,O=new WeakMap,I=new WeakMap,M=new WeakMap,k=new WeakSet;class U extends i.BasePlugin{constructor(){var e,t;super(...arguments),b(e=this,t=k),t.add(e),(0,n.default)(this,"columnsLimit",1/0),(0,n.default)(this,"rowsLimit",1/0),(0,n.default)(this,"pasteMode","overwrite"),(0,n.default)(this,"uiContainer",this.hot.rootDocument.body),v(this,_,!1),v(this,x,!1),v(this,R,!1),v(this,A,"cells-only"),v(this,N,!1),v(this,O,!1),v(this,I,new m.CopyableRangesFactory({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),v(this,M,!1),(0,n.default)(this,"copyableRanges",[])}static get PLUGIN_KEY(){return T}static get SETTING_KEYS(){return[T,...H]}static get PLUGIN_PRIORITY(){return 80}isEnabled(){return!!this.hot.getSettings()[T]}enablePlugin(){var e,t,n=this;this.enabled||({[T]:e}=this.hot.getSettings(),"object"==typeof e&&(this.pasteMode=null!=(t=e.pasteMode)?t:this.pasteMode,this.rowsLimit=(isNaN(e.rowsLimit)?this:e).rowsLimit,this.columnsLimit=(isNaN(e.columnsLimit)?this:e).columnsLimit,C(_,this,!!e.copyColumnHeaders),C(x,this,!!e.copyColumnGroupHeaders),C(R,this,!!e.copyColumnHeadersOnly),this.uiContainer=null!=(t=e.uiContainer)?t:this.uiContainer),this.addHook("afterContextMenuDefaultOptions",e=>E(k,this,$).call(this,e)),this.addHook("afterSelection",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return E(k,n,B).call(n,...t)}),this.addHook("afterSelectionEnd",()=>E(k,this,j).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return n.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return n.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return n.onPaste(...arguments)}),(0,u.isSafari)()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return E(k,n,z).call(n,...t)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return E(k,n,Y).call(n,...t)}),this.addHook("afterSelection",()=>E(k,this,G).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){C(A,this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:"cells-only"),C(N,this,!0),E(k,this,D).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){C(O,this,!0),E(k,this,D).call(this,"cut")}getRangedCopyableData(e){return(0,s.stringify)(this.getRangedData(e))}getRangedData(e){const n=[],{rows:t,columns:i}=(0,m.normalizeRanges)(e);return(0,a.arrayEach)(t,t=>{const r=[];(0,a.arrayEach)(i,e=>{t<0?r.push(this.hot.getColHeader(e,t)):r.push(this.hot.getCopyableData(t,e))}),n.push(r)}),n}paste(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:t;(t||r)&&(e=new F.default,t&&e.clipboardData.setData("text/plain",t),r&&e.clipboardData.setData("text/html",r),this.onPaste(e))}setCopyableText(){var e,t,r,n=this.hot.getSelectedRangeLast();n&&(n.isSingleHeader()?this.copyableRanges=[]:(w(I,this).setSelectedRange(n),n=new Map([["headers",null],["cells",null]]),"column-headers-only"===w(A,this)?n.set("headers",w(I,this).getMostBottomColumnHeadersRange()):("with-column-headers"===w(A,this)?n.set("headers",w(I,this).getMostBottomColumnHeadersRange()):"with-column-group-headers"===w(A,this)&&n.set("headers",w(I,this).getAllColumnHeadersRange()),n.set("cells",w(I,this).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(e=>null!==e).map(e=>{var{startRow:e,startCol:t,endRow:r,endCol:n}=e;return{startRow:e,startCol:t,endRow:r,endCol:n}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges),null!==(n=n.get("cells"))&&n.isRangeTrimmed&&({startRow:n,startCol:e,endRow:t,endCol:r}=n,this.hot.runHooks("afterCopyLimit",t-n+1,r-e+1,this.rowsLimit,this.columnsLimit))))}isEditorOpened(){var e;return null==(e=this.hot.getActiveEditor())?void 0:e.isOpened()}populateValues(i){var o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.hot.getSelectedRangeLast();if(i.length){var s=i.length,a=i[0].length,l=[],{row:c,col:u}=o.getTopStartCorner(),{row:d,col:h}=o.getBottomEndCorner();let e=c,t=u,r=c,n=u;for(;l.length<s||e<=d;){var{skipRowOnPaste:p,visualRow:f}=this.hot.getCellMeta(e,u);if(e=f+1,!0!==p){r=f,t=u;for(var g=[],m=l.length%s;g.length<a||t<=h;){var{skipColumnOnPaste:y,visualCol:v}=this.hot.getCellMeta(c,t);t=v+1,!0!==y&&(n=v,g.push(i[m][g.length%a]))}l.push(g)}}return C(M,this,!0),this.hot.populateFromArray(c,u,l,void 0,void 0,"CopyPaste.paste",this.pasteMode),[c,u,r,n]}}onCopy(e){var t,r,n,i;!this.hot.isListening()&&!w(N,this)||this.isEditorOpened()||!this.hot.getSettings().outsideClickDeselects&&e.target!==this.hot.rootDocument.body||(this.setCopyableText(),C(N,this,!1),t=this.getRangedData(this.copyableRanges),r=E(k,this,V).call(this,this.copyableRanges),this.hot.runHooks("beforeCopy",t,this.copyableRanges,r)&&(n=(0,s.stringify)(t),e&&e.clipboardData?(i=(0,y._dataToHTML)(t,this.hot.rootDocument),e.clipboardData.setData("text/plain",n),e.clipboardData.setData("text/html",[S,i].join(""))):"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",n),this.hot.runHooks("afterCopy",t,this.copyableRanges,r)),C(A,this,"cells-only"),e.preventDefault())}onCut(e){var t,r,n;!this.hot.isListening()&&!w(O,this)||this.isEditorOpened()||!this.hot.getSettings().outsideClickDeselects&&e.target!==this.hot.rootDocument.body||(this.setCopyableText(),C(O,this,!1),t=this.getRangedData(this.copyableRanges),this.hot.runHooks("beforeCut",t,this.copyableRanges)&&(r=(0,s.stringify)(t),e&&e.clipboardData?(n=(0,y._dataToHTML)(t,this.hot.rootDocument),e.clipboardData.setData("text/plain",r),e.clipboardData.setData("text/html",[S,n].join(""))):"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",r),this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",t,this.copyableRanges)),e.preventDefault())}onPaste(t){if(this.hot.isListening()&&!this.isEditorOpened()&&this.hot.getSelected()&&(this.hot.getSettings().outsideClickDeselects||t.target===this.hot.rootDocument.body)){t.preventDefault();let e;var r,n,i;t&&void 0!==t.clipboardData?(r=(0,l.sanitize)(t.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0}),e=r&&/(<table)|(<TABLE)/g.test(r)?(0,y.htmlToGridSettings)(r,this.hot.rootDocument).data:t.clipboardData.getData("text/plain")):"undefined"==typeof ClipboardEvent&&void 0!==this.hot.rootWindow.clipboardData&&(e=this.hot.rootWindow.clipboardData.getData("Text")),void 0===(e="string"==typeof e?(0,s.parse)(e):e)||e&&0===e.length||!1!==this.hot.runHooks("beforePaste",e,this.copyableRanges)&&([r,t,n,i]=this.populateValues(e),this.hot.selectCell(r,t,Math.min(this.hot.countRows()-1,n),Math.min(this.hot.countCols()-1,i)),this.hot.runHooks("afterPaste",e,this.copyableRanges))}}destroy(){super.destroy()}}function D(e){var t,r;(0,u.isSafari)()?(r=this.hot.getSelectedRangeLast())&&({row:r,col:t}=r.highlight,r=this.hot.getCell(r,t,!0))&&(0,c.runWithSelectedContendEditableElement)(r,()=>{this.hot.rootDocument.execCommand(e)}):this.hot.rootDocument.execCommand(e)}function V(e){var t=(0,m.normalizeRanges)(e)["rows"];let r=0;for(let e=0;e<t.length&&!(0<=t[e]);e++)r+=1;return{columnHeadersCount:r}}function W(){var e,t;this.hot.isListening()&&(t=this.hot.getSelectedRangeLast())&&({row:t,col:e}=t.highlight,t=this.hot.getCell(t,e,!0))&&(0,c.makeElementContentEditableAndSelectItsContent)(t)}function P(){var e,t;this.hot.isListening()&&(t=this.hot.getSelectedRangeLast())&&({row:t,col:e}=t.highlight,null!=(t=this.hot.getCell(t,e,!0)))&&t.hasAttribute("contenteditable")&&(0,c.removeContentEditableFromElementAndDeselect)(t)}function $(e){e.items.push({name:"---------"},(0,d.default)(this)),w(_,this)&&e.items.push((0,f.default)(this)),w(x,this)&&e.items.push((0,p.default)(this)),w(R,this)&&e.items.push((0,h.default)(this)),e.items.push((0,g.default)(this))}function B(e,t,r,n,i){w(M,this)&&(i.value=!0),C(M,this,!1)}function j(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function z(){E(k,this,P).call(this)}function Y(){E(k,this,W).call(this)}function G(){E(k,this,P).call(this)}e.CopyPaste=U},(e,t,r)=>{"use strict";t.__esModule=!0,t.default=function(e){return{key:"copy",name(){return this.getTranslatedPhrase(n.CONTEXTMENU_ITEMS_COPY)},callback(){e.copyCellsOnly()},disabled(){var e;return 0===this.countRows()||0===this.countCols()||!(e=this.getSelectedRangeLast())||!!e.isSingleHeader()||!(e=this.getSelected())||1<e.length},hidden:!1}};var n=r(621)},(e,t,r)=>{"use strict";t.__esModule=!0,t.default=function(e){return{key:"copy_column_headers_only",name(){var e=this.getSelectedRangeLast(),e=e?(0,i.clamp)(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(n.CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY,e)},callback(){e.copyColumnHeadersOnly()},disabled(){var e;return!(this.hasColHeaders()&&(e=this.getSelectedRangeLast())&&!e.isSingleHeader()&&(e=this.getSelected()))||1<e.length},hidden:!1}};var n=r(621),i=r(512)},(e,t,r)=>{"use strict";t.__esModule=!0,t.default=function(e){return{key:"copy_with_column_group_headers",name(){var e=this.getSelectedRangeLast(),e=e?(0,i.clamp)(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(n.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS,e)},callback(){e.copyWithAllColumnHeaders()},disabled(){var e;return!(this.hasColHeaders()&&this.getSettings().nestedHeaders&&(e=this.getSelectedRangeLast())&&!e.isSingleHeader()&&(e=this.getSelected()))||1<e.length},hidden:!1}};var n=r(621),i=r(512)},(e,t,r)=>{"use strict";t.__esModule=!0,t.default=function(e){return{key:"copy_with_column_headers",name(){var e=this.getSelectedRangeLast(),e=e?(0,i.clamp)(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(n.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS,e)},callback(){e.copyWithColumnHeaders()},disabled(){var e;return!(this.hasColHeaders()&&(e=this.getSelectedRangeLast())&&!e.isSingleHeader()&&(e=this.getSelected()))||1<e.length},hidden:!1}};var n=r(621),i=r(512)},(e,t,r)=>{"use strict";t.__esModule=!0,t.default=function(e){return{key:"cut",name(){return this.getTranslatedPhrase(n.CONTEXTMENU_ITEMS_CUT)},callback(){e.cut()},disabled(){var e;return 0===this.countRows()||0===this.countCols()||!(e=this.getSelectedRangeLast())||!!e.isSingleHeader()||!(e=this.getSelected())||1<e.length},hidden:!1}};var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621));function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(897)));t.default=class{constructor(){this.clipboardData=new i.default}preventDefault(){}}},(e,t)=>{"use strict";t.__esModule=!0;t.default=class{constructor(){this.data={}}setData(e,t){this.data[e]=t}getData(e){return this.data[e]||void 0}}},(e,t,r)=>{"use strict";t.__esModule=!0,t.normalizeRanges=function(e){const n=[],i=[];return(0,o.arrayEach)(e,e=>{var t=Math.min(e.startRow,e.endRow),r=Math.max(e.startRow,e.endRow),t=((0,s.rangeEach)(t,r,e=>{-1===n.indexOf(e)&&n.push(e)}),Math.min(e.startCol,e.endCol)),r=Math.max(e.startCol,e.endCol);(0,s.rangeEach)(t,r,e=>{-1===i.indexOf(e)&&i.push(e)})}),{rows:n,columns:i}},r(204),r(286);var o=r(478),s=r(512);function a(e,t,r){l(e,t),t.set(e,r)}function l(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function c(e,t){return e.get(d(e,t))}function u(e,t,r){e.set(d(e,t),r)}function d(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var h=new WeakMap,p=new WeakMap,f=new WeakMap,g=new WeakMap,m=new WeakMap,y=new WeakMap,v=new WeakSet;function b(e,t){return Math.min(t,Math.max(e+c(m,this).call(this)-1,e))}function w(e,t){return Math.min(t,Math.max(e+c(g,this).call(this)-1,e))}t.CopyableRangesFactory=class{constructor(e){var t,r,{countRows:e,countColumns:n,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;l(t=this,r=v),r.add(t),a(this,h,void 0),a(this,p,void 0),a(this,f,void 0),a(this,g,void 0),a(this,m,void 0),a(this,y,void 0),u(p,this,e),u(f,this,n),u(g,this,i),u(m,this,o),u(y,this,s)}setSelectedRange(e){u(h,this,e)}getCellsRange(){var e,t,r,n,i,o;return 0===c(p,this).call(this)||0===c(f,this).call(this)?null:({row:e,col:t}=c(h,this).getTopStartCorner(),{row:r,col:n}=c(h,this).getBottomEndCorner(),i=d(v,this,w).call(this,e,r),o=d(v,this,b).call(this,t,n),{isRangeTrimmed:r!==i||n!==o,startRow:e,startCol:t,endRow:i,endCol:o})}getMostBottomColumnHeadersRange(){var e,t;return 0===c(f,this).call(this)||0===c(y,this).call(this)?null:(e=c(h,this).getTopStartCorner()["col"],t=c(h,this).getBottomEndCorner()["col"],{isRangeTrimmed:t!==(t=d(v,this,b).call(this,e,t)),startRow:-1,startCol:e,endRow:-1,endCol:t})}getAllColumnHeadersRange(){var e,t;return 0===c(f,this).call(this)||0===c(y,this).call(this)?null:(e=c(h,this).getTopStartCorner()["col"],t=c(h,this).getBottomEndCorner()["col"],{isRangeTrimmed:t!==(t=d(v,this,b).call(this,e,t)),startRow:-c(y,this).call(this),startCol:e,endRow:-1,endCol:t})}}},(e,t,r)=>{"use strict";r.r(t)},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(901);t.PLUGIN_KEY=r.PLUGIN_KEY,t.PLUGIN_PRIORITY=r.PLUGIN_PRIORITY,t.CustomBorders=r.CustomBorders},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),r(286),n(r(487))),n=r(813),s=r(482),a=r(512),l=r(478),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=h(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621)),c=r(902),u=r(904),d=r(622);function h(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(h=function(e){return e?r:t})(e))}function p(e,t){var r=e;if(t.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object");t.add(e)}function f(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}const g=t.PLUGIN_KEY="customBorders";t.PLUGIN_PRIORITY=90;var m=new WeakSet;class y extends n.BasePlugin{constructor(){super(...arguments),p(this,m),(0,i.default)(this,"savedBorders",[])}static get PLUGIN_KEY(){return g}static get PLUGIN_PRIORITY(){return 90}isEnabled(){return!!this.hot.getSettings()[g]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>f(m,this,v).call(this,e)),this.addHook("init",()=>f(m,this,b).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,t){let n=["top","bottom","start","end"],i=null;t&&(this.checkSettingsCohesion([t]),n=Object.keys(t),i=(0,u.normalizeBorder)(t));t=(0,d.detectSelectionType)(e);const r=(0,d.normalizeSelectionFactory)(t,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});(0,l.arrayEach)(e,e=>{r(e).forAll((t,r)=>{(0,l.arrayEach)(n,e=>{this.prepareBorderFromCustomAdded(t,r,i,(0,u.toInlinePropName)(e))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;var t=(0,d.detectSelectionType)(e);const r=(0,d.normalizeSelectionFactory)(t,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),n=[];return(0,l.arrayEach)(e,e=>{r(e).forAll((t,r)=>{(0,l.arrayEach)(this.savedBorders,e=>{e.row===t&&e.col===r&&n.push((0,u.denormalizeBorder)(e))})})}),n}clearBorders(e){e?this.setBorders(e):((0,l.arrayEach)(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange(),this.hot.removeCellMeta(e.row,e.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,t){this.checkSavedBorders(e)||this.savedBorders.push(e);var r=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,r,t)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:r})}prepareBorderFromCustomAdded(e,r,n,i){var t=this.hot.countRows(),o=this.hot.countCols();if(!(t<=e||o<=r)){let t=(0,u.createEmptyBorders)(e,r);n&&(t=(0,u.extendDefaultBorder)(t,n),(0,l.arrayEach)(this.hot.selection.highlight.customSelections,e=>{if(t.id===e.settings.id)return Object.assign(e.settings,n),t.id=e.settings.id,t.top=e.settings.top,t.bottom=e.settings.bottom,t.start=e.settings.start,t.end=e.settings.end,!1})),this.hot.setCellMeta(e,r,"borders",(0,u.denormalizeBorder)(t)),this.insertBorderIntoSettings(t,i)}}prepareBorderFromCustomAddedRange(i,o){var e=Math.min(i.to.row,this.hot.countRows()-1);const t=Math.min(i.to.col,this.hot.countCols()-1);(0,a.rangeEach)(i.from.row,e,n=>{(0,a.rangeEach)(i.from.col,t,e=>{var t=(0,u.createEmptyBorders)(n,e);let r=0;n===i.from.row&&(0,s.hasOwnProperty)(o,"top")&&(r+=1,t.top=o.top),n===i.to.row&&(0,s.hasOwnProperty)(o,"bottom")&&(r+=1,t.bottom=o.bottom),e===i.from.col&&(0,s.hasOwnProperty)(o,"start")&&(r+=1,t.start=o.start),e===i.to.col&&(0,s.hasOwnProperty)(o,"end")&&(r+=1,t.end=o.end),0<r&&(this.hot.setCellMeta(n,e,"borders",(0,u.denormalizeBorder)(t)),this.insertBorderIntoSettings(t))})})}removeAllBorders(e,t){var r=(0,u.createId)(e,t);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,t,"borders")}setBorder(e,t,r,n){let i=this.hot.getCellMeta(e,t).borders;i=i&&void 0!==i.border?(0,u.normalizeBorder)(i):(0,u.createEmptyBorders)(e,t),n?(i[r]=(0,u.createSingleEmptyBorder)(),4===this.countHide(i)?this.removeAllBorders(e,t):(this.checkCustomSelectionsFromContextMenu(i,r,n)||this.insertBorderIntoSettings(i),this.hot.setCellMeta(e,t,"borders",(0,u.denormalizeBorder)(i)))):(i[r]=(0,u.createDefaultCustomBorder)(),this.checkCustomSelectionsFromContextMenu(i,r,n)||this.insertBorderIntoSettings(i),this.hot.setCellMeta(e,t,"borders",(0,u.denormalizeBorder)(i)))}prepareBorder(e,t,i){(0,l.arrayEach)(e,e=>{let{start:r,end:n}=e;if(r.row===n.row&&r.col===n.col)"noBorders"===t?this.removeAllBorders(r.row,r.col):this.setBorder(r.row,r.col,t,i);else switch(t){case"noBorders":(0,a.rangeEach)(r.col,n.col,t=>{(0,a.rangeEach)(r.row,n.row,e=>{this.removeAllBorders(e,t)})});break;case"top":(0,a.rangeEach)(r.col,n.col,e=>{this.setBorder(r.row,e,t,i)});break;case"bottom":(0,a.rangeEach)(r.col,n.col,e=>{this.setBorder(n.row,e,t,i)});break;case"start":(0,a.rangeEach)(r.row,n.row,e=>{this.setBorder(e,r.col,t,i)});break;case"end":(0,a.rangeEach)(r.row,n.row,e=>{this.setBorder(e,n.col,t,i)})}})}createCustomBorders(e){(0,l.arrayEach)(e,e=>{var t=(0,u.normalizeBorder)(e);e.range?this.prepareBorderFromCustomAddedRange(e.range,t):this.prepareBorderFromCustomAdded(e.row,e.col,t)})}countHide(e){var{top:e,bottom:t,start:r,end:n}=e;return(0,l.arrayReduce)([e,t,r,n],(e,t)=>{let r=e;return t&&t.hide&&(r+=1),r},0)}clearBordersFromSelectionSettings(e){e=(0,l.arrayMap)(this.hot.selection.highlight.customSelections,e=>e.settings.id).indexOf(e);-1<e&&this.hot.selection.highlight.customSelections[e].clear()}clearNullCellRange(){(0,l.arrayEach)(this.hot.selection.highlight.customSelections,(e,t)=>{if(null===e.cellRange)return this.hot.selection.highlight.customSelections[t].destroy(),this.hot.selection.highlight.customSelections.splice(t,1),!1})}hideBorders(){(0,l.arrayEach)(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){e=(0,l.arrayMap)(this.savedBorders,e=>e.id).indexOf(e);-1<e&&this.savedBorders.splice(e,1)}checkSavedBorders(r){let n=!1;return 4===this.countHide(r)?(this.spliceBorder(r.id),n=!0):(0,l.arrayEach)(this.savedBorders,(e,t)=>{if(r.id===e.id)return this.savedBorders[t]=r,!(n=!0)}),n}checkCustomSelectionsFromContextMenu(t,r,n){let i=!1;return(0,l.arrayEach)(this.hot.selection.highlight.customSelections,e=>{if(t.id===e.settings.id)return e=this.hot.view._wt.selectionManager.getBorderInstances(e),(0,l.arrayEach)(e,e=>{e.toggleHiddenClass(r,n)}),!(i=!0)}),i}checkCustomSelections(t,r,n){var e=this.countHide(t);let i=!1;return 4===e?(this.removeAllBorders(t.row,t.col),i=!0):(0,l.arrayEach)(this.hot.selection.highlight.customSelections,e=>{if(t.id===e.settings.id)return e.visualCellRange=r,e.commit(),n&&(e=this.hot.view._wt.selectionManager.getBorderInstances(e),(0,l.arrayEach)(e,e=>{e.changeBorderStyle(n,t)})),!(i=!0)}),i}changeBorderSettings(){var e,t=this.hot.getSettings()[g];Array.isArray(t)?(e=(0,s.deepClone)(t),this.checkSettingsCohesion(e),e.length||(this.savedBorders=e),this.createCustomBorders(e)):void 0!==t&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){var t=(0,u.hasLeftRightTypeOptions)(e),e=(0,u.hasStartEndTypeOptions)(e);if(t&&e)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&t)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function v(e){this.hot.getSettings()[g]&&e.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_BORDERS)},disabled(){var e=this.getSelectedRangeLast();return!e||!!e.isSingleHeader()||this.selection.isSelectedByCorner()},submenu:{items:[(0,c.top)(this),(0,c.right)(this),(0,c.bottom)(this),(0,c.left)(this),(0,c.noBorders)(this)]}})}function b(){this.changeBorderSettings()}t.CustomBorders=y},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(903))),i=(t.bottom=i.default,n(r(905))),i=(t.left=i.default,n(r(906))),i=(t.noBorders=i.default,n(r(907))),i=(t.right=i.default,n(r(908)));t.top=i.default},(e,t,r)=>{"use strict";t.__esModule=!0,t.default=function(n){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_BORDERS_BOTTOM);var t=(0,o.checkSelectionBorders)(this,"bottom");return e=t?(0,o.markSelected)(e):e},callback(e,t){var r=(0,o.checkSelectionBorders)(this,"bottom");n.prepareBorder(t,"bottom",r)}}};var i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621)),o=r(904);function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}},(e,t,r)=>{"use strict";t.__esModule=!0,t.checkSelectionBorders=function(r,n){let i=!1;return(0,s.arrayEach)(r.getSelectedRange(),e=>{e.forAll((e,t)=>{return e<0||t<0||!(e=r.getCellMeta(e,t).borders)||n&&(0,o.hasOwnProperty)(e[n],"hide")&&!1!==e[n].hide?void 0:!(i=!0)})}),i},t.createDefaultCustomBorder=a,t.createDefaultHtBorder=c,t.createEmptyBorders=function(e,t){return{id:i(e,t),border:c(),row:e,col:t,top:l(),bottom:l(),start:l(),end:l()}},t.createId=i,t.createSingleEmptyBorder=l,t.denormalizeBorder=function(e){(0,n.isDefined)(e.start)&&(e.left=e.start);(0,n.isDefined)(e.end)&&(e.right=e.end);return e},t.extendDefaultBorder=function(e,t){(0,o.hasOwnProperty)(t,"border")&&t.border&&(e.border=t.border);(0,o.hasOwnProperty)(t,"top")&&(0,n.isDefined)(t.top)&&(t.top?(0,o.isObject)(t.top)||(t.top=a()):t.top=l(),e.top=t.top);(0,o.hasOwnProperty)(t,"bottom")&&(0,n.isDefined)(t.bottom)&&(t.bottom?(0,o.isObject)(t.bottom)||(t.bottom=a()):t.bottom=l(),e.bottom=t.bottom);(0,o.hasOwnProperty)(t,"start")&&(0,n.isDefined)(t.start)&&(t.start?(0,o.isObject)(t.start)||(t.start=a()):t.start=l(),e.start=t.start);(0,o.hasOwnProperty)(t,"end")&&(0,n.isDefined)(t.end)&&(t.end?(0,o.isObject)(t.end)||(t.end=a()):t.end=l(),e.end=t.end);return e},t.hasLeftRightTypeOptions=function(e){return e.some(e=>(0,n.isDefined)(e.left)||(0,n.isDefined)(e.right))},t.hasStartEndTypeOptions=function(e){return e.some(e=>(0,n.isDefined)(e.start)||(0,n.isDefined)(e.end))},t.markSelected=function(e){return`<span class="selected">${String.fromCharCode(10003)}</span>`+e},t.normalizeBorder=function(e){var t;((0,n.isDefined)(e.start)||(0,n.isDefined)(e.left))&&(e.start=null!=(t=e.start)?t:e.left);((0,n.isDefined)(e.end)||(0,n.isDefined)(e.right))&&(e.end=null!=(t=e.end)?t:e.right);return delete e.left,delete e.right,e},t.toInlinePropName=function(e){var t;return null!=(t=u.get(e))?t:e};var o=r(482),n=r(337),s=r(478);function i(e,t){return`border_row${e}col`+t}function a(){return{width:1,color:"#000"}}function l(){return{hide:!0}}function c(){return{width:1,color:"#000",cornerVisible:!1}}const u=new Map([["left","start"],["right","end"]])},(e,t,r)=>{"use strict";t.__esModule=!0,t.default=function(n){const i=n.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let e=this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_BORDERS_LEFT);var t=(0,s.checkSelectionBorders)(this,i);return e=t?(0,s.markSelected)(e):e},callback(e,t){var r=(0,s.checkSelectionBorders)(this,i);n.prepareBorder(t,i,r)}}};var o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=a(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621)),s=r(904);function a(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(a=function(e){return e?r:t})(e))}},(e,t,r)=>{"use strict";t.__esModule=!0,t.default=function(r){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(n.CONTEXTMENU_ITEMS_REMOVE_BORDERS)},callback(e,t){r.prepareBorder(t,"noBorders")},disabled(){return!(0,i.checkSelectionBorders)(this)}}};var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621)),i=r(904);function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}},(e,t,r)=>{"use strict";t.__esModule=!0,t.default=function(n){const i=n.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let e=this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_BORDERS_RIGHT);var t=(0,s.checkSelectionBorders)(this,i);return e=t?(0,s.markSelected)(e):e},callback(e,t){var r=(0,s.checkSelectionBorders)(this,i);n.prepareBorder(t,i,r)}}};var o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=a(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621)),s=r(904);function a(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(a=function(e){return e?r:t})(e))}},(e,t,r)=>{"use strict";t.__esModule=!0,t.default=function(n){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_BORDERS_TOP);var t=(0,o.checkSelectionBorders)(this,"top");return e=t?(0,o.markSelected)(e):e},callback(e,t){var r=(0,o.checkSelectionBorders)(this,"top");n.prepareBorder(t,"top",r)}}};var i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621)),o=r(904);function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(910);t.PLUGIN_KEY=r.PLUGIN_KEY,t.PLUGIN_PRIORITY=r.PLUGIN_PRIORITY,t.DragToScroll=r.DragToScroll},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),n(r(487))),n=r(813),o=r(492),s=r(334);function a(e,t){var r=e;if(t.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object");t.add(e)}function l(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}const c=t.PLUGIN_KEY="dragToScroll";t.PLUGIN_PRIORITY=100;var u=new WeakSet;class d extends n.BasePlugin{constructor(){super(...arguments),a(this,u),(0,i.default)(this,"boundaries",null),(0,i.default)(this,"callback",null),(0,i.default)(this,"listening",!1)}static get PLUGIN_KEY(){return c}static get PLUGIN_PRIORITY(){return 100}isEnabled(){return!!this.hot.getSettings()[c]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>l(u,this,h).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>l(u,this,h).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,t){let r=0,n=0;t<this.boundaries.top?n=t-this.boundaries.top:t>this.boundaries.bottom&&(n=t-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,n)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){var e=this.hot["rootWindow"];let t=e;for(;t;)this.eventManager.addEventListener(t.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mousemove",e=>this.onMouseMove(e)),t=(0,s.getParentWindow)(t)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function h(e){if(!(0,o.isRightClick)(e)){const i=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(i!==this.hot.rootWindow?i.getBoundingClientRect():void 0),this.setCallback((e,t)=>{var r=null!=(r=i.scrollLeft)?r:i.scrollX,n=null!=(n=i.scrollTop)?n:i.scrollY;i.scroll(r+50*Math.sign(e),n+20*Math.sign(t))}),this.listen()}}t.DragToScroll=d},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(912);t.PLUGIN_KEY=r.PLUGIN_KEY,t.PLUGIN_PRIORITY=r.PLUGIN_PRIORITY,t.DropdownMenu=r.DropdownMenu},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),n(r(487))),o=r(813),s=r(478),a=r(482),l=r(874),c=r(855),u=r(334),d=r(877),h=r(878),n=n(r(494)),p=r(853),f=(r(913),r(479));function g(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function m(e,t,r){e.set(y(e,t),r)}function y(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}n.default.getSingleton().register("afterDropdownMenuDefaultOptions"),n.default.getSingleton().register("beforeDropdownMenuShow"),n.default.getSingleton().register("afterDropdownMenuShow"),n.default.getSingleton().register("afterDropdownMenuHide"),n.default.getSingleton().register("afterDropdownMenuExecute");const v=t.PLUGIN_KEY="dropdownMenu",b=(t.PLUGIN_PRIORITY=230,"changeType"),w=v;var C=new WeakMap,E=new WeakSet;class T extends o.BasePlugin{static get PLUGIN_KEY(){return v}static get PLUGIN_PRIORITY(){return 230}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[p.COLUMN_LEFT,p.COLUMN_RIGHT,p.SEPARATOR,p.REMOVE_COLUMN,p.SEPARATOR,p.CLEAR_COLUMN,p.SEPARATOR,p.READ_ONLY,p.SEPARATOR,p.ALIGNMENT]}constructor(e){var t,r;super(e),g(e=this,r=E),r.add(e),(0,i.default)(this,"commandExecutor",new l.CommandExecutor(this.hot)),(0,i.default)(this,"itemsFactory",null),(0,i.default)(this,"menu",null),r=!1,g(e=this,t=C),t.set(e,r),this.hot.addHook("afterGetColHeader",(e,t)=>y(E,this,x).call(this,e,t))}isEnabled(){return this.hot.getSettings()[v]}enablePlugin(){var n=this;if(!this.enabled){this.itemsFactory=new d.ItemsFactory(this.hot,T.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return y(E,n,M).call(n,...t)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return y(E,n,I).call(n,...t)});const t=this.hot.getSettings()[v],r={items:this.itemsFactory.getItems(t)};this.registerEvents(),"function"==typeof t.callback&&this.commandExecutor.setCommonCallback(t.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);var e=this.itemsFactory.getItems(t);this.menu&&this.menu.destroy(),this.menu=new h.Menu(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",e),this.menu.setMenuItems(e),this.menu.addLocalHook("beforeOpen",()=>y(E,this,R).call(this)),this.menu.addLocalHook("afterOpen",()=>y(E,this,A).call(this)),this.menu.addLocalHook("afterSubmenuOpen",e=>y(E,this,N).call(this,e)),this.menu.addLocalHook("afterClose",()=>y(E,this,O).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.executeCommand.call(n,...t)}),(0,s.arrayEach)(e,e=>this.commandExecutor.registerCommand(e.key,e))})}}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){var e=()=>{var e,t,r=this.hot.getSelectedRangeLast()["highlight"];(r.isHeader()&&-1===r.row||r.isCell())&&0<=r.col&&(this.hot.selectColumns(r.col,r.col,-1),r=this.hot.getSelectedRangeLast()["from"],e=(0,c.getDocumentOffsetByElement)(this.menu.container,this.hot.rootDocument),t=(r=this.hot.getCell(-1,r.col,!0)).getBoundingClientRect(),this.open({left:t.left+e.left,top:t.top+r.offsetHeight+e.top},{left:t.width}),this.menu.getNavigator().toFirstItem())};this.hot.getShortcutManager().getContext("grid").addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:e,runOnlyIf:()=>{var e=null==(e=this.hot.getSelectedRangeLast())?void 0:e.highlight;return e&&this.hot.selection.isCellVisible(e)&&e.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:w},{keys:[["Shift","Alt","ArrowDown"]],callback:e,runOnlyIf:()=>{var e=null==(e=this.hot.getSelectedRangeLast())?void 0:e.highlight;return e&&this.hot.selection.isCellVisible(e)&&e.isCell()&&!this.menu.isOpened()},group:w}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(w)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>y(E,this,_).call(this,e))}open(e){var t,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};null!=(t=this.menu)&&t.isOpened()||(this.menu.open(),(0,a.objectEach)(r,(e,t)=>{this.menu.setOffset(t,e)}),this.menu.setPosition(e))}close(){var e;null!=(e=this.menu)&&e.close()}executeCommand(e){for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];this.commandExecutor.execute(e,...r)}setListening(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function S(e){e.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function _(e){var t,r;(0,u.hasClass)(e.target,b)&&(t=(0,c.getDocumentOffsetByElement)(this.menu.container,this.hot.rootDocument),r=e.target.getBoundingClientRect(),e.stopPropagation(),m(C,this,!1),this.open({left:r.left+t.left,top:r.top+e.target.offsetHeight+3+t.top},{left:r.width}))}function x(e,t){var r,n=t.parentNode;n&&(r=n.parentNode.childNodes,n=Array.prototype.indexOf.call(r,n),e<0||n!==r.length-1||(e=t.querySelector("."+b),this.enabled&&e)||(this.enabled?((n=this.hot.rootDocument.createElement("button")).className=b,n.type="button",n.tabIndex=-1,this.hot.getSettings().ariaTags&&((0,u.setAttribute)(n,[(0,f.A11Y_HIDDEN)(),(0,f.A11Y_LABEL)(" ")]),(0,u.setAttribute)(t,[(0,f.A11Y_HASPOPUP)("menu")])),n.onclick=function(){return!1},t.firstChild.insertBefore(n,t.firstChild.firstChild)):e&&e.parentNode.removeChild(e)))}function R(){this.hot.runHooks("beforeDropdownMenuShow",this)}function A(){this.hot.runHooks("afterDropdownMenuShow",this),y(E,this,S).call(this,this.menu)}function N(e){y(E,this,S).call(this,e)}function O(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function I(e){return t=this,C.get(y(C,t))?null:e;var t}function M(e){(0,u.hasClass)(e.target,b)&&m(C,this,!0)}(t.DropdownMenu=T).SEPARATOR={name:p.SEPARATOR}},(e,t,r)=>{"use strict";r.r(t)},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(915);t.PLUGIN_KEY=r.PLUGIN_KEY,t.PLUGIN_PRIORITY=r.PLUGIN_PRIORITY,t.ExportFile=r.ExportFile},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),r(813)),o=n(r(916)),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=a(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(917));function a(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(a=function(e){return e?r:t})(e))}t.PLUGIN_KEY="exportFile",t.PLUGIN_PRIORITY=240;class l extends i.BasePlugin{static get PLUGIN_KEY(){return"exportFile"}static get PLUGIN_PRIORITY(){return 240}isEnabled(){return!0}exportAsString(e){return this._createTypeFormatter(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).export()}exportAsBlob(e){return this._createBlob(this._createTypeFormatter(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}))}downloadFile(e){var{rootDocument:t,rootWindow:r}=this.hot,e=this._createTypeFormatter(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}),n=this._createBlob(e);const i=r.URL||r.webkitURL;r=t.createElement("a"),e=e.options.filename+"."+e.options.fileExtension;if(void 0!==r.download){const o=i.createObjectURL(n);r.style.display="none",r.setAttribute("href",o),r.setAttribute("download",e),t.body.appendChild(r),r.dispatchEvent(new MouseEvent("click")),t.body.removeChild(r),setTimeout(()=>{i.revokeObjectURL(o)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(n,e)}_createTypeFormatter(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(s.EXPORT_TYPES[e])return(0,s.default)(e,new o.default(this.hot),t);throw new Error(`Export format type "${e}" is not supported.`)}_createBlob(e){let t=null;return t="undefined"!=typeof Blob?new Blob([e.export()],{type:e.options.mimeType+";charset="+e.options.encoding}):t}}t.ExportFile=l},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(286),n(r(487))),a=r(512);t.default=class{constructor(e){(0,i.default)(this,"hot",void 0),(0,i.default)(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:t,endCol:i}=this._getDataRange(),o=this.options,s=[];return(0,a.rangeEach)(e,t,t=>{const r=[];!o.exportHiddenRows&&this._isHiddenRow(t)||((0,a.rangeEach)(n,i,e=>{!o.exportHiddenColumns&&this._isHiddenColumn(e)||r.push(this.hot.getDataAtCell(t,e))}),s.push(r))}),s}getRowHeaders(){const t=[];if(this.options.rowHeaders){var{startRow:e,endRow:r}=this._getDataRange();const n=this.hot.getRowHeader();(0,a.rangeEach)(e,r,e=>{!this.options.exportHiddenRows&&this._isHiddenRow(e)||t.push(n[e])})}return t}getColumnHeaders(){const t=[];if(this.options.columnHeaders){var{startCol:e,endCol:r}=this._getDataRange();const n=this.hot.getColHeader();(0,a.rangeEach)(e,r,e=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(e)||t.push(n[e])})}return t}_getDataRange(){var e=this.hot.countCols()-1,t=this.hot.countRows()-1,[r=0,n=0,i=t,o=e]=this.options.range;return{startRow:Math.max(r,0),startCol:Math.max(n,0),endRow:Math.min(i,t),endCol:Math.min(o,e)}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}},(e,t,r)=>{"use strict";var n=r(197),n=(t.__esModule=!0,t.default=function(e,t,r){return"function"!=typeof i[e]?null:new i[e](t,r)},n(r(918)));t.TYPE_CSV="csv",t.TYPE_EXCEL="excel",t.TYPE_PDF="pdf";const i=t.EXPORT_TYPES={csv:n.default}},(e,t,r)=>{"use strict";var n=r(197),a=(t.__esModule=!0,r(478)),i=r(337),n=n(r(919));const o=String.fromCharCode(13),s=String.fromCharCode(34),l=String.fromCharCode(10);class c extends n.default{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:"\r\n"}}export(){const r=this.options;var e=this.dataProvider.getData(),t=this.dataProvider.getColumnHeaders(),n=0<t.length;const i=this.dataProvider.getRowHeaders(),o=0<i.length;let s=r.bom?String.fromCharCode(65279):"";return n&&(t=(0,a.arrayMap)(t,e=>this._escapeCell(e,!0)),o&&(s+=r.columnDelimiter),s=(s+=t.join(r.columnDelimiter))+r.rowDelimiter),(0,a.arrayEach)(e,(e,t)=>{0<t&&(s+=r.rowDelimiter),o&&(s+=this._escapeCell(i[t])+r.columnDelimiter),s+=e.map(e=>this._escapeCell(e)).join(r.columnDelimiter)}),s}_escapeCell(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];let r=(0,i.stringify)(e);return r=""!==r&&(t||0<=r.indexOf(o)||0<=r.indexOf(s)||0<=r.indexOf(l)||0<=r.indexOf(this.options.columnDelimiter))?`"${r=r.replace(new RegExp('"',"g"),'""')}"`:r}}t.default=c},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(487))),o=r(482),s=r(335);t.default=class a{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,t){(0,i.default)(this,"dataProvider",void 0),(0,i.default)(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(t),this.dataProvider.setOptions(this.options)}_mergeOptions(e){var t=(0,o.clone)(this.constructor.DEFAULT_OPTIONS),r=new Date,t=(0,o.extend)((0,o.clone)(a.DEFAULT_OPTIONS),t);return(t=(0,o.extend)(t,e)).filename=(0,s.substitute)(t.filename,{YYYY:r.getFullYear(),MM:(""+(r.getMonth()+1)).padStart(2,"0"),DD:(""+r.getDate()).padStart(2,"0")}),t}}},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(921);t.PLUGIN_KEY=r.PLUGIN_KEY,t.PLUGIN_PRIORITY=r.PLUGIN_PRIORITY,t.Filters=r.Filters},(L,e,t)=>{"use strict";var r=t(197),n=(e.__esModule=!0,t(204),t(286),t(582),r(t(487))),i=t(813),s=t(478),o=t(477),a=t(500),l=t(512),c=t(334),u=t(491),d=t(853),h=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=S(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(t(621)),p=t(922),f=t(957),g=t(959),m=t(962),y=r(t(963)),v=r(t(964)),b=r(t(965)),w=t(947),C=t(966),E=t(924),T=t(597);function S(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(S=function(e){return e?r:t})(e))}function _(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function x(e,t){return e.get(R(e,t))}function R(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}t(968);const A=e.PLUGIN_KEY="filters";e.PLUGIN_PRIORITY=250,A;var N=new WeakMap,O=new WeakSet;class I extends i.BasePlugin{static get PLUGIN_KEY(){return A}static get PLUGIN_PRIORITY(){return 250}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){var t,r;super(e),_(e=this,r=O),r.add(e),(0,n.default)(this,"dropdownMenuPlugin",null),(0,n.default)(this,"conditionCollection",null),(0,n.default)(this,"conditionUpdateObserver",null),(0,n.default)(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),(0,n.default)(this,"filtersRowsMap",null),r=void 0,_(e=this,t=N),t.set(e,r),this.hot.addHook("afterGetColHeader",(e,t)=>R(O,this,V).call(this,e,t))}isEnabled(){return!!this.hot.getSettings()[A]}enablePlugin(){if(!this.enabled){this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new T.TrimmingMap),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var e=this.hot.getSettings().dropdownMenu,e=e&&e.uiContainer||this.hot.rootDocument.body,t=t=>(t.addLocalHook("accept",()=>R(O,this,D).call(this,"accept")),t.addLocalHook("cancel",()=>R(O,this,D).call(this,"cancel")),t.addLocalHook("change",e=>R(O,this,U).call(this,t,e)),t),r=()=>this.hot.getTranslatedPhrase(h.FILTERS_DIVS_FILTER_BY_CONDITION)+":",n=()=>this.hot.getTranslatedPhrase(h.FILTERS_DIVS_FILTER_BY_VALUE)+":";if(this.components.get("filter_by_condition")||((r=new p.ConditionComponent(this.hot,{id:"filter_by_condition",name:r,addSeparator:!1,menuContainer:e})).addLocalHook("afterClose",()=>R(O,this,P).call(this)),this.components.set("filter_by_condition",t(r))),this.components.get("filter_operators")||this.components.set("filter_operators",new f.OperatorsComponent(this.hot,{id:"filter_operators",name:"Operators"})),this.components.get("filter_by_condition2")||((r=new p.ConditionComponent(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:e})).addLocalHook("afterClose",()=>R(O,this,P).call(this)),this.components.set("filter_by_condition2",t(r))),this.components.get("filter_by_value")||this.components.set("filter_by_value",t(new g.ValueComponent(this.hot,{id:"filter_by_value",name:n}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",t(new m.ActionBarComponent(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new y.default(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new b.default(this.hot,this.conditionCollection,e=>this.getDataMapAtColumn(e)),this.conditionUpdateObserver.addLocalHook("update",e=>R(O,this,W).call(this,e))),this.components.forEach(e=>e.show()),this.addHook("afterDropdownMenuDefaultOptions",e=>R(O,this,H).call(this,e)),this.addHook("afterDropdownMenuShow",()=>R(O,this,k).call(this)),this.addHook("afterDropdownMenuHide",()=>R(O,this,F).call(this)),this.addHook("afterChange",e=>R(O,this,M).call(this,e)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!x(N,this)&&this.dropdownMenuPlugin.enabled){const i=this.dropdownMenuPlugin.menu;e=[{focus:()=>{var e=i.getNavigator(),t=x(N,this).getLastMenuPage();i.focus(),0<t?e.setCurrentPage(t):e.toFirstItem()}},...Array.from(this.components).map(e=>{var[,e]=e;return e.getElements()}).flat()],e=(r=N,n=this,t=(0,C.createMenuFocusController)(i,e),r.set(R(r,n),t),e=>{x(N,this).listen(),e.preventDefault(),(0,u.isKey)(e.keyCode,"TAB")&&(e.shiftKey?x(N,this).toPreviousItem():x(N,this).toNextItem())});this.components.get("filter_by_value").addLocalHook("listTabKeydown",e),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",e)}this.registerShortcuts(),super.enablePlugin()}}disablePlugin(){var e;this.enabled&&(null!=(e=this.dropdownMenuPlugin)&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((e,t)=>{e.destroy(),this.components.set(t,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{var e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:"filters"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup("filters")}addCondition(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:E.OPERATION_AND,e=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(e,{command:{key:t},args:r},n)}removeConditions(e){e=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(e)}clearConditions(e){void 0===e?this.conditionCollection.clean():(e=this.hot.toPhysicalColumn(e),this.conditionCollection.removeConditions(e))}filter(){var e=this.hot.getSettings()["navigableHeaders"];const r=this._createDataFilter();var t=!this.conditionCollection.isEmpty();let n=[];var i=this.conditionCollection.exportAllConditions();if(!1!==this.hot.runHooks("beforeFilter",i))if(t){const o=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),n=(0,s.arrayMap)(r.filter(),e=>e.meta.visualRow);const t=(0,w.createArrayAssertion)(n);(0,l.rangeEach)(this.hot.countSourceRows()-1,e=>{t(e)||o.push(e)}),(0,s.arrayEach)(o,e=>{this.filtersRowsMap.setValueAtIndex(e,!0)})},!0),e||n.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",i),this.hot.view.adjustElementsSize(),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var e=null==(e=this.hot.getSelectedRangeLast())?void 0:e.highlight;return e?{visualIndex:e.col,physicalIndex:this.hot.toPhysicalColumn(e.col)}:null}getDataMapAtColumn(e){const u=this.hot.toVisualColumn(e),d=[];return(0,s.arrayEach)(this.hot.getSourceDataAtCol(u),(e,t)=>{var{row:r,col:n,visualCol:i,visualRow:o,type:s,instance:a,dateFormat:l,locale:c}=this.hot.getCellMeta(t,u),t=null!=(t=this.hot.getDataAtCell(this.hot.toVisualRow(t),u))?t:e;d.push({meta:{row:r,col:n,visualCol:i,visualRow:o,type:s,instance:a,dateFormat:l,locale:c},value:(0,w.toEmptyString)(t)})}),d}updateValueComponentCondition(e){var t=this.hot.getDataAtCol(e),t=(0,w.unifyColumnValues)(t);this.conditionUpdateObserver.updateStatesAtColumn(e,t)}restoreComponents(e){var t;const r=null==(t=this.getSelectedColumn())?void 0:t.physicalIndex;e.forEach(e=>{e.isHidden()||e.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,t,r,n){let i=e;return i===E.OPERATION_OR&&t.command.key!==E.CONDITION_NONE&&r.command.key!==E.CONDITION_NONE&&n.command.key!==E.CONDITION_NONE?i=E.OPERATION_OR_THEN_VARIABLE:n.command.key===E.CONDITION_NONE||t.command.key!==E.CONDITION_NONE&&r.command.key!==E.CONDITION_NONE||(i=E.OPERATION_AND),i}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){var e=this.components.get("filter_by_condition").getState()["command"],t=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];e.showOperators?this.showComponents(...t):this.hideComponents(...t)}_createDataFilter(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.conditionCollection;return new v.default(e,e=>this.getDataMapAtColumn(e))}getIndexesOfComponents(){const n=[];if(this.dropdownMenuPlugin){const i=this.dropdownMenuPlugin.menu;for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];(0,s.arrayEach)(t,r=>{(0,s.arrayEach)(i.menuItems,(e,t)=>{e.key===r.getMenuItemDescriptor().key&&n.push(t)})})}return n}changeComponentsVisibility(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];if(this.dropdownMenuPlugin){for(var t=this.dropdownMenuPlugin.menu.hotMenu,r=t.getPlugin("hiddenRows"),n=arguments.length,i=new Array(1<n?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];var s=this.getIndexesOfComponents(...i);e?r.showRows(s):r.hideRows(s),t.render()}}hideComponents(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.changeComponentsVisibility(!1,...t)}showComponents(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.changeComponentsVisibility(!0,...t)}destroy(){this.enabled&&(this.components.forEach((e,t)=>{null!==e&&(e.destroy(),this.components.set(t,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function M(e){e&&(0,s.arrayEach)(e,e=>{var[,e]=e,e=this.hot.propToCol(e);this.conditionCollection.hasConditions(e)&&this.updateValueComponentCondition(e)})}function k(){this.restoreComponents(Array.from(this.components.values()))}function F(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function H(t){t.items.push({name:d.SEPARATOR}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function D(t){if("accept"===t){t=this.getSelectedColumn();if(null===t)return void(null!=(r=this.dropdownMenuPlugin)&&r.close());const o=t["physicalIndex"];var r=this.components.get("filter_by_condition").getState(),t=this.components.get("filter_by_condition2").getState(),n=this.components.get("filter_by_value").getState(),i=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),r,t,n);this.conditionUpdateObserver.groupChanges();let e=this.conditionCollection.getColumnStackPosition(o);-1===e&&(e=void 0),this.conditionCollection.removeConditions(o),r.command.key!==E.CONDITION_NONE&&(this.conditionCollection.addCondition(o,r,i,e),t.command.key!==E.CONDITION_NONE)&&this.conditionCollection.addCondition(o,t,i,e),n.command.key!==E.CONDITION_NONE&&this.conditionCollection.addCondition(o,n,i,e),this.conditionUpdateObserver.flush(),this.components.forEach(e=>e.saveState(o)),this.filtersRowsMap.clear(),this.filter()}null!=(r=this.dropdownMenuPlugin)&&r.close()}function U(e,t){this.updateDependentComponentsVisibility(),e.constructor!==p.ConditionComponent||t.inputsCount||this.setListeningDropdownMenu()}function P(){this.setListeningDropdownMenu()}function V(e,t){e=this.hot.toPhysicalColumn(e);(this.enabled&&this.conditionCollection.hasConditions(e)?(0,c.addClass):(0,c.removeClass))(t,"htFiltersActive")}function W(e){var t,r,n;null!=(r=this.dropdownMenuPlugin)&&r.enabled&&({conditions:r,column:t}=e["editedConditionStack"],n=r.filter(e=>e.name===E.CONDITION_BY_VALUE),r=r.filter(e=>e.name!==E.CONDITION_BY_VALUE),2<=n.length||3<=r.length?(0,a.warn)((0,o.toSingleLine)`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`):(n=this.conditionCollection.getOperation(t),this.components.get("filter_by_condition").updateState(r[0],t),this.components.get("filter_by_condition2").updateState(r[1],t),this.components.get("filter_operators").updateState(n,t),this.components.get("filter_by_value").updateState(e)))}e.Filters=I},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),r(286),n(r(487))),a=r(334),o=r(492),l=r(478),s=r(491),c=r(482),u=m(r(621)),n=r(923),d=m(r(924)),h=r(954),p=r(956),f=r(925);function g(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(g=function(e){return e?r:t})(e))}function m(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=g(t);if(t&&t.has(e))return t.get(e);var r,n,i={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e)"default"!==r&&{}.hasOwnProperty.call(e,r)&&((n=o?Object.getOwnPropertyDescriptor(e,r):null)&&(n.get||n.set)?Object.defineProperty(i,r,n):i[r]=e[r]);return i.default=e,t&&t.set(e,i),i}function y(e,t){var r=e;if(t.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object");t.add(e)}function v(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var b=new WeakSet;class w extends n.BaseComponent{constructor(e,t){super(e,{id:t.id,stateless:!1}),y(this,b),(0,i.default)(this,"name",""),(0,i.default)(this,"addSeparator",!1),this.name=t.name,this.addSeparator=t.addSeparator,this.elements.push(new p.SelectUI(this.hot,{menuContainer:t.menuContainer})),this.elements.push(new h.InputUI(this.hot,{placeholder:u.FILTERS_BUTTONS_PLACEHOLDER_VALUE})),this.elements.push(new h.InputUI(this.hot,{placeholder:u.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>v(b,this,C).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),(0,l.arrayEach)(this.getInputElements(),e=>{e.addLocalHook("keydown",e=>v(b,this,E).call(this,e))})}setState(e){if(this.reset(),e){const n=(0,c.clone)(e.command);n.name.startsWith(u.FILTERS_CONDITIONS_NAMESPACE)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),(0,l.arrayEach)(e.args,(e,t)=>{if(t>n.inputsCount-1)return!1;const r=this.getInputElement(t);r.setValue(e),r[n.inputsCount>t?"show":"hide"](),t||this.hot._registerTimeout(()=>r.focus(),10)})}}getState(){const r=this.getSelectElement().getValue()||(0,f.getConditionDescriptor)(d.CONDITION_NONE),n=[];return(0,l.arrayEach)(this.getInputElements(),(e,t)=>{r.inputsCount>t&&n.push(e.getValue())}),{command:r,args:n}}updateState(e,t){var r=e?(0,f.getConditionDescriptor)(e.name):(0,f.getConditionDescriptor)(d.CONDITION_NONE);this.state.setValueAtIndex(t,{command:r,args:e?e.args:[]}),e||(0,l.arrayEach)(this.getInputElements(),e=>e.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof p.SelectUI)[0]}getInputElement(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof h.InputUI)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,r,n,i,o)=>{(0,a.addClass)(t.parentNode,"htFiltersMenuCondition"),this.addSeparator&&(0,a.addClass)(t.parentNode,"border");var s=this.hot.rootDocument.createElement("div");return(0,a.addClass)(s,"htFiltersMenuLabel"),s.textContent=o,t.appendChild(s),(0,l.arrayEach)(this.elements,e=>t.appendChild(e.element)),t}}}reset(){var e=this.hot.getPlugin("filters").getSelectedColumn();let t=[(0,f.getConditionDescriptor)(d.CONDITION_NONE)];null!==e&&(e=e["visualIndex"],t=(0,d.default)(this.hot.getDataType(0,e,this.hot.countRows(),e))),(0,l.arrayEach)(this.getInputElements(),e=>e.hide()),this.getSelectElement().setItems(t),super.reset(),this.getSelectElement().setValue(t[0])}}function C(r){(0,l.arrayEach)(this.getInputElements(),(e,t)=>{e[r.inputsCount>t?"show":"hide"](),0===t&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",r)}function E(e){(0,s.isKey)(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),(0,o.stopImmediatePropagation)(e))}t.ConditionComponent=w},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),n(r(487))),o=r(478),s=r(482),n=n(r(578)),a=r(597);class l{constructor(e,t){var{id:t,stateless:r=!0}=t;(0,i.default)(this,"hot",void 0),(0,i.default)(this,"id",void 0),(0,i.default)(this,"elements",[]),(0,i.default)(this,"hidden",!1),(0,i.default)(this,"stateId",""),(0,i.default)(this,"state",void 0),this.hot=e,this.id=t,this.stateId="Filters.component."+this.id,this.state=r?null:this.hot.columnIndexMapper.registerMap(this.stateId,new a.LinkedPhysicalIndexToValueMap)}getElements(){return this.elements}reset(){(0,o.arrayEach)(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return null===this.hot||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),(0,o.arrayEach)(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}t.BaseComponent=l,(0,s.mixin)(l,n.default)},(e,t,r)=>{"use strict";t.__esModule=!0,t.default=function(e){const r=[];let t=e;N[t]||(t=A);return(0,i.arrayEach)(N[t],e=>{let t;t=e===o.SEPARATOR?{name:o.SEPARATOR}:(0,n.clone)((0,s.getConditionDescriptor)(e)),r.push(t)}),r},r(286);var n=r(482),i=r(478),o=r(853),s=r(925),a=r(926),l=(t.CONDITION_NONE=a.CONDITION_NAME,r(927)),c=(t.CONDITION_EMPTY=l.CONDITION_NAME,r(928)),u=(t.CONDITION_NOT_EMPTY=c.CONDITION_NAME,r(929)),d=(t.CONDITION_EQUAL=u.CONDITION_NAME,r(930)),h=(t.CONDITION_NOT_EQUAL=d.CONDITION_NAME,r(931)),p=(t.CONDITION_GREATER_THAN=h.CONDITION_NAME,r(932)),f=(t.CONDITION_GREATER_THAN_OR_EQUAL=p.CONDITION_NAME,r(933)),g=(t.CONDITION_LESS_THAN=f.CONDITION_NAME,r(934)),m=(t.CONDITION_LESS_THAN_OR_EQUAL=g.CONDITION_NAME,r(935)),y=(t.CONDITION_BETWEEN=m.CONDITION_NAME,r(938)),v=(t.CONDITION_NOT_BETWEEN=y.CONDITION_NAME,r(939)),b=(t.CONDITION_BEGINS_WITH=v.CONDITION_NAME,r(940)),w=(t.CONDITION_ENDS_WITH=b.CONDITION_NAME,r(941)),C=(t.CONDITION_CONTAINS=w.CONDITION_NAME,r(942)),E=(t.CONDITION_NOT_CONTAINS=C.CONDITION_NAME,r(937)),T=(t.CONDITION_DATE_BEFORE=E.CONDITION_NAME,r(936)),S=(t.CONDITION_DATE_AFTER=T.CONDITION_NAME,r(943)),_=(t.CONDITION_TOMORROW=S.CONDITION_NAME,r(944)),x=(t.CONDITION_TODAY=_.CONDITION_NAME,r(945)),R=(t.CONDITION_YESTERDAY=x.CONDITION_NAME,r(946)),R=(t.CONDITION_BY_VALUE=R.CONDITION_NAME,r(948)),R=(t.CONDITION_TRUE=R.CONDITION_NAME,r(949)),R=(t.CONDITION_FALSE=R.CONDITION_NAME,r(950)),R=(t.OPERATION_AND=R.OPERATION_ID,r(952)),R=(t.OPERATION_OR=R.OPERATION_ID,r(953));t.OPERATION_OR_THEN_VARIABLE=R.OPERATION_ID,t.TYPE_NUMERIC="numeric";const A=t.TYPE_TEXT="text";t.TYPE_DATE="date";const N=t.TYPES={numeric:[a.CONDITION_NAME,o.SEPARATOR,l.CONDITION_NAME,c.CONDITION_NAME,o.SEPARATOR,u.CONDITION_NAME,d.CONDITION_NAME,o.SEPARATOR,h.CONDITION_NAME,p.CONDITION_NAME,f.CONDITION_NAME,g.CONDITION_NAME,m.CONDITION_NAME,y.CONDITION_NAME],[A]:[a.CONDITION_NAME,o.SEPARATOR,l.CONDITION_NAME,c.CONDITION_NAME,o.SEPARATOR,u.CONDITION_NAME,d.CONDITION_NAME,o.SEPARATOR,v.CONDITION_NAME,b.CONDITION_NAME,o.SEPARATOR,w.CONDITION_NAME,C.CONDITION_NAME],date:[a.CONDITION_NAME,o.SEPARATOR,l.CONDITION_NAME,c.CONDITION_NAME,o.SEPARATOR,u.CONDITION_NAME,d.CONDITION_NAME,o.SEPARATOR,E.CONDITION_NAME,T.CONDITION_NAME,m.CONDITION_NAME,o.SEPARATOR,S.CONDITION_NAME,_.CONDITION_NAME,x.CONDITION_NAME]}},(e,t,r)=>{"use strict";t.__esModule=!0,t.getCondition=function(e,t){if(!o[e])throw Error(`Filter condition "${e}" does not exist.`);const{condition:r,descriptor:n}=o[e];let i=t;n.inputValuesDecorator&&(i=n.inputValuesDecorator(i));return function(e){return r.apply(e.meta.instance,[].concat([e],[i]))}},t.getConditionDescriptor=function(e){if(o[e])return o[e].descriptor;throw Error(`Filter condition "${e}" does not exist.`)},t.registerCondition=function(e,t,r){r.key=e,o[e]={condition:t,descriptor:r}},r(204);const o=t.conditions={}},(e,t,r)=>{"use strict";t.__esModule=!0,t.condition=i;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621)),r=r(925);function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}t.CONDITION_NAME="none";function i(){return!0}(0,r.registerCondition)("none",i,{name:n.FILTERS_CONDITIONS_NONE,inputsCount:0,showOperators:!1})},(e,t,r)=>{"use strict";t.__esModule=!0,t.condition=a;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621)),i=r(925),o=r(337);function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}t.CONDITION_NAME="empty";function a(e){return(0,o.isEmpty)(e.value)}(0,i.registerCondition)("empty",a,{name:n.FILTERS_CONDITIONS_EMPTY,inputsCount:0,showOperators:!0})},(e,t,r)=>{"use strict";t.__esModule=!0,t.condition=a;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621)),i=r(925),o=r(927);function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}t.CONDITION_NAME="not_empty";function a(e,t){return!(0,i.getCondition)(o.CONDITION_NAME,t)(e)}(0,i.registerCondition)("not_empty",a,{name:n.FILTERS_CONDITIONS_NOT_EMPTY,inputsCount:0,showOperators:!0})},(e,t,r)=>{"use strict";t.__esModule=!0,t.condition=o;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621)),i=r(337),r=r(925);function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}t.CONDITION_NAME="eq";function o(e,t){var[t]=t;return(0,i.stringify)(e.value).toLocaleLowerCase(e.meta.locale)===(0,i.stringify)(t)}(0,r.registerCondition)("eq",o,{name:n.FILTERS_CONDITIONS_EQUAL,inputsCount:1,showOperators:!0})},(e,t,r)=>{"use strict";t.__esModule=!0,t.condition=a;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621)),i=r(925),o=r(929);function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}t.CONDITION_NAME="neq";function a(e,t){return!(0,i.getCondition)(o.CONDITION_NAME,t)(e)}(0,i.registerCondition)("neq",a,{name:n.FILTERS_CONDITIONS_NOT_EQUAL,inputsCount:1,showOperators:!0})},(e,t,r)=>{"use strict";t.__esModule=!0,t.condition=i;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621)),r=r(925);function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}t.CONDITION_NAME="gt";function i(e,t){var[t]=t;let r=t;return"numeric"===e.meta.type&&(r=parseFloat(r,10)),e.value>r}(0,r.registerCondition)("gt",i,{name:n.FILTERS_CONDITIONS_GREATER_THAN,inputsCount:1,showOperators:!0})},(e,t,r)=>{"use strict";t.__esModule=!0,t.condition=i;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621)),r=r(925);function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}t.CONDITION_NAME="gte";function i(e,t){var[t]=t;let r=t;return"numeric"===e.meta.type&&(r=parseFloat(r,10)),e.value>=r}(0,r.registerCondition)("gte",i,{name:n.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,inputsCount:1,showOperators:!0})},(e,t,r)=>{"use strict";t.__esModule=!0,t.condition=i;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621)),r=r(925);function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}t.CONDITION_NAME="lt";function i(e,t){var[t]=t;let r=t;return"numeric"===e.meta.type&&(r=parseFloat(r,10)),e.value<r}(0,r.registerCondition)("lt",i,{name:n.FILTERS_CONDITIONS_LESS_THAN,inputsCount:1,showOperators:!0})},(e,t,r)=>{"use strict";t.__esModule=!0,t.condition=i;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621)),r=r(925);function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}t.CONDITION_NAME="lte";function i(e,t){var[t]=t;let r=t;return"numeric"===e.meta.type&&(r=parseFloat(r,10)),e.value<=r}(0,r.registerCondition)("lte",i,{name:n.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,inputsCount:1,showOperators:!0})},(e,t,r)=>{"use strict";t.__esModule=!0,t.condition=i;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=l(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621)),o=r(925),s=r(936),a=r(937);function l(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(l=function(e){return e?r:t})(e))}t.CONDITION_NAME="between";function i(e,t){var[t,r]=t;let n=t,i=r;if("numeric"===e.meta.type){var t=parseFloat(n,10),r=parseFloat(i,10);n=Math.min(t,r),i=Math.max(t,r)}else if("date"===e.meta.type)return t=(0,o.getCondition)(a.CONDITION_NAME,[i]),r=(0,o.getCondition)(s.CONDITION_NAME,[n]),t(e)&&r(e);return e.value>=n&&e.value<=i}(0,o.registerCondition)("between",i,{name:n.FILTERS_CONDITIONS_BETWEEN,inputsCount:2,showOperators:!0})},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,t.condition=o,n(r(338))),n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621)),r=r(925);function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}t.CONDITION_NAME="date_after";function o(e,t){var[t]=t,r=(0,i.default)(e.value,e.meta.dateFormat),t=(0,i.default)(t,e.meta.dateFormat);return!(!r.isValid()||!t.isValid())&&0<=r.diff(t)}(0,r.registerCondition)("date_after",o,{name:n.FILTERS_CONDITIONS_AFTER,inputsCount:1,showOperators:!0})},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,t.condition=o,n(r(338))),n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621)),r=r(925);function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}t.CONDITION_NAME="date_before";function o(e,t){var[t]=t,r=(0,i.default)(e.value,e.meta.dateFormat),t=(0,i.default)(t,e.meta.dateFormat);return!(!r.isValid()||!t.isValid())&&r.diff(t)<=0}(0,r.registerCondition)("date_before",o,{name:n.FILTERS_CONDITIONS_BEFORE,inputsCount:1,showOperators:!0})},(e,t,r)=>{"use strict";t.__esModule=!0,t.condition=a;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621)),i=r(925),o=r(935);function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}t.CONDITION_NAME="not_between";function a(e,t){return!(0,i.getCondition)(o.CONDITION_NAME,t)(e)}(0,i.registerCondition)("not_between",a,{name:n.FILTERS_CONDITIONS_NOT_BETWEEN,inputsCount:2,showOperators:!0})},(e,t,r)=>{"use strict";t.__esModule=!0,t.condition=o;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621)),i=r(337),r=r(925);function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}t.CONDITION_NAME="begins_with";function o(e,t){var[t]=t;return(0,i.stringify)(e.value).toLocaleLowerCase(e.meta.locale).startsWith((0,i.stringify)(t))}(0,r.registerCondition)("begins_with",o,{name:n.FILTERS_CONDITIONS_BEGINS_WITH,inputsCount:1,showOperators:!0})},(e,t,r)=>{"use strict";t.__esModule=!0,t.condition=o;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621)),i=r(337),r=r(925);function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}t.CONDITION_NAME="ends_with";function o(e,t){var[t]=t;return(0,i.stringify)(e.value).toLocaleLowerCase(e.meta.locale).endsWith((0,i.stringify)(t))}(0,r.registerCondition)("ends_with",o,{name:n.FILTERS_CONDITIONS_ENDS_WITH,inputsCount:1,showOperators:!0})},(e,t,r)=>{"use strict";t.__esModule=!0,t.condition=o;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621)),i=r(337),r=r(925);function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}t.CONDITION_NAME="contains";function o(e,t){var[t]=t;return 0<=(0,i.stringify)(e.value).toLocaleLowerCase(e.meta.locale).indexOf((0,i.stringify)(t))}(0,r.registerCondition)("contains",o,{name:n.FILTERS_CONDITIONS_CONTAINS,inputsCount:1,showOperators:!0})},(e,t,r)=>{"use strict";t.__esModule=!0,t.condition=a;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621)),i=r(925),o=r(941);function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}t.CONDITION_NAME="not_contains";function a(e,t){return!(0,i.getCondition)(o.CONDITION_NAME,t)(e)}(0,i.registerCondition)("not_contains",a,{name:n.FILTERS_CONDITIONS_NOT_CONTAIN,inputsCount:1,showOperators:!0})},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,t.condition=o,n(r(338))),n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621)),r=r(925);function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}t.CONDITION_NAME="date_tomorrow";function o(e){e=(0,i.default)(e.value,e.meta.dateFormat);return!!e.isValid()&&e.isSame((0,i.default)().subtract(-1,"days").startOf("day"),"d")}(0,r.registerCondition)("date_tomorrow",o,{name:n.FILTERS_CONDITIONS_TOMORROW,inputsCount:0})},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,t.condition=o,n(r(338))),n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621)),r=r(925);function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}t.CONDITION_NAME="date_today";function o(e){e=(0,i.default)(e.value,e.meta.dateFormat);return!!e.isValid()&&e.isSame((0,i.default)().startOf("day"),"d")}(0,r.registerCondition)("date_today",o,{name:n.FILTERS_CONDITIONS_TODAY,inputsCount:0})},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,t.condition=o,n(r(338))),n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621)),r=r(925);function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}t.CONDITION_NAME="date_yesterday";function o(e){e=(0,i.default)(e.value,e.meta.dateFormat);return!!e.isValid()&&e.isSame((0,i.default)().subtract(1,"days").startOf("day"),"d")}(0,r.registerCondition)("date_yesterday",o,{name:n.FILTERS_CONDITIONS_YESTERDAY,inputsCount:0})},(e,t,r)=>{"use strict";t.__esModule=!0,t.condition=o;var n=r(925),i=r(947);t.CONDITION_NAME="by_value";function o(e,t){var[t]=t;return t(e.value)}(0,n.registerCondition)("by_value",o,{name:"By value",inputsCount:0,inputValuesDecorator(e){var[e]=e;return[(0,i.createArrayAssertion)(e)]},showOperators:!1})},(e,t,r)=>{"use strict";t.__esModule=!0,t.createArrayAssertion=c,t.intersectValues=function(e,t,r,n){const i=[],o=e===t;let s;o||(s=c(t));return(0,a.arrayEach)(e,e=>{let t=!1;e={checked:t=o||s(e)?!0:t,value:e,visualValue:l(e,r)};n&&n(e),i.push(e)}),i},t.sortComparison=function(e,t){return"number"!=typeof e||"number"!=typeof t?n(e,t):e-t},t.toEmptyString=function(e){return null==e?"":e},t.toVisualValue=l,t.unifyColumnValues=function(e){let t=e;t=o?Array.from(new Set(t)):(0,a.arrayUnique)(t);return t=t.sort((e,t)=>"number"==typeof e&&"number"==typeof t?e-t:e===t?0:t<e?1:-1)},r(286),r(290),r(302),r(305),r(309),r(312),r(315),r(318);var t=r(485),a=r(478);const n=(0,t.getComparisonFunction)();function l(e,t){let r=e;return r=""===r?`(${t})`:r}const i=new Set([1]).has(1),o=i&&"function"==typeof Array.from;function c(e){let r=e;return i&&(r=new Set(r)),function(e){let t;return t=i?r.has(e):!!~r.indexOf(e)}}},(e,t,r)=>{"use strict";t.__esModule=!0,t.condition=n;r=r(925);t.CONDITION_NAME="true";function n(){return!0}(0,r.registerCondition)("true",n,{name:"True"})},(e,t,r)=>{"use strict";t.__esModule=!0,t.condition=n;r=r(925);t.CONDITION_NAME="false";function n(){return!1}(0,r.registerCondition)("false",n,{name:"False"})},(e,t,r)=>{"use strict";t.__esModule=!0,t.operationResult=i;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621)),r=r(951);function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}t.OPERATION_ID="conjunction";t=t.SHORT_NAME_FOR_COMPONENT=n.FILTERS_LABELS_CONJUNCTION;function i(e,t){return e.every(e=>e.func(t))}(0,r.registerOperation)("conjunction",t,i)},(e,t,r)=>{"use strict";t.__esModule=!0,t.getOperationFunc=function(e){if(!n[e])throw Error(`Operation with id "${e}" does not exist.`);const r=n[e].func;return function(e,t){return r(e,t)}},t.getOperationName=function(e){return n[e].name},t.registerOperation=function(e,t,r){n[e]={name:t,func:r}},r(204);const n=t.operations={}},(e,t,r)=>{"use strict";t.__esModule=!0,t.operationResult=i;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621)),r=r(951);function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}t.OPERATION_ID="disjunction";t=t.SHORT_NAME_FOR_COMPONENT=n.FILTERS_LABELS_DISJUNCTION;function i(e,t){return e.some(e=>e.func(t))}(0,r.registerOperation)("disjunction",t,i)},(e,t,r)=>{"use strict";t.__esModule=!0,t.operationResult=i,r(204);var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621)),r=r(951);function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}t.OPERATION_ID="disjunctionWithExtraCondition";t=t.SHORT_NAME_FOR_COMPONENT=n.FILTERS_LABELS_DISJUNCTION;function i(e,t){if(e.length<3)throw Error("Operation doesn't work on less then three conditions.");return e.slice(0,e.length-1).some(e=>e.func(t))&&e[e.length-1].func(t)}(0,r.registerOperation)("disjunctionWithExtraCondition",t,i)},(e,t,r)=>{"use strict";t.__esModule=!0,r(204);var n=r(334),i=r(482),r=r(955);function o(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function s(e,t){return e.get(a(e,t))}function a(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var l=new WeakMap,c=new WeakSet;class u extends r.BaseUI{static get DEFAULTS(){return(0,i.clone)({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,t){var r;super(e,(0,i.extend)(u.DEFAULTS,t)),o(e=this,t=c),t.add(e),t=void 0,o(e=this,r=l),r.set(e,t),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>a(c,this,d).call(this,e))}build(){super.build();var e,t,r=this.hot.rootDocument.createElement("div");t=(e=this)._element.firstChild,l.set(a(l,e),t),(0,n.addClass)(this._element,"htUIInput"),(0,n.addClass)(r,"htUIInputIcon"),this._element.appendChild(r),this.update()}update(){this.isBuilt()&&(s(l,this).type=this.options.type,s(l,this).placeholder=this.translateIfPossible(this.options.placeholder),s(l,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&s(l,this).focus()}}function d(e){this.options.value=e.target.value}t.InputUI=u},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(487))),o=r(482),s=n(r(578)),a=n(r(502)),l=r(334),c=r(478),u=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=d(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621));function d(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(d=function(e){return e?r:t})(e))}const h="building",p=["click","input","keydown","keypress","keyup","focus","blur","change"];class f{static get DEFAULTS(){return(0,o.clone)({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,t){(0,i.default)(this,"hot",void 0),(0,i.default)(this,"eventManager",new a.default(this)),(0,i.default)(this,"options",void 0),(0,i.default)(this,"_element",void 0),(0,i.default)(this,"buildState",void 0),this.hot=e,this.options=(0,o.extend)(f.DEFAULTS,t),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState!==h&&("built"===this.buildState?this.update():(this.buildState=h,this.build(),this.buildState="built")),this._element}isBuilt(){return"built"===this.buildState}translateIfPossible(e){return"string"==typeof e&&e.startsWith(u.FILTERS_NAMESPACE)?this.hot.getTranslatedPhrase(e):e}build(){const t=(e,t)=>{this.eventManager.addEventListener(e,t,e=>this.runLocalHooks(t,e,this))};if(this.buildState||(this.buildState=h),this._element.setAttribute("data-hot-input",!0),void 0!==this.options.tabIndex&&this._element.setAttribute("tabindex",this.options.tabIndex),void 0!==this.options.role&&this._element.setAttribute("role",this.options.role),this.options.className&&(0,l.addClass)(this._element,this.options.className),this.options.children.length)(0,c.arrayEach)(this.options.children,e=>this._element.appendChild(e.element));else if(this.options.wrapIt){const r=this.hot.rootDocument.createElement(this.options.tagName);r.setAttribute("data-hot-input",!0),(0,o.objectEach)(this.options,(e,t)=>{void 0!==r[t]&&"className"!==t&&"tagName"!==t&&"children"!==t&&(r[t]=this.translateIfPossible(e))}),this._element.appendChild(r),(0,c.arrayEach)(p,e=>t(r,e))}else(0,c.arrayEach)(p,e=>t(this._element,e))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}t.BaseUI=f,(0,o.mixin)(f,s.default)},(e,t,r)=>{"use strict";t.__esModule=!0,r(204);var n=r(878),i=r(482),o=r(478),s=r(334),a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=d(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621)),l=r(853),c=r(955),u=r(479);function d(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(d=function(e){return e?r:t})(e))}function h(e,t,r){p(e,t),t.set(e,r)}function p(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function f(e,t,r){e.set(m(e,t),r)}function g(e,t){return e.get(m(e,t))}function m(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var y=new WeakMap,v=new WeakMap,b=new WeakMap,w=new WeakMap,C=new WeakMap,E=new WeakSet;class T extends c.BaseUI{static get DEFAULTS(){return(0,i.clone)({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,t){super(e,(0,i.extend)(T.DEFAULTS,t)),p(e=this,t=E),t.add(e),h(this,y,null),h(this,v,[]),h(this,b,void 0),h(this,w,void 0),h(this,C,void 0),this.registerHooks()}getMenu(){return g(y,this)}registerHooks(){this.addLocalHook("click",()=>m(E,this,x).call(this))}setItems(e){f(v,this,this.translateNames(e)),g(y,this)&&g(y,this).setMenuItems(g(v,this))}translateNames(e){return(0,o.arrayEach)(e,e=>{e.name=this.translateIfPossible(e.name)}),e}build(){super.build(),f(y,this,new n.Menu(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),g(y,this).setMenuItems(g(v,this));var e=new c.BaseUI(this.hot,{className:"htUISelectCaption"}),t=new c.BaseUI(this.hot,{className:"htUISelectDropdown"});f(b,this,e),f(w,this,e.element),f(C,this,t),this.hot.getSettings().ariaTags&&((0,s.setAttribute)(t.element,[(0,u.A11Y_HIDDEN)()]),(0,s.setAttribute)(this._element,[(0,u.A11Y_LISTBOX)()])),(0,o.arrayEach)([e,t],e=>this._element.appendChild(e.element)),g(y,this).addLocalHook("select",e=>m(E,this,S).call(this,e)),g(y,this).addLocalHook("afterClose",()=>m(E,this,_).call(this)),this.update()}update(){if(this.isBuilt()){let e;e=this.options.value?this.options.value.name:g(y,this).hot.getTranslatedPhrase(a.FILTERS_CONDITIONS_NONE),g(w,this).textContent=e,super.update()}}openOptions(){var e=this.element.getBoundingClientRect();g(y,this)&&(g(y,this).open(),g(y,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),g(y,this).getNavigator().toFirstItem(),g(y,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:e=>{this.closeOptions(),this.runLocalHooks("tabKeydown",e)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){g(y,this)&&g(y,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){g(y,this)&&(g(y,this).destroy(),f(y,this,null)),g(b,this)&&g(b,this).destroy(),g(C,this)&&g(C,this).destroy(),super.destroy()}}function S(e){e.name!==l.SEPARATOR&&(this.options.value=e,this.update(),this.runLocalHooks("select",this.options.value))}function _(){this.runLocalHooks("afterClose")}function x(){this.openOptions()}t.SelectUI=T},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),r(286),n(r(487))),o=r(334),s=r(478),a=r(477),n=r(923),l=r(951),c=r(950),u=r(952),d=r(953),h=r(958);function p(e,t){var r=e;if(t.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object");t.add(e)}var f=new WeakSet;class g extends n.BaseComponent{constructor(e,t){super(e,{id:t.id,stateless:!1}),p(this,f),(0,i.default)(this,"name",""),this.name=t.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>((0,o.addClass)(t.parentNode,"htFiltersMenuOperators"),(0,s.arrayEach)(this.elements,e=>t.appendChild(e.element)),t)}}buildOperatorsElement(){const t=[c.OPERATION_ID,u.OPERATION_ID];(0,s.arrayEach)(t,e=>{e=new h.RadioInputUI(this.hot,{name:"operator",label:{htmlFor:e,textContent:(0,l.getOperationName)(e)},value:e,checked:e===t[0],id:e});e.addLocalHook("change",e=>function(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}(f,this,m).call(this,e)),this.elements.push(e)})}setChecked(r){if(this.elements.length<r)throw Error((0,a.toSingleLine)`Radio button with index ${r} doesn't exist.`);(0,s.arrayEach)(this.elements,(e,t)=>{e.setChecked(t===r)})}getActiveOperationId(){var e=this.elements.find(e=>e instanceof h.RadioInputUI&&e.isChecked());return e?e.getValue():c.OPERATION_ID}getState(){return this.getActiveOperationId()}setState(t){this.reset(),t&&this.getActiveOperationId()!==t&&(0,s.arrayEach)(this.elements,e=>{e.setChecked(e.getValue()===t)})}updateState(){let e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:c.OPERATION_ID;e===d.OPERATION_ID&&(e=u.OPERATION_ID),this.state.setValueAtIndex(1<arguments.length?arguments[1]:void 0,e)}reset(){this.setChecked(0)}}function m(e){this.setState(e.target.value)}t.OperatorsComponent=g},(e,t,r)=>{"use strict";t.__esModule=!0,r(204);var n=r(482),r=r(955);function i(e,t,r){var n=e;if(t.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object");t.set(e,r)}function o(e,t){return e.get(a(e,t))}function s(e,t,r){e.set(a(e,t),r)}function a(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var l=new WeakMap,c=new WeakMap;class u extends r.BaseUI{static get DEFAULTS(){return(0,n.clone)({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,t){super(e,(0,n.extend)(u.DEFAULTS,t)),i(this,l,void 0),i(this,c,void 0)}build(){super.build();var e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),s(c,this,e),s(l,this,this._element.firstChild),o(l,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(o(c,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return!!this.isBuilt()&&o(l,this).checked}setChecked(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];this.isBuilt()&&(o(l,this).checked=e)}focus(){this.isBuilt()&&o(l,this).focus()}}t.RadioInputUI=u},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),r(286),n(r(487))),a=r(334),o=r(492),u=r(478),s=r(491),d=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=g(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621)),h=r(947),n=r(923),l=r(960),p=r(924),f=r(925),c=r(768);function g(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(g=function(e){return e?r:t})(e))}function m(e,t){var r=e;if(t.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object");t.add(e)}function y(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var v=new WeakSet;class b extends n.BaseComponent{constructor(e,t){super(e,{id:t.id,stateless:!1}),m(this,v),(0,i.default)(this,"name",""),this.name=t.name,this.elements.push(new l.MultipleSelectUI(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>y(v,this,w).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,t)=>y(v,this,E).call(this,e,t))}getElements(){var e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){var t;this.reset(),e&&e.command.key===p.CONDITION_BY_VALUE&&((t=this.getMultipleSelectElement()).setItems(e.itemsSnapshot),t.setValue(e.args[0]),t.setLocale(e.locale))}getState(){var e=this.getMultipleSelectElement(),t=e.getItems();return{command:{key:e.isSelectedAllValues()||!t.length?p.CONDITION_NONE:p.CONDITION_BY_VALUE},args:[e.getValue()],itemsSnapshot:t}}updateState(c){var e=(e,t,r,n,i)=>{var[t]=(0,u.arrayFilter)(t,e=>e.name===p.CONDITION_BY_VALUE),o={},s=this.hot.getTranslatedPhrase(d.FILTERS_VALUES_BLANK_CELLS);if(t){n=n(e,i),i=(0,u.arrayMap)(n,e=>e.value);const a=new Map(n.map(e=>[e.value,this.hot.getCellMeta(e.meta.visualRow,e.meta.visualCol)]));n=(0,h.unifyColumnValues)(i);r&&(t.args[0]=r);const l=[];i=(0,h.intersectValues)(n,t.args[0],s,e=>{e.checked&&l.push(e.value),y(v,this,C).call(this,e,a)}),r=c.editedConditionStack.column;o.locale=this.hot.getCellMeta(0,r).locale,o.args=[l],o.command=(0,f.getConditionDescriptor)(p.CONDITION_BY_VALUE),o.itemsSnapshot=i}else o.args=[],o.command=(0,f.getConditionDescriptor)(p.CONDITION_NONE);this.state.setValueAtIndex(e,o)};e(c.editedConditionStack.column,c.editedConditionStack.conditions,c.conditionArgsChange,c.filteredRowsFactory),c.dependentConditionStacks.length&&e(c.dependentConditionStacks[0].column,c.dependentConditionStacks[0].conditions,c.conditionArgsChange,c.filteredRowsFactory,c.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof l.MultipleSelectUI)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,r,n,i,o)=>{(0,a.addClass)(t.parentNode,"htFiltersMenuValue");var s=this.hot.rootDocument.createElement("div");return(0,a.addClass)(s,"htFiltersMenuLabel"),s.textContent=o,t.appendChild(s),(0,u.arrayEach)(this.elements,e=>t.appendChild(e.element)),t}}}reset(){var e=this.hot.getTranslatedPhrase(d.FILTERS_VALUES_BLANK_CELLS),t=this._getColumnVisibleValues(),r=t.map(e=>e.value);const n=new Map(t.map(e=>[e.value,e.meta]));t=(0,h.unifyColumnValues)(r),r=(0,h.intersectValues)(t,t,e,e=>{y(v,this,C).call(this,e,n)}),this.getMultipleSelectElement().setItems(r),super.reset(),this.getMultipleSelectElement().setValue(t),e=this.hot.getPlugin("filters").getSelectedColumn();null!==e&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,e.visualIndex).locale)}_getColumnVisibleValues(){const r=this.hot.getPlugin("filters").getSelectedColumn();return null===r?[]:(0,u.arrayMap)(this.hot.getDataAtCol(r.visualIndex),(e,t)=>({value:(0,h.toEmptyString)(e),meta:this.hot.getCellMeta(t,r.visualIndex)}))}}function w(e){(0,s.isKey)(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),(0,o.stopImmediatePropagation)(e))}function C(e,t){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(e.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",e.visualValue,t.get(e.value)))}function E(e,t){return"numeric"!==t.type?e:(0,c.getRenderedValue)(e,t)}t.ValueComponent=b},(e,t,r)=>{"use strict";t.__esModule=!0,r(204),r(286);var i=r(334),n=r(482),o=r(491),s=r(480),a=r(596),l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=f(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621)),c=r(492),u=r(955),d=r(954),h=r(961),p=r(947);function f(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(f=function(e){return e?r:t})(e))}function g(e,t,r){m(e,t),t.set(e,r)}function m(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function y(e,t){return e.get(b(e,t))}function v(e,t,r){e.set(b(e,t),r)}function b(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}const w="multipleSelect.itemBox";var C=new WeakMap,E=new WeakMap,T=new WeakMap,S=new WeakMap,_=new WeakMap,x=new WeakMap,R=new WeakSet;class A extends u.BaseUI{static get DEFAULTS(){return(0,n.clone)({className:"htUIMultipleSelect",value:[]})}constructor(e,t){super(e,(0,n.extend)(A.DEFAULTS,t)),m(e=this,t=R),t.add(e),g(this,C,[]),g(this,E,void 0),g(this,T,void 0),g(this,S,void 0),g(this,_,void 0),g(this,x,void 0),v(S,this,new d.InputUI(this.hot,{placeholder:l.FILTERS_BUTTONS_PLACEHOLDER_SEARCH,className:"htUIMultipleSelectSearch"})),v(_,this,new h.LinkUI(this.hot,{textContent:l.FILTERS_BUTTONS_SELECT_ALL,className:"htUISelectAll"})),v(x,this,new h.LinkUI(this.hot,{textContent:l.FILTERS_BUTTONS_CLEAR,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return y(E,this)}registerHooks(){y(S,this).addLocalHook("keydown",e=>b(R,this,O).call(this,e)),y(S,this).addLocalHook("input",e=>b(R,this,N).call(this,e)),y(_,this).addLocalHook("click",e=>b(R,this,I).call(this,e)),y(x,this).addLocalHook("click",e=>b(R,this,M).call(this,e))}setItems(e){v(C,this,e),y(E,this)&&y(E,this).loadData(y(C,this))}setLocale(e){v(T,this,e)}getLocale(){return y(T,this)}getItems(){return[...y(C,this)]}getValue(){{var e=y(C,this);const t=[];return e.forEach(e=>{e.checked&&t.push(e.value)}),t}}getSearchInputElement(){return y(S,this)}getSelectAllElement(){return y(_,this)}getClearAllElement(){return y(x,this)}isSelectedAllValues(){return y(C,this).length===this.getValue().length}build(){super.build();const t=this.hot["rootDocument"],e=t.createElement("div");var r=new u.BaseUI(this.hot,{className:"htUISelectionControls",children:[y(_,this),y(x,this)]});this._element.appendChild(y(S,this).element),this._element.appendChild(r.element),this._element.appendChild(e);const n=e=>{this._element&&(y(E,this)&&y(E,this).destroy(),(0,i.addClass)(e,"htUIMultipleSelectHot"),v(E,this,new this.hot.constructor(e,{data:y(C,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(e,t,r,n,i,o)=>{e.title=o.instance.getDataAtRowProp(t,o.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{y(E,this).listen()},colWidths:()=>y(E,this).container.scrollWidth-(0,i.getScrollbarWidth)(t),maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),y(E,this).init(),(e=y(E,this).getShortcutManager().getContext("grid")).removeShortcutsByKeys(["Tab"]),e.removeShortcutsByKeys(["Shift","Tab"]),e.addShortcut({keys:[["Escape"]],callback:e=>{this.runLocalHooks("keydown",e,this)},group:w}),e.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:e=>{y(E,this).deselectCell(),this.runLocalHooks("keydown",e,this),this.runLocalHooks("listTabKeydown",e,this)},group:w}))};n(e),this.hot._registerTimeout(()=>n(e),100)}focus(){this.isBuilt()&&y(E,this).listen()}reset(){y(S,this).reset(),y(_,this).reset(),y(x,this).reset()}update(){this.isBuilt()&&(y(E,this).loadData(function(e,t){const r=(0,p.createArrayAssertion)(t);return e.map(e=>(e.checked=r(e.value),e))}(y(C,this),this.options.value)),super.update())}destroy(){y(E,this)&&y(E,this).destroy(),y(S,this).destroy(),y(x,this).destroy(),y(_,this).destroy(),v(S,this,null),v(x,this,null),v(_,this,null),v(E,this,null),v(C,this,null),super.destroy()}}function N(e){const t=e.target.value.toLocaleLowerCase(this.getLocale());let r;r=""===t?[...y(C,this)]:y(C,this).filter(e=>0<=(""+e.value).toLocaleLowerCase(this.getLocale()).indexOf(t)),y(E,this).loadData(r)}function O(e){this.runLocalHooks("keydown",e,this),(0,s.partial)(o.isKey,e.keyCode)("ARROW_DOWN")&&(e.preventDefault(),(0,c.stopImmediatePropagation)(e),y(E,this).listen(),y(E,this).selectCell(0,0))}function I(e){const r=[];e.preventDefault(),y(E,this).getSourceData().forEach((e,t)=>{e.checked=!0,r.push((0,a.dataRowToChangesArray)(e,t)[0])}),y(E,this).setSourceDataAtCell(r)}function M(e){const r=[];e.preventDefault(),y(E,this).getSourceData().forEach((e,t)=>{e.checked=!1,r.push((0,a.dataRowToChangesArray)(e,t)[0])}),y(E,this).setSourceDataAtCell(r)}t.MultipleSelectUI=A;t.default=A},(e,t,r)=>{"use strict";t.__esModule=!0,r(204);var n=r(482),r=r(955);function i(e,t,r){var n=e;if(t.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object");t.set(e,r)}function o(e,t){return e.get(s(e,t))}function s(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var a=new WeakMap;class l extends r.BaseUI{static get DEFAULTS(){return(0,n.clone)({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,t){super(e,(0,n.extend)(l.DEFAULTS,t)),i(this,a,void 0)}build(){var e,t;super.build(),t=(e=this)._element.firstChild,a.set(s(a,e),t)}update(){this.isBuilt()&&(o(a,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&o(a,this).focus()}activate(){o(a,this).click()}}t.LinkUI=l},(e,t,r)=>{"use strict";var n,i=r(197),o=(t.__esModule=!0,r(204),r(286),i(r(487))),s=r(334),a=r(478),l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=u(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621)),i=r(923),c=r(954);function u(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(u=function(e){return e?r:t})(e))}function d(e,t){var r=e;if(t.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object");t.add(e)}var h=new WeakSet;class p extends i.BaseComponent{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,t){super(e,{id:t.id,stateless:!0}),d(this,h),(0,o.default)(this,"name",""),this.name=t.name,this.elements.push(new c.InputUI(this.hot,{type:"button",value:l.FILTERS_BUTTONS_OK,className:"htUIButton htUIButtonOK",identifier:p.BUTTON_OK})),this.elements.push(new c.InputUI(this.hot,{type:"button",value:l.FILTERS_BUTTONS_CANCEL,className:"htUIButton htUIButtonCancel",identifier:p.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){(0,a.arrayEach)(this.elements,e=>{e.addLocalHook("click",(e,t)=>function(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}(h,this,f).call(this,e,t))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>((0,s.addClass)(t.parentNode,"htFiltersMenuActionBar"),(0,a.arrayEach)(this.elements,e=>t.appendChild(e.element)),t)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}function f(e,t){t.options.identifier===n.BUTTON_OK?this.accept():this.cancel()}t.ActionBarComponent=p,n=p},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),r(286),n(r(487))),a=r(478),o=r(482),l=r(477),n=n(r(578)),c=r(925),u=r(950),d=r(951),h=r(337),s=r(597);const p="ConditionCollection.filteringStates";class f{constructor(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];(0,i.default)(this,"hot",void 0),(0,i.default)(this,"isMapRegistrable",void 0),(0,i.default)(this,"filteringStates",new s.LinkedPhysicalIndexToValueMap),this.hot=e,this.isMapRegistrable=t,!0===this.isMapRegistrable?this.hot.columnIndexMapper.registerMap(p,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return 0===this.getFilteredColumns().length}isMatch(e,t){var t=this.filteringStates.getValueAtIndex(t),r=null!=(r=null==t?void 0:t.conditions)?r:[],t=null==t?void 0:t.operation;return this.isMatchInConditions(r,e,t)}isMatchInConditions(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:u.OPERATION_ID;return!e.length||(0,d.getOperationFunc)(r)(e,t)}addCondition(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:u.OPERATION_ID,n=3<arguments.length?arguments[3]:void 0;const i=this.hot.getCellMeta(0,e).locale;var o=(0,a.arrayMap)(t.args,e=>"string"==typeof e?e.toLocaleLowerCase(i):e),t=t.name||t.command.key,s=(this.runLocalHooks("beforeAdd",e),this.getOperation(e));if(s){if(s!==r)throw Error((0,l.toSingleLine)`The column of index ${e} has been already applied with a \`${s}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if((0,h.isUndefined)(d.operations[r]))throw new Error((0,l.toSingleLine)`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);s=this.getConditions(e);0===s.length?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:t,args:o,func:(0,c.getCondition)(t,o)}]},n):s.push({name:t,args:o,func:(0,c.getCondition)(t,o)}),this.runLocalHooks("afterAdd",e)}getConditions(e){return null!=(e=null==(e=this.filteringStates.getValueAtIndex(e))?void 0:e.conditions)?e:[]}getOperation(e){return null==(e=this.filteringStates.getValueAtIndex(e))?void 0:e.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{var[e]=e;return e})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return(0,a.arrayReduce)(this.filteringStates.getEntries(),(e,t)=>{var[t,{operation:r,conditions:n}]=t;return e.push({column:t,operation:r,conditions:(0,a.arrayMap)(n,e=>{var{name:e,args:t}=e;return{name:e,args:t}})}),e},[])}importAllConditions(e){this.clean(),(0,a.arrayEach)(e,t=>{(0,a.arrayEach)(t.conditions,e=>this.addCondition(t.column,e))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,t){e=this.getConditions(e);return t?e.some(e=>e.name===t):0<e.length}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(p),this.filteringStates=null,this.clearLocalHooks()}}(0,o.mixin)(f,n.default);t.default=f},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(286),n(r(487))),o=r(478);t.default=class{constructor(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:()=>[];(0,i.default)(this,"conditionCollection",void 0),(0,i.default)(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=t}filter(){let n=[];return(0,o.arrayEach)(this.conditionCollection.getFilteredColumns(),(e,t)=>{let r=this.columnDataFactory(e);t&&(r=this._getIntersectData(r,n)),n=this.filterByColumn(e,r)}),n}filterByColumn(t){const r=[];return(0,o.arrayEach)(1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],e=>{void 0!==e&&this.conditionCollection.isMatch(e,t)&&r.push(e)}),r}_getIntersectData(t,e){const r=[];return(0,o.arrayEach)(e,e=>{e=e.meta.visualRow;void 0!==t[e]&&(r[e]=t[e])}),r}}},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),r(286),n(r(487))),a=r(478),o=r(482),l=r(480),s=n(r(578)),c=n(r(963)),u=n(r(964)),d=r(947);function h(e,t){var r=e;if(t.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object");t.add(e)}function p(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var f=new WeakSet;class g{constructor(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:()=>[];h(this,f),(0,i.default)(this,"hot",void 0),(0,i.default)(this,"conditionCollection",void 0),(0,i.default)(this,"columnDataFactory",void 0),(0,i.default)(this,"changes",[]),(0,i.default)(this,"grouping",!1),(0,i.default)(this,"latestEditedColumnPosition",-1),(0,i.default)(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=t,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",e=>p(f,this,m).call(this,e)),this.conditionCollection.addLocalHook("afterRemove",e=>this.updateStatesAtColumn(e)),this.conditionCollection.addLocalHook("afterAdd",e=>this.updateStatesAtColumn(e)),this.conditionCollection.addLocalHook("beforeClean",()=>p(f,this,y).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>p(f,this,v).call(this))}groupChanges(){this.grouping=!0}flush(){(this.grouping=!1,a.arrayEach)(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(t,r){var s=this;if(this.grouping)-1===this.changes.indexOf(t)&&this.changes.push(t);else{var n=this.conditionCollection.exportAllConditions();let e=this.conditionCollection.getColumnStackPosition(t);-1===e&&(e=this.latestEditedColumnPosition);var i=n.slice(0,e),n=n.slice(e),i=(n.length&&n[0].column===t&&n.shift(),(0,l.curry)(function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[],n=new c.default(s.hot,!1),e=[].concat(e,r),r=(n.importAllConditions(e),s.columnDataFactory(t));let i;i=n.isEmpty()?r:new u.default(n,e=>s.columnDataFactory(e)).filter(),i=(0,a.arrayMap)(i,e=>e.meta.visualRow);const o=(0,d.createArrayAssertion)(i);return n.destroy(),(0,a.arrayFilter)(r,e=>o(e.meta.visualRow))})(i)),o=[].concat(this.conditionCollection.getConditions(t));this.runLocalHooks("update",{editedConditionStack:{column:t,conditions:o},dependentConditionStacks:n,filteredRowsFactory:i,conditionArgsChange:r})}}destroy(){this.clearLocalHooks(),(0,o.objectEach)(this,(e,t)=>{this[t]=null})}}function m(e){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(e)}function y(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function v(){(0,a.arrayEach)(this.latestOrderStack,e=>{this.updateStatesAtColumn(e)})}(0,o.mixin)(g,s.default);t.default=g},(e,t,r)=>{"use strict";t.__esModule=!0,t.createMenuFocusController=function(n,i){let o=-1;const s=(0,a.createFocusNavigator)(i),t=e=>()=>{n.isOpened()&&n.getKeyboardShortcutsCtrl().listen(d),s.setCurrentPage(i.indexOf(e))};function e(e){const t=n.getKeyboardShortcutsCtrl();var r=e.getKeyboardShortcutsCtrl();s.clear(),r.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:t.getContext(d),callback:()=>{e.isSubMenu()&&e.close(),t.listen(d)}}]),e.isSubMenu()||t.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:e=>{var t=n.getNavigator();-1<t.getCurrentPage()&&(o=t.getCurrentPage()),t.clear(),e.shiftKey?s.toPreviousItem():s.toNextItem()}},{keys:[["Escape"]],callback:()=>{n.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:e=>{var t=i[s.getCurrentPage()];t instanceof l.SelectUI&&(t.openOptions(),e.preventDefault()),t instanceof u.LinkUI&&(t.activate(),e.preventDefault()),t instanceof c.BaseUI||e.preventDefault()}}],d)}return i.forEach(e=>{e instanceof c.BaseUI&&(e.addLocalHook("click",t(e)),e.addLocalHook("focus",t(e)),e.addLocalHook("afterClose",t(e)))}),n.addLocalHook("afterSelectionChange",e=>{e.key.startsWith("filter_")||s.clear()}),n.addLocalHook("afterSubmenuOpen",e),n.addLocalHook("afterOpen",e),{...s,listen:function(){n.focus(),n.getKeyboardShortcutsCtrl().listen(d)},getLastMenuPage:function(){return o}}};var a=r(967),l=r(956),c=r(955),u=r(961);const d="filters"},(e,t,r)=>{"use strict";t.__esModule=!0,t.createFocusNavigator=function(r){var e=(0,n.createPaginator)({initialPage:0,size:()=>r.length,onItemSelect:(e,t)=>{e=r[e];return e instanceof o.MultipleSelectUI?t:!(e.element&&!(0,i.isVisible)(e.element))&&void e.focus()}});return e};var n=r(883),i=r(334),o=r(960)},(e,t,r)=>{"use strict";r.r(t)},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(970);t.PLUGIN_KEY=r.PLUGIN_KEY,t.PLUGIN_PRIORITY=r.PLUGIN_PRIORITY,t.Formulas=r.Formulas},(L,e,t)=>{"use strict";var r=t(197),i=(e.__esModule=!0,t(204),t(286),t(483),t(290),t(302),t(305),t(309),t(312),t(315),t(318),r(t(487))),n=t(813),o=r(t(501)),s=t(500),a=t(512),l=t(337),c=t(971),v=t(973),u=t(972),d=t(596),h=t(335),p=r(t(494)),f=r(t(974));function g(e,t,r){m(e,t),t.set(e,r)}function m(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function y(e,t,r){e.set(w(e,t),r)}function b(e,t){return e.get(w(e,t))}function w(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}const C=e.PLUGIN_KEY="formulas",E=e.SETTING_KEYS=["maxRows","maxColumns","language"],T=(e.PLUGIN_PRIORITY=260,p.default.getSingleton().register("afterNamedExpressionAdded"),p.default.getSingleton().register("afterNamedExpressionRemoved"),p.default.getSingleton().register("afterSheetAdded"),p.default.getSingleton().register("afterSheetRemoved"),p.default.getSingleton().register("afterSheetRenamed"),p.default.getSingleton().register("afterFormulasValuesUpdate"),e=>"UndoRedo.undo"===e||"UndoRedo.redo"===e||"auto"===e);var S=new WeakMap,_=new WeakMap,x=new WeakMap,R=new WeakSet;class A extends n.BasePlugin{constructor(){var n,e,t;super(...arguments),m(e=n=this,t=R),t.add(e),g(this,S,!1),g(this,_,!1),g(this,x,[["valuesUpdated",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return w(R,n,q).call(n,...t)}],["namedExpressionAdded",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return w(R,n,K).call(n,...t)}],["namedExpressionRemoved",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return w(R,n,X).call(n,...t)}],["sheetAdded",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return w(R,n,J).call(n,...t)}],["sheetRenamed",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return w(R,n,Z).call(n,...t)}],["sheetRemoved",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return w(R,n,Q).call(n,...t)}]]),(0,i.default)(this,"staticRegister",(0,o.default)("formulas")),(0,i.default)(this,"engine",null),(0,i.default)(this,"sheetName",null),(0,i.default)(this,"indexSyncer",null),(0,i.default)(this,"rowAxisSyncer",null),(0,i.default)(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return C}static get PLUGIN_PRIORITY(){return 260}static get SETTING_KEYS(){return[C,...E]}get sheetId(){return null===this.sheetName?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[C]}enablePlugin(){var e,n=this;this.enabled||(this.engine=null!=(e=(0,c.setupEngine)(this.hot))?e:this.engine,this.engine?(null===this.sheetName||this.engine.doesSheetExist(this.sheetName)||!1!==(e=this.addSheet(this.sheetName,this.hot.getSourceDataArray()))&&(this.sheetName=e),this.addHook("beforeLoadData",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return w(R,n,I).call(n,...t)}),this.addHook("afterLoadData",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return w(R,n,k).call(n,...t)}),this.addHook("beforeUpdateData",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return w(R,n,I).call(n,...t)}),this.addHook("afterUpdateData",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return w(R,n,k).call(n,...t)}),this.addHook("modifyData",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return w(R,n,D).call(n,...t)}),this.addHook("modifySourceData",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return w(R,n,F).call(n,...t)}),this.addHook("beforeValidate",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return w(R,n,N).call(n,...t)}),this.addHook("afterSetSourceDataAtCell",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return w(R,n,H).call(n,...t)}),this.addHook("afterSetDataAtCell",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return w(R,n,P).call(n,...t)}),this.addHook("afterSetDataAtRowProp",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return w(R,n,P).call(n,...t)}),this.addHook("beforeCreateRow",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return w(R,n,U).call(n,...t)}),this.addHook("beforeCreateCol",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return w(R,n,V).call(n,...t)}),this.addHook("afterCreateRow",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return w(R,n,B).call(n,...t)}),this.addHook("afterCreateCol",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return w(R,n,j).call(n,...t)}),this.addHook("beforeRemoveRow",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return w(R,n,W).call(n,...t)}),this.addHook("beforeRemoveCol",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return w(R,n,$).call(n,...t)}),this.addHook("afterRemoveRow",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return w(R,n,z).call(n,...t)}),this.addHook("afterRemoveCol",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return w(R,n,Y).call(n,...t)}),this.indexSyncer=new f.default(this.hot.rowIndexMapper,this.hot.columnIndexMapper,e=>{this.hot.addHookOnce("init",()=>{e()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(e,t,r,n)=>{this.rowAxisSyncer.storeMovesInformation(e,t,n)}),this.hot.addHook("beforeColumnMove",(e,t,r,n)=>{this.columnAxisSyncer.storeMovesInformation(e,t,n)}),this.hot.addHook("afterRowMove",(e,t,r,n,i)=>{this.rowAxisSyncer.calculateAndSyncMoves(n,i)}),this.hot.addHook("afterColumnMove",(e,t,r,n,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(n,i)}),this.hot.addHook("beforeColumnFreeze",(e,t)=>{this.columnAxisSyncer.storeMovesInformation([e],this.hot.getSettings().fixedColumnsStart,t)}),this.hot.addHook("afterColumnFreeze",(e,t)=>{this.columnAxisSyncer.calculateAndSyncMoves(t,t)}),this.hot.addHook("beforeColumnUnfreeze",(e,t)=>{this.columnAxisSyncer.storeMovesInformation([e],this.hot.getSettings().fixedColumnsStart-1,t)}),this.hot.addHook("afterColumnUnfreeze",(e,t)=>{this.columnAxisSyncer.calculateAndSyncMoves(t,t)}),this.addHook("afterCellMetaReset",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return w(R,n,M).call(n,...t)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return w(R,n,G).call(n,...t)}),this.addHook("beforeAutofill",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return w(R,n,O).call(n,...t)}),b(x,this).forEach(e=>{var[e,t]=e;return this.engine.on(e,t)}),super.enablePlugin()):(0,s.warn)("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance."))}disablePlugin(){b(x,this).forEach(e=>{var[e,t]=e;return this.engine.off(e,t)}),(0,c.unregisterEngine)(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){var t=(0,u.getEngineSettingsWithOverrides)(this.hot.getSettings()),t=((0,u.haveEngineSettingsChanged)(this.engine.getConfig(),t)&&this.engine.updateConfig(t),this.hot.getSettings()[C]);(0,l.isDefined)(t)&&(0,l.isDefined)(t.sheetName)&&t.sheetName!==this.sheetName&&this.switchSheet(t.sheetName),e.data||null!==this.sheetName||((t=this.hot.getSettings()[C].sheetName)&&this.engine.doesSheetExist(t)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(null!=t?t:void 0,this.hot.getSourceDataArray())),super.updatePlugin(e)}destroy(){b(x,this).forEach(e=>{var t,[e,r]=e;return null==(t=this.engine)?void 0:t.off(e,r)}),y(x,this,null),(0,c.unregisterEngine)(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,t){if((0,l.isDefined)(t)&&!(0,d.isArrayOfArrays)(t))return(0,s.warn)("The provided data should be an array of arrays."),!1;if(null!=e&&this.engine.doesSheetExist(e))return(0,s.warn)("Sheet with the provided name already exists."),!1;try{var r=this.engine.addSheet(null!=e?e:void 0);return t&&this.engine.setSheetContent(this.engine.getSheetId(r),t),r}catch(e){return(0,s.warn)(e.message),!1}}switchSheet(e){var t;this.engine.doesSheetExist(e)?(this.sheetName=e,0<(t=this.engine.getSheetSerialized(this.sheetId)).length&&this.hot.loadData(t,(0,h.toUpperCaseFirst)(C)+".switchSheet")):(0,s.error)(`The sheet named \`${e}\` does not exist, switch aborted.`)}getCellType(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:this.sheetId,n=this.hot.toPhysicalRow(e),i=this.hot.toPhysicalColumn(t);return null!==n&&null!==i?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)}):"EMPTY"}isFormulaCellType(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)})}renderDependentSheets(e){let r=1<arguments.length&&void 0!==arguments[1]&&arguments[1];const n=new Set;e.forEach(e=>{e=null==e||null==(e=e.address)?void 0:e.sheet;void 0===e||n.has(e)||n.add(e)}),(0,c.getRegisteredHotInstances)(this.engine).forEach((e,t)=>{(r||t!==this.sheetId)&&n.has(t)&&(e.render(),null!=(t=e.view))&&t.adjustElementsSize()})}validateDependentCells(e){const i=e=>{var{row:e,col:t,sheet:r}=null!=(e=null==e?void 0:e.address)?e:{};return(0,l.isDefined)(r)?r+`:${e}x`+t:""},o=new Set((1<arguments.length&&void 0!==arguments[1]?arguments[1]:[]).map(e=>i(e)));e.forEach(e=>{var t,{row:r,col:n}=null!=(r=e.address)?r:{};!1===(0,l.isDefined)(r)||!1===(0,l.isDefined)(n)||r>=this.hot.countRows()||n>=this.hot.countCols()||(t=null==e||null==(t=e.address)?void 0:t.sheet,e=i(e),void 0===t)||o.has(e)||(e=(0,c.getRegisteredHotInstances)(this.engine).get(t))&&e.validateCell(e.getDataAtCell(r,n),e.getCellMeta(r,n),()=>{})})}syncChangeWithEngine(e,t,r){var n={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId};if(this.engine.isItPossibleToSetCellContents(n))return e=this.hot.getCellMeta(e,t),(0,v.isDate)(r,e.type)&&((0,v.isDateValid)(r,e.dateFormat)?r=(0,v.getDateInHfFormat)(r,e.dateFormat):!1===(0,v.isFormula)(r)&&(r="'"+r)),this.engine.setCellContents(n,r);(0,s.warn)("Not possible to set cell data at "+JSON.stringify(n))}}function N(e,t,r){r=this.hot.propToCol(r);if(this.isFormulaCellType(t,r)){var n={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},t=this.hot.getCellMeta(t,r);let e=this.engine.getCellValue(n);return"object"==typeof(e="date"===t.type&&(0,a.isNumeric)(e)?(0,v.getDateFromExcelDate)(e,t.dateFormat):e)&&null!==e?e.value:e}return e}function O(e,t,r){var{row:n,col:i}=t.getTopStartCorner(),{row:t,col:o}=t.getBottomEndCorner(),{row:s,col:a}=r.getTopStartCorner(),{row:r,col:l}=r.getBottomEndCorner(),n={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(n),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId}},i={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(a),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId}};if(!1===this.engine.isItPossibleToSetCellContents(i))return!1;var c=this.engine.getFillRangeData(n,i),{row:u,col:d}=n.start,{row:t,col:o}=n.end,h=t-u+1,p=o-d+1;for(let t=0;t<c.length;t+=1)for(let e=0;e<c[t].length;e+=1){var f=c[t][e],g=u+t%h,m=d+e%p,y=this.hot.getCellMeta(g,m);(0,v.isDate)(f,y.type)&&(f.startsWith("'")?c[t][e]=f.slice(1):!1===this.isFormulaCellType(g,m,this.sheetId)&&(c[t][e]=(0,v.getDateInHotFormat)(f,y.dateFormat)))}return c}function I(e,t){(2<arguments.length&&void 0!==arguments[2]?arguments[2]:"").includes((0,h.toUpperCaseFirst)(C))||y(_,this,(0,l.isUndefined)(this.hot.getSettings().data))}function M(){const o=this.hot.getSourceDataArray();let s=!1;o.forEach((e,i)=>{e.forEach((e,t)=>{var r=this.hot.getCellMeta(i,t),n=r.dateFormat;(0,v.isDate)(e,r.type)&&(s=!0,(0,v.isDateValid)(e,n)?o[i][t]=(0,v.getDateInHfFormat)(e,n):!1===this.isFormulaCellType(i,t)&&(o[i][t]="'"+e))})}),!0===s&&(y(S,this,!0),this.engine.setSheetContent(this.sheetId,o),y(S,this,!1))}function k(e,t){var r;(2<arguments.length&&void 0!==arguments[2]?arguments[2]:"").includes((0,h.toUpperCaseFirst)(C))||(this.sheetName=(0,c.setupSheet)(this.engine,this.hot.getSettings()[C].sheetName),b(_,this)?this.switchSheet(this.sheetName):(r=this.hot.getSourceDataArray(),this.engine.isItPossibleToReplaceSheetContent(this.sheetId,r)&&(y(S,this,!0),r=this.engine.setSheetContent(this.sheetId,r),this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(r),y(S,this,!1))))}function D(r,n,i,o){if("get"===o&&!b(S,this)&&null!==this.sheetName&&this.engine.doesSheetExist(this.sheetName)){const s=this.hot.toVisualRow(r);if(null!==s&&null!==n){o=this.isFormulaCellType(s,n);if(!o)if("ARRAY"!==this.getCellType(s,n))return void((0,v.isEscapedFormulaExpression)(i.value)&&(i.value=(0,v.unescapeFormulaExpression)(i.value)));r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};let e=this.engine.getCellValue(r),t=this.hot.getCellsMeta().find(e=>e.visualRow===s&&e.visualCol===n);void 0===t&&(t={});o="object"==typeof(e="date"===t.type&&(0,a.isNumeric)(e)?(0,v.getDateFromExcelDate)(e,t.dateFormat):e)&&null!==e?e.value:e;i.value=o}}}function F(e,t,r,n){if("get"===n&&!b(S,this)&&null!==this.sheetName&&this.engine.doesSheetExist(this.sheetName)){n=this.hot.toVisualRow(e),e=this.hot.propToCol(t);if(null!==n&&null!==e){t=this.isFormulaCellType(n,e);if(!t)if("ARRAY"!==this.getCellType(n,e))return;var t=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));0===t.width&&0===t.height||(t={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(n),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId},r.value=this.engine.getCellSerialized(t))}}}function P(e,t){if(!T(t)){const s=[],a=[];t=this.engine.batch(()=>{e.forEach(e=>{var[e,t,,r]=e,t=this.hot.propToCol(t),n=this.hot.toPhysicalRow(e),i=this.hot.toPhysicalColumn(t),o={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId};null!==n&&null!==i?this.syncChangeWithEngine(e,t,r):s.push([e,t,r]),a.push({address:o})})});s.length&&this.hot.addHookOnce("afterChange",()=>{var e=this.engine.batch(()=>{s.forEach(e=>{var[e,t,r]=e;this.syncChangeWithEngine(e,t,r)})});this.renderDependentSheets(e,!0)}),this.renderDependentSheets(t),this.validateDependentCells(t,a)}}function H(e,t){if(!T(t)){const n=[],i=[];e.forEach(e=>{var[e,t,,r]=e,t=this.hot.propToCol(t);(0,a.isNumeric)(t)&&(e={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId},this.engine.isItPossibleToSetCellContents(e)?(i.push({address:e}),n.push(...this.engine.setCellContents(e,r))):(0,s.warn)("Not possible to set source cell data at "+JSON.stringify(e)))}),this.renderDependentSheets(n),this.validateDependentCells(n,i)}}function U(e,t){let r=this.rowAxisSyncer.getHfIndexFromVisualIndex(e);if(e>=this.hot.countRows()&&(r=e),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[r,t]))return!1}function V(e,t){let r=this.columnAxisSyncer.getHfIndexFromVisualIndex(e);if(e>=this.hot.countCols()&&(r=e),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[r,t]))return!1}function W(e,t,r){return!1!==this.rowAxisSyncer.setRemovedHfIndexes(r).every(e=>this.engine.isItPossibleToRemoveRows(this.sheetId,[e,1]))&&void 0}function $(e,t,r){return!1!==this.columnAxisSyncer.setRemovedHfIndexes(r).every(e=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[e,1]))&&void 0}function B(e,t,r){T(r)||(r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(e),t]),this.renderDependentSheets(r))}function j(e,t,r){T(r)||(r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(e),t]),this.renderDependentSheets(r))}function z(e,t,r,n){if(!T(n)){const i=this.rowAxisSyncer.getRemovedHfIndexes().sort((e,t)=>t-e);n=this.engine.batch(()=>{i.forEach(e=>{this.engine.removeRows(this.sheetId,[e,1])})});this.renderDependentSheets(n)}}function Y(e,t,r,n){if(!T(n)){const i=this.columnAxisSyncer.getRemovedHfIndexes().sort((e,t)=>t-e);n=this.engine.batch(()=>{i.forEach(e=>{this.engine.removeColumns(this.sheetId,[e,1])})});this.renderDependentSheets(n)}}function G(e,t,n){y(S,this,!0);t=this.hot.getSourceDataArray(n,0,n+((null==(t=t.__children)?void 0:t.length)||0),this.hot.countSourceCols());y(S,this,!1),t.forEach((e,r)=>{e.forEach((e,t)=>{this.engine.setCellContents({col:t,row:n+r,sheet:this.sheetId},[[e]])})})}function q(e){this.hot.runHooks("afterFormulasValuesUpdate",e)}function K(e,t){this.hot.runHooks("afterNamedExpressionAdded",e,t)}function X(e,t){this.hot.runHooks("afterNamedExpressionRemoved",e,t)}function J(e){this.hot.runHooks("afterSheetAdded",e)}function Z(e,t){this.sheetName=t,this.hot.runHooks("afterSheetRenamed",e,t)}function Q(e,t){this.hot.runHooks("afterSheetRemoved",e,t)}e.Formulas=A},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,t.getRegisteredHotInstances=function(e){var t=d(),e=0===t.size?[]:Array.from(null!=(t=t.get(e))?t:[]);return new Map(e.map(e=>[e.getPlugin("formulas").sheetId,e]))},t.registerCustomFunctions=f,t.registerEngine=p,t.registerLanguage=g,t.registerNamedExpressions=m,t.setupEngine=function(e){var t=e.getSettings(),r=t[c.PLUGIN_KEY],n=null==r?void 0:r.engine;if(!0!==r&&!(0,o.isUndefined)(n)){if("function"==typeof n.hyperformula||"function"==typeof n)return p(null!=(r=n.hyperformula)?r:n,t,e);if("object"==typeof n&&(0,o.isUndefined)(n.hyperformula))return r=d(),t=h().get(n),r.has(n)||r.set(n,[]),r.get(n).push(e),t&&t.push(e.guid),n.getConfig().licenseKey||n.updateConfig({licenseKey:u.DEFAULT_LICENSE_KEY}),n.getConfig().leapYear1900===u.DEFAULT_SETTINGS.leapYear1900&&!1!==(0,l.isObjectEqual)(n.getConfig().nullDate,u.DEFAULT_SETTINGS.nullDate)||(0,a.warn)((0,s.toSingleLine)`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),n}return null},t.setupSheet=function(e,t){!(0,o.isUndefined)(t)&&e.doesSheetExist(t)||(t=e.addSheet(t));return t},t.unregisterEngine=function(e,t){{var r,n,i,o;e&&(r=d(),n=r.get(e),i=h(),o=i.get(e),n&&n.includes(t)&&(n.splice(n.indexOf(t),1),0===n.length)&&r.delete(e),o)&&o.includes(t.guid)&&(o.splice(o.indexOf(t.guid),1),0===o.length)&&(i.delete(e),e.destroy())}},r(286),n(r(501))),o=r(337),s=r(477),a=r(500),l=r(482),c=r(970),u=r(972);function d(){var e="engine_relationship",t=(0,i.default)(c.PLUGIN_KEY);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function h(){var e="shared_engine_usage",t=(0,i.default)(c.PLUGIN_KEY);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function p(e,t,r){var n=t[c.PLUGIN_KEY],t=(0,u.getEngineSettingsWithDefaultsAndOverrides)(t),i=d(),o=h();f(e,n.functions),g(e,n.language);const s=e.buildEmpty(t);return i.set(s,[r]),o.set(s,[r.guid]),m(s,n.namedExpressions),s.on("sheetAdded",()=>{s.rebuildAndRecalculate()}),s.on("sheetRemoved",()=>{s.rebuildAndRecalculate()}),s}function f(n,e){e&&e.forEach(e=>{var{name:e,plugin:t,translations:r}=e;try{n.registerFunction(e,t,r)}catch(e){(0,a.warn)(e.message)}})}function g(e,t){if(t){var r=t["langCode"];try{e.registerLanguage(r,t)}catch(e){(0,a.warn)(e.message)}}}function m(i,e){e&&(i.suspendEvaluation(),e.forEach(e=>{var{name:e,expression:t,scope:r,options:n}=e;try{i.addNamedExpression(e,t,r,n)}catch(e){(0,a.warn)(e.message)}}),i.resumeEvaluation())}},(e,t,r)=>{"use strict";t.__esModule=!0,t.getEngineSettingsOverrides=o,t.getEngineSettingsWithDefaultsAndOverrides=function(e){var t=e[n.PLUGIN_KEY],r=s(null!=t&&null!=(r=t.engine)&&r.hyperformula?t.engine:{}),t=o(e);return{...i,...r,...t}},t.getEngineSettingsWithOverrides=function(e){var t=e[n.PLUGIN_KEY],r=s(null!=t&&null!=(r=t.engine)&&r.hyperformula?t.engine:{}),t=o(e);return{...r,...t}},t.haveEngineSettingsChanged=function(t,r){return Object.keys(r).some(e=>void 0!==r[e]&&r[e]!==t[e])};var n=r(970);t.DEFAULT_LICENSE_KEY="internal-use-in-handsontable";const i=t.DEFAULT_SETTINGS={licenseKey:"internal-use-in-handsontable",useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function o(e){return{maxColumns:e.maxColumns,maxRows:e.maxRows,language:null==(e=e[n.PLUGIN_KEY])||null==(e=e.language)?void 0:e.langCode}}function s(r){return Object.keys(r).reduce((e,t)=>("hyperformula"!==t&&(e[t]=r[t]),e),{})}},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,t.getDateFromExcelDate=function(e,t){e=new Date(Date.UTC(0,0,e+-1));return(0,i.default)(e).format(t)},t.getDateInHfFormat=function(e,t){return(0,i.default)(e,t,!0).format(o)},t.getDateInHotFormat=function(e,t){return(0,i.default)(e,o,!0).format(t)},t.isDate=function(e,t){return"string"==typeof e&&"date"===t},t.isDateValid=function(e,t){return(0,i.default)(e,t,!0).isValid()},t.isEscapedFormulaExpression=s,t.isFormula=function(e){return"string"==typeof e&&e.startsWith("=")},t.unescapeFormulaExpression=function(e){return s(e)?e.substr(1):e},n(r(338)));const o="DD/MM/YYYY";function s(e){return"string"==typeof e&&"'"===e.charAt(0)&&"="===e.charAt(1)}},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),n(r(975)));function o(e,t,r){var n=e;if(t.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object");t.set(e,r)}function s(e,t){return e.get(l(e,t))}function a(e,t,r){e.set(l(e,t),r)}function l(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var c=new WeakMap,u=new WeakMap,d=new WeakMap,h=new WeakMap,p=new WeakMap,f=new WeakMap,g=new WeakMap;t.default=class{constructor(e,t,r){o(this,c,void 0),o(this,u,void 0),o(this,d,void 0),o(this,h,!1),o(this,p,!1),o(this,f,null),o(this,g,null),a(c,this,new i.default("row",e,this)),a(u,this,new i.default("column",t,this)),a(d,this,r)}getForAxis(e){return s("row"===e?c:u,this)}setPerformUndo(e){a(h,this,e)}setPerformRedo(e){a(p,this,e)}isPerformingUndoRedo(){return s(h,this)||s(p,this)}getSheetId(){return s(g,this)}getEngine(){return s(f,this)}getPostponeAction(){return s(d,this)}setupSyncEndpoint(e,t){a(f,this,e),a(g,this,t),s(c,this).init(),s(u,this).init()}}},(e,t,r)=>{"use strict";t.__esModule=!0,r(204),r(286);var o=r(335),n=r(976);function i(e,t,r){var n=e;if(t.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object");t.set(e,r)}function s(e,t){return e.get(l(e,t))}function a(e,t,r){e.set(l(e,t),r)}function l(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var c=new WeakMap,u=new WeakMap,d=new WeakMap,h=new WeakMap,p=new WeakMap,f=new WeakMap,g=new WeakMap;t.default=class{constructor(e,t,r){i(this,c,void 0),i(this,u,void 0),i(this,d,void 0),i(this,h,[]),i(this,p,[]),i(this,f,void 0),i(this,g,[]),a(c,this,e),a(u,this,t),a(d,this,r)}setRemovedHfIndexes(e){return a(g,this,e.map(e=>{e=s(u,this).getVisualFromPhysicalIndex(e);return this.getHfIndexFromVisualIndex(e)})),s(g,this)}getRemovedHfIndexes(){return s(g,this)}getHfIndexFromVisualIndex(e){var t=s(u,this).getIndexesSequence(),r=s(u,this).getNotTrimmedIndexes();return t.indexOf(r[e])}syncMoves(e){const n=`move${(0,o.toUpperCaseFirst)(s(c,this))}s`;s(d,this).getEngine().batch(()=>{e.forEach(e=>{var t=e.from!==e.to,r=e.from+1!==e.to;t&&r&&s(d,this).getEngine()[n](s(d,this).getSheetId(),e.from,1,e.to)})})}storeMovesInformation(e,t,r){!1!==r&&(a(p,this,e.map(e=>this.getHfIndexFromVisualIndex(e))),a(f,this,this.getHfIndexFromVisualIndex(t)))}calculateAndSyncMoves(e,t){if(!s(d,this).isPerformingUndoRedo()&&!1!==e&&!1!==t){const r=(0,n.getMoves)(s(p,this),s(f,this),s(u,this).getNumberOfIndexes());null===s(d,this).getSheetId()?s(d,this).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}}getIndexesChangeSyncMethod(){const i=`set${(0,o.toUpperCaseFirst)(s(c,this))}Order`;return e=>{if(!s(d,this).isPerformingUndoRedo()){const n=s(u,this).getIndexesSequence();if("update"===e&&0<n.length){var r=s(h,this).map(e=>n.indexOf(e)),e=s(d,this).getEngine().getSheetDimensions(s(d,this).getSheetId());let t;t="row"===s(c,this)?e.height:e.width;for(let e=r.length;e<t;e+=1)r.push(e);s(d,this).getEngine()[i](s(d,this).getSheetId(),r)}a(h,this,n)}}}init(){a(h,this,s(u,this).getIndexesSequence())}}},(e,t,r)=>{"use strict";t.__esModule=!0,t.getMoves=function(e,t,r){e=function(e,t){const r=[];return e.forEach(e=>{const n={from:e,to:t};r.forEach(e=>{var t=e.from>e.to,r=e.to<=n.from;e.from>n.from&&r&&t&&(n.from+=1)}),n.from>=t&&(t+=1),r.push(n)}),r}(e,function(t,e,r){r=Array.from(Array(r).keys()).filter(e=>!1===t.includes(e));return 0!==e?r[e-1]+1:null!=(r=r[e])?r:0}(e,t,r));return function(t){return t.forEach((r,e)=>{t.slice(e+1).forEach(e=>{var t=e.from<e.to;e.from>r.from&&t&&--e.from})}),t}(e)},r(286)},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(978);t.PLUGIN_KEY=r.PLUGIN_KEY,t.PLUGIN_PRIORITY=r.PLUGIN_PRIORITY,t.HiddenColumns=r.HiddenColumns},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),r(286),r(290),r(302),r(305),r(309),r(312),r(315),r(318),r(813)),o=r(334),s=r(512),a=r(478),l=r(482),c=r(337),u=r(853),d=n(r(494)),h=n(r(979)),p=n(r(980)),f=r(597);function g(e,t,r){m(e,t),t.set(e,r)}function m(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function y(e,t){return e.get(b(e,t))}function v(e,t,r){e.set(b(e,t),r)}function b(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}r(981),d.default.getSingleton().register("beforeHideColumns"),d.default.getSingleton().register("afterHideColumns"),d.default.getSingleton().register("beforeUnhideColumns"),d.default.getSingleton().register("afterUnhideColumns");const w=t.PLUGIN_KEY="hiddenColumns";t.PLUGIN_PRIORITY=310;var C=new WeakMap,E=new WeakMap,T=new WeakSet;class S extends i.BasePlugin{constructor(){var e,t;super(...arguments),m(e=this,t=T),t.add(e),g(this,C,{}),g(this,E,null)}static get PLUGIN_KEY(){return w}static get PLUGIN_PRIORITY(){return 310}isEnabled(){return!!this.hot.getSettings()[w]}enablePlugin(){var e,n=this;this.enabled||(e=this.hot.getSettings()[w],(0,l.isObject)(e)&&(v(C,this,e),(0,c.isUndefined)(e.copyPasteEnabled))&&(e.copyPasteEnabled=!0),v(E,this,new f.HidingMap),y(E,this).addLocalHook("init",()=>b(T,this,O).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,y(E,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return b(T,n,N).call(n,...t)}),this.addHook("afterGetCellMeta",(e,t,r)=>b(T,this,x).call(this,e,t,r)),this.addHook("modifyColWidth",(e,t)=>b(T,this,_).call(this,e,t),2),this.addHook("afterGetColHeader",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return b(T,n,A).call(n,...t)}),this.addHook("modifyCopyableRange",e=>b(T,this,R).call(this,e)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),v(C,this,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){var t=this.getHiddenColumns(),r=this.isValidConfig(e);let n=t;const i=y(E,this).getValues().slice();var o=0<e.length,e=(r&&o&&(e=e.map(e=>this.hot.toPhysicalColumn(e)),(0,a.arrayEach)(e,e=>{i[e]=!1}),n=(0,a.arrayReduce)(i,(e,t,r)=>(t&&e.push(this.hot.toVisualColumn(r)),e),[])),this.hot.runHooks("beforeUnhideColumns",t,n,r&&o));!1!==e&&(r&&o&&y(E,this).setValues(i),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",t,n,r&&o,r&&n.length<t.length))}showColumn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.showColumns(t)}hideColumns(e){var t=this.getHiddenColumns(),r=this.isValidConfig(e);let n=t;r&&(n=Array.from(new Set(t.concat(e)))),!1!==this.hot.runHooks("beforeHideColumns",t,n,r)&&(r&&this.hot.batchExecution(()=>{(0,a.arrayEach)(e,e=>{y(E,this).setValueAtIndex(this.hot.toPhysicalColumn(e),!0)})},!0),this.hot.runHooks("afterHideColumns",t,n,r,r&&n.length>t.length))}hideColumn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.hideColumns(t)}getHiddenColumns(){return(0,a.arrayMap)(y(E,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return y(E,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const t=this.hot.countCols();return!!(Array.isArray(e)&&0<e.length)&&e.every(e=>Number.isInteger(e)&&0<=e&&e<t)}resetCellsMeta(){(0,a.arrayEach)(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}destroy(){v(C,this,null),v(E,this,null),super.destroy()}}function _(e,t){return this.isHidden(t)?0:y(C,this).indicators&&(this.isHidden(t+1)||this.isHidden(t-1))&&"number"==typeof e&&this.hot.hasColHeaders()?e+15:void 0}function x(e,t,r){var n;!1===y(C,this).copyPasteEnabled&&this.isHidden(t)&&(r.skipColumnOnPaste=!0),this.isHidden(t-1)?(r.className=r.className||"",-1===r.className.indexOf("afterHiddenColumn")&&(r.className+=" afterHiddenColumn")):r.className&&0<(t=r.className.split(" ")).length&&(-1<(n=t.indexOf("afterHiddenColumn"))&&t.splice(n,1),r.className=t.join(" "))}function R(e){if(y(C,this).copyPasteEnabled)return e;const i=[],o=(e,t,r,n)=>{i.push({startRow:e,endRow:t,startCol:r,endCol:n})};return(0,a.arrayEach)(e,t=>{let r=!0,n=0;(0,s.rangeEach)(t.startCol,t.endCol,e=>{r=this.isHidden(e)?(r||o(t.startRow,t.endRow,n,e-1),!0):(r&&(n=e),e===t.endCol&&o(t.startRow,t.endRow,n,e),!1)})}),i}function A(e,t){var r;!y(C,this).indicators||e<0||(r=[],1<=e&&this.isHidden(e-1)&&r.push("afterHiddenColumn"),e<this.hot.countCols()-1&&this.isHidden(e+1)&&r.push("beforeHiddenColumn"),(0,o.addClass)(t,r))}function N(e){e.items.push({name:u.SEPARATOR},(0,h.default)(this),(0,p.default)(this))}function O(){Array.isArray(y(C,this).columns)&&this.hideColumns(y(C,this).columns)}t.HiddenColumns=S},(e,t,r)=>{"use strict";t.__esModule=!0,t.default=function(o){return{key:"hidden_columns_hide",name(){var e,t=this.getSelectedLast();let r=0;return Array.isArray(t)&&([,t,,e]=t,t-e!=0)&&(r=1),this.getTranslatedPhrase(n.CONTEXTMENU_ITEMS_HIDE_COLUMN,r)},callback(){var{from:e,to:t}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,t.col),0),n=Math.max(e.col,t.col),i=[];for(let e=r;e<=n;e+=1)i.push(e);o.hideColumns(i);e=this.columnIndexMapper.getNearestNotHiddenIndex(i[i.length-1],1,!0);Number.isInteger(e)&&0<=e?this.selectColumns(e):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}},r(286);var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621));function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}},(e,t,r)=>{"use strict";t.__esModule=!0,t.default=function(c){const u=[];return{key:"hidden_columns_show",name(){var e=1<u.length?1:0;return this.getTranslatedPhrase(n.CONTEXTMENU_ITEMS_SHOW_COLUMN,e)},callback(){var e,t,r;0!==u.length&&(t=u[0],r=u[u.length-1],t=null!=(e=this.columnIndexMapper.getNearestNotHiddenIndex(t-1,-1))?e:0,r=null!=(e=this.columnIndexMapper.getNearestNotHiddenIndex(r+1,1))?e:this.countCols()-1,c.showColumns(u),this.render(),this.view.adjustElementsSize(),r-t+1!==this.countCols())&&this.selectColumns(t,r)},disabled:!1,hidden(){const t=(0,d.arrayMap)(c.getHiddenColumns(),e=>this.toPhysicalColumn(e));if(!this.selection.isSelectedByColumnHeader()&&!this.selection.isSelectedByCorner()||t.length<1)return!0;u.length=0;var e,r=this.getSelectedRangeLast(),n=r.getTopStartCorner().col,r=r.getBottomEndCorner().col,i=this.columnIndexMapper,o=i.getRenderableFromVisualIndex(n),s=i.getRenderableFromVisualIndex(r),a=i.getNotTrimmedIndexes(),l=[];return n!==r?s-o+1<r-n+1&&(e=a.slice(n,r+1),l.push(...e.filter(e=>t.includes(e)))):0===o&&o<n?l.push(...a.slice(0,n)):null===o?l.push(...a.slice(0,this.countCols())):(e=this.countCols()-1,s===i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(e,-1))&&r<e&&l.push(...a.slice(r+1))),(0,d.arrayEach)(l,e=>{u.push(this.toVisualColumn(e))}),0===u.length}}},r(286);var d=r(478),n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621));function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}},(e,t,r)=>{"use strict";r.r(t)},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(983);t.PLUGIN_KEY=r.PLUGIN_KEY,t.PLUGIN_PRIORITY=r.PLUGIN_PRIORITY,t.HiddenRows=r.HiddenRows},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),r(286),r(290),r(302),r(305),r(309),r(312),r(315),r(318),r(813)),o=r(334),s=r(512),a=r(478),l=r(482),c=r(337),u=r(853),d=n(r(494)),h=n(r(984)),p=n(r(985)),f=r(597);function g(e,t,r){m(e,t),t.set(e,r)}function m(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function y(e,t){return e.get(b(e,t))}function v(e,t,r){e.set(b(e,t),r)}function b(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}r(986),d.default.getSingleton().register("beforeHideRows"),d.default.getSingleton().register("afterHideRows"),d.default.getSingleton().register("beforeUnhideRows"),d.default.getSingleton().register("afterUnhideRows");const w=t.PLUGIN_KEY="hiddenRows";t.PLUGIN_PRIORITY=320;var C=new WeakMap,E=new WeakMap,T=new WeakSet;class S extends i.BasePlugin{constructor(){var e,t;super(...arguments),m(e=this,t=T),t.add(e),g(this,C,{}),g(this,E,null)}static get PLUGIN_KEY(){return w}static get PLUGIN_PRIORITY(){return 320}isEnabled(){return!!this.hot.getSettings()[w]}enablePlugin(){var e,n=this;this.enabled||(e=this.hot.getSettings()[w],(0,l.isObject)(e)&&(v(C,this,e),(0,c.isUndefined)(e.copyPasteEnabled))&&(e.copyPasteEnabled=!0),v(E,this,new f.HidingMap),y(E,this).addLocalHook("init",()=>b(T,this,O).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,y(E,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return b(T,n,N).call(n,...t)}),this.addHook("afterGetCellMeta",(e,t,r)=>b(T,this,x).call(this,e,t,r)),this.addHook("modifyRowHeight",(e,t)=>b(T,this,_).call(this,e,t)),this.addHook("afterGetRowHeader",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return b(T,n,A).call(n,...t)}),this.addHook("modifyCopyableRange",e=>b(T,this,R).call(this,e)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),v(C,this,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(e){var t=this.getHiddenRows(),r=this.isValidConfig(e);let n=t;const i=y(E,this).getValues().slice();var o=0<e.length,e=(r&&o&&(e=e.map(e=>this.hot.toPhysicalRow(e)),(0,a.arrayEach)(e,e=>{i[e]=!1}),n=(0,a.arrayReduce)(i,(e,t,r)=>(t&&e.push(this.hot.toVisualRow(r)),e),[])),this.hot.runHooks("beforeUnhideRows",t,n,r&&o));!1!==e&&(r&&o&&y(E,this).setValues(i),this.hot.runHooks("afterUnhideRows",t,n,r&&o,r&&n.length<t.length))}showRow(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.showRows(t)}hideRows(e){var t=this.getHiddenRows(),r=this.isValidConfig(e);let n=t;r&&(n=Array.from(new Set(t.concat(e)))),!1!==this.hot.runHooks("beforeHideRows",t,n,r)&&(r&&this.hot.batchExecution(()=>{(0,a.arrayEach)(e,e=>{y(E,this).setValueAtIndex(this.hot.toPhysicalRow(e),!0)})},!0),this.hot.runHooks("afterHideRows",t,n,r,r&&n.length>t.length))}hideRow(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.hideRows(t)}getHiddenRows(){return(0,a.arrayMap)(y(E,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return y(E,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const t=this.hot.countRows();return!!(Array.isArray(e)&&0<e.length)&&e.every(e=>Number.isInteger(e)&&0<=e&&e<t)}resetCellsMeta(){(0,a.arrayEach)(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}destroy(){v(C,this,null),v(E,this,null),super.destroy()}}function _(e,t){return this.isHidden(t)?0:e}function x(e,t,r){var n;!1===y(C,this).copyPasteEnabled&&this.isHidden(e)&&(r.skipRowOnPaste=!0),this.isHidden(e-1)?(r.className=r.className||"",-1===r.className.indexOf("afterHiddenRow")&&(r.className+=" afterHiddenRow")):r.className&&0<(e=r.className.split(" ")).length&&(-1<(n=e.indexOf("afterHiddenRow"))&&e.splice(n,1),r.className=e.join(" "))}function R(e){if(y(C,this).copyPasteEnabled)return e;const i=[],o=(e,t,r,n)=>{i.push({startRow:e,endRow:t,startCol:r,endCol:n})};return(0,a.arrayEach)(e,t=>{let r=!0,n=0;(0,s.rangeEach)(t.startRow,t.endRow,e=>{r=this.isHidden(e)?(r||o(n,e-1,t.startCol,t.endCol),!0):(r&&(n=e),e===t.endRow&&o(n,e,t.startCol,t.endCol),!1)})}),i}function A(e,t){var r;!y(C,this).indicators||e<0||(r=[],1<=e&&this.isHidden(e-1)&&r.push("afterHiddenRow"),e<this.hot.countRows()-1&&this.isHidden(e+1)&&r.push("beforeHiddenRow"),(0,o.addClass)(t,r))}function N(e){e.items.push({name:u.SEPARATOR},(0,h.default)(this),(0,p.default)(this))}function O(){Array.isArray(y(C,this).rows)&&this.hideRows(y(C,this).rows)}t.HiddenRows=S},(e,t,r)=>{"use strict";t.__esModule=!0,t.default=function(o){return{key:"hidden_rows_hide",name(){var e,t=this.getSelectedLast();let r=0;return Array.isArray(t)&&([t,,e]=t,t-e!=0)&&(r=1),this.getTranslatedPhrase(n.CONTEXTMENU_ITEMS_HIDE_ROW,r)},callback(){var{from:e,to:t}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,t.row),0),n=Math.max(e.row,t.row),i=[];for(let e=r;e<=n;e+=1)i.push(e);o.hideRows(i);e=this.rowIndexMapper.getNearestNotHiddenIndex(i[i.length-1],1,!0);Number.isInteger(e)&&0<=e?this.selectRows(e):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}},r(286);var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621));function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}},(e,t,r)=>{"use strict";t.__esModule=!0,t.default=function(c){const u=[];return{key:"hidden_rows_show",name(){var e=1<u.length?1:0;return this.getTranslatedPhrase(n.CONTEXTMENU_ITEMS_SHOW_ROW,e)},callback(){var e,t,r;0!==u.length&&(t=u[0],r=u[u.length-1],t=null!=(e=this.rowIndexMapper.getNearestNotHiddenIndex(t-1,-1))?e:0,r=null!=(e=this.rowIndexMapper.getNearestNotHiddenIndex(r+1,1))?e:this.countRows()-1,c.showRows(u),this.render(),this.view.adjustElementsSize(),r-t+1!==this.countRows())&&this.selectRows(t,r)},disabled:!1,hidden(){const t=(0,d.arrayMap)(c.getHiddenRows(),e=>this.toPhysicalRow(e));if(!this.selection.isSelectedByRowHeader()&&!this.selection.isSelectedByCorner()||t.length<1)return!0;u.length=0;var e,r=this.getSelectedRangeLast(),n=r.getTopStartCorner().row,r=r.getBottomEndCorner().row,i=this.rowIndexMapper,o=i.getRenderableFromVisualIndex(n),s=i.getRenderableFromVisualIndex(r),a=i.getNotTrimmedIndexes(),l=[];return n!==r?s-o+1<r-n+1&&(e=a.slice(n,r+1),l.push(...e.filter(e=>t.includes(e)))):0===o&&o<n?l.push(...a.slice(0,n)):null===o?l.push(...a.slice(0,this.countRows())):(e=this.countRows()-1,s===i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(e,-1))&&r<e&&l.push(...a.slice(r+1))),(0,d.arrayEach)(l,e=>{u.push(this.toVisualRow(e))}),0===u.length}}},r(286);var d=r(478),n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621));function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}},(e,t,r)=>{"use strict";r.r(t)},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(988);t.PLUGIN_KEY=r.PLUGIN_KEY,t.PLUGIN_PRIORITY=r.PLUGIN_PRIORITY,t.ManualColumnFreeze=r.ManualColumnFreeze},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),r(286),r(813)),o=n(r(494)),s=n(r(989)),a=n(r(990));function l(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function c(e,t){return e.get(d(e,t))}function u(e,t,r){e.set(d(e,t),r)}function d(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}r(991),o.default.getSingleton().register("beforeColumnFreeze"),o.default.getSingleton().register("afterColumnFreeze"),o.default.getSingleton().register("beforeColumnUnfreeze"),o.default.getSingleton().register("afterColumnUnfreeze");const h=t.PLUGIN_KEY="manualColumnFreeze";t.PLUGIN_PRIORITY=110;var p=new WeakMap,f=new WeakSet;class g extends i.BasePlugin{constructor(){var e,t,r;super(...arguments),l(e=this,r=f),r.add(e),r=!1,l(e=this,t=p),t.set(e,r)}static get PLUGIN_KEY(){return h}static get PLUGIN_PRIORITY(){return 110}isEnabled(){return!!this.hot.getSettings()[h]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>d(f,this,m).call(this,e)),this.addHook("beforeColumnMove",(e,t)=>d(f,this,y).call(this,e,t)),super.enablePlugin())}disablePlugin(){u(p,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){var t=this.hot.getSettings(),r=t.fixedColumnsStart<this.hot.countCols()&&e>t.fixedColumnsStart-1,n=(c(p,this)||u(p,this,!0),this.hot.runHooks("beforeColumnFreeze",e,r));!1!==n&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,t.fixedColumnsStart),t._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){var t=this.hot.getSettings(),r=0<t.fixedColumnsStart&&e<=t.fixedColumnsStart-1,n=(c(p,this)||u(p,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r));!1!==n&&(r&&(--t._fixedColumnsStart,this.hot.columnIndexMapper.moveIndexes(e,t.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}}function m(e){e.items.push({name:"---------"},(0,s.default)(this),(0,a.default)(this))}function y(e,t){if(c(p,this)){const r=this.hot.getSettings().fixedColumnsStart;return t<r?!1:!e.some(e=>e<r)&&void 0}}t.ManualColumnFreeze=g},(e,t,r)=>{"use strict";t.__esModule=!0,t.default=function(r){return{key:"freeze_column",name(){return this.getTranslatedPhrase(n.CONTEXTMENU_ITEMS_FREEZE_COLUMN)},callback(e,t){var[{start:{col:t}}]=t;r.freezeColumn(t),this.render(),this.view.adjustElementsSize()},hidden(){var e=this.getSelectedRange();let t=!1;return t=void 0===e||1<e.length||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1?!0:t}}};var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621));function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}},(e,t,r)=>{"use strict";t.__esModule=!0,t.default=function(r){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(n.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN)},callback(e,t){var[{start:{col:t}}]=t;r.unfreezeColumn(t),this.render(),this.view.adjustElementsSize()},hidden(){var e=this.getSelectedRange();let t=!1;return t=void 0===e||1<e.length||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart?!0:t}}};var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621));function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}},(e,t,r)=>{"use strict";r.r(t)},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(993);t.PLUGIN_KEY=r.PLUGIN_KEY,t.PLUGIN_PRIORITY=r.PLUGIN_PRIORITY,t.ManualColumnMove=r.ManualColumnMove},(L,e,t)=>{"use strict";var r=t(197),n=(e.__esModule=!0,t(204),t(286),t(813)),i=r(t(494)),o=t(478),f=t(334),u=t(492),s=t(512),a=r(t(994)),l=r(t(996));function c(e,t,r){d(e,t),t.set(e,r)}function d(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function h(e,t,r){e.set(p(e,t),r)}function g(e,t){return e.get(p(e,t))}function p(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}t(997),i.default.getSingleton().register("beforeColumnMove"),i.default.getSingleton().register("afterColumnMove");const m=e.PLUGIN_KEY="manualColumnMove",y=(e.PLUGIN_PRIORITY=120,"ht__manualColumnMove"),v="show-ui",b="on-moving--columns",w="after-selection--columns";var C=new WeakMap,E=new WeakMap,T=new WeakMap,S=new WeakMap,_=new WeakMap,x=new WeakMap,R=new WeakMap,A=new WeakMap,N=new WeakMap,O=new WeakMap,I=new WeakMap,M=new WeakSet;class k extends n.BasePlugin{constructor(){var e,t;super(...arguments),d(e=this,t=M),t.add(e),c(this,C,new a.default(this.hot)),c(this,E,new l.default(this.hot)),c(this,T,[]),c(this,S,0),c(this,_,!1),c(this,x,{}),c(this,R,void 0),c(this,A,void 0),c(this,N,void 0),c(this,O,void 0),c(this,I,void 0)}static get PLUGIN_KEY(){return m}static get PLUGIN_PRIORITY(){return 120}isEnabled(){return!!this.hot.getSettings()[m]}enablePlugin(){var n=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return p(M,n,D).call(n,...t)}),this.addHook("beforeOnCellMouseOver",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return p(M,n,F).call(n,...t)}),this.addHook("afterScrollVertically",()=>p(M,this,U).call(this)),this.addHook("afterLoadData",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return p(M,n,V).call(n,...t)}),this.buildPluginUI(),this.registerEvents(),(0,f.addClass)(this.hot.rootElement,y),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){(0,f.removeClass)(this.hot.rootElement,y),this.unregisterEvents(),g(C,this).destroy(),g(E,this).destroy(),super.disablePlugin()}moveColumn(e,t){return this.moveColumns([e],t)}moveColumns(e,t){var r=g(R,this),n=this.isMovePossible(e,t),i=this.hot.runHooks("beforeColumnMove",e,t,r,n);if(h(R,this,void 0),!1!==i)return n&&this.hot.columnIndexMapper.moveIndexes(e,t),i=n&&this.isColumnOrderChanged(e,t),this.hot.runHooks("afterColumnMove",e,t,r,n,i),i}dragColumn(e,t){return this.dragColumns([e],t)}dragColumns(e,t){var r=this.countFinalIndex(e,t);return h(R,this,t),this.moveColumns(e,r)}isMovePossible(e,t){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength();var n=e.length+t>r,t=t<0,i=e.some(e=>e<0),e=e.some(e=>e>=r);return!(n||t||i||e)}isColumnOrderChanged(e,r){return e.some((e,t)=>e-t!==r)}countFinalIndex(e,r){e=(0,o.arrayReduce)(e,(e,t)=>(t<r&&(e+=1),e),0);return r-e}getColumnsWidth(t,r){var n=this.hot.columnIndexMapper;let i=0;for(let e=t;e<=r;e+=1){var o=n.getRenderableFromVisualIndex(e);e<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:null!==o&&(i+=this.hot.view._wt.wtTable.getStretchedColumnWidth(o)||0)}return i}moveBySettingsOrLoad(){var e=this.hot.getSettings()[m];Array.isArray(e)?this.moveColumns(e,0):void 0!==e&&(e=this.persistentStateLoad()).length&&this.moveColumns(e,0)}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){var e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value||[]}prepareColumnsToMoving(e,t){const r=[];return(0,s.rangeEach)(e,t,e=>{r.push(e)}),r}refreshPositions(){var e=this.hot.view.getFirstFullyVisibleColumn(),t=(this.isFixedColumnsStart(g(A,this))&&0<e&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)}),this.hot.view._wt.wtTable),r=this.hot.view._wt.wtOverlays.scrollableElement,n="number"==typeof r.scrollX?r.scrollX:r.scrollLeft;let i=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,g(A,this)-1);var o,s,a=t.hider.offsetWidth,t=t.TBODY.offsetLeft,l=g(C,this).getOffset().start,c=g(C,this).getSize().width;let u=0,d=0,h=(d=this.hot.isRtl()?(s=this.hot.rootWindow,o=(0,f.outerWidth)(this.hot.rootElement),o=s.innerWidth-g(N,this)-o,s.innerWidth-g(x,this).eventPageX-o-(void 0===r.scrollX?n:0)):g(x,this).eventPageX-(g(N,this)-(void 0===r.scrollX?n:0)),g(O,this)&&(u=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(g(A,this))&&(i+=n),i+=u,g(A,this)<0?0<g(I,this)?g(x,this).col=0:g(x,this).col=0<e?e-1:e:g(x,this).TD.offsetWidth/2+i<=d?(s=g(A,this)>=g(S,this)?g(S,this)-1:g(A,this),g(x,this).col=s+1,i+=g(x,this).TD.offsetWidth):g(x,this).col=g(A,this),d),p=i;d+c+l>=a?h=a-c-l:d+l<t+u&&(h=t+u+Math.abs(l)),i>=a-1?p=a-1:0===p?p=1:void 0!==r.scrollX&&g(A,this)<g(I,this)&&(p-=g(N,this)<=r.scrollX?g(N,this):0),g(C,this).setPosition(null,h),g(E,this).setPosition(null,p)}registerEvents(){var e=this.hot.rootDocument["documentElement"];this.eventManager.addEventListener(e,"mousemove",e=>p(M,this,P).call(this,e)),this.eventManager.addEventListener(e,"mouseup",()=>p(M,this,H).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){g(C,this).build(),g(E,this).build()}destroy(){g(C,this).destroy(),g(E,this).destroy(),super.destroy()}}function D(e,t,r,n){var i,o,s=this.hot.view._wt.wtTable,a=this.hot.selection.isSelectedByColumnHeader(),l=this.hot.getSelectedRangeLast(),c=(0,f.hasClass)(e.target,"sortAction");!l||!a||g(_,this)||0!==e.button||c?(h(_,this,!1),(g(T,this).length=0,f.removeClass)(this.hot.rootElement,[b,v])):(a=g(E,this).isBuilt()&&!g(E,this).isAppended(),c=g(C,this).isBuilt()&&!g(C,this).isAppended(),{from:a,to:c}=(a&&c&&(g(E,this).appendTo(s.hider),g(C,this).appendTo(s.hider)),l),l=Math.min(a.col,c.col),a=Math.max(a.col,c.col),t.row<0&&t.col>=l&&t.col<=a?(n.column=!0,h(_,this,!0),c=r.firstChild?(0,u.offsetRelativeTo)(e,r.firstChild).x:e.offsetX,g(x,this).eventPageX=e.pageX,h(A,this,t.col),g(x,this).TD=r,g(x,this).col=t.col,h(T,this,this.prepareColumnsToMoving(l,a)),h(O,this,!!this.hot.getSettings().rowHeaders),h(S,this,this.hot.countCols()),h(I,this,this.hot.getSettings().fixedColumnsStart),h(N,this,(0,f.offset)(this.hot.rootElement).left),n=g(O,this)?-1:0,e=s.holder.scrollTop+s.getColumnHeaderHeight(0)+1,i=t.col<g(I,this),o=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),c=Math.abs(c-(this.hot.isRtl()?r.offsetWidth:0)),r=this.getColumnsWidth(l,t.col-1)+c,t=this.getColumnsWidth(n,l-1)+(i?o:0)+r,g(C,this).setPosition(e,t),g(C,this).setSize(this.getColumnsWidth(l,a),s.hider.offsetHeight-e),g(C,this).setOffset(null,-r),(0,f.addClass)(this.hot.rootElement,b)):((0,f.removeClass)(this.hot.rootElement,w),h(_,this,!1),g(T,this).length=0))}function P(e){g(_,this)&&(g(x,this).eventPageX=e.pageX,this.refreshPositions())}function F(e,t,r,n){this.hot.getSelectedRangeLast()&&g(_,this)&&((-1<g(T,this).indexOf(t.col)?(0,f.removeClass):(0,f.addClass))(this.hot.rootElement,v),n.row=!0,n.column=!0,n.cell=!0,h(A,this,t.col),g(x,this).TD=r)}function H(){var e,t=g(x,this).col,r=g(T,this).length;h(A,this,void 0),h(_,this,!1),(0,f.removeClass)(this.hot.rootElement,[b,v,w]),this.hot.selection.isSelectedByColumnHeader()&&(0,f.addClass)(this.hot.rootElement,w),r<1||void 0===t||(e=g(T,this)[0],e=this.hot.toPhysicalColumn(e),t=this.dragColumns(g(T,this),t),!(g(T,this).length=0)===t&&(this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(),t=this.hot.toVisualColumn(e),this.hot.selectColumns(t,t+r-1)))}function U(){var e=this.hot.view._wt.wtTable,t=e.getColumnHeaderHeight(0)+1+e.holder.scrollTop;g(C,this).setPosition(t),g(C,this).setSize(null,e.hider.offsetHeight-t)}function V(){this.moveBySettingsOrLoad()}e.ManualColumnMove=k},(e,t,r)=>{"use strict";var n=r(197),n=(t.__esModule=!0,n(r(995))),i=r(334);class o extends n.default{build(){super.build(),(0,i.addClass)(this._element,"ht__manualColumnMove--backlight")}}t.default=o},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(487))),o=r(512),s=r(335);t.default=class{constructor(e){(0,i.default)(this,"hot",void 0),(0,i.default)(this,"_element",null),(0,i.default)(this,"state",0),(0,i.default)(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=2}build(){0===this.state&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}isAppended(){return 2===this.state}isBuilt(){return 1<=this.state}setPosition(e,t){(0,o.isNumeric)(e)&&(this._element.style.top=e+"px"),(0,o.isNumeric)(t)&&(this._element.style[this.inlineProperty]=t+"px")}getPosition(){var e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,t){(0,o.isNumeric)(e)&&(this._element.style.width=e+"px"),(0,o.isNumeric)(t)&&(this._element.style.height=t+"px")}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){(0,o.isNumeric)(e)&&(this._element.style.marginTop=e+"px"),(0,o.isNumeric)(t)&&(this._element.style["margin"+(0,s.toUpperCaseFirst)(this.inlineProperty)]=t+"px")}getOffset(){var e=this._element.style,t="margin"+(0,s.toUpperCaseFirst)(this.inlineProperty);return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[t]?parseInt(e[t],10):0}}}},(e,t,r)=>{"use strict";var n=r(197),n=(t.__esModule=!0,n(r(995))),i=r(334);class o extends n.default{build(){super.build(),(0,i.addClass)(this._element,"ht__manualColumnMove--guideline")}}t.default=o},(e,t,r)=>{"use strict";r.r(t)},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(999);t.PLUGIN_KEY=r.PLUGIN_KEY,t.PLUGIN_PRIORITY=r.PLUGIN_PRIORITY,t.ManualColumnResize=r.ManualColumnResize},(L,e,t)=>{"use strict";e.__esModule=!0,t(204),t(286);var r=t(813),a=t(334),l=t(478),c=t(512),n=t(597);function i(e,t,r){o(e,t),t.set(e,r)}function o(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function u(e,t,r){e.set(s(e,t),r)}function d(e,t){return e.get(s(e,t))}function s(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}const h=e.PLUGIN_KEY="manualColumnResize",p=(e.PLUGIN_PRIORITY=130,"manualColumnWidths");var f=new WeakMap,g=new WeakMap,m=new WeakMap,y=new WeakMap,v=new WeakMap,b=new WeakMap,w=new WeakMap,C=new WeakMap,E=new WeakMap,T=new WeakMap,S=new WeakMap,_=new WeakMap,x=new WeakMap,R=new WeakMap,A=new WeakMap,N=new WeakMap,O=new WeakSet;class I extends r.BasePlugin{static get PLUGIN_KEY(){return h}static get PLUGIN_PRIORITY(){return 130}constructor(e){var t;super(e),o(e=this,t=O),t.add(e),i(this,f,null),i(this,g,null),i(this,m,[]),i(this,y,null),i(this,v,null),i(this,b,null),i(this,w,null),i(this,C,null),i(this,E,this.hot.rootDocument.createElement("DIV")),i(this,T,this.hot.rootDocument.createElement("DIV")),i(this,S,null),i(this,_,!1),i(this,x,0),i(this,R,null),i(this,A,void 0),i(this,N,void 0),(0,a.addClass)(d(E,this),"manualColumnResizer"),(0,a.addClass)(d(T,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[h]}enablePlugin(){this.enabled||(u(A,this,new n.PhysicalIndexToValueMap),d(A,this).addLocalHook("init",()=>s(O,this,M).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,d(A,this)),this.addHook("modifyColWidth",(e,t)=>s(O,this,U).call(this,e,t),1),this.addHook("beforeStretchingColumnWidth",(e,t)=>s(O,this,V).call(this,e,t)),this.addHook("beforeColumnResize",(e,t,r)=>s(O,this,W).call(this,e,t,r)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){u(N,this,d(A,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",p,d(A,this).getValues())}loadManualColumnWidths(){var e={};return this.hot.runHooks("persistentStateLoad",p,e),e.value}setManualSize(e,t){t=Math.max(t,20),e=this.hot.toPhysicalColumn(e);return d(A,this).setValueAtIndex(e,t),t}clearManualSize(e){e=this.hot.toPhysicalColumn(e);d(A,this).setValueAtIndex(e,null)}setupHandlePosition(t){if(t.parentNode){u(f,this,t);var t=this.hot.view["_wt"],r=t.wtTable.getCoords(d(f,this)),n=r.col;if(!(n<0)){var i=(0,a.outerHeight)(d(f,this)),o=d(f,this).getBoundingClientRect(),s=n<t.getSetting("fixedColumnsStart");let e;e=(e=s?t.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(d(f,this),r.row,r.col):e)||t.wtOverlays.topOverlay.getRelativeCellPosition(d(f,this),r.row,r.col),u(g,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)),u(m,this,[]);s=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();this.hot.selection.isSelected()&&s&&(t=this.hot.getSelectedRange(),(0,l.arrayEach)(t,e=>{var t=e.getTopStartCorner().col,e=e.getBottomEndCorner().col;(0,c.rangeEach)(t,e,e=>{d(m,this).includes(e)||d(m,this).push(e)})})),d(m,this).includes(d(g,this))||u(m,this,[d(g,this)]),u(C,this,e.start-6),u(w,this,parseInt(o.width,10)),d(E,this).style.top=e.top+"px",d(E,this).style[this.inlineDir]=d(C,this)+d(w,this)+"px",d(E,this).style.height=i+"px",this.hot.rootElement.appendChild(d(E,this))}}}refreshHandlePosition(){d(E,this).style[this.inlineDir]=d(C,this)+d(y,this)+"px"}setupGuidePosition(){var e=parseInt((0,a.outerHeight)(d(E,this)),10),t=parseInt(d(E,this).style.top,10)+e,r=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);(0,a.addClass)(d(E,this),"active"),(0,a.addClass)(d(T,this),"active"),d(T,this).style.top=t+"px",this.refreshGuidePosition(),d(T,this).style.height=r-e+"px",this.hot.rootElement.appendChild(d(T,this))}refreshGuidePosition(){d(T,this).style[this.inlineDir]=d(E,this).style[this.inlineDir]}hideHandleAndGuide(){(0,a.removeClass)(d(E,this),"active"),(0,a.removeClass)(d(T,this),"active")}checkIfColumnHeader(e){var e=(0,a.closest)(e,["THEAD"],this.hot.rootElement),{topOverlay:t,topInlineStartCornerOverlay:r}=this.hot.view._wt.wtOverlays;return[t.clone.wtTable.THEAD,r.clone.wtTable.THEAD].includes(e)}getClosestTHParent(e){return"TABLE"!==e.tagName?"TH"===e.tagName?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const n=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},t=(e,t)=>{var r=this.hot.runHooks("beforeColumnResize",d(v,this),e,!0);void 0!==r&&u(v,this,r),"all"===this.hot.getSettings().stretchH?this.clearManualSize(e):this.setManualSize(e,d(v,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",d(v,this),e,!0),t&&n()};2<=d(x,this)&&(1<d(m,this).length?((0,l.arrayEach)(d(m,this),e=>{t(e)}),n()):(0,l.arrayEach)(d(m,this),e=>{t(e,!0)})),u(x,this,0),u(R,this,null)}bindEvents(){var{rootWindow:e,rootElement:t}=this.hot;this.eventManager.addEventListener(t,"mouseover",e=>s(O,this,k).call(this,e)),this.eventManager.addEventListener(t,"mousedown",e=>s(O,this,D).call(this,e)),this.eventManager.addEventListener(e,"mousemove",e=>s(O,this,P).call(this,e)),this.eventManager.addEventListener(e,"mouseup",()=>s(O,this,F).call(this)),this.eventManager.addEventListener(d(E,this),"contextmenu",()=>s(O,this,H).call(this))}destroy(){super.destroy()}}function M(){const e=this.hot.getSettings()[h],t=this.loadManualColumnWidths();void 0!==t?this.hot.batchExecution(()=>{t.forEach((e,t)=>{d(A,this).setValueAtIndex(t,e)})},!0):Array.isArray(e)?(this.hot.batchExecution(()=>{e.forEach((e,t)=>{d(A,this).setValueAtIndex(t,e)})},!0),u(N,this,e)):!0===e&&Array.isArray(d(N,this))&&this.hot.batchExecution(()=>{d(N,this).forEach((e,t)=>{d(A,this).setValueAtIndex(t,e)})},!0)}function k(e){var t;(0,a.isDetached)(e.target)||!0!==d(_,this)&&this.checkIfColumnHeader(e.target)&&(e=this.getClosestTHParent(e.target))&&(t=e.getAttribute("colspan"),!e||null!==t&&"1"!==t||d(S,this)||this.setupHandlePosition(e))}function D(e){e.target.parentNode===this.hot.rootElement&&(0,a.hasClass)(e.target,"manualColumnResizer")&&(this.setupHandlePosition(d(f,this)),this.setupGuidePosition(),u(S,this,!0),null===d(R,this)&&(u(R,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(d(R,this))),u(x,this,d(x,this)+1),this.startX=e.pageX,u(v,this,d(w,this)))}function P(e){d(S,this)&&(e=(e.pageX-this.startX)*this.hot.getDirectionFactor(),u(y,this,d(w,this)+e),(0,l.arrayEach)(d(m,this),e=>{u(v,this,this.setManualSize(e,d(y,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function F(){const r=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},t=(e,t)=>{this.hot.runHooks("beforeColumnResize",d(v,this),e,!1),t&&r(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",d(v,this),e,!1)};d(S,this)&&(this.hideHandleAndGuide(),u(S,this,!1),d(v,this)!==d(w,this)&&(1<d(m,this).length?((0,l.arrayEach)(d(m,this),e=>{t(e)}),r()):(0,l.arrayEach)(d(m,this),e=>{t(e,!0)})),this.setupHandlePosition(d(f,this)))}function H(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(d(E,this)),this.hot.rootElement.removeChild(d(T,this)),u(S,this,!1),u(_,this,!0),this.hot._registerImmediate(()=>{u(_,this,!1)})}function U(e,t){let r=e;return r=this.enabled&&(e=this.hot.toPhysicalColumn(t),t=d(A,this).getValueAtIndex(e),this.hot.getSettings()[h])&&t?t:r}function V(e,t){let r=d(A,this).getValueAtIndex(t);return r=null===r?e:r}function W(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}e.ManualColumnResize=I},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(1001);t.PLUGIN_KEY=r.PLUGIN_KEY,t.PLUGIN_PRIORITY=r.PLUGIN_PRIORITY,t.ManualRowMove=r.ManualRowMove},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),r(286),r(813)),o=n(r(494)),s=r(478),h=r(334),a=r(512),l=n(r(1002)),c=n(r(1004));function u(e,t,r){d(e,t),t.set(e,r)}function d(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function p(e,t,r){e.set(g(e,t),r)}function f(e,t){return e.get(g(e,t))}function g(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}r(1005),o.default.getSingleton().register("beforeRowMove"),o.default.getSingleton().register("afterRowMove");const m=t.PLUGIN_KEY="manualRowMove",y=(t.PLUGIN_PRIORITY=140,"ht__manualRowMove"),v="show-ui",b="on-moving--rows",w="after-selection--rows";var C=new WeakMap,E=new WeakMap,T=new WeakMap,S=new WeakMap,_=new WeakMap,x=new WeakMap,R=new WeakSet;class A extends i.BasePlugin{constructor(){var e,t;super(...arguments),d(e=this,t=R),t.add(e),u(this,C,new l.default(this.hot)),u(this,E,new c.default(this.hot)),u(this,T,[]),u(this,S,void 0),u(this,_,{}),u(this,x,void 0)}static get PLUGIN_KEY(){return m}static get PLUGIN_PRIORITY(){return 140}isEnabled(){return!!this.hot.getSettings()[m]}enablePlugin(){var n=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return g(R,n,N).call(n,...t)}),this.addHook("beforeOnCellMouseOver",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return g(R,n,I).call(n,...t)}),this.addHook("afterScrollHorizontally",()=>g(R,this,k).call(this)),this.addHook("afterLoadData",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return g(R,n,D).call(n,...t)}),this.buildPluginUI(),this.registerEvents(),(0,h.addClass)(this.hot.rootElement,y),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){(0,h.removeClass)(this.hot.rootElement,y),this.unregisterEvents(),f(C,this).destroy(),f(E,this).destroy(),super.disablePlugin()}moveRow(e,t){return this.moveRows([e],t)}moveRows(e,t){var r=f(x,this),n=this.isMovePossible(e,t),i=this.hot.runHooks("beforeRowMove",e,t,r,n);if(p(x,this,void 0),!1!==i)return n&&this.hot.rowIndexMapper.moveIndexes(e,t),i=n&&this.isRowOrderChanged(e,t),this.hot.runHooks("afterRowMove",e,t,r,n,i),i}dragRow(e,t){return this.dragRows([e],t)}dragRows(e,t){var r=this.countFinalIndex(e,t);return p(x,this,t),this.moveRows(e,r)}isMovePossible(e,t){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();var n=e.length+t>r,t=t<0,i=e.some(e=>e<0),e=e.some(e=>e>=r);return!(n||t||i||e)}isRowOrderChanged(e,r){return e.some((e,t)=>e-t!==r)}countFinalIndex(e,r){e=(0,s.arrayReduce)(e,(e,t)=>(t<r&&(e+=1),e),0);return r-e}getRowsHeight(t,r){var n=this.hot.rowIndexMapper;let i=0;for(let e=t;e<=r;e++){var o=n.getRenderableFromVisualIndex(e);null!==o&&(i+=this.hot.view._wt.wtTable.getRowHeight(o)||23)}return i}moveBySettingsOrLoad(){var e=this.hot.getSettings()[m];Array.isArray(e)?this.moveRows(e,0):void 0!==e&&(e=this.persistentStateLoad()).length&&this.moveRows(e,0)}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){var e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value||[]}prepareRowsToMoving(){var e,t,r=this.hot.getSelectedRangeLast();const n=[];return r&&({from:r,to:e}=r,t=Math.min(r.row,e.row),r=Math.max(r.row,e.row),(0,a.rangeEach)(t,r,e=>{n.push(e)})),n}refreshPositions(){var e=f(_,this).coords,t=this.hot.view.getFirstFullyVisibleRow(),r=this.hot.view.getLastFullyVisibleRow(),n=this.hot.countRows(),n=(this.isFixedRowTop(e.row)&&0<t&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(t-1,-1)),this.isFixedRowBottom(e.row)&&r<n&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0),this.hot.view._wt.wtTable),r=f(_,this).TD,i=this.hot.rootElement,o=(0,h.offset)(i),i=(0,h.getTrimmingContainer)(i),s=n.holder.scrollTop,i=this.hot.rootWindow!==i?i.scrollTop:0,o=o.top-i,i=f(_,this).eventPageY-o+s,o=n.hider.offsetHeight,s=n.TBODY.offsetTop,n=f(C,this).getOffset().top,a=f(C,this).getSize().height,l=r.offsetHeight/2,r=r.offsetHeight;let c=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);l=i>=c+l;this.isFixedRowTop(e.row)&&(c+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?f(_,this).row=0<t?t-1:t:l?(f(_,this).row=e.row+1,c+=0===e.row?r-1:r):f(_,this).row=e.row;let u=i,d=c;o<=i+a+n?u=o-a-n:i+n<s&&(u=s+Math.abs(n)),c>=o-1&&(d=o-1),f(C,this).setPosition(u),f(E,this).setPosition(d)}registerEvents(){var e=this.hot.rootDocument["documentElement"];this.eventManager.addEventListener(e,"mousemove",e=>g(R,this,O).call(this,e)),this.eventManager.addEventListener(e,"mouseup",()=>g(R,this,M).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){f(C,this).build(),f(E,this).build()}destroy(){f(C,this).destroy(),f(E,this).destroy(),super.destroy()}}function N(e,t,r,n){var i,{wtTable:o,wtViewport:s}=this.hot.view._wt,a=this.hot.selection.isSelectedByRowHeader(),l=this.hot.getSelectedRangeLast();l&&a&&!f(S,this)&&0===e.button?(a=f(E,this).isBuilt()&&!f(E,this).isAppended(),i=f(C,this).isBuilt()&&!f(C,this).isAppended(),{from:a,to:i}=(a&&i&&(f(E,this).appendTo(o.hider),f(C,this).appendTo(o.hider)),l),l=Math.min(a.row,i.row),a=Math.max(a.row,i.row),t.col<0&&t.row>=l&&t.row<=a?(n.row=!0,p(S,this,!0),f(_,this).eventPageY=e.pageY,f(_,this).coords=t,f(_,this).TD=r,p(T,this,this.prepareRowsToMoving()),i=o.holder.scrollLeft+s.getRowHeaderWidth(),n=this.getRowsHeight(l,t.row-1)+e.offsetY,f(C,this).setPosition(null,i),f(C,this).setSize(o.hider.offsetWidth-i,this.getRowsHeight(l,a)),f(C,this).setOffset(-n,null),(0,h.addClass)(this.hot.rootElement,b),this.refreshPositions()):((0,h.removeClass)(this.hot.rootElement,w),p(S,this,!1),f(T,this).length=0)):(p(S,this,!1),(f(T,this).length=0,h.removeClass)(this.hot.rootElement,[b,v]))}function O(e){f(S,this)&&(f(_,this).eventPageY=e.pageY,this.refreshPositions())}function I(e,t,r,n){this.hot.getSelectedRangeLast()&&f(S,this)&&((-1<f(T,this).indexOf(t.row)?(0,h.removeClass):(0,h.addClass))(this.hot.rootElement,v),n.row=!0,n.column=!0,n.cell=!0,f(_,this).coords=t,f(_,this).TD=r)}function M(){var e,t=f(_,this).row,r=f(T,this).length;p(S,this,!1),(0,h.removeClass)(this.hot.rootElement,[b,v,w]),this.hot.selection.isSelectedByRowHeader()&&(0,h.addClass)(this.hot.rootElement,w),r<1||void 0===t||(e=f(T,this)[0],e=this.hot.toPhysicalRow(e),t=this.dragRows(f(T,this),t),!(f(T,this).length=0)===t&&(this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(),t=this.hot.toVisualRow(e),this.hot.selectRows(t,t+r-1)))}function k(){var e=this.hot.view._wt.wtTable,t=this.hot.view._wt.wtViewport.getRowHeaderWidth()+e.holder.scrollLeft;f(C,this).setPosition(null,t),f(C,this).setSize(e.hider.offsetWidth-t)}function D(){this.moveBySettingsOrLoad()}t.ManualRowMove=A},(e,t,r)=>{"use strict";var n=r(197),n=(t.__esModule=!0,n(r(1003))),i=r(334);class o extends n.default{build(){super.build(),(0,i.addClass)(this._element,"ht__manualRowMove--backlight")}}t.default=o},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(487)));t.default=class{constructor(e){(0,i.default)(this,"hot",void 0),(0,i.default)(this,"_element",null),(0,i.default)(this,"state",0),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=2}build(){0===this.state&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}isAppended(){return 2===this.state}isBuilt(){return 1<=this.state}setPosition(e,t){void 0!==e&&(this._element.style.top=e+"px"),void 0!==t&&(this._element.style.left=t+"px")}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,t){e&&(this._element.style.width=e+"px"),t&&(this._element.style.height=t+"px")}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){e&&(this._element.style.marginTop=e+"px"),t&&(this._element.style.marginLeft=t+"px")}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}},(e,t,r)=>{"use strict";var n=r(197),n=(t.__esModule=!0,n(r(1003))),i=r(334);class o extends n.default{build(){super.build(),(0,i.addClass)(this._element,"ht__manualRowMove--guideline")}}t.default=o},(e,t,r)=>{"use strict";r.r(t)},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(1007);t.PLUGIN_KEY=r.PLUGIN_KEY,t.PLUGIN_PRIORITY=r.PLUGIN_PRIORITY,t.ManualRowResize=r.ManualRowResize},(L,e,t)=>{"use strict";e.__esModule=!0,t(204),t(286);var r=t(813),l=t(334),c=t(478),u=t(512),n=t(597),i=t(518);function o(e,t,r){s(e,t),t.set(e,r)}function s(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function d(e,t,r){e.set(a(e,t),r)}function h(e,t){return e.get(a(e,t))}function a(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}const p=e.PLUGIN_KEY="manualRowResize",f=(e.PLUGIN_PRIORITY=30,"manualRowHeights");var g=new WeakMap,m=new WeakMap,y=new WeakMap,v=new WeakMap,b=new WeakMap,w=new WeakMap,C=new WeakMap,E=new WeakMap,T=new WeakMap,S=new WeakMap,_=new WeakMap,x=new WeakMap,R=new WeakMap,A=new WeakMap,N=new WeakMap,O=new WeakMap,I=new WeakSet;class M extends r.BasePlugin{static get PLUGIN_KEY(){return p}static get PLUGIN_PRIORITY(){return 30}constructor(e){var t;super(e),s(e=this,t=I),t.add(e),o(this,g,null),o(this,m,null),o(this,y,[]),o(this,v,null),o(this,b,null),o(this,w,null),o(this,C,null),o(this,E,null),o(this,T,this.hot.rootDocument.createElement("DIV")),o(this,S,this.hot.rootDocument.createElement("DIV")),o(this,_,!1),o(this,x,!1),o(this,R,0),o(this,A,null),o(this,N,void 0),o(this,O,void 0),(0,l.addClass)(h(T,this),"manualRowResizer"),(0,l.addClass)(h(S,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[p]}enablePlugin(){this.enabled||(d(N,this,new n.PhysicalIndexToValueMap),h(N,this).addLocalHook("init",()=>a(I,this,V).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,h(N,this)),this.addHook("modifyRowHeight",(e,t)=>a(I,this,U).call(this,e,t)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){d(O,this,h(N,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",f,h(N,this).getValues())}loadManualRowHeights(){var e={};return this.hot.runHooks("persistentStateLoad",f,e),e.value}setManualSize(e,t){e=this.hot.toPhysicalRow(e),t=Math.max(t,i.DEFAULT_ROW_HEIGHT);return h(N,this).setValueAtIndex(e,t),t}getLastDesiredRowHeight(){return h(v,this)}setupHandlePosition(t){d(g,this,t);var t=this.hot["view"],r=t["_wt"],n=r.wtTable.getCoords(h(g,this)),i=n.row;if(!(i<0)){var o=(0,l.outerWidth)(h(g,this)),s=h(g,this).getBoundingClientRect(),a=i<r.getSetting("fixedRowsTop"),t=i>=t.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let e;a?e=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(h(g,this),n.row,n.col):t&&(e=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(h(g,this),n.row,n.col)),e=e||r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(h(g,this),n.row,n.col),d(m,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(i)),d(y,this,[]);a=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();this.hot.selection.isSelected()&&a&&(t=this.hot.getSelectedRange(),(0,c.arrayEach)(t,e=>{var t=e.getTopStartCorner().row,e=e.getBottomStartCorner().row;(0,u.rangeEach)(t,e,e=>{h(y,this).includes(e)||h(y,this).push(e)})})),h(y,this).includes(h(m,this))||d(y,this,[h(m,this)]),d(E,this,e.top-6),d(C,this,parseInt(s.height,10)),h(T,this).style.top=h(E,this)+h(C,this)+"px",h(T,this).style[this.inlineDir]=e.start+"px",h(T,this).style.width=o+"px",this.hot.rootElement.appendChild(h(T,this))}}refreshHandlePosition(){h(T,this).style.top=h(E,this)+h(v,this)+"px"}setupGuidePosition(){var e=parseInt((0,l.outerWidth)(h(T,this)),10),t=parseInt(h(T,this).style[this.inlineDir],10)+e,r=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);(0,l.addClass)(h(T,this),"active"),(0,l.addClass)(h(S,this),"active"),h(S,this).style.top=h(T,this).style.top,h(S,this).style[this.inlineDir]=t+"px",h(S,this).style.width=r-e+"px",this.hot.rootElement.appendChild(h(S,this))}refreshGuidePosition(){h(S,this).style.top=h(T,this).style.top}hideHandleAndGuide(){(0,l.removeClass)(h(T,this),"active"),(0,l.removeClass)(h(S,this),"active")}checkIfRowHeader(e){var e=(0,l.closest)(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:t,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:n}=this.hot.view._wt.wtOverlays;return[t.clone.wtTable.TBODY,r.clone.wtTable.TBODY,n.clone.wtTable.TBODY].includes(e)}getClosestTHParent(e){return"TABLE"!==e.tagName?"TH"===e.tagName?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){e=this.hot.view._wt.wtTable.getRowHeight(e);return void 0!==e&&h(b,this)<e?e:h(b,this)}afterMouseDownTimeout(){const n=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},t=(e,t)=>{var r=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(e),e,!0);void 0!==r&&d(b,this,r),this.setManualSize(e,h(b,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(e),e,!0),t&&n()};2<=h(R,this)&&(1<h(y,this).length?((0,c.arrayEach)(h(y,this),e=>{t(e)}),n()):(0,c.arrayEach)(h(y,this),e=>{t(e,!0)})),d(R,this,0),d(A,this,null)}bindEvents(){var{rootElement:e,rootWindow:t}=this.hot;this.eventManager.addEventListener(e,"mouseover",e=>a(I,this,k).call(this,e)),this.eventManager.addEventListener(e,"mousedown",e=>a(I,this,D).call(this,e)),this.eventManager.addEventListener(t,"mousemove",e=>a(I,this,P).call(this,e)),this.eventManager.addEventListener(t,"mouseup",()=>a(I,this,F).call(this)),this.eventManager.addEventListener(h(T,this),"contextmenu",()=>a(I,this,H).call(this))}destroy(){super.destroy()}}function k(e){(0,l.isDetached)(e.target)||!0!==h(x,this)&&this.checkIfRowHeader(e.target)&&(e=this.getClosestTHParent(e.target))&&!h(_,this)&&this.setupHandlePosition(e)}function D(e){(0,l.hasClass)(e.target,"manualRowResizer")&&(this.setupHandlePosition(h(g,this)),this.setupGuidePosition(),d(_,this,!0),null===h(A,this)&&(d(A,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(h(A,this))),d(R,this,h(R,this)+1),d(w,this,e.pageY),d(b,this,h(C,this)))}function P(e){h(_,this)&&(d(v,this,h(C,this)+(e.pageY-h(w,this))),(0,c.arrayEach)(h(y,this),e=>{d(b,this,this.setManualSize(e,h(v,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function F(){const r=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},t=(e,t)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(e),e,!1),t&&r(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(e),e,!1)};h(_,this)&&(this.hideHandleAndGuide(),d(_,this,!1),h(b,this)!==h(C,this)&&(1<h(y,this).length?((0,c.arrayEach)(h(y,this),e=>{t(e)}),r()):(0,c.arrayEach)(h(y,this),e=>{t(e,!0)})),this.setupHandlePosition(h(g,this)))}function H(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(h(T,this)),this.hot.rootElement.removeChild(h(S,this)),d(_,this,!1),d(x,this,!0),this.hot._registerImmediate(()=>{d(x,this,!1)})}function U(e,t){let r=e;return r=this.enabled&&(e=this.hot.toPhysicalRow(t),t=h(N,this).getValueAtIndex(e),this.hot.getSettings()[p])&&t?t:r}function V(){const e=this.hot.getSettings()[p],t=this.loadManualRowHeights();this.hot.batchExecution(()=>{void 0!==t?t.forEach((e,t)=>{h(N,this).setValueAtIndex(t,e)}):Array.isArray(e)?(e.forEach((e,t)=>{h(N,this).setValueAtIndex(t,e)}),d(O,this,e)):!0===e&&Array.isArray(h(O,this))&&h(O,this).forEach((e,t)=>{h(N,this).setValueAtIndex(t,e)})},!0)}e.ManualRowResize=M},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(1009);t.PLUGIN_KEY=r.PLUGIN_KEY,t.PLUGIN_PRIORITY=r.PLUGIN_PRIORITY,t.MergeCells=r.MergeCells},(L,e,t)=>{"use strict";var r=t(197),n=(e.__esModule=!0,t(204),t(286),t(290),t(302),t(305),t(309),t(312),t(315),t(318),r(t(487))),i=t(813),o=r(t(494)),s=r(t(1010)),a=r(t(1011)),l=r(t(1012)),c=r(t(1013)),u=r(t(1014)),d=t(478),h=t(482),p=t(500),f=t(512),g=(t(1015),t(334)),m=t(481),y=t(1016),v=t(1018);function b(e,t,r){w(e,t),t.set(e,r)}function w(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function C(e,t,r){e.set(T(e,t),r)}function E(e,t){return e.get(T(e,t))}function T(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}o.default.getSingleton().register("beforeMergeCells"),o.default.getSingleton().register("afterMergeCells"),o.default.getSingleton().register("beforeUnmergeCells"),o.default.getSingleton().register("afterUnmergeCells");const S=e.PLUGIN_KEY="mergeCells",_=(e.PLUGIN_PRIORITY=150,S);var x=new WeakMap,R=new WeakMap,A=new WeakMap,N=new WeakMap,O=new WeakSet;class I extends i.BasePlugin{constructor(){var e,t;super(...arguments),w(e=this,t=O),t.add(e),(0,n.default)(this,"mergedCellsCollection",null),(0,n.default)(this,"autofillCalculations",null),(0,n.default)(this,"selectionCalculations",null),b(this,x,null),b(this,R,{row:0,col:0}),b(this,A,new y.FocusOrder({mergedCellsGetter:(e,t)=>this.mergedCellsCollection.get(e,t),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),b(this,N,(0,v.createMergeCellRenderer)(this))}static get PLUGIN_KEY(){return S}static get PLUGIN_PRIORITY(){return 150}isEnabled(){return!!this.hot.getSettings()[S]}enablePlugin(){var n=this;this.enabled||(this.mergedCellsCollection=new s.default(this),this.autofillCalculations=new l.default(this),this.selectionCalculations=new c.default(this),this.addHook("afterInit",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return T(O,n,M).call(n,...t)}),this.addHook("modifyTransformFocus",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return T(O,n,D).call(n,...t)}),this.addHook("modifyTransformStart",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return T(O,n,F).call(n,...t)}),this.addHook("modifyTransformEnd",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return T(O,n,H).call(n,...t)}),this.addHook("beforeSelectionHighlightSet",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return T(O,n,U).call(n,...t)}),this.addHook("beforeSetRangeStart",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return T(O,n,P).call(n,...t)}),this.addHook("beforeSetRangeStartOnly",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return T(O,n,P).call(n,...t)}),this.addHook("beforeSelectionFocusSet",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return T(O,n,$).call(n,...t)}),this.addHook("afterSelectionFocusSet",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return T(O,n,B).call(n,...t)}),this.addHook("afterSelectionEnd",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return T(O,n,j).call(n,...t)}),this.addHook("modifyGetCellCoords",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return T(O,n,V).call(n,...t)}),this.addHook("afterIsMultipleSelection",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return T(O,n,k).call(n,...t)}),this.addHook("afterRenderer",function(){return E(N,n).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return T(O,n,W).call(n,...t)}),this.addHook("afterGetCellMeta",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return T(O,n,z).call(n,...t)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return T(O,n,Y).call(n,...t)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return T(O,n,G).call(n,...t)}),this.addHook("modifyAutofillRange",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return T(O,n,q).call(n,...t)}),this.addHook("afterCreateCol",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return T(O,n,K).call(n,...t)}),this.addHook("afterRemoveCol",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return T(O,n,X).call(n,...t)}),this.addHook("afterCreateRow",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return T(O,n,J).call(n,...t)}),this.addHook("afterRemoveRow",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return T(O,n,Z).call(n,...t)}),this.addHook("afterChange",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return T(O,n,Q).call(n,...t)}),this.addHook("beforeDrawBorders",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return T(O,n,ee).call(n,...t)}),this.addHook("afterDrawSelection",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return T(O,n,te).call(n,...t)}),this.addHook("beforeRemoveCellClassNames",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return T(O,n,re).call(n,...t)}),this.addHook("beforeBeginEditing",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return T(O,n,ne).call(n,...t)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return T(O,n,ie).call(n,...t)}),this.addHook("beforeUndoStackChange",(e,t)=>{if("MergeCells"===t)return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){var e=this.hot.getSettings()[S];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),super.updatePlugin()}ifChromeForceRepaint(){if((0,m.isChrome)()){const r=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(e=>{var{row:t,rowspan:r}=e;for(let e=t+1;e<t+r;e++)n.push(e)}),(n=[...new Set(n)]).forEach(e=>{const t=this.hot.rowIndexMapper.getRenderableFromVisualIndex(e);this.hot.view._wt.wtOverlays.getOverlays(!0).map(e=>"master"===(null==e?void 0:e.name)?e:e.clone.wtTable).forEach(e=>{e=e.getRow(t);e&&(e.style.background=(0,g.getStyle)(e,"backgroundColor").replace(")",", 0.99)"),r.push(e))})}),this.hot._registerTimeout(()=>{r.forEach(e=>{e.style.background=(0,g.getStyle)(e,"backgroundColor").replace(", 0.99)",")")})},1)}}validateSetting(e){return!(!e||(a.default.containsNegativeValues(e)?((0,p.warn)(a.default.NEGATIVE_VALUES_WARNING(e)),1):a.default.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?((0,p.warn)(a.default.IS_OUT_OF_BOUNDS_WARNING(e)),1):a.default.isSingleCell(e)?((0,p.warn)(a.default.IS_SINGLE_CELL(e)),1):a.default.containsZeroSpan(e)&&((0,p.warn)(a.default.ZERO_SPAN_WARNING(e)),1)))}generateFromSettings(e){if(Array.isArray(e)){e=e.filter(e=>this.validateSetting(e)),e=this.mergedCellsCollection.filterOverlappingMergeCells(e);const s=[];e.forEach(e=>{var{row:r,col:n,rowspan:i,colspan:o}=e,e=this.hot._createCellCoords(r,n),t=this.hot._createCellCoords(r+i-1,n+o-1),e=this.hot._createCellRange(e,e,t);this.mergeRange(e,!0,!0);for(let t=r;t<r+i;t++)for(let e=n;e<n+o;e++)t===r&&e===n||s.push([t,e,null])}),0!==s.length&&this.hot.setDataAtCell(s,void 0,void 0,this.pluginName)}}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return!!(1<arguments.length&&void 0!==arguments[1]&&arguments[1])||this.validateSetting(e)}mergeSelection(){var e,t,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();r&&(r.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE"),{from:e,to:t}=r,this.unmergeRange(r,!0),this.mergeRange(r),this.hot.selectCell(e.row,e.col,t.row,t.col,!1))}unmergeSelection(){var e,t,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();r&&({from:e,to:t}=r,this.unmergeRange(r,!0),this.hot.selectCell(e.row,e.col,t.row,t.col,!1))}mergeRange(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],r=2<arguments.length&&void 0!==arguments[2]&&arguments[2],n=e.getTopStartCorner(),i=e.getBottomEndCorner();const o={row:n.row,col:n.col,rowspan:i.row-n.row+1,colspan:i.col-n.col+1},s=[];let a=null;return!!this.canMergeRange(o,t)&&(this.hot.runHooks("beforeMergeCells",e,t),(0,f.rangeEach)(0,o.rowspan-1,r=>{(0,f.rangeEach)(0,o.colspan-1,e=>{let t=null;s[r]||(s[r]=[]),0===r&&0===e?t=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o.row),this.hot.toPhysicalColumn(o.col)):this.hot.setCellMeta(o.row+r,o.col+e,"hidden",!0),s[r][e]=t})}),this.hot.setCellMeta(o.row,o.col,"spanned",!0),!this.mergedCellsCollection.add(o,t)||(r?a=[o.row,o.col,s]:this.hot.populateFromArray(o.row,o.col,s,void 0,void 0,this.pluginName),t||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,o,t),a))}unmergeRange(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],r=this.mergedCellsCollection.getWithinRange(e);0!==r.length&&(this.hot.runHooks("beforeUnmergeCells",e,t),(0,d.arrayEach)(r,r=>{this.mergedCellsCollection.remove(r.row,r.col),(0,f.rangeEach)(0,r.rowspan-1,t=>{(0,f.rangeEach)(0,r.colspan-1,e=>{this.hot.removeCellMeta(r.row+t,r.col+e,"hidden"),this.hot.removeCellMeta(r.row+t,r.col+e,"copyable")})}),this.hot.removeCellMeta(r.row,r.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,t),this.hot.render())}toggleMerge(e){var t=this.mergedCellsCollection.get(e.from.row,e.from.col);t.row===e.from.row&&t.col===e.from.col&&t.row+t.rowspan-1===e.to.row&&t.col+t.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,t,r,n){e=this.hot._createCellCoords(e,t),t=this.hot._createCellCoords(r,n);this.mergeRange(this.hot._createCellRange(e,e,t))}unmerge(e,t,r,n){e=this.hot._createCellCoords(e,t),t=this.hot._createCellCoords(r,n);this.unmergeRange(this.hot._createCellRange(e,e,t))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{var e=this.hot.getSelectedRangeLast();e&&!e.isSingleHeader()&&(this.toggleMerge(e),this.hot.render())},runOnlyIf:e=>!e.altKey,group:_})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(_)}modifyViewportRowStart(t,r){var n=this.hot.rowIndexMapper,i=n.getVisualFromRenderableIndex(t.startRow);for(let e=0;e<r;e+=1){var o=this.mergedCellsCollection.get(i,e);if((0,h.isObject)(o)){o=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o.row,1));if(o<t.startRow)return t.startRow=o,void this.modifyViewportRowStart(t,r)}}}modifyViewportRowEnd(t,r){var n=this.hot.rowIndexMapper,i=n.getVisualFromRenderableIndex(t.endRow);for(let e=0;e<r;e+=1){var o=this.mergedCellsCollection.get(i,e);if((0,h.isObject)(o)){o=o.row+o.rowspan-1,o=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o,-1));if(o>t.endRow)return t.endRow=o,void this.modifyViewportRowEnd(t,r)}}}modifyViewportColumnStart(t,r){var n=this.hot.columnIndexMapper,i=n.getVisualFromRenderableIndex(t.startColumn);for(let e=0;e<r;e+=1){var o=this.mergedCellsCollection.get(e,i);if((0,h.isObject)(o)){o=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o.col,1));if(o<t.startColumn)return t.startColumn=o,void this.modifyViewportColumnStart(t,r)}}}modifyViewportColumnEnd(t,r){var n=this.hot.columnIndexMapper,i=n.getVisualFromRenderableIndex(t.endColumn);for(let e=0;e<r;e+=1){var o=this.mergedCellsCollection.get(e,i);if((0,h.isObject)(o)){o=o.col+o.colspan-1,o=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o,-1));if(o>t.endColumn)return t.endColumn=o,void this.modifyViewportColumnEnd(t,r)}}}translateMergedCellToRenderable(e,t,r,n){var{rowIndexMapper:i,columnIndexMapper:o}=this.hot;let s,a;return s=0===t?i.getNearestNotHiddenIndex(e,1):i.getNearestNotHiddenIndex(e+t-1,-1),a=0===n?o.getNearestNotHiddenIndex(r,1):o.getNearestNotHiddenIndex(r+n-1,-1),[0<=e?i.getRenderableFromVisualIndex(s):e,0<=r?o.getRenderableFromVisualIndex(a):r]}}function M(){this.generateFromSettings(this.hot.getSettings()[S]),this.hot.render()}function k(e){if(e){var t=this.mergedCellsCollection.mergedCells,r=this.hot.getSelectedRangeLast(),n=r.getTopStartCorner(),i=r.getBottomEndCorner();for(let e=0;e<t.length;e+=1)if(n.row===t[e].row&&n.col===t[e].col&&i.row===t[e].row+t[e].rowspan-1&&i.col===t[e].col+t[e].colspan-1)return!1}return e}function D(e){E(R,this).row=e.row,E(R,this).col=e.col}function F(e){var t,r,n,i=this.hot.getSelectedRangeLast()["highlight"],{columnIndexMapper:o,rowIndexMapper:s}=this.hot,a=(E(x,this)&&(null!==s.getRenderableFromVisualIndex(E(x,this).row)&&(i.row=E(x,this).row),null!==o.getRenderableFromVisualIndex(E(x,this).col)&&(i.col=E(x,this).col),C(x,this,null)),this.mergedCellsCollection.get(i.row,i.col));a&&(t=a.col,r=a.col+a.colspan-1,e.col<0?(n=i.col>=t&&i.col<=r?t-1:r,n=o.getNearestNotHiddenIndex(n,-1),e.col=null===n?-this.hot.view.countRenderableColumnsInRange(0,i.col):-Math.max(this.hot.view.countRenderableColumnsInRange(n,i.col)-1,1)):0<e.col&&(n=i.col>=t&&i.col<=r?1+r:t,r=o.getNearestNotHiddenIndex(n,1),e.col=null===r?this.hot.view.countRenderableColumnsInRange(i.col,this.hot.countCols()):Math.max(this.hot.view.countRenderableColumnsInRange(i.col,r)-1,1)),t=a.row,o=a.row+a.rowspan-1,e.row<0?(n=i.row>=t&&i.row<=o?t-1:o,r=s.getNearestNotHiddenIndex(n,-1),e.row=null===r?-this.hot.view.countRenderableRowsInRange(0,i.row):-Math.max(this.hot.view.countRenderableRowsInRange(r,i.row)-1,1)):0<e.row&&(a=i.row>=t&&i.row<=o?1+o:t,n=s.getNearestNotHiddenIndex(a,1),e.row=null===n?this.hot.view.countRenderableRowsInRange(i.row,this.hot.countRows()):Math.max(this.hot.view.countRenderableRowsInRange(i.row,n)-1,1)))}function H(t){var r=this.hot.getSelectedRangeLast();const n=r.clone();var i=r["to"],{columnIndexMapper:o,rowIndexMapper:s}=this.hot,a=(e,t)=>{n.expand(this.hot._createCellCoords(e,t));for(let e=0;e<this.mergedCellsCollection.mergedCells.length;e+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[e].getRange())};if(t.col<0){let e=this.mergedCellsCollection.getStartMostColumnIndex(r,i.col)+t.col;a(i.row,e),"E-W"===r.getHorizontalDirection()&&"E-W"===n.getHorizontalDirection()&&(e=n.getTopStartCorner().col);var l=o.getNearestNotHiddenIndex(e,1);null!==l&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,i.col)-1,1))}else if(0<t.col){let e=this.mergedCellsCollection.getEndMostColumnIndex(r,i.col)+t.col;a(i.row,e),"W-E"===r.getHorizontalDirection()&&"W-E"===n.getHorizontalDirection()&&(e=n.getBottomEndCorner().col);l=o.getNearestNotHiddenIndex(e,-1);null!==l&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(i.col,l)-1,1))}if(t.row<0){let e=this.mergedCellsCollection.getTopMostRowIndex(r,i.row)+t.row;a(e,i.col),"S-N"===r.getVerticalDirection()&&"S-N"===n.getVerticalDirection()&&(e=n.getTopStartCorner().row);o=s.getNearestNotHiddenIndex(e,1);null!==o&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(o,i.row)-1,1))}else if(0<t.row){let e=this.mergedCellsCollection.getBottomMostRowIndex(r,i.row)+t.row;a(e,i.col),"N-S"===r.getVerticalDirection()&&"N-S"===n.getVerticalDirection()&&(e=n.getBottomStartCorner().row);l=s.getNearestNotHiddenIndex(e,-1);null!==l&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(i.row,l)-1,1))}}function U(){var t=this.hot.getSelectedRangeLast(),e=t["highlight"];if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader())C(x,this,e.clone());else{for(let e=0;e<this.mergedCellsCollection.mergedCells.length;e+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[e].getRange(),!1);for(let e=0;e<this.mergedCellsCollection.mergedCells.length;e+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[e].getRange(),!1);var r=this.mergedCellsCollection.get(e.row,e.col);C(x,this,e.clone()),r&&e.assign(r)}}function V(e,t){if(!(e<0||t<0)){var r,n,e=this.mergedCellsCollection.get(e,t);if(e)return{row:t,col:e,colspan:r,rowspan:n}=e,[t,e,t+n-1,e+r-1]}}function W(e){e.items.push({name:"---------"},(0,u.default)(this))}function P(){C(x,this,null)}function $(){var e,t,r;E(x,this).isCell()||(e=(t=this.hot.getSelectedRangeLast()).getVerticalDirection(),t=t.getHorizontalDirection(),r=E(x,this).clone().normalize(),E(A,this).setActiveNode(r.row,r.col),0<E(R,this).row||0<E(R,this).col?E(A,this).setPrevNodeAsActive():("E-W"===t&&E(R,this).col<0||"S-N"===e&&E(R,this).row<0)&&E(A,this).setNextNodeAsActive())}function B(e,t){var r,n,i=this.hot.getSelectedRangeLast(),{columnIndexMapper:o,rowIndexMapper:s}=this.hot;let a=null,l=null;E(R,this).col<0?({rowEnd:n,colEnd:r}=E(A,this).getPrevHorizontalNode(),l=o.getNearestNotHiddenIndex(r,-1),a=s.getNearestNotHiddenIndex(n,-1)):0<E(R,this).col?({rowStart:r,colStart:n}=E(A,this).getNextHorizontalNode(),l=o.getNearestNotHiddenIndex(n,1),a=s.getNearestNotHiddenIndex(r,1)):E(R,this).row<0?({rowEnd:n,colEnd:r}=E(A,this).getPrevVerticalNode(),l=o.getNearestNotHiddenIndex(r,-1),a=s.getNearestNotHiddenIndex(n,-1)):0<E(R,this).row&&({rowStart:r,colStart:n}=E(A,this).getNextVerticalNode(),l=o.getNearestNotHiddenIndex(n,1),a=s.getNearestNotHiddenIndex(r,1)),null===a&&null===l||(o=this.hot._createCellCoords(a,l),n=this.mergedCellsCollection.get(o.row,o.col),s=this.hot.selection.highlight.getFocus(),e=o.row,t=o.col,n?i.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1)}):i.highlight.assign(o),s.clear(),s.add(o).commit()),E(A,this).setActiveNode(e,t),C(R,this,{row:0,col:0})}function j(){this.hot.getSelectedRangeLast().isHeader()||E(A,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function z(e,t,r){var n=this.mergedCellsCollection.get(e,t);n&&(n.row!==e||n.col!==t?r.copyable=!1:(r.rowspan=n.rowspan,r.colspan=n.colspan))}function Y(e){var t=this.hot.countCols();this.modifyViewportRowStart(e,t),this.modifyViewportRowEnd(e,t)}function G(e){var t=this.hot.countRows();this.modifyViewportColumnStart(e,t),this.modifyViewportColumnEnd(e,t)}function q(e,t){this.autofillCalculations.correctSelectionAreaSize(t);var r,n=this.autofillCalculations.getDirection(t,e);let i=e;return i=this.autofillCalculations.dragAreaOverlapsCollections(t,i,n)?t:(e=this.hot._createCellCoords(t[0],t[1]),r=this.hot._createCellCoords(t[2],t[3]),e=this.hot._createCellRange(e,e,r),r=this.mergedCellsCollection.getWithinRange(e),0!==r.length?this.autofillCalculations.snapDragArea(t,i,n,r):i)}function K(e,t){this.mergedCellsCollection.shiftCollections("right",e,t)}function X(e,t){this.mergedCellsCollection.shiftCollections("left",e,t)}function J(e,t,r){"auto"!==r&&this.mergedCellsCollection.shiftCollections("down",e,t)}function Z(e,t){this.mergedCellsCollection.shiftCollections("up",e,t)}function Q(e,t){"Autofill.fill"===t&&this.autofillCalculations.recreateAfterDataPopulation(e)}function ee(t,e){if(e&&"area"===e){const r=this.hot.getSelectedRangeLast();e=this.mergedCellsCollection.getWithinRange(r);(0,d.arrayEach)(e,e=>{r.getBottomEndCorner().row===e.getLastRow()&&r.getBottomEndCorner().col===e.getLastColumn()&&(t[2]=e.row,t[3]=e.col)})}}function te(e,t,r,n){if(r)return this.selectionCalculations.getSelectedMergedCellClassName(e,t,r,n)}function re(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function ne(e,t,r,n){if(n instanceof MouseEvent){var i,n=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getByRange(n);if(o)return i=this.hot._createCellCoords(o.row,o.col),o=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1),0===this.hot.selection.getLayerLevel()&&n.isEqual(this.hot._createCellRange(i,i,o))}}function ie(n,i,o){if(!this.hot.getSettings().rowHeaders&&"bottom"!==o&&"bottom_inline_start_corner"!==o){let e,t;t="master"===o?(e=this.hot.view.getFirstRenderedVisibleColumn(),this.hot.view.getLastRenderedVisibleColumn()):(s=this.hot.view.getOverlayByName(o),e=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s.clone.wtTable.getFirstRenderedColumn()),this.hot.columnIndexMapper.getVisualFromRenderableIndex(s.clone.wtTable.getLastRenderedColumn()));var s=this.mergedCellsCollection.get(i,e);if(s){var s=this.hot._createCellCoords(i,e),a=this.hot._createCellCoords(i,t),s=this.hot._createCellRange(s,s,a),a=this.mergedCellsCollection.getWithinRange(s);const l=a.reduce((e,t)=>{t=t.rowspan;return Math.max(e,t)},1);let r=0;1<a.length&&a[0].rowspan<l&&(r=l-a[0].rowspan),a.forEach(e=>{var e=e["rowspan"];let t=0;t="top"===o||"top_inline_start_corner"===o?Math.min(l,this.hot.view.countNotHiddenFixedRowsTop()-i):e-r,n=Math.max(null!=(e=n)?e:0,T(O,this,oe).call(this,i,t))})}}return n}function oe(t,r){var n,i=this.hot.view._wt.wtSettings.getSettingPure("defaultRowHeight"),o=this.hot.getPlugin("autoRowSize");let s=0;for(let e=t;e<t+r;e++)this.hot.rowIndexMapper.isHidden(e)||(s+=null!=(n=null==o?void 0:o.getRowHeight(e))?n:i);return s}e.MergeCells=I},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),r(286),r(495),r(290),r(302),r(305),r(309),r(312),r(315),r(318),n(r(487))),o=n(r(1011)),s=r(512),u=r(500),a=r(478),l=r(477);function c(e,t){var r=e;if(t.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object");t.add(e)}function d(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var h=new WeakSet;class p{constructor(e){c(this,h),(0,i.default)(this,"plugin",void 0),(0,i.default)(this,"mergedCells",[]),(0,i.default)(this,"mergedCellsMatrix",new Map),(0,i.default)(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){var{row:e,col:t}=e;return(0,l.toSingleLine)`The merged cell declared at [${e}, ${t}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,t){return!!this.mergedCellsMatrix.has(e)&&null!=(e=this.mergedCellsMatrix.get(e).get(t))&&e}getByRange(t){let r=!1;return(0,a.arrayEach)(this.mergedCells,e=>!(e.row<=t.from.row&&e.row+e.rowspan-1>=t.to.row&&e.col<=t.from.col&&e.col+e.colspan-1>=t.to.col)||(r=e)),r}filterOverlappingMergeCells(e){const c=new Set;return this.mergedCells.forEach(e=>{var{row:r,col:n,colspan:i,rowspan:o}=e;for(let t=r;t<r+o;t++)for(let e=n;e<n+i;e++)c.add(`r${t},c`+e)}),e.filter(r=>{var{row:e,col:n,colspan:i,rowspan:o}=r,s=new Set;let a=!1;for(let t=e;t<e+o;t++){for(let e=n;e<n+i;e++){var l=`r${t},c`+e;if(c.has(l)){(0,u.warn)(p.IS_OVERLAPPING_WARNING(r)),a=!0;break}s.add(l)}if(a)break}return a||c.add(...s),!a})}getWithinRange(e){var r=1<arguments.length&&void 0!==arguments[1]&&arguments[1],{row:n,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),a=[];for(let t=n;t<=o;t++)for(let e=i;e<=s;e++){var l=this.get(t,e);l&&(r||!r&&l.row===t&&l.col===e)&&a.push(l)}return a}add(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],r=e.row,n=e.col,i=e.rowspan,e=e.colspan,i=new o.default(r,n,i,e,this.hot._createCellCoords,this.hot._createCellRange),e=this.get(r,n),r=!t&&this.isOverlapping(i);return e||r?((0,u.warn)(p.IS_OVERLAPPING_WARNING(i)),!1):(this.hot&&i.normalize(this.hot),this.mergedCells.push(i),d(h,this,g).call(this,i),i)}remove(e,t){e=this.get(e,t),t=e?this.mergedCells.indexOf(e):-1;return!(!e||-1===t)&&(this.mergedCells.splice(t,1),d(h,this,m).call(this,e),e)}clear(){(0,a.arrayEach)(this.mergedCells,e=>{let{row:t,col:r,rowspan:n,colspan:i}=e;(0,s.rangeEach)(t,t+n,t=>{(0,s.rangeEach)(r,r+i,e=>{e=this.hot.getCell(t,e);e&&(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){var t=e.getRange();for(let e=0;e<this.mergedCells.length;e++)if(this.mergedCells[e].getRange().overlaps(t))return!0;return!1}isFirstRenderableMergedCell(e,t){var r=this.get(e,t);return r&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1)===t}getFirstRenderableCoords(e,t){var r=this.get(e,t);return!r||this.isFirstRenderableMergedCell(e,t)||(e=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),t=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1)),this.hot._createCellCoords(e,t)}getStartMostColumnIndex(e,t){var r=d(h,this,f).call(this,e,"col",-1);let n=t;for(let e=0;e<r.length;e++)if(r[e]<=t){n=r[e];break}return n}getEndMostColumnIndex(e,t){var r=d(h,this,f).call(this,e,"col",1);let n=t;for(let e=0;e<r.length;e++)if(r[e]>=t){n=r[e];break}return n}getTopMostRowIndex(e,t){var r=d(h,this,f).call(this,e,"row",-1);let n=t;for(let e=0;e<r.length;e++)if(r[e]<=t){n=r[e];break}return n}getBottomMostRowIndex(e,t){var r=d(h,this,f).call(this,e,"row",1);let n=t;for(let e=0;e<r.length;e++)if(r[e]>=t){n=r[e];break}return n}shiftCollections(e,t,r){const n=[0,0];switch(e){case"right":n[0]+=r;break;case"left":n[0]-=r;break;case"down":n[1]+=r;break;case"up":n[1]-=r}(0,a.arrayEach)(this.mergedCells,e=>{d(h,this,m).call(this,e),e.shift(n,t),d(h,this,g).call(this,e)}),(0,s.rangeEachReverse)(this.mergedCells.length-1,0,e=>{e=this.mergedCells[e];e&&e.removed&&(this.mergedCells.splice(this.mergedCells.indexOf(e),1),d(h,this,m).call(this,e))})}}function f(e,n){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,o=new Map,s=1===i?e.getTopStartCorner():e.getBottomEndCorner(),a=1===i?e.getBottomEndCorner():e.getTopStartCorner();for(let r=s.row;1===i?r<=a.row:r>=a.row;r+=i)for(let t=s.col;1===i?t<=a.col:t>=a.col;t+=i){var l="row"===n?r:t,c=this.get(r,t);let e=l;c&&(e=1===i?c[n]+c[n+"span"]-1:c[n]),o.has(l)||o.set(l,new Set),o.get(l).add(e)}return Array.from(new Set(Array.from(o.entries()).filter(e=>{var[,e]=e;return 1===e.size}).flatMap(e=>{var[,e]=e;return Array.from(e)})))}function g(r){for(let t=r.row;t<r.row+r.rowspan;t++)for(let e=r.col;e<r.col+r.colspan;e++)this.mergedCellsMatrix.has(t)||this.mergedCellsMatrix.set(t,new Map),this.mergedCellsMatrix.get(t).set(e,r)}function m(r){for(let t=r.row;t<r.row+r.rowspan;t++)for(let e=r.col;e<r.col+r.colspan;e++)this.mergedCellsMatrix.get(t).delete(e)}t.default=p},(e,t,r)=>{"use strict";var n=r(197),s=(t.__esModule=!0,r(204),n(r(487))),i=r(477);function a(e,t,r){var n=e;if(t.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object");t.set(e,r)}function o(e,t){return e.get(l(e,t))}function c(e,t,r){e.set(l(e,t),r)}function l(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var u=new WeakMap;t.default=class{constructor(e,t,r,n,i,o){(0,s.default)(this,"row",void 0),(0,s.default)(this,"col",void 0),(0,s.default)(this,"rowspan",void 0),(0,s.default)(this,"colspan",void 0),(0,s.default)(this,"removed",!1),(0,s.default)(this,"cellCoordsFactory",void 0),(0,s.default)(this,"cellRangeFactory",void 0),a(this,u,null),this.row=e,this.col=t,this.rowspan=r,this.colspan=n,this.cellCoordsFactory=i,this.cellRangeFactory=o}static NEGATIVE_VALUES_WARNING(e){var{row:e,col:t,rowspan:r,colspan:n}=e;return(0,i.toSingleLine)`The merged cell declared with {row: ${e}, col: ${t},\x20
      rowspan: ${r}, colspan: ${n}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){var{row:e,col:t}=e;return(0,i.toSingleLine)`The merged cell declared at [${e}, ${t}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){var{row:e,col:t}=e;return(0,i.toSingleLine)`The merged cell declared at [${e}, ${t}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){var{row:e,col:t}=e;return(0,i.toSingleLine)`The merged cell declared at [${e}, ${t}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){var{row:e,col:t,rowspan:r,colspan:n}=e;return e<0||t<0||r<0||n<0}static isSingleCell(e){var{rowspan:e,colspan:t}=e;return 1===t&&1===e}static containsZeroSpan(e){var{rowspan:e,colspan:t}=e;return 0===t||0===e}static isOutOfBounds(e,t,r){return e.row<0||e.col<0||e.row>=t||e.row+e.rowspan-1>=t||e.col>=r||e.col+e.colspan-1>=r}normalize(e){var t=e.countRows(),e=e.countCols();this.row<0?this.row=0:this.row>t-1&&(this.row=t-1),this.col<0?this.col=0:this.col>e-1&&(this.col=e-1),this.row+this.rowspan>t-1&&(this.rowspan=t-this.row),this.col+this.colspan>e-1&&(this.colspan=e-this.col),c(u,this,null)}includes(e,t){return this.row<=e&&this.col<=t&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=t}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,t){var r,n=e[0]||e[1],i=t+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",e=e[0]?"col":"row",s=Math.min(t,i),i=Math.max(t,i),a=this[e],l=this[e]+this[o]-1;if(t<=a&&(this[e]+=n),0<n)t<=l&&a<t&&(this[o]+=n);else if(n<0){if(s<=a&&l<=i)return this.removed=!0,c(u,this,null),!1;s<=a&&a<=i?(t=i-a+1,r=Math.abs(n)-t,this[e]-=r+n,this[o]-=t):a<=s&&i<=l?this[o]+=n:a<=s&&s<=l&&l<i&&(this[o]-=l-s+1)}return c(u,this,null),!0}isFarther(e,t){return!e||("down"===t?e.row+e.rowspan-1<this.row+this.rowspan-1:"up"===t?e.row>this.row:"right"===t?e.col+e.colspan-1<this.col+this.colspan-1:"left"===t?e.col>this.col:null)}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return o(u,this)||c(u,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),o(u,this)}}},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(487))),o=r(482),g=r(478);t.default=class{constructor(e){(0,i.default)(this,"plugin",void 0),(0,i.default)(this,"mergedCellsCollection",void 0),(0,i.default)(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(e){var t;e[0]===e[2]&&e[1]===e[3]&&(t=this.mergedCellsCollection.get(e[0],e[1]))&&(e[2]=e[0]+t.rowspan-1,e[3]=e[1]+t.colspan-1)}getDirection(e,t){let r=null;return r=t[0]===e[0]&&t[1]===e[1]&&t[3]===e[3]?"down":t[2]===e[2]&&t[1]===e[1]&&t[3]===e[3]?"up":t[1]===e[1]&&t[2]===e[2]?"right":"left"}snapDragArea(e,t,r,n){var i=t.slice(0),o=this.getAutofillSize(e,t,r),[s,a,l,c]=e,u=-1<["up","down"].indexOf(r)?l-s+1:c-a+1,d=o-Math.floor(o/u)*u,t=this.getFarthestCollection(e,t,r,n);return t&&("down"===r?(s=t.row+t.rowspan-s-d,i[2]+s>=this.plugin.hot.countRows()?i[2]-=d:i[2]+=d?s:0):"right"===r?(s=t.col+t.colspan-a-d,i[3]+s>=this.plugin.hot.countCols()?i[3]-=d:i[3]+=d?s:0):"up"===r?(a=l-d-t.row+1,i[0]+a<0?i[0]+=d:i[0]-=d?a:0):"left"===r&&(s=c-d-t.col+1,i[1]+s<0?i[1]+=d:i[1]-=d?s:0)),this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:n,fillSize:o,dragArea:i,cycleLength:u}),i}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),(0,o.extend)(this.currentFillData,e)}getAutofillSize(e,t,r){var[n,i,o,s]=e,[a,l,c,u]=t;switch(r){case"up":return n-a;case"down":return c-o;case"left":return i-l;case"right":return u-s;default:return null}}getDragArea(e,t,r){var[n,i,o,s]=e,[a,l,c,u]=t;switch(r){case"up":return[a,l,n-1,s];case"down":return[o+1,i,c,s];case"left":return[a,l,o,i-1];case"right":return[n,s+1,c,u];default:return null}}getFarthestCollection(e,t,r,n){var[i,o,s,a]=e,l=-1<["up","down"].indexOf(r),c=l?s:a,u=l?i:o,e=this.getAutofillSize(e,t,r),t=l?s-i+1:a-o+1,d=e-Math.floor(e/t)*t;let h=null,p=null,f=null;switch(r){case"up":h="includesVertically",f=c-d+1;break;case"left":h="includesHorizontally",f=c-d+1;break;case"down":h="includesVertically",f=u+d-1;break;case"right":h="includesHorizontally",f=u+d-1}return(0,g.arrayEach)(n,e=>{e[h](f)&&e.isFarther(p,r)&&(p=e)}),p}recreateAfterDataPopulation(e){if(this.currentFillData){const s=this.getRangeFromChanges(e);var i=this.currentFillData.foundMergedCells;const a=this.currentFillData.dragDirection;var o=(e,t)=>{switch(a){case"up":return e.row-t>=s.from.row;case"down":return e.row+e.rowspan-1+t<=s.to.row;case"left":return e.col-t>=s.from.column;case"right":return e.col+e.colspan-1+t<=s.to.column;default:return null}};let t=0,r=null,n=1;do{for(let e=0;e<i.length;e+=1){if(r=i[e],t=n*this.currentFillData.cycleLength,o(r,t))switch(a){case"up":this.plugin.mergedCellsCollection.add({row:r.row-t,rowspan:r.rowspan,col:r.col,colspan:r.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:r.row+t,rowspan:r.rowspan,col:r.col,colspan:r.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:r.row,rowspan:r.rowspan,col:r.col-t,colspan:r.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:r.row,rowspan:r.rowspan,col:r.col+t,colspan:r.colspan})}e===i.length-1&&(n+=1)}}while(o(r,t));this.currentFillData=null,this.plugin.hot.render(),0<i.length&&this.plugin.ifChromeForceRepaint()}}getRangeFromChanges(e){const r={min:null,max:null},n={min:null,max:null};return(0,g.arrayEach)(e,e=>{var t=e[0],e=this.plugin.hot.propToCol(e[1]);(null===r.min||t<r.min)&&(r.min=t),(null===r.max||t>r.max)&&(r.max=t),(null===n.min||e<n.min)&&(n.min=e),(null===n.max||e>n.max)&&(n.max=e)}),{from:{row:r.min,column:n.min},to:{row:r.max,column:n.max}}}dragAreaOverlapsCollections(e,t,r){var[e,t,r,n]=this.getDragArea(e,t,r),e=this.plugin.hot._createCellCoords(e,t),t=this.plugin.hot._createCellCoords(r,n),r=this.plugin.hot._createCellRange(e,e,t);return 0<this.mergedCellsCollection.getWithinRange(r,!0).length}}},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(286),n(r(487)));t.default=class{constructor(e){(0,i.default)(this,"plugin",void 0),(0,i.default)(this,"hot",void 0),(0,i.default)(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,t,r,n){var i=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),r=Math.max(r[1],r[3]);if(void 0!==n&&this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,t)){var a,e=this.plugin.mergedCellsCollection.get(e,t);if(e)return t=e.getLastRow(),a=e.getLastColumn(),i<=e.row&&o<=e.col&&t<=s&&a<=r?this.fullySelectedMergedCellClassName+"-"+n:this.isMergeCellFullySelected(e,this.plugin.hot.getSelectedRange())?this.fullySelectedMergedCellClassName+"-multiple":void 0}}isMergeCellFullySelected(r,n){var i=[];if(!n||!r)return!1;for(let t=0;t<r.rowspan;t+=1)for(let e=0;e<r.colspan;e+=1)i.push(this.hot._createCellCoords(r.row+t,r.col+e));for(let t=0;t<i.length;t+=1){var o=[];for(let e=0;e<n.length;e+=1)o[e]=n[e].includes(i[t]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){var t=[];for(let e=0;e<=7;e+=1)t.push(this.fullySelectedMergedCellClassName+"-"+e);return t.push(this.fullySelectedMergedCellClassName+"-multiple"),t}}},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,t.default=function(n){return{key:"mergeCells",name(){var e=this.getSelectedLast();if(e){var t=n.mergedCellsCollection.get(e[0],e[1]);if(t.row===e[0]&&t.col===e[1]&&t.row+t.rowspan-1===e[2]&&t.col+t.colspan-1===e[3])return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_UNMERGE_CELLS)}return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_MERGE_CELLS)},callback(){var e,t,r=this.getSelectedRangeLast();r&&(r.setDirection(this.isRtl()?"NE-SW":"NW-SE"),{from:e,to:t}=r,n.toggleMerge(r),this.selectCell(e.row,e.col,t.row,t.col,!1))},disabled(){var e=this.getSelectedLast();return!e||o.default.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner()},hidden:!1}},function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621))),o=n(r(1011));function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}},(e,t,r)=>{"use strict";r.r(t)},(e,t,r)=>{"use strict";var n=r(197),c=(t.__esModule=!0,r(204),r(286),n(r(1017)));function o(e,t,r){s(e,t),t.set(e,r)}function s(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function u(e,t){return e.get(h(e,t))}function d(e,t,r){e.set(h(e,t),r)}function h(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var p=new WeakMap,f=new WeakMap,g=new WeakMap,m=new WeakMap,y=new WeakMap,v=new WeakMap,b=new WeakMap,w=new WeakSet;function C(e,t,r,n,i){var o=e.getTopStartCorner(),s=e.getBottomEndCorner(),e=e.highlight.clone().normalize(),a=u(y,this).call(this,n,i);if(a&&r.has(a))return null;var l={colStart:i,colEnd:i,rowStart:n,rowEnd:n};if(a){if(r.add(a),a.row<o.row||a.row+a.rowspan-1>s.row||a.col<o.col||a.col+a.colspan-1>s.col)return null;l.colStart=a.col,l.colEnd=a.col+a.colspan-1,l.rowStart=a.row,l.rowEnd=a.row+a.rowspan-1}r=t.push(l);return n===e.row&&i===e.col||a&&e.row>=a.row&&e.row<=a.row+a.rowspan-1&&e.col>=a.col&&e.col<=a.col+a.colspan-1?r:null}t.FocusOrder=class{constructor(e){var t,r,{mergedCellsGetter:e,rowIndexMapper:n,columnIndexMapper:i}=e;s(t=this,r=w),r.add(t),o(this,p,new c.default),o(this,f,new c.default),o(this,g,null),o(this,m,null),o(this,y,null),o(this,v,null),o(this,b,null),d(y,this,e),d(v,this,n),d(b,this,i)}getCurrentVerticalNode(){return u(m,this).data}getFirstVerticalNode(){return u(f,this).first.data}getNextVerticalNode(){return u(m,this).next.data}getPrevVerticalNode(){return u(m,this).prev.data}getCurrentHorizontalNode(){return u(g,this).data}getFirstHorizontalNode(){return u(p,this).first.data}getNextHorizontalNode(){return u(g,this).next.data}getPrevHorizontalNode(){return u(g,this).prev.data}setPrevNodeAsActive(){d(m,this,u(m,this).prev),d(g,this,u(g,this).prev)}setNextNodeAsActive(){d(m,this,u(m,this).next),d(g,this,u(g,this).next)}buildFocusOrder(r){var n,i=r.getTopStartCorner(),o=r.getBottomEndCorner(),s=new WeakSet;d(p,this,new c.default);for(let t=i.row;t<=o.row;t++)if(!u(v,this).isHidden(t))for(let e=i.col;e<=o.col;e++)u(b,this).isHidden(e)||(n=h(w,this,C).call(this,r,u(p,this),s,t,e))&&d(g,this,n);u(p,this).first&&(u(p,this).first.prev=u(p,this).last,u(p,this).last.next=u(p,this).first);var a,l=new WeakSet;d(f,this,new c.default);for(let t=i.col;t<=o.col;t++)if(!u(b,this).isHidden(t))for(let e=i.row;e<=o.row;e++)u(v,this).isHidden(e)||(a=h(w,this,C).call(this,r,u(f,this),l,e,t))&&d(m,this,a);u(f,this).first&&(u(f,this).first.prev=u(f,this).last,u(f,this).last.next=u(f,this).first)}setActiveNode(o,s){return u(p,this).inorder(e=>{var{rowStart:t,rowEnd:r,colStart:n,colEnd:i}=e.data;if(t<=o&&o<=r&&n<=s&&s<=i)return d(g,this,e),!1}),u(f,this).inorder(e=>{var{rowStart:t,rowEnd:r,colStart:n,colEnd:i}=e.data;if(t<=o&&o<=r&&n<=s&&s<=i)return d(m,this,e),!1}),this}}},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(487)));class o{constructor(e){(0,i.default)(this,"data",void 0),(0,i.default)(this,"next",null),(0,i.default)(this,"prev",null),this.data=e}}t.NodeStructure=o;t.default=class{constructor(){(0,i.default)(this,"first",null),(0,i.default)(this,"last",null)}push(e){var t,e=new o(e);return null===this.first?(this.first=e,this.last=e):(t=this.last,((this.last=e).prev=t).next=e),e}unshift(e){var t,e=new o(e);null===this.first?(this.first=e,this.last=e):(t=this.first,((this.first=e).next=t).prev=e)}inorder(e){let t=this.first;for(;t;){var r=e(t);if(t===this.last||!0===r)break;t=t.next}}remove(t){if(null!==this.first){let e=this.first;for(var r,n;e;){if(e.data===t)return r=e.next,n=e.prev,r&&(r.prev=n),n&&(n.next=r),e===this.first&&(this.first=r),e===this.last&&(this.last=n),!0;e=e.next}}return!1}hasCycle(){let e=this.first,t=this.first;for(;;){if(null===e)return!1;if(null===(e=e.next))return!1;if(e=e.next,t=t.next,e===t)return!0}}pop(){var e;return null===this.last?null:(e=this.last,this.last=this.last.prev,e)}shift(){var e;return null===this.first?null:(e=this.first,this.first=this.first.next,e)}recursiveReverse(){var e;this.first&&(function e(t,r){r&&(e(r,r.next),r.next=t)}(this.first,this.first.next),this.first.next=null,e=this.first,this.first=this.last,this.last=e)}reverse(){if(this.first&&this.first.next){let e=this.first.next,t=this.first,r;for(;e;)r=e.next,(e.next=t).prev=e,t=e,e=r;this.first.next=null,this.last.prev=null,r=this.first,this.first=t,this.last=r}}}},(e,t,r)=>{"use strict";t.__esModule=!0,t.createMergeCellRenderer=function(c){const e=c["hot"],{rowIndexMapper:u,columnIndexMapper:d}=e;return{before:function(){},after:function(e,t,r){var n,i,o,s,a,l=c.mergedCellsCollection.get(t,r);(0,h.isObject)(l)?({row:l,col:o,colspan:n,rowspan:s}=l,[a,i]=c.translateMergedCellToRenderable(l,s,o,n),a=a-u.getRenderableFromVisualIndex(t)+1,i=i-d.getRenderableFromVisualIndex(r)+1,l=u.getNearestNotHiddenIndex(l,1),o=d.getNearestNotHiddenIndex(o,1),s=Math.min(s,a),a=Math.min(n,i),l===t&&o===r?(e.setAttribute("rowspan",s),e.setAttribute("colspan",a)):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="none")):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="")}}};var h=r(482)},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(1020);t.PLUGIN_KEY=r.PLUGIN_KEY,t.PLUGIN_PRIORITY=r.PLUGIN_PRIORITY,t.MultiColumnSorting=r.MultiColumnSorting},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(487))),o=r(829),n=r(833),s=r(832),a=r(334),l=r(1021),c=r(1022),u=r(1023),d=r(656);r(1024);const h=t.PLUGIN_KEY="multiColumnSorting",p=(t.PLUGIN_PRIORITY=170,"columnSorting"),f=h;(0,n.registerRootComparator)(h,l.rootComparator);class g extends o.ColumnSorting{constructor(){super(...arguments),(0,i.default)(this,"pluginKey",h)}static get PLUGIN_KEY(){return h}static get PLUGIN_PRIORITY(){return 170}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[p]&&((0,c.warnAboutPluginsConflict)(),this.hot.getPlugin(p).disablePlugin()),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{var e=this.hot.getSelectedRangeLast()["highlight"];return-1===e.row&&0<=e.col&&this.sort(this.getNextSortConfig(e.col,o.APPEND_COLUMN_CONFIG_STRATEGY)),!1},runOnlyIf:()=>{var e,t=null==(t=this.hot.getSelectedRangeLast())?void 0:t.highlight;return t&&(null==(e=this.hot.getSelectedRangeLast())?void 0:e.isSingle())&&this.hot.selection.isCellVisible(t)&&t.isHeader()},relativeToGroup:d.EDITOR_EDIT_GROUP,position:"before",group:f})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(f)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];super.updateHeaderClasses(e,...r),(0,a.removeClass)(e,(0,u.getClassesToRemove)(e)),!1!==this.enabled&&(0,a.addClass)(e,(0,u.getClassesToAdd)(...r))}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[p]&&(0,c.warnAboutPluginsConflict)(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,t){!1!==(0,s.wasHeaderClickedProperly)(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(t.col),this.sort(this.getNextSortConfig(t.col,o.APPEND_COLUMN_CONFIG_STRATEGY))):this.sort(this.getColumnNextConfig(t.col)))}}t.MultiColumnSorting=g},(e,t,r)=>{"use strict";t.__esModule=!0,t.rootComparator=function(c,u){return function(e,t){const[,...a]=e,[,...l]=t;return function e(t){var r=c[t],n=u[t],i=a[t],o=l[t],s=n.multiColumnSorting,r=(s.compareFunctionFactory||(0,d.getCompareFunctionFactory)(n.type))(r,n,s)(i,o);if(r===d.DO_NOT_SWAP){n=t+1;if(void 0!==u[n])return e(n)}return r}(0)}};var d=r(833)},(e,t,r)=>{"use strict";t.__esModule=!0,t.warnAboutPluginsConflict=function(){(0,n.warn)((0,i.toSingleLine)`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work. The \`columnSorting\` plugin will be disabled.`)};var n=r(500),i=r(477)},(e,t,r)=>{"use strict";t.__esModule=!0,t.getClassesToAdd=function(e,t,r){var n=[];return!1!==r&&e.isColumnSorted(t)&&1<e.getNumberOfSortedColumns()&&n.push(i+"-"+(e.getIndexOfColumnInSortQueue(t)+1)),n},t.getClassesToRemove=function(e){const t=e.className.split(" "),r=new RegExp(`^${i}-[0-9]{1,2}$`);return t.filter(e=>r.test(e))},r(286);const i="sort"},(e,t,r)=>{"use strict";r.r(t)},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(1026);t.PLUGIN_KEY=r.PLUGIN_KEY,t.PLUGIN_PRIORITY=r.PLUGIN_PRIORITY,t.MultipleSelectionHandles=r.MultipleSelectionHandles},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(286),n(r(487))),o=r(334),s=r(481),n=r(813);t.PLUGIN_KEY="multipleSelectionHandles",t.PLUGIN_PRIORITY=160;class a extends n.BasePlugin{constructor(){super(...arguments),(0,i.default)(this,"dragged",[]),(0,i.default)(this,"lastSetCell",null)}static get PLUGIN_KEY(){return"multipleSelectionHandles"}static get PLUGIN_PRIORITY(){return 160}isEnabled(){return(0,s.isMobileBrowser)()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const a=this;var e=this.hot["rootElement"];function t(e){return 1===a.dragged.length?(a.dragged.splice(0,a.dragged.length),!0):-1!==(e=a.dragged.indexOf(e))&&void(0===e?a.dragged=a.dragged.slice(0,1):1===e&&(a.dragged=a.dragged.slice(-1)))}this.eventManager.addEventListener(e,"touchstart",e=>{let t;return(0,o.hasClass)(e.target,"topSelectionHandle-HitArea")?(t=a.hot.getSelectedRangeLast(),a.dragged.push("top"),a.touchStartRange={width:t.getWidth(),height:t.getHeight(),direction:t.getDirection()},e.preventDefault(),!1):(0,o.hasClass)(e.target,"bottomSelectionHandle-HitArea")?(t=a.hot.getSelectedRangeLast(),a.dragged.push("bottom"),a.touchStartRange={width:t.getWidth(),height:t.getHeight(),direction:t.getDirection()},e.preventDefault(),!1):void 0}),this.eventManager.addEventListener(e,"touchend",e=>(0,o.hasClass)(e.target,"topSelectionHandle-HitArea")?(t.call(a,"top"),a.touchStartRange=void 0,e.preventDefault(),!1):(0,o.hasClass)(e.target,"bottomSelectionHandle-HitArea")?(t.call(a,"bottom"),a.touchStartRange=void 0,e.preventDefault(),!1):void 0),this.eventManager.addEventListener(e,"touchmove",e=>{var t,r,n,i,o,s=this.hot["rootDocument"];0!==a.dragged.length&&(s=s.elementFromPoint(e.touches[0].clientX,e.touches[0].clientY))&&s!==a.lastSetCell&&("TD"!==s.nodeName&&"TH"!==s.nodeName||(-1===(t=a.hot.getCoords(s)).col&&(t.col=0),o=(r=a.hot.getSelectedRangeLast()).getWidth(),n=r.getHeight(),i=r.getDirection(),1===o&&1===n&&a.hot.selection.setRangeEnd(t),null!==(o=a.getCurrentRangeCoords(r,t,a.touchStartRange.direction,i,a.dragged[0])).start&&a.hot.selection.setRangeStart(o.start),a.hot.selection.setRangeEnd(o.end),a.lastSetCell=s),e.preventDefault())})}getCurrentRangeCoords(e,t,r,n,i){var o=e.getTopStartCorner(),s=e.getBottomEndCorner(),a=e.getBottomStartCorner(),l=e.getTopEndCorner();let c={start:null,end:null};switch(r){case"NE-SW":switch(n){case"NE-SW":case"NW-SE":c="top"===i?{start:this.hot._createCellCoords(t.row,e.highlight.col),end:this.hot._createCellCoords(a.row,t.col)}:{start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,o.col)};break;case"SE-NW":"bottom"===i&&(c={start:this.hot._createCellCoords(s.row,t.col),end:this.hot._createCellCoords(t.row,o.col)})}break;case"NW-SE":switch(n){case"NE-SW":"top"===i?c={start:t,end:a}:c.end=t;break;case"NW-SE":"top"===i?c={start:t,end:s}:c.end=t;break;case"SE-NW":"top"===i?c={start:t,end:o}:c.end=t;break;case"SW-NE":"top"===i?c={start:t,end:l}:c.end=t}break;case"SW-NE":switch(n){case"NW-SE":c="bottom"===i?{start:this.hot._createCellCoords(t.row,o.col),end:this.hot._createCellCoords(a.row,t.col)}:{start:this.hot._createCellCoords(o.row,t.col),end:this.hot._createCellCoords(t.row,s.col)};break;case"SW-NE":c="top"===i?{start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,s.col)}:{start:this.hot._createCellCoords(t.row,o.col),end:this.hot._createCellCoords(o.row,t.col)};break;case"SE-NW":"bottom"===i?c={start:this.hot._createCellCoords(t.row,l.col),end:this.hot._createCellCoords(o.row,t.col)}:"top"===i&&(c={start:a,end:t})}break;case"SE-NW":switch(n){case"NW-SE":case"NE-SW":case"SW-NE":"top"===i&&(c.end=t);break;case"SE-NW":"top"===i?c.end=t:c={start:t,end:o}}}return c}isDragged(){return 0<this.dragged.length}}t.MultipleSelectionHandles=a},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(1028);t.PLUGIN_KEY=r.PLUGIN_KEY,t.PLUGIN_PRIORITY=r.PLUGIN_PRIORITY,t.NestedHeaders=r.NestedHeaders},(L,e,t)=>{"use strict";var r=t(197),n=(e.__esModule=!0,t(204),t(286),r(t(487))),h=t(334),u=t(512),i=t(477),l=t(492),o=t(500),a=t(622),s=t(813),c=r(t(1029)),d=r(t(1042));function p(e,t,r){f(e,t),t.set(e,r)}function f(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function g(e,t,r){e.set(y(e,t),r)}function m(e,t){return e.get(y(e,t))}function y(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}t(1043);const v=e.PLUGIN_KEY="nestedHeaders";e.PLUGIN_PRIORITY=280;var b=new WeakMap,w=new WeakMap,C=new WeakMap,E=new WeakMap,T=new WeakSet;class S extends s.BasePlugin{constructor(){var e,t;super(...arguments),f(e=this,t=T),t.add(e),p(this,b,new c.default),p(this,w,null),p(this,C,null),p(this,E,!1),(0,n.default)(this,"ghostTable",new d.default(this.hot,(e,t)=>this.getHeaderSettings(e,t))),(0,n.default)(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return v}static get PLUGIN_PRIORITY(){return 280}isEnabled(){return!!this.hot.getSettings()[v]}enablePlugin(){var e,n=this;this.enabled||(e=this.hot.getSettings()["nestedHeaders"],Array.isArray(e)&&Array.isArray(e[0])||(0,o.warn)((0,i.toSingleLine)`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>y(T,this,$).call(this)),this.addHook("afterLoadData",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return y(T,n,B).call(n,...t)}),this.addHook("beforeOnCellMouseDown",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return y(T,n,N).call(n,...t)}),this.addHook("afterOnCellMouseDown",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return y(T,n,O).call(n,...t)}),this.addHook("beforeOnCellMouseOver",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return y(T,n,I).call(n,...t)}),this.addHook("beforeOnCellMouseUp",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return y(T,n,M).call(n,...t)}),this.addHook("beforeSelectionHighlightSet",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return y(T,n,k).call(n,...t)}),this.addHook("modifyTransformStart",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return y(T,n,D).call(n,...t)}),this.addHook("afterSelection",()=>y(T,this,_).call(this)),this.addHook("afterSelectionFocusSet",()=>y(T,this,_).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return y(T,n,x).call(n,...t)}),this.addHook("afterGetColumnHeaderRenderers",e=>y(T,this,F).call(this,e)),this.addHook("modifyColWidth",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return y(T,n,U).call(n,...t)}),this.addHook("modifyColumnHeaderValue",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return y(T,n,V).call(n,...t)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return y(T,n,R).call(n,...t)}),this.addHook("beforeCopy",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return y(T,n,A).call(n,...t)}),this.addHook("beforeSelectColumns",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return y(T,n,P).call(n,...t)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return y(T,n,H).call(n,...t)}),this.addHook("modifyFocusedElement",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return y(T,n,W).call(n,...t)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>y(T,this,_).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>y(T,this,_).call(this)),super.enablePlugin(),this.updatePlugin())}updatePlugin(){var e;this.hot.view&&(e=this.hot.getSettings()["nestedHeaders"],m(b,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=m(b,this).setState(e)),this.detectedOverlappedHeaders&&(0,o.warn)((0,i.toSingleLine)`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((e,t)=>{e=!0===e?"hide-column":"show-column";m(b,this).triggerColumnModification(e,t)}),!m(w,this)&&this.enabled&&g(w,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(e=>{e.forEach(e=>{var{op:e,index:t,newValue:r}=e;"replace"===e&&(e=!0===r?"hide-column":"show-column",m(b,this).triggerColumnModification(e,t))}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin())}disablePlugin(){this.clearColspans(),m(b,this).clear(),m(w,this).unsubscribe(),g(w,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return m(b,this)}getLayersCount(){return m(b,this).getLayersCount()}getHeaderSettings(e,t){return m(b,this).getHeaderSettings(e,t)}clearColspans(){if(this.hot.view){var e=this.hot.view["_wt"],t=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,n=e.wtOverlays.topOverlay.clone.wtTable.THEAD,i=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let e=0;e<t;e++){var o=r.childNodes[e];if(!o)break;var s=n.childNodes[e],a=i?i.childNodes[e]:null;for(let e=0,t=o.childNodes.length;e<t;e++)o.childNodes[e].removeAttribute("colspan"),(0,h.removeClass)(o.childNodes[e],"hiddenHeader"),s&&s.childNodes[e]&&(s.childNodes[e].removeAttribute("colspan"),(0,h.removeClass)(s.childNodes[e],"hiddenHeader")),i&&a&&a.childNodes[e]&&(a.childNodes[e].removeAttribute("colspan"),(0,h.removeClass)(a.childNodes[e],"hiddenHeader"))}}}headerRendererFactory(c){var u=this;const d=this.hot.view._wt.getSetting("fixedColumnsStart");return(e,t)=>{var{columnIndexMapper:r,view:n}=this.hot;let i=r.getVisualFromRenderableIndex(e);null===i&&(i=e),t.removeAttribute("colspan"),(0,h.removeClass)(t,"hiddenHeader");var o,{colspan:r,isHidden:s,isPlaceholder:a,headerClassNames:l}=null!=(r=m(b,this).getHeaderSettings(c,i))?r:{label:""};a||s?(0,h.addClass)(t,"hiddenHeader"):1<r&&(n=n._wt["wtOverlays"],o=null==(o=n.topInlineStartCornerOverlay)?void 0:o.clone.wtTable.THEAD.contains(t),n=null==(n=n.inlineStartOverlay)?void 0:n.clone.wtTable.THEAD.contains(t),1<(o=o||n?Math.min(r,d-e):r))&&t.setAttribute("colspan",o),this.hot.view.appendColHeader(i,t,function(){return u.getColumnHeaderValue(...arguments)},c),a||s||(n=t.querySelector("div.relative"))&&l&&0<l.length&&((0,h.removeClass)(n,this.hot.getColumnMeta(i).headerClassName),(0,h.addClass)(n,l))}}getColumnHeaderValue(e,t){var{isHidden:r,isPlaceholder:n}=null!=(r=m(b,this).getHeaderSettings(t,e))?r:{};return n||r?"":this.hot.getColHeader(e,t)}destroy(){g(b,this,null),null!==m(w,this)&&(m(w,this).unsubscribe(),g(w,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(0<=e.row||e.col<0))return m(b,this).getHeaderTreeNodeData(e.row,e.col)}}function _(){var e,t=null==(t=this.hot)?void 0:t.getSelectedRangeLast();t&&(t=t["highlight"],t.isHeader())&&0<=t.col&&(t=m(b,this).findLeftMostColumnIndex(t.row,t.col),(e=this.hot.selection.highlight.getFocus()).visualCellRange.highlight.col=t,e.visualCellRange.from.col=t,e.visualCellRange.to.col=t,e.commit())}function x(e){var t,r,n,i=this.hot.getSelectedRangeLast();return!i||(i=i.highlight,!(i.isHeader()&&0<=i.col))||(t=this.hot.view.getFirstFullyVisibleColumn(),r=this.hot.view.getLastFullyVisibleColumn(),n=m(b,this).findLeftMostColumnIndex(i.row,i.col),i=m(b,this).findRightMostColumnIndex(i.row,i.col),n<t&&r<i)?e:n<t?n:i}function R(e,t,r){var n=m(b,this).getHeaderTreeNodeData(t,e);if(n){var{columnCursor:r,selectionType:i,selectionWidth:o}=r,{isRoot:t,colspan:s}=m(b,this).getHeaderSettings(t,e);if(i===a.HEADER_TYPE){if(!t)return n.columnIndex}else if(i===a.ACTIVE_HEADER_TYPE&&(o-r<s||!t))return null}return e}function A(r,t,e){e=e.columnHeadersCount;if(0!==e)for(let e=0;e<t.length;e++){var{startRow:n,startCol:i,endRow:o,endCol:s}=t[e],a=o-n+1;if(0<=n||1==i-s+1)break;for(let t=i;t<=s;t++)for(let e=n;e<=o;e++){var l,c=a+e,u=t-i;0!=u&&!1===(null==(l=m(b,this).getHeaderTreeNodeData(e,t))?void 0:l.isRoot)&&(r[c][u]="")}}}function N(e,t,r,n){this._getHeaderTreeNodeDataByCoords(t)&&(n.column=!0)}function O(e,t){var r,n,i,o,s,a=this._getHeaderTreeNodeDataByCoords(t);a&&(g(C,this,t.clone()),g(E,this,!0),r=this.hot["selection"],n=r.isSelected()?r.getSelectedRange().current():null,i=[],{columnIndex:a,origColspan:o}=a,s=!r.inInSelection(t),e.shiftKey&&n?t.col<n.from.col?i.push(n.getTopEndCorner().col,a,t.row):t.col>n.from.col?i.push(n.getTopStartCorner().col,a+o-1,t.row):i.push(a,a+o-1,t.row):((0,l.isLeftClick)(e)||(0,l.isRightClick)(e)&&s||(0,l.isTouchEvent)(e))&&i.push(a,a+o-1,t.row),r.selectColumns(...i))}function I(e,t,r,n){var i,o,s,a,l,c;this.hot.view.isMouseDown()&&(i=this._getHeaderTreeNodeDataByCoords(t))&&({columnIndex:i,origColspan:o}=i,s=(l=this.hot.getSelectedRangeLast()).getTopStartCorner(),a=l.getBottomEndCorner(),l=l["from"],n.column=!0,n.cell=!0,n=[],c=(0,u.clamp)(t.row,-1/0,-1),t.col<l.col?n.push(a.col,i,c):t.col>l.col?n.push(s.col,i+o-1,c):n.push(i,i+o-1,c),this.hot.selection.selectColumns(...n))}function M(){g(E,this,!1)}function k(){var e,t,r,n,i=this.hot.getSettings()["navigableHeaders"];this.hot.view.isMouseDown()&&m(E,this)&&i&&(n=(i=this.hot.getSelectedRangeLast()).getTopStartCorner().col,e=i.getBottomEndCorner().col,{columnIndex:t,origColspan:r}=m(b,this).getHeaderTreeNodeData(m(C,this).row,m(C,this).col),i.setHighlight(m(C,this)),r>i.getWidth()||t<n||e<t+r-1)&&(n=m(b,this).findTopMostEntireHeaderLevel((0,u.clamp)(n,t,t+r-1),(0,u.clamp)(e,t,t+r-1)),i.highlight.row=n,i.highlight.col=i.from.col)}function D(e){var t,r,n=this.hot.getSelectedRangeLast()["highlight"],i=this.hot._createCellCoords(n.row+e.row,n.col+e.col);i.isHeader()&&0<=i.col&&(t=m(b,this).findLeftMostColumnIndex(i.row,i.col),i=m(b,this).findRightMostColumnIndex(i.row,i.col),e.col<0?(r=n.col>=t&&n.col<=i?t-1:i,r=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r,-1),e.col=null===r?-this.hot.view.countRenderableColumnsInRange(0,n.col):-Math.max(this.hot.view.countRenderableColumnsInRange(r,n.col)-1,1)):0<e.col&&(r=n.col>=t&&n.col<=i?i+1:t,i=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r,1),e.col=null===i?this.hot.view.countRenderableColumnsInRange(n.col,this.hot.countCols()):Math.max(this.hot.view.countRenderableColumnsInRange(n.col,i)-1,1)))}function P(e,t){var r=e.row,n=this._getHeaderTreeNodeDataByCoords({row:r,col:e.col}),r=this._getHeaderTreeNodeDataByCoords({row:r,col:t.col});t.col<e.col?(n&&(e.col=n.columnIndex+n.origColspan-1),r&&(t.col=r.columnIndex)):t.col>=e.col&&(n&&(e.col=n.columnIndex),r)&&(t.col=r.columnIndex+r.origColspan-1)}function F(t){for(let e=t.length=0;e<m(b,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}function H(t){var r=m(b,this).getLayersCount();let n=t.startColumn,i=!!r;for(let e=0;e<r;e++){var o=m(b,this).findLeftMostColumnIndex(e,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(0<=o&&(i=!1),(0,u.isNumeric)(s)&&s<t.startColumn){n=s;break}}t.startColumn=i?m(b,this).getHeaderTreeNodeData(0,n).columnIndex:n}function U(e,t){t=this.ghostTable.getWidth(t);return t<e?e:t}function V(e,t,r){t=(null!=(r=m(b,this).getHeaderTreeNodeData(r,t))?r:{label:""}).label;return t}function W(e,t){if(e<0)return this.hot.getCell(e,m(b,this).findLeftMostColumnIndex(e,t),!0)}function $(){this.updatePlugin()}function B(e,t){t||this.updatePlugin()}e.NestedHeaders=S},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),r(286),r(478)),o=n(r(1030)),s=n(r(1033)),a=r(1035),l=r(1041),c=r(1034);function u(e,t,r){var n=e;if(t.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object");t.set(e,r)}function d(e,t,r){e.set(p(e,t),r)}function h(e,t){return e.get(p(e,t))}function p(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var f=new WeakMap,g=new WeakMap,m=new WeakMap;t.default=class{constructor(){u(this,f,new o.default),u(this,g,new s.default(h(f,this))),u(this,m,[[]])}setState(e){h(f,this).setData(e);let t=!1;try{h(g,this).buildTree()}catch(e){h(g,this).clear(),h(f,this).clear(),t=!0}return d(m,this,(0,l.generateMatrix)(h(g,this).getRoots())),t}setColumnsLimit(e){h(f,this).setColumnsLimit(e)}mergeStateWith(e){e=(0,i.arrayMap)(e,e=>{let{row:t,...r}=e;return{row:t<0?this.rowCoordsToLevel(t):t,...r}});h(f,this).mergeWith(e),h(g,this).buildTree(),d(m,this,(0,l.generateMatrix)(h(g,this).getRoots()))}mapState(e){h(f,this).map(e),h(g,this).buildTree(),d(m,this,(0,l.generateMatrix)(h(g,this).getRoots()))}mapNodes(r){return(0,i.arrayReduce)(h(g,this).getRoots(),(t,e)=>(e.walkDown(e=>{e=r(e.data);void 0!==e&&t.push(e)}),t),[])}triggerNodeModification(e,t,r){t<0&&(t=this.rowCoordsToLevel(t));t=h(g,this).getNode(t,r);let n;return t&&(n=(0,a.triggerNodeModification)(e,t,r),d(m,this,(0,l.generateMatrix)(h(g,this).getRoots()))),n}triggerColumnModification(e,t){return this.triggerNodeModification(e,-1,t)}rowCoordsToLevel(e){return 0<=e||(e=e+Math.max(this.getLayersCount(),1))<0?null:e}levelToRowCoords(e){return e<0||0<=(e=e-Math.max(this.getLayersCount(),1))?null:e}getHeaderSettings(e,t){return!(null===(e=e<0?this.rowCoordsToLevel(e):e)||e>=this.getLayersCount())&&null!=(e=null==(e=h(m,this)[e])?void 0:e[t])?e:null}getHeaderTreeNodeData(e,t){e=this.getHeaderTreeNode(e,t);return e?{...e.data}:null}getHeaderTreeNode(e,t){return!(null===(e=e<0?this.rowCoordsToLevel(e):e)||e>=this.getLayersCount())&&h(g,this).getNode(e,t)||null}findTopMostEntireHeaderLevel(i){var e;let o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:i;const s=o-i+1;let t=!1,a=null;for(let e=i;e<=o;e++){var r=h(g,this).getRootByColumn(e);if(!r)break;t=!0,r.walkDown(e=>{var{columnIndex:e,headerLevel:t,origColspan:r,isHidden:n}=e.data;n||r<=s&&i<=e&&e+r-1<=o&&(null===a||t<a)&&(a=t)},c.TRAVERSAL_DF_PRE)}return t&&null===a?-1:this.levelToRowCoords(null!=(e=a)?e:0)}findLeftMostColumnIndex(e,t){var r=(null!=(r=this.getHeaderSettings(e,t))?r:{isRoot:!0})["isRoot"];if(r)return t;let n=t-1;for(;0<=n;){var i=(null!=(i=this.getHeaderSettings(e,n))?i:{isRoot:!0})["isRoot"];if(i)break;--n}return n}findRightMostColumnIndex(e,t){var{isRoot:r,origColspan:n}=null!=(r=this.getHeaderSettings(e,t))?r:{isRoot:!0,origColspan:1};if(r)return t+n-1;let i=t+1;for(;i<this.getColumnsCount();){var o=(null!=(o=this.getHeaderSettings(e,i))?o:{isRoot:!0})["isRoot"];if(o)break;i+=1}return i-1}getLayersCount(){return h(f,this).getLayersCount()}getColumnsCount(){return h(f,this).getColumnsCount()}clear(){d(m,this,[]),h(f,this).clear(),h(g,this).clear()}}},(e,t,r)=>{"use strict";t.__esModule=!0,r(204),r(286);var i=r(482),n=r(478),o=r(1031);function s(e,t,r){var n=e;if(t.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object");t.set(e,r)}function a(e,t){return e.get(c(e,t))}function l(e,t,r){e.set(c(e,t),r)}function c(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}const u=t.HEADER_CONFIGURABLE_PROPS=["label","collapsible"];var d=new WeakMap,h=new WeakMap,p=new WeakMap;t.default=class{constructor(){s(this,d,[]),s(this,h,0),s(this,p,1/0)}setColumnsLimit(e){l(p,this,e)}setData(){l(d,this,(0,o.normalizeSettings)(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],a(p,this))),l(h,this,a(d,this).length)}getData(){return a(d,this)}mergeWith(e){(0,n.arrayEach)(e,e=>{let{row:t,col:r,...n}=e;e=this.getHeaderSettings(t,r);null!==e&&(0,i.extend)(e,n,u)})}map(r){(0,n.arrayEach)(a(d,this),e=>{(0,n.arrayEach)(e,e=>{var t=r({...e});(0,i.isObject)(t)&&(0,i.extend)(e,t,u)})})}getHeaderSettings(e,t){return!(e>=a(h,this)||e<0||(e=a(d,this)[e],!1===Array.isArray(e))||t>=e.length||null==(e=e[t]))?e:null}getHeadersSettings(e,r){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,i=[];if(!(e>=a(h,this)||e<0)){var o=a(d,this)[e];let t=0;for(let e=r;e<o.length;e++){var s=o[e];if(s.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(t+=s.colspan,i.push(s),1<s.colspan&&(e+=s.colspan-1),t===n)break;if(t>n)throw new Error("The last column settings cannot overlap the other header layers")}}return i}getLayersCount(){return a(h,this)}getColumnsCount(){return 0<a(h,this)?a(d,this)[0].length:0}clear(){l(d,this,[]),l(h,this,0)}}},(e,t,r)=>{"use strict";t.__esModule=!0,t.normalizeSettings=function(e){let l=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1/0;const t=[];if(0!==l){(0,n.arrayEach)(e,e=>{const s=[];let a=0;t.push(s),(0,n.arrayEach)(e,e=>{var t,r,n,i=(0,d.createDefaultHeaderSettings)();(0,c.isObject)(e)?({label:t,colspan:r,headerClassName:n}=e,i.label=(0,u.stringify)(t),"number"==typeof r&&1<r&&(i.colspan=r,i.origColspan=r),"string"==typeof n&&(i.headerClassNames=[...n.split(" ")])):i.label=(0,u.stringify)(e);let o=!1;if((a+=i.origColspan)>=l&&(i.colspan=i.origColspan-(a-l),i.origColspan=i.colspan,o=!0),s.push(i),1<i.colspan)for(let e=0;e<i.colspan-1;e++)s.push((0,d.createPlaceholderHeaderSettings)());return!o})});const r=Math.max(...(0,n.arrayMap)(t,e=>e.length));(0,n.arrayEach)(t,e=>{var t;e.length<r&&(t=(0,n.arrayMap)(new Array(r-e.length),()=>(0,d.createDefaultHeaderSettings)()),e.splice(e.length,0,...t))})}return t},r(286);var n=r(478),c=r(482),u=r(337),d=r(1032)},(e,t)=>{"use strict";t.__esModule=!0,t.createDefaultHeaderSettings=function(){var{label:e="",colspan:t=1,origColspan:r=1,collapsible:n=!1,crossHiddenColumns:i=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:c=[]}=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return{label:e,colspan:t,origColspan:r,collapsible:n,isCollapsed:o,crossHiddenColumns:i,isHidden:s,isRoot:a,isPlaceholder:l,headerClassNames:c}},t.createPlaceholderHeaderSettings=function(){return{label:"",isPlaceholder:!0}}},(e,t,r)=>{"use strict";var n=r(197),s=(t.__esModule=!0,r(204),r(478)),a=n(r(1034));function i(e,t,r){var n=e;if(t.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object");t.set(e,r)}function l(e,t){return e.get(o(e,t))}function o(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var c=new WeakMap,u=new WeakMap,d=new WeakMap;t.default=class{constructor(e){var t;i(this,c,new Map),i(this,u,new Map),i(this,d,null),t=this,e=e,d.set(o(d,t),e)}getRoots(){return Array.from(l(c,this).values())}getRootByColumn(e){let t;return t=l(u,this).has(e)?l(c,this).get(l(u,this).get(e)):t}getNode(o,s){var e=this.getRootByColumn(s);if(e){const a=s-l(u,this).get(s);let n=0,i;return e.walkDown(e=>{var{origColspan:t,headerLevel:r}=e["data"];if(o===r){if(a>=n&&a<=n+t-1)return(i=e).data.isRoot=s===i.data.columnIndex,!1;n+=t}}),i}}rebuildTreeIndex(){let r=0;l(u,this).clear(),(0,s.arrayEach)(l(c,this),e=>{var[,{data:{colspan:t}}]=e;for(let e=r;e<r+t;e++)l(u,this).set(e,r);r+=t})}buildTree(){this.clear();var e=l(d,this).getColumnsCount();let t=0;for(;t<e;){var r=l(d,this).getHeaderSettings(0,t),n=new a.default;l(c,this).set(t,n),this.buildLeaves(n,t,0,r.origColspan),t+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(n,i,o){var e=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,e=l(d,this).getHeadersSettings(o,i,e);o+=1,(0,s.arrayEach)(e,e=>{var t={...e,headerLevel:o-1,columnIndex:i};let r;1===o?(n.data=t,r=n):(r=new a.default(t),n.addChild(r)),o<l(d,this).getLayersCount()&&this.buildLeaves(r,i,o,e.origColspan),i+=e.origColspan})}clear(){l(c,this).clear(),l(u,this).clear()}}},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,t.depthFirstPreOrder=o,n(r(487)));r(204),r(286),t.TRAVERSAL_DF_PRE="DF-pre-order";function o(t,r){let n=t.call(r,this);for(let e=0;e<this.childs.length;e++){if(!1===n)return!1;n=o.call(this.childs[e],t,r)}return n}t.TRAVERSAL_DF_POST="DF-post-order";function s(t,r){for(let e=0;e<this.childs.length;e++)if(!1===s.call(this.childs[e],t,r))return!1;return t.call(r,this)}t.TRAVERSAL_BF="BF";const a=new Map([["DF-pre-order",o],["DF-post-order",s],["BF",function(r,n){const i=[this];!function e(){var t;0!==i.length&&(t=i.shift(),i.push(...t.childs),!1!==r.call(n,t))&&e()}()}]]);t.default=class l{constructor(e){(0,i.default)(this,"data",{}),(0,i.default)(this,"parent",null),(0,i.default)(this,"childs",[]),this.data=e}addChild(e){(e.parent=this).childs.push(e)}cloneTree(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this,r=new l({...t.data});for(let e=0;e<t.childs.length;e++)r.addChild(this.cloneTree(t.childs[e]));return r}replaceTreeWith(t){this.data={...t.data},this.childs=[];for(let e=0;e<t.childs.length;e++)this.addChild(t.childs[e])}walkDown(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"BF";if(!a.has(t))throw new Error(`Traversal strategy "${t}" does not exist`);a.get(t).call(this,e,this)}walkUp(t){const r=this,n=e=>{!1!==t.call(r,e)&&null!==e.parent&&n(e.parent)};n(this)}}},(e,t,r)=>{"use strict";t.__esModule=!0,t.triggerNodeModification=function(e,t,r){if(o.has(e))return o.get(e)(t,r);throw new Error(`The node modifier action ("${e}") does not exist.`)},r(204);var t=r(1036),n=r(1037),i=r(1039),r=r(1040);const o=new Map([["collapse",t.collapseNode],["expand",n.expandNode],["hide-column",i.hideColumn],["show-column",r.showColumn]])},(e,t,r)=>{"use strict";t.__esModule=!0,t.collapseNode=function e(t){var r;const{data:n,childs:i}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};const o=(0,f.isNodeReflectsFirstChildColspan)(t);if(o)return e(i[0]);n.isCollapsed=!0;const s=i.slice(1);const a=new Set;if(0<s.length)(0,h.arrayEach)(s,e=>{(0,f.traverseHiddenNodeColumnIndexes)(e,e=>{a.add(e)}),e.data.clonedTree=e.cloneTree(),e.walkDown(e=>{let t=e["data"];t.isHidden=!0})});else{const{origColspan:c,columnIndex:u}=n;for(let e=1;e<c;e++){const d=u+e;a.add(d)}}const l=n.colspan-(null!=(r=(0,f.getFirstChildProperty)(t,"colspan"))?r:1);t.walkUp(e=>{const t=e["data"];t.colspan-=l,t.colspan<=1?(t.colspan=1,t.isCollapsed=!0):(0,f.isNodeReflectsFirstChildColspan)(e)&&(t.isCollapsed=(0,f.getFirstChildProperty)(e,"isCollapsed"))});return{rollbackModification:()=>(0,p.expandNode)(t),affectedColumns:Array.from(a),colspanCompensation:l}},r(290),r(302),r(305),r(309),r(312),r(315),r(318);var h=r(478),p=r(1037),f=r(1038)},(e,t,r)=>{"use strict";t.__esModule=!0,t.expandNode=function e(t){const{data:r,childs:n}=t;if(!r.isCollapsed||r.isHidden||r.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};const i=(0,p.isNodeReflectsFirstChildColspan)(t);if(i)return e(n[0]);r.isCollapsed=!1;const o=n.slice(1);const s=new Set;let a=0;if(0<o.length)(0,d.arrayEach)(o,e=>{e.replaceTreeWith(e.data.clonedTree),e.data.clonedTree=null;const t=e.data;a+=t.colspan,(0,p.traverseHiddenNodeColumnIndexes)(e,e=>{s.add(e)})});else{const{colspan:l,origColspan:c,columnIndex:u}=r;a=c-l;for(let e=1;e<c;e++)s.add(u+e)}t.walkUp(e=>{const t=e["data"];t.colspan+=a,t.colspan>=t.origColspan?(t.colspan=t.origColspan,t.isCollapsed=!1):(0,p.isNodeReflectsFirstChildColspan)(e)&&(t.isCollapsed=(0,p.getFirstChildProperty)(e,"isCollapsed"))});return{rollbackModification:()=>(0,h.collapseNode)(t),affectedColumns:Array.from(s),colspanCompensation:a}},r(290),r(302),r(305),r(309),r(312),r(315),r(318);var d=r(478),h=r(1036),p=r(1038)},(e,t)=>{"use strict";function r(e,t){e=e.childs;if(0!==e.length)return e[0].data[t]}t.__esModule=!0,t.getFirstChildProperty=r,t.isNodeReflectsFirstChildColspan=function(e){return r(e,"origColspan")===e.data.origColspan},t.traverseHiddenNodeColumnIndexes=function(e,r){e.walkDown(e=>{var{data:t,childs:e}=e;if(!t.isHidden&&(r(t.columnIndex),0===e.length))for(let e=1;e<t.colspan;e++)r(t.columnIndex+e)})}},(e,t,r)=>{"use strict";t.__esModule=!0,t.hideColumn=function(e,r){if(!Number.isInteger(r))throw new Error("The passed gridColumnIndex argument has invalid type.");if(0<e.childs.length)throw new Error((0,n.toSingleLine)`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);var t=e.data["crossHiddenColumns"];if(!t.includes(r)){let t=!1;e.walkUp(e=>{var e=e["data"]["collapsible"];if(e)return!(t=!0)}),t||e.walkUp(e=>{e=e.data;e.crossHiddenColumns.push(r),1<e.colspan?--e.colspan:e.isHidden=!0})}},r(204),r(286);var n=r(477)},(e,t,r)=>{"use strict";t.__esModule=!0,t.showColumn=function(e,r){if(!Number.isInteger(r))throw new Error("The passed gridColumnIndex argument has invalid type.");if(0<e.childs.length)throw new Error((0,n.toSingleLine)`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);var t=e.data["crossHiddenColumns"];if(t.includes(r)){let t=!1;e.walkUp(e=>{var e=e["data"]["collapsible"];if(e)return!(t=!0)}),t||e.walkUp(e=>{e=e.data;e.crossHiddenColumns.splice(e.crossHiddenColumns.indexOf(r),1),!e.isHidden&&e.colspan<e.origColspan&&(e.colspan+=1),e.isHidden=!1})}},r(204);var n=r(477)},(e,t,r)=>{"use strict";t.__esModule=!0,t.generateMatrix=function(e){const l=[];return(0,n.arrayEach)(e,e=>{e.walkDown(e=>{var t,r=e.data,{origColspan:n,columnIndex:i,headerLevel:e,crossHiddenColumns:o}=r,s=function(e,t){let r;Array.isArray(e[t])?r=e[t]:(r=[],e[t]=r);return r}(l,e);let a=!1;for(let e=i;e<i+n;e++)o.includes(e)||a?s.push((0,c.createPlaceholderHeaderSettings)(r)):((t=function(e){const{crossHiddenColumns:t,...r}=(0,c.createDefaultHeaderSettings)(e);return r}(r)).isRoot=!0,s.push(t),a=!0)})}),l},r(286);var n=r(478),c=r(1032)},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(487))),d=r(334);t.default=class{constructor(e,t){(0,i.default)(this,"hot",void 0),(0,i.default)(this,"nestedHeaderSettingsGetter",void 0),(0,i.default)(this,"layersCount",0),(0,i.default)(this,"container",void 0),(0,i.default)(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=t,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);var t=this.container.querySelectorAll("tr:last-of-type th"),r=t.length;this.widthsMap.clear();for(let e=0;e<r;e++){var n=this.hot.columnIndexMapper.getVisualFromRenderableIndex(e),n=this.hot.toPhysicalColumn(n);this.widthsMap.setValueAtIndex(n,t[e].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){var{rootDocument:n,columnIndexMapper:i}=this.hot,t=n.createDocumentFragment(),o=n.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=i.getRenderableIndexesLength();for(let r=0;r<this.layersCount;r++){var l=n.createElement("tr");for(let t=0;t<a;t++){let e=i.getVisualFromRenderableIndex(t);null===e&&(e=t);var c=n.createElement("th"),u=this.nestedHeaderSettingsGetter(r,e);if(u&&(!u.isPlaceholder||u.isHidden)){let e=u.label;s&&(e+='<button class="changeType"></button>'),(0,d.fastInnerHTML)(c,e),c.colSpan=u.colspan,l.appendChild(c)}}o.appendChild(l)}t.appendChild(o),e.appendChild(t)}clear(){this.widthsMap.clear(),this.container=null}}},(e,t,r)=>{"use strict";r.r(t)},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(1045);t.PLUGIN_KEY=r.PLUGIN_KEY,t.PLUGIN_PRIORITY=r.PLUGIN_PRIORITY,t.NestedRows=r.NestedRows},(L,e,t)=>{"use strict";var r=t(197),n=(e.__esModule=!0,t(204),t(286),t(290),t(302),t(305),t(309),t(312),t(315),t(318),r(t(487))),i=t(813),o=r(t(1046)),s=r(t(1047)),a=r(t(1049)),l=r(t(1050)),c=t(500),u=t(596),d=t(597),h=t(656),p=r(t(1051));function f(e,t,r){g(e,t),t.set(e,r)}function g(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function m(e,t){return e.get(v(e,t))}function y(e,t,r){e.set(v(e,t),r)}function v(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}t(1052);const b=e.PLUGIN_KEY="nestedRows",w=(e.PLUGIN_PRIORITY=300,b);var C=new WeakMap,E=new WeakMap,T=new WeakSet;class S extends i.BasePlugin{constructor(){var e,t;super(...arguments),g(e=this,t=T),t.add(e),(0,n.default)(this,"dataManager",null),(0,n.default)(this,"headersUI",null),(0,n.default)(this,"collapsedRowsMap",null),f(this,C,!1),f(this,E,!1)}static get PLUGIN_KEY(){return b}static get PLUGIN_PRIORITY(){return 300}isEnabled(){return!!this.hot.getSettings()[b]}enablePlugin(){var n=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new d.TrimmingMap),this.dataManager=new o.default(this,this.hot),this.collapsingUI=new s.default(this,this.hot),this.headersUI=new a.default(this,this.hot),this.contextMenuUI=new l.default(this,this.hot),this.rowMoveController=new p.default(this),this.addHook("afterInit",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return v(T,n,V).call(n,...t)}),this.addHook("beforeViewRender",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return v(T,n,W).call(n,...t)}),this.addHook("modifyRowData",function(){return n.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return n.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return n.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return v(T,n,R).call(n,...t)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return v(T,n,A).call(n,...t)}),this.addHook("afterGetRowHeader",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return v(T,n,N).call(n,...t)}),this.addHook("beforeOnCellMouseDown",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return v(T,n,x).call(n,...t)}),this.addHook("beforeRemoveRow",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return v(T,n,M).call(n,...t)}),this.addHook("afterRemoveRow",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return v(T,n,I).call(n,...t)}),this.addHook("beforeAddChild",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return v(T,n,k).call(n,...t)}),this.addHook("afterAddChild",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return v(T,n,D).call(n,...t)}),this.addHook("beforeDetachChild",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return v(T,n,F).call(n,...t)}),this.addHook("afterDetachChild",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return v(T,n,H).call(n,...t)}),this.addHook("modifyRowHeaderWidth",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return v(T,n,O).call(n,...t)}),this.addHook("afterCreateRow",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return v(T,n,U).call(n,...t)}),this.addHook("beforeRowMove",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return v(T,n,_).call(n,...t)}),this.addHook("beforeLoadData",e=>v(T,this,P).call(this,e)),this.addHook("beforeUpdateData",e=>v(T,this,P).call(this,e)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();var e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e=this.hot.getSelectedRangeLast()["highlight"],e=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(e)?this.collapsingUI.expandChildren(e):this.collapsingUI.collapseChildren(e),!1},runOnlyIf:()=>{var e,t=null==(t=this.hot.getSelectedRangeLast())?void 0:t.highlight;return t&&(null==(e=this.hot.getSelectedRangeLast())?void 0:e.isSingle())&&this.hot.selection.isCellVisible(t)&&-1===t.col&&0<=t.row},group:w,relativeToGroup:h.EDITOR_EDIT_GROUP,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(w)}disableCoreAPIModifiers(){y(E,this,!0)}enableCoreAPIModifiers(){y(E,this,!1)}onModifyRowData(e){if(!m(E,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!m(E,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,t,r){return!(!m(E,this)&&!this.dataManager.isRowHighestLevel(e)&&(this.dataManager.spliceData(e,t,r),1))}destroy(){super.destroy()}}function _(e,t,r,n){return this.rowMoveController.onBeforeRowMove(e,t,r,n)}function x(e,t,r){this.collapsingUI.toggleState(e,t,r)}function R(e,t,r){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(r[0],t),this.collapsingUI.collapsedRowsStash.shiftStash(r[0],null,-1*t),this.dataManager.filterData(e,t,r),y(C,this,!0),this.dataManager.getData().slice()}function A(e){return this.contextMenuUI.appendOptions(e)}function N(e,t){this.headersUI.appendLevelIndicators(e,t)}function O(e){return Math.max(this.headersUI.rowHeaderWidthCache,e)}function I(e,t,r,n){n!==this.pluginName&&this.hot._registerTimeout(()=>{y(C,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function M(e,t,r){var n=Array.from(r.reduce((t,e)=>{var r;return this.dataManager.isParent(e)?(r=this.dataManager.getDataObject(e).__children,t.add(e),Array.isArray(r)&&r.forEach(e=>t.add(this.dataManager.getRowIndex(e))),t):t.add(e)},new Set));r.length=0,r.push(...n)}function k(){this.collapsingUI.collapsedRowsStash.stash()}function D(e,t){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(t)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function F(){this.collapsingUI.collapsedRowsStash.stash()}function H(e,t,r){this.collapsingUI.collapsedRowsStash.shiftStash(r,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function U(){this.dataManager.rewriteCache()}function V(){this.headersUI.updateRowHeaderWidth()}function W(e,t){m(C,this)&&(t.skipRender=!0)}function P(e){(0,u.isArrayOfObjects)(e)?(this.dataManager.setData(e),this.dataManager.rewriteCache()):((0,c.error)("The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled."),this.hot.getSettings()[b]=!1,this.disablePlugin())}e.NestedRows=S},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(286),n(r(487))),d=r(512),o=r(482),s=r(478);t.default=class{constructor(e,t){(0,i.default)(this,"hot",void 0),(0,i.default)(this,"data",null),(0,i.default)(this,"plugin",void 0),(0,i.default)(this,"parentReference",new WeakMap),(0,i.default)(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=t,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){var e;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},(0,d.rangeEach)(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(t,r,e){this.cache.levels[r]||(this.cache.levels[r]=[],this.cache.levelCount+=1),this.cache.levels[r].push(t),this.cache.rows.push(t),this.cache.nodeInfo.set(t,{parent:e,row:this.cache.rows.length-1,level:r}),this.hasChildren(t)&&(0,s.arrayEach)(t.__children,e=>{this.cacheNode(e,r+1,t)})}getDataObject(e){return null==e?null:this.cache.rows[e]}readTreeNodes(e,t,r,n){let i=!1,o=t;if(!isNaN(o)||!o.end){let t=e;if(t||(t={__children:this.data},i=!0,--o),null!=r&&o===r)return{result:t,end:!0};if(null!=n&&t===n)return{result:o,end:!0};o+=1,t.__children&&(0,s.arrayEach)(t.__children,e=>{if(this.parentReference.set(e,i?null:t),o=this.readTreeNodes(e,o,r,n),isNaN(o)&&o.end)return!1})}return o}mockParent(){var e=this.mockNode();return e.__children=this.data,e}mockNode(){const r={};return(0,o.objectEach)(this.data[0],(e,t)=>{r[t]=null}),r}getRowIndex(e){return null==e?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let t=null;t=isNaN(e)?e:this.getDataObject(e);e=this.getRowParent(e);return(null==e?this.data:e.__children).indexOf(t)}countAllRows(){var e={__children:this.data};return this.countChildren(e)}countChildren(e){let t=0,r=e;return(r=isNaN(r)?r:this.getDataObject(r))&&r.__children?((0,s.arrayEach)(r.__children,e=>{t+=1,e.__children&&(t+=this.countChildren(e))}),t):0}getRowParent(e){let t;return t=isNaN(e)?e:this.getDataObject(e),this.getRowObjectParent(t)}getRowObjectParent(e){return e&&"object"==typeof e?this.cache.nodeInfo.get(e).parent:null}getRowLevel(e){let t=null;return(t=isNaN(e)?e:this.getDataObject(e))?this.getRowObjectLevel(t):null}getRowObjectLevel(e){return null==e?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let t=e;return!(!(t=isNaN(t)?t:this.getDataObject(t)).__children||!t.__children.length)}isChild(e){return null!==this.getRowParent(e)}getChild(e,t){return(null==(e=e.__children)?void 0:e[t])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){let t=e;return(t=isNaN(t)?t:this.getDataObject(t))&&!!t.__children&&0!==(null==(e=t.__children)?void 0:e.length)}addChild(e,t){let r=t,n=(this.hot.runHooks("beforeAddChild",e,r),null),i=(e&&(n=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",n+this.countChildren(e)+1,1),e);(i=e?i:this.mockParent()).__children||(i.__children=[]),r=r||this.mockNode(),i.__children.push(r),this.rewriteCache();t=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(t,1),this.hot.runHooks("afterCreateRow",t,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,t,r){let n=r,i;n=n||this.mockNode(),this.hot.runHooks("beforeAddChild",e,n,t),i=e?(r=this.getRowIndex(e)+t+1,this.hot.runHooks("beforeCreateRow",r,1),e.__children.splice(t,null,n),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(r,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",r,1),r):(this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",t,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),this.getRowIndex(this.data[t])),n=this.getDataObject(i),this.hot.runHooks("afterAddChild",e,n,t)}addSibling(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"below",e=this.translateTrimmedRow(e),r=this.getRowParent(e),n=this.getRowIndexWithinParent(e);switch(t){case"below":this.addChildAtIndex(r,n+1,null);break;case"above":this.addChildAtIndex(r,n,null)}}detachFromParent(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];let r=null;const n=[];r=Array.isArray(e)?((0,d.rangeEach)(e[0],e[2],e=>{e=this.translateTrimmedRow(e);n.push(this.getDataObject(e))}),(0,d.rangeEach)(0,n.length-2,e=>{this.detachFromParent(n[e],!1)}),n[n.length-1]):e;var i,e=this.getRowIndex(r),o=this.countChildren(r),s=this.getRowIndexWithinParent(r),a=this.getRowParent(r),l=this.getRowParent(a),c=this.getRowIndex(l);let u=null;this.hot.runHooks("beforeDetachChild",a,r),null!=s&&(i=Array.from(new Array(e+o+1).keys()).splice(-1*(o+1)),this.hot.runHooks("beforeRemoveRow",e,o+1,i,this.plugin.pluginName),a.__children.splice(s,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",e,o+1,i,this.plugin.pluginName),(l?(u=c+this.countChildren(l),s=this.getChild(l,this.countChildren(l)-1),e=this.getRowIndex(s),this.hot.runHooks("beforeCreateRow",e+1,o+1,this.plugin.pluginName),l.__children):(u=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",u-2,o+1,this.plugin.pluginName),this.data)).push(r)),this.rewriteCache(),this.hot.runHooks("afterCreateRow",u-2,o+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",a,r,this.getRowIndex(r)),t&&this.hot.render()}filterData(e,t,r){const n=[];(0,s.arrayEach)(r,e=>{n.push(this.getDataObject(e))}),(0,s.arrayEach)(n,e=>{var t=this.getRowIndexWithinParent(e),e=this.getRowParent(e);(null===e?this.data:e.__children).splice(t,1)}),this.rewriteCache()}spliceData(e,t,r){var n=this.getDataObject(e-1);let i=null,o=e;n&&n.__children&&0===n.__children.length?(i=n,o=0):e<this.countAllRows()&&(i=this.getRowParent(e),o=this.getRowIndexWithinParent(e)),i?r?i.__children.splice(o,t,...r):i.__children.splice(o,t):r?this.data.splice(o,t,...r):this.data.splice(o,t),this.rewriteCache()}syncRowWithRawSource(e){let t=e,r=null;for(;null!==(r=this.getRowParent(r))&&(t=r),null!==r;);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(t),"__children",t.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,t,r,n){var i=t===this.hot.countRows(),o=this.getRowParent(e),s=this.getRowIndexWithinParent(e),a=o.__children.slice(s,s+1),e=t<e;let l=i?this.getRowParent(t-1):this.getRowParent(t);(l=null!==(l=null!==l&&void 0!==l?l:this.getRowParent(t-1))&&void 0!==l?l:this.getDataObject(t-1))?l.__children||(l.__children=[]):(l=this.getDataObject(t)).__children=[];i=i||r||n?l.__children.length:this.getRowIndexWithinParent(t),r=o===l;l.__children.splice(i,0,a[0]),o.__children.splice(s+(e&&r?1:0),1),this.syncRowWithRawSource(o),r||this.syncRowWithRawSource(l)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(286),r(492)),s=r(478),a=r(512),o=r(334),l=n(r(1048)),c=n(r(1049));class u extends l.default{constructor(e,t){var o;super(e,t),(o=this).dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];o.lastCollapsedRows=o.collapsedRows.slice(0),o.expandMultipleChildren(o.lastCollapsedRows,e)},shiftStash:function(r,n){let i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;null==n&&(n=1/0),(0,s.arrayEach)(o.lastCollapsedRows,(e,t)=>{r<=e&&e<n&&(o.lastCollapsedRows[t]=e+i)})},applyStash:function(){o.collapseMultipleChildren(o.lastCollapsedRows,!(0<arguments.length&&void 0!==arguments[0])||arguments[0]),o.lastCollapsedRows=void 0},trimStash:(e,t)=>{(0,a.rangeEach)(e,e+t-1,e=>{e=this.lastCollapsedRows.indexOf(e);-1<e&&this.lastCollapsedRows.splice(e,1)})}}}collapseChildren(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],r=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];const n=[];let i=null,o=null;return o=isNaN(e)?(i=e,this.dataManager.getRowIndex(i)):(i=this.dataManager.getDataObject(e),e),this.dataManager.hasChildren(i)&&(0,s.arrayEach)(i.__children,e=>{n.push(this.dataManager.getRowIndex(e))}),e=this.collapseRows(n,!0,!1),r&&this.trimRows(e),t&&this.renderAndAdjust(),-1===this.collapsedRows.indexOf(o)&&this.collapsedRows.push(o),e}collapseMultipleChildren(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],r=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];const n=[];(0,s.arrayEach)(e,e=>{n.push(...this.collapseChildren(e,!1,!1))}),r&&this.trimRows(n),t&&this.renderAndAdjust()}collapseRow(e){this.collapseRows([e],!(1<arguments.length&&void 0!==arguments[1])||arguments[1])}collapseRows(e){let t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];var r=2<arguments.length&&void 0!==arguments[2]&&arguments[2];const n=[];return(0,s.arrayEach)(e,e=>{n.push(e),t&&this.collapseChildRows(e,n)}),r&&this.trimRows(n),n}collapseChildRows(e){let t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];var r=3<arguments.length&&void 0!==arguments[3]&&arguments[3];this.dataManager.hasChildren(e)&&(e=this.dataManager.getDataObject(e),(0,s.arrayEach)(e.__children,e=>{e=this.dataManager.getRowIndex(e);t.push(e),this.collapseChildRows(e,t)})),r&&this.trimRows(t)}expandRow(e){this.expandRows([e],!(1<arguments.length&&void 0!==arguments[1])||arguments[1])}expandRows(e){let t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];var r=2<arguments.length&&void 0!==arguments[2]&&arguments[2];const n=[];return(0,s.arrayEach)(e,e=>{n.push(e),t&&this.expandChildRows(e,n)}),r&&this.untrimRows(n),n}expandChildRows(e){let t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];var r=3<arguments.length&&void 0!==arguments[3]&&arguments[3];this.dataManager.hasChildren(e)&&(e=this.dataManager.getDataObject(e),(0,s.arrayEach)(e.__children,e=>{this.isAnyParentCollapsed(e)||(e=this.dataManager.getRowIndex(e),t.push(e),this.expandChildRows(e,t))})),r&&this.untrimRows(t)}expandChildren(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],r=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];const n=[];let i=null,o=null;return o=isNaN(e)?(i=e,this.dataManager.getRowIndex(e)):(i=this.dataManager.getDataObject(e),e),this.collapsedRows.splice(this.collapsedRows.indexOf(o),1),this.dataManager.hasChildren(i)&&(0,s.arrayEach)(i.__children,e=>{e=this.dataManager.getRowIndex(e);n.push(e)}),e=this.expandRows(n,!0,!1),r&&this.untrimRows(e),t&&this.renderAndAdjust(),e}expandMultipleChildren(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],r=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];const n=[];(0,s.arrayEach)(e,e=>{n.push(...this.expandChildren(e,!1,!1))}),r&&this.untrimRows(n),t&&this.renderAndAdjust()}collapseAll(){var e=this.dataManager.getData();const t=[];(0,s.arrayEach)(e,e=>{this.dataManager.hasChildren(e)&&t.push(e)}),this.collapseMultipleChildren(t),this.renderAndAdjust()}expandAll(){var e=this.dataManager.getData();const t=[];(0,s.arrayEach)(e,e=>{this.dataManager.hasChildren(e)&&t.push(e)}),this.expandMultipleChildren(t),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{(0,s.arrayEach)(e,e=>{this.plugin.collapsedRowsMap.setValueAtIndex(e,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{(0,s.arrayEach)(e,e=>{this.plugin.collapsedRowsMap.setValueAtIndex(e,!1)})},!0)}areChildrenCollapsed(e){let t=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return null===t&&(t={__children:this.dataManager.data}),this.dataManager.hasChildren(t)&&(0,s.arrayEach)(t.__children,e=>{e=this.dataManager.getRowIndex(e);if(!this.plugin.collapsedRowsMap.getValueAtIndex(e))return r=!1}),r}isAnyParentCollapsed(e){let t=e;for(;null!==t;){t=this.dataManager.getRowParent(t);var r=this.dataManager.getRowIndex(t);if(-1<this.collapsedRows.indexOf(r))return!0}return!1}toggleState(e,t){0<=t.col||(t=this.translateTrimmedRow(t.row),(0,o.hasClass)(e.target,c.default.CSS_CLASSES.button)&&(this.areChildrenCollapsed(t)?this.expandChildren(t):this.collapseChildren(t),(0,i.stopImmediatePropagation)(e)))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}t.default=u},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(487)));t.default=class{constructor(e,t){(0,i.default)(this,"hot",void 0),(0,i.default)(this,"plugin",void 0),this.hot=t,this.plugin=e}}},(e,t,r)=>{"use strict";var n=r(197),c=(t.__esModule=!0,r(478)),u=r(512),d=r(334),n=n(r(1048)),h=r(479);class p extends n.default{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,t){super(e,t),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,t){var e=this.hot.toPhysicalRow(e),r=this.dataManager.getRowLevel(e),n=this.dataManager.getDataObject(e);const i=t.getElementsByTagName("DIV")[0];var o=i.querySelector("span.rowHeader"),s=i.querySelectorAll('[class^="ht_nesting"]'),a=this.hot.getSettings().ariaTags;if((0,c.arrayEach)(s,e=>{e&&i.removeChild(e)}),(0,d.addClass)(t,p.CSS_CLASSES.indicatorContainer),r){const l=this.hot["rootDocument"];s=o.cloneNode(!0);(i.innerHTML="",u.rangeEach)(0,r-1,()=>{var e=l.createElement("SPAN");(0,d.addClass)(e,p.CSS_CLASSES.emptyIndicator),i.appendChild(e)}),i.appendChild(s)}this.dataManager.hasChildren(n)&&(o=this.hot.rootDocument.createElement("DIV"),a&&(0,d.setAttribute)(o,[(0,h.A11Y_HIDDEN)()]),(0,d.addClass)(t,p.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(e)?((0,d.addClass)(o,p.CSS_CLASSES.button+" "+p.CSS_CLASSES.expandButton),a&&(0,d.setAttribute)(t,[(0,h.A11Y_EXPANDED)(!1)])):((0,d.addClass)(o,p.CSS_CLASSES.button+" "+p.CSS_CLASSES.collapseButton),a&&(0,d.setAttribute)(t,[(0,h.A11Y_EXPANDED)(!0)])),i.appendChild(o))}updateRowHeaderWidth(e){let t=e;t=t||this.dataManager.cache.levelCount,this.rowHeaderWidthCache=Math.max(50,11+10*t+25),this.hot.render()}}t.default=p},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),n(r(487))),o=r(512),s=r(478),a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=l(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(621)),n=n(r(1048));function l(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(l=function(e){return e?r:t})(e))}function c(e,t,r){var n=e;if(t.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object");t.set(e,r)}function u(e,t){return e.get(function(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}(e,t))}var d=new WeakMap;class h extends n.default{constructor(){super(...arguments),(0,i.default)(this,"dataManager",this.plugin.dataManager),c(this,d,{row_above:(e,t)=>{t=t[t.length-1];this.dataManager.addSibling(t.start.row,"above")},row_below:(e,t)=>{t=t[t.length-1];this.dataManager.addSibling(t.start.row,"below")}})}appendOptions(n){const e=[{key:"add_child",name(){return this.getTranslatedPhrase(a.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD)},callback:()=>{var e=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),e=this.dataManager.getDataObject(e);this.dataManager.addChild(e)},disabled:()=>{var e=this.hot.getSelectedLast();return!e||e[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(a.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{var e=this.hot.getSelectedLast(),t=this.dataManager.translateTrimmedRow(e[0]);return!this.dataManager.getRowParent(t)||!e||e[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return(0,o.rangeEach)(0,n.items.length-1,r=>{if(0===r)return(0,s.arrayEach)(e,(e,t)=>{n.items.splice(r+t,0,e)}),!1}),this.modifyRowInsertingOptions(n)}modifyRowInsertingOptions(r){return(0,o.rangeEach)(0,r.items.length-1,e=>{var t=u(d,this)[r.items[e].key];null!=t&&(r.items[e].callback=t)}),r}}t.default=h},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(286),n(r(487))),o=r(337),s=r(500),a=r(477);t.default=class{constructor(e){(0,i.default)(this,"plugin",void 0),(0,i.default)(this,"hot",void 0),(0,i.default)(this,"dataManager",void 0),(0,i.default)(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,r,n,i){var o=this.displayAPICompatibilityWarning({rows:e,finalIndex:r,dropIndex:n,movePossible:i});if(!o){this.movedToCollapsed=!1;o=n===this.hot.countRows();const l=o?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(n);let t=!0;var s=e.map(e=>{return!!t&&(e=this.dataManager.translateTrimmedRow(e),t=this.shouldAllowMoving(e,l),e)}),a=-1===s.indexOf(l);t&&a&&(o=this.getBaseParent(s)===(a=this.getTargetParent(o,l)),this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(a),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(s,l,o),this.moveRows(s,l,a),this.dataManager.rewriteCache(),this.moveCellsMeta(s,l),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,r,n,i,i&&this.isRowOrderChanged(e,r)),this.hot.render(),this.selectCells(e,n))}return!1}displayAPICompatibilityWarning(e){var{rows:e,finalIndex:t,dropIndex:r,movePossible:n}=e;let i=!1;return(0,o.isUndefined)(r)&&((0,s.warn)((0,a.toSingleLine)`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",e,t,r,n,!1),i=!0),i}shouldAllowMoving(e,t){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===t||0===t)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,t){let r=this.dataManager.getRowParent(e?t-1:t);return r=null!==r&&void 0!==r?r:this.dataManager.getRowParent(t-1)}shiftCollapsibleParentsLocations(e,t,r){r||(Math.max(...e)<=t?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],t,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(t,e[0],e.length))}moveRows(e,t,r){const n=t===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(e=>{this.dataManager.moveRow(e,t,this.movedToCollapsed,n)})})}moveCellsMeta(e,t){const r=[];var n=Math.max(...e)<t;e.forEach(e=>{r.push(this.hot.getCellMetaAtRow(e))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(t-(n?r.length:0),0,...r)}selectCells(t,r){var n=t.length;let i=0,o=0;var e=null;if(this.movedToCollapsed){let e=null;e=t[n-1]<r?this.dataManager.translateTrimmedRow(r-n):this.dataManager.translateTrimmedRow(r);var s=this.dataManager.getRowParent(null===e?this.hot.countSourceRows()-1:e-1),s=this.dataManager.getRowIndex(s);i=this.dataManager.untranslateTrimmedRow(s),o=i}else t[n-1]<r?(o=r-1,i=o-n+1):(i=r,o=i+n-1);e=this.hot.selection,s=this.hot.countCols()-1,e.setRangeStart(this.hot._createCellCoords(i,0)),e.setRangeEnd(this.hot._createCellCoords(o,s),!0)}isRowOrderChanged(e,r){return e.some((e,t)=>e-t!==r)}}},(e,t,r)=>{"use strict";r.r(t)},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(1054);t.PLUGIN_KEY=r.PLUGIN_KEY,t.PLUGIN_PRIORITY=r.PLUGIN_PRIORITY,t.PersistentState=r.PersistentState},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,n(r(487))),o=r(813),s=n(r(1055)),n=n(r(494));n.default.getSingleton().register("persistentStateSave"),n.default.getSingleton().register("persistentStateLoad"),n.default.getSingleton().register("persistentStateReset");const a=t.PLUGIN_KEY="persistentState";t.PLUGIN_PRIORITY=0;class l extends o.BasePlugin{constructor(){super(...arguments),(0,i.default)(this,"storage",void 0)}static get PLUGIN_KEY(){return a}static get PLUGIN_PRIORITY(){return 0}isEnabled(){return!!this.hot.getSettings()[a]}enablePlugin(){this.enabled||(this.storage||(this.storage=new s.default(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,t)=>this.saveValue(e,t)),this.addHook("persistentStateLoad",(e,t)=>this.loadValue(e,t)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,t){t.value=this.storage.loadValue(e)}saveValue(e,t){this.storage.saveValue(e,t)}resetValue(e){void 0===e?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}t.PersistentState=l},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(286),r(483),n(r(487))),o=r(478);t.default=class{constructor(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:window;(0,i.default)(this,"rootWindow",void 0),(0,i.default)(this,"prefix",void 0),(0,i.default)(this,"savedKeys",[]),this.rootWindow=t,this.prefix=e,this.loadSavedKeys()}saveValue(e,t){this.rootWindow.localStorage.setItem(this.prefix+"_"+e,JSON.stringify(t)),-1===this.savedKeys.indexOf(e)&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,t){t=this.rootWindow.localStorage.getItem(this.prefix+"_"+(void 0===e?t:e));return null===t?void 0:JSON.parse(t)}reset(e){this.rootWindow.localStorage.removeItem(this.prefix+"_"+e)}resetAll(){(0,o.arrayEach)(this.savedKeys,(e,t)=>{this.rootWindow.localStorage.removeItem(this.prefix+"_"+this.savedKeys[t])}),this.clearSavedKeys()}loadSavedKeys(){var e=this.rootWindow.localStorage.getItem(this.prefix+"__persistentStateKeys"),e="string"==typeof e?JSON.parse(e):void 0;this.savedKeys=e||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(this.prefix+"__persistentStateKeys",JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(1057);t.PLUGIN_KEY=r.PLUGIN_KEY,t.PLUGIN_PRIORITY=r.PLUGIN_PRIORITY,t.Search=r.Search},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),r(286),n(r(487))),n=r(813),o=r(482),d=r(512),s=r(337);function a(e,t){var r=e;if(t.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object");t.add(e)}function l(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}function c(e,t,r,n,i){e.getCellMeta(t,r).isSearchResult=i}function u(e,t,r){return!((0,s.isUndefined)(e)||null===e||!e.toLocaleLowerCase||0===e.length||(0,s.isUndefined)(t)||null===t||-1===t.toString().toLocaleLowerCase(r.locale).indexOf(e.toLocaleLowerCase(r.locale)))}const h=t.PLUGIN_KEY="search";t.PLUGIN_PRIORITY=190;var p=new WeakSet;class f extends n.BasePlugin{constructor(){super(...arguments),a(this,p),(0,i.default)(this,"callback",c),(0,i.default)(this,"queryMethod",u),(0,i.default)(this,"searchResultClass","htSearchResult")}static get PLUGIN_KEY(){return h}static get PLUGIN_PRIORITY(){return 190}isEnabled(){return this.hot.getSettings()[h]}enablePlugin(){var e,n=this;this.enabled||(e=this.hot.getSettings()[h],this.updatePluginSettings(e),this.addHook("beforeRenderer",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return l(p,n,g).call(n,...t)}),super.enablePlugin())}disablePlugin(){var n=this;function e(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return l(p,n,g).call(n,...t)}this.hot.addHook("beforeRenderer",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",e)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(s){let a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.getCallback(),l=2<arguments.length&&void 0!==arguments[2]?arguments[2]:this.getQueryMethod();var e=this.hot.countRows();const t=this.hot.countCols(),c=[],u=this.hot;return(0,d.rangeEach)(0,e-1,o=>{(0,d.rangeEach)(0,t-1,e=>{var t,r=this.hot.getDataAtCell(o,e),n=this.hot.getCellMeta(o,e),i=n.search.callback||a,n=(n.search.queryMethod||l)(s,r,n);n&&(t={row:o,col:e,data:r},c.push(t)),i&&i(u,o,e,r,n)})}),c}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){(0,o.isObject)(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback)&&this.setCallback(e.callback)}destroy(){super.destroy()}}function g(e,t,r,n,i,o){var s=o.className||[];let a=[];"string"==typeof s?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(""+this.searchResultClass):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}t.Search=f},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(1059);t.PLUGIN_KEY=r.PLUGIN_KEY,t.PLUGIN_PRIORITY=r.PLUGIN_PRIORITY,t.TouchScroll=r.TouchScroll},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),r(286),n(r(487))),o=r(334),s=r(478),n=r(813),a=r(485);function l(e,t){var r=e;if(t.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object");t.add(e)}function c(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}t.PLUGIN_KEY="touchScroll",t.PLUGIN_PRIORITY=200;var u=new WeakSet;class d extends n.BasePlugin{constructor(){super(...arguments),l(this,u),(0,i.default)(this,"scrollbars",[]),(0,i.default)(this,"clones",[]),(0,i.default)(this,"lockedCollection",!1),(0,i.default)(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return"touchScroll"}static get PLUGIN_PRIORITY(){return 200}static get SETTING_KEYS(){return!0}isEnabled(){return(0,a.isTouchSupported)()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>c(u,this,h).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>c(u,this,p).call(this)),this.addHook("afterMomentumScroll",()=>c(u,this,f).call(this))}}function h(){var e,t,r,n,i;this.lockedCollection||({topOverlay:e,bottomOverlay:t,inlineStartOverlay:r,topInlineStartCornerOverlay:n,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays,this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(e),t.clone&&this.scrollbars.push(t),this.scrollbars.push(r),n&&this.scrollbars.push(n),i&&i.clone&&this.scrollbars.push(i),this.clones=[],e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),r.needFullRender&&this.clones.push(r.clone.wtTable.holder.parentNode),n&&this.clones.push(n.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode))}function p(){this.freezeOverlays=!0,(0,s.arrayEach)(this.clones,e=>{(0,o.addClass)(e,"hide-tween")})}function f(){(this.freezeOverlays=!1,s.arrayEach)(this.clones,e=>{(0,o.removeClass)(e,"hide-tween"),(0,o.addClass)(e,"show-tween")}),this.hot._registerTimeout(()=>{(0,s.arrayEach)(this.clones,e=>{(0,o.removeClass)(e,"show-tween")})},400),(0,s.arrayEach)(this.scrollbars,e=>{e.refresh(),e.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}t.TouchScroll=d},(e,t,r)=>{"use strict";t.__esModule=!0;r=r(1061);t.PLUGIN_KEY=r.PLUGIN_KEY,t.PLUGIN_PRIORITY=r.PLUGIN_PRIORITY,t.TrimRows=r.TrimRows},(e,t,r)=>{"use strict";var n=r(197),i=(t.__esModule=!0,r(204),r(286),r(290),r(302),r(305),r(309),r(312),r(315),r(318),n(r(487))),n=r(813),o=r(597),s=r(478);function a(e,t){var r=e;if(t.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object");t.add(e)}const l=t.PLUGIN_KEY="trimRows";t.PLUGIN_PRIORITY=330;var c=new WeakSet;class u extends n.BasePlugin{constructor(){super(...arguments),a(this,c),(0,i.default)(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return l}static get PLUGIN_PRIORITY(){return 330}isEnabled(){return!!this.hot.getSettings()[l]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new o.TrimmingMap),this.trimmedRowsMap.addLocalHook("init",()=>function(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}(c,this,d).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[l];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),(0,s.arrayEach)(e,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){var t=this.getTrimmedRows(),r=this.isValidConfig(e);let n=t;r&&(n=Array.from(new Set(t.concat(e)))),!1!==this.hot.runHooks("beforeTrimRow",t,n,r)&&(r&&this.hot.batchExecution(()=>{(0,s.arrayEach)(e,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0),this.hot.runHooks("afterTrimRow",t,n,r,r&&n.length>t.length))}trimRow(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.trimRows(t)}untrimRows(e){var t=this.getTrimmedRows(),r=this.isValidConfig(e);let n=t;const i=this.trimmedRowsMap.getValues().slice();var o=0<e.length,e=(r&&o&&((0,s.arrayEach)(e,e=>{i[e]=!1}),n=(0,s.arrayReduce)(i,(e,t,r)=>(t&&e.push(r),e),[])),this.hot.runHooks("beforeUntrimRow",t,n,r&&o));!1!==e&&(r&&o&&this.trimmedRowsMap.setValues(i),this.hot.runHooks("afterUntrimRow",t,n,r&&o,r&&n.length<t.length))}untrimRow(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.untrimRows(t)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const t=this.hot.countSourceRows();return e.every(e=>Number.isInteger(e)&&0<=e&&e<t)}destroy(){super.destroy()}}function d(){const e=this.hot.getSettings()[l];Array.isArray(e)&&this.hot.batchExecution(()=>{(0,s.arrayEach)(e,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}t.TrimRows=u},(e,t,r)=>{"use strict";t.__esModule=!0;r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var o;"default"!==r&&{}.hasOwnProperty.call(e,r)&&((o=i?Object.getOwnPropertyDescriptor(e,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(r(1063));function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}t.UndoRedo=r.default,t.PLUGIN_KEY=r.PLUGIN_KEY},(e,t,r)=>{"use strict";var n=r(197),n=(t.__esModule=!0,r(286),r(1064),n(r(494))),l=r(478),p=r(512),f=r(482),o=r(855),i=r(976);t.PLUGIN_KEY="undoRedo";function g(u){const d=this,h=(this.instance=u,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,u.addHook("afterChange",function(r,e){const n=r&&r.length;n&&r.find(e=>{var[,,e,t]=e;return e!==t})&&d.done(()=>{var e=r.reduce((e,t)=>(e.push([...t]),e),[]),t=((0,l.arrayEach)(e,e=>{e[1]=u.propToCol(e[1])}),1<n?this.getSelected():[[e[0][0],e[0][1]]]);return new g.ChangeAction(e,t)},e)}),u.addHook("afterCreateRow",(e,t,r)=>{d.done(()=>new g.CreateRowAction(e,t),r)}),(e,t,r,n)=>{const i=["visualRow","visualCol","row","col","prop"],o=i.length,s=[];return(0,p.rangeEach)(r,n,r=>{(0,p.rangeEach)(e,t,e=>{var t,e=u.getCellMeta(e,r);Object.keys(e).length!==o&&(t=Object.fromEntries(Object.entries(e).filter(e=>{var[e]=e;return!1===i.includes(e)})),s.push([e.visualRow,e.visualCol,t]))})}),s});u.addHook("beforeRemoveRow",(n,i,e,t)=>{d.done(()=>{var e=u.toPhysicalRow(n),t=e+i-1,r=(0,f.deepClone)(d.instance.getSourceData(e,0,e+i-1,d.instance.countSourceCols()-1));return new g.RemoveRowAction(e,r,u.getSettings().fixedRowsBottom,u.getSettings().fixedRowsTop,u.rowIndexMapper.getIndexesSequence(),h(e,t,0,u.countCols()-1))},t)}),u.addHook("afterCreateCol",(e,t,r)=>{d.done(()=>new g.CreateColumnAction(e,t),r)}),u.addHook("beforeRemoveCol",(l,c,e,t)=>{d.done(()=>{const n=d.instance.getSourceDataArray(),i=(d.instance.countCols()+l)%d.instance.countCols(),o=i+c-1,s=[],t=[],r=[];(0,p.rangeEach)(n.length-1,e=>{const t=[],r=n[e];(0,p.rangeEach)(i,o,e=>{t.push(r[u.toPhysicalColumn(e)])}),s.push(t)}),(0,p.rangeEach)(c-1,e=>{r.push(u.toPhysicalColumn(i+e))}),Array.isArray(u.getSettings().colHeaders)&&(0,p.rangeEach)(c-1,e=>{t.push(u.getSettings().colHeaders[u.toPhysicalColumn(i+e)]||null)});var e=u.columnIndexMapper.getIndexesSequence(),a=u.rowIndexMapper.getIndexesSequence();return new g.RemoveColumnAction(i,r,s,t,e,a,u.getSettings().fixedColumnsStart,h(0,u.countRows(),i,o))},t)}),u.addHook("beforeCellAlignment",(e,t,r,n)=>{d.done(()=>new g.CellAlignmentAction(e,t,r,n))}),u.addHook("beforeFilter",e=>{d.done(()=>new g.FiltersAction(e))}),u.addHook("beforeRowMove",(e,t)=>{!1!==e&&d.done(()=>new g.RowMoveAction(e,t))}),u.addHook("beforeColumnMove",(e,t)=>{!1!==e&&d.done(()=>new g.ColumnMoveAction(e,t))}),u.addHook("beforeMergeCells",(e,t)=>{t||d.done(()=>new g.MergeCellsAction(u,e))}),u.addHook("afterUnmergeCells",(e,t)=>{t||d.done(()=>new g.UnmergeCellsAction(u,e))}),u.addHook("beforeColumnSort",(e,t,r)=>{r&&d.done(()=>new g.ColumnSortAction(e,t))}),u.addHook("afterInit",()=>{d.init()})}g.prototype.done=function(e,t){var r;this.ignoreNewActions||"UndoRedo.undo"===t||"UndoRedo.redo"===t||"auto"===t||(r=this.doneActions.slice(),!1!==this.instance.runHooks("beforeUndoStackChange",r,t)&&(t=e(),e=this.undoneActions.slice(),this.doneActions.push(t),this.instance.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",e),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",e,this.undoneActions.slice())))},g.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",e);const r=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",e,this.doneActions.slice());var e=(0,f.deepClone)(r),t=this.instance.runHooks("beforeUndo",e);if(!1!==t){this.ignoreNewActions=!0;const n=this;t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t),r.undo(this.instance,()=>{n.ignoreNewActions=!1,n.undoneActions.push(r)}),this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice()),this.instance.runHooks("afterUndo",e)}}},g.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",e);const r=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",e,this.undoneActions.slice());var e=(0,f.deepClone)(r),t=this.instance.runHooks("beforeRedo",e);if(!1!==t){this.ignoreNewActions=!0;const n=this;t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t),r.redo(this.instance,()=>{n.ignoreNewActions=!1,n.doneActions.push(r)}),this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice()),this.instance.runHooks("afterRedo",e)}}},g.prototype.isUndoAvailable=function(){return 0<this.doneActions.length},g.prototype.isRedoAvailable=function(){return 0<this.undoneActions.length},g.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},g.prototype.isEnabled=function(){return this.enabled},g.prototype.enable=function(){var e,t;this.isEnabled()||(e=this.instance,this.enabled=!0,(t=e).undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()},this.registerShortcuts(),e.addHook("afterChange",c))},g.prototype.disable=function(){var e,t;this.isEnabled()&&(e=this.instance,this.enabled=!1,delete(t=e).undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo,this.unregisterShortcuts(),e.removeHook("afterChange",c))},g.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null},g.Action=function(){},g.Action.prototype.undo=function(){},g.Action.prototype.redo=function(){},g.ChangeAction=function(e,t){this.changes=e,this.selected=t,this.actionType="change"},(0,f.inherit)(g.ChangeAction,g.Action),g.ChangeAction.prototype.undo=function(r,e){var n=(0,f.deepClone)(this.changes),i=r.countEmptyRows(!0),o=r.countEmptyCols(!0);for(let e=0,t=n.length;e<t;e++)n[e].splice(3,1);r.addHookOnce("afterChange",e),r.setDataAtCell(n,null,null,"UndoRedo.undo");for(let e=0,t=n.length;e<t;e++){var[s,a]=n[e];r.getSettings().minSpareRows&&s+1+r.getSettings().minSpareRows===r.countRows()&&i===r.getSettings().minSpareRows&&(r.alter("remove_row",parseInt(s+1,10),r.getSettings().minSpareRows),r.undoRedo.doneActions.pop()),r.getSettings().minSpareCols&&a+1+r.getSettings().minSpareCols===r.countCols()&&o===r.getSettings().minSpareCols&&(r.alter("remove_col",parseInt(a+1,10),r.getSettings().minSpareCols),r.undoRedo.doneActions.pop())}var t,l,c,u,d,e=r.getSelectedLast();void 0!==e&&([t,l]=n[0],[e,c]=e,u=r.view.getFirstFullyVisibleRow()<=t,d=r.view.getFirstFullyVisibleColumn()<=l,!1==(u&&d))&&!0==(e!==t||c!==l)&&(!(e={row:t,col:l})==u&&(e.verticalSnap="top"),!1==d&&(e.horizontalSnap="start"),r.scrollViewportTo(e)),r.selectCells(this.selected,!1,!1)},g.ChangeAction.prototype.redo=function(e,t){var r=(0,f.deepClone)(this.changes);for(let e=0,t=r.length;e<t;e++)r[e].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)},g.CreateRowAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_row"},(0,f.inherit)(g.CreateRowAction,g.Action),g.CreateRowAction.prototype.undo=function(e,t){var r=e.countRows(),n=e.getSettings().minSpareRows;this.index>=r&&this.index-n<r&&(this.index-=n),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")},g.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")},g.RemoveRowAction=function(e,t,r,n,i,o){this.index=e,this.data=t,this.actionType="remove_row",this.fixedRowsBottom=r,this.fixedRowsTop=n,this.rowIndexesSequence=i,this.removedCellMetas=o},(0,f.inherit)(g.RemoveRowAction,g.Action),g.RemoveRowAction.prototype.undo=function(n,e){var t=n.getSettings();const i=[];t.fixedRowsBottom=this.fixedRowsBottom,t.fixedRowsTop=this.fixedRowsTop,this.data.forEach((r,n)=>{Object.keys(r).forEach(e=>{var t=parseInt(e,10);i.push([this.index+n,isNaN(t)?e:t,r[e]])})}),n.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),this.removedCellMetas.forEach(e=>{var[e,t,r]=e;n.setCellMetaObject(e,t,r)}),n.addHookOnce("afterViewRender",e),n.setSourceDataAtCell(i,null,null,"UndoRedo.undo"),n.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)},g.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")},g.CreateColumnAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_col"},(0,f.inherit)(g.CreateColumnAction,g.Action),g.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")},g.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")},g.RemoveColumnAction=function(e,t,r,n,i,o,s,a){this.index=e,this.indexes=t,this.data=r,this.amount=this.data[0].length,this.headers=n,this.columnPositions=i.slice(0),this.rowPositions=o.slice(0),this.actionType="remove_col",this.fixedColumnsStart=s,this.removedCellMetas=a},(0,f.inherit)(g.RemoveColumnAction,g.Action),g.RemoveColumnAction.prototype.undo=function(n,e){n.getSettings().fixedColumnsStart=this.fixedColumnsStart;const i=this.indexes.slice(0).sort();var t=(e,t,r)=>r[this.indexes.indexOf(i[t])],r=this.data.length;const o=[];for(let e=0;e<r;e++)o.push((0,l.arrayMap)(this.data[e],t));var s=(0,l.arrayMap)(this.headers,t);const a=[];n.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),(0,l.arrayEach)(n.getSourceDataArray(),(r,n)=>{(0,l.arrayEach)(i,(e,t)=>{r[e]=o[n][t],a.push([n,e,r[e]])})}),n.setSourceDataAtCell(a,void 0,void 0,"UndoRedo.undo"),void 0!==this.headers&&(0,l.arrayEach)(s,(e,t)=>{n.getSettings().colHeaders[i[t]]=e}),this.removedCellMetas.forEach(e=>{var[e,t,r]=e;n.setCellMetaObject(e,t,r)}),n.batchExecution(()=>{n.rowIndexMapper.setIndexesSequence(this.rowPositions),n.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),n.addHookOnce("afterViewRender",e),n.render()},g.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")},g.CellAlignmentAction=function(e,t,r,n){this.stateBefore=e,this.range=t,this.type=r,this.alignment=n},g.CellAlignmentAction.prototype.undo=function(r,e){(0,l.arrayEach)(this.range,e=>{e.forAll((e,t)=>{0<=e&&0<=t&&r.setCellMeta(e,t,"className",this.stateBefore[e][t]||" htLeft")})}),r.addHookOnce("afterViewRender",e),r.render()},g.CellAlignmentAction.prototype.redo=function(i,e){(0,o.align)(this.range,this.type,this.alignment,(e,t)=>i.getCellMeta(e,t),(e,t,r,n)=>i.setCellMeta(e,t,r,n)),i.addHookOnce("afterViewRender",e),i.render()},g.FiltersAction=function(e){this.conditionsStack=e,this.actionType="filter"},(0,f.inherit)(g.FiltersAction,g.Action),g.FiltersAction.prototype.undo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),r.filter()},g.FiltersAction.prototype.redo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack),r.filter()};class s extends g.Action{constructor(e,t){super(),this.cellRange=t;var t=this.cellRange.getTopStartCorner(),r=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(t.row,t.col,r.row,r.col)}undo(e,t){var r=e.getPlugin("mergeCells"),t=(e.addHookOnce("afterViewRender",t),r.unmergeRange(this.cellRange,!0),this.cellRange.getTopStartCorner());e.populateFromArray(t.row,t.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,t){var r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),r.mergeRange(this.cellRange)}}g.MergeCellsAction=s;class a extends g.Action{constructor(e,t){super(),this.cellRange=t}undo(e,t){var r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),r.mergeRange(this.cellRange,!0)}redo(e,t){var r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),r.unmergeRange(this.cellRange,!0),e.render()}}function c(e,t){if("loadData"===t)return this.undoRedo.clear()}g.UnmergeCellsAction=a,g.RowMoveAction=function(e,t){this.rows=e.slice(),this.finalRowIndex=t,this.actionType="row_move"},(0,f.inherit)(g.RowMoveAction,g.Action),g.RowMoveAction.prototype.undo=function(e,t){const n=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),(0,i.getMoves)(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(e=>{let{from:t,to:r}=e;t<r&&--r,n.moveRow(r,t)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)},g.RowMoveAction.prototype.redo=function(e,t){var r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),r.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)},g.ColumnMoveAction=function(e,t){this.columns=e.slice(),this.finalColumnIndex=t,this.actionType="col_move"},(0,f.inherit)(g.ColumnMoveAction,g.Action),g.ColumnMoveAction.prototype.undo=function(e,t){const n=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",t),(0,i.getMoves)(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(e=>{let{from:t,to:r}=e;t<r&&--r,n.moveColumn(r,t)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)},g.ColumnMoveAction.prototype.redo=function(e,t){var r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",t),r.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)},g.ColumnSortAction=function(e,t){this.previousSortState=e,this.nextSortState=t},(0,f.inherit)(g.ColumnSortAction,g.Action),g.ColumnSortAction.prototype.undo=function(e,t){var r=e.getPlugin("columnSorting"),e=e.getPlugin("multiColumnSorting"),e=e.isEnabled()?e:r;this.previousSortState.length?e.sort(this.previousSortState):e.clearSort(),t()},g.ColumnSortAction.prototype.redo=function(e,t){var r=e.getPlugin("columnSorting"),e=e.getPlugin("multiColumnSorting");(e.isEnabled()?e:r).sort(this.nextSortState),t()},g.prototype.init=function(){var e=this.instance.getSettings().undo,e=void 0===e||e;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()},g.prototype.registerShortcuts=function(){this.instance.getShortcutManager().getContext("grid").addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],{runOnlyIf:e=>!e.altKey,group:"undoRedo"})},g.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup("undoRedo")};r=n.default.getSingleton();r.add("afterUpdateSettings",function(){var e;null!=(e=this.getPlugin("undoRedo"))&&e.init()}),r.register("beforeUndo"),r.register("afterUndo"),r.register("beforeRedo"),r.register("afterRedo"),g.PLUGIN_KEY="undoRedo",g.SETTING_KEYS=!0,t.default=g},(e,t,r)=>{"use strict";var n=r(205),i=r(1065),o=r(1070);n({target:"Object",stat:!0},{fromEntries:function(e){var r={};return i(e,function(e,t){o(r,e,t)},{AS_ENTRIES:!0}),r}})},(e,t,r)=>{"use strict";function y(e,t){this.stopped=e,this.result=t}var v=r(324),b=r(210),w=r(248),C=r(233),E=r(1066),T=r(265),S=r(226),_=r(1068),x=r(1069),R=r(308),A=TypeError,N=y.prototype;e.exports=function(e,t,r){function n(e){return o&&R(o,"normal",e),new y(!0,e)}function i(e){return h?(w(e),g?m(e[0],e[1],n):m(e[0],e[1])):g?m(e,n):m(e)}var o,s,a,l,c,u,d=r&&r.that,h=!(!r||!r.AS_ENTRIES),p=!(!r||!r.IS_RECORD),f=!(!r||!r.IS_ITERATOR),g=!(!r||!r.INTERRUPTED),m=v(t,d);if(p)o=e.iterator;else if(f)o=e;else{if(!(r=x(e)))throw new A(C(e)+" is not iterable");if(E(r)){for(s=0,a=T(e);s<a;s++)if((l=i(e[s]))&&S(N,l))return l;return new y(!1)}o=_(e,r)}for(c=(p?e:o).next;!(u=b(c,o)).done;){try{l=i(u.value)}catch(e){R(o,"throw",e)}if("object"==typeof l&&l&&S(N,l))return l}return new y(!1)}},(e,t,r)=>{"use strict";var n=r(235),i=r(1067),o=n("iterator"),s=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||s[o]===e)}},e=>{"use strict";e.exports={}},(e,t,r)=>{"use strict";var n=r(210),i=r(232),o=r(248),s=r(233),a=r(1069),l=TypeError;e.exports=function(e,t){t=arguments.length<2?a(e):t;if(i(t))return o(n(t,e));throw new l(s(e)+" is not iterable")}},(e,t,r)=>{"use strict";var n=r(280),i=r(231),o=r(219),s=r(1067),a=r(235)("iterator");e.exports=function(e){if(!o(e))return i(e,a)||i(e,"@@iterator")||s[n(e)]}},(e,t,r)=>{"use strict";var n=r(208),i=r(246),o=r(213);e.exports=function(e,t,r){n?i.f(e,t,o(0,r)):e[t]=r}},(e,t,r)=>{"use strict";t.__esModule=!0,t.default=function(l){var e="undefined"!=typeof window&&window.jQuery;e&&(e.fn.handsontable=function(e){var t,r=this.first();let n=r.data("handsontable");if("string"!=typeof e)return t=e||{},n?n.updateSettings(t):(n=new l.Core(r[0],t),r.data("handsontable",n),n.init()),r;let i;if(n){if(void 0===n[e])throw new Error("Handsontable do not provide action: "+e);for(var o=arguments.length,s=new Array(1<o?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];i=n[e].call(n,...s),"destroy"===e&&r.removeData()}return i})},r(204)}],n={};function i(e){var t=n[e];return void 0!==t||(t=n[e]={id:e,loaded:!1,exports:{}},r[e].call(t.exports,t,t.exports,i),t.loaded=!0),t.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),i(0);var e=i(196),e=e.default;return e})()),!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("handsontable"));else if("function"==typeof define&&define.amd)define(["handsontable"],t);else{var r,n="object"==typeof exports?t(require("handsontable")):t(e.Handsontable);for(r in n)("object"==typeof exports?exports:e)[r]=n[r]}}("undefined"!=typeof self?self:this,t=>{return r=[,e=>{e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports},e=>{"use strict";e.exports=t}],i={},o={},(()=>{"use strict";var e=o,t=n(1),t=(e.__esModule=!0,t(n(2))),r=t.default.languages.dictionaryKeys,r={languageCode:"ko-KR",[r.CONTEXTMENU_ITEMS_ROW_ABOVE]:"위쪽에 행 삽입",[r.CONTEXTMENU_ITEMS_ROW_BELOW]:"아래쪽에 행 삽입",[r.CONTEXTMENU_ITEMS_INSERT_LEFT]:"왼쪽에 열 삽입",[r.CONTEXTMENU_ITEMS_INSERT_RIGHT]:"오른쪽에 열 삽입",[r.CONTEXTMENU_ITEMS_REMOVE_ROW]:["행 삭제","여러 행 삭제"],[r.CONTEXTMENU_ITEMS_REMOVE_COLUMN]:["열 삭제","여러 열 삭제"],[r.CONTEXTMENU_ITEMS_UNDO]:"되돌리기",[r.CONTEXTMENU_ITEMS_REDO]:"다시하기",[r.CONTEXTMENU_ITEMS_READ_ONLY]:"읽기 전용",[r.CONTEXTMENU_ITEMS_CLEAR_COLUMN]:"열 지우기",[r.CONTEXTMENU_ITEMS_ALIGNMENT]:"정렬",[r.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT]:"왼쪽",[r.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER]:"중앙",[r.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT]:"오른쪽",[r.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY]:"자동",[r.CONTEXTMENU_ITEMS_ALIGNMENT_TOP]:"위쪽",[r.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE]:"가운데",[r.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM]:"아래쪽",[r.CONTEXTMENU_ITEMS_FREEZE_COLUMN]:"열 고정",[r.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN]:"열 고정 해제",[r.CONTEXTMENU_ITEMS_BORDERS]:"테두리",[r.CONTEXTMENU_ITEMS_BORDERS_TOP]:"위쪽",[r.CONTEXTMENU_ITEMS_BORDERS_RIGHT]:"오른쪽",[r.CONTEXTMENU_ITEMS_BORDERS_BOTTOM]:"아래쪽",[r.CONTEXTMENU_ITEMS_BORDERS_LEFT]:"왼쪽",[r.CONTEXTMENU_ITEMS_REMOVE_BORDERS]:"테두리 지우기",[r.CONTEXTMENU_ITEMS_ADD_COMMENT]:"댓글 달기",[r.CONTEXTMENU_ITEMS_EDIT_COMMENT]:"댓글 편집",[r.CONTEXTMENU_ITEMS_REMOVE_COMMENT]:"댓글 삭제",[r.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT]:"읽기 전용 댓글",[r.CONTEXTMENU_ITEMS_MERGE_CELLS]:"셀 병합",[r.CONTEXTMENU_ITEMS_UNMERGE_CELLS]:"셀 병합 해제",[r.CONTEXTMENU_ITEMS_COPY]:"복사",[r.CONTEXTMENU_ITEMS_CUT]:"잘라내기",[r.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD]:"자녀 행 추가",[r.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD]:"부모행에서 제거",[r.CONTEXTMENU_ITEMS_HIDE_COLUMN]:["열 숨기기","여러 열 숨기기"],[r.CONTEXTMENU_ITEMS_SHOW_COLUMN]:["열 숨기기 해제","여러 열 숨기기 해제"],[r.CONTEXTMENU_ITEMS_HIDE_ROW]:["행 숨기기","여러 행 숨기기"],[r.CONTEXTMENU_ITEMS_SHOW_ROW]:["행 숨기기 해제","여러 행 숨기기 해제"],[r.FILTERS_CONDITIONS_NONE]:"조건없음",[r.FILTERS_CONDITIONS_EMPTY]:"비어있음",[r.FILTERS_CONDITIONS_NOT_EMPTY]:"비어있지 않음",[r.FILTERS_CONDITIONS_EQUAL]:"같",[r.FILTERS_CONDITIONS_NOT_EQUAL]:"같지 않음",[r.FILTERS_CONDITIONS_BEGINS_WITH]:"시작 문자",[r.FILTERS_CONDITIONS_ENDS_WITH]:"끝 문자",[r.FILTERS_CONDITIONS_CONTAINS]:"포함",[r.FILTERS_CONDITIONS_NOT_CONTAIN]:"포함하지 않음",[r.FILTERS_CONDITIONS_GREATER_THAN]:"보다 큼",[r.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL]:"크거나 같음",[r.FILTERS_CONDITIONS_LESS_THAN]:"보다 작",[r.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL]:"작거나 같음",[r.FILTERS_CONDITIONS_BETWEEN]:"사이",[r.FILTERS_CONDITIONS_NOT_BETWEEN]:"사이 제외",[r.FILTERS_CONDITIONS_AFTER]:"다음",[r.FILTERS_CONDITIONS_BEFORE]:"전",[r.FILTERS_CONDITIONS_TODAY]:"오늘",[r.FILTERS_CONDITIONS_TOMORROW]:"내일",[r.FILTERS_CONDITIONS_YESTERDAY]:"어제",[r.FILTERS_VALUES_BLANK_CELLS]:"공란",[r.FILTERS_DIVS_FILTER_BY_CONDITION]:"조건부 필터",[r.FILTERS_DIVS_FILTER_BY_VALUE]:"값 필터",[r.FILTERS_LABELS_CONJUNCTION]:"그리고",[r.FILTERS_LABELS_DISJUNCTION]:"또는",[r.FILTERS_BUTTONS_SELECT_ALL]:"전체선택",[r.FILTERS_BUTTONS_CLEAR]:"지우기",[r.FILTERS_BUTTONS_OK]:"확인",[r.FILTERS_BUTTONS_CANCEL]:"취소",[r.FILTERS_BUTTONS_PLACEHOLDER_SEARCH]:"찾기",[r.FILTERS_BUTTONS_PLACEHOLDER_VALUE]:"값",[r.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE]:"두번째 값"};t.default.languages.registerLanguageDictionary(r),e.default=r})(),o.___;function n(e){var t=i[e];return void 0!==t||(t=i[e]={exports:{}},r[e](t,t.exports,n)),t.exports}var r,i,o}),!function(r){"use strict";"function"==typeof define&&define.amd?define(["jquery"],function(e){return r(e,window,document)}):"object"==typeof exports?module.exports=function(e,t){return e=e||window,t=t||("undefined"!=typeof window?require("jquery"):require("jquery")(e)),r(t,e,e.document)}:r(jQuery,window,document)}(function(k,$,w,D){"use strict";function h(e){var t=parseInt(e,10);return!isNaN(t)&&isFinite(e)?t:null}function l(e,t,r){var n="string"==typeof e;return!!i(e)||(t&&n&&(e=G(e,t)),r&&n&&(e=e.replace(Y,"")),!isNaN(parseFloat(e))&&isFinite(e))}function r(e,t,r){var n;return!!i(e)||(i(n=e)||"string"==typeof n)&&!!l(e.replace(B,""),t,r)||null}function y(e,t,r,n){var i=[],o=0,s=t.length;if(n!==D)for(;o<s;o++)e[t[o]][r]&&i.push(e[t[o]][r][n]);else for(;o<s;o++)i.push(e[t[o]][r]);return i}function d(e,t){var r,n=[];t===D?(t=0,r=e):(r=t,t=e);for(var i=t;i<r;i++)n.push(i);return n}function C(e){for(var t=[],r=0,n=e.length;r<n;r++)e[r]&&t.push(e[r]);return t}var f,t,e,T=function(b){this.$=function(e,t){return this.api(!0).$(e,t)},this._=function(e,t){return this.api(!0).rows(e,t).data()},this.api=function(e){return new W(e?ht(this[f.iApiIndex]):this)},this.fnAddData=function(e,t){var r=this.api(!0),e=(Array.isArray(e)&&(Array.isArray(e[0])||k.isPlainObject(e[0]))?r.rows:r.row).add(e);return t!==D&&!t||r.draw(),e.flatten().toArray()},this.fnAdjustColumnSizing=function(e){var t=this.api(!0).columns.adjust(),r=t.settings()[0],n=r.oScroll;e===D||e?t.draw(!1):""===n.sX&&""===n.sY||Je(r)},this.fnClearTable=function(e){var t=this.api(!0).clear();e!==D&&!e||t.draw()},this.fnClose=function(e){this.api(!0).row(e).child.hide()},this.fnDeleteRow=function(e,t,r){var n=this.api(!0),e=n.rows(e),i=e.settings()[0],o=i.aoData[e[0][0]];return e.remove(),t&&t.call(this,i,o),r!==D&&!r||n.draw(),o},this.fnDestroy=function(e){this.api(!0).destroy(e)},this.fnDraw=function(e){this.api(!0).draw(e)},this.fnFilter=function(e,t,r,n,i,o){var s=this.api(!0);(null===t||t===D?s:s.column(t)).search(e,r,n,o),s.draw()},this.fnGetData=function(e,t){var r,n=this.api(!0);return e!==D?(r=e.nodeName?e.nodeName.toLowerCase():"",t!==D||"td"==r||"th"==r?n.cell(e,t).data():n.row(e).data()||null):n.data().toArray()},this.fnGetNodes=function(e){var t=this.api(!0);return e!==D?t.row(e).node():t.rows().nodes().flatten().toArray()},this.fnGetPosition=function(e){var t=this.api(!0),r=e.nodeName.toUpperCase();return"TR"==r?t.row(e).index():"TD"==r||"TH"==r?[(r=t.cell(e).index()).row,r.columnVisible,r.column]:null},this.fnIsOpen=function(e){return this.api(!0).row(e).child.isShown()},this.fnOpen=function(e,t,r){return this.api(!0).row(e).child(t,r).show().child()[0]},this.fnPageChange=function(e,t){e=this.api(!0).page(e);t!==D&&!t||e.draw(!1)},this.fnSetColumnVis=function(e,t,r){e=this.api(!0).column(e).visible(t);r!==D&&!r||e.columns.adjust().draw()},this.fnSettings=function(){return ht(this[f.iApiIndex])},this.fnSort=function(e){this.api(!0).order(e).draw()},this.fnSortListener=function(e,t,r){this.api(!0).order.listener(e,t,r)},this.fnUpdate=function(e,t,r,n,i){var o=this.api(!0);return(r===D||null===r?o.row(t):o.cell(t,r)).data(e),i!==D&&!i||o.columns.adjust(),n!==D&&!n||o.draw(),0},this.fnVersionCheck=f.fnVersionCheck;var e,w=this,C=b===D,E=this.length;for(e in C&&(b={}),this.oApi=this.internal=f.internal,T.ext.internal)e&&(this[e]=Lt(e));return this.each(function(){var n=1<E?pt({},b,!0):b,i=0,e=this.getAttribute("id"),o=!1,t=T.defaults,s=k(this);if("table"!=this.nodeName.toLowerCase())V(null,0,"Non-table node initialisation ("+this.nodeName+")",2);else{Z(t),Q(t.column),S(t,t,!0),S(t.column,t.column,!0),S(t,k.extend(n,s.data()),!0);for(var r=T.settings,i=0,a=r.length;i<a;i++){var l=r[i];if(l.nTable==this||l.nTHead&&l.nTHead.parentNode==this||l.nTFoot&&l.nTFoot.parentNode==this){var c=(n.bRetrieve!==D?n:t).bRetrieve,u=(n.bDestroy!==D?n:t).bDestroy;if(C||c)return l.oInstance;if(u){l.oInstance.fnDestroy();break}return void V(l,0,"Cannot reinitialise DataTable",3)}if(l.sTableId==this.id){r.splice(i,1);break}}null!==e&&""!==e||(e="DataTables_Table_"+T.ext._unique++,this.id=e);var d,h,p=k.extend(!0,{},T.models.oSettings,{sDestroyWidth:s[0].style.width,sInstance:e,sTableId:e}),f=(p.nTable=this,p.oApi=w.internal,p.oInit=n,r.push(p),p.oInstance=1===w.length?w:s.dataTable(),Z(n),J(n.oLanguage),n.aLengthMenu&&!n.iDisplayLength&&(n.iDisplayLength=(Array.isArray(n.aLengthMenu[0])?n.aLengthMenu[0]:n.aLengthMenu)[0]),n=pt(k.extend(!0,{},t),n),N(p.oFeatures,n,["bPaginate","bLengthChange","bFilter","bSort","bSortMulti","bInfo","bProcessing","bAutoWidth","bSortClasses","bServerSide","bDeferRender"]),N(p,n,["asStripeClasses","ajax","fnServerData","fnFormatNumber","sServerMethod","aaSorting","aaSortingFixed","aLengthMenu","sPaginationType","sAjaxSource","sAjaxDataProp","iStateDuration","sDom","bSortCellsTop","iTabIndex","fnStateLoadCallback","fnStateSaveCallback","renderer","searchDelay","rowId",["iCookieDuration","iStateDuration"],["oSearch","oPreviousSearch"],["aoSearchCols","aoPreSearchCols"],["iDisplayLength","_iDisplayLength"]]),N(p.oScroll,n,[["sScrollX","sX"],["sScrollXInner","sXInner"],["sScrollY","sY"],["bScrollCollapse","bCollapse"]]),N(p.oLanguage,n,"fnInfoCallback"),O(p,"aoDrawCallback",n.fnDrawCallback,"user"),O(p,"aoServerParams",n.fnServerParams,"user"),O(p,"aoStateSaveParams",n.fnStateSaveParams,"user"),O(p,"aoStateLoadParams",n.fnStateLoadParams,"user"),O(p,"aoStateLoaded",n.fnStateLoaded,"user"),O(p,"aoRowCallback",n.fnRowCallback,"user"),O(p,"aoRowCreatedCallback",n.fnCreatedRow,"user"),O(p,"aoHeaderCallback",n.fnHeaderCallback,"user"),O(p,"aoFooterCallback",n.fnFooterCallback,"user"),O(p,"aoInitComplete",n.fnInitComplete,"user"),O(p,"aoPreDrawCallback",n.fnPreDrawCallback,"user"),p.rowIdFn=R(n.rowId),ee(p),p.oClasses),g=(k.extend(f,T.ext.classes,n.oClasses),s.addClass(f.sTable),p.iInitDisplayStart===D&&(p.iInitDisplayStart=n.iDisplayStart,p._iDisplayStart=n.iDisplayStart),null!==n.iDeferLoading&&(p.bDeferLoading=!0,e=Array.isArray(n.iDeferLoading),p._iRecordsDisplay=e?n.iDeferLoading[0]:n.iDeferLoading,p._iRecordsTotal=e?n.iDeferLoading[1]:n.iDeferLoading),p.oLanguage),e=(k.extend(!0,g,n.oLanguage),g.sUrl?(k.ajax({dataType:"json",url:g.sUrl,success:function(e){J(e),S(t.oLanguage,e),k.extend(!0,g,e),I(p,null,"i18n",[p]),Be(p)},error:function(){Be(p)}}),o=!0):I(p,null,"i18n",[p]),null===n.asStripeClasses&&(p.asStripeClasses=[f.sStripeOdd,f.sStripeEven]),p.asStripeClasses),m=s.children("tbody").find("tr").eq(0),y=(-1!==k.inArray(!0,k.map(e,function(e,t){return m.hasClass(e)}))&&(k("tbody tr",this).removeClass(e.join(" ")),p.asDestroyStripes=e.slice()),[]),e=this.getElementsByTagName("thead");if(0!==e.length&&(Ce(p.aoHeader,e[0]),y=Ee(p)),null===n.aoColumns)for(d=[],i=0,a=y.length;i<a;i++)d.push(null);else d=n.aoColumns;for(i=0,a=d.length;i<a;i++)re(p,y?y[i]:null);se(p,n.aoColumnDefs,d,function(e,t){ne(p,e,t)}),m.length&&(h=function(e,t){return null!==e.getAttribute("data-"+t)?t:null},k(m[0]).children("th, td").each(function(e,t){var r,n=p.aoColumns[e];n.mData===e&&(r=h(t,"sort")||h(t,"order"),t=h(t,"filter")||h(t,"search"),null===r&&null===t||(n.mData={_:e+".display",sort:null!==r?e+".@data-"+r:D,type:null!==r?e+".@data-"+r:D,filter:null!==t?e+".@data-"+t:D},ne(p,e)))}));var v=p.oFeatures,e=function(){if(n.aaSorting===D){var e=p.aaSorting;for(i=0,a=e.length;i<a;i++)e[i][1]=p.aoColumns[i].asSorting[0]}lt(p),v.bSort&&O(p,"aoDrawCallback",function(){var e,r;p.bSorted&&(e=A(p),r={},k.each(e,function(e,t){r[t.src]=t.dir}),I(p,null,"order",[p,e,r]),ot(p))}),O(p,"aoDrawCallback",function(){(p.bSorted||"ssp"===M(p)||v.bDeferRender)&&lt(p)},"sc");var t=s.children("caption").each(function(){this._captionSide=k(this).css("caption-side")}),r=s.children("thead"),r=(0===r.length&&(r=k("<thead/>").appendTo(s)),p.nTHead=r[0],s.children("tbody")),r=(0===r.length&&(r=k("<tbody/>").appendTo(s)),p.nTBody=r[0],s.children("tfoot"));if(0===(r=0===r.length&&0<t.length&&(""!==p.oScroll.sX||""!==p.oScroll.sY)?k("<tfoot/>").appendTo(s):r).length||0===r.children().length?s.addClass(f.sNoFooter):0<r.length&&(p.nTFoot=r[0],Ce(p.aoFooter,p.nTFoot)),n.aaData)for(i=0;i<n.aaData.length;i++)x(p,n.aaData[i]);else!p.bDeferLoading&&"dom"!=M(p)||ae(p,k(p.nTBody).children("tr"));p.aiDisplay=p.aiDisplayMaster.slice(),!(p.bInitialised=!0)===o&&Be(p)};n.bStateSave?(v.bStateSave=!0,O(p,"aoDrawCallback",ut,"state_save"),dt(p,0,e)):e()}}),w=null,this},n={},E=/[\r\n\u2028]/g,B=/<.*?>/g,j=/^\d{2,4}[\.\/\-]\d{1,2}[\.\/\-]\d{1,2}([T ]{1}\d{1,2}[:\.]\d{2}([\.:]\d{2})?)?$/,z=new RegExp("(\\"+["/",".","*","+","?","|","(",")","[","]","{","}","\\","$","^","-"].join("|\\")+")","g"),Y=/['\u00A0,$£€¥%\u2009\u202F\u20BD\u20a9\u20BArfkɃΞ]/gi,i=function(e){return!e||!0===e||"-"===e},G=function(e,t){return n[t]||(n[t]=new RegExp(De(t),"g")),"string"==typeof e&&"."!==t?e.replace(/\./g,"").replace(n[t],"."):e},P=function(e,t,r){var n=[],i=0,o=e.length;if(r!==D)for(;i<o;i++)e[i]&&e[i][t]&&n.push(e[i][t][r]);else for(;i<o;i++)e[i]&&n.push(e[i][t]);return n},q=function(e){if(!(e.length<2))for(var t=e.slice().sort(),r=t[0],n=1,i=t.length;n<i;n++){if(t[n]===r)return!1;r=t[n]}return!0},K=function(e){if(q(e))return e.slice();var t,r,n,i=[],o=e.length,s=0;e:for(r=0;r<o;r++){for(t=e[r],n=0;n<s;n++)if(i[n]===t)continue e;i.push(t),s++}return i},X=function(e,t){if(Array.isArray(t))for(var r=0;r<t.length;r++)X(e,t[r]);else e.push(t);return e};function s(r){var n,i,o={};k.each(r,function(e,t){(n=e.match(/^([^A-Z]+?)([A-Z])/))&&-1!=="a aa ai ao as b fn i m o s ".indexOf(n[1]+" ")&&(i=e.replace(n[0],n[2].toLowerCase()),o[i]=e,"o"===n[1])&&s(r[e])}),r._hungarianMap=o}function S(r,n,i){var o;r._hungarianMap||s(r),k.each(n,function(e,t){(o=r._hungarianMap[e])===D||!i&&n[o]!==D||("o"===o.charAt(0)?(n[o]||(n[o]={}),k.extend(!0,n[o],n[e]),S(r[o],n[o],i)):n[o]=n[e])})}function J(e){var t,r=T.defaults.oLanguage,n=r.sDecimal;n&&Dt(n),e&&(t=e.sZeroRecords,!e.sEmptyTable&&t&&"No data available in table"===r.sEmptyTable&&N(e,e,"sZeroRecords","sEmptyTable"),!e.sLoadingRecords&&t&&"Loading..."===r.sLoadingRecords&&N(e,e,"sZeroRecords","sLoadingRecords"),e.sInfoThousands&&(e.sThousands=e.sInfoThousands),t=e.sDecimal)&&n!==t&&Dt(t)}Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}),T.util={throttle:function(n,e){var i,o,s=e!==D?e:200;return function(){var e=this,t=+new Date,r=arguments;i&&t<i+s?(clearTimeout(o),o=setTimeout(function(){i=D,n.apply(e,r)},s)):(i=t,n.apply(e,r))}},escapeRegex:function(e){return e.replace(z,"\\$1")}};var o=function(e,t,r){e[t]!==D&&(e[r]=e[t])};function Z(e){o(e,"ordering","bSort"),o(e,"orderMulti","bSortMulti"),o(e,"orderClasses","bSortClasses"),o(e,"orderCellsTop","bSortCellsTop"),o(e,"order","aaSorting"),o(e,"orderFixed","aaSortingFixed"),o(e,"paging","bPaginate"),o(e,"pagingType","sPaginationType"),o(e,"pageLength","iDisplayLength"),o(e,"searching","bFilter"),"boolean"==typeof e.sScrollX&&(e.sScrollX=e.sScrollX?"100%":""),"boolean"==typeof e.scrollX&&(e.scrollX=e.scrollX?"100%":"");var t=e.aoSearchCols;if(t)for(var r=0,n=t.length;r<n;r++)t[r]&&S(T.models.oSearch,t[r])}function Q(e){o(e,"orderable","bSortable"),o(e,"orderData","aDataSort"),o(e,"orderSequence","asSorting"),o(e,"orderDataType","sortDataType");var t=e.aDataSort;"number"!=typeof t||Array.isArray(t)||(e.aDataSort=[t])}function ee(e){var t,r,n,i;T.__browser||(T.__browser=t={},i=(n=(r=k("<div/>").css({position:"fixed",top:0,left:-1*k($).scrollLeft(),height:1,width:1,overflow:"hidden"}).append(k("<div/>").css({position:"absolute",top:1,left:1,width:100,overflow:"scroll"}).append(k("<div/>").css({width:"100%",height:10}))).appendTo("body")).children()).children(),t.barWidth=n[0].offsetWidth-n[0].clientWidth,t.bScrollOversize=100===i[0].offsetWidth&&100!==n[0].clientWidth,t.bScrollbarLeft=1!==Math.round(i.offset().left),t.bBounding=!!r[0].getBoundingClientRect().width,r.remove()),k.extend(e.oBrowser,T.__browser),e.oScroll.iBarWidth=T.__browser.barWidth}function te(e,t,r,n,i,o){var s,a=n,l=!1;for(r!==D&&(s=r,l=!0);a!==i;)e.hasOwnProperty(a)&&(s=l?t(s,e[a],a,e):e[a],l=!0,a+=o);return s}function re(e,t){var r=T.defaults.column,n=e.aoColumns.length,r=k.extend({},T.models.oColumn,r,{nTh:t||w.createElement("th"),sTitle:r.sTitle||(t?t.innerHTML:""),aDataSort:r.aDataSort||[n],mData:r.mData||n,idx:n}),r=(e.aoColumns.push(r),e.aoPreSearchCols);r[n]=k.extend({},T.models.oSearch,r[n]),ne(e,n,k(t).data())}function ne(e,t,r){function n(e){return"string"==typeof e&&-1!==e.indexOf("@")}var t=e.aoColumns[t],i=e.oClasses,o=k(t.nTh),s=(!t.sWidthOrig&&(t.sWidthOrig=o.attr("width")||null,c=(o.attr("style")||"").match(/width:\s*(\d+[pxem%]+)/))&&(t.sWidthOrig=c[1]),r!==D&&null!==r&&(Q(r),S(T.defaults.column,r,!0),r.mDataProp===D||r.mData||(r.mData=r.mDataProp),r.sType&&(t._sManualType=r.sType),r.className&&!r.sClass&&(r.sClass=r.className),r.sClass&&o.addClass(r.sClass),k.extend(t,r),N(t,r,"sWidth","sWidthOrig"),r.iDataSort!==D&&(t.aDataSort=[r.iDataSort]),N(t,r,"aDataSort")),t.mData),a=R(s),l=t.mRender?R(t.mRender):null,c=(t._bAttrSrc=k.isPlainObject(s)&&(n(s.sort)||n(s.type)||n(s.filter)),t._setter=null,t.fnGetData=function(e,t,r){var n=a(e,t,D,r);return l&&t?l(n,t,e,r):n},t.fnSetData=function(e,t,r){return m(s)(e,t,r)},"number"!=typeof s&&(e._rowReadObject=!0),e.oFeatures.bSort||(t.bSortable=!1,o.addClass(i.sSortableNone)),-1!==k.inArray("asc",t.asSorting)),r=-1!==k.inArray("desc",t.asSorting);t.bSortable&&(c||r)?c&&!r?(t.sSortingClass=i.sSortableAsc,t.sSortingClassJUI=i.sSortJUIAscAllowed):!c&&r?(t.sSortingClass=i.sSortableDesc,t.sSortingClassJUI=i.sSortJUIDescAllowed):(t.sSortingClass=i.sSortable,t.sSortingClassJUI=i.sSortJUI):(t.sSortingClass=i.sSortableNone,t.sSortingClassJUI="")}function L(e){if(!1!==e.oFeatures.bAutoWidth){var t=e.aoColumns;Qe(e);for(var r=0,n=t.length;r<n;r++)t[r].nTh.style.width=t[r].sWidth}var i=e.oScroll;""===i.sY&&""===i.sX||Je(e),I(e,null,"column-sizing",[e])}function F(e,t){e=ie(e,"bVisible");return"number"==typeof e[t]?e[t]:null}function u(e,t){e=ie(e,"bVisible"),t=k.inArray(t,e);return-1!==t?t:null}function _(e){var r=0;return k.each(e.aoColumns,function(e,t){t.bVisible&&"none"!==k(t.nTh).css("display")&&r++}),r}function ie(e,r){var n=[];return k.map(e.aoColumns,function(e,t){e[r]&&n.push(t)}),n}function oe(e){for(var t,r,n,i,o,s,a,l=e.aoColumns,c=e.aoData,u=T.ext.type.detect,d=0,h=l.length;d<h;d++)if(a=[],!(o=l[d]).sType&&o._sManualType)o.sType=o._sManualType;else if(!o.sType){for(t=0,r=u.length;t<r;t++){for(n=0,i=c.length;n<i&&(a[n]===D&&(a[n]=v(e,n,d,"type")),(s=u[t](a[n],e))||t===u.length-1)&&"html"!==s;n++);if(s){o.sType=s;break}}o.sType||(o.sType="string")}}function se(e,t,r,n){var i,o,s,a,l=e.aoColumns;if(t)for(i=t.length-1;0<=i;i--)for(var c,u=(c=t[i]).targets!==D?c.targets:c.aTargets,d=0,h=(u=Array.isArray(u)?u:[u]).length;d<h;d++)if("number"==typeof u[d]&&0<=u[d]){for(;l.length<=u[d];)re(e);n(u[d],c)}else if("number"==typeof u[d]&&u[d]<0)n(l.length+u[d],c);else if("string"==typeof u[d])for(s=0,a=l.length;s<a;s++)"_all"!=u[d]&&!k(l[s].nTh).hasClass(u[d])||n(s,c);if(r)for(i=0,o=r.length;i<o;i++)n(i,r[i])}function x(e,t,r,n){for(var i=e.aoData.length,o=k.extend(!0,{},T.models.oRow,{src:r?"dom":"data",idx:i}),s=(o._aData=t,e.aoData.push(o),e.aoColumns),a=0,l=s.length;a<l;a++)s[a].sType=null;e.aiDisplayMaster.push(i);t=e.rowIdFn(t);return t!==D&&(e.aIds[t]=o),!r&&e.oFeatures.bDeferRender||me(e,i,r,n),i}function ae(r,e){var n;return(e=e instanceof k?e:k(e)).map(function(e,t){return n=ge(r,t),x(r,n.data,t,n.cells)})}function v(e,t,r,n){var i=e.iDraw,o=e.aoColumns[r],s=e.aoData[t]._aData,a=o.sDefaultContent,l=o.fnGetData(s,n,{settings:e,row:t,col:r});if(l===D)return e.iDrawError!=i&&null===a&&(V(e,0,"Requested unknown parameter "+("function"==typeof o.mData?"{function}":"'"+o.mData+"'")+" for row "+t+", column "+r,4),e.iDrawError=i),a;if(l!==s&&null!==l||null===a||n===D){if("function"==typeof l)return l.call(s)}else l=a;return null===l&&"display"==n?"":l}function le(e,t,r,n){var i=e.aoColumns[r],o=e.aoData[t]._aData;i.fnSetData(o,n,{settings:e,row:t,col:r})}var ce=/\[.*?\]$/,p=/\(\)$/;function ue(e){return k.map(e.match(/(\\.|[^\.])+/g)||[""],function(e){return e.replace(/\\\./g,".")})}function R(i){var o,h;return k.isPlainObject(i)?(o={},k.each(i,function(e,t){t&&(o[e]=R(t))}),function(e,t,r,n){var i=o[t]||o._;return i!==D?i(e,t,r,n):e}):null===i?function(e){return e}:"function"==typeof i?function(e,t,r,n){return i(e,t,r,n)}:"string"!=typeof i||-1===i.indexOf(".")&&-1===i.indexOf("[")&&-1===i.indexOf("(")?function(e,t){return e[i]}:(h=function(e,t,r){var n,i,o;if(""!==r)for(var s=ue(r),a=0,l=s.length;a<l;a++){if(d=s[a].match(ce),n=s[a].match(p),d){if(s[a]=s[a].replace(ce,""),""!==s[a]&&(e=e[s[a]]),i=[],s.splice(0,a+1),o=s.join("."),Array.isArray(e))for(var c=0,u=e.length;c<u;c++)i.push(h(e[c],t,o));var d=d[0].substring(1,d[0].length-1);e=""===d?i:i.join(d);break}if(n)s[a]=s[a].replace(p,""),e=e[s[a]]();else{if(null===e||e[s[a]]===D)return D;e=e[s[a]]}}return e},function(e,t){return h(e,t,i)})}function m(n){var h;return k.isPlainObject(n)?m(n._):null===n?function(){}:"function"==typeof n?function(e,t,r){n(e,"set",t,r)}:"string"!=typeof n||-1===n.indexOf(".")&&-1===n.indexOf("[")&&-1===n.indexOf("(")?function(e,t){e[n]=t}:(h=function(e,t,r){for(var n,i,o,s,a=ue(r),r=a[a.length-1],l=0,c=a.length-1;l<c;l++){if("__proto__"===a[l]||"constructor"===a[l])throw new Error("Cannot set prototype values");if(n=a[l].match(ce),i=a[l].match(p),n){if(a[l]=a[l].replace(ce,""),e[a[l]]=[],(n=a.slice()).splice(0,l+1),s=n.join("."),Array.isArray(t))for(var u=0,d=t.length;u<d;u++)h(o={},t[u],s),e[a[l]].push(o);else e[a[l]]=t;return}i&&(a[l]=a[l].replace(p,""),e=e[a[l]](t)),null!==e[a[l]]&&e[a[l]]!==D||(e[a[l]]={}),e=e[a[l]]}r.match(p)?e[r.replace(p,"")](t):e[r.replace(ce,"")]=t},function(e,t){return h(e,t,n)})}function de(e){return P(e.aoData,"_aData")}function he(e){e.aoData.length=0,e.aiDisplayMaster.length=0,e.aiDisplay.length=0,e.aIds={}}function pe(e,t,r){for(var n=-1,i=0,o=e.length;i<o;i++)e[i]==t?n=i:e[i]>t&&e[i]--;-1!=n&&r===D&&e.splice(n,1)}function fe(r,n,e,t){function i(e,t){for(;e.childNodes.length;)e.removeChild(e.firstChild);e.innerHTML=v(r,n,t,"display")}var o,s,a=r.aoData[n];if("dom"!==e&&(e&&"auto"!==e||"dom"!==a.src)){var l=a.anCells;if(l)if(t!==D)i(l[t],t);else for(o=0,s=l.length;o<s;o++)i(l[o],o)}else a._aData=ge(r,a,t,t===D?D:a._aData).data;a._aSortData=null,a._aFilterData=null;var c=r.aoColumns;if(t!==D)c[t].sType=null;else{for(o=0,s=c.length;o<s;o++)c[o].sType=null;ye(r,a)}}function ge(e,t,r,n){function i(e,t){var r;"string"==typeof e&&-1!==(r=e.indexOf("@"))&&(r=e.substring(r+1),m(e)(n,t.getAttribute(r)))}function o(e){r!==D&&r!==d||(a=h[d],l=e.innerHTML.trim(),a&&a._bAttrSrc?(m(a.mData._)(n,l),i(a.mData.sort,e),i(a.mData.type,e),i(a.mData.filter,e)):p?(a._setter||(a._setter=m(a.mData)),a._setter(n,l)):n[d]=l),d++}var s,a,l,c=[],u=t.firstChild,d=0,h=e.aoColumns,p=e._rowReadObject;n=n!==D?n:p?{}:[];if(u)for(;u;)"TD"!=(s=u.nodeName.toUpperCase())&&"TH"!=s||(o(u),c.push(u)),u=u.nextSibling;else for(var f=0,g=(c=t.anCells).length;f<g;f++)o(c[f]);var t=t.firstChild?t:t.nTr;return t&&(t=t.getAttribute("id"))&&m(e.rowId)(n,t),{data:n,cells:c}}function me(e,t,r,n){var i,o,s,a,l,c,u=e.aoData[t],d=u._aData,h=[];if(null===u.nTr){for(i=r||w.createElement("tr"),u.nTr=i,u.anCells=h,i._DT_RowIndex=t,ye(e,u),a=0,l=e.aoColumns.length;a<l;a++)s=e.aoColumns[a],(o=(c=!r)?w.createElement(s.sCellType):n[a])._DT_CellIndex={row:t,column:a},h.push(o),!c&&(!s.mRender&&s.mData===a||k.isPlainObject(s.mData)&&s.mData._===a+".display")||(o.innerHTML=v(e,t,a,"display")),s.sClass&&(o.className+=" "+s.sClass),s.bVisible&&!r?i.appendChild(o):!s.bVisible&&r&&o.parentNode.removeChild(o),s.fnCreatedCell&&s.fnCreatedCell.call(e.oInstance,o,v(e,t,a),d,t,a);I(e,"aoRowCreatedCallback",null,[i,d,t,h])}}function ye(e,t){var r=t.nTr,n=t._aData;r&&((e=e.rowIdFn(n))&&(r.id=e),n.DT_RowClass&&(e=n.DT_RowClass.split(" "),t.__rowc=t.__rowc?K(t.__rowc.concat(e)):e,k(r).removeClass(t.__rowc.join(" ")).addClass(n.DT_RowClass)),n.DT_RowAttr&&k(r).attr(n.DT_RowAttr),n.DT_RowData)&&k(r).data(n.DT_RowData)}function ve(e){var t,r,n,i=e.nTHead,o=e.nTFoot,s=0===k("th, td",i).length,a=e.oClasses,l=e.aoColumns;for(s&&(r=k("<tr/>").appendTo(i)),u=0,d=l.length;u<d;u++)n=l[u],t=k(n.nTh).addClass(n.sClass),s&&t.appendTo(r),e.oFeatures.bSort&&(t.addClass(n.sSortingClass),!1!==n.bSortable)&&(t.attr("tabindex",e.iTabIndex).attr("aria-controls",e.sTableId),at(e,n.nTh,u)),n.sTitle!=t[0].innerHTML&&t.html(n.sTitle),mt(e,"header")(e,t,n,a);if(s&&Ce(e.aoHeader,i),k(i).children("tr").attr("role","row"),k(i).children("tr").children("th, td").addClass(a.sHeaderTH),k(o).children("tr").children("th, td").addClass(a.sFooterTH),null!==o)for(var c=e.aoFooter[0],u=0,d=c.length;u<d;u++)(n=l[u]).nTf=c[u].cell,n.sClass&&k(n.nTf).addClass(n.sClass)}function be(e,t,r){var n,i,o,s,a,l,c,u,d,h=[],p=[],f=e.aoColumns.length;if(t){for(r===D&&(r=!1),n=0,i=t.length;n<i;n++){for(h[n]=t[n].slice(),h[n].nTr=t[n].nTr,o=f-1;0<=o;o--)e.aoColumns[o].bVisible||r||h[n].splice(o,1);p.push([])}for(n=0,i=h.length;n<i;n++){if(c=h[n].nTr)for(;l=c.firstChild;)c.removeChild(l);for(o=0,s=h[n].length;o<s;o++)if(d=u=1,p[n][o]===D){for(c.appendChild(h[n][o].cell),p[n][o]=1;h[n+u]!==D&&h[n][o].cell==h[n+u][o].cell;)p[n+u][o]=1,u++;for(;h[n][o+d]!==D&&h[n][o].cell==h[n][o+d].cell;){for(a=0;a<u;a++)p[n+a][o+d]=1;d++}k(h[n][o].cell).attr("rowspan",u).attr("colspan",d)}}}}function g(e){var t=I(e,"aoPreDrawCallback","preDraw",[e]);if(-1!==k.inArray(!1,t))b(e,!1);else{var r=[],n=0,i=e.asStripeClasses,o=i.length,t=(e.aoOpenRows.length,e.oLanguage),s=e.iInitDisplayStart,a="ssp"==M(e),l=e.aiDisplay,s=(e.bDrawing=!0,s!==D&&-1!==s&&(e._iDisplayStart=!a&&s>=e.fnRecordsDisplay()?0:s,e.iInitDisplayStart=-1),e._iDisplayStart),c=e.fnDisplayEnd();if(e.bDeferLoading)e.bDeferLoading=!1,e.iDraw++,b(e,!1);else if(a){if(!e.bDestroying&&!Se(e))return}else e.iDraw++;if(0!==l.length)for(var u=a?e.aoData.length:c,d=a?0:s;d<u;d++){var h,p=l[d],f=e.aoData[p],g=(null===f.nTr&&me(e,p),f.nTr);0!==o&&(h=i[n%o],f._sRowStripe!=h)&&(k(g).removeClass(f._sRowStripe).addClass(h),f._sRowStripe=h),I(e,"aoRowCallback",null,[g,f._aData,n,d,p]),r.push(g),n++}else{a=t.sZeroRecords;1==e.iDraw&&"ajax"==M(e)?a=t.sLoadingRecords:t.sEmptyTable&&0===e.fnRecordsTotal()&&(a=t.sEmptyTable),r[0]=k("<tr/>",{class:o?i[0]:""}).append(k("<td />",{valign:"top",colSpan:_(e),class:e.oClasses.sRowEmpty}).html(a))[0]}I(e,"aoHeaderCallback","header",[k(e.nTHead).children("tr")[0],de(e),s,c,l]),I(e,"aoFooterCallback","footer",[k(e.nTFoot).children("tr")[0],de(e),s,c,l]);t=k(e.nTBody);t.children().detach(),t.append(k(r)),I(e,"aoDrawCallback","draw",[e]),e.bSorted=!1,e.bFiltered=!1,e.bDrawing=!1}}function c(e,t){var r=e.oFeatures,n=r.bSort,r=r.bFilter;n&&it(e),r?Ne(e,e.oPreviousSearch):e.aiDisplay=e.aiDisplayMaster.slice(),!0!==t&&(e._iDisplayStart=0),e._drawHold=t,g(e),e._drawHold=!1}function we(e){for(var t,r,n,i,o,s,a,l=e.oClasses,c=k(e.nTable),c=k("<div/>").insertBefore(c),u=e.oFeatures,d=k("<div/>",{id:e.sTableId+"_wrapper",class:l.sWrapper+(e.nTFoot?"":" "+l.sNoFooter)}),h=(e.nHolding=c[0],e.nTableWrapper=d[0],e.nTableReinsertBefore=e.nTable.nextSibling,e.sDom.split("")),p=0;p<h.length;p++){if(t=null,"<"==(r=h[p])){if(n=k("<div/>")[0],"'"==(i=h[p+1])||'"'==i){for(o="",s=2;h[p+s]!=i;)o+=h[p+s],s++;"H"==o?o=l.sJUIHeader:"F"==o&&(o=l.sJUIFooter),-1!=o.indexOf(".")?(a=o.split("."),n.id=a[0].substr(1,a[0].length-1),n.className=a[1]):"#"==o.charAt(0)?n.id=o.substr(1,o.length-1):n.className=o,p+=s}d.append(n),d=k(n)}else if(">"==r)d=d.parent();else if("l"==r&&u.bPaginate&&u.bLengthChange)t=Ye(e);else if("f"==r&&u.bFilter)t=Ae(e);else if("r"==r&&u.bProcessing)t=Ke(e);else if("t"==r)t=Xe(e);else if("i"==r&&u.bInfo)t=Ve(e);else if("p"==r&&u.bPaginate)t=Ge(e);else if(0!==T.ext.feature.length)for(var f=T.ext.feature,g=0,m=f.length;g<m;g++)if(r==f[g].cFeature){t=f[g].fnInit(e);break}t&&((a=e.aanFeatures)[r]||(a[r]=[]),a[r].push(t),d.append(t))}c.replaceWith(d),e.nHolding=null}function Ce(e,t){var r,n,i,o,s,a,l,c,u,d,h=k(t).children("tr");for(e.splice(0,e.length),i=0,a=h.length;i<a;i++)e.push([]);for(i=0,a=h.length;i<a;i++)for(n=(r=h[i]).firstChild;n;){if("TD"==n.nodeName.toUpperCase()||"TH"==n.nodeName.toUpperCase())for(c=(c=+n.getAttribute("colspan"))&&0!=c&&1!=c?c:1,u=(u=+n.getAttribute("rowspan"))&&0!=u&&1!=u?u:1,l=function(e,t,r){for(var n=e[t];n[r];)r++;return r}(e,i,0),d=1==c,s=0;s<c;s++)for(o=0;o<u;o++)e[i+o][l+s]={cell:n,unique:d},e[i+o].nTr=r;n=n.nextSibling}}function Ee(e,t,r){var n=[];r||(r=e.aoHeader,t&&Ce(r=[],t));for(var i=0,o=r.length;i<o;i++)for(var s=0,a=r[i].length;s<a;s++)!r[i][s].unique||n[s]&&e.bSortCellsTop||(n[s]=r[i][s].cell);return n}function Te(i,e,t){function r(e){I(i,null,"xhr",[i,e,i.jqXHR]),t(e)}I(i,"aoServerParams","serverParams",[e]),e&&Array.isArray(e)&&(n={},o=/(.*?)\[\]$/,k.each(e,function(e,t){var r=t.name.match(o);r?(r=r[0],n[r]||(n[r]=[]),n[r].push(t.value)):n[t.name]=t.value}),e=n);var n,o,s,a=i.ajax,l=i.oInstance,c=(k.isPlainObject(a)&&a.data&&(c="function"==typeof(s=a.data)?s(e,i):s,e="function"==typeof s&&c?c:k.extend(!0,e,c),delete a.data),{data:e,success:function(e){var t=e.error||e.sError;t&&V(i,0,t),i.json=e,r(e)},dataType:"json",cache:!1,type:i.sServerMethod,error:function(e,t,r){var n=I(i,null,"xhr",[i,null,i.jqXHR]);-1===k.inArray(!0,n)&&("parsererror"==t?V(i,0,"Invalid JSON response",1):4===e.readyState&&V(i,0,"Ajax error",7)),b(i,!1)}});i.oAjaxData=e,I(i,null,"preXhr",[i,e]),i.fnServerData?i.fnServerData.call(l,i.sAjaxSource,k.map(e,function(e,t){return{name:t,value:e}}),r,i):i.sAjaxSource||"string"==typeof a?i.jqXHR=k.ajax(k.extend(c,{url:a||i.sAjaxSource})):"function"==typeof a?i.jqXHR=a.call(l,e,r,i):(i.jqXHR=k.ajax(k.extend(c,a)),a.data=s)}function Se(t){return!t.bAjaxDataGet||(t.iDraw++,b(t,!0),Te(t,_e(t),function(e){xe(t,e)}),!1)}function _e(e){for(var t,r,n,i=e.aoColumns,o=i.length,s=e.oFeatures,a=e.oPreviousSearch,l=e.aoPreSearchCols,c=[],u=A(e),d=e._iDisplayStart,h=!1!==s.bPaginate?e._iDisplayLength:-1,p=function(e,t){c.push({name:e,value:t})},f=(p("sEcho",e.iDraw),p("iColumns",o),p("sColumns",P(i,"sName").join(",")),p("iDisplayStart",d),p("iDisplayLength",h),{draw:e.iDraw,columns:[],order:[],start:d,length:h,search:{value:a.sSearch,regex:a.bRegex}}),g=0;g<o;g++)r=i[g],n=l[g],t="function"==typeof r.mData?"function":r.mData,f.columns.push({data:t,name:r.sName,searchable:r.bSearchable,orderable:r.bSortable,search:{value:n.sSearch,regex:n.bRegex}}),p("mDataProp_"+g,t),s.bFilter&&(p("sSearch_"+g,n.sSearch),p("bRegex_"+g,n.bRegex),p("bSearchable_"+g,r.bSearchable)),s.bSort&&p("bSortable_"+g,r.bSortable);s.bFilter&&(p("sSearch",a.sSearch),p("bRegex",a.bRegex)),s.bSort&&(k.each(u,function(e,t){f.order.push({column:t.col,dir:t.dir}),p("iSortCol_"+e,t.col),p("sSortDir_"+e,t.dir)}),p("iSortingCols",u.length));d=T.ext.legacy.ajax;return null===d?e.sAjaxSource?c:f:d?c:f}function xe(e,r){function t(e,t){return r[e]!==D?r[e]:r[t]}var n=Re(e,r),i=t("sEcho","draw"),o=t("iTotalRecords","recordsTotal"),s=t("iTotalDisplayRecords","recordsFiltered");if(i!==D){if(+i<e.iDraw)return;e.iDraw=+i}he(e),e._iRecordsTotal=parseInt(o,10),e._iRecordsDisplay=parseInt(s,10);for(var a=0,l=n.length;a<l;a++)x(e,n[a]);e.aiDisplay=e.aiDisplayMaster.slice(),e.bAjaxDataGet=!1,g(e),e._bInitComplete||je(e,r),e.bAjaxDataGet=!0,b(e,!1)}function Re(e,t){e=k.isPlainObject(e.ajax)&&e.ajax.dataSrc!==D?e.ajax.dataSrc:e.sAjaxDataProp;return"data"===e?t.aaData||t[e]:""!==e?R(e)(t):t}function Ae(r){function t(){s.f;var e=this.value||"";e!=o.sSearch&&(Ne(r,{sSearch:e,bRegex:o.bRegex,bSmart:o.bSmart,bCaseInsensitive:o.bCaseInsensitive}),r._iDisplayStart=0,g(r))}var e=r.oClasses,n=r.sTableId,i=r.oLanguage,o=r.oPreviousSearch,s=r.aanFeatures,a='<input type="search" class="'+e.sFilterInput+'"/>',l=(l=i.sSearch).match(/_INPUT_/)?l.replace("_INPUT_",a):l+a,a=k("<div/>",{id:s.f?null:n+"_filter",class:e.sFilter}).append(k("<label/>").append(l)),e=null!==r.searchDelay?r.searchDelay:"ssp"===M(r)?400:0,c=k("input",a).val(o.sSearch).attr("placeholder",i.sSearchPlaceholder).on("keyup.DT search.DT input.DT paste.DT cut.DT",e?et(t,e):t).on("mouseup",function(e){setTimeout(function(){t.call(c[0])},10)}).on("keypress.DT",function(e){if(13==e.keyCode)return!1}).attr("aria-controls",n);return k(r.nTable).on("search.dt.DT",function(e,t){if(r===t)try{c[0]!==w.activeElement&&c.val(o.sSearch)}catch(e){}}),a[0]}function Ne(e,t,r){function n(e){o.sSearch=e.sSearch,o.bRegex=e.bRegex,o.bSmart=e.bSmart,o.bCaseInsensitive=e.bCaseInsensitive}function i(e){return e.bEscapeRegex!==D?!e.bEscapeRegex:e.bRegex}var o=e.oPreviousSearch,s=e.aoPreSearchCols;if(oe(e),"ssp"!=M(e)){Me(e,t.sSearch,r,i(t),t.bSmart,t.bCaseInsensitive),n(t);for(var a=0;a<s.length;a++)Ie(e,s[a].sSearch,a,i(s[a]),s[a].bSmart,s[a].bCaseInsensitive);Oe(e)}else n(t);e.bFiltered=!0,I(e,null,"search",[e])}function Oe(e){for(var t,r,n=T.ext.search,i=e.aiDisplay,o=0,s=n.length;o<s;o++){for(var a=[],l=0,c=i.length;l<c;l++)r=i[l],t=e.aoData[r],n[o](e,t._aFilterData,r,t._aData,l)&&a.push(r);i.length=0,k.merge(i,a)}}function Ie(e,t,r,n,i,o){if(""!==t){for(var s,a=[],l=e.aiDisplay,c=ke(t,n,i,o),u=0;u<l.length;u++)s=e.aoData[l[u]]._aFilterData[r],c.test(s)&&a.push(l[u]);e.aiDisplay=a}}function Me(e,t,r,n,i,o){var s,a,l,c=ke(t,n,i,o),i=e.oPreviousSearch.sSearch,o=e.aiDisplayMaster,u=[];if(0!==T.ext.search.length&&(r=!0),a=Fe(e),t.length<=0)e.aiDisplay=o.slice();else{for((a||r||n||i.length>t.length||0!==t.indexOf(i)||e.bSorted)&&(e.aiDisplay=o.slice()),s=e.aiDisplay,l=0;l<s.length;l++)c.test(e.aoData[s[l]]._sFilterRow)&&u.push(s[l]);e.aiDisplay=u}}function ke(e,t,r,n){return e=t?e:De(e),r&&(e="^(?=.*?"+k.map(e.match(/"[^"]+"|[^ ]+/g)||[""],function(e){var t;return(e='"'===e.charAt(0)?(t=e.match(/^"(.*)"$/))?t[1]:e:e).replace('"',"")}).join(")(?=.*?")+").*$"),new RegExp(e,n?"i":"")}var De=T.util.escapeRegex,Pe=k("<div>")[0],Le=Pe.textContent!==D;function Fe(e){for(var t,r,n,i,o,s,a=e.aoColumns,l=T.ext.type.search,c=!1,u=0,d=e.aoData.length;u<d;u++)if(!(s=e.aoData[u])._aFilterData){for(i=[],r=0,n=a.length;r<n;r++)(t=a[r]).bSearchable?(o=v(e,u,r,"filter"),"string"!=typeof(o=null===(o=l[t.sType]?l[t.sType](o):o)?"":o)&&o.toString&&(o=o.toString())):o="",o.indexOf&&-1!==o.indexOf("&")&&(Pe.innerHTML=o,o=Le?Pe.textContent:Pe.innerText),o.replace&&(o=o.replace(/[\r\n\u2028]/g,"")),i.push(o);s._aFilterData=i,s._sFilterRow=i.join("  "),c=!0}return c}function He(e){return{search:e.sSearch,smart:e.bSmart,regex:e.bRegex,caseInsensitive:e.bCaseInsensitive}}function Ue(e){return{sSearch:e.search,bSmart:e.smart,bRegex:e.regex,bCaseInsensitive:e.caseInsensitive}}function Ve(e){var t=e.sTableId,r=e.aanFeatures.i,n=k("<div/>",{class:e.oClasses.sInfo,id:r?null:t+"_info"});return r||(e.aoDrawCallback.push({fn:We,sName:"information"}),n.attr("role","status").attr("aria-live","polite"),k(e.nTable).attr("aria-describedby",t+"_info")),n[0]}function We(e){var t,r,n,i,o,s,a=e.aanFeatures.i;0!==a.length&&(s=e.oLanguage,t=e._iDisplayStart+1,r=e.fnDisplayEnd(),n=e.fnRecordsTotal(),o=(i=e.fnRecordsDisplay())?s.sInfo:s.sInfoEmpty,i!==n&&(o+=" "+s.sInfoFiltered),o=$e(e,o+=s.sInfoPostFix),null!==(s=s.fnInfoCallback)&&(o=s.call(e.oInstance,e,t,r,n,i,o)),k(a).html(o))}function $e(e,t){var r=e.fnFormatNumber,n=e._iDisplayStart+1,i=e._iDisplayLength,o=e.fnRecordsDisplay(),s=-1===i;return t.replace(/_START_/g,r.call(e,n)).replace(/_END_/g,r.call(e,e.fnDisplayEnd())).replace(/_MAX_/g,r.call(e,e.fnRecordsTotal())).replace(/_TOTAL_/g,r.call(e,o)).replace(/_PAGE_/g,r.call(e,s?1:Math.ceil(n/i))).replace(/_PAGES_/g,r.call(e,s?1:Math.ceil(o/i)))}function Be(r){var n,e,t,i=r.iInitDisplayStart,o=r.aoColumns,s=r.oFeatures,a=r.bDeferLoading;if(r.bInitialised){for(we(r),ve(r),be(r,r.aoHeader),be(r,r.aoFooter),b(r,!0),s.bAutoWidth&&Qe(r),n=0,e=o.length;n<e;n++)(t=o[n]).sWidth&&(t.nTh.style.width=U(t.sWidth));I(r,null,"preInit",[r]),c(r);s=M(r);"ssp"==s&&!a||("ajax"==s?Te(r,[],function(e){var t=Re(r,e);for(n=0;n<t.length;n++)x(r,t[n]);r.iInitDisplayStart=i,c(r),b(r,!1),je(r,e)}):(b(r,!1),je(r)))}else setTimeout(function(){Be(r)},200)}function je(e,t){e._bInitComplete=!0,(t||e.oInit.aaData)&&L(e),I(e,null,"plugin-init",[e,t]),I(e,"aoInitComplete","init",[e,t])}function ze(e,t){t=parseInt(t,10);e._iDisplayLength=t,gt(e),I(e,null,"length",[e,t])}function Ye(n){for(var e=n.oClasses,t=n.sTableId,r=n.aLengthMenu,i=Array.isArray(r[0]),o=i?r[0]:r,s=i?r[1]:r,a=k("<select/>",{name:t+"_length","aria-controls":t,class:e.sLengthSelect}),l=0,c=o.length;l<c;l++)a[0][l]=new Option("number"==typeof s[l]?n.fnFormatNumber(s[l]):s[l],o[l]);var u=k("<div><label/></div>").addClass(e.sLength);return n.aanFeatures.l||(u[0].id=t+"_length"),u.children().append(n.oLanguage.sLengthMenu.replace("_MENU_",a[0].outerHTML)),k("select",u).val(n._iDisplayLength).on("change.DT",function(e){ze(n,k(this).val()),g(n)}),k(n.nTable).on("length.dt.DT",function(e,t,r){n===t&&k("select",u).val(r)}),u[0]}function Ge(e){function u(e){g(e)}var t=e.sPaginationType,d=T.ext.pager[t],h="function"==typeof d,t=k("<div/>").addClass(e.oClasses.sPaging+t)[0],p=e.aanFeatures;return h||d.fnInit(e,t,u),p.p||(t.id=e.sTableId+"_paginate",e.aoDrawCallback.push({fn:function(e){if(h)for(var t=e._iDisplayStart,r=e._iDisplayLength,n=e.fnRecordsDisplay(),i=-1===r,o=i?0:Math.ceil(t/r),s=i?1:Math.ceil(n/r),a=d(o,s),l=0,c=p.p.length;l<c;l++)mt(e,"pageButton")(e,p.p[l],l,a,o,s);else d.fnUpdate(e,u)},sName:"pagination"})),t}function qe(e,t,r){var n=e._iDisplayStart,i=e._iDisplayLength,o=e.fnRecordsDisplay(),o=(0===o||-1===i?n=0:"number"==typeof t?o<(n=t*i)&&(n=0):"first"==t?n=0:"previous"==t?(n=0<=i?n-i:0)<0&&(n=0):"next"==t?n+i<o&&(n+=i):"last"==t?n=Math.floor((o-1)/i)*i:V(e,0,"Unknown paging action: "+t,5),e._iDisplayStart!==n);return e._iDisplayStart=n,o&&(I(e,null,"page",[e]),r)&&g(e),o}function Ke(e){return k("<div/>",{id:e.aanFeatures.r?null:e.sTableId+"_processing",class:e.oClasses.sProcessing}).html(e.oLanguage.sProcessing).insertBefore(e.nTable)[0]}function b(e,t){e.oFeatures.bProcessing&&k(e.aanFeatures.r).css("display",t?"block":"none"),I(e,null,"processing",[e,t])}function Xe(e){var t,r,n,i,o,s,a,l,c,u,d,h,p=k(e.nTable),f=(p.attr("role","grid"),e.oScroll);return""===f.sX&&""===f.sY?e.nTable:(t=f.sX,r=f.sY,n=e.oClasses,o=(i=p.children("caption")).length?i[0]._captionSide:null,l=k(p[0].cloneNode(!1)),s=k(p[0].cloneNode(!1)),c=function(e){return e?U(e):null},(a=p.children("tfoot")).length||(a=null),l=k(d="<div/>",{class:n.sScrollWrapper}).append(k(d,{class:n.sScrollHead}).css({overflow:"hidden",position:"relative",border:0,width:t?c(t):"100%"}).append(k(d,{class:n.sScrollHeadInner}).css({"box-sizing":"content-box",width:f.sXInner||"100%"}).append(l.removeAttr("id").css("margin-left",0).append("top"===o?i:null).append(p.children("thead"))))).append(k(d,{class:n.sScrollBody}).css({position:"relative",overflow:"auto",width:c(t)}).append(p)),a&&l.append(k(d,{class:n.sScrollFoot}).css({overflow:"hidden",border:0,width:t?c(t):"100%"}).append(k(d,{class:n.sScrollFootInner}).append(s.removeAttr("id").css("margin-left",0).append("bottom"===o?i:null).append(p.children("tfoot"))))),c=l.children(),u=c[0],d=c[1],h=a?c[2]:null,t&&k(d).on("scroll.DT",function(e){var t=this.scrollLeft;u.scrollLeft=t,a&&(h.scrollLeft=t)}),k(d).css("max-height",r),f.bCollapse||k(d).css("height",r),e.nScrollHead=u,e.nScrollBody=d,e.nScrollFoot=h,e.aoDrawCallback.push({fn:Je,sName:"scrolling"}),l[0])}function Je(r){function e(e){(e=e.style).paddingTop="0",e.paddingBottom="0",e.borderTopWidth="0",e.borderBottomWidth="0",e.height=0}var t,n,i,o,s,a=r.oScroll,l=a.sX,c=a.sXInner,u=a.sY,a=a.iBarWidth,d=k(r.nScrollHead),h=d[0].style,p=d.children("div"),f=p[0].style,p=p.children("table"),g=r.nScrollBody,m=k(g),y=g.style,v=k(r.nScrollFoot).children("div"),b=v.children("table"),w=k(r.nTHead),C=k(r.nTable),E=C[0],T=E.style,S=r.nTFoot?k(r.nTFoot):null,_=r.oBrowser,x=_.bScrollOversize,R=P(r.aoColumns,"nTh"),A=[],N=[],O=[],I=[],M=g.scrollHeight>g.clientHeight;r.scrollBarVis!==M&&r.scrollBarVis!==D?(r.scrollBarVis=M,L(r)):(r.scrollBarVis=M,C.children("thead, tfoot").remove(),S&&(M=S.clone().prependTo(C),s=S.find("tr"),n=M.find("tr")),M=w.clone().prependTo(C),w=w.find("tr"),t=M.find("tr"),M.find("th, td").removeAttr("tabindex"),l||(y.width="100%",d[0].style.width="100%"),k.each(Ee(r,M),function(e,t){i=F(r,e),t.style.width=r.aoColumns[i].sWidth}),S&&H(function(e){e.style.width=""},n),d=C.outerWidth(),""===l?(T.width="100%",x&&(C.find("tbody").height()>g.offsetHeight||"scroll"==m.css("overflow-y"))&&(T.width=U(C.outerWidth()-a)),d=C.outerWidth()):""!==c&&(T.width=U(c),d=C.outerWidth()),H(e,t),H(function(e){O.push(e.innerHTML),A.push(U(k(e).css("width")))},t),H(function(e,t){-1!==k.inArray(e,R)&&(e.style.width=A[t])},w),k(t).height(0),S&&(H(e,n),H(function(e){I.push(e.innerHTML),N.push(U(k(e).css("width")))},n),H(function(e,t){e.style.width=N[t]},s),k(n).height(0)),H(function(e,t){e.innerHTML='<div class="dataTables_sizing">'+O[t]+"</div>",e.childNodes[0].style.height="0",e.childNodes[0].style.overflow="hidden",e.style.width=A[t]},t),S&&H(function(e,t){e.innerHTML='<div class="dataTables_sizing">'+I[t]+"</div>",e.childNodes[0].style.height="0",e.childNodes[0].style.overflow="hidden",e.style.width=N[t]},n),C.outerWidth()<d?(o=g.scrollHeight>g.offsetHeight||"scroll"==m.css("overflow-y")?d+a:d,x&&(g.scrollHeight>g.offsetHeight||"scroll"==m.css("overflow-y"))&&(T.width=U(o-a)),""!==l&&""===c||V(r,1,"Possible column misalignment",6)):o="100%",y.width=U(o),h.width=U(o),S&&(r.nScrollFoot.style.width=U(o)),u||x&&(y.height=U(E.offsetHeight+a)),M=C.outerWidth(),p[0].style.width=U(M),f.width=U(M),w=C.height()>g.clientHeight||"scroll"==m.css("overflow-y"),f[s="padding"+(_.bScrollbarLeft?"Left":"Right")]=w?a+"px":"0px",S&&(b[0].style.width=U(M),v[0].style.width=U(M),v[0].style[s]=w?a+"px":"0px"),C.children("colgroup").insertBefore(C.children("thead")),m.trigger("scroll"),!r.bSorted&&!r.bFiltered||r._drawHold||(g.scrollTop=0))}function H(e,t,r){for(var n,i,o=0,s=0,a=t.length;s<a;){for(n=t[s].firstChild,i=r?r[s].firstChild:null;n;)1===n.nodeType&&(r?e(n,i,o):e(n,o),o++),n=n.nextSibling,i=r?i.nextSibling:null;s++}}var Ze=/<.*?>/g;function Qe(e){var t,r,n=e.nTable,i=e.aoColumns,o=e.oScroll,s=o.sY,a=o.sX,o=o.sXInner,l=i.length,c=ie(e,"bVisible"),u=k("th",e.nTHead),d=n.getAttribute("width"),h=n.parentNode,p=!1,f=e.oBrowser,g=f.bScrollOversize,m=n.style.width;for(m&&-1!==m.indexOf("%")&&(d=m),C=0;C<c.length;C++)null!==(t=i[c[C]]).sWidth&&(t.sWidth=tt(t.sWidthOrig,h),p=!0);if(g||!p&&!a&&!s&&l==_(e)&&l==u.length)for(C=0;C<l;C++){var y=F(e,C);null!==y&&(i[y].sWidth=U(u.eq(C).width()))}else{var m=k(n).clone().css("visibility","hidden").removeAttr("id"),v=(m.find("tbody tr").remove(),k("<tr/>").appendTo(m.find("tbody")));for(m.find("thead, tfoot").remove(),m.append(k(e.nTHead).clone()).append(k(e.nTFoot).clone()),m.find("tfoot th, tfoot td").css("width",""),u=Ee(e,m.find("thead")[0]),C=0;C<c.length;C++)t=i[c[C]],u[C].style.width=null!==t.sWidthOrig&&""!==t.sWidthOrig?U(t.sWidthOrig):"",t.sWidthOrig&&a&&k(u[C]).append(k("<div/>").css({width:t.sWidthOrig,margin:0,padding:0,border:0,height:1}));if(e.aoData.length)for(C=0;C<c.length;C++)t=i[r=c[C]],k(rt(e,r)).clone(!1).append(t.sContentPadding).appendTo(v);k("[name]",m).removeAttr("name");for(var b=k("<div/>").css(a||s?{position:"absolute",top:0,left:0,height:1,right:0,overflow:"hidden"}:{}).append(m).appendTo(h),w=(a&&o?m.width(o):a?(m.css("width","auto"),m.removeAttr("width"),m.width()<h.clientWidth&&d&&m.width(h.clientWidth)):s?m.width(h.clientWidth):d&&m.width(d),0),C=0;C<c.length;C++){var E=k(u[C]),T=E.outerWidth()-E.width(),E=f.bBounding?Math.ceil(u[C].getBoundingClientRect().width):E.outerWidth();w+=E,i[c[C]].sWidth=U(E-T)}n.style.width=U(w),b.remove()}d&&(n.style.width=U(d)),!d&&!a||e._reszEvt||(o=function(){k($).on("resize.DT-"+e.sInstance,et(function(){L(e)}))},g?setTimeout(o,1e3):o(),e._reszEvt=!0)}var et=T.util.throttle;function tt(e,t){return e?(t=(e=k("<div/>").css("width",U(e)).appendTo(t||w.body))[0].offsetWidth,e.remove(),t):0}function rt(e,t){var r,n=nt(e,t);return n<0?null:(r=e.aoData[n]).nTr?r.anCells[t]:k("<td/>").html(v(e,n,t,"display"))[0]}function nt(e,t){for(var r,n=-1,i=-1,o=0,s=e.aoData.length;o<s;o++)(r=(r=(r=v(e,o,t,"display")+"").replace(Ze,"")).replace(/&nbsp;/g," ")).length>n&&(n=r.length,i=o);return i}function U(e){return null===e?"0px":"number"==typeof e?e<0?"0px":e+"px":e.match(/\d$/)?e+"px":e}function A(e){function t(e){e.length&&!Array.isArray(e[0])?p.push(e):k.merge(p,e)}var r,n,i,o,s,a,l,c=[],u=e.aoColumns,d=e.aaSortingFixed,h=k.isPlainObject(d),p=[];for(Array.isArray(d)&&t(d),h&&d.pre&&t(d.pre),t(e.aaSorting),h&&d.post&&t(d.post),r=0;r<p.length;r++)for(i=(o=u[l=p[r][n=0]].aDataSort).length;n<i;n++)a=u[s=o[n]].sType||"string",p[r]._idx===D&&(p[r]._idx=k.inArray(p[r][1],u[s].asSorting)),c.push({src:l,col:s,dir:p[r][1],index:p[r]._idx,type:a,formatter:T.ext.type.order[a+"-pre"]});return c}function it(e){var t,r,n,i,u,d=[],c=T.ext.type.order,h=e.aoData,o=(e.aoColumns,0),s=e.aiDisplayMaster;for(oe(e),t=0,r=(u=A(e)).length;t<r;t++)(i=u[t]).formatter&&o++,ct(e,i.col);if("ssp"!=M(e)&&0!==u.length){for(t=0,n=s.length;t<n;t++)d[s[t]]=t;o===u.length?s.sort(function(e,t){for(var r,n,i,o,s=u.length,a=h[e]._aSortData,l=h[t]._aSortData,c=0;c<s;c++)if(0!=(i=(r=a[(o=u[c]).col])<(n=l[o.col])?-1:n<r?1:0))return"asc"===o.dir?i:-i;return(r=d[e])<(n=d[t])?-1:n<r?1:0}):s.sort(function(e,t){for(var r,n,i,o=u.length,s=h[e]._aSortData,a=h[t]._aSortData,l=0;l<o;l++)if(r=s[(i=u[l]).col],n=a[i.col],0!==(i=(c[i.type+"-"+i.dir]||c["string-"+i.dir])(r,n)))return i;return(r=d[e])<(n=d[t])?-1:n<r?1:0})}e.bSorted=!0}function ot(e){for(var t=e.aoColumns,r=A(e),n=e.oLanguage.oAria,i=0,o=t.length;i<o;i++){var s=t[i],a=s.asSorting,l=s.sTitle.replace(/<.*?>/g,""),c=s.nTh;c.removeAttribute("aria-sort"),s=s.bSortable?l+("asc"===(0<r.length&&r[0].col==i&&(c.setAttribute("aria-sort","asc"==r[0].dir?"ascending":"descending"),a[r[0].index+1])||a[0])?n.sSortAscending:n.sSortDescending):l,c.setAttribute("aria-label",s)}}function st(e,t,r,n){function i(e,t){var r=e._idx;return(r=r===D?k.inArray(e[1],l):r)+1<l.length?r+1:t?null:0}var o,s=e.aoColumns[t],a=e.aaSorting,l=s.asSorting;"number"==typeof a[0]&&(a=e.aaSorting=[a]),r&&e.oFeatures.bSortMulti?-1!==(s=k.inArray(t,P(a,"0")))?null===(o=null===(o=i(a[s],!0))&&1===a.length?0:o)?a.splice(s,1):(a[s][1]=l[o],a[s]._idx=o):(a.push([t,l[0],0]),a[a.length-1]._idx=0):a.length&&a[0][0]==t?(o=i(a[0]),a.length=1,a[0][1]=l[o],a[0]._idx=o):(a.length=0,a.push([t,l[0]]),a[0]._idx=0),c(e),"function"==typeof n&&n(e)}function at(t,e,r,n){var i=t.aoColumns[r];ft(e,{},function(e){!1!==i.bSortable&&(t.oFeatures.bProcessing?(b(t,!0),setTimeout(function(){st(t,r,e.shiftKey,n),"ssp"!==M(t)&&b(t,!1)},0)):st(t,r,e.shiftKey,n))})}function lt(e){var t,r,n,i=e.aLastSort,o=e.oClasses.sSortColumn,s=A(e),a=e.oFeatures;if(a.bSort&&a.bSortClasses){for(t=0,r=i.length;t<r;t++)n=i[t].src,k(P(e.aoData,"anCells",n)).removeClass(o+(t<2?t+1:3));for(t=0,r=s.length;t<r;t++)n=s[t].src,k(P(e.aoData,"anCells",n)).addClass(o+(t<2?t+1:3))}e.aLastSort=s}function ct(e,t){for(var r,n,i,o=e.aoColumns[t],s=T.ext.order[o.sSortDataType],a=(s&&(r=s.call(e.oInstance,e,t,u(e,t))),T.ext.type.order[o.sType+"-pre"]),l=0,c=e.aoData.length;l<c;l++)(n=e.aoData[l])._aSortData||(n._aSortData=[]),n._aSortData[t]&&!s||(i=s?r[l]:v(e,l,t,"sort"),n._aSortData[t]=a?a(i):i)}function ut(r){var e;r.oFeatures.bStateSave&&!r.bDestroying&&(e={time:+new Date,start:r._iDisplayStart,length:r._iDisplayLength,order:k.extend(!0,[],r.aaSorting),search:He(r.oPreviousSearch),columns:k.map(r.aoColumns,function(e,t){return{visible:e.bVisible,search:He(r.aoPreSearchCols[t])}})},I(r,"aoStateSaveParams","stateSaveParams",[r,e]),r.oSavedState=e,r.fnStateSaveCallback.call(r.oInstance,r,e))}function dt(n,e,i){function t(e){if(e&&e.time){var t=I(n,"aoStateLoadParams","stateLoadParams",[n,e]);if(-1===k.inArray(!1,t)){t=n.iStateDuration;if(!(0<t&&e.time<+new Date-1e3*t||e.columns&&a.length!==e.columns.length)){if(n.oLoadedState=k.extend(!0,{},e),e.start!==D&&(n._iDisplayStart=e.start,n.iInitDisplayStart=e.start),e.length!==D&&(n._iDisplayLength=e.length),e.order!==D&&(n.aaSorting=[],k.each(e.order,function(e,t){n.aaSorting.push(t[0]>=a.length?[0,t[1]]:t)})),e.search!==D&&k.extend(n.oPreviousSearch,Ue(e.search)),e.columns)for(o=0,s=e.columns.length;o<s;o++){var r=e.columns[o];r.visible!==D&&(a[o].bVisible=r.visible),r.search!==D&&k.extend(n.aoPreSearchCols[o],Ue(r.search))}I(n,"aoStateLoaded","stateLoaded",[n,e])}}}i()}var o,s,r,a=n.aoColumns;n.oFeatures.bStateSave?(r=n.fnStateLoadCallback.call(n.oInstance,n,t))!==D&&t(r):i()}function ht(e){var t=T.settings,e=k.inArray(e,P(t,"nTable"));return-1!==e?t[e]:null}function V(e,t,r,n){if(r="DataTables warning: "+(e?"table id="+e.sTableId+" - ":"")+r,n&&(r+=". For more information about this error, please see http://datatables.net/tn/"+n),t)$.console&&console.log&&console.log(r);else{t=T.ext,t=t.sErrMode||t.errMode;if(e&&I(e,null,"error",[e,n,r]),"alert"==t)alert(r);else{if("throw"==t)throw new Error(r);"function"==typeof t&&t(e,n,r)}}}function N(r,n,e,t){Array.isArray(e)?k.each(e,function(e,t){Array.isArray(t)?N(r,n,t[0],t[1]):N(r,n,t)}):(t===D&&(t=e),n[e]!==D&&(r[t]=n[e]))}function pt(e,t,r){var n,i;for(i in t)t.hasOwnProperty(i)&&(n=t[i],k.isPlainObject(n)?(k.isPlainObject(e[i])||(e[i]={}),k.extend(!0,e[i],n)):r&&"data"!==i&&"aaData"!==i&&Array.isArray(n)?e[i]=n.slice():e[i]=n);return e}function ft(t,e,r){k(t).on("click.DT",e,function(e){k(t).trigger("blur"),r(e)}).on("keypress.DT",e,function(e){13===e.which&&(e.preventDefault(),r(e))}).on("selectstart.DT",function(){return!1})}function O(e,t,r,n){r&&e[t].push({fn:r,sName:n})}function I(r,e,t,n){var i=[];return e&&(i=k.map(r[e].slice().reverse(),function(e,t){return e.fn.apply(r.oInstance,n)})),null!==t&&(e=k.Event(t+".dt"),k(r.nTable).trigger(e,n),i.push(e.result)),i}function gt(e){var t=e._iDisplayStart,r=e.fnDisplayEnd(),n=e._iDisplayLength;r<=t&&(t=r-n),t-=t%n,e._iDisplayStart=t=-1===n||t<0?0:t}function mt(e,t){var e=e.renderer,r=T.ext.renderer[t];return k.isPlainObject(e)&&e[t]?r[e[t]]||r._:"string"==typeof e&&r[e]||r._}function M(e){return e.oFeatures.bServerSide?"ssp":e.ajax||e.sAjaxSource?"ajax":"dom"}function yt(e,r){var n;return Array.isArray(e)?k.map(e,function(e){return yt(e,r)}):"number"==typeof e?[r[e]]:(n=k.map(r,function(e,t){return e.nTable}),k(n).filter(e).map(function(e){var t=k.inArray(this,n);return r[t]}).toArray())}function vt(i,o,e){var t,r;e&&(t=new W(i)).one("draw",function(){e(t.ajax.json())}),"ssp"==M(i)?c(i,o):(b(i,!0),(r=i.jqXHR)&&4!==r.readyState&&r.abort(),Te(i,[],function(e){he(i);for(var t=Re(i,e),r=0,n=t.length;r<n;r++)x(i,t[r]);c(i,o),b(i,!1)}))}function bt(e,t,r,n,i){for(var o,s,a,l,c=[],u=typeof t,d=0,h=(t=t&&"string"!=u&&"function"!=u&&t.length!==D?t:[t]).length;d<h;d++)for(a=0,l=(s=t[d]&&t[d].split&&!t[d].match(/[\[\(:]/)?t[d].split(","):[t[d]]).length;a<l;a++)(o=r("string"==typeof s[a]?s[a].trim():s[a]))&&o.length&&(c=c.concat(o));var p=f.selector[e];if(p.length)for(d=0,h=p.length;d<h;d++)c=p[d](n,i,c);return K(c)}function wt(e){return(e=e||{}).filter&&e.search===D&&(e.search=e.filter),k.extend({search:"none",order:"current",page:"all"},e)}function Ct(e){for(var t=0,r=e.length;t<r;t++)if(0<e[t].length)return e[0]=e[t],e[0].length=1,e.length=1,e.context=[e.context[t]],e;return e.length=0,e}function Et(o,e,t,r){function s(e,t){var r;if(Array.isArray(e)||e instanceof k)for(var n=0,i=e.length;n<i;n++)s(e[n],t);else e.nodeName&&"tr"===e.nodeName.toLowerCase()?a.push(e):(r=k("<tr><td></td></tr>").addClass(t),k("td",r).addClass(t).html(e)[0].colSpan=_(o),a.push(r[0]))}var a=[];s(t,r),e._details&&e._details.detach(),e._details=k(a),e._detailsShow&&e._details.insertAfter(e.nTr)}function Tt(e,t){if((r=e.context).length&&e.length){e=r[0].aoData[e[0]];if(e._details){(e._detailsShow=t)?e._details.insertAfter(e.nTr):e._details.detach();var l=r[0],i=new W(l),t=".dt.DT_details",e="draw"+t,r="column-visibility"+t,t="destroy"+t,c=l.aoData;if(i.off(e+" "+r+" "+t),P(c,"_details").length>0){i.on(e,function(e,t){if(l!==t)return;i.rows({page:"current"}).eq(0).each(function(e){var t=c[e];if(t._detailsShow)t._details.insertAfter(t.nTr)})});i.on(r,function(e,t,r,n){if(l!==t)return;var i,o=_(t);for(var s=0,a=c.length;s<a;s++){i=c[s];if(i._details)i._details.children("td[colspan]").attr("colspan",o)}});i.on(t,function(e,t){if(l!==t)return;for(var r=0,n=c.length;r<n;r++)if(c[r]._details)Rt(i,r)})}}}}function St(e,t,r,n,i){for(var o=[],s=0,a=i.length;s<a;s++)o.push(v(e,i[s],t));return o}var _t=[],a=Array.prototype,W=function(e,t){if(!(this instanceof W))return new W(e,t);function r(e){var t,r,n,i;e=e,n=T.settings,i=k.map(n,function(e,t){return e.nTable}),(e=e?e.nTable&&e.oApi?[e]:e.nodeName&&"table"===e.nodeName.toLowerCase()?-1!==(t=k.inArray(e,i))?[n[t]]:null:e&&"function"==typeof e.settings?e.settings().toArray():("string"==typeof e?r=k(e):e instanceof k&&(r=e),r?r.map(function(e){return-1!==(t=k.inArray(this,i))?n[t]:null}).toArray():void 0):[])&&o.push.apply(o,e)}var o=[];if(Array.isArray(e))for(var n=0,i=e.length;n<i;n++)r(e[n]);else r(e);this.context=K(o),t&&k.merge(this,t),this.selector={rows:null,cols:null,opts:null},W.extend(this,this,_t)},xt=(T.Api=W,k.extend(W.prototype,{any:function(){return 0!==this.count()},concat:a.concat,context:[],count:function(){return this.flatten().length},each:function(e){for(var t=0,r=this.length;t<r;t++)e.call(this,this[t],t,this);return this},eq:function(e){var t=this.context;return t.length>e?new W(t[e],this[e]):null},filter:function(e){var t=[];if(a.filter)t=a.filter.call(this,e,this);else for(var r=0,n=this.length;r<n;r++)e.call(this,this[r],r,this)&&t.push(this[r]);return new W(this.context,t)},flatten:function(){var e=[];return new W(this.context,e.concat.apply(e,this.toArray()))},join:a.join,indexOf:a.indexOf||function(e,t){for(var r=t||0,n=this.length;r<n;r++)if(this[r]===e)return r;return-1},iterator:function(e,t,r,n){var i,o,s,a,l,c,u,d,h=[],p=this.context,f=this.selector;for("string"==typeof e&&(n=r,r=t,t=e,e=!1),o=0,s=p.length;o<s;o++){var g=new W(p[o]);if("table"===t)(i=r.call(g,p[o],o))!==D&&h.push(i);else if("columns"===t||"rows"===t)(i=r.call(g,p[o],this[o],o))!==D&&h.push(i);else if("column"===t||"column-rows"===t||"row"===t||"cell"===t)for(u=this[o],"column-rows"===t&&(c=xt(p[o],f.opts)),a=0,l=u.length;a<l;a++)d=u[a],(i="cell"===t?r.call(g,p[o],d.row,d.column,o,a):r.call(g,p[o],d,o,a,c))!==D&&h.push(i)}return h.length||n?((e=(n=new W(p,e?h.concat.apply([],h):h)).selector).rows=f.rows,e.cols=f.cols,e.opts=f.opts,n):this},lastIndexOf:a.lastIndexOf||function(e,t){return this.indexOf.apply(this.toArray.reverse(),arguments)},length:0,map:function(e){var t=[];if(a.map)t=a.map.call(this,e,this);else for(var r=0,n=this.length;r<n;r++)t.push(e.call(this,this[r],r));return new W(this.context,t)},pluck:function(t){return this.map(function(e){return e[t]})},pop:a.pop,push:a.push,reduce:a.reduce||function(e,t){return te(this,e,t,0,this.length,1)},reduceRight:a.reduceRight||function(e,t){return te(this,e,t,this.length-1,-1,-1)},reverse:a.reverse,selector:null,shift:a.shift,slice:function(){return new W(this.context,this)},sort:a.sort,splice:a.splice,toArray:function(){return a.slice.call(this)},to$:function(){return k(this)},toJQuery:function(){return k(this)},unique:function(){return new W(this.context,K(this))},unshift:a.unshift}),W.extend=function(e,t,r){if(r.length&&t&&(t instanceof W||t.__dt_wrapper))for(var n,i=0,o=r.length;i<o;i++)t[(n=r[i]).name]="function"===n.type?function(t,r,n){return function(){var e=r.apply(t,arguments);return W.extend(e,e,n.methodExt),e}}(e,n.val,n):"object"===n.type?{}:n.val,t[n.name].__dt_wrapper=!0,W.extend(e,t[n.name],n.propExt)},W.register=t=function(e,t){if(Array.isArray(e))for(var r=0,n=e.length;r<n;r++)W.register(e[r],t);else for(var i=e.split("."),o=_t,s=0,a=i.length;s<a;s++){var l,c,u=function(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r].name===t)return e[r];return null}(o,c=(l=-1!==i[s].indexOf("()"))?i[s].replace("()",""):i[s]);u||o.push(u={name:c,val:{},methodExt:[],propExt:[],type:"object"}),s===a-1?(u.val=t,u.type="function"==typeof t?"function":k.isPlainObject(t)?"object":"other"):o=l?u.methodExt:u.propExt}},W.registerPlural=e=function(e,t,r){W.register(e,r),W.register(t,function(){var e=r.apply(this,arguments);return e===this?this:e instanceof W?e.length?Array.isArray(e[0])?new W(e.context,e[0]):e[0]:D:e})},t("tables()",function(e){return e!==D&&null!==e?new W(yt(e,this.context)):this}),t("table()",function(e){var e=this.tables(e),t=e.context;return t.length?new W(t[0]):e}),e("tables().nodes()","table().node()",function(){return this.iterator("table",function(e){return e.nTable},1)}),e("tables().body()","table().body()",function(){return this.iterator("table",function(e){return e.nTBody},1)}),e("tables().header()","table().header()",function(){return this.iterator("table",function(e){return e.nTHead},1)}),e("tables().footer()","table().footer()",function(){return this.iterator("table",function(e){return e.nTFoot},1)}),e("tables().containers()","table().container()",function(){return this.iterator("table",function(e){return e.nTableWrapper},1)}),t("draw()",function(t){return this.iterator("table",function(e){"page"===t?g(e):c(e,!1===(t="string"==typeof t?"full-hold"!==t:t))})}),t("page()",function(t){return t===D?this.page.info().page:this.iterator("table",function(e){qe(e,t)})}),t("page.info()",function(e){var t,r,n,i,o;return 0===this.context.length?D:(r=(t=this.context[0])._iDisplayStart,n=t.oFeatures.bPaginate?t._iDisplayLength:-1,i=t.fnRecordsDisplay(),{page:(o=-1===n)?0:Math.floor(r/n),pages:o?1:Math.ceil(i/n),start:r,end:t.fnDisplayEnd(),length:n,recordsTotal:t.fnRecordsTotal(),recordsDisplay:i,serverSide:"ssp"===M(t)})}),t("page.len()",function(t){return t===D?0!==this.context.length?this.context[0]._iDisplayLength:D:this.iterator("table",function(e){ze(e,t)})}),t("ajax.json()",function(){var e=this.context;if(0<e.length)return e[0].json}),t("ajax.params()",function(){var e=this.context;if(0<e.length)return e[0].oAjaxData}),t("ajax.reload()",function(t,r){return this.iterator("table",function(e){vt(e,!1===r,t)})}),t("ajax.url()",function(t){var e=this.context;return t===D?0===e.length?D:(e=e[0]).ajax?k.isPlainObject(e.ajax)?e.ajax.url:e.ajax:e.sAjaxSource:this.iterator("table",function(e){k.isPlainObject(e.ajax)?e.ajax.url=t:e.ajax=t})}),t("ajax.url().load()",function(t,r){return this.iterator("table",function(e){vt(e,!1===r,t)})}),function(e,t){var r,n=[],i=e.aiDisplay,o=e.aiDisplayMaster,s=t.search,a=t.order,t=t.page;if("ssp"==M(e))return"removed"===s?[]:d(0,o.length);if("current"==t)for(c=e._iDisplayStart,u=e.fnDisplayEnd();c<u;c++)n.push(i[c]);else if("current"==a||"applied"==a){if("none"==s)n=o.slice();else if("applied"==s)n=i.slice();else if("removed"==s){for(var l={},c=0,u=i.length;c<u;c++)l[i[c]]=null;n=k.map(o,function(e){return l.hasOwnProperty(e)?null:e})}}else if("index"==a||"original"==a)for(c=0,u=e.aoData.length;c<u;c++)("none"==s||-1===(r=k.inArray(c,i))&&"removed"==s||0<=r&&"applied"==s)&&n.push(c);return n}),Rt=(t("rows()",function(t,r){t===D?t="":k.isPlainObject(t)&&(r=t,t=""),r=wt(r);var e=this.iterator("table",function(e){return bt("row",t,function(r){var e=h(r),n=i.aoData;if(null!==e&&!o)return[e];if(s=s||xt(i,o),null!==e&&-1!==k.inArray(e,s))return[e];if(null===r||r===D||""===r)return s;if("function"==typeof r)return k.map(s,function(e){var t=n[e];return r(e,t._aData,t.nTr)?e:null});if(r.nodeName)return e=r._DT_RowIndex,t=r._DT_CellIndex,e!==D?n[e]&&n[e].nTr===r?[e]:[]:t?n[t.row]&&n[t.row].nTr===r.parentNode?[t.row]:[]:(e=k(r).closest("*[data-dt-row]")).length?[e.data("dt-row")]:[];if("string"==typeof r&&"#"===r.charAt(0)){var t=i.aIds[r.replace(/^#/,"")];if(t!==D)return[t.idx]}e=C(y(i.aoData,s,"nTr"));return k(e).filter(r).map(function(){return this._DT_RowIndex}).toArray()},i=e,o=r);var i,o,s},1);return e.selector.rows=t,e.selector.opts=r,e}),t("rows().nodes()",function(){return this.iterator("row",function(e,t){return e.aoData[t].nTr||D},1)}),t("rows().data()",function(){return this.iterator(!0,"rows",function(e,t){return y(e.aoData,t,"_aData")},1)}),e("rows().cache()","row().cache()",function(r){return this.iterator("row",function(e,t){e=e.aoData[t];return"search"===r?e._aFilterData:e._aSortData},1)}),e("rows().invalidate()","row().invalidate()",function(r){return this.iterator("row",function(e,t){fe(e,t,r)})}),e("rows().indexes()","row().index()",function(){return this.iterator("row",function(e,t){return t},1)}),e("rows().ids()","row().id()",function(e){for(var t=[],r=this.context,n=0,i=r.length;n<i;n++)for(var o=0,s=this[n].length;o<s;o++){var a=r[n].rowIdFn(r[n].aoData[this[n][o]]._aData);t.push((!0===e?"#":"")+a)}return new W(r,t)}),e("rows().remove()","row().remove()",function(){var d=this;return this.iterator("row",function(e,t,r){var n,i,o,s,a,l,c=e.aoData,u=c[t];for(c.splice(t,1),n=0,i=c.length;n<i;n++)if(l=(a=c[n]).anCells,null!==a.nTr&&(a.nTr._DT_RowIndex=n),null!==l)for(o=0,s=l.length;o<s;o++)l[o]._DT_CellIndex.row=n;pe(e.aiDisplayMaster,t),pe(e.aiDisplay,t),pe(d[r],t,!1),0<e._iRecordsDisplay&&e._iRecordsDisplay--,gt(e);r=e.rowIdFn(u._aData);r!==D&&delete e.aIds[r]}),this.iterator("table",function(e){for(var t=0,r=e.aoData.length;t<r;t++)e.aoData[t].idx=t}),this}),t("rows.add()",function(o){var e=this.iterator("table",function(e){for(var t,r=[],n=0,i=o.length;n<i;n++)(t=o[n]).nodeName&&"TR"===t.nodeName.toUpperCase()?r.push(ae(e,t)[0]):r.push(x(e,t));return r},1),t=this.rows(-1);return t.pop(),k.merge(t,e),t}),t("row()",function(e,t){return Ct(this.rows(e,t))}),t("row().data()",function(e){var t,r=this.context;return e===D?r.length&&this.length?r[0].aoData[this[0]]._aData:D:((t=r[0].aoData[this[0]])._aData=e,Array.isArray(e)&&t.nTr&&t.nTr.id&&m(r[0].rowId)(e,t.nTr.id),fe(r[0],this[0],"data"),this)}),t("row().node()",function(){var e=this.context;return e.length&&this.length&&e[0].aoData[this[0]].nTr||null}),t("row.add()",function(t){t instanceof k&&t.length&&(t=t[0]);var e=this.iterator("table",function(e){return t.nodeName&&"TR"===t.nodeName.toUpperCase()?ae(e,t)[0]:x(e,t)});return this.row(e[0])}),function(e,t){var r=e.context;r.length&&(r=r[0].aoData[t!==D?t:e[0]])&&r._details&&(r._details.remove(),r._detailsShow=D,r._details=D)}),At="row().child",Nt=At+"()",Ot=(t(Nt,function(e,t){var r=this.context;return e===D?r.length&&this.length?r[0].aoData[this[0]]._details:D:(!0===e?this.child.show():!1===e?Rt(this):r.length&&this.length&&Et(r[0],r[0].aoData[this[0]],e,t),this)}),t([At+".show()",Nt+".show()"],function(e){return Tt(this,!0),this}),t([At+".hide()",Nt+".hide()"],function(){return Tt(this,!1),this}),t([At+".remove()",Nt+".remove()"],function(){return Rt(this),this}),t(At+".isShown()",function(){var e=this.context;return e.length&&this.length&&e[0].aoData[this[0]]._detailsShow||!1}),/^([^:]+):(name|visIdx|visible)$/),It=(t("columns()",function(r,n){r===D?r="":k.isPlainObject(r)&&(n=r,r=""),n=wt(n);var e=this.iterator("table",function(e){return t=r,a=n,l=(s=e).aoColumns,c=P(l,"sName"),u=P(l,"nTh"),bt("column",t,function(r){var n,e=h(r);if(""===r)return d(l.length);if(null!==e)return[0<=e?e:l.length+e];if("function"==typeof r)return n=xt(s,a),k.map(l,function(e,t){return r(t,St(s,t,0,0,n),u[t])?t:null});var i="string"==typeof r?r.match(Ot):"";if(i)switch(i[2]){case"visIdx":case"visible":var t,o=parseInt(i[1],10);return o<0?[(t=k.map(l,function(e,t){return e.bVisible?t:null}))[t.length+o]]:[F(s,o)];case"name":return k.map(c,function(e,t){return e===i[1]?t:null});default:return[]}return r.nodeName&&r._DT_CellIndex?[r._DT_CellIndex.column]:(e=k(u).filter(r).map(function(){return k.inArray(this,u)}).toArray()).length||!r.nodeName?e:(e=k(r).closest("*[data-dt-column]")).length?[e.data("dt-column")]:[]},s,a);var s,t,a,l,c,u},1);return e.selector.cols=r,e.selector.opts=n,e}),e("columns().header()","column().header()",function(e,t){return this.iterator("column",function(e,t){return e.aoColumns[t].nTh},1)}),e("columns().footer()","column().footer()",function(e,t){return this.iterator("column",function(e,t){return e.aoColumns[t].nTf},1)}),e("columns().data()","column().data()",function(){return this.iterator("column-rows",St,1)}),e("columns().dataSrc()","column().dataSrc()",function(){return this.iterator("column",function(e,t){return e.aoColumns[t].mData},1)}),e("columns().cache()","column().cache()",function(o){return this.iterator("column-rows",function(e,t,r,n,i){return y(e.aoData,i,"search"===o?"_aFilterData":"_aSortData",t)},1)}),e("columns().nodes()","column().nodes()",function(){return this.iterator("column-rows",function(e,t,r,n,i){return y(e.aoData,i,"anCells",t)},1)}),e("columns().visible()","column().visible()",function(d,r){var t=this,e=this.iterator("column",function(e,t){if(d===D)return e.aoColumns[t].bVisible;var r,n,i=t,t=d,o=e.aoColumns,s=o[i],a=e.aoData;if(t===D)s.bVisible;else if(s.bVisible!==t){if(t)for(var l=k.inArray(!0,P(o,"bVisible"),i+1),c=0,u=a.length;c<u;c++)n=a[c].nTr,r=a[c].anCells,n&&n.insertBefore(r[i],r[l]||null);else k(P(e.aoData,"anCells",i)).detach();s.bVisible=t}});return d!==D&&this.iterator("table",function(e){be(e,e.aoHeader),be(e,e.aoFooter),e.aiDisplay.length||k(e.nTBody).find("td[colspan]").attr("colspan",_(e)),ut(e),t.iterator("column",function(e,t){I(e,null,"column-visibility",[e,t,d,r])}),r!==D&&!r||t.columns.adjust()}),e}),e("columns().indexes()","column().index()",function(r){return this.iterator("column",function(e,t){return"visible"===r?u(e,t):t},1)}),t("columns.adjust()",function(){return this.iterator("table",function(e){L(e)},1)}),t("column.index()",function(e,t){var r;if(0!==this.context.length)return r=this.context[0],"fromVisible"===e||"toData"===e?F(r,t):"fromData"===e||"toVisible"===e?u(r,t):void 0}),t("column()",function(e,t){return Ct(this.columns(e,t))}),t("cells()",function(g,e,m){var n,i,o,s,a,l,t;return k.isPlainObject(g)&&(g.row===D?(m=g,g=null):(m=e,e=null)),k.isPlainObject(e)&&(m=e,e=null),null===e||e===D?this.iterator("table",function(e){return n=e,e=g,t=wt(m),d=n.aoData,h=xt(n,t),r=C(y(d,h,"anCells")),p=k(X([],r)),f=n.aoColumns.length,bt("cell",e,function(e){var t,r="function"==typeof e;if(null===e||e===D||r){for(o=[],s=0,a=h.length;s<a;s++)for(i=h[s],l=0;l<f;l++)c={row:i,column:l},(!r||(u=d[i],e(c,v(n,i,l),u.anCells?u.anCells[l]:null)))&&o.push(c);return o}return k.isPlainObject(e)?e.column!==D&&e.row!==D&&-1!==k.inArray(e.row,h)?[e]:[]:(t=p.filter(e).map(function(e,t){return{row:t._DT_CellIndex.row,column:t._DT_CellIndex.column}}).toArray()).length||!e.nodeName?t:(u=k(e).closest("*[data-dt-row]")).length?[{row:u.data("dt-row"),column:u.data("dt-column")}]:[]},n,t);var n,t,i,o,s,a,l,c,u,d,h,r,p,f}):(t=m?{page:m.page,order:m.order,search:m.search}:{},n=this.columns(e,t),i=this.rows(g,t),t=this.iterator("table",function(e,t){var r=[];for(o=0,s=i[t].length;o<s;o++)for(a=0,l=n[t].length;a<l;a++)r.push({row:i[t][o],column:n[t][a]});return r},1),t=m&&m.selected?this.cells(t,m):t,k.extend(t.selector,{cols:e,rows:g,opts:m}),t)}),e("cells().nodes()","cell().node()",function(){return this.iterator("cell",function(e,t,r){e=e.aoData[t];return e&&e.anCells?e.anCells[r]:D},1)}),t("cells().data()",function(){return this.iterator("cell",function(e,t,r){return v(e,t,r)},1)}),e("cells().cache()","cell().cache()",function(n){return n="search"===n?"_aFilterData":"_aSortData",this.iterator("cell",function(e,t,r){return e.aoData[t][n][r]},1)}),e("cells().render()","cell().render()",function(n){return this.iterator("cell",function(e,t,r){return v(e,t,r,n)},1)}),e("cells().indexes()","cell().index()",function(){return this.iterator("cell",function(e,t,r){return{row:t,column:r,columnVisible:u(e,r)}},1)}),e("cells().invalidate()","cell().invalidate()",function(n){return this.iterator("cell",function(e,t,r){fe(e,t,n,r)})}),t("cell()",function(e,t,r){return Ct(this.cells(e,t,r))}),t("cell().data()",function(e){var t=this.context,r=this[0];return e===D?t.length&&r.length?v(t[0],r[0].row,r[0].column):D:(le(t[0],r[0].row,r[0].column,e),fe(t[0],r[0].row,"data",r[0].column),this)}),t("order()",function(t,e){var r=this.context;return t===D?0!==r.length?r[0].aaSorting:D:("number"==typeof t?t=[[t,e]]:t.length&&!Array.isArray(t[0])&&(t=Array.prototype.slice.call(arguments)),this.iterator("table",function(e){e.aaSorting=t.slice()}))}),t("order.listener()",function(t,r,n){return this.iterator("table",function(e){at(e,t,r,n)})}),t("order.fixed()",function(t){var e;return t?this.iterator("table",function(e){e.aaSortingFixed=k.extend(!0,{},t)}):(e=(e=this.context).length?e[0].aaSortingFixed:D,Array.isArray(e)?{pre:e}:e)}),t(["columns().order()","column().order()"],function(n){var i=this;return this.iterator("table",function(e,t){var r=[];k.each(i[t],function(e,t){r.push([t,n])}),e.aaSorting=r})}),t("search()",function(t,r,n,i){var e=this.context;return t===D?0!==e.length?e[0].oPreviousSearch.sSearch:D:this.iterator("table",function(e){e.oFeatures.bFilter&&Ne(e,k.extend({},e.oPreviousSearch,{sSearch:t+"",bRegex:null!==r&&r,bSmart:null===n||n,bCaseInsensitive:null===i||i}),1)})}),e("columns().search()","column().search()",function(n,i,o,s){return this.iterator("column",function(e,t){var r=e.aoPreSearchCols;if(n===D)return r[t].sSearch;e.oFeatures.bFilter&&(k.extend(r[t],{sSearch:n+"",bRegex:null!==i&&i,bSmart:null===o||o,bCaseInsensitive:null===s||s}),Ne(e,e.oPreviousSearch,1))})}),t("state()",function(){return this.context.length?this.context[0].oSavedState:null}),t("state.clear()",function(){return this.iterator("table",function(e){e.fnStateSaveCallback.call(e.oInstance,e,{})})}),t("state.loaded()",function(){return this.context.length?this.context[0].oLoadedState:null}),t("state.save()",function(){return this.iterator("table",function(e){ut(e)})}),T.versionCheck=T.fnVersionCheck=function(e){for(var t,r,n=T.version.split("."),i=e.split("."),o=0,s=i.length;o<s;o++)if((t=parseInt(n[o],10)||0)!==(r=parseInt(i[o],10)||0))return r<t;return!0},T.isDataTable=T.fnIsDataTable=function(e){var i=k(e).get(0),o=!1;return e instanceof T.Api||(k.each(T.settings,function(e,t){var r=t.nScrollHead?k("table",t.nScrollHead)[0]:null,n=t.nScrollFoot?k("table",t.nScrollFoot)[0]:null;t.nTable!==i&&r!==i&&n!==i||(o=!0)}),o)},T.tables=T.fnTables=function(t){var e=!1,r=(k.isPlainObject(t)&&(e=t.api,t=t.visible),k.map(T.settings,function(e){if(!t||k(e.nTable).is(":visible"))return e.nTable}));return e?new W(r):r},T.camelToHungarian=S,t("$()",function(e,t){t=this.rows(t).nodes(),t=k(t);return k([].concat(t.filter(e).toArray(),t.find(e).toArray()))}),k.each(["on","one","off"],function(e,r){t(r+"()",function(){var e=Array.prototype.slice.call(arguments),t=(e[0]=k.map(e[0].split(/\s/),function(e){return e.match(/\.dt\b/)?e:e+".dt"}).join(" "),k(this.tables().nodes()));return t[r].apply(t,e),this})}),t("clear()",function(){return this.iterator("table",function(e){he(e)})}),t("settings()",function(){return new W(this.context,this.context)}),t("init()",function(){var e=this.context;return e.length?e[0].oInit:null}),t("data()",function(){return this.iterator("table",function(e){return P(e.aoData,"_aData")}).flatten()}),t("destroy()",function(d){return d=d||!1,this.iterator("table",function(t){var r,e=t.nTableWrapper.parentNode,n=t.oClasses,i=t.nTable,o=t.nTBody,s=t.nTHead,a=t.nTFoot,l=k(i),o=k(o),c=k(t.nTableWrapper),u=k.map(t.aoData,function(e){return e.nTr}),a=(t.bDestroying=!0,I(t,"aoDestroyCallback","destroy",[t]),d||new W(t).columns().visible(!0),c.off(".DT").find(":not(tbody *)").off(".DT"),k($).off(".DT-"+t.sInstance),i!=s.parentNode&&(l.children("thead").detach(),l.append(s)),a&&i!=a.parentNode&&(l.children("tfoot").detach(),l.append(a)),t.aaSorting=[],t.aaSortingFixed=[],lt(t),k(u).removeClass(t.asStripeClasses.join(" ")),k("th, td",s).removeClass(n.sSortable+" "+n.sSortableAsc+" "+n.sSortableDesc+" "+n.sSortableNone),o.children().detach(),o.append(u),d?"remove":"detach"),s=(l[a](),c[a](),!d&&e&&(e.insertBefore(i,t.nTableReinsertBefore),l.css("width",t.sDestroyWidth).removeClass(n.sTable),r=t.asDestroyStripes.length)&&o.children().each(function(e){k(this).addClass(t.asDestroyStripes[e%r])}),k.inArray(t,T.settings));-1!==s&&T.settings.splice(s,1)})}),k.each(["column","row","cell"],function(e,l){t(l+"s().every()",function(o){var s=this.selector.opts,a=this;return this.iterator(l,function(e,t,r,n,i){o.call(a[l](t,"cell"===l?r:s,"cell"===l?s:D),t,r,n,i)})})}),t("i18n()",function(e,t,r){var n=this.context[0],e=R(e)(n.oLanguage);return e===D&&(e=t),(e=r!==D&&k.isPlainObject(e)?e[r]!==D?e[r]:e._:e).replace("%d",r)}),T.version="1.10.24",T.settings=[],T.models={},T.models.oSearch={bCaseInsensitive:!0,sSearch:"",bRegex:!1,bSmart:!0},T.models.oRow={nTr:null,anCells:null,_aData:[],_aSortData:null,_aFilterData:null,_sFilterRow:null,_sRowStripe:"",src:null,idx:-1},T.models.oColumn={idx:null,aDataSort:null,asSorting:null,bSearchable:null,bSortable:null,bVisible:null,_sManualType:null,_bAttrSrc:!1,fnCreatedCell:null,fnGetData:null,fnSetData:null,mData:null,mRender:null,nTh:null,nTf:null,sClass:null,sContentPadding:null,sDefaultContent:null,sName:null,sSortDataType:"std",sSortingClass:null,sSortingClassJUI:null,sTitle:null,sType:null,sWidth:null,sWidthOrig:null},T.defaults={aaData:null,aaSorting:[[0,"asc"]],aaSortingFixed:[],ajax:null,aLengthMenu:[10,25,50,100],aoColumns:null,aoColumnDefs:null,aoSearchCols:[],asStripeClasses:null,bAutoWidth:!0,bDeferRender:!1,bDestroy:!1,bFilter:!0,bInfo:!0,bLengthChange:!0,bPaginate:!0,bProcessing:!1,bRetrieve:!1,bScrollCollapse:!1,bServerSide:!1,bSort:!0,bSortMulti:!0,bSortCellsTop:!1,bSortClasses:!0,bStateSave:!1,fnCreatedRow:null,fnDrawCallback:null,fnFooterCallback:null,fnFormatNumber:function(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,this.oLanguage.sThousands)},fnHeaderCallback:null,fnInfoCallback:null,fnInitComplete:null,fnPreDrawCallback:null,fnRowCallback:null,fnServerData:null,fnServerParams:null,fnStateLoadCallback:function(e){try{return JSON.parse((-1===e.iStateDuration?sessionStorage:localStorage).getItem("DataTables_"+e.sInstance+"_"+location.pathname))}catch(e){return{}}},fnStateLoadParams:null,fnStateLoaded:null,fnStateSaveCallback:function(e,t){try{(-1===e.iStateDuration?sessionStorage:localStorage).setItem("DataTables_"+e.sInstance+"_"+location.pathname,JSON.stringify(t))}catch(e){}},fnStateSaveParams:null,iStateDuration:7200,iDeferLoading:null,iDisplayLength:10,iDisplayStart:0,iTabIndex:0,oClasses:{},oLanguage:{oAria:{sSortAscending:": activate to sort column ascending",sSortDescending:": activate to sort column descending"},oPaginate:{sFirst:"First",sLast:"Last",sNext:"Next",sPrevious:"Previous"},sEmptyTable:"No data available in table",sInfo:"Showing _START_ to _END_ of _TOTAL_ entries",sInfoEmpty:"Showing 0 to 0 of 0 entries",sInfoFiltered:"(filtered from _MAX_ total entries)",sInfoPostFix:"",sDecimal:"",sThousands:",",sLengthMenu:"Show _MENU_ entries",sLoadingRecords:"Loading...",sProcessing:"Processing...",sSearch:"Search:",sSearchPlaceholder:"",sUrl:"",sZeroRecords:"No matching records found"},oSearch:k.extend({},T.models.oSearch),sAjaxDataProp:"data",sAjaxSource:null,sDom:"lfrtip",searchDelay:null,sPaginationType:"simple_numbers",sScrollX:"",sScrollXInner:"",sScrollY:"",sServerMethod:"GET",renderer:null,rowId:"DT_RowId"},s(T.defaults),T.defaults.column={aDataSort:null,iDataSort:-1,asSorting:["asc","desc"],bSearchable:!0,bSortable:!0,bVisible:!0,fnCreatedCell:null,mData:null,mRender:null,sCellType:"td",sClass:"",sContentPadding:"",sDefaultContent:null,sName:"",sSortDataType:"std",sTitle:null,sType:null,sWidth:null},s(T.defaults.column),T.models.oSettings={oFeatures:{bAutoWidth:null,bDeferRender:null,bFilter:null,bInfo:null,bLengthChange:null,bPaginate:null,bProcessing:null,bServerSide:null,bSort:null,bSortMulti:null,bSortClasses:null,bStateSave:null},oScroll:{bCollapse:null,iBarWidth:0,sX:null,sXInner:null,sY:null},oLanguage:{fnInfoCallback:null},oBrowser:{bScrollOversize:!1,bScrollbarLeft:!1,bBounding:!1,barWidth:0},ajax:null,aanFeatures:[],aoData:[],aiDisplay:[],aiDisplayMaster:[],aIds:{},aoColumns:[],aoHeader:[],aoFooter:[],oPreviousSearch:{},aoPreSearchCols:[],aaSorting:null,aaSortingFixed:[],asStripeClasses:null,asDestroyStripes:[],sDestroyWidth:0,aoRowCallback:[],aoHeaderCallback:[],aoFooterCallback:[],aoDrawCallback:[],aoRowCreatedCallback:[],aoPreDrawCallback:[],aoInitComplete:[],aoStateSaveParams:[],aoStateLoadParams:[],aoStateLoaded:[],sTableId:"",nTable:null,nTHead:null,nTFoot:null,nTBody:null,nTableWrapper:null,bDeferLoading:!1,bInitialised:!1,aoOpenRows:[],sDom:null,searchDelay:null,sPaginationType:"two_button",iStateDuration:0,aoStateSave:[],aoStateLoad:[],oSavedState:null,oLoadedState:null,sAjaxSource:null,sAjaxDataProp:null,bAjaxDataGet:!0,jqXHR:null,json:D,oAjaxData:D,fnServerData:null,aoServerParams:[],sServerMethod:null,fnFormatNumber:null,aLengthMenu:null,iDraw:0,bDrawing:!1,iDrawError:-1,_iDisplayLength:10,_iDisplayStart:0,_iRecordsTotal:0,_iRecordsDisplay:0,oClasses:{},bFiltered:!1,bSorted:!1,bSortCellsTop:null,oInit:null,aoDestroyCallback:[],fnRecordsTotal:function(){return"ssp"==M(this)?+this._iRecordsTotal:this.aiDisplayMaster.length},fnRecordsDisplay:function(){return"ssp"==M(this)?+this._iRecordsDisplay:this.aiDisplay.length},fnDisplayEnd:function(){var e=this._iDisplayLength,t=this._iDisplayStart,r=t+e,n=this.aiDisplay.length,i=this.oFeatures,o=i.bPaginate;return i.bServerSide?!1===o||-1===e?t+n:Math.min(t+e,this._iRecordsDisplay):!o||n<r||-1===e?n:r},oInstance:null,sInstance:null,iTabIndex:0,nScrollHead:null,nScrollFoot:null,aLastSort:[],oPlugins:{},rowIdFn:null,rowId:null},T.ext=f={buttons:{},classes:{},build:"dt/dt-1.10.24/fc-3.3.2/fh-3.1.8/r-2.2.7/rg-1.1.2/sc-2.0.3/sp-1.2.2/sl-1.3.3",errMode:"alert",feature:[],search:[],selector:{cell:[],column:[],row:[]},internal:{},legacy:{ajax:null},pager:{},renderer:{pageButton:{},header:{}},order:{},type:{detect:[],search:{},order:{}},_unique:0,fnVersionCheck:T.fnVersionCheck,iApiIndex:0,oJUIClasses:{},sVersion:T.version},k.extend(f,{afnFiltering:f.search,aTypes:f.type.detect,ofnSearch:f.type.search,oSort:f.type.order,afnSortData:f.order,aoFeatures:f.feature,oApi:f.internal,oStdClasses:f.classes,oPagination:f.pager}),k.extend(T.ext.classes,{sTable:"dataTable",sNoFooter:"no-footer",sPageButton:"paginate_button",sPageButtonActive:"current",sPageButtonDisabled:"disabled",sStripeOdd:"odd",sStripeEven:"even",sRowEmpty:"dataTables_empty",sWrapper:"dataTables_wrapper",sFilter:"dataTables_filter",sInfo:"dataTables_info",sPaging:"dataTables_paginate paging_",sLength:"dataTables_length",sProcessing:"dataTables_processing",sSortAsc:"sorting_asc",sSortDesc:"sorting_desc",sSortable:"sorting",sSortableAsc:"sorting_desc_disabled",sSortableDesc:"sorting_asc_disabled",sSortableNone:"sorting_disabled",sSortColumn:"sorting_",sFilterInput:"",sLengthSelect:"",sScrollWrapper:"dataTables_scroll",sScrollHead:"dataTables_scrollHead",sScrollHeadInner:"dataTables_scrollHeadInner",sScrollBody:"dataTables_scrollBody",sScrollFoot:"dataTables_scrollFoot",sScrollFootInner:"dataTables_scrollFootInner",sHeaderTH:"",sFooterTH:"",sSortJUIAsc:"",sSortJUIDesc:"",sSortJUI:"",sSortJUIAscAllowed:"",sSortJUIDescAllowed:"",sSortJUIWrapper:"",sSortIcon:"",sJUIHeader:"",sJUIFooter:""}),T.ext.pager);function Mt(e,t){var r=[],n=It.numbers_length,i=Math.floor(n/2);return t<=n?r=d(0,t):e<=i?((r=d(0,n-2)).push("ellipsis"),r.push(t-1)):((t-1-i<=e?r=d(t-(n-2),t):((r=d(e-i+2,e+i-1)).push("ellipsis"),r.push(t-1),r)).splice(0,0,"ellipsis"),r.splice(0,0,0)),r.DT_el="span",r}k.extend(It,{simple:function(e,t){return["previous","next"]},full:function(e,t){return["first","previous","next","last"]},numbers:function(e,t){return[Mt(e,t)]},simple_numbers:function(e,t){return["previous",Mt(e,t),"next"]},full_numbers:function(e,t){return["first","previous",Mt(e,t),"next","last"]},first_last_numbers:function(e,t){return["first",Mt(e,t),"last"]},_numbers:Mt,numbers_length:7}),k.extend(!0,T.ext.renderer,{pageButton:{_:function(c,e,u,t,d,h){function p(e,t){for(var r,n,i=m.sPageButtonDisabled,o=function(e){qe(c,e.data.action,!0)},s=0,a=t.length;s<a;s++)if(r=t[s],Array.isArray(r)){var l=k("<"+(r.DT_el||"div")+"/>").appendTo(e);p(l,r)}else{switch(f=null,g=r,n=c.iTabIndex,r){case"ellipsis":e.append('<span class="ellipsis">&#x2026;</span>');break;case"first":f=y.sFirst,0===d&&(n=-1,g+=" "+i);break;case"previous":f=y.sPrevious,0===d&&(n=-1,g+=" "+i);break;case"next":f=y.sNext,0!==h&&d!==h-1||(n=-1,g+=" "+i);break;case"last":f=y.sLast,0!==h&&d!==h-1||(n=-1,g+=" "+i);break;default:f=c.fnFormatNumber(r+1),g=d===r?m.sPageButtonActive:""}null!==f&&(ft(k("<a>",{class:m.sPageButton+" "+g,"aria-controls":c.sTableId,"aria-label":v[r],"data-dt-idx":b,tabindex:n,id:0===u&&"string"==typeof r?c.sTableId+"_"+r:null}).html(f).appendTo(e),{action:r},o),b++)}}var f,g,r,m=c.oClasses,y=c.oLanguage.oPaginate,v=c.oLanguage.oAria.paginate||{},b=0;try{r=k(e).find(w.activeElement).data("dt-idx")}catch(e){}p(k(e).empty(),t),r!==D&&k(e).find("[data-dt-idx="+r+"]").trigger("focus")}}}),k.extend(T.ext.type.detect,[function(e,t){t=t.oLanguage.sDecimal;return l(e,t)?"num"+t:null},function(e,t){var r;return(!e||e instanceof Date||j.test(e))&&(null!==(r=Date.parse(e))&&!isNaN(r)||i(e))?"date":null},function(e,t){t=t.oLanguage.sDecimal;return l(e,t,!0)?"num-fmt"+t:null},function(e,t){t=t.oLanguage.sDecimal;return r(e,t)?"html-num"+t:null},function(e,t){t=t.oLanguage.sDecimal;return r(e,t,!0)?"html-num-fmt"+t:null},function(e,t){return i(e)||"string"==typeof e&&-1!==e.indexOf("<")?"html":null}]),k.extend(T.ext.type.search,{html:function(e){return i(e)?e:"string"==typeof e?e.replace(E," ").replace(B,""):""},string:function(e){return!i(e)&&"string"==typeof e?e.replace(E," "):e}});function kt(e,t,r,n){return 0===e||e&&"-"!==e?+(e=(e=t?G(e,t):e).replace&&(r&&(e=e.replace(r,"")),n)?e.replace(n,""):e):-1/0}function Dt(r){k.each({num:function(e){return kt(e,r)},"num-fmt":function(e){return kt(e,r,Y)},"html-num":function(e){return kt(e,r,B)},"html-num-fmt":function(e){return kt(e,r,B,Y)}},function(e,t){f.type.order[e+r+"-pre"]=t,e.match(/^html\-/)&&(f.type.search[e+r]=f.type.search.html)})}k.extend(f.type.order,{"date-pre":function(e){e=Date.parse(e);return isNaN(e)?-1/0:e},"html-pre":function(e){return i(e)?"":e.replace?e.replace(/<.*?>/g,"").toLowerCase():e+""},"string-pre":function(e){return i(e)?"":"string"==typeof e?e.toLowerCase():e.toString?e.toString():""},"string-asc":function(e,t){return e<t?-1:t<e?1:0},"string-desc":function(e,t){return e<t?1:t<e?-1:0}}),Dt(""),k.extend(!0,T.ext.renderer,{header:{_:function(i,o,s,a){k(i.nTable).on("order.dt.DT",function(e,t,r,n){i===t&&(t=s.idx,o.removeClass(a.sSortAsc+" "+a.sSortDesc).addClass("asc"==n[t]?a.sSortAsc:"desc"==n[t]?a.sSortDesc:s.sSortingClass))})},jqueryui:function(i,o,s,a){k("<div/>").addClass(a.sSortJUIWrapper).append(o.contents()).append(k("<span/>").addClass(a.sSortIcon+" "+s.sSortingClassJUI)).appendTo(o),k(i.nTable).on("order.dt.DT",function(e,t,r,n){i===t&&(t=s.idx,o.removeClass(a.sSortAsc+" "+a.sSortDesc).addClass("asc"==n[t]?a.sSortAsc:"desc"==n[t]?a.sSortDesc:s.sSortingClass),o.find("span."+a.sSortIcon).removeClass(a.sSortJUIAsc+" "+a.sSortJUIDesc+" "+a.sSortJUI+" "+a.sSortJUIAscAllowed+" "+a.sSortJUIDescAllowed).addClass("asc"==n[t]?a.sSortJUIAsc:"desc"==n[t]?a.sSortJUIDesc:s.sSortingClassJUI))})}}});function Pt(e){return"string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"):e}function Lt(t){return function(){var e=[ht(this[T.ext.iApiIndex])].concat(Array.prototype.slice.call(arguments));return T.ext.internal[t].apply(this,e)}}return T.render={number:function(n,i,o,s,a){return{display:function(e){if("number"!=typeof e&&"string"!=typeof e)return e;var t=e<0?"-":"",r=parseFloat(e);if(isNaN(r))return Pt(e);r=r.toFixed(o),e=Math.abs(r);r=parseInt(e,10),e=o?i+(e-r).toFixed(o).substring(2):"";return t+(s||"")+r.toString().replace(/\B(?=(\d{3})+(?!\d))/g,n)+e+(a||"")}}},text:function(){return{display:Pt,filter:Pt}}},k.extend(T.ext.internal,{_fnExternApiFunc:Lt,_fnBuildAjax:Te,_fnAjaxUpdate:Se,_fnAjaxParameters:_e,_fnAjaxUpdateDraw:xe,_fnAjaxDataSrc:Re,_fnAddColumn:re,_fnColumnOptions:ne,_fnAdjustColumnSizing:L,_fnVisibleToColumnIndex:F,_fnColumnIndexToVisible:u,_fnVisbleColumns:_,_fnGetColumns:ie,_fnColumnTypes:oe,_fnApplyColumnDefs:se,_fnHungarianMap:s,_fnCamelToHungarian:S,_fnLanguageCompat:J,_fnBrowserDetect:ee,_fnAddData:x,_fnAddTr:ae,_fnNodeToDataIndex:function(e,t){return t._DT_RowIndex!==D?t._DT_RowIndex:null},_fnNodeToColumnIndex:function(e,t,r){return k.inArray(r,e.aoData[t].anCells)},_fnGetCellData:v,_fnSetCellData:le,_fnSplitObjNotation:ue,_fnGetObjectDataFn:R,_fnSetObjectDataFn:m,_fnGetDataMaster:de,_fnClearTable:he,_fnDeleteIndex:pe,_fnInvalidate:fe,_fnGetRowElements:ge,_fnCreateTr:me,_fnBuildHead:ve,_fnDrawHead:be,_fnDraw:g,_fnReDraw:c,_fnAddOptionsHtml:we,_fnDetectHeader:Ce,_fnGetUniqueThs:Ee,_fnFeatureHtmlFilter:Ae,_fnFilterComplete:Ne,_fnFilterCustom:Oe,_fnFilterColumn:Ie,_fnFilter:Me,_fnFilterCreateSearch:ke,_fnEscapeRegex:De,_fnFilterData:Fe,_fnFeatureHtmlInfo:Ve,_fnUpdateInfo:We,_fnInfoMacros:$e,_fnInitialise:Be,_fnInitComplete:je,_fnLengthChange:ze,_fnFeatureHtmlLength:Ye,_fnFeatureHtmlPaginate:Ge,_fnPageChange:qe,_fnFeatureHtmlProcessing:Ke,_fnProcessingDisplay:b,_fnFeatureHtmlTable:Xe,_fnScrollDraw:Je,_fnApplyToChildren:H,_fnCalculateColumnWidths:Qe,_fnThrottle:et,_fnConvertToWidth:tt,_fnGetWidestNode:rt,_fnGetMaxLenString:nt,_fnStringToCss:U,_fnSortFlatten:A,_fnSort:it,_fnSortAria:ot,_fnSortListener:st,_fnSortAttachListener:at,_fnSortingClasses:lt,_fnSortData:ct,_fnSaveState:ut,_fnLoadState:dt,_fnSettingsFromNode:ht,_fnLog:V,_fnMap:N,_fnBindAction:ft,_fnCallbackReg:O,_fnCallbackFire:I,_fnLengthOverflow:gt,_fnRenderer:mt,_fnDataSource:M,_fnRowAttributes:ye,_fnExtend:pt,_fnCalculateEnd:function(){}}),((k.fn.dataTable=T).$=k).fn.dataTableSettings=T.settings,k.fn.dataTableExt=T.ext,k.fn.DataTable=function(e){return k(this).dataTable(e).api()},k.each(T,function(e,t){k.fn.DataTable[e]=t}),k.fn.dataTable}),!function(r){"function"==typeof define&&define.amd?define(["jquery","datatables.net"],function(e){return r(e,window,document)}):"object"==typeof exports?module.exports=function(e,t){return e=e||window,t&&t.fn.dataTable||(t=require("datatables.net")(e,t).$),r(t,e,e.document)}:r(jQuery,window,document)}(function(E,a,l,T){"use strict";function c(e,t){var r=this;if(this instanceof c){t!==T&&!0!==t||(t={});var n=E.fn.dataTable.camelToHungarian,n=(n&&(n(c.defaults,c.defaults,!0),n(c.defaults,t)),new E.fn.dataTable.Api(e).settings()[0]);if(this.s={dt:n,iTableColumns:n.aoColumns.length,aiOuterWidths:[],aiInnerWidths:[],rtl:"rtl"===E(n.nTable).css("direction")},this.dom={scroller:null,header:null,body:null,footer:null,grid:{wrapper:null,dt:null,left:{wrapper:null,head:null,body:null,foot:null},right:{wrapper:null,head:null,body:null,foot:null}},clone:{left:{header:null,body:null,footer:null},right:{header:null,body:null,footer:null}}},n._oFixedColumns)throw"FixedColumns already initialised on this table";n._oFixedColumns=this,n._bInitComplete?this._fnConstruct(t):n.oApi._fnCallbackReg(n,"aoInitComplete",function(){r._fnConstruct(t)},"FixedColumns")}else alert("FixedColumns warning: FixedColumns must be initialised with the 'new' keyword.")}var t,i=E.fn.dataTable;return E.extend(c.prototype,{fnUpdate:function(){this._fnDraw(!0)},fnRedrawLayout:function(){this._fnColCalc(),this._fnGridLayout(),this.fnUpdate()},fnRecalculateHeight:function(e){delete e._DTTC_iHeight,e.style.height="auto"},fnSetRowHeight:function(e,t){e.style.height=t+"px"},fnGetPosition:function(e){var t,r,n=this.s.dt.oInstance;return E(e).parents(".DTFC_Cloned").length?"tr"===e.nodeName.toLowerCase()?(r=E(e).index(),n.fnGetPosition(E("tr",this.s.dt.nTBody)[r])):(t=E(e).index(),r=E(e.parentNode).index(),[n.fnGetPosition(E("tr",this.s.dt.nTBody)[r]),t,n.oApi._fnVisibleToColumnIndex(this.s.dt,t)]):n.fnGetPosition(e)},fnToFixedNode:function(e,t){var r;return t<this.s.iLeftColumns?r=E(this.dom.clone.left.body).find("[data-dt-row="+e+"][data-dt-column="+t+"]"):t>=this.s.iRightColumns&&(r=E(this.dom.clone.right.body).find("[data-dt-row="+e+"][data-dt-column="+t+"]")),r&&r.length?r[0]:new E.fn.dataTable.Api(this.s.dt).cell(e,t).node()},_fnConstruct:function(e){var t,r,n,i,o,s=this;"function"!=typeof this.s.dt.oInstance.fnVersionCheck||!0!==this.s.dt.oInstance.fnVersionCheck("1.8.0")?alert("FixedColumns "+c.VERSION+" required DataTables 1.8.0 or later. Please upgrade your DataTables installation"):""===this.s.dt.oScroll.sX?this.s.dt.oInstance.oApi._fnLog(this.s.dt,1,"FixedColumns is not needed (no x-scrolling in DataTables enabled), so no action will be taken. Use 'FixedHeader' for column fixing when scrolling is not enabled"):(this.s=E.extend(!0,this.s,c.defaults,e),e=this.s.dt.oClasses,this.dom.grid.dt=E(this.s.dt.nTable).parents("div."+e.sScrollWrapper)[0],this.dom.scroller=E("div."+e.sScrollBody,this.dom.grid.dt)[0],this._fnColCalc(),this._fnGridSetup(),r=!1,E(this.s.dt.nTableWrapper).on("mousedown.DTFC",function(e){0===e.button&&(r=!0,E(l).one("mouseup",function(){r=!1}))}),E(this.dom.scroller).on("mouseover.DTFC touchstart.DTFC",function(){r||(t="main")}).on("scroll.DTFC",function(e){"main"!==(t=!t&&e.originalEvent?"main":t)&&"key"!==t||(0<s.s.iLeftColumns&&(s.dom.grid.left.liner.scrollTop=s.dom.scroller.scrollTop),0<s.s.iRightColumns&&(s.dom.grid.right.liner.scrollTop=s.dom.scroller.scrollTop))}),n="onwheel"in l.createElement("div")?"wheel.DTFC":"mousewheel.DTFC",0<s.s.iLeftColumns&&(E(s.dom.grid.left.liner).on("mouseover.DTFC touchstart.DTFC",function(){r||"key"===t||(t="left")}).on("scroll.DTFC",function(e){"left"===(t=!t&&e.originalEvent?"left":t)&&(s.dom.scroller.scrollTop=s.dom.grid.left.liner.scrollTop,0<s.s.iRightColumns)&&(s.dom.grid.right.liner.scrollTop=s.dom.grid.left.liner.scrollTop)}).on(n,function(e){t="left";e="wheel"===e.type?-e.originalEvent.deltaX:e.originalEvent.wheelDeltaX;s.dom.scroller.scrollLeft-=e}),E(s.dom.grid.left.head).on("mouseover.DTFC touchstart.DTFC",function(){t="main"})),0<s.s.iRightColumns&&(E(s.dom.grid.right.liner).on("mouseover.DTFC touchstart.DTFC",function(){r||"key"===t||(t="right")}).on("scroll.DTFC",function(e){"right"===(t=!t&&e.originalEvent?"right":t)&&(s.dom.scroller.scrollTop=s.dom.grid.right.liner.scrollTop,0<s.s.iLeftColumns)&&(s.dom.grid.left.liner.scrollTop=s.dom.grid.right.liner.scrollTop)}).on(n,function(e){t="right";e="wheel"===e.type?-e.originalEvent.deltaX:e.originalEvent.wheelDeltaX;s.dom.scroller.scrollLeft-=e}),E(s.dom.grid.right.head).on("mouseover.DTFC touchstart.DTFC",function(){t="main"})),E(a).on("resize.DTFC",function(){s._fnGridLayout.call(s)}),i=!0,(o=E(this.s.dt.nTable)).on("draw.dt.DTFC",function(){s._fnColCalc(),s._fnDraw.call(s,i),i=!1}).on("key-focus.dt.DTFC",function(){t="key"}).on("column-sizing.dt.DTFC",function(){s._fnColCalc(),s._fnGridLayout(s)}).on("column-visibility.dt.DTFC",function(e,t,r,n,i){i!==T&&!i||(s._fnColCalc(),s._fnGridLayout(s),s._fnDraw(!0))}).on("select.dt.DTFC deselect.dt.DTFC",function(e,t,r,n){"dt"===e.namespace&&s._fnDraw(!1)}).on("position.dts.dt.DTFC",function(e,t){s.dom.grid.left.body&&E(s.dom.grid.left.body).find("table").eq(0).css("top",t),s.dom.grid.right.body&&E(s.dom.grid.right.body).find("table").eq(0).css("top",t)}).on("destroy.dt.DTFC",function(){o.off(".DTFC"),E(s.dom.scroller).off(".DTFC"),E(a).off(".DTFC"),E(s.s.dt.nTableWrapper).off(".DTFC"),E(s.dom.grid.left.liner).off(".DTFC "+n),E(s.dom.grid.left.wrapper).remove(),E(s.dom.grid.right.liner).off(".DTFC "+n),E(s.dom.grid.right.wrapper).remove()}),this._fnGridLayout(),this.s.dt.oInstance.fnDraw(!1))},_fnColCalc:function(){var i=this,o=0,s=0;this.s.aiInnerWidths=[],this.s.aiOuterWidths=[],E.each(this.s.dt.aoColumns,function(e,t){var r,n,t=E(t.nTh);t.filter(":visible").length?(n=t.outerWidth(),0===i.s.aiOuterWidths.length&&(n+="string"==typeof(r=E(i.s.dt.nTable).css("border-left-width"))&&-1===r.indexOf("px")?1:parseInt(r,10)),i.s.aiOuterWidths.length===i.s.dt.aoColumns.length-1&&(n+="string"==typeof(r=E(i.s.dt.nTable).css("border-right-width"))&&-1===r.indexOf("px")?1:parseInt(r,10)),i.s.aiOuterWidths.push(n),i.s.aiInnerWidths.push(t.width()),e<i.s.iLeftColumns&&(o+=n),i.s.iTableColumns-i.s.iRightColumns<=e&&(s+=n)):(i.s.aiInnerWidths.push(0),i.s.aiOuterWidths.push(0))}),this.s.iLeftWidth=o,this.s.iRightWidth=s},_fnGridSetup:function(){var e,t=this._fnDTOverflow(),r=(this.dom.body=this.s.dt.nTable,this.dom.header=this.s.dt.nTHead.parentNode,this.dom.header.parentNode.parentNode.style.position="relative",E('<div class="DTFC_ScrollWrapper" style="position:relative; clear:both;"><div class="DTFC_LeftWrapper" style="position:absolute; top:0; left:0;" aria-hidden="true"><div class="DTFC_LeftHeadWrapper" style="position:relative; top:0; left:0; overflow:hidden;"></div><div class="DTFC_LeftBodyWrapper" style="position:relative; top:0; left:0; height:0; overflow:hidden;"><div class="DTFC_LeftBodyLiner" style="position:relative; top:0; left:0; overflow-y:scroll;"></div></div><div class="DTFC_LeftFootWrapper" style="position:relative; top:0; left:0; overflow:hidden;"></div></div><div class="DTFC_RightWrapper" style="position:absolute; top:0; right:0;" aria-hidden="true"><div class="DTFC_RightHeadWrapper" style="position:relative; top:0; left:0;"><div class="DTFC_RightHeadBlocker DTFC_Blocker" style="position:absolute; top:0; bottom:0;"></div></div><div class="DTFC_RightBodyWrapper" style="position:relative; top:0; left:0; height:0; overflow:hidden;"><div class="DTFC_RightBodyLiner" style="position:relative; top:0; left:0; overflow-y:scroll;"></div></div><div class="DTFC_RightFootWrapper" style="position:relative; top:0; left:0;"><div class="DTFC_RightFootBlocker DTFC_Blocker" style="position:absolute; top:0; bottom:0;"></div></div></div></div>')[0]),n=r.childNodes[0],i=r.childNodes[1];this.dom.grid.dt.parentNode.insertBefore(r,this.dom.grid.dt),r.appendChild(this.dom.grid.dt),this.dom.grid.wrapper=r,0<this.s.iLeftColumns&&(this.dom.grid.left.wrapper=n,this.dom.grid.left.head=n.childNodes[0],this.dom.grid.left.body=n.childNodes[1],this.dom.grid.left.liner=E("div.DTFC_LeftBodyLiner",r)[0],r.appendChild(n)),0<this.s.iRightColumns&&(this.dom.grid.right.wrapper=i,this.dom.grid.right.head=i.childNodes[0],this.dom.grid.right.body=i.childNodes[1],this.dom.grid.right.liner=E("div.DTFC_RightBodyLiner",r)[0],i.style.right=t.bar+"px",(e=E("div.DTFC_RightHeadBlocker",r)[0]).style.width=t.bar+"px",e.style.right=-t.bar+"px",this.dom.grid.right.headBlock=e,(e=E("div.DTFC_RightFootBlocker",r)[0]).style.width=t.bar+"px",e.style.right=-t.bar+"px",this.dom.grid.right.footBlock=e,r.appendChild(i)),this.s.dt.nTFoot&&(this.dom.footer=this.s.dt.nTFoot.parentNode,0<this.s.iLeftColumns&&(this.dom.grid.left.foot=n.childNodes[2]),0<this.s.iRightColumns)&&(this.dom.grid.right.foot=i.childNodes[2]),this.s.rtl&&E("div.DTFC_RightHeadBlocker",r).css({left:-t.bar+"px",right:""})},_fnGridLayout:function(){function e(e,t){s.bar?(!r._firefoxScrollError()||34<E(e).height())&&(e.style.width=t+s.bar+"px"):(e.style.width=t+20+"px",e.style.paddingRight="20px",e.style.boxSizing="border-box")}var t,r=this,n=this.dom.grid,i=(E(n.wrapper).width(),this.s.dt.nTable.parentNode.offsetHeight),o=this.s.dt.nTable.parentNode.parentNode.offsetHeight,s=this._fnDTOverflow(),a=this.s.iLeftWidth,l=this.s.iRightWidth,c="rtl"===E(this.dom.body).css("direction");s.x&&(i-=s.bar),n.wrapper.style.height=o+"px",0<this.s.iLeftColumns&&((t=n.left.wrapper).style.width=a+"px",t.style.height="1px",c?(t.style.left="",t.style.right=0):(t.style.left=0,t.style.right=""),n.left.body.style.height=i+"px",n.left.foot&&(n.left.foot.style.top=(s.x?s.bar:0)+"px"),e(n.left.liner,a),n.left.liner.style.height=i+"px",n.left.liner.style.maxHeight=i+"px"),0<this.s.iRightColumns&&((t=n.right.wrapper).style.width=l+"px",t.style.height="1px",this.s.rtl?(t.style.left=s.y?s.bar+"px":0,t.style.right=""):(t.style.left="",t.style.right=s.y?s.bar+"px":0),n.right.body.style.height=i+"px",n.right.foot&&(n.right.foot.style.top=(s.x?s.bar:0)+"px"),e(n.right.liner,l),n.right.liner.style.height=i+"px",n.right.liner.style.maxHeight=i+"px",n.right.headBlock.style.display=s.y?"block":"none",n.right.footBlock.style.display=s.y?"block":"none")},_fnDTOverflow:function(){var e=this.s.dt.nTable,t=e.parentNode,r={x:!1,y:!1,bar:this.s.dt.oScroll.iBarWidth};return e.offsetWidth>t.clientWidth&&(r.x=!0),e.offsetHeight>t.clientHeight&&(r.y=!0),r},_fnDraw:function(e){this._fnGridLayout(),this._fnCloneLeft(e),this._fnCloneRight(e),E(this.dom.scroller).trigger("scroll"),null!==this.s.fnDrawCallback&&this.s.fnDrawCallback.call(this,this.dom.clone.left,this.dom.clone.right),E(this).trigger("draw.dtfc",{leftClone:this.dom.clone.left,rightClone:this.dom.clone.right})},_fnCloneRight:function(e){if(!(this.s.iRightColumns<=0)){for(var t=[],r=this.s.iTableColumns-this.s.iRightColumns;r<this.s.iTableColumns;r++)this.s.dt.aoColumns[r].bVisible&&t.push(r);this._fnClone(this.dom.clone.right,this.dom.grid.right,t,e)}},_fnCloneLeft:function(e){if(!(this.s.iLeftColumns<=0)){for(var t=[],r=0;r<this.s.iLeftColumns;r++)this.s.dt.aoColumns[r].bVisible&&t.push(r);this._fnClone(this.dom.clone.left,this.dom.grid.left,t,e)}},_fnCopyLayout:function(e,t,r){for(var n=[],i=[],o=[],s=0,a=e.length;s<a;s++){var l=[];l.nTr=E(e[s].nTr).clone(r,!1)[0];for(var c,u,d=0,h=this.s.iTableColumns;d<h;d++)-1!==E.inArray(d,t)&&(-1===(c=E.inArray(e[s][d].cell,o))?(u=E(e[s][d].cell).clone(r,!1)[0],i.push(u),o.push(e[s][d].cell),l.push({cell:u,unique:e[s][d].unique})):l.push({cell:i[c],unique:e[s][d].unique}));n.push(l)}return n},_fnClone:function(e,t,i,r){var n,o,s,a,l,c,u,d,h=this,p=this.s.dt;if(r){for(E(e.header).remove(),e.header=E(this.dom.header).clone(!0,!1)[0],e.header.className+=" DTFC_Cloned",e.header.style.width="100%",t.head.appendChild(e.header),v=this._fnCopyLayout(p.aoHeader,i,!0),(u=E(">thead",e.header)).empty(),n=0,o=v.length;n<o;n++)u[0].appendChild(v[n].nTr);p.oApi._fnDrawHead(p,v,!0)}else for(v=this._fnCopyLayout(p.aoHeader,i,!1),p.oApi._fnDetectHeader(d=[],E(">thead",e.header)[0]),n=0,o=v.length;n<o;n++)for(s=0,a=v[n].length;s<a;s++)d[n][s].cell.className=v[n][s].cell.className,E("span.DataTables_sort_icon",d[n][s].cell).each(function(){this.className=E("span.DataTables_sort_icon",v[n][s].cell)[0].className});this._fnEqualiseHeights("thead",this.dom.header,e.header),"auto"==this.s.sHeightMatch&&E(">tbody>tr",h.dom.body).css("height","auto"),null!==e.body&&(E(e.body).remove(),e.body=null),e.body=E(this.dom.body).clone(!0)[0],e.body.className+=" DTFC_Cloned",e.body.style.paddingBottom=p.oScroll.iBarWidth+"px",e.body.style.marginBottom=2*p.oScroll.iBarWidth+"px",null!==e.body.getAttribute("id")&&e.body.removeAttribute("id"),E(">thead>tr",e.body).empty(),E(">tfoot",e.body).remove();var f=E("tbody",e.body)[0];if(E(f).empty(),0<p.aiDisplay.length){for(var g=E(">thead>tr",e.body)[0],m=0;m<i.length;m++){l=i[m],(c=E(p.aoColumns[l].nTh).clone(!0)[0]).innerHTML="";var y=c.style;y.paddingTop="0",y.paddingBottom="0",y.borderTopWidth="0",y.borderBottomWidth="0",y.height=0,y.width=h.s.aiInnerWidths[l]+"px",g.appendChild(c)}E(">tbody>tr",h.dom.body).each(function(e){var t=!1===h.s.dt.oFeatures.bServerSide?h.s.dt.aiDisplay[h.s.dt._iDisplayStart+e]:e,r=h.s.dt.aoData[t].anCells||E(this).children("td, th"),n=this.cloneNode(!1);for(n.removeAttribute("id"),n.setAttribute("data-dt-row",t),m=0;m<i.length;m++)l=i[m],0<r.length&&((c=E(r[l]).clone(!0,!0)[0]).removeAttribute("id"),c.setAttribute("data-dt-row",t),c.setAttribute("data-dt-column",l),n.appendChild(c));f.appendChild(n)})}else E(">tbody>tr",h.dom.body).each(function(e){(c=this.cloneNode(!0)).className+=" DTFC_NoData",E("td",c).html(""),f.appendChild(c)});if(e.body.style.width="100%",e.body.style.margin="0",e.body.style.padding="0",p.oScroller!==T&&(C=p.oScroller.dom.force,t.forcer?t.forcer.style.height=C.style.height:(t.forcer=C.cloneNode(!0),t.liner.appendChild(t.forcer))),t.liner.appendChild(e.body),this._fnEqualiseHeights("tbody",h.dom.body,e.body),null!==p.nTFoot){if(r){null!==e.footer&&e.footer.parentNode.removeChild(e.footer),e.footer=E(this.dom.footer).clone(!0,!0)[0],e.footer.className+=" DTFC_Cloned",e.footer.style.width="100%",t.foot.appendChild(e.footer);var v=this._fnCopyLayout(p.aoFooter,i,!0),b=E(">tfoot",e.footer);for(b.empty(),n=0,o=v.length;n<o;n++)b[0].appendChild(v[n].nTr);p.oApi._fnDrawHead(p,v,!0)}else{v=this._fnCopyLayout(p.aoFooter,i,!1);var w=[];for(p.oApi._fnDetectHeader(w,E(">tfoot",e.footer)[0]),n=0,o=v.length;n<o;n++)for(s=0,a=v[n].length;s<a;s++)w[n][s].cell.className=v[n][s].cell.className}this._fnEqualiseHeights("tfoot",this.dom.footer,e.footer)}var C=p.oApi._fnGetUniqueThs(p,E(">thead",e.header)[0]);E(C).each(function(e){l=i[e],this.style.width=h.s.aiInnerWidths[l]+"px"}),null!==h.s.dt.nTFoot&&(C=p.oApi._fnGetUniqueThs(p,E(">tfoot",e.footer)[0]),E(C).each(function(e){l=i[e],this.style.width=h.s.aiInnerWidths[l]+"px"}))},_fnGetTrNodes:function(e){for(var t=[],r=0,n=e.childNodes.length;r<n;r++)"TR"==e.childNodes[r].nodeName.toUpperCase()&&t.push(e.childNodes[r]);return t},_fnEqualiseHeights:function(e,t,r){if("none"!=this.s.sHeightMatch||"thead"===e||"tfoot"===e){for(var n,i,o=t.getElementsByTagName(e)[0],r=r.getElementsByTagName(e)[0],e=E(">"+e+">tr:eq(0)",t).children(":first"),s=(e.outerHeight(),e.height(),this._fnGetTrNodes(o)),a=this._fnGetTrNodes(r),l=[],c=0,u=a.length;c<u;c++)i=(n=s[c].offsetHeight)<(i=a[c].offsetHeight)?i:n,"semiauto"==this.s.sHeightMatch&&(s[c]._DTTC_iHeight=i),l.push(i);for(c=0,u=a.length;c<u;c++)a[c].style.height=l[c]+"px",s[c].style.height=l[c]+"px"}},_firefoxScrollError:function(){var e;return t===T&&(e=E("<div/>").css({position:"absolute",top:0,left:0,height:10,width:50,overflow:"scroll"}).appendTo("body"),t=e[0].clientWidth===e[0].offsetWidth&&0!==this._fnDTOverflow().bar,e.remove()),t}}),c.defaults={iLeftColumns:1,iRightColumns:0,fnDrawCallback:null,sHeightMatch:"semiauto"},c.version="3.3.2",i.Api.register("fixedColumns()",function(){return this}),i.Api.register("fixedColumns().update()",function(){return this.iterator("table",function(e){e._oFixedColumns&&e._oFixedColumns.fnUpdate()})}),i.Api.register("fixedColumns().relayout()",function(){return this.iterator("table",function(e){e._oFixedColumns&&e._oFixedColumns.fnRedrawLayout()})}),i.Api.register("rows().recalcHeight()",function(){return this.iterator("row",function(e,t){e._oFixedColumns&&e._oFixedColumns.fnRecalculateHeight(this.row(t).node())})}),i.Api.register("fixedColumns().rowIndex()",function(e){return(e=E(e)).parents(".DTFC_Cloned").length?this.rows({page:"current"}).indexes()[e.index()]:this.row(e).index()}),i.Api.register("fixedColumns().cellIndex()",function(e){var t,r;return(e=E(e)).parents(".DTFC_Cloned").length?(t=e.parent().index(),t=this.rows({page:"current"}).indexes()[t],r=e.parents(".DTFC_LeftWrapper").length?e.index():this.columns().flatten().length-this.context[0]._oFixedColumns.s.iRightColumns+e.index(),{row:t,column:this.column.index("toData",r),columnVisible:r}):this.cell(e).index()}),i.Api.registerPlural("cells().fixedNodes()","cell().fixedNode()",function(){return this.iterator("cell",function(e,t,r){return e._oFixedColumns?e._oFixedColumns.fnToFixedNode(t,r):this.cell(t,r).node()},1)}),E(l).on("init.dt.fixedColumns",function(e,t){var r,n;"dt"===e.namespace&&(e=t.oInit.fixedColumns,r=i.defaults.fixedColumns,e||r)&&(n=E.extend({},e,r),!1!==e)&&new c(t,n)}),E.fn.dataTable.FixedColumns=c,E.fn.DataTable.FixedColumns=c}),!function(r){"function"==typeof define&&define.amd?define(["jquery","datatables.net"],function(e){return r(e,window,document)}):"object"==typeof exports?module.exports=function(e,t){return e=e||window,t&&t.fn.dataTable||(t=require("datatables.net")(e,t).$),r(t,e,e.document)}:r(jQuery,window,document)}(function(l,n,c,i){"use strict";function o(e,t){if(!(this instanceof o))throw"FixedHeader must be initialised with the 'new' keyword.";if(!0===t&&(t={}),e=new s.Api(e),this.c=l.extend(!0,{},o.defaults,t),this.s={dt:e,position:{theadTop:0,tbodyTop:0,tfootTop:0,tfootBottom:0,width:0,left:0,tfootHeight:0,theadHeight:0,windowHeight:l(n).height(),visible:!0},headerMode:null,footerMode:null,autoWidth:e.settings()[0].oFeatures.bAutoWidth,namespace:".dtfc"+r++,scrollLeft:{header:-1,footer:-1},enable:!0},this.dom={floatingHeader:null,thead:l(e.table().header()),tbody:l(e.table().body()),tfoot:l(e.table().footer()),header:{host:null,floating:null,placeholder:null},footer:{host:null,floating:null,placeholder:null}},this.dom.header.host=this.dom.thead.parent(),this.dom.footer.host=this.dom.tfoot.parent(),(t=e.settings()[0])._fixedHeader)throw"FixedHeader already initialised on table "+t.nTable.id;(t._fixedHeader=this)._constructor()}var s=l.fn.dataTable,r=0;return l.extend(o.prototype,{destroy:function(){this.s.dt.off(".dtfc"),l(n).off(this.s.namespace),this.c.header&&this._modeChange("in-place","header",!0),this.c.footer&&this.dom.tfoot.length&&this._modeChange("in-place","footer",!0)},enable:function(e,t){this.s.enable=e,!t&&t!==i||(this._positions(),this._scroll(!0))},enabled:function(){return this.s.enable},headerOffset:function(e){return e!==i&&(this.c.headerOffset=e,this.update()),this.c.headerOffset},footerOffset:function(e){return e!==i&&(this.c.footerOffset=e,this.update()),this.c.footerOffset},update:function(){var e=this.s.dt.table().node();l(e).is(":visible")?this.enable(!0,!1):this.enable(!1,!1),this._positions(),this._scroll(!0)},_constructor:function(){var e=this,t=this.s.dt,r=(l(n).on("scroll"+this.s.namespace,function(){e._scroll()}).on("resize"+this.s.namespace,s.util.throttle(function(){e.s.position.windowHeight=l(n).height(),e.update()},50)),l(".fh-fixedHeader")),r=(!this.c.headerOffset&&r.length&&(this.c.headerOffset=r.outerHeight()),l(".fh-fixedFooter"));!this.c.footerOffset&&r.length&&(this.c.footerOffset=r.outerHeight()),t.on("column-reorder.dt.dtfc column-visibility.dt.dtfc draw.dt.dtfc column-sizing.dt.dtfc responsive-display.dt.dtfc",function(){e.update()}),t.on("destroy.dtfc",function(){e.destroy()}),this._positions(),this._scroll()},_clone:function(e,t){var r=this.s.dt,n=this.dom[e],i="header"===e?this.dom.thead:this.dom.tfoot;!t&&n.floating?n.floating.removeClass("fixedHeader-floating fixedHeader-locked"):(n.floating&&(n.placeholder.remove(),this._unsize(e),n.floating.children().detach(),n.floating.remove()),n.floating=l(r.table().node().cloneNode(!1)).css("table-layout","fixed").attr("aria-hidden","true").removeAttr("id").append(i).appendTo("body"),n.placeholder=i.clone(!1),n.placeholder.find("*[id]").removeAttr("id"),n.host.prepend(n.placeholder),this._matchWidths(n.placeholder,n.floating))},_matchWidths:function(t,r){function e(e){return l(e,t).map(function(){return+l(this).css("width").replace(/[^\d\.]/g,"")}).toArray()}function n(e,t){l(e,r).each(function(e){l(this).css({width:t[e],minWidth:t[e]})})}var i=e("th"),o=e("td");n("th",i),n("td",o)},_unsize:function(e){var t=this.dom[e].floating;t&&("footer"===e||"header"===e&&!this.s.autoWidth)?l("th, td",t).css({width:"",minWidth:""}):t&&"header"===e&&l("th, td",t).css("min-width","")},_horizontal:function(e,t){var r=this.dom[e],n=this.s.position,i=this.s.scrollLeft;r.floating&&i[e]!==t&&(r.floating.css("left",n.left-t),i[e]=t)},_modeChange:function(e,t,r){this.s.dt;function n(r){i.floating.attr("style",function(e,t){return(t||"")+"width: "+r+"px !important;"})}var i=this.dom[t],o=this.s.position,s=this.dom["footer"===t?"tfoot":"thead"],a=l.contains(s[0],c.activeElement)?c.activeElement:null;a&&a.blur(),"in-place"===e?(i.placeholder&&(i.placeholder.remove(),i.placeholder=null),this._unsize(t),"header"===t?i.host.prepend(s):i.host.append(s),i.floating&&(i.floating.remove(),i.floating=null)):"in"===e?(this._clone(t,r),i.floating.addClass("fixedHeader-floating").css("header"===t?"top":"bottom",this.c[t+"Offset"]).css("left",o.left+"px"),n(o.width),"footer"===t&&i.floating.css("top","")):"below"===e?(this._clone(t,r),i.floating.addClass("fixedHeader-locked").css("top",o.tfootTop-o.theadHeight).css("left",o.left+"px"),n(o.width)):"above"===e&&(this._clone(t,r),i.floating.addClass("fixedHeader-locked").css("top",o.tbodyTop).css("left",o.left+"px"),n(o.width)),a&&a!==c.activeElement&&setTimeout(function(){a.focus()},10),this.s.scrollLeft.header=-1,this.s.scrollLeft.footer=-1,this.s[t+"Mode"]=e},_positions:function(){var e=this.s.dt.table(),t=this.s.position,r=this.dom,e=l(e.node()),n=e.children("thead"),i=e.children("tfoot"),r=r.tbody;t.visible=e.is(":visible"),t.width=e.outerWidth(),t.left=e.offset().left,t.theadTop=n.offset().top,t.tbodyTop=r.offset().top,t.tbodyHeight=r.outerHeight(),t.theadHeight=t.tbodyTop-t.theadTop,i.length?(t.tfootTop=i.offset().top,t.tfootBottom=t.tfootTop+i.outerHeight(),t.tfootHeight=t.tfootBottom-t.tfootTop):(t.tfootTop=t.tbodyTop+r.outerHeight(),t.tfootBottom=t.tfootTop,t.tfootHeight=t.tfootTop)},_scroll:function(e){var t,r=l(c).scrollTop(),n=l(c).scrollLeft(),i=this.s.position;this.c.header&&(t=!this.s.enable||!i.visible||r<=i.theadTop-this.c.headerOffset?"in-place":r<=i.tfootTop-i.theadHeight-this.c.headerOffset?"in":"below",!e&&t===this.s.headerMode||this._modeChange(t,"header",e),this._horizontal("header",n)),this.c.footer&&this.dom.tfoot.length&&(t=!this.s.enable||!i.visible||r+i.windowHeight>=i.tfootBottom+this.c.footerOffset?"in-place":i.windowHeight+r>i.tbodyTop+i.tfootHeight+this.c.footerOffset?"in":"above",!e&&t===this.s.footerMode||this._modeChange(t,"footer",e),this._horizontal("footer",n))}}),o.version="3.1.8",o.defaults={header:!0,footer:!1,headerOffset:0,footerOffset:0},l.fn.dataTable.FixedHeader=o,l.fn.DataTable.FixedHeader=o,l(c).on("init.dt.dtfh",function(e,t,r){var n;"dt"===e.namespace&&(e=t.oInit.fixedHeader,n=s.defaults.fixedHeader,e||n)&&!t._fixedHeader&&(n=l.extend({},n,e),!1!==e)&&new o(t,n)}),s.Api.register("fixedHeader()",function(){}),s.Api.register("fixedHeader.adjust()",function(){return this.iterator("table",function(e){e=e._fixedHeader;e&&e.update()})}),s.Api.register("fixedHeader.enable()",function(t){return this.iterator("table",function(e){e=e._fixedHeader;t=t===i||t,e&&t!==e.enabled()&&e.enable(t)})}),s.Api.register("fixedHeader.enabled()",function(){if(this.context.length){var e=this.context[0]._fixedHeader;if(e)return e.enabled()}return!1}),s.Api.register("fixedHeader.disable()",function(){return this.iterator("table",function(e){e=e._fixedHeader;e&&e.enabled()&&e.enable(!1)})}),l.each(["header","footer"],function(e,r){s.Api.register("fixedHeader."+r+"Offset()",function(t){var e=this.context;return t===i?e.length&&e[0]._fixedHeader?e[0]._fixedHeader[r+"Offset"]():i:this.iterator("table",function(e){e=e._fixedHeader;e&&e[r+"Offset"](t)})})}),o}),!function(r){"function"==typeof define&&define.amd?define(["jquery","datatables.net"],function(e){return r(e,window,document)}):"object"==typeof exports?module.exports=function(e,t){return e=e||window,t&&t.fn.dataTable||(t=require("datatables.net")(e,t).$),r(t,e,e.document)}:r(jQuery,window,document)}(function(f,g,s,h){"use strict";function n(e,t){if(!o.versionCheck||!o.versionCheck("1.10.10"))throw"DataTables Responsive requires DataTables 1.10.10 or newer";this.s={dt:new o.Api(e),columns:[],current:[]},this.s.dt.settings()[0].responsive||(t&&"string"==typeof t.details?t.details={type:t.details}:t&&!1===t.details?t.details={type:!1}:t&&!0===t.details&&(t.details={type:"inline"}),this.c=f.extend(!0,{},n.defaults,o.defaults.responsive,t),(e.responsive=this)._constructor())}var o=f.fn.dataTable,d=(f.extend(n.prototype,{_constructor:function(){var n=this,i=this.s.dt,e=i.settings()[0],t=f(g).innerWidth(),e=(i.settings()[0]._responsive=this,f(g).on("resize.dtr orientationchange.dtr",o.util.throttle(function(){var e=f(g).innerWidth();e!==t&&(n._resize(),t=e)})),e.oApi._fnCallbackReg(e,"aoRowCreatedCallback",function(e,t,r){-1!==f.inArray(!1,n.s.current)&&f(">td, >th",e).each(function(e){e=i.column.index("toData",e);!1===n.s.current[e]&&f(this).css("display","none")})}),i.on("destroy.dtr",function(){i.off(".dtr"),f(i.table().body()).off(".dtr"),f(g).off("resize.dtr orientationchange.dtr"),i.cells(".dtr-control").nodes().to$().removeClass("dtr-control"),f.each(n.s.current,function(e,t){!1===t&&n._setColumnVis(e,!0)})}),this.c.breakpoints.sort(function(e,t){return e.width<t.width?1:e.width>t.width?-1:0}),this._classLogic(),this._resizeAuto(),this.c.details);!1!==e.type&&(n._detailsInit(),i.on("column-visibility.dtr",function(){n._timer&&clearTimeout(n._timer),n._timer=setTimeout(function(){n._timer=null,n._classLogic(),n._resizeAuto(),n._resize(!0),n._redrawChildren()},100)}),i.on("draw.dtr",function(){n._redrawChildren()}),f(i.table().node()).addClass("dtr-"+e.type)),i.on("column-reorder.dtr",function(e,t,r){n._classLogic(),n._resizeAuto(),n._resize(!0)}),i.on("column-sizing.dtr",function(){n._resizeAuto(),n._resize()}),i.on("preXhr.dtr",function(){var e=[];i.rows().every(function(){this.child.isShown()&&e.push(this.id(!0))}),i.one("draw.dtr",function(){n._resizeAuto(),n._resize(),i.rows(e).every(function(){n._detailsDisplay(this,!1)})})}),i.on("draw.dtr",function(){n._controlClass()}).on("init.dtr",function(e,t,r){"dt"===e.namespace&&(n._resizeAuto(),n._resize(),f.inArray(!1,n.s.current))&&i.columns.adjust()}),this._resize()},_columnsVisiblity:function(r){for(var n=this.s.dt,e=this.s.columns,t=e.map(function(e,t){return{columnIdx:t,priority:e.priority}}).sort(function(e,t){return e.priority!==t.priority?e.priority-t.priority:e.columnIdx-t.columnIdx}),i=f.map(e,function(e,t){return!1===n.column(t).visible()?"not-visible":(!e.auto||null!==e.minWidth)&&(!0===e.auto?"-":-1!==f.inArray(r,e.includeIn))}),o=0,s=0,a=i.length;s<a;s++)!0===i[s]&&(o+=e[s].minWidth);var l=n.settings()[0].oScroll,l=l.sY||l.sX?l.iBarWidth:0,c=n.table().container().offsetWidth-l-o;for(s=0,a=i.length;s<a;s++)e[s].control&&(c-=e[s].minWidth);var u=!1;for(s=0,a=t.length;s<a;s++){var d=t[s].columnIdx;"-"===i[d]&&!e[d].control&&e[d].minWidth&&(u||c-e[d].minWidth<0?i[d]=!(u=!0):i[d]=!0,c-=e[d].minWidth)}var h=!1;for(s=0,a=e.length;s<a;s++)if(!e[s].control&&!e[s].never&&!1===i[s]){h=!0;break}for(s=0,a=e.length;s<a;s++)e[s].control&&(i[s]=h),"not-visible"===i[s]&&(i[s]=!1);return-1===f.inArray(!0,i)&&(i[0]=!0),i},_classLogic:function(){function a(e,t,r,n){var i,o,s;if(r){if("max-"===r)for(i=l._find(t).width,o=0,s=c.length;o<s;o++)c[o].width<=i&&d(e,c[o].name);else if("min-"===r)for(i=l._find(t).width,o=0,s=c.length;o<s;o++)c[o].width>=i&&d(e,c[o].name);else if("not-"===r)for(o=0,s=c.length;o<s;o++)-1===c[o].name.indexOf(n)&&d(e,c[o].name)}else u[e].includeIn.push(t)}var l=this,c=this.c.breakpoints,n=this.s.dt,u=n.columns().eq(0).map(function(e){var t=this.column(e),r=t.header().className,e=n.settings()[0].aoColumns[e].responsivePriority,t=t.header().getAttribute("data-priority");return e===h&&(e=t===h||null===t?1e4:+t),{className:r,includeIn:[],auto:!1,control:!1,never:!!r.match(/\bnever\b/),priority:e}}),d=function(e,t){e=u[e].includeIn;-1===f.inArray(t,e)&&e.push(t)};u.each(function(e,i){for(var t=e.className.split(" "),o=!1,r=0,n=t.length;r<n;r++){var s=t[r].trim();if("all"===s)return o=!0,void(e.includeIn=f.map(c,function(e){return e.name}));if("none"===s||e.never)return void(o=!0);if("control"===s||"dtr-control"===s)return o=!0,void(e.control=!0);f.each(c,function(e,t){var r=t.name.split("-"),n=new RegExp("(min\\-|max\\-|not\\-)?("+r[0]+")(\\-[_a-zA-Z0-9])?"),n=s.match(n);n&&(o=!0,n[2]===r[0]&&n[3]==="-"+r[1]?a(i,t.name,n[1],n[2]+n[3]):n[2]!==r[0]||n[3]||a(i,t.name,n[1],n[2]))})}o||(e.auto=!0)}),this.s.columns=u},_controlClass:function(){var e,t,r;"inline"===this.c.details.type&&(e=this.s.dt,t=this.s.current,r=f.inArray(!0,t),e.cells(null,function(e){return e!==r},{page:"current"}).nodes().to$().filter(".dtr-control").removeClass("dtr-control"),e.cells(null,r,{page:"current"}).nodes().to$().addClass("dtr-control"))},_detailsDisplay:function(e,t){var r,n=this,i=this.s.dt,o=this.c.details;!o||!1===o.type||!0!==(r=o.display(e,t,function(){return o.renderer(i,e[0],n._detailsObj(e[0]))}))&&!1!==r||f(i.table().node()).triggerHandler("responsive-display.dt",[i,e,r,t])},_detailsInit:function(){var r=this,n=this.s.dt,e=this.c.details,i=("inline"===e.type&&(e.target="td.dtr-control, th.dtr-control"),n.on("draw.dtr",function(){r._tabIndexes()}),r._tabIndexes(),f(n.table().body()).on("keyup.dtr","td, th",function(e){13===e.keyCode&&f(this).data("dtr-keyboard")&&f(this).click()}),e.target),e="string"==typeof i?i:"td, th";i===h&&null===i||f(n.table().body()).on("click.dtr mousedown.dtr mouseup.dtr",e,function(e){if(f(n.table().node()).hasClass("collapsed")&&-1!==f.inArray(f(this).closest("tr").get(0),n.rows().nodes().toArray())){if("number"==typeof i){var t=i<0?n.columns().eq(0).length+i:i;if(n.cell(this).index().column!==t)return}t=n.row(f(this).closest("tr"));"click"===e.type?r._detailsDisplay(t,!1):"mousedown"===e.type?f(this).css("outline","none"):"mouseup"===e.type&&f(this).trigger("blur").css("outline","")}})},_detailsObj:function(r){var n=this,i=this.s.dt;return f.map(this.s.columns,function(e,t){if(!e.never&&!e.control)return{className:(e=i.settings()[0].aoColumns[t]).sClass,columnIndex:t,data:i.cell(r,t).render(n.c.orthogonal),hidden:i.column(t).visible()&&!n.s.current[t],rowIndex:r,title:null!==e.sTitle?e.sTitle:f(i.column(t).header()).text()}})},_find:function(e){for(var t=this.c.breakpoints,r=0,n=t.length;r<n;r++)if(t[r].name===e)return t[r]},_redrawChildren:function(){var r=this,n=this.s.dt;n.rows({page:"current"}).iterator("row",function(e,t){n.row(t);r._detailsDisplay(n.row(t),!0)})},_resize:function(r){for(var e,n=this,t=this.s.dt,i=f(g).innerWidth(),o=this.c.breakpoints,s=o[0].name,a=this.s.columns,l=this.s.current.slice(),c=o.length-1;0<=c;c--)if(i<=o[c].width){s=o[c].name;break}var u=this._columnsVisiblity(s),d=(this.s.current=u,!1);for(c=0,e=a.length;c<e;c++)if(!1===u[c]&&!a[c].never&&!a[c].control&&!1==!t.column(c).visible()){d=!0;break}f(t.table().node()).toggleClass("collapsed",d);var h=!1,p=0;t.columns().eq(0).each(function(e,t){!0===u[t]&&p++,!r&&u[t]===l[t]||(h=!0,n._setColumnVis(e,u[t]))}),h&&(this._redrawChildren(),f(t.table().node()).trigger("responsive-resize.dt",[t,this.s.current]),0===t.page.info().recordsDisplay)&&f("td",t.table().body()).eq(0).attr("colspan",p),n._controlClass()},_resizeAuto:function(){var e,t,r,n,i,o=this.s.dt,s=this.s.columns;this.c.auto&&-1!==f.inArray(!0,f.map(s,function(e){return e.auto}))&&(f.isEmptyObject(d)||f.each(d,function(e){e=e.split("-");a(o,+e[0],+e[1])}),o.table().node().offsetWidth,o.columns,e=o.table().node().cloneNode(!1),t=f(o.table().header().cloneNode(!1)).appendTo(e),n=f(o.table().body()).clone(!1,!1).empty().appendTo(e),e.style.width="auto",r=o.columns().header().filter(function(e){return o.column(e).visible()}).to$().clone(!1).css("display","table-cell").css("width","auto").css("min-width",0),f(n).append(f(o.rows({page:"current"}).nodes()).clone(!1)).find("th, td").css("display",""),(n=o.table().footer())&&(n=f(n.cloneNode(!1)).appendTo(e),i=o.columns().footer().filter(function(e){return o.column(e).visible()}).to$().clone(!1).css("display","table-cell"),f("<tr/>").append(i).appendTo(n)),f("<tr/>").append(r).appendTo(t),"inline"===this.c.details.type&&f(e).addClass("dtr-inline collapsed"),f(e).find("[name]").removeAttr("name"),f(e).css("position","relative"),(i=f("<div/>").css({width:1,height:1,overflow:"hidden",clear:"both"}).append(e)).insertBefore(o.table().node()),r.each(function(e){e=o.column.index("fromVisible",e);s[e].minWidth=this.offsetWidth||0}),i.remove())},_responsiveOnlyHidden:function(){var r=this.s.dt;return f.map(this.s.current,function(e,t){return!1===r.column(t).visible()||e})},_setColumnVis:function(e,t){var r=this.s.dt,t=t?"":"none";f(r.column(e).header()).css("display",t),f(r.column(e).footer()).css("display",t),r.column(e).nodes().to$().css("display",t),f.isEmptyObject(d)||r.cells(null,e).indexes().each(function(e){a(r,e.row,e.column)})},_tabIndexes:function(){var e=this.s.dt,t=e.cells({page:"current"}).nodes().to$(),r=e.settings()[0],n=this.c.details.target;t.filter("[data-dtr-keyboard]").removeData("[data-dtr-keyboard]"),("number"==typeof n?e.cells(null,n,{page:"current"}).nodes().to$():f(n="td:first-child, th:first-child"===n?">td:first-child, >th:first-child":n,e.rows({page:"current"}).nodes())).attr("tabIndex",r.iTabIndex).data("dtr-keyboard",1)}}),{});function a(e,t,r){var n=t+"-"+r;if(d[n]){for(var i=e.cell(t,r).node(),o=d[n][0].parentNode.childNodes,s=[],a=0,l=o.length;a<l;a++)s.push(o[a]);for(var c=0,u=s.length;c<u;c++)i.appendChild(s[c]);d[n]=h}}n.defaults={breakpoints:n.breakpoints=[{name:"desktop",width:1/0},{name:"tablet-l",width:1024},{name:"tablet-p",width:768},{name:"mobile-l",width:480},{name:"mobile-p",width:320}],auto:!0,details:{display:(n.display={childRow:function(e,t,r){return t?f(e.node()).hasClass("parent")?(e.child(r(),"child").show(),!0):void 0:e.child.isShown()?(e.child(!1),f(e.node()).removeClass("parent"),!1):(e.child(r(),"child").show(),f(e.node()).addClass("parent"),!0)},childRowImmediate:function(e,t,r){return!t&&e.child.isShown()||!e.responsive.hasHidden()?(e.child(!1),f(e.node()).removeClass("parent"),!1):(e.child(r(),"child").show(),f(e.node()).addClass("parent"),!0)},modal:function(o){return function(e,t,r){var n,i;t?f("div.dtr-modal-content").empty().append(r()):(n=function(){i.remove(),f(s).off("keypress.dtr")},i=f('<div class="dtr-modal"/>').append(f('<div class="dtr-modal-display"/>').append(f('<div class="dtr-modal-content"/>').append(r())).append(f('<div class="dtr-modal-close">&times;</div>').click(function(){n()}))).append(f('<div class="dtr-modal-background"/>').click(function(){n()})).appendTo("body"),f(s).on("keyup.dtr",function(e){27===e.keyCode&&(e.stopPropagation(),n())})),o&&o.header&&f("div.dtr-modal-content").prepend("<h2>"+o.header(e)+"</h2>")}}}).childRow,renderer:(n.renderer={listHiddenNodes:function(){return function(n,e,t){var i=f('<ul data-dtr-index="'+e+'" class="dtr-details"/>'),o=!1;f.each(t,function(e,t){var r;t.hidden&&(r=t.className?'class="'+t.className+'"':"",f("<li "+r+' data-dtr-index="'+t.columnIndex+'" data-dt-row="'+t.rowIndex+'" data-dt-column="'+t.columnIndex+'"><span class="dtr-title">'+t.title+"</span> </li>").append(f('<span class="dtr-data"/>').append(function(e,t,r){var n=t+"-"+r;if(d[n])return d[n];for(var i=[],o=e.cell(t,r).node().childNodes,s=0,a=o.length;s<a;s++)i.push(o[s]);return d[n]=i}(n,t.rowIndex,t.columnIndex))).appendTo(i),o=!0)});return!!o&&i}},listHidden:function(){return function(e,t,r){r=f.map(r,function(e){var t=e.className?'class="'+e.className+'"':"";return e.hidden?"<li "+t+' data-dtr-index="'+e.columnIndex+'" data-dt-row="'+e.rowIndex+'" data-dt-column="'+e.columnIndex+'"><span class="dtr-title">'+e.title+'</span> <span class="dtr-data">'+e.data+"</span></li>":""}).join("");return!!r&&f('<ul data-dtr-index="'+t+'" class="dtr-details"/>').append(r)}},tableAll:function(n){return n=f.extend({tableClass:""},n),function(e,t,r){r=f.map(r,function(e){return"<tr "+(e.className?'class="'+e.className+'"':"")+' data-dt-row="'+e.rowIndex+'" data-dt-column="'+e.columnIndex+'"><td>'+e.title+":</td> <td>"+e.data+"</td></tr>"}).join("");return f('<table class="'+n.tableClass+' dtr-details" width="100%"/>').append(r)}}}).listHidden(),target:0,type:"inline"},orthogonal:"display"};var e=f.fn.dataTable.Api;return e.register("responsive()",function(){return this}),e.register("responsive.index()",function(e){return{column:(e=f(e)).data("dtr-index"),row:e.parent().data("dtr-index")}}),e.register("responsive.rebuild()",function(){return this.iterator("table",function(e){e._responsive&&e._responsive._classLogic()})}),e.register("responsive.recalc()",function(){return this.iterator("table",function(e){e._responsive&&(e._responsive._resizeAuto(),e._responsive._resize())})}),e.register("responsive.hasHidden()",function(){var e=this.context[0];return!!e._responsive&&-1!==f.inArray(!1,e._responsive._responsiveOnlyHidden())}),e.registerPlural("columns().responsiveHidden()","column().responsiveHidden()",function(){return this.iterator("column",function(e,t){return!!e._responsive&&e._responsive._responsiveOnlyHidden()[t]},1)}),n.version="2.2.7",f.fn.dataTable.Responsive=n,f.fn.DataTable.Responsive=n,f(s).on("preInit.dt.dtr",function(e,t,r){"dt"===e.namespace&&(f(t.nTable).hasClass("responsive")||f(t.nTable).hasClass("dt-responsive")||t.oInit.responsive||o.defaults.responsive)&&!1!==(e=t.oInit.responsive)&&new n(t,f.isPlainObject(e)?e:{})}),n}),!function(r){"function"==typeof define&&define.amd?define(["jquery","datatables.net"],function(e){return r(e,window,document)}):"object"==typeof exports?module.exports=function(e,t){return e=e||window,t&&t.fn.dataTable||(t=require("datatables.net")(e,t).$),r(t,e,e.document)}:r(jQuery,window,document)}(function(d,e,t,h){"use strict";function o(e,t){if(!p.versionCheck||!p.versionCheck("1.10.8"))throw"RowGroup requires DataTables 1.10.8 or newer";if(this.c=d.extend(!0,{},p.defaults.rowGroup,o.defaults,t),this.s={dt:new p.Api(e)},this.dom={},t=this.s.dt.settings()[0],e=t.rowGroup)return e;(t.rowGroup=this)._constructor()}var p=d.fn.dataTable;return d.extend(o.prototype,{dataSrc:function(e){var t;return e===h?this.c.dataSrc:(t=this.s.dt,this.c.dataSrc=e,d(t.table().node()).triggerHandler("rowgroup-datasrc.dt",[t,e]),this)},disable:function(){return this.c.enable=!1,this},enable:function(e){return!1===e?this.disable():(this.c.enable=!0,this)},enabled:function(){return this.c.enable},_constructor:function(){var r=this,e=this.s.dt,n=e.settings()[0];e.on("draw.dtrg",function(e,t){r.c.enable&&n===t&&r._draw()}),e.on("column-visibility.dt.dtrg responsive-resize.dt.dtrg",function(){r._adjustColspan()}),e.on("destroy",function(){e.off(".dtrg")})},_adjustColspan:function(){d("tr."+this.c.className,this.s.dt.table().body()).find("td:visible").attr("colspan",this._colspan())},_colspan:function(){return this.s.dt.columns().visible().reduce(function(e,t){return e+t},0)},_draw:function(){var e=this.s.dt,e=this._group(0,e.rows({page:"current"}).indexes());this._groupDisplay(0,e)},_group:function(e,t){for(var r,n=d.isArray(this.c.dataSrc)?this.c.dataSrc:[this.c.dataSrc],i=p.ext.oApi._fnGetObjectDataFn(n[e]),o=this.s.dt,s=[],a=0,l=t.length;a<l;a++){var c,u=t[a];null!==(c=i(o.row(u).data()))&&c!==h||(c=this.c.emptyDataGroup),r!==h&&c===r||(s.push({dataPoint:c,rows:[]}),r=c),s[s.length-1].rows.push(u)}if(n[e+1]!==h)for(a=0,l=s.length;a<l;a++)s[a].children=this._group(e+1,s[a].rows);return s},_groupDisplay:function(e,t){for(var r,n=this.s.dt,i=0,o=t.length;i<o;i++){var s,a=t[i],l=a.dataPoint,c=a.rows;this.c.startRender&&(r=this.c.startRender.call(this,n.rows(c),l,e),s=this._rowWrap(r,this.c.startClassName,e))&&s.insertBefore(n.row(c[0]).node()),this.c.endRender&&(r=this.c.endRender.call(this,n.rows(c),l,e),s=this._rowWrap(r,this.c.endClassName,e))&&s.insertAfter(n.row(c[c.length-1]).node()),a.children&&this._groupDisplay(e+1,a.children)}},_rowWrap:function(e,t,r){return(e=null!==e&&""!==e?e:this.c.emptyDataGroup)===h||null===e?null:("object"==typeof e&&e.nodeName&&"tr"===e.nodeName.toLowerCase()?d(e):e instanceof d&&e.length&&"tr"===e[0].nodeName.toLowerCase()?e:d("<tr/>").append(d("<td/>").attr("colspan",this._colspan()).append(e))).addClass(this.c.className).addClass(t).addClass("dtrg-level-"+r)}}),o.defaults={className:"dtrg-group",dataSrc:0,emptyDataGroup:"No group",enable:!0,endClassName:"dtrg-end",endRender:null,startClassName:"dtrg-start",startRender:function(e,t){return t}},o.version="1.1.2",d.fn.dataTable.RowGroup=o,d.fn.DataTable.RowGroup=o,p.Api.register("rowGroup()",function(){return this}),p.Api.register("rowGroup().disable()",function(){return this.iterator("table",function(e){e.rowGroup&&e.rowGroup.enable(!1)})}),p.Api.register("rowGroup().enable()",function(t){return this.iterator("table",function(e){e.rowGroup&&e.rowGroup.enable(t===h||t)})}),p.Api.register("rowGroup().enabled()",function(){var e=this.context;return!(!e.length||!e[0].rowGroup)&&e[0].rowGroup.enabled()}),p.Api.register("rowGroup().dataSrc()",function(t){return t===h?this.context[0].rowGroup.dataSrc():this.iterator("table",function(e){e.rowGroup&&e.rowGroup.dataSrc(t)})}),d(t).on("preInit.dt.dtrg",function(e,t,r){var n,i;"dt"===e.namespace&&(e=t.oInit.rowGroup,n=p.defaults.rowGroup,e||n)&&(i=d.extend({},n,e),!1!==e)&&new o(t,i)}),o}),!function(r){"function"==typeof define&&define.amd?define(["jquery","datatables.net"],function(e){return r(e,window,document)}):"object"==typeof exports?module.exports=function(e,t){return e=e||window,t&&t.fn.dataTable||(t=require("datatables.net")(e,t).$),r(t,e,e.document)}:r(jQuery,window,document)}(function(f,s,r,a){"use strict";function i(e,t){this instanceof i?(t===a&&(t={}),e=f.fn.dataTable.Api(e),this.s={dt:e.settings()[0],dtApi:e,tableTop:0,tableBottom:0,redrawTop:0,redrawBottom:0,autoHeight:!0,viewportRows:0,stateTO:null,stateSaveThrottle:function(){},drawTO:null,heights:{jump:null,page:null,virtual:null,scroll:null,row:null,viewport:null,labelFactor:1},topRowFloat:0,scrollDrawDiff:null,loaderVisible:!1,forceReposition:!1,baseRowTop:0,baseScrollTop:0,mousedown:!1,lastScrollTop:0},this.s=f.extend(this.s,i.oDefaults,t),this.s.heights.row=this.s.rowHeight,this.dom={force:r.createElement("div"),label:f('<div class="dts_label">0</div>'),scroller:null,table:null,loader:null},this.s.dt.oScroller||(this.s.dt.oScroller=this).construct()):alert("Scroller warning: Scroller must be initialised with the 'new' keyword.")}var o=f.fn.dataTable,e=(f.extend(i.prototype,{measure:function(e){this.s.autoHeight&&this._calcRowHeight();var t=this.s.heights,r=(t.row&&(t.viewport=this._parseHeight(f(this.dom.scroller).css("max-height")),this.s.viewportRows=parseInt(t.viewport/t.row,10)+1,this.s.dt._iDisplayLength=this.s.viewportRows*this.s.displayBuffer),this.dom.label.outerHeight());t.labelFactor=(t.viewport-r)/t.scroll,e!==a&&!e||this.s.dt.oInstance.fnDraw(!1)},pageInfo:function(){var e=this.s.dt,t=this.dom.scroller.scrollTop,e=e.fnRecordsDisplay(),r=Math.ceil(this.pixelsToRow(t+this.s.heights.viewport,!1,this.s.ani));return{start:Math.floor(this.pixelsToRow(t,!1,this.s.ani)),end:e<r?e-1:r-1}},pixelsToRow:function(e,t,r){e-=this.s.baseScrollTop,r=r?(this._domain("physicalToVirtual",this.s.baseScrollTop)+e)/this.s.heights.row:e/this.s.heights.row+this.s.baseRowTop;return t||t===a?parseInt(r,10):r},rowToPixels:function(e,t,r){e-=this.s.baseRowTop,r=r?this._domain("virtualToPhysical",this.s.baseScrollTop):this.s.baseScrollTop;return r+=e*this.s.heights.row,t||t===a?parseInt(r,10):r},scrollToRow:function(e,t){var r=this,n=!1,i=this.rowToPixels(e),o=e-(this.s.displayBuffer-1)/2*this.s.viewportRows;o<0&&(o=0),(t=(i>this.s.redrawBottom||i<this.s.redrawTop)&&this.s.dt._iDisplayStart!==o&&(n=!0,i=this._domain("virtualToPhysical",e*this.s.heights.row),this.s.redrawTop<i)&&i<this.s.redrawBottom?!(this.s.forceReposition=!0):t)===a||t?(this.s.ani=n,f(this.dom.scroller).animate({scrollTop:i},function(){setTimeout(function(){r.s.ani=!1},250)})):f(this.dom.scroller).scrollTop(i)},construct:function(){var n,i,o=this,e=this.s.dtApi;this.s.dt.oFeatures.bPaginate?(this.dom.force.style.position="relative",this.dom.force.style.top="0px",this.dom.force.style.left="0px",this.dom.force.style.width="1px",this.dom.scroller=f("div."+this.s.dt.oClasses.sScrollBody,this.s.dt.nTableWrapper)[0],this.dom.scroller.appendChild(this.dom.force),this.dom.scroller.style.position="relative",this.dom.table=f(">table",this.dom.scroller)[0],this.dom.table.style.position="absolute",this.dom.table.style.top="0px",this.dom.table.style.left="0px",f(e.table().container()).addClass("dts DTS"),this.s.loadingIndicator&&(this.dom.loader=f('<div class="dataTables_processing dts_loading">'+this.s.dt.oLanguage.sLoadingRecords+"</div>").css("display","none"),f(this.dom.scroller.parentNode).css("position","relative").append(this.dom.loader)),this.dom.label.appendTo(this.dom.scroller),this.s.heights.row&&"auto"!=this.s.heights.row&&(this.s.autoHeight=!1),this.s.ingnoreScroll=!0,f(this.dom.scroller).on("scroll.dt-scroller",function(e){o._scroll.call(o)}),f(this.dom.scroller).on("touchstart.dt-scroller",function(){o._scroll.call(o)}),f(this.dom.scroller).on("mousedown.dt-scroller",function(){o.s.mousedown=!0}).on("mouseup.dt-scroller",function(){o.s.labelVisible=!1,o.s.mousedown=!1,o.dom.label.css("display","none")}),f(s).on("resize.dt-scroller",function(){o.measure(!1),o._info()}),n=!0,i=e.state.loaded(),e.on("stateSaveParams.scroller",function(e,t,r){n&&i?(r.scroller=i.scroller,n=!1):r.scroller={topRow:o.s.topRowFloat,baseScrollTop:o.s.baseScrollTop,baseRowTop:o.s.baseRowTop,scrollTop:o.s.lastScrollTop}}),i&&i.scroller&&(this.s.topRowFloat=i.scroller.topRow,this.s.baseScrollTop=i.scroller.baseScrollTop,this.s.baseRowTop=i.scroller.baseRowTop),this.measure(!1),o.s.stateSaveThrottle=o.s.dt.oApi._fnThrottle(function(){o.s.dtApi.state.save()},500),e.on("init.scroller",function(){o.measure(!1),o.s.scrollType="jump",o._draw(),e.on("draw.scroller",function(){o._draw()})}),e.on("preDraw.dt.scroller",function(){o._scrollForce()}),e.on("destroy.scroller",function(){f(s).off("resize.dt-scroller"),f(o.dom.scroller).off(".dt-scroller"),f(o.s.dt.nTable).off(".scroller"),f(o.s.dt.nTableWrapper).removeClass("DTS"),f("div.DTS_Loading",o.dom.scroller.parentNode).remove(),o.dom.table.style.position="",o.dom.table.style.top="",o.dom.table.style.left=""})):this.s.dt.oApi._fnLog(this.s.dt,0,"Pagination must be enabled for Scroller")},_calcRowHeight:function(){var e=this.s.dt,t=e.nTable,r=t.cloneNode(!1),n=f("<tbody/>").appendTo(r),i=f('<div class="'+e.oClasses.sWrapper+' DTS"><div class="'+e.oClasses.sScrollWrapper+'"><div class="'+e.oClasses.sScrollBody+'"></div></div></div>'),o=(f("tbody tr:lt(4)",t).clone().appendTo(n),f("tr",n).length);if(1===o)n.prepend("<tr><td>&#160;</td></tr>"),n.append("<tr><td>&#160;</td></tr>");else for(;o<3;o++)n.append("<tr><td>&#160;</td></tr>");f("div."+e.oClasses.sScrollBody,i).append(r);e=this.s.dt.nHolding||t.parentNode;f(e).is(":visible")||(e="body"),i.find("input").removeAttr("name"),i.appendTo(e),this.s.heights.row=f("tr",n).eq(1).outerHeight(),i.remove()},_draw:function(){var e=this,t=this.s.heights,r=this.dom.scroller.scrollTop,n=f(this.s.dt.nTable).height(),i=this.s.dt._iDisplayStart,o=this.s.dt._iDisplayLength,s=this.s.dt.fnRecordsDisplay(),a=(this.s.skip=!0,!this.s.dt.bSorted&&!this.s.dt.bFiltered||0!==i||this.s.dt._drawHold||(this.s.topRowFloat=0),r="jump"===this.s.scrollType?this._domain("virtualToPhysical",this.s.topRowFloat*t.row):r,this.s.baseScrollTop=r,this.s.baseRowTop=this.s.topRowFloat,r-(this.s.topRowFloat-i)*t.row),s=(0===i?a=0:s<=i+o&&(a=t.scroll-n),this.dom.table.style.top=a+"px",this.s.tableTop=a,this.s.tableBottom=n+this.s.tableTop,(r-this.s.tableTop)*this.s.boundaryScale);this.s.redrawTop=r-s,this.s.redrawBottom=r+s>t.scroll-t.viewport-t.row?t.scroll-t.viewport-t.row:r+s,this.s.skip=!1,this.s.dt.oFeatures.bStateSave&&null!==this.s.dt.oLoadedState&&void 0!==this.s.dt.oLoadedState.scroller?((i=!(!this.s.dt.sAjaxSource&&!e.s.dt.ajax||this.s.dt.oFeatures.bServerSide))&&2==this.s.dt.iDraw||!i&&1==this.s.dt.iDraw)&&setTimeout(function(){f(e.dom.scroller).scrollTop(e.s.dt.oLoadedState.scroller.scrollTop),setTimeout(function(){e.s.ingnoreScroll=!1},0)},0):e.s.ingnoreScroll=!1,this.s.dt.oFeatures.bInfo&&setTimeout(function(){e._info.call(e)},0),this.dom.loader&&this.s.loaderVisible&&(this.dom.loader.css("display","none"),this.s.loaderVisible=!1)},_domain:function(e,t){var r,n=this.s.heights;return n.virtual===n.scroll||t<1e4?t:"virtualToPhysical"===e&&t>=n.virtual-1e4?(r=n.virtual-t,n.scroll-r):"physicalToVirtual"===e&&t>=n.scroll-1e4?(r=n.scroll-t,n.virtual-r):(n=1e4-1e4*(r=(n.virtual-1e4-1e4)/(n.scroll-1e4-1e4)),"virtualToPhysical"===e?(t-n)/r:r*t+n)},_info:function(){if(this.s.dt.oFeatures.bInfo){var e=this.s.dt,t=e.oLanguage,r=this.dom.scroller.scrollTop,n=Math.floor(this.pixelsToRow(r,!1,this.s.ani)+1),i=e.fnRecordsTotal(),o=e.fnRecordsDisplay(),r=Math.ceil(this.pixelsToRow(r+this.s.heights.viewport,!1,this.s.ani)),r=o<r?o:r,s=e.fnFormatNumber(n),a=e.fnFormatNumber(r),l=e.fnFormatNumber(i),c=e.fnFormatNumber(o),u=0===e.fnRecordsDisplay()&&e.fnRecordsDisplay()==e.fnRecordsTotal()?t.sInfoEmpty+t.sInfoPostFix:0===e.fnRecordsDisplay()?t.sInfoEmpty+" "+t.sInfoFiltered.replace("_MAX_",l)+t.sInfoPostFix:e.fnRecordsDisplay()==e.fnRecordsTotal()?t.sInfo.replace("_START_",s).replace("_END_",a).replace("_MAX_",l).replace("_TOTAL_",c)+t.sInfoPostFix:t.sInfo.replace("_START_",s).replace("_END_",a).replace("_MAX_",l).replace("_TOTAL_",c)+" "+t.sInfoFiltered.replace("_MAX_",e.fnFormatNumber(e.fnRecordsTotal()))+t.sInfoPostFix,s=t.fnInfoCallback,d=(s&&(u=s.call(e.oInstance,e,n,r,i,o,u)),e.aanFeatures.i);if(void 0!==d)for(var h=0,p=d.length;h<p;h++)f(d[h]).html(u);f(e.nTable).triggerHandler("info.dt")}},_parseHeight:function(e){var t,r,e=/^([+-]?(?:\d+(?:\.\d+)?|\.\d+))(px|em|rem|vh)$/.exec(e);return null!==e&&(r=parseFloat(e[1]),"px"===(e=e[2])?t=r:"vh"===e?t=r/100*f(s).height():"rem"===e?t=r*parseFloat(f(":root").css("font-size")):"em"===e&&(t=r*parseFloat(f("body").css("font-size"))),t)||0},_scroll:function(){var e,t=this,r=this.s.heights,n=this.dom.scroller.scrollTop;this.s.skip||this.s.ingnoreScroll||n!==this.s.lastScrollTop&&(this.s.dt.bFiltered||this.s.dt.bSorted?this.s.lastScrollTop=0:(this._info(),clearTimeout(this.s.stateTO),this.s.stateTO=setTimeout(function(){t.s.dtApi.state.save()},250),this.s.scrollType=Math.abs(n-this.s.lastScrollTop)>r.viewport?"jump":"cont",this.s.topRowFloat="cont"===this.s.scrollType?this.pixelsToRow(n,!1,!1):this._domain("physicalToVirtual",n)/r.row,this.s.topRowFloat<0&&(this.s.topRowFloat=0),this.s.forceReposition||n<this.s.redrawTop||n>this.s.redrawBottom?(e=Math.ceil((this.s.displayBuffer-1)/2*this.s.viewportRows),e=parseInt(this.s.topRowFloat,10)-e,this.s.forceReposition=!1,e<=0?e=0:e+this.s.dt._iDisplayLength>this.s.dt.fnRecordsDisplay()?(e=this.s.dt.fnRecordsDisplay()-this.s.dt._iDisplayLength)<0&&(e=0):e%2!=0&&e++,(this.s.targetTop=e)!=this.s.dt._iDisplayStart&&(this.s.tableTop=f(this.s.dt.nTable).offset().top,this.s.tableBottom=f(this.s.dt.nTable).height()+this.s.tableTop,e=function(){t.s.dt._iDisplayStart=t.s.targetTop,t.s.dt.oApi._fnDraw(t.s.dt)},this.s.dt.oFeatures.bServerSide?(this.s.forceReposition=!0,clearTimeout(this.s.drawTO),this.s.drawTO=setTimeout(e,this.s.serverWait)):e(),this.dom.loader)&&!this.s.loaderVisible&&(this.dom.loader.css("display","block"),this.s.loaderVisible=!0)):this.s.topRowFloat=this.pixelsToRow(n,!1,!0),this.s.lastScrollTop=n,this.s.stateSaveThrottle(),"jump"===this.s.scrollType&&this.s.mousedown&&(this.s.labelVisible=!0),this.s.labelVisible&&this.dom.label.html(this.s.dt.fnFormatNumber(parseInt(this.s.topRowFloat,10)+1)).css("top",n+n*r.labelFactor).css("display","block")))},_scrollForce:function(){var e=this.s.heights;e.virtual=e.row*this.s.dt.fnRecordsDisplay(),e.scroll=e.virtual,1e6<e.scroll&&(e.scroll=1e6),this.dom.force.style.height=e.scroll>this.s.heights.row?e.scroll+"px":this.s.heights.row+"px"}}),i.oDefaults=i.defaults={boundaryScale:.5,displayBuffer:9,loadingIndicator:!1,rowHeight:"auto",serverWait:200},i.version="2.0.3",f(r).on("preInit.dt.dtscroller",function(e,t){var r,n;"dt"===e.namespace&&(e=t.oInit.scroller,r=o.defaults.scroller,e||r)&&(n=f.extend({},e,r),!1!==e)&&new i(t,n)}),f.fn.dataTable.Scroller=i,f.fn.DataTable.Scroller=i,f.fn.dataTable.Api);return e.register("scroller()",function(){return this}),e.register("scroller().rowToPixels()",function(e,t,r){var n=this.context;if(n.length&&n[0].oScroller)return n[0].oScroller.rowToPixels(e,t,r)}),e.register("scroller().pixelsToRow()",function(e,t,r){var n=this.context;if(n.length&&n[0].oScroller)return n[0].oScroller.pixelsToRow(e,t,r)}),e.register(["scroller().scrollToRow()","scroller.toPosition()"],function(t,r){return this.iterator("table",function(e){e.oScroller&&e.oScroller.scrollToRow(t,r)}),this}),e.register("row().scrollTo()",function(r){var n=this;return this.iterator("row",function(e,t){e.oScroller&&(t=n.rows({order:"applied",search:"applied"}).indexes().indexOf(t),e.oScroller.scrollToRow(t,r))}),this}),e.register("scroller.measure()",function(t){return this.iterator("table",function(e){e.oScroller&&e.oScroller.measure(t)}),this}),e.register("scroller.page()",function(){var e=this.context;if(e.length&&e[0].oScroller)return e[0].oScroller.pageInfo()}),i}),!function(){"use strict";var L,F;c.prototype.clearData=function(){this.s.rowData={arrayFilter:[],arrayOriginal:[],arrayTotals:[],bins:{},binsOriginal:{},binsTotal:{},filterMap:new Map,totalOptions:0}},c.prototype.clearPane=function(){return this.s.dtPane.rows({selected:!0}).deselect(),this.updateTable(),this},c.prototype.destroy=function(){L(this.s.dtPane).off(".dtsp"),L(this.s.dt).off(".dtsp"),L(this.dom.nameButton).off(".dtsp"),L(this.dom.countButton).off(".dtsp"),L(this.dom.clear).off(".dtsp"),L(this.dom.searchButton).off(".dtsp"),L(this.dom.container).remove();for(var e=L.fn.dataTable.ext.search.indexOf(this.s.searchFunction);-1!==e;)L.fn.dataTable.ext.search.splice(e,1),e=L.fn.dataTable.ext.search.indexOf(this.s.searchFunction);void 0!==this.s.dtPane&&this.s.dtPane.destroy(),this.s.listSet=!1},c.prototype.getPaneCount=function(){return void 0!==this.s.dtPane?this.s.dtPane.rows({selected:!0}).data().toArray().length:0},c.prototype.rebuildPane=function(e,t,r,n){void 0===e&&(e=!1),void 0===t&&(t=null),void 0===r&&(r=null),void 0===n&&(n=!1),this.clearData();var i=[],o=(this.s.serverSelect=[],null);return void 0!==this.s.dtPane&&(n&&(this.s.dt.page.info().serverSide?this.s.serverSelect=this.s.dtPane.rows({selected:!0}).data().toArray():i=this.s.dtPane.rows({selected:!0}).data().toArray()),this.s.dtPane.clear().destroy(),o=L(this.dom.container).prev(),this.destroy(),this.s.dtPane=void 0,L.fn.dataTable.ext.search.push(this.s.searchFunction)),this.dom.container.removeClass(this.classes.hidden),this.s.displayed=!1,this._buildPane(this.s.dt.page.info().serverSide?this.s.serverSelect:i,e,t,r,o),this},c.prototype.removePane=function(){this.s.displayed=!1,L(this.dom.container).hide()},c.prototype.setCascadeRegen=function(e){this.s.cascadeRegen=e},c.prototype.setClear=function(e){this.s.clearing=e},c.prototype.updatePane=function(e){void 0===e&&(e=!1),this.s.updating=!0,this._updateCommon(e),this.s.updating=!1},c.prototype.updateTable=function(){var e=this.s.dtPane.rows({selected:!0}).data().toArray();this.selections=e,this._searchExtras(),(this.c.cascadePanes||this.c.viewTotal)&&this.updatePane()},c.prototype._setListeners=function(){var e,c=this,u=this.s.rowData;return this.s.dtPane.on("select.dtsp",function(){clearTimeout(e),c.s.dt.page.info().serverSide&&!c.s.updating?c.s.serverSelecting||(c.s.serverSelect=c.s.dtPane.rows({selected:!0}).data().toArray(),c.s.scrollTop=L(c.s.dtPane.table().node()).parent()[0].scrollTop,c.s.selectPresent=!0,c.s.dt.draw(!1)):(L(c.dom.clear).removeClass(c.classes.dull),c.s.selectPresent=!0,c.s.updating||c._makeSelection(),c.s.selectPresent=!1)}),this.s.dtPane.on("deselect.dtsp",function(){e=setTimeout(function(){c.s.dt.page.info().serverSide&&!c.s.updating?c.s.serverSelecting||(c.s.serverSelect=c.s.dtPane.rows({selected:!0}).data().toArray(),c.s.deselect=!0,c.s.dt.draw(!1)):(c.s.deselect=!0,0===c.s.dtPane.rows({selected:!0}).data().toArray().length&&L(c.dom.clear).addClass(c.classes.dull),c._makeSelection(),c.s.deselect=!1,c.s.dt.state.save())},50)}),this.s.dt.on("stateSaveParams.dtsp",function(e,t,r){if(L.isEmptyObject(r))c.s.dtPane.state.clear();else{var n,i,o,s,a=[];void 0!==c.s.dtPane&&(a=c.s.dtPane.rows({selected:!0}).data().map(function(e){return e.filter.toString()}).toArray(),n=L(c.dom.searchBox).val(),i=c.s.dtPane.order(),o=u.binsOriginal,s=u.arrayOriginal),void 0===r.searchPanes&&(r.searchPanes={}),void 0===r.searchPanes.panes&&(r.searchPanes.panes=[]);for(var l=0;l<r.searchPanes.panes.length;l++)r.searchPanes.panes[l].id===c.s.index&&(r.searchPanes.panes.splice(l,1),l--);r.searchPanes.panes.push({arrayFilter:s,bins:o,id:c.s.index,order:i,searchTerm:n,selected:a})}}),this.s.dtPane.on("user-select.dtsp",function(e,t,r,n,i){i.stopPropagation()}),this.s.dtPane.on("draw.dtsp",function(){c._adjustTopRow()}),L(this.dom.nameButton).on("click.dtsp",function(){var e=c.s.dtPane.order()[0][1];c.s.dtPane.order([0,"asc"===e?"desc":"asc"]).draw(),c.s.dt.state.save()}),L(this.dom.countButton).on("click.dtsp",function(){var e=c.s.dtPane.order()[0][1];c.s.dtPane.order([1,"asc"===e?"desc":"asc"]).draw(),c.s.dt.state.save()}),L(this.dom.clear).on("click.dtsp",function(){c.dom.container.find("."+c.classes.search).each(function(){L(this).val(""),L(this).trigger("input")}),c.clearPane()}),L(this.dom.searchButton).on("click.dtsp",function(){L(c.dom.searchBox).focus()}),L(this.dom.searchBox).on("input.dtsp",function(){c.s.dtPane.search(L(c.dom.searchBox).val()).draw(),c.s.dt.state.save()}),this.s.dt.state.save(),!0},c.prototype._addOption=function(e,t,r,n,i,o){if(Array.isArray(e)||e instanceof F.Api){if(e instanceof F.Api&&(e=e.toArray(),t=t.toArray()),e.length!==t.length)throw new Error("display and filter not the same length");for(var s=0;s<e.length;s++)o[e[s]]?o[e[s]]++:(o[e[s]]=1,i.push({display:t[s],filter:e[s],sort:r[s],type:n[s]})),this.s.rowData.totalOptions++}else"string"==typeof this.s.colOpts.orthogonal?(o[e]?o[e]++:(o[e]=1,i.push({display:t,filter:e,sort:r,type:n})),this.s.rowData.totalOptions++):i.push({display:t,filter:e,sort:r,type:n})},c.prototype._addRow=function(e,t,r,n,i,o,s){for(var a,l=0,c=this.s.indexes;l<c.length;l++){var u=c[l];u.filter===t&&(a=u.index)}return void 0===a&&(a=this.s.indexes.length,this.s.indexes.push({filter:t,index:a})),this.s.dtPane.row.add({className:s,display:""!==e?e:(!1!==this.s.colOpts.emptyMessage?this.s.colOpts:this.c).emptyMessage,filter:t,index:a,shown:r,sort:""!==i?i:(!1!==this.s.colOpts.emptyMessage?this.s.colOpts:this.c).emptyMessage,total:n,type:o})},c.prototype._adjustTopRow=function(){var e=this.dom.container.find("."+this.classes.subRowsContainer),t=this.dom.container.find(".dtsp-subRow1"),r=this.dom.container.find(".dtsp-subRow2"),n=this.dom.container.find("."+this.classes.topRow);(L(e[0]).width()<252||L(n[0]).width()<252)&&0!==L(e[0]).width()?(L(e[0]).addClass(this.classes.narrow),L(t[0]).addClass(this.classes.narrowSub).removeClass(this.classes.narrowSearch),L(r[0]).addClass(this.classes.narrowSub).removeClass(this.classes.narrowButton)):(L(e[0]).removeClass(this.classes.narrow),L(t[0]).removeClass(this.classes.narrowSub).addClass(this.classes.narrowSearch),L(r[0]).removeClass(this.classes.narrowSub).addClass(this.classes.narrowButton))},c.prototype._buildPane=function(e,t,r,n,i){var o=this,s=(void 0===e&&(e=[]),void 0===t&&(t=!1),void 0===r&&(r=null),void 0===n&&(n=null),void 0===i&&(i=null),this.selections=[],this.s.dt),a=s.column(this.colExists?this.s.index:0),l=this.s.colOpts,c=this.s.rowData,u=s.i18n("searchPanes.count","{total}"),d=s.i18n("searchPanes.countFiltered","{shown} ({total})"),h=s.state.loaded();if(this.s.listSet&&(h=s.state()),this.colExists){var p=-1;if(h&&h.searchPanes&&h.searchPanes.panes)for(var f=0;f<h.searchPanes.panes.length;f++)if(h.searchPanes.panes[f].id===this.s.index){p=f;break}if((!1===l.show||void 0!==l.show&&!0!==l.show)&&-1===p)return this.dom.container.addClass(this.classes.hidden),this.s.displayed=!1;if(!0!==l.show&&-1===p||(this.s.displayed=!0),this.s.dt.page.info().serverSide||null!==r&&null!==r.searchPanes&&null!==r.searchPanes.options){if(null!==r&&null!==r.searchPanes&&null!==r.searchPanes.options){void 0!==r.tableLength?(this.s.tableLength=r.tableLength,this.s.rowData.totalOptions=this.s.tableLength):(null===this.s.tableLength||s.rows()[0].length>this.s.tableLength)&&(this.s.tableLength=s.rows()[0].length,this.s.rowData.totalOptions=this.s.tableLength);var g=s.column(this.s.index).dataSrc();if(void 0!==r.searchPanes.options[g])for(var m=0,y=r.searchPanes.options[g];m<y.length;m++){var v=y[m];this.s.rowData.arrayFilter.push({display:v.label,filter:v.value,sort:v.label,type:v.label}),this.s.rowData.bins[v.value]=this.c.viewTotal||this.c.cascadePanes?v.count:v.total,this.s.rowData.binsTotal[v.value]=v.total}g=Object.keys(c.binsTotal).length,b=this._uniqueRatio(g,this.s.tableLength);if(!1===this.s.displayed&&((void 0===l.show&&null===l.threshold?b>this.c.threshold:b>l.threshold)||!0!==l.show&&g<=1))return this.dom.container.addClass(this.classes.hidden),void(this.s.displayed=!1);this.s.rowData.arrayOriginal=this.s.rowData.arrayFilter,this.s.rowData.binsOriginal=this.s.rowData.bins,this.s.displayed=!0}}else{if(0===c.arrayFilter.length){if(this._populatePane(t),this.s.rowData.totalOptions=0,this._detailsPane(),h&&h.searchPanes&&h.searchPanes.panes&&-1===p)return this.dom.container.addClass(this.classes.hidden),void(this.s.displayed=!1);c.arrayOriginal=c.arrayTotals,c.binsOriginal=c.binsTotal}var g=Object.keys(c.binsOriginal).length,b=this._uniqueRatio(g,s.rows()[0].length);if(!1===this.s.displayed&&((void 0===l.show&&null===l.threshold?b>this.c.threshold:b>l.threshold)||!0!==l.show&&g<=1))return this.dom.container.addClass(this.classes.hidden),void(this.s.displayed=!1);this.c.viewTotal&&0===c.arrayTotals.length?(this.s.rowData.totalOptions=0,this._detailsPane()):c.binsTotal=c.bins,this.dom.container.addClass(this.classes.show),this.s.displayed=!0}}else this.s.displayed=!0;this._displayPane(),this.s.listSet||this.dom.dtP.on("stateLoadParams.dt",function(e,t,r){L.isEmptyObject(s.state.loaded())&&L.each(r,function(e,t){delete r[e]})}),null!==i&&0<L(this.dom.panesContainer).has(i).length?L(this.dom.container).insertAfter(i):L(this.dom.panesContainer).prepend(this.dom.container);t=L.fn.dataTable.ext.errMode,L.fn.dataTable.ext.errMode="none",b=F.Scroller;if(this.s.dtPane=L(this.dom.dtP).DataTable(L.extend(!0,{columnDefs:[{className:"dtsp-nameColumn",data:"display",render:function(e,t,r){if("sort"===t)return r.sort;if("type"===t)return r.type;var n=((o.s.filteringActive||o.s.showFiltered)&&o.c.viewTotal?d:u).replace(/{total}/,r.total);for(n=n.replace(/{shown}/,r.shown);-1!==n.indexOf("{total}");)n=n.replace(/{total}/,r.total);for(;-1!==n.indexOf("{shown}");)n=n.replace(/{shown}/,r.shown);t='<span class="'+o.classes.pill+'">'+n+"</span>";return(o.c.hideCount||l.hideCount)&&(t=""),'<div class="'+o.classes.nameCont+'"><span title="'+("string"==typeof e&&null!==e.match(/<[^>]*>/)?e.replace(/<[^>]*>/g,""):e)+'" class="'+o.classes.name+'">'+e+"</span>"+t+"</div>"},targets:0,type:void 0!==s.settings()[0].aoColumns[this.s.index]?s.settings()[0].aoColumns[this.s.index]._sManualType:null},{className:"dtsp-countColumn "+this.classes.badgePill,data:"shown",orderData:[1,2],targets:1,visible:!1},{data:"total",targets:2,visible:!1}],deferRender:!0,dom:"t",info:!1,language:this.s.dt.settings()[0].oLanguage,paging:!!b,scrollX:!1,scrollY:"200px",scroller:!!b,select:!0,stateSave:!!s.settings()[0].oFeatures.bStateSave},this.c.dtOpts,void 0!==l?l.dtOpts:{},void 0===this.s.colOpts.options&&this.colExists?void 0:{createdRow:function(e,t,r){L(e).addClass(t.className)}},null!==this.customPaneSettings&&void 0!==this.customPaneSettings.dtOpts?this.customPaneSettings.dtOpts:{})),L(this.dom.dtP).addClass(this.classes.table),L(this.dom.searchBox).attr("placeholder",void 0!==l.header?l.header:this.colExists?s.settings()[0].aoColumns[this.s.index].sTitle:this.customPaneSettings.header||"Custom Pane"),L.fn.dataTable.select.init(this.s.dtPane),L.fn.dataTable.ext.errMode=t,this.colExists){var g=(g=a.search())?g.substr(1,g.length-2).split("|"):[],w=0;c.arrayFilter.forEach(function(e){""===e.filter&&w++});for(var f=0,C=c.arrayFilter.length;f<C;f++){for(var E=!1,T=0,S=this.s.serverSelect;T<S.length;T++)S[T].filter===c.arrayFilter[f].filter&&(E=!0);if(this.s.dt.page.info().serverSide&&(!this.c.cascadePanes||this.c.cascadePanes&&0!==c.bins[c.arrayFilter[f].filter]||this.c.cascadePanes&&null!==n||E))for(var _=this._addRow(c.arrayFilter[f].display,c.arrayFilter[f].filter,(n?c.binsTotal:c.bins)[c.arrayFilter[f].filter],this.c.viewTotal||n?String(c.binsTotal[c.arrayFilter[f].filter]):c.bins[c.arrayFilter[f].filter],c.arrayFilter[f].sort,c.arrayFilter[f].type),x=0,R=this.s.serverSelect;x<R.length;x++)R[x].filter===c.arrayFilter[f].filter&&(this.s.serverSelecting=!0,_.select(),this.s.serverSelecting=!1);else this.s.dt.page.info().serverSide||!c.arrayFilter[f]||void 0===c.bins[c.arrayFilter[f].filter]&&this.c.cascadePanes?this.s.dt.page.info().serverSide||this._addRow("",w,w,"","",""):this._addRow(c.arrayFilter[f].display,c.arrayFilter[f].filter,c.bins[c.arrayFilter[f].filter],c.binsTotal[c.arrayFilter[f].filter],c.arrayFilter[f].sort,c.arrayFilter[f].type)}}F.select.init(this.s.dtPane),(void 0!==l.options||null!==this.customPaneSettings&&void 0!==this.customPaneSettings.options)&&this._getComparisonRows(),this.s.dtPane.draw(),this._adjustTopRow(),this.s.listSet||(this._setListeners(),this.s.listSet=!0);for(var A=0,N=e;A<N.length;A++){var O=N[A];if(void 0!==O)for(var I=0,M=this.s.dtPane.rows().indexes().toArray();I<M.length;I++){_=M[I];void 0!==this.s.dtPane.row(_).data()&&O.filter===this.s.dtPane.row(_).data().filter&&(this.s.dt.page.info().serverSide?(this.s.serverSelecting=!0,this.s.dtPane.row(_).select(),this.s.serverSelecting=!1):this.s.dtPane.row(_).select())}}if(this.s.dt.page.info().serverSide&&this.s.dtPane.search(L(this.dom.searchBox).val()).draw(),h&&h.searchPanes&&h.searchPanes.panes&&(null===r||1===r.draw)){this.c.cascadePanes||this._reloadSelect(h);for(var k=0,D=h.searchPanes.panes;k<D.length;k++){var P=D[k];P.id===this.s.index&&(L(this.dom.searchBox).val(P.searchTerm),L(this.dom.searchBox).trigger("input"),this.s.dtPane.order(P.order).draw())}}return this.s.dt.state.save(),!0},c.prototype._detailsPane=function(){var e=this.s.dt,t=(this.s.rowData.arrayTotals=[],this.s.rowData.binsTotal={},this.s.dt.settings()[0]),e=e.rows().indexes();if(!this.s.dt.page.info().serverSide)for(var r=0,n=e;r<n.length;r++){var i=n[r];this._populatePaneArray(i,this.s.rowData.arrayTotals,t,this.s.rowData.binsTotal)}},c.prototype._displayPane=function(){var e=this.dom.container,t=this.s.colOpts,r=parseInt(this.c.layout.split("-")[1],10);L(this.dom.topRow).empty(),L(this.dom.dtP).empty(),L(this.dom.topRow).addClass(this.classes.topRow),3<r&&L(this.dom.container).addClass(this.classes.smallGap),L(this.dom.topRow).addClass(this.classes.subRowsContainer),L(this.dom.upper).appendTo(this.dom.topRow),L(this.dom.lower).appendTo(this.dom.topRow),L(this.dom.searchCont).appendTo(this.dom.upper),L(this.dom.buttonGroup).appendTo(this.dom.lower),!1!==this.c.dtOpts.searching&&(void 0===t.dtOpts||!1!==t.dtOpts.searching)&&this.c.controls&&t.controls&&(null===this.customPaneSettings||void 0===this.customPaneSettings.dtOpts||void 0===this.customPaneSettings.dtOpts.searching||this.customPaneSettings.dtOpts.searching)||L(this.dom.searchBox).attr("disabled","disabled").removeClass(this.classes.paneInputButton).addClass(this.classes.disabledButton),L(this.dom.searchBox).appendTo(this.dom.searchCont),this._searchContSetup(),this.c.clear&&this.c.controls&&t.controls&&L(this.dom.clear).appendTo(this.dom.buttonGroup),this.c.orderable&&t.orderable&&this.c.controls&&t.controls&&L(this.dom.nameButton).appendTo(this.dom.buttonGroup),!this.c.hideCount&&!t.hideCount&&this.c.orderable&&t.orderable&&this.c.controls&&t.controls&&L(this.dom.countButton).appendTo(this.dom.buttonGroup),L(this.dom.topRow).prependTo(this.dom.container),L(e).append(this.dom.dtP),L(e).show()},c.prototype._getBonusOptions=function(){return L.extend(!0,{},c.defaults,{orthogonal:{threshold:null},threshold:null},void 0!==this.c?this.c:{})},c.prototype._getComparisonRows=function(){var e=this.s.colOpts,e=void 0!==e.options?e.options:null!==this.customPaneSettings&&void 0!==this.customPaneSettings.options?this.customPaneSettings.options:void 0;if(void 0!==e){var t=this.s.dt.rows({search:"applied"}).data().toArray(),r=this.s.dt.rows({search:"applied"}),n=this.s.dt.rows().data().toArray(),i=this.s.dt.rows(),o=[];this.s.dtPane.clear();for(var s=0,a=e;s<a.length;s++){var l=a[s],c=""!==l.label?l.label:this.c.emptyMessage,u={className:l.className,display:c,filter:"function"==typeof l.value?l.value:[],shown:0,sort:c,total:0,type:c};if("function"==typeof l.value){for(var d=0;d<t.length;d++)l.value.call(this.s.dt,t[d],r[0][d])&&u.shown++;for(var h=0;h<n.length;h++)l.value.call(this.s.dt,n[h],i[0][h])&&u.total++;"function"!=typeof u.filter&&u.filter.push(l.filter)}(!this.c.cascadePanes||this.c.cascadePanes&&0!==u.shown)&&o.push(this._addRow(u.display,u.filter,u.shown,u.total,u.sort,u.type,u.className))}return o}},c.prototype._getOptions=function(){var e=this.s.dt;return L.extend(!0,{},c.defaults,{emptyMessage:!1,orthogonal:{threshold:null},threshold:null},e.settings()[0].aoColumns[this.s.index].searchPanes)},c.prototype._makeSelection=function(){this.updateTable(),this.s.updating=!0,this.s.dt.draw(),this.s.updating=!1},c.prototype._populatePane=function(e){void 0===e&&(e=!1);var t=this.s.dt,r=(this.s.rowData.arrayFilter=[],this.s.rowData.bins={},this.s.dt.settings()[0]);if(!this.s.dt.page.info().serverSide)for(var n=0,i=(!this.c.cascadePanes&&!this.c.viewTotal||this.s.clearing||e?t.rows():t.rows({search:"applied"})).indexes().toArray();n<i.length;n++){var o=i[n];this._populatePaneArray(o,this.s.rowData.arrayFilter,r)}},c.prototype._populatePaneArray=function(e,t,r,n){void 0===n&&(n=this.s.rowData.bins);var i,o=this.s.colOpts;"string"==typeof o.orthogonal?(i=r.oApi._fnGetCellData(r,e,this.s.index,o.orthogonal),this.s.rowData.filterMap.set(e,i),this._addOption(i,i,i,i,t,n)):("string"==typeof(i=null===(i=r.oApi._fnGetCellData(r,e,this.s.index,o.orthogonal.search))?"":i)&&(i=i.replace(/<[^>]*>/g,"")),this.s.rowData.filterMap.set(e,i),n[i]?n[i]++:(n[i]=1,this._addOption(i,r.oApi._fnGetCellData(r,e,this.s.index,o.orthogonal.display),r.oApi._fnGetCellData(r,e,this.s.index,o.orthogonal.sort),r.oApi._fnGetCellData(r,e,this.s.index,o.orthogonal.type),t,n)),this.s.rowData.totalOptions++)},c.prototype._reloadSelect=function(e){if(void 0!==e){for(var t,r=0;r<e.searchPanes.panes.length;r++)if(e.searchPanes.panes[r].id===this.s.index){t=r;break}if(void 0!==t)for(var n=this.s.dtPane,i=n.rows({order:"index"}).data().map(function(e){return null!==e.filter?e.filter.toString():null}).toArray(),o=0,s=e.searchPanes.panes[t].selected;o<s.length;o++){var a=s[o],l=-1;-1<(l=null!==a?i.indexOf(a.toString()):l)&&(this.s.serverSelecting=!0,n.row(l).select(),this.s.serverSelecting=!1)}}},c.prototype._search=function(e,t){for(var r=this.s.colOpts,n=this.s.dt,i=0,o=this.selections;i<o.length;i++){var s=o[i];if("string"==typeof s.filter&&(s.filter=s.filter.replaceAll("&amp;","&")),Array.isArray(e)){if(-1!==e.indexOf(s.filter))return!0}else if("function"==typeof s.filter){if(s.filter.call(n,n.row(t).data(),t)){if("or"===r.combiner)return!0}else if("and"===r.combiner)return!1}else if(e===s.filter||("string"!=typeof e||0!==e.length)&&e==s.filter||null===s.filter&&"string"==typeof e&&""===e)return!0}return"and"===r.combiner},c.prototype._searchContSetup=function(){this.c.controls&&this.s.colOpts.controls&&L(this.dom.searchButton).appendTo(this.dom.searchLabelCont),!1===this.c.dtOpts.searching||!1===this.s.colOpts.dtOpts.searching||null!==this.customPaneSettings&&void 0!==this.customPaneSettings.dtOpts&&void 0!==this.customPaneSettings.dtOpts.searching&&!this.customPaneSettings.dtOpts.searching||L(this.dom.searchLabelCont).appendTo(this.dom.searchCont)},c.prototype._searchExtras=function(){var e=this.s.updating,t=(this.s.updating=!0,this.s.dtPane.rows({selected:!0}).data().pluck("filter").toArray()),r=t.indexOf((!1!==this.s.colOpts.emptyMessage?this.s.colOpts:this.c).emptyMessage),n=L(this.s.dtPane.table().container());-1<r&&(t[r]=""),0<t.length?n.addClass(this.classes.selected):0===t.length&&n.removeClass(this.classes.selected),this.s.updating=e},c.prototype._uniqueRatio=function(e,t){return 0<t&&(0<this.s.rowData.totalOptions&&!this.s.dt.page.info().serverSide||this.s.dt.page.info().serverSide&&0<this.s.tableLength)?e/this.s.rowData.totalOptions:1},c.prototype._updateCommon=function(e){if(void 0===e&&(e=!1),!this.s.dt.page.info().serverSide&&void 0!==this.s.dtPane&&(!this.s.filteringActive||this.c.cascadePanes||!0===e)&&(!0!==this.c.cascadePanes||!0!==this.s.selectPresent)&&(!this.s.lastSelect||!this.s.lastCascade)){var e=this.s.colOpts,n=this.s.dtPane.rows({selected:!0}).data().toArray(),t=L(this.s.dtPane.table().node()).parent()[0].scrollTop,i=this.s.rowData;if(this.s.dtPane.clear(),this.colExists){0===i.arrayFilter.length?this._populatePane():this.c.cascadePanes&&this.s.dt.rows().data().toArray().length===this.s.dt.rows({search:"applied"}).data().toArray().length?(i.arrayFilter=i.arrayOriginal,i.bins=i.binsOriginal):(this.c.viewTotal||this.c.cascadePanes)&&this._populatePane(),this.c.viewTotal?this._detailsPane():i.binsTotal=i.bins,this.c.viewTotal&&!this.c.cascadePanes&&(i.arrayFilter=i.arrayTotals);for(var o=this,r=0,s=i.arrayFilter;r<s.length;r++)!function(t){var e,r;t&&(void 0!==i.bins[t.filter]&&0!==i.bins[t.filter]&&o.c.cascadePanes||!o.c.cascadePanes||o.s.clearing)&&(e=o._addRow(t.display,t.filter,!o.c.viewTotal||void 0!==i.bins[t.filter]?i.bins[t.filter]:0,o.c.viewTotal?String(i.binsTotal[t.filter]):i.bins[t.filter],t.sort,t.type),-1!==(r=n.findIndex(function(e){return e.filter===t.filter})))&&(e.select(),n.splice(r,1))}(s[r])}if(void 0!==e.searchPanes&&void 0!==e.searchPanes.options||void 0!==e.options||null!==this.customPaneSettings&&void 0!==this.customPaneSettings.options)for(var a=0,l=this._getComparisonRows();a<l.length;a++)!function(t){var e=n.findIndex(function(e){if(e.display===t.data().display)return!0});-1!==e&&(t.select(),n.splice(e,1))}(h=l[a]);for(var c=0,u=n;c<u.length;c++){var d=u[c],h=this._addRow(d.display,d.filter,0,this.c.viewTotal?d.total:0,d.display,d.display);this.s.updating=!0,h.select(),this.s.updating=!1}this.s.dtPane.draw(),this.s.dtPane.table().node().parentNode.scrollTop=t}},c.version="1.1.0",c.classes={buttonGroup:"dtsp-buttonGroup",buttonSub:"dtsp-buttonSub",clear:"dtsp-clear",clearAll:"dtsp-clearAll",clearButton:"clearButton",container:"dtsp-searchPane",countButton:"dtsp-countButton",disabledButton:"dtsp-disabledButton",dull:"dtsp-dull",hidden:"dtsp-hidden",hide:"dtsp-hide",layout:"dtsp-",name:"dtsp-name",nameButton:"dtsp-nameButton",nameCont:"dtsp-nameCont",narrow:"dtsp-narrow",paneButton:"dtsp-paneButton",paneInputButton:"dtsp-paneInputButton",pill:"dtsp-pill",search:"dtsp-search",searchCont:"dtsp-searchCont",searchIcon:"dtsp-searchIcon",searchLabelCont:"dtsp-searchButtonCont",selected:"dtsp-selected",smallGap:"dtsp-smallGap",subRow1:"dtsp-subRow1",subRow2:"dtsp-subRow2",subRowsContainer:"dtsp-subRowsContainer",title:"dtsp-title",topRow:"dtsp-topRow"},c.defaults={cascadePanes:!1,clear:!0,combiner:"or",controls:!0,container:function(e){return e.table().container()},dtOpts:{},emptyMessage:"<i>No Data</i>",hideCount:!1,layout:"columns-3",name:void 0,orderable:!0,orthogonal:{display:"display",filter:"filter",hideCount:!1,search:"filter",show:void 0,sort:"sort",threshold:.6,type:"type"},preSelect:[],threshold:.6,viewTotal:!1};var S,s,d=c;function c(e,t,r,n,i,o){var s,a,l=this;if(void 0===o&&(o=null),!F||!F.versionCheck||!F.versionCheck("1.10.0"))throw new Error("SearchPane requires DataTables 1.10 or newer");if(F.select)return e=new F.Api(e),this.classes=L.extend(!0,{},c.classes),this.c=L.extend(!0,{},c.defaults,t),this.customPaneSettings=o,this.s={cascadeRegen:!1,clearing:!1,colOpts:[],deselect:!1,displayed:!1,dt:e,dtPane:void 0,filteringActive:!1,index:r,indexes:[],lastCascade:!1,lastSelect:!1,listSet:!1,name:void 0,redraw:!1,rowData:{arrayFilter:[],arrayOriginal:[],arrayTotals:[],bins:{},binsOriginal:{},binsTotal:{},filterMap:new Map,totalOptions:0},scrollTop:0,searchFunction:void 0,selectPresent:!1,serverSelect:[],serverSelecting:!1,showFiltered:!1,tableLength:null,updating:!1},t=e.columns().eq(0).toArray().length,this.colExists=this.s.index<t,this.c.layout=n,o=parseInt(n.split("-")[1],10),this.dom={buttonGroup:L("<div/>").addClass(this.classes.buttonGroup),clear:L('<button type="button">&#215;</button>').addClass(this.classes.dull).addClass(this.classes.paneButton).addClass(this.classes.clearButton),container:L("<div/>").addClass(this.classes.container).addClass(this.classes.layout+(o<10?n:n.split("-")[0]+"-9")),countButton:L('<button type="button"></button>').addClass(this.classes.paneButton).addClass(this.classes.countButton),dtP:L("<table><thead><tr><th>"+(this.colExists?L(e.column(this.colExists?this.s.index:0).header()).text():this.customPaneSettings.header||"Custom Pane")+"</th><th/></tr></thead></table>"),lower:L("<div/>").addClass(this.classes.subRow2).addClass(this.classes.narrowButton),nameButton:L('<button type="button"></button>').addClass(this.classes.paneButton).addClass(this.classes.nameButton),panesContainer:i,searchBox:L("<input/>").addClass(this.classes.paneInputButton).addClass(this.classes.search),searchButton:L('<button type = "button" class="'+this.classes.searchIcon+'"></button>').addClass(this.classes.paneButton),searchCont:L("<div/>").addClass(this.classes.searchCont),searchLabelCont:L("<div/>").addClass(this.classes.searchLabelCont),topRow:L("<div/>").addClass(this.classes.topRow),upper:L("<div/>").addClass(this.classes.subRow1).addClass(this.classes.narrowSearch)},this.s.displayed=!1,e=this.s.dt,this.selections=[],this.s.colOpts=this.colExists?this._getOptions():this._getBonusOptions(),s=this.s.colOpts,r=L('<button type="button">X</button>').addClass(this.classes.paneButton),L(r).text(e.i18n("searchPanes.clearPane","X")),this.dom.container.addClass(s.className),this.dom.container.addClass(null!==this.customPaneSettings&&void 0!==this.customPaneSettings.className?this.customPaneSettings.className:""),void 0!==this.s.colOpts.name?this.s.name=this.s.colOpts.name:null!==this.customPaneSettings&&void 0!==this.customPaneSettings.name?this.s.name=this.customPaneSettings.name:this.s.name=this.colExists?L(e.column(this.s.index).header()).text():this.customPaneSettings.header||"Custom Pane",L(i).append(this.dom.container),a=e.table(0).node(),this.s.searchFunction=function(e,t,r,n){return 0===l.selections.length||e.nTable!==a||(e=null,l.colExists&&(e=t[l.s.index],"filter"!==s.orthogonal.filter)&&(e=l.s.rowData.filterMap.get(r))instanceof L.fn.dataTable.Api&&(e=e.toArray()),l._search(e,r))},L.fn.dataTable.ext.search.push(this.s.searchFunction),this.c.clear&&L(r).on("click",function(){l.dom.container.find(l.classes.search).each(function(){L(this).val(""),L(this).trigger("input")}),l.clearPane()}),e.on("draw.dtsp",function(){l._adjustTopRow()}),e.on("buttons-action",function(){l._adjustTopRow()}),L(window).on("resize.dtsp",F.util.throttle(function(){l._adjustTopRow()})),e.on("column-reorder.dtsp",function(e,t,r){l.s.index=r.mapping[l.s.index]}),this;throw new Error("SearchPane requires Select")}i.prototype.clearSelections=function(){this.dom.container.find(this.classes.search).each(function(){S(this).val(""),S(this).trigger("input")});for(var e=[],t=0,r=this.s.panes;t<r.length;t++){var n=r[t];void 0!==n.s.dtPane&&e.push(n.clearPane())}return this.s.dt.draw(),e},i.prototype.getNode=function(){return this.dom.container},i.prototype.rebuild=function(e,t){void 0===e&&(e=!1),void 0===t&&(t=!1),S(this.dom.emptyMessage).remove();var r=[];!1===e&&S(this.dom.panes).empty();for(var n=0,i=this.s.panes;n<i.length;n++){var o=i[n];!1!==e&&o.s.index!==e||(o.clearData(),r.push(o.rebuildPane(void 0!==this.s.selectionList[this.s.selectionList.length-1]&&o.s.index===this.s.selectionList[this.s.selectionList.length-1].index,this.s.dt.page.info().serverSide?this.s.serverData:void 0,null,t)),S(this.dom.panes).append(o.dom.container))}return this.s.dt.page.info().serverSide||this.s.dt.draw(),this.c.cascadePanes||this.c.viewTotal?this.redrawPanes(!0):this._updateSelection(),this._updateFilterCount(),this._attachPaneContainer(),this.s.dt.draw(),1===r.length?r[0]:r},i.prototype.redrawPanes=function(e){void 0===e&&(e=!1);var t=this.s.dt;if(!this.s.updating&&!this.s.dt.page.info().serverSide){var r=!0,n=this.s.filterPane;if(t.rows({search:"applied"}).data().toArray().length===t.rows().data().toArray().length)r=!1;else if(this.c.viewTotal)for(var i=0,o=this.s.panes;i<o.length;i++)if(void 0!==(x=o[i]).s.dtPane){var s=x.s.dtPane.rows({selected:!0}).data().toArray().length;if(0===s)for(var a=0,l=this.s.selectionList;a<l.length;a++){var c=l[a];c.index===x.s.index&&0!==c.rows.length&&(s=c.rows.length)}0<s&&-1===n?n=x.s.index:0<s&&(n=null)}var u=void 0,d=[];if(this.regenerating){T=-1;1===d.length&&(T=d[0].index);for(var h=0,p=this.s.panes;h<p.length;h++)void 0!==(x=p[h]).s.dtPane&&(x.s.filteringActive=I=!0,(-1!==n&&null!==n&&n===x.s.index||!1===r||x.s.index===T)&&(x.s.filteringActive=I=!1),x.updatePane(I&&r));this._updateFilterCount()}else{for(var f,g=0,m=this.s.panes;g<m.length;g++){if((x=m[g]).s.selectPresent){this.s.selectionList.push({index:x.s.index,rows:x.s.dtPane.rows({selected:!0}).data().toArray(),protect:!1}),t.state.save();break}x.s.deselect&&(u=x.s.index,0<(f=x.s.dtPane.rows({selected:!0}).data().toArray()).length)&&this.s.selectionList.push({index:x.s.index,rows:f,protect:!0})}if(0<this.s.selectionList.length)for(var y=this.s.selectionList[this.s.selectionList.length-1].index,v=0,b=this.s.panes;v<b.length;v++)(x=b[v]).s.lastSelect=x.s.index===y;for(var w=0;w<this.s.selectionList.length;w++)if(this.s.selectionList[w].index!==u||!0===this.s.selectionList[w].protect){for(var C=!1,E=w+1;E<this.s.selectionList.length;E++)this.s.selectionList[E].index===this.s.selectionList[w].index&&(C=!0);C||(d.push(this.s.selectionList[w]),this.s.selectionList[w].protect=!1)}var T=-1;1===d.length&&(T=d[0].index);for(var S=0,_=this.s.panes;S<_.length;S++)void 0!==(x=_[S]).s.dtPane&&(x.s.filteringActive=I=!0,(-1!==n&&null!==n&&n===x.s.index||!1===r||x.s.index===T)&&(x.s.filteringActive=I=!1),x.updatePane(!!I&&r));if(this._updateFilterCount(),0<d.length&&(d.length<this.s.selectionList.length||e)){this._cascadeRegen(d);for(var x,y=d[d.length-1].index,R=0,A=this.s.panes;R<A.length;R++)(x=A[R]).s.lastSelect=x.s.index===y}else if(0<d.length)for(var N=0,O=this.s.panes;N<O.length;N++){var I,M=O[N];void 0!==M.s.dtPane&&(M.s.filteringActive=I=!0,(-1!==n&&null!==n&&n===M.s.index||!1===r)&&(M.s.filteringActive=I=!1),M.updatePane(I&&r))}}r||(this.s.selectionList=[])}},i.prototype._attach=function(){var e=this;S(this.dom.container).removeClass(this.classes.hide),S(this.dom.titleRow).removeClass(this.classes.hide),S(this.dom.titleRow).remove(),S(this.dom.title).appendTo(this.dom.titleRow),this.c.clear&&(S(this.dom.clearAll).appendTo(this.dom.titleRow),S(this.dom.clearAll).on("click.dtsps",function(){e.clearSelections()})),S(this.dom.titleRow).appendTo(this.dom.container);for(var t=0,r=this.s.panes;t<r.length;t++){var n=r[t];S(n.dom.container).appendTo(this.dom.panes)}return S(this.dom.panes).appendTo(this.dom.container),0===S("div."+this.classes.container).length&&S(this.dom.container).prependTo(this.s.dt),this.dom.container},i.prototype._attachExtras=function(){return S(this.dom.container).removeClass(this.classes.hide),S(this.dom.titleRow).removeClass(this.classes.hide),S(this.dom.titleRow).remove(),S(this.dom.title).appendTo(this.dom.titleRow),this.c.clear&&S(this.dom.clearAll).appendTo(this.dom.titleRow),S(this.dom.titleRow).appendTo(this.dom.container),this.dom.container},i.prototype._attachMessage=function(){var t;try{t=this.s.dt.i18n("searchPanes.emptyPanes","No SearchPanes")}catch(e){t=null}if(null!==t)return S(this.dom.container).removeClass(this.classes.hide),S(this.dom.titleRow).addClass(this.classes.hide),S(this.dom.emptyMessage).text(t),this.dom.emptyMessage.appendTo(this.dom.container),this.dom.container;S(this.dom.container).addClass(this.classes.hide),S(this.dom.titleRow).removeClass(this.classes.hide)},i.prototype._attachPaneContainer=function(){for(var e=0,t=this.s.panes;e<t.length;e++)if(!0===t[e].s.displayed)return this._attach();return this._attachMessage()},i.prototype._cascadeRegen=function(e){this.regenerating=!0;var t=-1;1===e.length&&(t=e[0].index);for(var r=0,n=this.s.panes;r<n.length;r++)(i=n[r]).setCascadeRegen(!0),i.setClear(!0),(void 0!==i.s.dtPane&&i.s.index===t||void 0!==i.s.dtPane)&&i.clearPane(),i.setClear(!1);this._makeCascadeSelections(e),this.s.selectionList=e;for(var i,o=0,s=this.s.panes;o<s.length;o++)(i=s[o]).setCascadeRegen(!1);this.regenerating=!1},i.prototype._checkMessage=function(){for(var e=0,t=this.s.panes;e<t.length;e++)if(!0===t[e].s.displayed)return;return this._attachMessage()},i.prototype._getState=function(){var e=this.s.dt.state.loaded();e&&e.searchPanes&&void 0!==e.searchPanes.selectionList&&(this.s.selectionList=e.searchPanes.selectionList)},i.prototype._makeCascadeSelections=function(n){for(var i=0;i<n.length;i++)for(var e=function(r){if(r.s.index===n[i].index&&void 0!==r.s.dtPane){i===n.length-1&&(r.s.lastCascade=!0),0<r.s.dtPane.rows({selected:!0}).data().toArray().length&&void 0!==r.s.dtPane&&(r.setClear(!0),r.clearPane(),r.setClear(!1));for(var e=0,t=n[i].rows;e<t.length;e++)!function(t){r.s.dtPane.rows().every(function(e){void 0!==r.s.dtPane.row(e).data()&&void 0!==t&&r.s.dtPane.row(e).data().filter===t.filter&&r.s.dtPane.row(e).select()})}(t[e]);o._updateFilterCount(),r.s.lastCascade=!1}},o=this,t=0,r=this.s.panes;t<r.length;t++)e(r[t]);this.s.dt.state.save()},i.prototype._paneDeclare=function(e,t,r){for(var n=this,i=(e.columns(0<this.c.columns.length?this.c.columns:void 0).eq(0).each(function(e){n.s.panes.push(new d(t,r,e,n.c.layout,n.dom.panes))}),e.columns().eq(0).toArray().length),o=this.c.panes.length,s=0;s<o;s++)this.s.panes.push(new d(t,r,i+s,this.c.layout,this.dom.panes,this.c.panes[s]));if(0<this.c.order.length){var a=this.c.order.map(function(e,t,r){return n._findPane(e)});this.dom.panes.empty(),this.s.panes=a;for(var l=0,c=this.s.panes;l<c.length;l++){var u=c[l];this.dom.panes.append(u.dom.container)}}this.s.dt.settings()[0]._bInitComplete?this._startup(e):this.s.dt.settings()[0].aoInitComplete.push({fn:function(){n._startup(e)}})},i.prototype._findPane=function(e){for(var t=0,r=this.s.panes;t<r.length;t++){var n=r[t];if(e===n.s.name)return n}},i.prototype._serverTotals=function(){for(var e,t=!1,r=!1,n=this.s.dt,i=0,o=this.s.panes;i<o.length;i++){if((C=o[i]).s.selectPresent){this.s.selectionList.push({index:C.s.index,rows:C.s.dtPane.rows({selected:!0}).data().toArray(),protect:!1}),n.state.save(),t=!(C.s.selectPresent=!1);break}C.s.deselect&&(0<(e=C.s.dtPane.rows({selected:!0}).data().toArray()).length&&this.s.selectionList.push({index:C.s.index,rows:e,protect:!0}),r=t=!0)}if(t){for(var s=[],a=0;a<this.s.selectionList.length;a++){for(var l=!1,c=a+1;c<this.s.selectionList.length;c++)this.s.selectionList[c].index===this.s.selectionList[a].index&&(l=!0);if(!l){for(var u=!1,d=0,h=this.s.panes;d<h.length;d++)(C=h[d]).s.index===this.s.selectionList[a].index&&0<C.s.dtPane.rows({selected:!0}).data().toArray().length&&(u=!0);u&&s.push(this.s.selectionList[a])}}this.s.selectionList=s}else this.s.selectionList=[];var p=-1;if(r&&1===this.s.selectionList.length)for(var f=0,g=this.s.panes;f<g.length;f++)(C=g[f]).s.lastSelect=!1,C.s.deselect=!1,void 0!==C.s.dtPane&&0<C.s.dtPane.rows({selected:!0}).data().toArray().length&&(p=C.s.index);else if(0<this.s.selectionList.length)for(var m=this.s.selectionList[this.s.selectionList.length-1].index,y=0,v=this.s.panes;y<v.length;y++)(C=v[y]).s.lastSelect=C.s.index===m,C.s.deselect=!1;else if(0===this.s.selectionList.length)for(var b=0,w=this.s.panes;b<w.length;b++)(C=w[b]).s.lastSelect=!1,C.s.deselect=!1;S(this.dom.panes).empty();for(var C,E=0,T=this.s.panes;E<T.length;E++)(C=T[E]).s.lastSelect?C._setListeners():C.rebuildPane(void 0,this.s.dt.page.info().serverSide?this.s.serverData:void 0,C.s.index===p||null,!0),S(this.dom.panes).append(C.dom.container),void 0!==C.s.dtPane&&(S(C.s.dtPane.table().node()).parent()[0].scrollTop=C.s.scrollTop,S.fn.dataTable.select.init(C.s.dtPane));this.s.dt.page.info().serverSide||this.s.dt.draw()},i.prototype._startup=function(r){var u=this,e=(S(this.dom.container).text(""),this._attachExtras(),S(this.dom.container).append(this.dom.panes),S(this.dom.panes).empty(),this.s.dt.state.loaded());if(this.c.viewTotal&&!this.c.cascadePanes&&null!=e&&void 0!==e.searchPanes&&void 0!==e.searchPanes.panes){for(var t=!1,n=0,i=e.searchPanes.panes;n<i.length;n++)if(0<(m=i[n]).selected.length){t=!0;break}if(t)for(var o=0,s=this.s.panes;o<s.length;o++)(m=s[o]).s.showFiltered=!0}for(var a=0,l=this.s.panes;a<l.length;a++)(m=l[a]).rebuildPane(void 0,0<Object.keys(this.s.serverData).length?this.s.serverData:void 0),S(this.dom.panes).append(m.dom.container);if(this.s.dt.page.info().serverSide||this.s.dt.draw(),this.s.stateRead||null==e||(this.s.dt.page(e.start/this.s.dt.page.len()),this.s.dt.draw("page")),this.s.stateRead=!0,this.c.viewTotal&&!this.c.cascadePanes)for(var c=0,d=this.s.panes;c<d.length;c++)(m=d[c]).updatePane();this._updateFilterCount(),this._checkMessage(),r.on("preDraw.dtsps",function(){u._updateFilterCount(),!u.c.cascadePanes&&!u.c.viewTotal||u.s.dt.page.info().serverSide?u._updateSelection():u.redrawPanes(),u.s.filterPane=-1}),this.s.dt.on("stateSaveParams.dtsp",function(e,t,r){void 0===r.searchPanes&&(r.searchPanes={}),r.searchPanes.selectionList=u.s.selectionList}),this.s.dt.page.info().serverSide?(r.off("page"),r.on("page",function(){u.s.page=u.s.dt.page()}),r.off("preXhr.dt"),r.on("preXhr.dt",function(e,t,r){void 0===r.searchPanes&&(r.searchPanes={});for(var n=0,i=0,o=u.s.panes;i<o.length;i++){var s=o[i],a=u.s.dt.column(s.s.index).dataSrc();if(void 0===r.searchPanes[a]&&(r.searchPanes[a]={}),void 0!==s.s.dtPane)for(var l=s.s.dtPane.rows({selected:!0}).data().toArray(),c=0;c<l.length;c++)r.searchPanes[a][c]=l[c].filter,n++}u.c.viewTotal&&u._prepViewTotal(),0<n&&(n!==u.s.filterCount?(r.start=0,u.s.page=0):r.start=u.s.page*u.s.dt.page.len(),u.s.dt.page(u.s.page),u.s.filterCount=n)})):r.on("preXhr.dt",function(e,t,r){for(var n=0,i=u.s.panes;n<i.length;n++)i[n].clearData()}),this.s.dt.on("xhr",function(e,t,r,n){var i=!1;u.s.dt.page.info().serverSide||u.s.dt.one("preDraw",function(){if(!i){var e=u.s.dt.page();i=!0,S(u.dom.panes).empty();for(var t=0,r=u.s.panes;t<r.length;t++){var n=r[t];n.clearData(),n.rebuildPane(void 0!==u.s.selectionList[u.s.selectionList.length-1]&&n.s.index===u.s.selectionList[u.s.selectionList.length-1].index,void 0,void 0,!0),S(u.dom.panes).append(n.dom.container)}u.s.dt.page.info().serverSide||u.s.dt.draw(),u.c.cascadePanes||u.c.viewTotal?u.redrawPanes(u.c.cascadePanes):u._updateSelection(),u._checkMessage(),u.s.dt.one("draw",function(){u.s.dt.page(e).draw(!1)})}})});for(var h=0,p=this.s.panes;h<p.length;h++)if(void 0!==(m=p[h])&&void 0!==m.s.dtPane&&(void 0!==m.s.colOpts.preSelect&&0<m.s.colOpts.preSelect.length||null!==m.customPaneSettings&&void 0!==m.customPaneSettings.preSelect&&0<m.customPaneSettings.preSelect.length)){for(var f=m.s.dtPane.rows().data().toArray().length,g=0;g<f;g++)(-1!==m.s.colOpts.preSelect.indexOf(m.s.dtPane.cell(g,0).data())||null!==m.customPaneSettings&&void 0!==m.customPaneSettings.preSelect&&-1!==m.customPaneSettings.preSelect.indexOf(m.s.dtPane.cell(g,0).data()))&&m.s.dtPane.row(g).select();m.updateTable()}if(void 0!==this.s.selectionList&&0<this.s.selectionList.length)for(var m,y=this.s.selectionList[this.s.selectionList.length-1].index,v=0,b=this.s.panes;v<b.length;v++)(m=b[v]).s.lastSelect=m.s.index===y;0<this.s.selectionList.length&&this.c.cascadePanes&&this._cascadeRegen(this.s.selectionList),this._updateFilterCount(),r.on("destroy.dtsps",function(){for(var e=0,t=u.s.panes;e<t.length;e++)t[e].destroy();r.off(".dtsps"),S(u.dom.clearAll).off(".dtsps"),S(u.dom.container).remove(),u.clearSelections()}),this.c.clear&&S(this.dom.clearAll).on("click.dtsps",function(){u.clearSelections()}),r.settings()[0]._searchPanes=this},i.prototype._prepViewTotal=function(){for(var e,t=this.s.filterPane,r=!1,n=0,i=this.s.panes;n<i.length;n++)void 0!==(o=i[n]).s.dtPane&&(0<(e=o.s.dtPane.rows({selected:!0}).data().toArray().length)&&-1===t?(t=o.s.index,r=!0):0<e&&(t=null));for(var o,s=0,a=this.s.panes;s<a.length;s++)void 0!==(o=a[s]).s.dtPane&&(o.s.filteringActive=!0,-1!==t&&null!==t&&t===o.s.index||!1===r)&&(o.s.filteringActive=!1)},i.prototype._updateFilterCount=function(){for(var e=0,t=0,r=this.s.panes;t<r.length;t++){var n=r[t];void 0!==n.s.dtPane&&(e+=n.getPaneCount())}var i=this.s.dt.i18n("searchPanes.title","Filters Active - %d",e);S(this.dom.title).text(i),void 0!==this.c.filterChanged&&"function"==typeof this.c.filterChanged&&this.c.filterChanged.call(this.s.dt,e)},i.prototype._updateSelection=function(){this.s.selectionList=[];for(var e=0,t=this.s.panes;e<t.length;e++){var r=t[e];void 0!==r.s.dtPane&&this.s.selectionList.push({index:r.s.index,rows:r.s.dtPane.rows({selected:!0}).data().toArray(),protect:!1})}this.s.dt.state.save()},i.version="1.2.2",i.classes={clear:"dtsp-clear",clearAll:"dtsp-clearAll",container:"dtsp-searchPanes",emptyMessage:"dtsp-emptyMessage",hide:"dtsp-hidden",panes:"dtsp-panesContainer",search:"dtsp-search",title:"dtsp-title",titleRow:"dtsp-titleRow"},i.defaults={cascadePanes:!1,clear:!0,container:function(e){return e.table().container()},columns:[],filterChanged:void 0,layout:"columns-3",order:[],panes:[],viewTotal:!1};var r,a=i;function i(t,r,e){var l=this;if(void 0===e&&(e=!1),this.regenerating=!1,!s||!s.versionCheck||!s.versionCheck("1.10.0"))throw new Error("SearchPane requires DataTables 1.10 or newer");if(!s.select)throw new Error("SearchPane requires Select");var n=new s.Api(t);if(this.classes=S.extend(!0,{},i.classes),this.c=S.extend(!0,{},i.defaults,r),this.dom={clearAll:S('<button type="button">Clear All</button>').addClass(this.classes.clearAll),container:S("<div/>").addClass(this.classes.panes).text(n.i18n("searchPanes.loadMessage","Loading Search Panes...")),emptyMessage:S("<div/>").addClass(this.classes.emptyMessage),options:S("<div/>").addClass(this.classes.container),panes:S("<div/>").addClass(this.classes.container),title:S("<div/>").addClass(this.classes.title),titleRow:S("<div/>").addClass(this.classes.titleRow),wrapper:S("<div/>")},this.s={colOpts:[],dt:n,filterCount:0,filterPane:-1,page:0,panes:[],selectionList:[],serverData:{},stateRead:!1,updating:!1},void 0===n.settings()[0]._searchPanes)return this._getState(),this.s.dt.page.info().serverSide&&n.on("preXhr.dt",function(e,t,r){void 0===r.searchPanes&&(r.searchPanes={});for(var n=0,i=l.s.selectionList;n<i.length;n++){var o=i[n],s=l.s.dt.column(o.index).dataSrc();void 0===r.searchPanes[s]&&(r.searchPanes[s]={});for(var a=0;a<o.rows.length;a++)r.searchPanes[s][a]=o.rows[a].filter}}),n.on("xhr",function(e,t,r,n){r&&r.searchPanes&&r.searchPanes.options&&(l.s.serverData=r,l.s.serverData.tableLength=r.recordsTotal,l._serverTotals())}),(n.settings()[0]._searchPanes=this).dom.clearAll.text(n.i18n("searchPanes.clearMessage","Clear All")),this.s.dt.settings()[0]._bInitComplete||e?this._paneDeclare(n,t,r):n.one("preInit.dt",function(e){l._paneDeclare(n,t,r)}),this}r=function(o,e,t){F=(L=o).fn.dataTable,s=(S=o).fn.dataTable;var n=o.fn.dataTable,r=(o.fn.dataTable.SearchPanes=a,o.fn.DataTable.SearchPanes=a,o.fn.dataTable.SearchPane=d,o.fn.DataTable.SearchPane=d,o.fn.dataTable.Api.register);function i(e,t){void 0===t&&(t=!1);var e=new n.Api(e),r=e.init().searchPanes||n.defaults.searchPanes;return new a(e,r,t).getNode()}r("searchPanes()",function(){return this}),r("searchPanes.clearSelections()",function(){return this.iterator("table",function(e){e._searchPanes&&e._searchPanes.clearSelections()})}),r("searchPanes.rebuildPane()",function(t,r){return this.iterator("table",function(e){e._searchPanes&&e._searchPanes.rebuild(t,r)})}),r("searchPanes.container()",function(){var e=this.context[0];return e._searchPanes?e._searchPanes.getNode():null}),o.fn.dataTable.ext.buttons.searchPanesClear={text:"Clear Panes",action:function(e,t,r,n){t.searchPanes.clearSelections()}},o.fn.dataTable.ext.buttons.searchPanes={action:function(e,t,r,n){e.stopPropagation(),this.popover(n._panes.getNode(),{align:"dt-container"}),n._panes.rebuild(void 0,!0)},config:{},init:function(t,r,e){var n=new o.fn.dataTable.SearchPanes(t,o.extend({filterChanged:function(e){t.button(r).text(t.i18n("searchPanes.collapse",{0:"SearchPanes",_:"SearchPanes (%d)"},e))}},e.config)),i=t.i18n("searchPanes.collapse","SearchPanes",0);t.button(r).text(i),e._panes=n},text:"Search Panes"},o(t).on("preInit.dt.dtsp",function(e,t,r){"dt"!==e.namespace||!t.oInit.searchPanes&&!n.defaults.searchPanes||t._searchPanes||i(t,!0)}),n.ext.feature.push({cFeature:"P",fnInit:i}),n.ext.features&&n.ext.features.register("searchPanes",i)},"function"==typeof define&&define.amd?define(["jquery","datatables.net"],function(e){return r(e,window,document)}):"object"==typeof exports?module.exports=function(e,t){return e=e||window,t&&t.fn.dataTable||(t=require("datatables.net")(e,t).$),r(t,0,e.document)}:r(window.jQuery,window,document)}(),!function(r){"function"==typeof define&&define.amd?define(["jquery","datatables.net-dt","datatables.net-searchpanes"],function(e){return r(e,window,document)}):"object"==typeof exports?module.exports=function(e,t){return e=e||window,(t=t&&t.fn.dataTable?t:require("datatables.net-dt")(e,t).$).fn.dataTable.SearchPanes||require("datatables.net-searchpanes")(e,t),r(t,e,e.document)}:r(jQuery,window,document)}(function(e,t,r){"use strict";return e.fn.dataTable.searchPanes}),!function(r){"function"==typeof define&&define.amd?define(["jquery","datatables.net"],function(e){return r(e,window,document)}):"object"==typeof exports?module.exports=function(e,t){return e=e||window,t&&t.fn.dataTable||(t=require("datatables.net")(e,t).$),r(t,e,e.document)}:r(jQuery,window,document)}(function(d,l,e,h){"use strict";var p=d.fn.dataTable;function c(o,e,t){function r(t,r){r<t&&(e=r,r=t,t=e);var e,n=!1;return o.columns(":visible").indexes().filter(function(e){return e===t&&(n=!0),e===r?!(n=!1):n})}function n(t,r){var e,n=o.rows({search:"applied"}).indexes(),i=(n.indexOf(t)>n.indexOf(r)&&(e=r,r=t,t=e),!1);return n.filter(function(e){return e===t&&(i=!0),e===r?!(i=!1):i})}var i,t=o.cells({selected:!0}).any()||t?(i=r(t.column,e.column),n(t.row,e.row)):(i=r(0,e.column),n(0,e.row)),t=o.cells(t,i).flatten();o.cells(e,{selected:!0}).any()?o.cells(t).deselect():o.cells(t).select()}function n(e){var t=e.settings()[0]._select.selector;d(e.table().container()).off("mousedown.dtSelect",t).off("mouseup.dtSelect",t).off("click.dtSelect",t),d("body").off("click.dtSelect"+y(e.table().node()))}function i(s){var a,t=d(s.table().container()),r=s.settings()[0],n=r._select.selector;t.on("mousedown.dtSelect",n,function(e){(e.shiftKey||e.metaKey||e.ctrlKey)&&t.css("-moz-user-select","none").one("selectstart.dtSelect",n,function(){return!1}),l.getSelection&&(a=l.getSelection())}).on("mouseup.dtSelect",n,function(){t.css("-moz-user-select","")}).on("click.dtSelect",n,function(e){var t,r=s.select.items();if(a){var n=l.getSelection();if((!n.anchorNode||d(n.anchorNode).closest("table")[0]===s.table().node())&&n!==a)return}var i,n=s.settings()[0],o=s.settings()[0].oClasses.sWrapper.trim().replace(/ +/g,".");d(e.target).closest("div."+o)[0]==s.table().container()&&(o=s.cell(d(e.target).closest("td, th"))).any()&&(i=d.Event("user-select.dt"),u(s,i,[r,o,e]),i.isDefaultPrevented()||(i=o.index(),"row"===r?(t=i.row,m(e,s,n,"row",t)):"column"===r?(t=o.index().column,m(e,s,n,"column",t)):"cell"===r&&(t=o.index(),m(e,s,n,"cell",t)),n._select_lastCell=i))}),d("body").on("click.dtSelect"+y(s.table().node()),function(e){!r._select.blurable||d(e.target).parents().filter(s.table().container()).length||0===d(e.target).parents("html").length||d(e.target).parents("div.DTE").length||g(r,!0)})}function u(e,t,r,n){n&&!e.flatten().length||("string"==typeof t&&(t+=".dt"),r.unshift(e),d(e.table().node()).trigger(t,r))}function o(s){var l=new p.Api(s);s.aoRowCreatedCallback.push({fn:function(e,t,r){var n,i,o=s.aoData[r];for(o._select_selected&&d(e).addClass(s._select.className),n=0,i=s.aoColumns.length;n<i;n++)(s.aoColumns[n]._select_selected||o._selected_cells&&o._selected_cells[n])&&d(o.anCells[n]).addClass(s._select.className)},sName:"select-deferRender"}),l.on("preXhr.dt.dtSelect",function(e,t){var r,n;t===l.settings()[0]&&(r=l.rows({selected:!0}).ids(!0).filter(function(e){return e!==h}),n=l.cells({selected:!0}).eq(0).map(function(e){var t=l.row(e.row).id(!0);return t?{row:t,column:e.column}:h}).filter(function(e){return e!==h}),l.one("draw.dt.dtSelect",function(){l.rows(r).select(),n.any()&&n.each(function(e){l.cells(e.row,e.column).select()})}))}),l.on("draw.dtSelect.dt select.dtSelect.dt deselect.dtSelect.dt info.dt",function(){var n,i,o,s,a,e;(e=(n=l).settings()[0])._select.info&&e.aanFeatures.i&&"api"!==n.select.style()&&(i=n.rows({selected:!0}).flatten().length,o=n.columns({selected:!0}).flatten().length,s=n.cells({selected:!0}).flatten().length,a=function(e,t,r){e.append(d('<span class="select-item"/>').append(n.i18n("select."+t+"s",{_:"%d "+t+"s selected",0:"",1:"1 "+t+" selected"},r)))},d.each(e.aanFeatures.i,function(e,t){t=d(t);var r=d('<span class="select-info"/>'),n=(a(r,"row",i),a(r,"column",o),a(r,"cell",s),t.children("span.select-info"));n.length&&n.remove(),""!==r.text()&&t.append(r)}))}),l.on("destroy.dtSelect",function(){l.rows({selected:!0}).deselect(),n(l),l.off(".dtSelect")})}function f(e,t,r,n){var i,o=e[t+"s"]({search:"applied"}).indexes(),n=d.inArray(n,o),s=d.inArray(r,o);e[t+"s"]({selected:!0}).any()||-1!==n?(s<n&&(i=s,s=n,n=i),o.splice(s+1,o.length),o.splice(0,n)):o.splice(d.inArray(r,o)+1,o.length),e[t](r,{selected:!0}).any()?(o.splice(d.inArray(r,o),1),e[t+"s"](o).deselect()):e[t+"s"](o).select()}function g(e,t){!t&&"single"!==e._select.style||((t=new p.Api(e)).rows({selected:!0}).deselect(),t.columns({selected:!0}).deselect(),t.cells({selected:!0}).deselect())}function m(e,t,r,n,i){var o=t.select.style(),s=t.select.toggleable(),a=t[n](i,{selected:!0}).any();a&&!s||("os"===o?e.ctrlKey||e.metaKey?t[n](i).select(!a):e.shiftKey?"cell"===n?c(t,i,r._select_lastCell||null):f(t,n,i,r._select_lastCell?r._select_lastCell[n]:null):(s=t[n+"s"]({selected:!0}),a&&1===s.flatten().length?t[n](i).deselect():(s.deselect(),t[n](i).select())):"multi+shift"==o&&e.shiftKey?"cell"===n?c(t,i,r._select_lastCell||null):f(t,n,i,r._select_lastCell?r._select_lastCell[n]:null):t[n](i).select(!a))}function y(e){return e.id.replace(/[^a-zA-Z0-9\-\_]/g,"-")}p.select={},p.select.version="1.3.3",p.select.init=function(e){var t=e.settings()[0],r=t.oInit.select,n=p.defaults.select,n=r===h?n:r,r="row",i="api",o=!1,s=!0,a=!0,l="td, th",c="selected",u=!1;t._select={},!0===n?(i="os",u=!0):"string"==typeof n?(i=n,u=!0):d.isPlainObject(n)&&(n.blurable!==h&&(o=n.blurable),n.toggleable!==h&&(s=n.toggleable),n.info!==h&&(a=n.info),n.items!==h&&(r=n.items),u=(i=n.style!==h?n.style:"os",!0),n.selector!==h&&(l=n.selector),n.className!==h)&&(c=n.className),e.select.selector(l),e.select.items(r),e.select.style(i),e.select.blurable(o),e.select.toggleable(s),e.select.info(a),t._select.className=c,d.fn.dataTable.ext.order["select-checkbox"]=function(t,e){return this.api().column(e,{order:"index"}).nodes().map(function(e){return"row"===t._select.items?d(e).parent().hasClass(t._select.className):"cell"===t._select.items&&d(e).hasClass(t._select.className)})},!u&&d(e.table().node()).hasClass("selectable")&&e.select.style("os")},d.each([{type:"row",prop:"aoData"},{type:"column",prop:"aoColumns"}],function(e,l){p.ext.selector[l.type].push(function(e,t,r){var n,i=t.selected,o=[];if(!0!==i&&!1!==i)return r;for(var s=0,a=r.length;s<a;s++)n=e[l.prop][r[s]],(!0===i&&!0===n._select_selected||!1===i&&!n._select_selected)&&o.push(r[s]);return o})}),p.ext.selector.cell.push(function(e,t,r){var n,i=t.selected,o=[];if(i===h)return r;for(var s=0,a=r.length;s<a;s++)n=e.aoData[r[s].row],(!0!==i||!n._selected_cells||!0!==n._selected_cells[r[s].column])&&(!1!==i||n._selected_cells&&n._selected_cells[r[s].column])||o.push(r[s]);return o});var t=p.Api.register,r=p.Api.registerPlural;function s(t,r){return function(e){return e.i18n("buttons."+t,r)}}function a(e){e=e._eventNamespace;return"draw.dt.DT"+e+" select.dt.DT"+e+" deselect.dt.DT"+e}t("select()",function(){return this.iterator("table",function(e){p.select.init(new p.Api(e))})}),t("select.blurable()",function(t){return t===h?this.context[0]._select.blurable:this.iterator("table",function(e){e._select.blurable=t})}),t("select.toggleable()",function(t){return t===h?this.context[0]._select.toggleable:this.iterator("table",function(e){e._select.toggleable=t})}),t("select.info()",function(t){return t===h?this.context[0]._select.info:this.iterator("table",function(e){e._select.info=t})}),t("select.items()",function(t){return t===h?this.context[0]._select.items:this.iterator("table",function(e){e._select.items=t,u(new p.Api(e),"selectItems",[t])})}),t("select.style()",function(r){return r===h?this.context[0]._select.style:this.iterator("table",function(e){e._select.style=r,e._select_init||o(e);var t=new p.Api(e);n(t),"api"!==r&&i(t),u(new p.Api(e),"selectStyle",[r])})}),t("select.selector()",function(t){return t===h?this.context[0]._select.selector:this.iterator("table",function(e){n(new p.Api(e)),e._select.selector=t,"api"!==e._select.style&&i(new p.Api(e))})}),r("rows().select()","row().select()",function(e){var r=this;return!1===e?this.deselect():(this.iterator("row",function(e,t){g(e),e.aoData[t]._select_selected=!0,d(e.aoData[t].nTr).addClass(e._select.className)}),this.iterator("table",function(e,t){u(r,"select",["row",r[t]],!0)}),this)}),r("columns().select()","column().select()",function(e){var r=this;return!1===e?this.deselect():(this.iterator("column",function(e,t){g(e),e.aoColumns[t]._select_selected=!0;t=new p.Api(e).column(t);d(t.header()).addClass(e._select.className),d(t.footer()).addClass(e._select.className),t.nodes().to$().addClass(e._select.className)}),this.iterator("table",function(e,t){u(r,"select",["column",r[t]],!0)}),this)}),r("cells().select()","cell().select()",function(e){var r=this;return!1===e?this.deselect():(this.iterator("cell",function(e,t,r){g(e);t=e.aoData[t];t._selected_cells===h&&(t._selected_cells=[]),t._selected_cells[r]=!0,t.anCells&&d(t.anCells[r]).addClass(e._select.className)}),this.iterator("table",function(e,t){u(r,"select",["cell",r.cells(r[t]).indexes().toArray()],!0)}),this)}),r("rows().deselect()","row().deselect()",function(){var r=this;return this.iterator("row",function(e,t){e.aoData[t]._select_selected=!1,e._select_lastCell=null,d(e.aoData[t].nTr).removeClass(e._select.className)}),this.iterator("table",function(e,t){u(r,"deselect",["row",r[t]],!0)}),this}),r("columns().deselect()","column().deselect()",function(){var r=this;return this.iterator("column",function(n,e){n.aoColumns[e]._select_selected=!1;var t=new p.Api(n),r=t.column(e);d(r.header()).removeClass(n._select.className),d(r.footer()).removeClass(n._select.className),t.cells(null,e).indexes().each(function(e){var t=n.aoData[e.row],r=t._selected_cells;!t.anCells||r&&r[e.column]||d(t.anCells[e.column]).removeClass(n._select.className)})}),this.iterator("table",function(e,t){u(r,"deselect",["column",r[t]],!0)}),this}),r("cells().deselect()","cell().deselect()",function(){var r=this;return this.iterator("cell",function(e,t,r){t=e.aoData[t];t._selected_cells[r]=!1,t.anCells&&!e.aoColumns[r]._select_selected&&d(t.anCells[r]).removeClass(e._select.className)}),this.iterator("table",function(e,t){u(r,"deselect",["cell",r[t]],!0)}),this});var v=0;return d.extend(p.ext.buttons,{selected:{text:s("selected","Selected"),className:"buttons-selected",limitTo:["rows","columns","cells"],init:function(r,e,n){var i=this;n._eventNamespace=".select"+v++,r.on(a(n),function(){var e,t;i.enable((e=r,t=n,!(-1===d.inArray("rows",t.limitTo)||!e.rows({selected:!0}).any())||!(-1===d.inArray("columns",t.limitTo)||!e.columns({selected:!0}).any())||!(-1===d.inArray("cells",t.limitTo)||!e.cells({selected:!0}).any())))}),this.disable()},destroy:function(e,t,r){e.off(r._eventNamespace)}},selectedSingle:{text:s("selectedSingle","Selected single"),className:"buttons-selected-single",init:function(t,e,r){var n=this;r._eventNamespace=".select"+v++,t.on(a(r),function(){var e=t.rows({selected:!0}).flatten().length+t.columns({selected:!0}).flatten().length+t.cells({selected:!0}).flatten().length;n.enable(1===e)}),this.disable()},destroy:function(e,t,r){e.off(r._eventNamespace)}},selectAll:{text:s("selectAll","Select all"),className:"buttons-select-all",action:function(){var e=this.select.items();this[e+"s"]().select()}},selectNone:{text:s("selectNone","Deselect all"),className:"buttons-select-none",action:function(){g(this.settings()[0],!0)},init:function(t,e,r){var n=this;r._eventNamespace=".select"+v++,t.on(a(r),function(){var e=t.rows({selected:!0}).flatten().length+t.columns({selected:!0}).flatten().length+t.cells({selected:!0}).flatten().length;n.enable(0<e)}),this.disable()},destroy:function(e,t,r){e.off(r._eventNamespace)}}}),d.each(["Row","Column","Cell"],function(e,t){var i=t.toLowerCase();p.ext.buttons["select"+t+"s"]={text:s("select"+t+"s","Select "+i+"s"),className:"buttons-select-"+i+"s",action:function(){this.select.items(i)},init:function(e){var n=this;e.on("selectItems.dt.DT",function(e,t,r){n.active(r===i)})}}}),d(e).on("preInit.dt.dtSelect",function(e,t){"dt"===e.namespace&&p.select.init(new p.Api(t))}),p.select}),!function(r){"function"==typeof define&&define.amd?define(["jquery","datatables.net"],function(e){return r(e,window,document)}):"object"==typeof exports?module.exports=function(e,t){return e=e||window,t&&t.fn.dataTable||(t=require("datatables.net")(e,t).$),r(t,e,e.document)}:r(jQuery,window,document)}(function(h,e,p){"use strict";function f(e){if(!g.versionCheck||!g.versionCheck("1.10.8"))throw"DataTables Checkboxes requires DataTables 1.10.8 or newer";this.s={dt:new g.Api(e),columns:[],data:{},dataDisabled:{},ignoreSelect:!1},this.s.ctx=this.s.dt.settings()[0],this.s.ctx.checkboxes||(e.checkboxes=this)._constructor()}var g=h.fn.dataTable,t=(f.prototype={_constructor:function(){for(var e,t,r,n,i,o,s=this,a=s.s.dt,l=s.s.ctx,c=!1,u=!1,d=0;d<l.aoColumns.length;d++)l.aoColumns[d].checkboxes&&(e=h(a.column(d).header()),c=!0,h.isPlainObject(l.aoColumns[d].checkboxes)||(l.aoColumns[d].checkboxes={}),l.aoColumns[d].checkboxes=h.extend({},f.defaults,l.aoColumns[d].checkboxes),t={searchable:!1,orderable:!1},""===l.aoColumns[d].sClass?t.className="dt-checkboxes-cell":t.className=l.aoColumns[d].sClass+" dt-checkboxes-cell",null===l.aoColumns[d].sWidthOrig&&(t.width="1%"),null===l.aoColumns[d].mRender&&(t.render=function(){return'<input type="checkbox" class="dt-checkboxes" autocomplete="off">'}),g.ext.internal._fnColumnOptions(l,d,t),e.removeClass("sorting"),e.off(".dt"),null===l.sAjaxSource&&((r=a.cells("tr",d)).invalidate("data"),h(r.nodes()).addClass(t.className)),s.s.data[d]={},s.s.dataDisabled[d]={},s.s.columns.push(d),l.aoColumns[d].checkboxes.selectRow&&(l._select?u=!0:l.aoColumns[d].checkboxes.selectRow=!1),l.aoColumns[d].checkboxes.selectAll)&&(e.data("html",e.html()),null!==l.aoColumns[d].checkboxes.selectAllRender)&&(r="",h.isFunction(l.aoColumns[d].checkboxes.selectAllRender)?r=l.aoColumns[d].checkboxes.selectAllRender():"string"==typeof l.aoColumns[d].checkboxes.selectAllRender&&(r=l.aoColumns[d].checkboxes.selectAllRender),e.html(r).addClass("dt-checkboxes-select-all").attr("data-col",d));c&&(s.loadState(),n=h(a.table().node()),i=h(a.table().body()),o=h(a.table().container()),u&&(n.addClass("dt-checkboxes-select"),n.on("user-select.dt.dtCheckboxes",function(e,t,r,n,i){s.onDataTablesUserSelect(e,t,r,n,i)}),n.on("select.dt.dtCheckboxes deselect.dt.dtCheckboxes",function(e,t,r,n){s.onDataTablesSelectDeselect(e,r,n)}),l._select.info)&&(a.select.info(!1),n.on("draw.dt.dtCheckboxes select.dt.dtCheckboxes deselect.dt.dtCheckboxes",function(){s.showInfoSelected()})),n.on("draw.dt.dtCheckboxes",function(e){s.onDataTablesDraw(e)}),i.on("click.dtCheckboxes","input.dt-checkboxes",function(e){s.onClick(e,this)}),o.on("click.dtCheckboxes",'thead th.dt-checkboxes-select-all input[type="checkbox"]',function(e){s.onClickSelectAll(e,this)}),o.on("click.dtCheckboxes","thead th.dt-checkboxes-select-all",function(){h('input[type="checkbox"]',this).not(":disabled").trigger("click")}),u||o.on("click.dtCheckboxes","tbody td.dt-checkboxes-cell",function(){h('input[type="checkbox"]',this).not(":disabled").trigger("click")}),o.on("click.dtCheckboxes","thead th.dt-checkboxes-select-all label, tbody td.dt-checkboxes-cell label",function(e){e.preventDefault()}),h(p).on("click.dtCheckboxes",'.fixedHeader-floating thead th.dt-checkboxes-select-all input[type="checkbox"]',function(e){l._fixedHeader&&l._fixedHeader.dom.header.floating&&s.onClickSelectAll(e,this)}),h(p).on("click.dtCheckboxes",".fixedHeader-floating thead th.dt-checkboxes-select-all",function(){l._fixedHeader&&l._fixedHeader.dom.header.floating&&h('input[type="checkbox"]',this).trigger("click")}),n.on("init.dt.dtCheckboxes",function(){setTimeout(function(){s.onDataTablesInit()},0)}),n.on("stateSaveParams.dt.dtCheckboxes",function(e,t,r){s.onDataTablesStateSave(e,t,r)}),n.one("destroy.dt.dtCheckboxes",function(e,t){s.onDataTablesDestroy(e,t)}))},onDataTablesInit:function(){var i=this,e=i.s.dt,t=i.s.ctx;t.oFeatures.bServerSide||(t.oFeatures.bStateSave&&i.updateState(),h(e.table().node()).on("xhr.dt.dtCheckboxes",function(e,t,r,n){i.onDataTablesXhr(e.settings,r,n)}))},onDataTablesUserSelect:function(e,t,r,n){var n=n.index().row,i=this.getSelectRowColIndex(),t=t.cell({row:n,column:i}).data();this.isCellSelectable(i,t)||e.preventDefault()},onDataTablesSelectDeselect:function(e,t,r){var n=this.s.dt;this.s.ignoreSelect||"row"===t&&null!==(t=this.getSelectRowColIndex())&&(n=n.cells(r,t),this.updateData(n,t,"select"===e.type),this.updateCheckbox(n,t,"select"===e.type),this.updateSelectAll(t))},onDataTablesStateSave:function(e,t,r){var n=this,i=n.s.ctx;h.each(n.s.columns,function(e,t){i.aoColumns[t].checkboxes.stateSave&&(Object.prototype.hasOwnProperty.call(r,"checkboxes")||(r.checkboxes=[]),r.checkboxes[t]=n.s.data[t])})},onDataTablesDestroy:function(){var e=this.s.dt,t=h(e.table().node()),r=h(e.table().body()),e=h(e.table().container());h(p).off("click.dtCheckboxes"),e.off(".dtCheckboxes"),r.off(".dtCheckboxes"),t.off(".dtCheckboxes"),this.s.data={},this.s.dataDisabled={},h(".dt-checkboxes-select-all",t).each(function(e,t){h(t).html(h(t).data("html")).removeClass("dt-checkboxes-select-all")})},onDataTablesDraw:function(){var r=this,e=r.s.ctx;(e.oFeatures.bServerSide||e.oFeatures.bDeferRender)&&r.updateStateCheckboxes({page:"current",search:"none"}),h.each(r.s.columns,function(e,t){r.updateSelectAll(t)})},onDataTablesXhr:function(){var r=this,e=r.s.dt,t=r.s.ctx,e=h(e.table().node());h.each(r.s.columns,function(e,t){r.s.data[t]={},r.s.dataDisabled[t]={}}),t.oFeatures.bStateSave&&(r.loadState(),e.one("draw.dt.dtCheckboxes",function(){r.updateState()}))},updateData:function(e,t,r){var n=this.s.dt,i=this.s.ctx;i.aoColumns[t].checkboxes&&(e.data().each(function(e){r?i.checkboxes.s.data[t][e]=1:delete i.checkboxes.s.data[t][e]}),i.oFeatures.bStateSave)&&i.aoColumns[t].checkboxes.stateSave&&n.state.save()},updateSelect:function(e,t){var r=this.s.dt;this.s.ctx._select&&(this.s.ignoreSelect=!0,t?r.rows(e).select():r.rows(e).deselect(),this.s.ignoreSelect=!1)},updateCheckbox:function(e,t,r){var n=this.s.ctx,e=e.nodes();e.length&&(h("input.dt-checkboxes",e).not(":disabled").prop("checked",r),h.isFunction(n.aoColumns[t].checkboxes.selectCallback))&&n.aoColumns[t].checkboxes.selectCallback(e,r)},updateState:function(){var r=this,e=(r.s.dt,r.s.ctx);r.updateStateCheckboxes({page:"all",search:"none"}),e._oFixedColumns&&setTimeout(function(){h.each(r.s.columns,function(e,t){r.updateSelectAll(t)})},0)},updateStateCheckboxes:function(e){var i=this,t=i.s.dt,o=i.s.ctx;t.cells("tr",i.s.columns,e).every(function(e,t){var r=this.data(),n=i.isCellSelectable(t,r);Object.prototype.hasOwnProperty.call(o.checkboxes.s.data,t)&&Object.prototype.hasOwnProperty.call(o.checkboxes.s.data[t],r)&&(o.aoColumns[t].checkboxes.selectRow&&n&&i.updateSelect(e,!0),i.updateCheckbox(this,t,!0)),n||h("input.dt-checkboxes",this.node()).prop("disabled",!0)})},onClick:function(e,t){var r=this,n=r.s.dt,i=r.s.ctx,o=h(t).closest("td"),o=o.parents(".DTFC_Cloned").length?n.fixedColumns().cellIndex(o):o,s=n.cell(o),a=s.index().column;i.aoColumns[a].checkboxes.selectRow?setTimeout(function(){var e=s.data(),e=Object.prototype.hasOwnProperty.call(r.s.data,a)&&Object.prototype.hasOwnProperty.call(r.s.data[a],e);e!==t.checked&&(r.updateCheckbox(s,a,e),r.updateSelectAll(a))},0):(s.checkboxes.select(t.checked),e.stopPropagation())},onClickSelectAll:function(e,t){var r=this.s.dt,n=this.s.ctx,i=null,o=h(t).closest("th");i=o.parents(".DTFC_Cloned").length?r.fixedColumns().cellIndex(o).column:r.column(o).index(),h(t).data("is-changed",!0),r.column(i,{page:n.aoColumns[i].checkboxes&&n.aoColumns[i].checkboxes.selectAllPages?"all":"current",search:"applied"}).checkboxes.select(t.checked),e.stopPropagation()},loadState:function(){var r,n=this,e=n.s.dt,i=n.s.ctx;i.oFeatures.bStateSave&&(r=e.state.loaded(),h.each(n.s.columns,function(e,t){r&&r.checkboxes&&r.checkboxes.hasOwnProperty(t)&&i.aoColumns[t].checkboxes.stateSave&&(n.s.data[t]=r.checkboxes[t])}))},updateSelectAll:function(r){var n,i,e,t,o,s,a,l=this,c=l.s.dt,u=l.s.ctx;u.aoColumns[r].checkboxes&&u.aoColumns[r].checkboxes.selectAll&&(t=c.cells("tr",r,{page:u.aoColumns[r].checkboxes.selectAllPages?"all":"current",search:"applied"}),c=c.table().container(),c=h('.dt-checkboxes-select-all[data-col="'+r+'"] input[type="checkbox"]',c),i=n=0,t=t.data(),h.each(t,function(e,t){l.isCellSelectable(r,t)?Object.prototype.hasOwnProperty.call(l.s.data,r)&&Object.prototype.hasOwnProperty.call(l.s.data[r],t)&&n++:i++}),u._fixedHeader&&u._fixedHeader.dom.header.floating&&(c=h('.fixedHeader-floating .dt-checkboxes-select-all[data-col="'+r+'"] input[type="checkbox"]')),t=0===n?e=!1:n+i===t.length?!(e=!0):e=!0,o=c.data("is-changed"),s=c.prop("checked"),a=c.prop("indeterminate"),o||s!==e||a!==t)&&(c.data("is-changed",!1),c.prop({checked:!t&&e,indeterminate:t}),h.isFunction(u.aoColumns[r].checkboxes.selectAllCallback))&&u.aoColumns[r].checkboxes.selectAllCallback(c.closest("th").get(0),e,t)},showInfoSelected:function(){var o=this.s.dt,e=this.s.ctx;if(e.aanFeatures.i){var t=this.getSelectRowColIndex();if(null!==t){var r,s=0;for(r in e.checkboxes.s.data[t])Object.prototype.hasOwnProperty.call(e.checkboxes.s.data,t)&&Object.prototype.hasOwnProperty.call(e.checkboxes.s.data[t],r)&&s++;h.each(e.aanFeatures.i,function(e,t){var r,t=h(t),n=h('<span class="select-info"/>'),i=(i="row",r=s,n.append(h('<span class="select-item"/>').append(o.i18n("select."+i+"s",{_:"%d "+i+"s selected",0:"",1:"1 "+i+" selected"},r))),t.children("span.select-info"));i.length&&i.remove(),""!==n.text()&&t.append(n)})}}},isCellSelectable:function(e,t){var r=this.s.ctx;return!Object.prototype.hasOwnProperty.call(r.checkboxes.s.dataDisabled,e)||!Object.prototype.hasOwnProperty.call(r.checkboxes.s.dataDisabled[e],t)},getCellIndex:function(e){var t=this.s.dt;return this.s.ctx._oFixedColumns?t.fixedColumns().cellIndex(e):t.cell(e).index()},getSelectRowColIndex:function(){for(var e=this.s.ctx,t=null,r=0;r<e.aoColumns.length;r++)if(e.aoColumns[r].checkboxes&&e.aoColumns[r].checkboxes.selectRow){t=r;break}return t},updateFixedColumn:function(e){var t,r=this,n=r.s.dt,i=r.s.ctx;i._oFixedColumns&&(t=i._oFixedColumns.s.iLeftColumns,i=i.aoColumns.length-i._oFixedColumns.s.iRightColumns-1,e<t||i<e)&&(n.fixedColumns().update(),setTimeout(function(){h.each(r.s.columns,function(e,t){r.updateSelectAll(t)})},0))}},f.defaults={stateSave:!0,selectRow:!1,selectAll:!0,selectAllPages:!0,selectCallback:null,selectAllCallback:null,selectAllRender:'<input type="checkbox" autocomplete="off">'},h.fn.dataTable.Api);return t.register("checkboxes()",function(){return this}),t.registerPlural("columns().checkboxes.select()","column().checkboxes.select()",function(c){return void 0===c&&(c=!0),this.iterator("column-rows",function(r,n,e,t,i){var o,s,a,l;r.aoColumns[n].checkboxes&&(l=[],h.each(i,function(e,t){l.push({row:t,column:n})}),s=(o=this.cells(l)).data(),a=[],l=[],h.each(s,function(e,t){r.checkboxes.isCellSelectable(n,t)&&(l.push({row:i[e],column:n}),a.push(i[e]))}),o=this.cells(l),r.checkboxes.updateData(o,n,c),r.aoColumns[n].checkboxes.selectRow&&r.checkboxes.updateSelect(a,c),r.checkboxes.updateCheckbox(o,n,c),r.checkboxes.updateSelectAll(n),r.checkboxes.updateFixedColumn(n))},1)}),t.registerPlural("cells().checkboxes.select()","cell().checkboxes.select()",function(o){return void 0===o&&(o=!0),this.iterator("cell",function(e,t,r){var n,i;e.aoColumns[r].checkboxes&&(n=this.cells([{row:t,column:r}]),i=this.cell({row:t,column:r}).data(),e.checkboxes.isCellSelectable(r,i))&&(e.checkboxes.updateData(n,r,o),e.aoColumns[r].checkboxes.selectRow&&e.checkboxes.updateSelect(t,o),e.checkboxes.updateCheckbox(n,r,o),e.checkboxes.updateSelectAll(r),e.checkboxes.updateFixedColumn(r))},1)}),t.registerPlural("cells().checkboxes.enable()","cell().checkboxes.enable()",function(o){return void 0===o&&(o=!0),this.iterator("cell",function(e,t,r){var n,i;e.aoColumns[r].checkboxes&&(n=(i=this.cell({row:t,column:r})).data(),o?delete e.checkboxes.s.dataDisabled[r][n]:e.checkboxes.s.dataDisabled[r][n]=1,(i=i.node())&&h("input.dt-checkboxes",i).prop("disabled",!o),e.aoColumns[r].checkboxes.selectRow)&&Object.prototype.hasOwnProperty.call(e.checkboxes.s.data,r)&&Object.prototype.hasOwnProperty.call(e.checkboxes.s.data[r],n)&&e.checkboxes.updateSelect(t,o)},1)}),t.registerPlural("cells().checkboxes.disable()","cell().checkboxes.disable()",function(e){return this.checkboxes.enable(!(e=void 0===e?!0:e))}),t.registerPlural("columns().checkboxes.deselect()","column().checkboxes.deselect()",function(e){return this.checkboxes.select(!(e=void 0===e?!0:e))}),t.registerPlural("cells().checkboxes.deselect()","cell().checkboxes.deselect()",function(e){return this.checkboxes.select(!(e=void 0===e?!0:e))}),t.registerPlural("columns().checkboxes.deselectAll()","column().checkboxes.deselectAll()",function(){return this.iterator("column",function(e,t){e.aoColumns[t].checkboxes&&(e.checkboxes.s.data[t]={},this.column(t).checkboxes.select(!1))},1)}),t.registerPlural("columns().checkboxes.selected()","column().checkboxes.selected()",function(){return this.iterator("column-rows",function(r,n,e,t,i){var o,s;return r.aoColumns[n].checkboxes?(o=[],r.oFeatures.bServerSide?h.each(r.checkboxes.s.data[n],function(e){r.checkboxes.isCellSelectable(n,e)&&o.push(e)}):(s=[],h.each(i,function(e,t){s.push({row:t,column:n})}),i=this.cells(s).data(),h.each(i,function(e,t){Object.prototype.hasOwnProperty.call(r.checkboxes.s.data,n)&&Object.prototype.hasOwnProperty.call(r.checkboxes.s.data[n],t)&&r.checkboxes.isCellSelectable(n,t)&&o.push(t)})),o):[]},1)}),f.version="1.2.13-dev",h.fn.DataTable.Checkboxes=f,h.fn.dataTable.Checkboxes=f,h(p).on("preInit.dt.dtCheckboxes",function(e,t){"dt"===e.namespace&&new f(t)}),f}),!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Chart=t()}(this,function(){"use strict";var n=Object.freeze({__proto__:null,get Colors(){return uo},get Decimation(){return fo},get Filler(){return Ro},get Legend(){return Io},get SubTitle(){return Po},get Title(){return ko},get Tooltip(){return Yo}});function e(){}const F=(()=>{let e=0;return()=>e++})();function x(e){return null==e}function N(e){return!(!Array.isArray||!Array.isArray(e))||"[object"===(e=Object.prototype.toString.call(e)).slice(0,7)&&"Array]"===e.slice(-6)}function O(e){return null!==e&&"[object Object]"===Object.prototype.toString.call(e)}function g(e){return("number"==typeof e||e instanceof Number)&&isFinite(+e)}function h(e,t){return g(e)?e:t}function I(e,t){return void 0===e?t:e}const H=(e,t)=>"string"==typeof e&&e.endsWith("%")?parseFloat(e)/100:+e/t,U=(e,t)=>"string"==typeof e&&e.endsWith("%")?parseFloat(e)/100*t:+e;function d(e,t,r){if(e&&"function"==typeof e.call)return e.apply(r,t)}function S(e,t,r,n){let i,o,s;if(N(e))if(o=e.length,n)for(i=o-1;0<=i;i--)t.call(r,e[i],i);else for(i=0;i<o;i++)t.call(r,e[i],i);else if(O(e))for(s=Object.keys(e),o=s.length,i=0;i<o;i++)t.call(r,e[s[i]],s[i])}function V(e,t){let r,n,i,o;if(!e||!t||e.length!==t.length)return!1;for(r=0,n=e.length;r<n;++r)if(i=e[r],o=t[r],i.datasetIndex!==o.datasetIndex||i.index!==o.index)return!1;return!0}function W(t){if(N(t))return t.map(W);if(O(t)){var r=Object.create(null),n=Object.keys(t),i=n.length;let e=0;for(;e<i;++e)r[n[e]]=W(t[n[e]]);return r}return t}function $(e){return-1===["__proto__","prototype","constructor"].indexOf(e)}function B(e,t,r,n){var i;$(e)&&(i=t[e],r=r[e],O(i)&&O(r)?j(i,r,n):t[e]=W(r))}function j(r,e,n){var t=N(e)?e:[e],i=t.length;if(O(r)){var o,s=(n=n||{}).merger||B;for(let e=0;e<i;++e)if(O(o=t[e])){const N=Object.keys(o);for(let e=0,t=N.length;e<t;++e)s(N[e],r,o,n)}}return r}function z(e,t){return j(e,t,{merger:Y})}function Y(e,t,r){var n;$(e)&&(n=t[e],r=r[e],O(n)&&O(r)?z(n,r):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=W(r)))}const G={"":e=>e,x:e=>e.x,y:e=>e.y};function q(e){var t=e.split("."),r=[];let n="";for(const e of t)n+=e,n=n.endsWith("\\")?n.slice(0,-1)+".":(r.push(n),"");return r}function f(e,t){return(G[t]||(G[t]=function(){const r=q(t);return e=>{for(const t of r){if(""===t)break;e=e&&e[t]}return e}}()))(e)}function K(e){return e.charAt(0).toUpperCase()+e.slice(1)}const X=e=>void 0!==e,p=e=>"function"==typeof e,J=(e,t)=>{if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0};function Z(e){return"mouseup"===e.type||"click"===e.type||"contextmenu"===e.type}const _=Math.PI,b=2*_,Q=b+_,ee=Number.POSITIVE_INFINITY,te=_/180,R=_/2,re=_/4,ne=2*_/3,a=Math.log10,w=Math.sign;function ie(e,t,r){return Math.abs(e-t)<r}function oe(e){var t=Math.round(e),t=(e=ie(e,t,e/1e3)?t:e,Math.pow(10,Math.floor(a(e)))),e=e/t;return(e<=1?1:e<=2?2:e<=5?5:10)*t}function se(e){var t=[],r=Math.sqrt(e);let n;for(n=1;n<r;n++)e%n==0&&(t.push(n),t.push(e/n));return r===(0|r)&&t.push(r),t.sort((e,t)=>e-t).pop(),t}function ae(e){return!isNaN(parseFloat(e))&&isFinite(e)}function le(e,t){var r=Math.round(e);return r-t<=e&&e<=r+t}function ce(e,t,r){let n,i,o;for(n=0,i=e.length;n<i;n++)o=e[n][r],isNaN(o)||(t.min=Math.min(t.min,o),t.max=Math.max(t.max,o))}function M(e){return e*(_/180)}function ue(e){return e*(180/_)}function de(r){if(g(r)){let e=1,t=0;for(;Math.round(r*e)/e!==r;)e*=10,t++;return t}}function he(e,t){var r=t.x-e.x,t=t.y-e.y,e=Math.sqrt(r*r+t*t);let n=Math.atan2(t,r);return n<-.5*_&&(n+=b),{angle:n,distance:e}}function pe(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function fe(e,t){return(e-t+Q)%b-_}function C(e){return(e%b+b)%b}function ge(e,t,r,n){var e=C(e),t=C(t),r=C(r),i=C(t-e),o=C(r-e),s=C(e-t),a=C(e-r);return e===t||e===r||n&&t===r||o<i&&s<a}function A(e,t,r){return Math.max(t,Math.min(r,e))}function me(e){return A(e,-32768,32767)}function u(e,t,r,n=1e-6){return e>=Math.min(t,r)-n&&e<=Math.max(t,r)+n}function ye(t,r,e){e=e||(e=>t[e]<r);let n,i=t.length-1,o=0;for(;1<i-o;)e(n=o+i>>1)?o=n:i=n;return{lo:o,hi:i}}const m=(r,n,i,e)=>ye(r,i,e?e=>{var t=r[e][n];return t<i||t===i&&r[e+1][n]===i}:e=>r[e][n]<i),ve=(t,r,n)=>ye(t,n,e=>t[e][r]>=n);function be(e,t,r){let n=0,i=e.length;for(;n<i&&e[n]<t;)n++;for(;i>n&&e[i-1]>r;)i--;return 0<n||i<e.length?e.slice(n,i):e}const we=["push","pop","shift","splice","unshift"];function Ce(i,e){i._chartjs?i._chartjs.listeners.push(e):(Object.defineProperty(i,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),we.forEach(e=>{const r="_onData"+K(e),n=i[e];Object.defineProperty(i,e,{configurable:!0,enumerable:!1,value(...t){var e=n.apply(this,t);return i._chartjs.listeners.forEach(e=>{"function"==typeof e[r]&&e[r](...t)}),e}})}))}function Ee(t,e){var r=t._chartjs;r&&(-1!==(e=(r=r.listeners).indexOf(e))&&r.splice(e,1),0<r.length||(we.forEach(e=>{delete t[e]}),delete t._chartjs))}function Te(e){var t=new Set(e);return t.size===e.length?e:Array.from(t)}const Se="undefined"==typeof window?function(e){return e()}:window.requestAnimationFrame;function _e(t,r){let n,i=!1;return function(...e){n=e,i||(i=!0,Se.call(window,()=>{i=!1,t.apply(r,n)}))}}function xe(t,r){let n;return function(...e){return r?(clearTimeout(n),n=setTimeout(t,r,e)):t.apply(this,e),r}}const Re=e=>"start"===e?"left":"end"===e?"right":"center",k=(e,t,r)=>"start"===e?t:"end"===e?r:(t+r)/2,Ae=(e,t,r,n)=>e===(n?"left":"right")?r:"center"===e?(t+r)/2:t;function Ne(e,t,r){var n,i,o,s,a,l,c=t.length;let u=0,d=c;return e._sorted&&({iScale:e,_parsed:n}=e,i=e.axis,{min:o,max:s,minDefined:a,maxDefined:l}=e.getUserBounds(),a&&(u=A(Math.min(m(n,i,o).lo,r?c:m(t,i,e.getPixelForValue(o)).lo),0,c-1)),d=l?A(Math.max(m(n,e.axis,s,!0).hi+1,r?0:m(t,i,e.getPixelForValue(s),!0).hi+1),u,c)-u:c-u),{start:u,count:d}}function Oe(e){var{xScale:t,yScale:r,_scaleRanges:n}=e,i={xmin:t.min,xmax:t.max,ymin:r.min,ymax:r.max};return n?(t=n.xmin!==t.min||n.xmax!==t.max||n.ymin!==r.min||n.ymax!==r.max,Object.assign(n,i),t):(e._scaleRanges=i,!0)}var o=new class{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,r,n,e){const i=r.listeners[e],o=r.duration;i.forEach(e=>e({chart:t,initial:r.initial,numSteps:o,currentStep:Math.min(n-r.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=Se.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(s=Date.now()){let a=0;this._charts.forEach((n,i)=>{if(n.running&&n.items.length){var o=n.items;let e,t=o.length-1,r=!1;for(;0<=t;--t)(e=o[t])._active?(e._total>n.duration&&(n.duration=e._total),e.tick(s),r=!0):(o[t]=o[o.length-1],o.pop());r&&(i.draw(),this._notify(i,n,s,"progress")),o.length||(n.running=!1,this._notify(i,n,s,"complete"),n.initial=!1),a+=o.length}}),this._lastDate=s,0===a&&(this._running=!1)}_getAnims(e){var t=this._charts;let r=t.get(e);return r||(r={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,r)),r}listen(e,t,r){this._getAnims(e).listeners[t].push(r)}add(e,t){t&&t.length&&this._getAnims(e).items.push(...t)}has(e){return 0<this._getAnims(e).items.length}start(e){e=this._charts.get(e);e&&(e.running=!0,e.start=Date.now(),e.duration=e.items.reduce((e,t)=>Math.max(e,t._duration),0),this._refresh())}running(e){return!!this._running&&!!((e=this._charts.get(e))&&e.running&&e.items.length)}stop(t){var r=this._charts.get(t);if(r&&r.items.length){var n=r.items;let e=n.length-1;for(;0<=e;--e)n[e].cancel();r.items=[],this._notify(t,r,Date.now(),"complete")}}remove(e){return this._charts.delete(e)}};const Ie=(e,t,r)=>Math.max(Math.min(e,r),t);function Me(e){return Ie(2.55*e+.5|0,0,255)}function ke(e){return Ie(255*e+.5|0,0,255)}function s(e){return Ie((e/2.55+.5|0)/100,0,1)}function De(e){return Ie(100*e+.5|0,0,100)}const l={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Pe=[..."0123456789ABCDEF"],Le=e=>Pe[15&e],Fe=e=>Pe[(240&e)>>4]+Pe[15&e],He=e=>(240&e)>>4==(15&e);const Ue=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Ve(r,e,n){const i=e*Math.min(n,1-n),t=(e,t=(e+r/30)%12)=>n-i*Math.max(Math.min(t-3,9-t,1),-1);return[t(0),t(8),t(4)]}function We(r,n,i){var e=(e,t=(e+r/60)%6)=>i-i*n*Math.max(Math.min(t,4-t,1),0);return[e(5),e(3),e(1)]}function $e(e,t,r){var n=Ve(e,1,.5);let i;for(1<t+r&&(t*=i=1/(t+r),r*=i),i=0;i<3;i++)n[i]*=1-t-r,n[i]+=t;return n}function Be(e){var t=e.r/255,r=e.g/255,e=e.b/255,n=Math.max(t,r,e),i=Math.min(t,r,e),o=(n+i)/2;let s,a,l;return n!==i&&(l=n-i,a=.5<o?l/(2-n-i):l/(n+i),s=60*(s=(i=r,r=e,(e=t)===n?(i-r)/l+(i<r?6:0):i===n?(r-e)/l+2:(e-i)/l+4))+.5),[0|s,a||0,o]}function je(e,t,r,n){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,r,n)).map(ke)}function ze(e,t,r){return je(Ve,e,t,r)}function Ye(e){return(e%360+360)%360}const Ge={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},qe={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};let Ke;const Xe=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/,Je=e=>e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055,Ze=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function Qe(t,r,n){if(t){let e=Be(t);e[r]=Math.max(0,Math.min(e[r]+e[r]*n,0===r?360:1)),e=ze(e),t.r=e[0],t.g=e[1],t.b=e[2]}}function et(e,t){return e&&Object.assign(t||{},e)}function tt(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?3<=e.length&&(t={r:e[0],g:e[1],b:e[2],a:255},3<e.length)&&(t.a=ke(e[3])):(t=et(e,{r:0,g:0,b:0,a:1})).a=ke(t.a),t}function rt(e){return("r"===e.charAt(0)?function(e){var t=Xe.exec(e);let r,n,i,o=255;if(t){if(void 0!==t[7]){const e=+t[7];o=t[8]?Me(e):Ie(255*e,0,255)}return r=+t[1],n=+t[3],i=+t[5],{r:255&(t[2]?Me(r):Ie(r,0,255)),g:255&(t[4]?Me(n):Ie(n,0,255)),b:255&(t[6]?Me(i):Ie(i,0,255)),a:o}}}:function(e){var t,r,n,e=Ue.exec(e);let i,o=255;if(e)return void 0!==e[5]&&(o=(e[6]?Me:ke)(+e[5])),t=Ye(+e[2]),r=+e[3]/100,n=+e[4]/100,{r:(i="hwb"===e[1]?je($e,t,r,n):"hsv"===e[1]?je(We,t,r,n):ze(t,r,n))[0],g:i[1],b:i[2],a:o}})(e)}class nt{constructor(e){if(e instanceof nt)return e;var t,r,n=typeof e;let i;"object"==n?i=tt(e):"string"==n&&(r=(n=e).length,"#"===n[0]&&(4===r||5===r?t={r:255&17*l[n[1]],g:255&17*l[n[2]],b:255&17*l[n[3]],a:5===r?17*l[n[4]]:255}:7!==r&&9!==r||(t={r:l[n[1]]<<4|l[n[2]],g:l[n[3]]<<4|l[n[4]],b:l[n[5]]<<4|l[n[6]],a:9===r?l[n[7]]<<4|l[n[8]]:255})),i=t||(r=e,Ke||((Ke=function(){var e={},t=Object.keys(qe),r=Object.keys(Ge);let n,i,o,s,a;for(n=0;n<t.length;n++){for(s=a=t[n],i=0;i<r.length;i++)o=r[i],a=a.replace(o,Ge[o]);o=parseInt(qe[s],16),e[a]=[o>>16&255,o>>8&255,255&o]}return e}()).transparent=[0,0,0,0]),(r=Ke[r.toLowerCase()])&&{r:r[0],g:r[1],b:r[2],a:4===r.length?r[3]:255})||rt(e)),this._rgb=i,this._valid=!!i}get valid(){return this._valid}get rgb(){var e=et(this._rgb);return e&&(e.a=s(e.a)),e}set rgb(e){this._rgb=tt(e)}rgbString(){return this._valid?(e=this._rgb)&&(e.a<255?`rgba(${e.r}, ${e.g}, ${e.b}, ${s(e.a)})`:`rgb(${e.r}, ${e.g}, ${e.b})`):void 0;var e}hexString(){return this._valid&&(e=this._rgb,t=e,t=He(t.r)&&He(t.g)&&He(t.b)&&He(t.a)?Le:Fe,e)?"#"+t(e.r)+t(e.g)+t(e.b)+((e=e.a)<255?t(e):""):void 0;var e,t}hslString(){if(this._valid){var e,t,r,n=this._rgb;if(n)return e=(r=Be(n))[0],t=De(r[1]),r=De(r[2]),n.a<255?`hsla(${e}, ${t}%, ${r}%, ${s(n.a)})`:`hsl(${e}, ${t}%, ${r}%)`}}mix(e,t){var r,n,i;return e&&(r=this.rgb,e=e.rgb,i=r.a-e.a,r.r=255&(n=(1+((n=2*(t=void 0===t?.5:t)-1)*i==-1?n:(n+i)/(1+n*i)))/2)*r.r+(i=1-n)*e.r+.5,r.g=255&n*r.g+i*e.g+.5,r.b=255&n*r.b+i*e.b+.5,r.a=t*r.a+(1-t)*e.a,this.rgb=r),this}interpolate(e,t){return e&&(this._rgb=(r=this._rgb,e=e._rgb,t=t,n=Ze(s(r.r)),i=Ze(s(r.g)),o=Ze(s(r.b)),{r:ke(Je(n+t*(Ze(s(e.r))-n))),g:ke(Je(i+t*(Ze(s(e.g))-i))),b:ke(Je(o+t*(Ze(s(e.b))-o))),a:r.a+t*(e.a-r.a)})),this;var r,n,i,o}clone(){return new nt(this.rgb)}alpha(e){return this._rgb.a=ke(e),this}clearer(e){return this._rgb.a*=1-e,this}greyscale(){var e=this._rgb,t=.3*e.r+.59*e.g+.11*e.b+.5|0;return e.r=e.g=e.b=t,this}opaquer(e){return this._rgb.a*=1+e,this}negate(){var e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return Qe(this._rgb,2,e),this}darken(e){return Qe(this._rgb,2,-e),this}saturate(e){return Qe(this._rgb,1,e),this}desaturate(e){return Qe(this._rgb,1,-e),this}rotate(e){return t=this._rgb,e=e,(r=Be(t))[0]=Ye(r[0]+e),r=ze(r),t.r=r[0],t.g=r[1],t.b=r[2],this;var t,r}}function it(e){return!(!e||"object"!=typeof e||"[object CanvasPattern]"!==(e=e.toString())&&"[object CanvasGradient]"!==e)}function ot(e){return it(e)?e:new nt(e)}function st(e){return it(e)?e:new nt(e).saturate(.5).darken(.1).hexString()}const at=["x","y","borderWidth","radius","tension"],lt=["color","borderColor","backgroundColor"],ct=new Map;function ut(e,t,i){return function(e,t){t=i||{};var r=e+JSON.stringify(t);let n=ct.get(r);return n||(n=new Intl.NumberFormat(e,t),ct.set(r,n)),n}(t).format(e)}const dt={values:e=>N(e)?e:""+e,numeric(e,t,r){if(0===e)return"0";var n=this.chart.options.locale;let i,o=e;if(1<r.length){const t=Math.max(Math.abs(r[0].value),Math.abs(r[r.length-1].value));(t<1e-4||1e15<t)&&(i="scientific"),o=function(e){let t=3<r.length?r[2].value-r[1].value:r[1].value-r[0].value;return t=1<=Math.abs(t)&&e!==Math.floor(e)?e-Math.floor(e):t}(e)}var s=a(Math.abs(o)),s=isNaN(s)?1:Math.max(Math.min(-1*Math.floor(s),20),0),s={notation:i,minimumFractionDigits:s,maximumFractionDigits:s};return Object.assign(s,this.options.ticks.format),ut(e,n,s)},logarithmic(e,t,r){var n;return 0===e?"0":(n=r[t].significand||e/Math.pow(10,Math.floor(a(e))),[1,2,3,5,10,15].includes(n)||t>.8*r.length?dt.numeric.call(this,e,t,r):"")}};var ht={formatters:dt};const pt=Object.create(null),ft=Object.create(null);function gt(r,e){if(e){var n=e.split(".");for(let e=0,t=n.length;e<t;++e){var i=n[e];r=r[i]||(r[i]=Object.create(null))}}return r}function mt(e,t,r){return"string"==typeof t?j(gt(e,t),r):j(gt(e,""),t)}var D=new class{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=e=>e.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(e,t)=>st(t.backgroundColor),this.hoverBorderColor=(e,t)=>st(t.borderColor),this.hoverColor=(e,t)=>st(t.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return mt(this,e,t)}get(e){return gt(this,e)}describe(e,t){return mt(ft,e,t)}override(e,t){return mt(pt,e,t)}route(e,t,r,n){const i=gt(this,e),o=gt(this,r),s="_"+t;Object.defineProperties(i,{[s]:{value:i[t],writable:!0},[t]:{enumerable:!0,get(){var e=this[s],t=o[n];return O(e)?Object.assign({},t,e):I(e,t)},set(e){this[s]=e}}})}apply(e){e.forEach(e=>e(this))}}({_scriptable:e=>!e.startsWith("on"),_indexable:e=>"events"!==e,hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[function(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>"onProgress"!==e&&"onComplete"!==e&&"fn"!==e}),e.set("animations",{colors:{type:"color",properties:lt},numbers:{type:"number",properties:at}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>0|e}}}})},function(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})},function(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:ht.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&"callback"!==e&&"parser"!==e,_indexable:e=>"borderDash"!==e&&"tickBorderDash"!==e&&"dash"!==e}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:e=>"backdropPadding"!==e&&"callback"!==e,_indexable:e=>"backdropPadding"!==e})}]);function yt(){return"undefined"!=typeof window&&"undefined"!=typeof document}function vt(e){let t=e.parentNode;return t=t&&"[object ShadowRoot]"===t.toString()?t.host:t}function bt(e,t,r){let n;return"string"==typeof e?(n=parseInt(e,10),-1!==e.indexOf("%")&&(n=n/100*t.parentNode[r])):n=e,n}const wt=e=>e.ownerDocument.defaultView.getComputedStyle(e,null);function Ct(e,t){return wt(e).getPropertyValue(t)}const Et=["top","right","bottom","left"];function Tt(t,r,n){var i={};n=n?"-"+n:"";for(let e=0;e<4;e++){var o=Et[e];i[o]=parseFloat(t[r+"-"+o+n])||0}return i.width=i.left+i.right,i.height=i.top+i.bottom,i}function St(e,t){if("native"in e)return e;var{canvas:r,currentDevicePixelRatio:n}=t,i=wt(r),o="border-box"===i.boxSizing,s=Tt(i,"padding"),i=Tt(i,"border","width"),{x:e,y:a,box:l}=function(e,t){var r,n=e.touches,n=n&&n.length?n[0]:e,{offsetX:i,offsetY:o}=n;let s,a,l=!1;if(r=o,e=e.target,!(0<i||0<r)||e&&e.shadowRoot){const e=t.getBoundingClientRect();s=n.clientX-e.left,a=n.clientY-e.top,l=!0}else s=i,a=o;return{x:s,y:a,box:l}}(e,r),c=s.left+(l&&i.left),l=s.top+(l&&i.top);let{width:u,height:d}=t;return o&&(u-=s.width+i.width,d-=s.height+i.height),{x:Math.round((e-c)/u*r.width/n),y:Math.round((a-l)/d*r.height/n)}}const _t=e=>Math.round(10*e)/10;function xt(e,t,r,n){var i=wt(e),o=Tt(i,"margin"),s=bt(i.maxWidth,e,"clientWidth")||ee,a=bt(i.maxHeight,e,"clientHeight")||ee,e=function(e,t,r){let n,i;if(void 0===t||void 0===r){var o=vt(e);if(o){const e=o.getBoundingClientRect(),s=wt(o),a=Tt(s,"border","width"),l=Tt(s,"padding");t=e.width-l.width-a.width,r=e.height-l.height-a.height,n=bt(s.maxWidth,o,"clientWidth"),i=bt(s.maxHeight,o,"clientHeight")}else t=e.clientWidth,r=e.clientHeight}return{width:t,height:r,maxWidth:n||ee,maxHeight:i||ee}}(e,t,r);let{width:l,height:c}=e;if("content-box"===i.boxSizing){const e=Tt(i,"border","width"),t=Tt(i,"padding");l-=t.width+e.width,c-=t.height+e.height}return l=Math.max(0,l-o.width),c=Math.max(0,n?l/n:c-o.height),l=_t(Math.min(l,s,e.maxWidth)),c=_t(Math.min(c,a,e.maxHeight)),l&&!c&&(c=_t(l/2)),(void 0!==t||void 0!==r)&&n&&e.height&&c>e.height&&(c=e.height,l=_t(Math.floor(c*n))),{width:l,height:c}}function Rt(e,t,r){var t=t||1,n=Math.floor(e.height*t),i=Math.floor(e.width*t),o=(e.height=Math.floor(e.height),e.width=Math.floor(e.width),e.canvas);return o.style&&(r||!o.style.height&&!o.style.width)&&(o.style.height=e.height+"px",o.style.width=e.width+"px"),(e.currentDevicePixelRatio!==t||o.height!==n||o.width!==i)&&(e.currentDevicePixelRatio=t,o.height=n,o.width=i,e.ctx.setTransform(t,0,0,t,0,0),!0)}var At=function(){let e=!1;try{var t={get passive(){return!(e=!0)}};yt()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch(e){}return e}();function Nt(e,t){e=Ct(e,t),t=e&&e.match(/^(\d+)(\.\d+)?px$/);return t?+t[1]:void 0}function Ot(e){return!e||x(e.size)||x(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}function It(e,t,r,n,i){let o=t[i];return o||(o=t[i]=e.measureText(i).width,r.push(i)),n=o>n?o:n}function Mt(e,t,r,n){let i=(n=n||{}).data=n.data||{},o=n.garbageCollect=n.garbageCollect||[],s=(n.font!==t&&(i=n.data={},o=n.garbageCollect=[],n.font=t),e.save(),e.font=t,0);var a=r.length;let l,c,u,d,h;for(l=0;l<a;l++)if(null==(d=r[l])||N(d)){if(N(d))for(c=0,u=d.length;c<u;c++)null==(h=d[c])||N(h)||(s=It(e,i,o,s,h))}else s=It(e,i,o,s,d);e.restore();var p=o.length/2;if(p>r.length){for(l=0;l<p;l++)delete i[o[l]];o.splice(0,p)}return s}function kt(e,t,r){e=e.currentDevicePixelRatio,r=0!==r?Math.max(r/2,.5):0;return Math.round((t-r)*e)/e+r}function Dt(e,t){(t=t||e.getContext("2d")).save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore()}function Pt(e,t,r,n){Lt(e,t,r,n,null)}function Lt(e,t,r,n,i){let o,s,a,l,c,u,d,h;var p=t.pointStyle,f=t.rotation,g=t.radius;let m=(f||0)*te;if(p&&"object"==typeof p&&("[object HTMLImageElement]"===(o=p.toString())||"[object HTMLCanvasElement]"===o))e.save(),e.translate(r,n),e.rotate(m),e.drawImage(p,-p.width/2,-p.height/2,p.width,p.height),e.restore();else if(!(isNaN(g)||g<=0)){switch(e.beginPath(),p){default:i?e.ellipse(r,n,i/2,g,0,0,b):e.arc(r,n,g,0,b),e.closePath();break;case"triangle":u=i?i/2:g,e.moveTo(r+Math.sin(m)*u,n-Math.cos(m)*g),m+=ne,e.lineTo(r+Math.sin(m)*u,n-Math.cos(m)*g),m+=ne,e.lineTo(r+Math.sin(m)*u,n-Math.cos(m)*g),e.closePath();break;case"rectRounded":c=.516*g,l=g-c,s=Math.cos(m+re)*l,d=Math.cos(m+re)*(i?i/2-c:l),a=Math.sin(m+re)*l,h=Math.sin(m+re)*(i?i/2-c:l),e.arc(r-d,n-a,c,m-_,m-R),e.arc(r+h,n-s,c,m-R,m),e.arc(r+d,n+a,c,m,m+R),e.arc(r-h,n+s,c,m+R,m+_),e.closePath();break;case"rect":if(!f){l=Math.SQRT1_2*g,u=i?i/2:l,e.rect(r-u,n-l,2*u,2*l);break}m+=re;case"rectRot":d=Math.cos(m)*(i?i/2:g),s=Math.cos(m)*g,a=Math.sin(m)*g,h=Math.sin(m)*(i?i/2:g),e.moveTo(r-d,n-a),e.lineTo(r+h,n-s),e.lineTo(r+d,n+a),e.lineTo(r-h,n+s),e.closePath();break;case"crossRot":m+=re;case"cross":d=Math.cos(m)*(i?i/2:g),s=Math.cos(m)*g,a=Math.sin(m)*g,h=Math.sin(m)*(i?i/2:g),e.moveTo(r-d,n-a),e.lineTo(r+d,n+a),e.moveTo(r+h,n-s),e.lineTo(r-h,n+s);break;case"star":d=Math.cos(m)*(i?i/2:g),s=Math.cos(m)*g,a=Math.sin(m)*g,h=Math.sin(m)*(i?i/2:g),e.moveTo(r-d,n-a),e.lineTo(r+d,n+a),e.moveTo(r+h,n-s),e.lineTo(r-h,n+s),m+=re,d=Math.cos(m)*(i?i/2:g),s=Math.cos(m)*g,a=Math.sin(m)*g,h=Math.sin(m)*(i?i/2:g),e.moveTo(r-d,n-a),e.lineTo(r+d,n+a),e.moveTo(r+h,n-s),e.lineTo(r-h,n+s);break;case"line":s=i?i/2:Math.cos(m)*g,a=Math.sin(m)*g,e.moveTo(r-s,n-a),e.lineTo(r+s,n+a);break;case"dash":e.moveTo(r,n),e.lineTo(r+Math.cos(m)*(i?i/2:g),n+Math.sin(m)*g);break;case!1:e.closePath()}e.fill(),0<t.borderWidth&&e.stroke()}}function E(e,t,r){return r=r||.5,!t||e&&e.x>t.left-r&&e.x<t.right+r&&e.y>t.top-r&&e.y<t.bottom+r}function Ft(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function Ht(e){e.restore()}function Ut(e,t,r,n,i){if(!t)return e.lineTo(r.x,r.y);if("middle"===i){const n=(t.x+r.x)/2;e.lineTo(n,t.y),e.lineTo(n,r.y)}else"after"===i!=!!n?e.lineTo(t.x,r.y):e.lineTo(r.x,t.y);e.lineTo(r.x,r.y)}function Vt(e,t,r,n){if(!t)return e.lineTo(r.x,r.y);e.bezierCurveTo(n?t.cp1x:t.cp2x,n?t.cp1y:t.cp2y,n?r.cp2x:r.cp1x,n?r.cp2y:r.cp1y,r.x,r.y)}function Wt(e,t,r,n,i,o={}){var s,a,l,c,u,d,h,p,f=N(t)?t:[t],g=0<o.strokeWidth&&""!==o.strokeColor;let m,y;for(e.save(),e.font=i.string,t=e,(p=o).translation&&t.translate(p.translation[0],p.translation[1]),x(p.rotation)||t.rotate(p.rotation),p.color&&(t.fillStyle=p.color),p.textAlign&&(t.textAlign=p.textAlign),p.textBaseline&&(t.textBaseline=p.textBaseline),m=0;m<f.length;++m)y=f[m],o.backdrop&&(u=e,d=o.backdrop,h=void 0,h=u.fillStyle,u.fillStyle=d.color,u.fillRect(d.left,d.top,d.width,d.height),u.fillStyle=h),g&&(o.strokeColor&&(e.strokeStyle=o.strokeColor),x(o.strokeWidth)||(e.lineWidth=o.strokeWidth),e.strokeText(y,r,n,o.maxWidth)),e.fillText(y,r,n,o.maxWidth),d=e,u=r,h=n,s=y,c=l=void 0,((a=o).strikethrough||a.underline)&&(l=u-(s=d.measureText(s)).actualBoundingBoxLeft,u=u+s.actualBoundingBoxRight,c=h-s.actualBoundingBoxAscent,h=h+s.actualBoundingBoxDescent,s=a.strikethrough?(c+h)/2:h,d.strokeStyle=d.fillStyle,d.beginPath(),d.lineWidth=a.decorationWidth||2,d.moveTo(l,s),d.lineTo(u,s),d.stroke()),n+=Number(i.lineHeight);e.restore()}function $t(e,t){var{x:t,y:r,w:n,h:i,radius:o}=t;e.arc(t+o.topLeft,r+o.topLeft,o.topLeft,1.5*_,_,!0),e.lineTo(t,r+i-o.bottomLeft),e.arc(t+o.bottomLeft,r+i-o.bottomLeft,o.bottomLeft,_,R,!0),e.lineTo(t+n-o.bottomRight,r+i),e.arc(t+n-o.bottomRight,r+i-o.bottomRight,o.bottomRight,R,0,!0),e.lineTo(t+n,r+o.topRight),e.arc(t+n-o.topRight,r+o.topRight,o.topRight,0,-R,!0),e.lineTo(t+o.topLeft,r)}function Bt(a,l=[""],e,t,i=()=>a[0]){const r=e||a;void 0===t&&(t=Qt("_fallback",a));e={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:a,_rootScopes:r,_fallback:t,_getTarget:i,override:e=>Bt([e,...a],l,r,t)};return new Proxy(e,{deleteProperty:(e,t)=>(delete e[t],delete e._keys,delete a[0][t],!0),get:(o,s)=>qt(o,s,()=>{var e,t=s,r=a,n=o;for(const i of l)if(e=Qt(Yt(i,t),r),void 0!==e)return Gt(t,e)?Jt(r,n,t,e):e}),getOwnPropertyDescriptor:(e,t)=>Reflect.getOwnPropertyDescriptor(e._scopes[0],t),getPrototypeOf:()=>Reflect.getPrototypeOf(a[0]),has:(e,t)=>er(e).includes(t),ownKeys:e=>er(e),set(e,t,r){var n=e._storage||(e._storage=i());return e[t]=n[t]=r,delete e._keys,!0}})}function jt(n,t,r,i){var e={_cacheable:!1,_proxy:n,_context:t,_subProxy:r,_stack:new Set,_descriptors:zt(n,i),setContext:e=>jt(n,e,r,i),override:e=>jt(n.override(e),t,r,i)};return new Proxy(e,{deleteProperty:(e,t)=>(delete e[t],delete n[t],!0),get:(a,c,u)=>qt(a,c,()=>{{var l=a,t=c,r=u,{_proxy:n,_context:i,_subProxy:o,_descriptors:s}=l;let e=n[t];return N(e=p(e)&&s.isScriptable(t)?function(e,t,r){var{_proxy:n,_context:i,_subProxy:o,_stack:s}=l;if(s.has(e))throw new Error("Recursion detected: "+Array.from(s).join("->")+"->"+e);s.add(e);let a=t(i,o||r);return s.delete(e),a=Gt(e,a)?Jt(n._scopes,n,e,a):a}(t,e,r):e)&&e.length&&(e=function(e,t,r,n){var{_proxy:i,_context:o,_subProxy:s,_descriptors:a}=r;if(void 0!==o.index&&n(e))return t[o.index%t.length];if(O(t[0])){const r=t,n=i._scopes.filter(e=>e!==r);t=[];for(const O of r){const r=Jt(n,i,e,O);t.push(jt(r,o,s&&s[e],a))}}return t}(t,e,l,s.isIndexable)),e=Gt(t,e)?jt(e,i,o&&o[t],s):e}}),getOwnPropertyDescriptor:(e,t)=>e._descriptors.allKeys?Reflect.has(n,t)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(n,t),getPrototypeOf:()=>Reflect.getPrototypeOf(n),has:(e,t)=>Reflect.has(n,t),ownKeys:()=>Reflect.ownKeys(n),set:(e,t,r)=>(n[t]=r,delete e[t],!0)})}function zt(e,t={scriptable:!0,indexable:!0}){const{_scriptable:r=t.scriptable,_indexable:n=t.indexable,_allKeys:i=t.allKeys}=e;return{allKeys:i,scriptable:r,indexable:n,isScriptable:p(r)?r:()=>r,isIndexable:p(n)?n:()=>n}}const Yt=(e,t)=>e?e+K(t):t,Gt=(e,t)=>O(t)&&"adapters"!==e&&(null===Object.getPrototypeOf(t)||t.constructor===Object);function qt(e,t,r){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:(r=r(),e[t]=r)}function Kt(e,t,r){return p(e)?e(t,r):e}function Xt(e,t,r,n,i){for(const a of t){o=r,s=a;const t=!0===o?s:"string"==typeof o?f(s,o):void 0;if(t){e.add(t);s=Kt(t._fallback,r,i);if(void 0!==s&&s!==r&&s!==n)return s}else if(!1===t&&void 0!==n&&r!==n)return null}var o,s;return!1}function Jt(e,n,i,o){var t=n._rootScopes,r=Kt(n._fallback,i,o),e=[...e,...t],s=new Set,a=(s.add(o),Zt(s,e,i,r||i,o));return null!==a&&(void 0===r||r===i||null!==(a=Zt(s,e,r,a,o)))&&Bt(Array.from(s),[""],t,r,()=>{return e=i,t=o,r=n._getTarget(),e in r||(r[e]={}),N(r=r[e])&&O(t)?t:r||{};var e,t,r})}function Zt(e,t,r,n,i){for(;r;)r=Xt(e,t,r,n,i);return r}function Qt(e,t){for(const r of t)if(r){const t=r[e];if(void 0!==t)return t}}function er(e){let t=e._keys;return t=t||(e._keys=function(e){var t=new Set;for(const r of e)for(const e of Object.keys(r).filter(e=>!e.startsWith("_")))t.add(e);return Array.from(t)}(e._scopes))}function tr(e,t,r,n){var i=e["iScale"],{key:o="r"}=this._parsing,s=new Array(n);let a,l,c,u;for(a=0,l=n;a<l;++a)u=t[c=a+r],s[a]={r:i.parse(f(u,o),c)};return s}const rr=Number.EPSILON||1e-14,nr=(e,t)=>t<e.length&&!e[t].skip&&e[t],ir=e=>"x"===e?"y":"x";function or(e,t,r,n){var e=e.skip?t:e,i=t,t=r.skip?t:r,r=pe(i,e),o=pe(t,i),s=r/(r+o),r=o/(r+o),o=n*(isNaN(s)?0:s),s=n*(isNaN(r)?0:r);return{previous:{x:i.x-o*(t.x-e.x),y:i.y-o*(t.y-e.y)},next:{x:i.x+s*(t.x-e.x),y:i.y+s*(t.y-e.y)}}}function sr(e,o="x"){var t=ir(o),r=e.length,a=Array(r).fill(0),l=Array(r);let n,i,s,c=nr(e,0);for(n=0;n<r;++n)if(i=s,s=c,c=nr(e,n+1),s){if(c){const e=c[o]-s[o];a[n]=0!=e?(c[t]-s[t])/e:0}l[n]=i?c?w(a[n-1])!==w(a[n])?0:(a[n-1]+a[n])/2:a[n-1]:a[n]}{var u=e,d=a,h=l,p=u.length;let t,r,n,i,o,s=nr(u,0);for(let e=0;e<p-1;++e)o=s,s=nr(u,e+1),o&&s&&(ie(d[e],0,rr)?h[e]=h[e+1]=0:(t=h[e]/d[e],r=h[e+1]/d[e],(i=Math.pow(t,2)+Math.pow(r,2))<=9||(n=3/Math.sqrt(i),h[e]=t*n*d[e],h[e+1]=r*n*d[e])))}{var[f,g,m="x"]=[e,l,o];const y=ir(m),v=f.length;let t,r,n,i=nr(f,0);for(let e=0;e<v;++e)if(r=n,n=i,i=nr(f,e+1),n){const v=n[m],b=n[y];r&&(t=(v-r[m])/3,n["cp1"+m]=v-t,n["cp1"+y]=b-t*g[e]),i&&(t=(i[m]-v)/3,n["cp2"+m]=v+t,n["cp2"+y]=b+t*g[e])}}}function ar(e,t,r){return Math.max(Math.min(e,r),t)}function lr(s,t,a,r,e){let n,i,o,l;if(t.spanGaps&&(s=s.filter(e=>!e.skip)),"monotone"===t.cubicInterpolationMode)sr(s,e);else{let e=r?s[s.length-1]:s[0];for(n=0,i=s.length;n<i;++n)o=s[n],l=or(e,o,s[Math.min(n+1,i-(r?0:1))%i],t.tension),o.cp1x=l.previous.x,o.cp1y=l.previous.y,o.cp2x=l.next.x,o.cp2y=l.next.y,e=o}if(t.capBezierPoints){var c=s,u=a;let e,t,r,n,i,o=E(c[0],u);for(e=0,t=c.length;e<t;++e)i=n,n=o,o=e<t-1&&E(c[e+1],u),n&&(r=c[e],i&&(r.cp1x=ar(r.cp1x,u.left,u.right),r.cp1y=ar(r.cp1y,u.top,u.bottom)),o)&&(r.cp2x=ar(r.cp2x,u.left,u.right),r.cp2y=ar(r.cp2y,u.top,u.bottom))}}const cr=e=>0===e||1===e,ur=(e,t,r)=>-Math.pow(2,10*--e)*Math.sin((e-t)*b/r),dr=(e,t,r)=>Math.pow(2,-10*e)*Math.sin((e-t)*b/r)+1,hr={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>--e*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-(--e*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>--e*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>1-Math.cos(e*R),easeOutSine:e=>Math.sin(e*R),easeInOutSine:e=>-.5*(Math.cos(_*e)-1),easeInExpo:e=>0===e?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>1===e?1:1-Math.pow(2,-10*e),easeInOutExpo:e=>cr(e)?e:e<.5?.5*Math.pow(2,10*(2*e-1)):.5*(2-Math.pow(2,-10*(2*e-1))),easeInCirc:e=>1<=e?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1- --e*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>cr(e)?e:ur(e,.075,.3),easeOutElastic:e=>cr(e)?e:dr(e,.075,.3),easeInOutElastic(e){return cr(e)?e:e<.5?.5*ur(2*e,.1125,.45):.5+.5*dr(2*e-1,.1125,.45)},easeInBack(e){return e*e*(2.70158*e-1.70158)},easeOutBack(e){return--e*e*(2.70158*e+1.70158)+1},easeInOutBack(e){let t=1.70158;return(e/=.5)<1?e*e*((1+(t*=1.525))*e-t)*.5:.5*((e-=2)*e*((1+(t*=1.525))*e+t)+2)},easeInBounce:e=>1-hr.easeOutBounce(1-e),easeOutBounce(e){var t=7.5625;return e<1/2.75?t*e*e:e<2/2.75?t*(e-=1.5/2.75)*e+.75:e<2.5/2.75?t*(e-=2.25/2.75)*e+.9375:t*(e-=2.625/2.75)*e+.984375},easeInOutBounce:e=>e<.5?.5*hr.easeInBounce(2*e):.5*hr.easeOutBounce(2*e-1)+.5};function pr(e,t,r,n){return{x:e.x+r*(t.x-e.x),y:e.y+r*(t.y-e.y)}}function fr(e,t,r,n){return{x:e.x+r*(t.x-e.x),y:("middle"===n?r<.5?e:t:"after"===n?r<1?e:t:0<r?t:e).y}}function gr(e,t,r,n){var i={x:e.cp2x,y:e.cp2y},o={x:t.cp1x,y:t.cp1y},e=pr(e,i,r),i=pr(i,o,r),o=pr(o,t,r),t=pr(e,i,r),e=pr(i,o,r);return pr(t,e,r)}const mr=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,yr=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function vr(e,t){var r=(""+e).match(mr);if(!r||"normal"===r[1])return 1.2*t;switch(e=+r[2],r[3]){case"px":return e;case"%":e/=100}return t*e}const br=e=>+e||0;function wr(t,r){var e={},n=O(r),i=n?Object.keys(r):r,o=O(t)?n?e=>I(t[e],t[r[e]]):e=>t[e]:()=>t;for(const t of i)e[t]=br(o(t));return e}function Cr(e){return wr(e,{top:"y",right:"x",bottom:"y",left:"x"})}function Er(e){return wr(e,["topLeft","topRight","bottomLeft","bottomRight"])}function P(e){e=Cr(e);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function L(e,t){t=t||D.font;let r=I((e=e||{}).size,t.size),n=("string"==typeof r&&(r=parseInt(r,10)),I(e.style,t.style));n&&!(""+n).match(yr)&&(console.warn('Invalid font style specified: "'+n+'"'),n=void 0);e={family:I(e.family,t.family),lineHeight:vr(I(e.lineHeight,t.lineHeight),r),size:r,style:n,weight:I(e.weight,t.weight),string:""};return e.string=Ot(e),e}function Tr(e,t,r,n){let i,o,s,a=!0;for(i=0,o=e.length;i<o;++i)if(void 0!==(s=e[i])&&(void 0!==t&&"function"==typeof s&&(s=s(t),a=!1),void 0!==r&&N(s)&&(s=s[r%s.length],a=!1),void 0!==s))return n&&!a&&(n.cacheable=!1),s}function Sr(e,t,r){var{min:e,max:n}=e,t=U(t,(n-e)/2),i=(e,t)=>r&&0===e?0:e+t;return{min:i(e,-Math.abs(t)),max:i(n,t)}}function _r(e,t){return Object.assign(Object.create(e),t)}function xr(e,t,r){return e?(n=t,i=r,{x:e=>n+n+i-e,setWidth(e){i=e},textAlign:e=>"center"===e?e:"right"===e?"left":"right",xPlus:(e,t)=>e-t,leftForLtr:(e,t)=>e-t}):{x:e=>e,setWidth(e){},textAlign:e=>e,xPlus:(e,t)=>e+t,leftForLtr:(e,t)=>e};var n,i}function Rr(e,t){var r,n;"ltr"!==t&&"rtl"!==t||(n=[(r=e.canvas.style).getPropertyValue("direction"),r.getPropertyPriority("direction")],r.setProperty("direction",t,"important"),e.prevTextDirection=n)}function Ar(e,t){void 0!==t&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function Nr(e){return"angle"===e?{between:ge,compare:fe,normalize:C}:{between:u,compare:(e,t)=>e-t,normalize:e=>e}}function Or({start:e,end:t,count:r,loop:n,style:i}){return{start:e%r,end:t%r,loop:n&&(t-e+1)%r==0,style:i}}function Ir(e,r,p){if(!p)return[e];const{property:n,start:i,end:o}=p,s=r.length,{compare:a,between:l,normalize:c}=Nr(n),{start:u,end:d,loop:h,style:f}=function(e,t){var{property:r,start:n,end:i}=p,{between:o,normalize:s}=Nr(r),a=t.length;let l,c,{start:u,end:d,loop:h}=e;if(h){for(u+=a,d+=a,l=0,c=a;l<c&&o(s(t[u%a][r]),n,i);++l)u--,d--;u%=a,d%=a}return d<u&&(d+=a),{start:u,end:d,loop:h,style:e.style}}(e,r),g=[];let m,y,v,b,w=null;for(let e=u,t=u;e<=d;++e)(y=r[e%s]).skip||(m=c(y[n]))!==v&&(b=l(m,i,o),null===(w=null===w&&(b||l(i,v,m)&&0!==a(i,v))?0===a(m,i)?e:t:w)||b&&0!==a(o,m)&&!l(o,v,m)||(g.push(Or({start:w,end:e,loop:h,count:s,style:f})),w=null),t=e,v=m);return null!==w&&g.push(Or({start:w,end:d,loop:h,count:s,style:f})),g}function Mr(t,r){var n=[],i=t.segments;for(let e=0;e<i.length;e++){var o=Ir(i[e],t.points,r);o.length&&n.push(...o)}return n}function kr(e,t){var r,n,i,o=e.points,s=e.options.spanGaps,a=o.length;return a?({start:n,end:i}=function(e,t,r){let n=0,i=t-1;if(r&&!s)for(;n<t&&!e[n].skip;)n++;for(;n<t&&e[n].skip;)n++;for(n%=t,r&&(i+=n);i>n&&e[i%t].skip;)i--;return i%=t,{start:n,end:i}}(o,a,r=!!e._loop),Dr(e,!0===s?[{start:n,end:i,loop:r}]:function(e,t,r,n){var i=e.length,o=[];let s,a=t,l=e[t];for(s=t+1;s<=r;++s){const r=e[s%i];r.skip||r.stop?l.skip||(n=!1,o.push({start:t%i,end:(s-1)%i,loop:n}),t=a=r.stop?s:null):(a=s,l.skip&&(t=s)),l=r}return null!==a&&o.push({start:t%i,end:a%i,loop:n}),o}(o,n,i<n?i+a:i,!!e._fullLoop&&0===n&&i===a-1),o,t)):[]}function Dr(e,t,n,i){if(i&&i.setContext&&n){var a=e,e=t,l=n,c=i;const d=a._chart.getContext(),h=Pr(a.options),{_datasetIndex:p,options:{spanGaps:f}}=a,g=l.length,m=[];let o=h,s=e[0].start,r=s;function u(e,t,r,n){var i=f?-1:1;if(e!==t){for(e+=g;l[e%g].skip;)e-=i;for(;l[t%g].skip;)t+=i;e%g!=t%g&&(m.push({start:e%g,end:t%g,loop:r,style:n}),o=n,s=t%g)}}for(const a of e){s=f?s:a.start;let e,t=l[s%g];for(r=s+1;r<=a.end;r++){const f=l[r%g];(function(e,t){if(!t)return;function r(e,t){return it(t)?(n.includes(t)||n.push(t),n.indexOf(t)):t}const n=[];return JSON.stringify(e,r)!==JSON.stringify(t,r)})(e=Pr(c.setContext(_r(d,{type:"segment",p0:t,p1:f,p0DataIndex:(r-1)%g,p1DataIndex:r%g,datasetIndex:p}))),o)&&u(s,r-1,a.loop,o),t=f,o=e}s<r-1&&u(s,r-1,a.loop,o)}return m}return t}function Pr(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}var Lr=Object.freeze({__proto__:null,HALF_PI:R,INFINITY:ee,PI:_,PITAU:Q,QUARTER_PI:re,RAD_PER_DEG:te,TAU:b,TWO_THIRDS_PI:ne,_addGrace:Sr,_alignPixel:kt,_alignStartEnd:k,_angleBetween:ge,_angleDiff:fe,_arrayUnique:Te,_attachContext:jt,_bezierCurveTo:Vt,_bezierInterpolation:gr,_boundSegment:Ir,_boundSegments:Mr,_capitalize:K,_computeSegments:kr,_createResolver:Bt,_decimalPlaces:de,_deprecated:function(e,t,r,n){void 0!==t&&console.warn(e+': "'+r+'" is deprecated. Please use "'+n+'" instead')},_descriptors:zt,_elementsEqual:V,_factorize:se,_filterBetween:be,_getParentNode:vt,_getStartAndCountOfVisiblePoints:Ne,_int16Range:me,_isBetween:u,_isClickEvent:Z,_isDomSupported:yt,_isPointInArea:E,_limitValue:A,_longestText:Mt,_lookup:ye,_lookupByKey:m,_measureText:It,_merger:B,_mergerIf:Y,_normalizeAngle:C,_parseObjectDataRadialScale:tr,_pointInLine:pr,_readValueToProps:wr,_rlookupByKey:ve,_scaleRangesChanged:Oe,_setMinAndMaxByKey:ce,_splitKey:q,_steppedInterpolation:fr,_steppedLineTo:Ut,_textX:Ae,_toLeftRightCenter:Re,_updateBezierControlPoints:lr,addRoundedRectPath:$t,almostEquals:ie,almostWhole:le,callback:d,clearCanvas:Dt,clipArea:Ft,clone:W,color:ot,createContext:_r,debounce:xe,defined:X,distanceBetweenPoints:pe,drawPoint:Pt,drawPointLegend:Lt,each:S,easingEffects:hr,finiteOrDefault:h,fontString:function(e,t,r){return t+" "+e+"px "+r},formatNumber:ut,getAngleFromPoint:he,getHoverColor:st,getMaximumSize:xt,getRelativePosition:St,getRtlAdapter:xr,getStyle:Ct,isArray:N,isFinite:g,isFunction:p,isNullOrUndef:x,isNumber:ae,isObject:O,isPatternOrGradient:it,listenArrayEvents:Ce,log10:a,merge:j,mergeIf:z,niceNum:oe,noop:e,overrideTextDirection:Rr,readUsedSize:Nt,renderText:Wt,requestAnimFrame:Se,resolve:Tr,resolveObjectKey:f,restoreTextDirection:Ar,retinaScale:Rt,setsEqual:J,sign:w,splineCurve:or,splineCurveMonotone:sr,supportsEventListenerOptions:At,throttled:_e,toDegrees:ue,toDimension:U,toFont:L,toFontString:Ot,toLineHeight:vr,toPadding:P,toPercentage:H,toRadians:M,toTRBL:Cr,toTRBLCorners:Er,uid:F,unclipArea:Ht,unlistenArrayEvents:Ee,valueOrDefault:I});function Fr(e,r,n,i,o){var s=e.getSortedVisibleDatasetMetas(),a=n[r];for(let e=0,t=s.length;e<t;++e){const{index:n,data:l}=s[e],{lo:c,hi:u}=function(e,t,r,n){const{controller:i,data:o,_sorted:s}=e,a=i._cachedMeta.iScale;if(a&&t===a.axis&&"r"!==t&&s&&o.length){const e=a._reversePixels?ve:m;if(!n)return e(o,t,r);if(i._sharedOptions){const n=o[0],i="function"==typeof n.getRange&&n.getRange(t);if(i){const n=e(o,t,r-i),s=e(o,t,r+i);return{lo:n.lo,hi:s.hi}}}}return{lo:0,hi:o.length-1}}(s[e],r,a,o);for(let e=c;e<=u;++e){const r=l[e];r.skip||i(r,n,e)}}}function Hr(n,i,e,o,s){const a=[];return(s||n.isPointInArea(i))&&Fr(n,e,i,function(e,t,r){(s||E(e,n.chartArea,0))&&e.inRange(i.x,i.y,o)&&a.push({element:e,datasetIndex:t,index:r})},!0),a}function Ur(e,t,r,n,i,a){{if(a||e.isPointInArea(t)){if("r"!==r||n){var l=e,c=t,u=r,d=n,h=i,p=a;let o=[];const m=function(e){const n=-1!==e.indexOf("x"),i=-1!==e.indexOf("y");return function(e,t){var r=n?Math.abs(e.x-t.x):0,e=i?Math.abs(e.y-t.y):0;return Math.sqrt(Math.pow(r,2)+Math.pow(e,2))}}(u);let s=Number.POSITIVE_INFINITY;return Fr(l,u,c,function(e,t,r){var n,i=e.inRange(c.x,c.y,h);(!d||i)&&(n=e.getCenterPoint(h),p||l.isPointInArea(n)||i)&&((i=m(c,n))<s?(o=[{element:e,datasetIndex:t,index:r}],s=i):i===s&&o.push({element:e,datasetIndex:t,index:r}))}),o}{var f=t,g=i;let s=[];return Fr(e,r,f,function(e,t,r){var{startAngle:n,endAngle:i}=e.getProps(["startAngle","endAngle"],g),o=he(e,{x:f.x,y:f.y})["angle"];ge(o,n,i)&&s.push({element:e,datasetIndex:t,index:r})}),s}}return[]}}function Vr(e,n,i,t,o){const s=[],a="x"===i?"inXRange":"inYRange";let l=!1;return Fr(e,i,n,(e,t,r)=>{e[a](n[i],o)&&(s.push({element:e,datasetIndex:t,index:r}),l=l||e.inRange(n.x,n.y,o))}),t&&!l?[]:s}var Wr={evaluateInteractionItems:Fr,modes:{index(e,t,r,n){const i=St(t,e),o=r.axis||"x",s=r.includeInvisible||!1,a=r.intersect?Hr(e,i,o,n,s):Ur(e,i,o,!1,n,s),l=[];return a.length?(e.getSortedVisibleDatasetMetas().forEach(e=>{var t=a[0].index,r=e.data[t];r&&!r.skip&&l.push({element:r,datasetIndex:e.index,index:t})}),l):[]},dataset(e,t,r,n){var t=St(t,e),i=r.axis||"xy",o=r.includeInvisible||!1;let s=r.intersect?Hr(e,t,i,n,o):Ur(e,t,i,!1,n,o);if(0<s.length){const t=s[0].datasetIndex,r=e.getDatasetMeta(t).data;s=[];for(let e=0;e<r.length;++e)s.push({element:r[e],datasetIndex:t,index:e})}return s},point:(e,t,r,n)=>Hr(e,St(t,e),r.axis||"xy",n,r.includeInvisible||!1),nearest(e,t,r,n){var t=St(t,e),i=r.axis||"xy",o=r.includeInvisible||!1;return Ur(e,t,i,r.intersect,n,o)},x:(e,t,r,n)=>Vr(e,St(t,e),"x",r.intersect,n),y:(e,t,r,n)=>Vr(e,St(t,e),"y",r.intersect,n)}};const $r=["left","top","right","bottom"];function Br(e,t){return e.filter(e=>e.pos===t)}function jr(e,t){return e.filter(e=>-1===$r.indexOf(e.pos)&&e.box.axis===t)}function zr(e,n){return e.sort((e,t)=>{var r=n?t:e,e=n?e:t;return r.weight===e.weight?r.index-e.index:r.weight-e.weight})}function Yr(e,t,r,n){return Math.max(e[r],t[r])+Math.max(e[n],t[n])}function Gr(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function qr(e,t,r,n){var i=[];let o,s,a,l,c,u;for(o=0,s=e.length,c=0;o<s;++o){a=e[o],(l=a.box).update(a.width||t.w,a.height||t.h,function(e,t){const r=t.maxPadding;{const n={left:0,top:0,right:0,bottom:0};return(e=e?["left","right"]:["top","bottom"]).forEach(e=>{n[e]=Math.max(t[e],r[e])}),n}}(a.horizontal,t));const{same:s,other:d}=function(e,t,r,n){var{pos:i,box:o}=r,s=e.maxPadding;if(!O(i)){r.size&&(e[i]-=r.size);const t=n[r.stack]||{size:0,count:1};t.size=Math.max(t.size,r.horizontal?o.height:o.width),r.size=t.size/t.count,e[i]+=r.size}return o.getPadding&&Gr(s,o.getPadding()),n=Math.max(0,t.outerWidth-Yr(s,e,"left","right")),i=Math.max(0,t.outerHeight-Yr(s,e,"top","bottom")),o=n!==e.w,t=i!==e.h,e.w=n,e.h=i,r.horizontal?{same:o,other:t}:{same:t,other:o}}(t,r,a,n);c|=s&&i.length,u=u||d,l.fullSize||i.push(a)}return c&&qr(i,t,r,n)||u}function Kr(e,t,r,n,i){e.top=r,e.left=t,e.right=t+n,e.bottom=r+i,e.width=n,e.height=i}function Xr(e,t,r,n){var i=r.padding;let{x:o,y:s}=t;for(const a of e){const e=a.box,l=n[a.stack]||{count:1,placed:0,weight:1},c=a.stackWeight/l.weight||1;if(a.horizontal){const n=t.w*c,o=l.size||e.height;X(l.start)&&(s=l.start),e.fullSize?Kr(e,i.left,s,r.outerWidth-i.right-i.left,o):Kr(e,t.left+l.placed,s,n,o),l.start=s,l.placed+=n,s=e.bottom}else{const n=t.h*c,s=l.size||e.width;X(l.start)&&(o=l.start),e.fullSize?Kr(e,o,i.top,s,r.outerHeight-i.bottom-i.top):Kr(e,o,t.top+l.placed,s,n),l.start=o,l.placed+=n,o=e.right}}t.x=o,t.y=s}var i={addBox(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(e){t.draw(e)}}]},e.boxes.push(t)},removeBox(e,t){t=e.boxes?e.boxes.indexOf(t):-1;-1!==t&&e.boxes.splice(t,1)},configure(e,t,r){t.fullSize=r.fullSize,t.position=r.position,t.weight=r.weight},update(t,e,r,n){if(t){var i,o,s=P(t.options.layout.padding),a=Math.max(e-s.width,0),l=Math.max(r-s.height,0),c=(u=function(e){var t=[];let r,n,i,o,s,a;for(r=0,n=(e||[]).length;r<n;++r)({position:o,options:{stack:s,stackWeight:a=1}}=i=e[r]),t.push({index:r,box:i,pos:o,horizontal:i.isHorizontal(),weight:i.weight,stack:s&&o+s,stackWeight:a});return t}(t.boxes),c=zr(u.filter(e=>e.box.fullSize),!0),d=zr(Br(u,"left"),!0),h=zr(Br(u,"right")),f=zr(Br(u,"top"),!0),i=zr(Br(u,"bottom")),o=jr(u,"x"),p=jr(u,"y"),{fullSize:c,leftAndTop:d.concat(f),rightAndBottom:h.concat(p).concat(i).concat(o),chartArea:Br(u,"chartArea"),vertical:d.concat(h).concat(p),horizontal:f.concat(i).concat(o)}),u=c.vertical,d=c.horizontal,h=(S(t.boxes,e=>{"function"==typeof e.beforeLayout&&e.beforeLayout()}),u.reduce((e,t)=>t.box.options&&!1===t.box.options.display?e:e+1,0)||1),p=Object.freeze({outerWidth:e,outerHeight:r,padding:s,availableWidth:a,availableHeight:l,vBoxMaxWidth:a/2/h,hBoxMaxHeight:l/2}),f=Object.assign({},s);Gr(f,P(n));const y=Object.assign({maxPadding:f,w:a,h:l,x:s.left,y:s.top},s),v=function(e,t){var r=function(e){var t,r={};for(const n of e){const{stack:e,pos:i,stackWeight:o}=n;e&&$r.includes(i)&&((t=r[e]||(r[e]={count:0,placed:0,weight:0,size:0})).count++,t.weight+=o)}return r}(e),{vBoxMaxWidth:n,hBoxMaxHeight:i}=t;let o,s,a;for(o=0,s=e.length;o<s;++o){const s=(a=e[o]).box["fullSize"],l=r[a.stack],c=l&&a.stackWeight/l.weight;a.horizontal?(a.width=c?c*n:s&&t.availableWidth,a.height=i):(a.width=n,a.height=c?c*i:s&&t.availableHeight)}return r}(u.concat(d),p);qr(c.fullSize,y,p,v),qr(u,y,p,v),qr(d,y,p,v)&&qr(u,y,p,v);{var g=y;const b=g.maxPadding;function m(e){var t=Math.max(b[e]-g[e],0);return g[e]+=t,t}g.y+=m("top"),g.x+=m("left"),m("right"),m("bottom")}Xr(c.leftAndTop,y,p,v),y.x+=y.w,y.y+=y.h,Xr(c.rightAndBottom,y,p,v),t.chartArea={left:y.left,top:y.top,right:y.left+y.w,bottom:y.top+y.h,height:y.h,width:y.w},S(c.chartArea,e=>{e=e.box;Object.assign(e,t.chartArea),e.update(y.w,y.h,{left:0,top:0,right:0,bottom:0})})}}};class Jr{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,r){}removeEventListener(e,t,r){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,r,n){return t=Math.max(0,t||e.width),r=r||e.height,{width:t,height:Math.max(0,n?Math.floor(t/n):r)}}isAttached(e){return!0}updateConfig(e){}}class Zr extends Jr{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const Qr="$chartjs",en={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},tn=e=>null===e||""===e,rn=!!At&&{passive:!0};function nn(e,t){for(const r of e)if(r===t||r.contains(t))return!0}function on(e,t,r){const n=e.canvas,i=new MutationObserver(e=>{let t=!1;for(const r of e)t=t||nn(r.addedNodes,n),t=t&&!nn(r.removedNodes,n);t&&r()});return i.observe(document,{childList:!0,subtree:!0}),i}function sn(e,t,r){const n=e.canvas,i=new MutationObserver(e=>{let t=!1;for(const r of e)t=t||nn(r.removedNodes,n),t=t&&!nn(r.addedNodes,n);t&&r()});return i.observe(document,{childList:!0,subtree:!0}),i}const an=new Map;let ln=0;function cn(){const r=window.devicePixelRatio;r!==ln&&(ln=r,an.forEach((e,t)=>{t.currentDevicePixelRatio!==r&&e()}))}function un(e,t,n){const r=e.canvas,i=r&&vt(r);if(i){const s=_e((e,t)=>{var r=i.clientWidth;n(e,t),r<i.clientWidth&&n()},window),a=new ResizeObserver(e=>{var e=e[0],t=e.contentRect.width,e=e.contentRect.height;0===t&&0===e||s(t,e)});return a.observe(i),e=e,o=s,an.size||window.addEventListener("resize",cn),an.set(e,o),a;var o}}function dn(e,t,r){r&&r.disconnect(),"resize"===t&&(r=e,an.delete(r),an.size||window.removeEventListener("resize",cn))}function hn(t,e,r){var n=t.canvas,i=_e(e=>{null!==t.ctx&&r(function(e,t){var r=en[e.type]||e.type,{x:n,y:i}=St(e,t);return{type:r,chart:t,native:e,x:void 0!==n?n:null,y:void 0!==i?i:null}}(e,t))},t);return n.addEventListener(e,i,rn),i}class pn extends Jr{acquireContext(e,t){var r=e&&e.getContext&&e.getContext("2d");{if(r&&r.canvas===e){var n=t,t=e.style,i=e.getAttribute("height"),o=e.getAttribute("width");if(e[Qr]={initial:{height:i,width:o,style:{display:t.display,height:t.height,width:t.width}}},t.display=t.display||"block",t.boxSizing=t.boxSizing||"border-box",tn(o)){const n=Nt(e,"width");void 0!==n&&(e.width=n)}if(tn(i))if(""===e.style.height)e.height=e.width/(n||2);else{const n=Nt(e,"height");void 0!==n&&(e.height=n)}return r}return null}}releaseContext(e){const r=e.canvas;if(!r[Qr])return!1;const n=r[Qr].initial,t=(["height","width"].forEach(e=>{var t=n[e];x(t)?r.removeAttribute(e):r.setAttribute(e,t)}),n.style||{});return Object.keys(t).forEach(e=>{r.style[e]=t[e]}),r.width=r.width,delete r[Qr],!0}addEventListener(e,t,r){this.removeEventListener(e,t);var n=e.$proxies||(e.$proxies={}),i={attach:on,detach:sn,resize:un}[t]||hn;n[t]=i(e,t,r)}removeEventListener(e,t){var r=e.$proxies||(e.$proxies={}),n=r[t];n&&(({attach:dn,detach:dn,resize:dn}[t]||function(e,t,r){e.canvas.removeEventListener(t,r,rn)})(e,t,n),r[t]=void 0)}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,r,n){return xt(e,t,r,n)}isAttached(e){e=vt(e);return!(!e||!e.isConnected)}}function fn(e){return!yt()||"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas?Zr:pn}At=Object.freeze({__proto__:null,BasePlatform:Jr,BasicPlatform:Zr,DomPlatform:pn,_detectPlatform:fn});const gn="transparent",mn={boolean:(e,t,r)=>.5<r?t:e,color(e,t,r){var e=ot(e||gn),n=e.valid&&ot(t||gn);return n&&n.valid?n.mix(e,r).hexString():t},number:(e,t,r)=>e+(t-e)*r};class yn{constructor(e,t,r,n){var i=t[r],i=(n=Tr([e.to,n,i,e.from]),Tr([e.from,i,n]));this._active=!0,this._fn=e.fn||mn[e.type||typeof i],this._easing=hr[e.easing]||hr.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=r,this._from=i,this._to=n,this._promises=void 0}active(){return this._active}update(e,t,r){var n,i,o;this._active&&(this._notify(!1),n=this._target[this._prop],i=r-this._start,o=this._duration-i,this._start=r,this._duration=Math.floor(Math.max(o,e.duration)),this._total+=i,this._loop=!!e.loop,this._to=Tr([e.to,t,n,e.from]),this._from=Tr([e.from,n,t]))}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){var e=e-this._start,t=this._duration,r=this._prop,n=this._from,i=this._loop,o=this._to;this._active=n!==o&&(i||e<t),this._active?e<0?this._target[r]=n:(e=e/t%2,e=this._easing(Math.min(1,Math.max(0,i&&1<e?2-e:e))),this._target[r]=this._fn(n,o,e)):(this._target[r]=o,this._notify(!0))}wait(){const r=this._promises||(this._promises=[]);return new Promise((e,t)=>{r.push({res:e,rej:t})})}_notify(e){var t=e?"res":"rej",r=this._promises||[];for(let e=0;e<r.length;e++)r[e][t]()}}class vn{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(n){if(O(n)){const i=Object.keys(D.animation),o=this._properties;Object.getOwnPropertyNames(n).forEach(t=>{var e=n[t];if(O(e)){const r={};for(const n of i)r[n]=e[n];(N(e.properties)&&e.properties||[t]).forEach(e=>{e!==t&&o.has(e)||o.set(e,r)})}})}}_animateOptions(e,t){const r=t.options,n=function(t,r){if(r){let e=t.options;if(e)return e.$shared&&(t.options=e=Object.assign({},e,{$shared:!1,$animations:{}})),e;t.options=r}}(e,r);return n?(t=this._createAnimations(n,r),r.$shared&&function(t,e){var r=[],n=Object.keys(e);for(let e=0;e<n.length;e++){var i=t[n[e]];i&&i.active()&&r.push(i.wait())}return Promise.all(r)}(e.options.$animations,r).then(()=>{e.options=r},()=>{}),t):[]}_createAnimations(t,r){var n=this._properties,i=[],o=t.$animations||(t.$animations={}),e=Object.keys(r),s=Date.now();let a;for(a=e.length-1;0<=a;--a){var l=e[a];if("$"!==l.charAt(0))if("options"===l)i.push(...this._animateOptions(t,r));else{var c=r[l];let e=o[l];var u=n.get(l);if(e){if(u&&e.active()){e.update(u,c,s);continue}e.cancel()}u&&u.duration?(o[l]=e=new yn(u,t,l,c),i.push(e)):t[l]=c}}return i}update(e,t){var r;if(0!==this._properties.size)return(r=this._createAnimations(e,t)).length?(o.add(this._chart,r),!0):void 0;Object.assign(e,t)}}function bn(e,t){var e=e&&e.options||{},r=e.reverse,n=void 0===e.min?t:0,e=void 0===e.max?t:0;return{start:r?e:n,end:r?n:e}}function wn(e,t){var r=[],n=e._getSortedDatasetMetas(t);let i,o;for(i=0,o=n.length;i<o;++i)r.push(n[i].index);return r}function Cn(e,t,r,n={}){var i=e.keys,o="single"===n.mode;let s,a,l,c;if(null!==t){for(s=0,a=i.length;s<a;++s){if((l=+i[s])===r){if(n.all)continue;break}g(c=e.values[l])&&(o||0===t||w(t)===w(c))&&(t+=c)}return t}}function En(e,t){e=e&&e.options.stacked;return e||void 0===e&&void 0!==t.stack}function Tn(e,t,r,n){for(const i of t.getMatchingVisibleMetas(n).reverse()){const t=e[i.index];if(r&&0<t||!r&&t<0)return i.index}return null}function Sn(e,t){const{chart:r,_cachedMeta:n}=e,i=r._stacks||(r._stacks={}),{iScale:o,vScale:s,index:a}=n,l=o.axis,c=s.axis,u=`${o.id}.${s.id}.`+(n.stack||n.type),d=t.length;var h,p,f;for(let e=0;e<d;++e){const r=t[e],{[l]:o,[c]:d}=r;(p=(r._stacks||(r._stacks={}))[c]=(f=o,(h=(h=i)[p=u]||(h[p]={}))[f]||(h[f]={})))[a]=d,p._top=Tn(p,s,!0,n.type),p._bottom=Tn(p,s,!1,n.type),(p._visualValues||(p._visualValues={}))[a]=d}}function _n(e,t){const r=e.scales;return Object.keys(r).filter(e=>r[e].axis===t).shift()}function xn(e,t){var r=e.controller.index,n=e.vScale&&e.vScale.axis;if(n){t=t||e._parsed;for(const e of t){const t=e._stacks;if(!t||void 0===t[n]||void 0===t[n][r])return;delete t[n][r],void 0!==t[n]._visualValues&&void 0!==t[n]._visualValues[r]&&delete t[n]._visualValues[r]}}}const Rn=e=>"reset"===e||"none"===e,An=(e,t)=>t?e:Object.assign({},e);class Nn{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){var e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=En(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&xn(this._cachedMeta),this.index=e}linkScales(){var e=this.chart,t=this._cachedMeta,r=this.getDataset(),n=(e,t,r,n)=>"x"===e?t:"r"===e?n:r,i=t.xAxisID=I(r.xAxisID,_n(e,"x")),o=t.yAxisID=I(r.yAxisID,_n(e,"y")),r=t.rAxisID=I(r.rAxisID,_n(e,"r")),e=t.indexAxis,s=t.iAxisID=n(e,i,o,r),n=t.vAxisID=n(e,o,i,r);t.xScale=this.getScaleForId(i),t.yScale=this.getScaleForId(o),t.rScale=this.getScaleForId(r),t.iScale=this.getScaleForId(s),t.vScale=this.getScaleForId(n)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){var t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){var e=this._cachedMeta;this._data&&Ee(this._data,this),e._stacked&&xn(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),r=this._data;if(O(t))this._data=function(e){var t=Object.keys(e),r=new Array(t.length);let n,i,o;for(n=0,i=t.length;n<i;++n)o=t[n],r[n]={x:o,y:e[o]};return r}(t);else if(r!==t){if(r){Ee(r,this);const e=this._cachedMeta;xn(e),e._parsed=[]}t&&Object.isExtensible(t)&&Ce(t,this),this._syncList=[],this._data=t}}addElements(){var e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){var t=this._cachedMeta,r=this.getDataset();let n=!1;this._dataCheck();var i=t._stacked;t._stacked=En(t.vScale,t),t.stack!==r.stack&&(n=!0,xn(t),t.stack=r.stack),this._resyncElements(e),!n&&i===t._stacked||Sn(this,t._parsed)}configure(){var e=this.chart.config,t=e.datasetScopeKeys(this._type),t=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(t,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:r,_data:n}=this,{iScale:i,_stacked:o}=r,s=i.axis;let a,l,c,u=0===e&&t===n.length||r._sorted,d=0<e&&r._parsed[e-1];if(!1===this._parsing)r._parsed=n,r._sorted=!0,c=n;else{c=N(n[e])?this.parseArrayData(r,n,e,t):O(n[e])?this.parseObjectData(r,n,e,t):this.parsePrimitiveData(r,n,e,t);const i=()=>null===l[s]||d&&l[s]<d[s];for(a=0;a<t;++a)r._parsed[a+e]=l=c[a],u&&(i()&&(u=!1),d=l);r._sorted=u}o&&Sn(this,c)}parsePrimitiveData(e,t,r,n){var{iScale:i,vScale:o}=e,s=i.axis,a=o.axis,l=i.getLabels(),c=i===o,u=new Array(n);let d,h,p;for(d=0,h=n;d<h;++d)p=d+r,u[d]={[s]:c||i.parse(l[p],p),[a]:o.parse(t[p],p)};return u}parseArrayData(e,t,r,n){var{xScale:i,yScale:o}=e,s=new Array(n);let a,l,c,u;for(a=0,l=n;a<l;++a)u=t[c=a+r],s[a]={x:i.parse(u[0],c),y:o.parse(u[1],c)};return s}parseObjectData(e,t,r,n){var{xScale:i,yScale:o}=e,{xAxisKey:s="x",yAxisKey:a="y"}=this._parsing,l=new Array(n);let c,u,d,h;for(c=0,u=n;c<u;++c)h=t[d=c+r],l[c]={x:i.parse(f(h,s),d),y:o.parse(f(h,a),d)};return l}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,r){var n=this.chart,i=this._cachedMeta,o=t[e.axis];return Cn({keys:wn(n,!0),values:t._stacks[e.axis]._visualValues},o,i.index,{mode:r})}updateRangeFromParsed(e,t,r,n){var i=r[t.axis];let o=null===i?NaN:i;r=n&&r._stacks[t.axis];n&&r&&(n.values=r,o=Cn(n,i,this._cachedMeta.index)),e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}getMinMax(t,e){const r=this._cachedMeta,n=r._parsed,i=r._sorted&&t===r.iScale,o=n.length,s=this._getOtherScale(t),a=(d=this.chart,e&&!r.hidden&&r._stacked&&{keys:wn(d,!0),values:null}),l={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:c,max:u}=function(){var{min:e,max:t,minDefined:r,maxDefined:n}=s.getUserBounds();return{min:r?e:Number.NEGATIVE_INFINITY,max:n?t:Number.POSITIVE_INFINITY}}();var d;let h,p;function f(){var e=(p=n[h])[s.axis];return!g(p[t.axis])||c>e||u<e}for(h=0;h<o&&(f()||(this.updateRangeFromParsed(l,t,p,a),!i));++h);if(i)for(h=o-1;0<=h;--h)if(!f()){this.updateRangeFromParsed(l,t,p,a);break}return l}getAllParsedValues(e){var t=this._cachedMeta._parsed,r=[];let n,i,o;for(n=0,i=t.length;n<i;++n)g(o=t[n][e.axis])&&r.push(o);return r}getMaxOverflow(){return!1}getLabelAndValue(e){var t=this._cachedMeta,r=t.iScale,t=t.vScale,e=this.getParsed(e);return{label:r?""+r.getLabelForValue(e[r.axis]):"",value:t?""+t.getLabelForValue(e[t.axis]):""}}_update(e){var t,r=this._cachedMeta;this.update(e||"default"),r._clip=function(e){let t,r,n,i;return O(e)?(t=e.top,r=e.right,n=e.bottom,i=e.left):t=r=n=i=e,{top:t,right:r,bottom:n,left:i,disabled:!1===e}}(I(this.options.clip,(e=r.xScale,r=r.yScale,!1!==(t=this.getMaxOverflow())&&(e=bn(e,t),{top:(r=bn(r,t)).end,right:e.end,bottom:r.start,left:e.start}))))}update(e){}draw(){const e=this._ctx,t=this.chart,r=this._cachedMeta,n=r.data||[],i=t.chartArea,o=[],s=this._drawStart||0,a=this._drawCount||n.length-s,l=this.options.drawActiveElementsOnTop;let c;for(r.dataset&&r.dataset.draw(e,i,s,a),c=s;c<s+a;++c){const t=n[c];t.hidden||(t.active&&l?o.push(t):t.draw(e,i))}for(c=0;c<o.length;++c)o[c].draw(e,i)}getStyle(e,t){t=t?"active":"default";return void 0===e&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(t):this.resolveDataElementOptions(e||0,t)}getContext(e,t,r){var n,i=this.getDataset();let o;if(0<=e&&e<this._cachedMeta.data.length){const t=this._cachedMeta.data[e];(o=t.$context||(t.$context=_r(this.getContext(),{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:t,index:e,mode:"default",type:"data"}))).parsed=this.getParsed(e),o.raw=i.data[e],o.index=o.dataIndex=e}else(o=this.$context||(this.$context=(e=this.chart.getContext(),n=this.index,_r(e,{active:!1,dataset:void 0,datasetIndex:n,index:n,mode:"default",type:"dataset"})))).dataset=i,o.index=o.datasetIndex=this.index;return o.active=!!t,o.mode=r,o}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e,t="default",r){const n="active"===t,i=this._cachedDataOpts,o=e+"-"+t,s=i[o],a=this.enableOptionSharing&&X(r);var l,c,u;return s?An(s,a):(c=(u=this.chart.config).datasetElementScopeKeys(this._type,e),l=n?[e+"Hover","hover",e,""]:[e,""],c=u.getOptionScopes(this.getDataset(),c),e=Object.keys(D.elements[e]),(u=u.resolveNamedOptions(c,e,()=>this.getContext(r,n,t),l)).$shared&&(u.$shared=a,i[o]=Object.freeze(An(u,a))),u)}_resolveAnimations(e,t,r){const n=this.chart,i=this._cachedDataOpts,o="animation-"+t,s=i[o];if(s)return s;let a;if(!1!==n.options.animation){const n=this.chart.config,i=n.datasetAnimationScopeKeys(this._type,t),o=n.getOptionScopes(this.getDataset(),i);a=n.createResolver(o,this.getContext(e,r,t))}e=new vn(n,a&&a.animations);return a&&a._cacheable&&(i[o]=Object.freeze(e)),e}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||Rn(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){var e=this.resolveDataElementOptions(e,t),r=this._sharedOptions,n=this.getSharedOptions(e),r=this.includeOptions(t,n)||n!==r;return this.updateSharedOptions(n,t,e),{sharedOptions:n,includeOptions:r}}updateElement(e,t,r,n){Rn(n)?Object.assign(e,r):this._resolveAnimations(t,n).update(e,r)}updateSharedOptions(e,t,r){e&&!Rn(t)&&this._resolveAnimations(void 0,t).update(e,r)}_setStyle(e,t,r,n){e.active=n;var i=this.getStyle(t,n);this._resolveAnimations(t,r,n).update(e,{options:!n&&this.getSharedOptions(i)||i})}removeHoverStyle(e,t,r){this._setStyle(e,r,"active",!1)}setHoverStyle(e,t,r){this._setStyle(e,r,"active",!0)}_removeDatasetHoverStyle(){var e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){var e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,r=this._cachedMeta.data;for(const[e,t,r]of this._syncList)this[e](t,r);this._syncList=[];var n=r.length,i=t.length,o=Math.min(i,n);o&&this.parse(0,o),n<i?this._insertElements(n,i-n,e):i<n&&this._removeElements(i,n-i)}_insertElements(e,t,r=!0){const n=this._cachedMeta,i=n.data,o=e+t;let s;var a=e=>{for(e.length+=t,s=e.length-1;s>=o;s--)e[s]=e[s-t]};for(a(i),s=e;s<o;++s)i[s]=new this.dataElementType;this._parsing&&a(n._parsed),this.parse(e,t),r&&this.updateElements(i,e,t,"reset")}updateElements(e,t,r,n){}_removeElements(e,t){var r,n=this._cachedMeta;this._parsing&&(r=n._parsed.splice(e,t),n._stacked)&&xn(n,r),n.data.splice(e,t)}_sync(e){var t,r,n;this._parsing?this._syncList.push(e):([t,r,n]=e,this[t](r,n)),this.chart._dataChanges.push([this.index,...e])}_onDataPush(){var e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);t=arguments.length-2;t&&this._sync(["_insertElements",e,t])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}class t{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(e){var{x:e,y:t}=this.getProps(["x","y"],e);return{x:e,y:t}}hasValue(){return ae(this.x)&&ae(this.y)}getProps(e,t){const r=this.$animations;if(!t||!r)return this;const n={};return e.forEach(e=>{n[e]=r[e]&&r[e].active()?r[e]._to:this[e]}),n}}function On(e,t,r,n,i){var o=I(n,0),s=Math.min(I(i,e.length),e.length);let a,l,c,u=0;for(r=Math.ceil(r),i&&(r=(a=i-n)/Math.floor(a/r)),c=o;c<0;)u++,c=Math.round(o+u*r);for(l=Math.max(o,0);l<s;l++)l===c&&(t.push(e[l]),u++,c=Math.round(o+u*r))}const In=(e,t,r)=>"top"===t||"left"===t?e[t]+r:e[t]-r,Mn=(e,t)=>Math.min(t||e,e);function kn(e,t){var r=[],n=e.length/t,i=e.length;let o=0;for(;o<i;o+=n)r.push(e[Math.floor(o)]);return r}function Dn(e){return e.drawTicks?e.tickLength:0}function Pn(e,t){var r;return e.display?(t=L(e.font,t),r=P(e.padding),(N(e.text)?e.text.length:1)*t.lineHeight+r.height):0}class Ln extends t{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){var{_userMin:e,_userMax:t,_suggestedMin:r,_suggestedMax:n}=this,e=h(e,Number.POSITIVE_INFINITY),t=h(t,Number.NEGATIVE_INFINITY),r=h(r,Number.POSITIVE_INFINITY),n=h(n,Number.NEGATIVE_INFINITY);return{min:h(e,r),max:h(t,n),minDefined:g(e),maxDefined:g(t)}}getMinMax(r){let n,{min:i,max:o,minDefined:s,maxDefined:a}=this.getUserBounds();if(s&&a)return{min:i,max:o};var l=this.getMatchingVisibleMetas();for(let e=0,t=l.length;e<t;++e)n=l[e].controller.getMinMax(this,r),s||(i=Math.min(i,n.min)),a||(o=Math.max(o,n.max));return i=a&&i>o?o:i,o=s&&i>o?i:o,{min:h(i,h(o,i)),max:h(o,h(i,o))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){var e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){d(this.options.beforeUpdate,[this])}update(e,t,r){var{beginAtZero:n,grace:i,ticks:o}=this.options,s=o.sampleSize,e=(this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=r=Object.assign({left:0,right:0,top:0,bottom:0},r),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+r.left+r.right:this.height+r.top+r.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=Sr(this,i,n),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks(),s<this.ticks.length);this._convertTicksToLabels(e?kn(this.ticks,s):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||"auto"===o.source)&&(this.ticks=function(e,n){const t=e.options.ticks,r=(u=(e=e).options.offset,d=e._tickSize(),u=e._length/d+(u?0:1),e=e._maxLength/d,Math.floor(Math.min(u,e))),i=Math.min(t.maxTicksLimit||r,r),o=t.major.enabled?function(e){var t=[];let r,n;for(r=0,n=e.length;r<n;r++)e[r].major&&t.push(r);return t}(n):[],s=o.length,a=o[0],l=o[s-1],c=[];var u,d;if(i<s){var h=n;var p=c;var f=o;var g=s/i;let e,t=0,r=f[0];for(g=Math.ceil(g),e=0;e<h.length;e++)e===r&&(p.push(h[e]),t++,r=f[t*g])}else{var m=function(e,r,t){var e=function(e){var t=e.length;let r,n;if(t<2)return!1;for(n=e[0],r=1;r<t;++r)if(e[r]-e[r-1]!==n)return!1;return n}(e),n=r.length/t;if(e){var i=se(e);for(let e=0,t=i.length-1;e<t;e++){const r=i[e];if(r>n)return r}}return Math.max(n,1)}(o,n,i);if(0<s){let e,t;const r=1<s?Math.round((l-a)/(s-1)):null;for(On(n,c,m,x(r)?0:a-r,a),e=0,t=s-1;e<t;e++)On(n,c,m,o[e],o[e+1]);On(n,c,m,l,x(r)?n.length:l+r)}else On(n,c,m)}return c}(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),e&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e,t,r=this.options.reverse;this.isHorizontal()?(e=this.left,t=this.right):(e=this.top,t=this.bottom,r=!r),this._startPixel=e,this._endPixel=t,this._reversePixels=r,this._length=t-e,this._alignToPixels=this.options.alignToPixels}afterUpdate(){d(this.options.afterUpdate,[this])}beforeSetDimensions(){d(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){d(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),d(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){d(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){var t=this.options.ticks;let r,n,i;for(r=0,n=e.length;r<n;r++)(i=e[r]).label=d(t.callback,[i.value,r,e],this)}afterTickToLabelConversion(){d(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){d(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){var e,t,r,n,i=this.options,o=i.ticks,s=Mn(this.ticks.length,i.ticks.maxTicksLimit),a=o.minRotation||0,l=o.maxRotation;let c,u,d,h=a;!this._isVisible()||!o.display||l<=a||s<=1||!this.isHorizontal()?this.labelRotation=a:(t=(e=this._getLabelSizes()).widest.width,r=e.highest.height,n=A(this.chart.width-t,0,this.maxWidth),(i.offset?this.maxWidth/s:n/(s-1))<t+6&&(c=n/(s-(i.offset?.5:1)),u=this.maxHeight-Dn(i.grid)-o.padding-Pn(i.title,this.chart.options.font),d=Math.sqrt(t*t+r*r),h=ue(Math.min(Math.asin(A((e.highest.height+6)/c,-1,1)),Math.asin(A(u/d,-1,1))-Math.asin(A(r/d,-1,1)))),h=Math.max(a,Math.min(l,h))),this.labelRotation=h)}afterCalculateLabelRotation(){d(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){d(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:r,title:n,grid:i}}=this,o=this._isVisible(),s=this.isHorizontal();if(o){const o=Pn(n,t.options.font);if(s?(e.width=this.maxWidth,e.height=Dn(i)+o):(e.height=this.maxHeight,e.width=Dn(i)+o),r.display&&this.ticks.length){const{first:t,last:n,widest:i,highest:o}=this._getLabelSizes(),a=2*r.padding,l=M(this.labelRotation),c=Math.cos(l),u=Math.sin(l);if(s){const t=r.mirror?0:u*i.width+c*o.height;e.height=Math.min(this.maxHeight,e.height+t+a)}else{const t=r.mirror?0:c*i.width+u*o.height;e.width=Math.min(this.maxWidth,e.width+t+a)}this._calculatePadding(t,n,u,c)}}this._handleMargins(),s?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(r,n,i,o){const{ticks:{align:s,padding:a},position:l}=this.options,c=0!==this.labelRotation,u="top"!==l&&"x"===this.axis;if(this.isHorizontal()){const l=this.getPixelForTick(0)-this.left,d=this.right-this.getPixelForTick(this.ticks.length-1);let e=0,t=0;c?t=u?(e=o*r.width,i*n.height):(e=i*r.height,o*n.width):"start"===s?t=n.width:"end"===s?e=r.width:"inner"!==s&&(e=r.width/2,t=n.width/2),this.paddingLeft=Math.max((e-l+a)*this.width/(this.width-l),0),this.paddingRight=Math.max((t-d+a)*this.width/(this.width-d),0)}else{let e=n.height/2,t=r.height/2;"start"===s?(e=0,t=r.height):"end"===s&&(e=n.height,t=0),this.paddingTop=e+a,this.paddingBottom=t+a}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){d(this.options.afterFit,[this])}isHorizontal(){var{axis:e,position:t}=this.options;return"top"===t||"bottom"===t||"x"===e}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){let t,r;for(this.beforeTickToLabelConversion(),this.generateTickLabels(e),t=0,r=e.length;t<r;t++)x(e[t].label)&&(e.splice(t,1),r--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){var r=this.options.ticks.sampleSize;let e=this.ticks;r<e.length&&(e=kn(e,r)),this._labelSizes=t=this._computeLabelSizes(e,e.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(e,t,r){const{ctx:n,_longestTextCache:i}=this,o=[],s=[],a=Math.floor(t/Mn(t,r));let l,c,u,d,h,p,f,g,m,y,v,b=0,w=0;for(l=0;l<t;l+=a){if(d=e[l].label,h=this._resolveTickFontOptions(l),n.font=p=h.string,f=i[p]=i[p]||{data:{},gc:[]},g=h.lineHeight,m=y=0,x(d)||N(d)){if(N(d))for(c=0,u=d.length;c<u;++c)x(v=d[c])||N(v)||(m=It(n,f.data,f.gc,m,v),y+=g)}else m=It(n,f.data,f.gc,m,d),y=g;o.push(m),s.push(y),b=Math.max(m,b),w=Math.max(y,w)}C=t,S(i,e=>{var t=e.gc,r=t.length/2;let n;if(C<r){for(n=0;n<r;++n)delete e.data[t[n]];t.splice(0,r)}});var C,r=o.indexOf(b),E=s.indexOf(w),T=e=>({width:o[e]||0,height:s[e]||0});return{first:T(0),last:T(t-1),widest:T(r),highest:T(E),widths:o,heights:s}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){var t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);e=this._startPixel+e*this._length;return me(this._alignToPixels?kt(this.chart,e,0):e)}getDecimalForPixel(e){e=(e-this._startPixel)/this._length;return this._reversePixels?1-e:e}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){var{min:e,max:t}=this;return e<0&&t<0?t:0<e&&0<t?e:0}getContext(e){var t=this.ticks||[];return 0<=e&&e<t.length?(t=t[e]).$context||(t.$context=_r(this.getContext(),{tick:t,index:e,type:"tick"})):this.$context||(this.$context=_r(this.chart.getContext(),{scale:this,type:"scale"}))}_tickSize(){var e=this.options.ticks,t=M(this.labelRotation),r=Math.abs(Math.cos(t)),t=Math.abs(Math.sin(t)),n=this._getLabelSizes(),e=e.autoSkipPadding||0,i=n?n.widest.width+e:0,n=n?n.highest.height+e:0;return this.isHorizontal()?i*t<n*r?i/r:n/t:n*t<i*r?n/r:i/t}_isVisible(){var e=this.options.display;return"auto"!==e?!!e:0<this.getMatchingVisibleMetas().length}_computeGridLineItems(e){function t(e){return kt(n,e,f)}const r=this.axis,n=this.chart,i=this.options,{grid:o,position:s,border:a}=i,l=o.offset,c=this.isHorizontal(),u=this.ticks.length+(l?1:0),d=Dn(o),h=[],p=a.setContext(this.getContext()),f=p.display?p.width:0,g=f/2;let m,y,v,b,w,C,E,T,S,_,x,R;if("top"===s)m=t(this.bottom),C=this.bottom-d,T=m-g,_=t(e.top)+g,R=e.bottom;else if("bottom"===s)m=t(this.top),_=e.top,R=t(e.bottom)-g,C=m+g,T=this.top+d;else if("left"===s)m=t(this.right),w=this.right-d,E=m-g,S=t(e.left)+g,x=e.right;else if("right"===s)m=t(this.left),S=e.left,x=t(e.right)-g,w=m+g,E=this.left+d;else if("x"===r){if("center"===s)m=t((e.top+e.bottom)/2+.5);else if(O(s)){const e=Object.keys(s)[0],r=s[e];m=t(this.chart.scales[e].getPixelForValue(r))}_=e.top,R=e.bottom,C=m+g,T=C+d}else if("y"===r){if("center"===s)m=t((e.left+e.right)/2);else if(O(s)){const e=Object.keys(s)[0],r=s[e];m=t(this.chart.scales[e].getPixelForValue(r))}w=m-g,E=w-d,S=e.left,x=e.right}var e=I(i.ticks.maxTicksLimit,u),A=Math.max(1,Math.ceil(u/e));for(y=0;y<u;y+=A){const e=this.getContext(y),r=o.setContext(e),i=a.setContext(e),O=r.lineWidth,s=r.color,I=i.dash||[],u=i.dashOffset,d=r.tickWidth,p=r.tickColor,f=r.tickBorderDash||[],g=r.tickBorderDashOffset;void 0!==(v=function(e,t,r){var n=e.ticks.length,i=Math.min(t,n-1),o=e._startPixel,s=e._endPixel;let a,l=e.getPixelForTick(i);if(!(r&&(a=1===n?Math.max(l-o,s-l):0===t?(e.getPixelForTick(1)-l)/2:(l-e.getPixelForTick(i-1))/2,(l+=i<t?a:-a)<o-1e-6||l>s+1e-6)))return l}(this,y,l))&&(b=kt(n,v,O),c?w=E=S=x=b:C=T=_=R=b,h.push({tx1:w,ty1:C,tx2:E,ty2:T,x1:S,y1:_,x2:x,y2:R,width:O,color:s,borderDash:I,borderDashOffset:u,tickWidth:d,tickColor:p,tickBorderDash:f,tickBorderDashOffset:g}))}return this._ticksLength=u,this._borderValue=m,h}_computeLabelItems(n){const i=this.axis,o=this.options,{position:s,ticks:t}=o,a=this.isHorizontal(),l=this.ticks,{align:c,crossAlign:u,padding:e,mirror:d}=t,r=Dn(o.grid),h=r+e,p=d?-e:h,f=-M(this.labelRotation),g=[];let m,y,v,b,w,C,E,T,S,_,x,R="middle";if("top"===s)w=this.bottom-p,C=this._getXAxisLabelAlignment();else if("bottom"===s)w=this.top+p,C=this._getXAxisLabelAlignment();else if("left"===s){const n=this._getYAxisLabelAlignment(r);C=n.textAlign,b=n.x}else if("right"===s){const n=this._getYAxisLabelAlignment(r);C=n.textAlign,b=n.x}else if("x"===i){if("center"===s)w=(n.top+n.bottom)/2+h;else if(O(s)){const n=Object.keys(s)[0],i=s[n];w=this.chart.scales[n].getPixelForValue(i)+h}C=this._getXAxisLabelAlignment()}else if("y"===i){if("center"===s)b=(n.left+n.right)/2-h;else if(O(s)){const n=Object.keys(s)[0],i=s[n];b=this.chart.scales[n].getPixelForValue(i)}C=this._getYAxisLabelAlignment(r).textAlign}"y"===i&&("start"===c?R="top":"end"===c&&(R="bottom"));var A=this._getLabelSizes();for(m=0,y=l.length;m<y;++m){v=l[m].label;const n=t.setContext(this.getContext(m)),i=(E=this.getPixelForTick(m)+t.labelOffset,S=(T=this._resolveTickFontOptions(m)).lineHeight,(_=N(v)?v.length:1)/2),o=n.color,O=n.textStrokeColor,c=n.textStrokeWidth;let r,e=C;if(a?(b=E,"inner"===C&&(e=m===y-1?this.options.reverse?"left":"right":0===m?this.options.reverse?"right":"left":"center"),x="top"===s?"near"===u||0!=f?-_*S+S/2:"center"===u?-A.highest.height/2-i*S+S:-A.highest.height+S/2:"near"===u||0!=f?S/2:"center"===u?A.highest.height/2-i*S:A.highest.height-_*S,d&&(x*=-1),0==f||n.showLabelBackdrop||(b+=S/2*Math.sin(f))):(w=E,x=(1-_)*S/2),n.showLabelBackdrop){const i=P(n.backdropPadding),o=A.heights[m],s=A.widths[m];let e=x-i.top,t=0-i.left;switch(R){case"middle":e-=o/2;break;case"bottom":e-=o}switch(C){case"center":t-=s/2;break;case"right":t-=s;break;case"inner":m===y-1?t-=s:0<m&&(t-=s/2)}r={left:t,top:e,width:s+i.width,height:o+i.height,color:n.backdropColor}}g.push({label:v,font:T,textOffset:x,options:{rotation:f,color:o,strokeColor:O,strokeWidth:c,textAlign:e,textBaseline:R,translation:[b,w],backdrop:r}})}return g}_getXAxisLabelAlignment(){var{position:e,ticks:t}=this.options;if(-M(this.labelRotation))return"top"===e?"left":"right";let r="center";return"start"===t.align?r="left":"end"===t.align?r="right":"inner"===t.align&&(r="inner"),r}_getYAxisLabelAlignment(e){var{position:t,ticks:{crossAlign:r,mirror:n,padding:i}}=this.options,e=e+i,o=this._getLabelSizes().widest.width;let s,a;return"left"===t?n?(a=this.right+i,"near"===r?s="left":"center"===r?(s="center",a+=o/2):(s="right",a+=o)):(a=this.right-e,"near"===r?s="right":"center"===r?(s="center",a-=o/2):(s="left",a=this.left)):"right"===t?n?(a=this.left+i,"near"===r?s="right":"center"===r?(s="center",a-=o/2):(s="left",a-=o)):(a=this.left+e,"near"===r?s="left":"center"===r?(s="center",a+=o/2):(s="right",a=this.right)):s="right",{textAlign:s,x:a}}_computeLabelArea(){var e,t;if(!this.options.ticks.mirror)return e=this.chart,"left"===(t=this.options.position)||"right"===t?{top:0,left:this.left,bottom:e.height,right:this.right}:"top"===t||"bottom"===t?{top:this.top,left:0,bottom:this.bottom,right:e.width}:void 0}drawBackground(){var{ctx:e,options:{backgroundColor:t},left:r,top:n,width:i,height:o}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(r,n,i,o),e.restore())}getLineWidthForValue(t){var e,r=this.options.grid;return this._isVisible()&&r.display&&0<=(e=this.ticks.findIndex(e=>e.value===t))?r.setContext(this.getContext(e)).lineWidth:0}drawGrid(e){const t=this.options.grid,n=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let i,o;var s=(e,t,r)=>{r.width&&r.color&&(n.save(),n.lineWidth=r.width,n.strokeStyle=r.color,n.setLineDash(r.borderDash||[]),n.lineDashOffset=r.borderDashOffset,n.beginPath(),n.moveTo(e.x,e.y),n.lineTo(t.x,t.y),n.stroke(),n.restore())};if(t.display)for(i=0,o=r.length;i<o;++i){const e=r[i];t.drawOnChartArea&&s({x:e.x1,y:e.y1},{x:e.x2,y:e.y2},e),t.drawTicks&&s({x:e.tx1,y:e.ty1},{x:e.tx2,y:e.ty2},{color:e.tickColor,width:e.tickWidth,borderDash:e.tickBorderDash,borderDashOffset:e.tickBorderDashOffset})}}drawBorder(){var{chart:i,ctx:o,options:{border:s,grid:a}}=this,l=s.setContext(this.getContext()),s=s.display?l.width:0;if(s){var a=a.setContext(this.getContext(0)).lineWidth,c=this._borderValue;let e,t,r,n;this.isHorizontal()?(e=kt(i,this.left,s)-s/2,t=kt(i,this.right,a)+a/2,r=n=c):(r=kt(i,this.top,s)-s/2,n=kt(i,this.bottom,a)+a/2,e=t=c),o.save(),o.lineWidth=l.width,o.strokeStyle=l.color,o.beginPath(),o.moveTo(e,r),o.lineTo(t,n),o.stroke(),o.restore()}}drawLabels(e){if(this.options.ticks.display){const t=this.ctx,r=this._computeLabelArea(),n=(r&&Ft(t,r),this.getLabelItems(e));for(const e of n){const r=e.options,n=e.font;Wt(t,e.label,0,e.textOffset,n,r)}r&&Ht(t)}}drawTitle(){var{ctx:t,options:{position:r,title:n,reverse:i}}=this;if(n.display){var o=L(n.font),s=P(n.padding),a=n.align;let e=o.lineHeight/2;"bottom"===r||"center"===r||O(r)?(e+=s.bottom,N(n.text)&&(e+=o.lineHeight*(n.text.length-1))):e+=s.top;var{titleX:s,titleY:l,maxWidth:c,rotation:u}=function(e,t,r,n){var{top:i,left:o,bottom:s,right:a,chart:l}=e,{chartArea:l,scales:c}=l;let u,d,h,p=0;var f=s-i,g=a-o;if(e.isHorizontal()){if(d=k(n,o,a),O(r)){const e=Object.keys(r)[0],n=r[e];h=c[e].getPixelForValue(n)+f-t}else h="center"===r?(l.bottom+l.top)/2+f-t:In(e,r,t);u=a-o}else{if(O(r)){const e=Object.keys(r)[0],n=r[e];d=c[e].getPixelForValue(n)-g+t}else d="center"===r?(l.left+l.right)/2-g+t:In(e,r,t);h=k(n,s,i),p="left"===r?-R:R}return{titleX:d,titleY:h,maxWidth:u,rotation:p}}(this,e,r,a);Wt(t,n.text,0,0,o,{color:n.color,maxWidth:c,rotation:u,textAlign:function(e,t,r){let n=Re(e);return n=r&&"right"!==t||!r&&"right"===t?"left"===(e=n)?"right":"right"===e?"left":e:n}(a,r,i),textBaseline:"middle",translation:[s,l]})}}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){var e=this.options,t=e.ticks&&e.ticks.z||0,r=I(e.grid&&e.grid.z,-1),e=I(e.border&&e.border.z,0);return this._isVisible()&&this.draw===Ln.prototype.draw?[{z:r,draw:e=>{this.drawBackground(),this.drawGrid(e),this.drawTitle()}},{z:e,draw:()=>{this.drawBorder()}},{z:t,draw:e=>{this.drawLabels(e)}}]:[{z:t,draw:e=>{this.draw(e)}}]}getMatchingVisibleMetas(e){var t=this.chart.getSortedVisibleDatasetMetas(),r=this.axis+"AxisID",n=[];let i,o;for(i=0,o=t.length;i<o;++i){const o=t[i];o[r]!==this.id||e&&o.type!==e||n.push(o)}return n}_resolveTickFontOptions(e){return L(this.options.ticks.setContext(this.getContext(e)).font)}_maxDigits(){var e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class Fn{constructor(e,t,r){this.type=e,this.scope=t,this.override=r,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){var t=Object.getPrototypeOf(e);let r;"id"in(s=t)&&"defaults"in s&&(r=this.register(t));var n,i,o,s=this.items,t=e.id,a=this.scope+"."+t;if(t)return t in s||(s[t]=e,s=e,t=a,n=r,n=j(Object.create(null),[n?D.get(n):{},D.get(t),s.defaults]),D.set(t,n),s.defaultRoutes&&(i=t,o=s.defaultRoutes,Object.keys(o).forEach(e=>{var t=e.split("."),r=t.pop(),t=[i].concat(t).join("."),e=o[e].split("."),n=e.pop(),e=e.join(".");D.route(t,r,e,n)})),s.descriptors&&D.describe(t,s.descriptors),this.override&&D.override(e.id,e.overrides)),a;throw new Error("class does not have id: "+e)}get(e){return this.items[e]}unregister(e){var t=this.items,e=e.id,r=this.scope;e in t&&delete t[e],r&&e in D[r]&&(delete D[r][e],this.override)&&delete pt[e]}}var T=new class{constructor(){this.controllers=new Fn(Nn,"datasets",!0),this.elements=new Fn(t,"elements"),this.plugins=new Fn(Object,"plugins"),this.scales=new Fn(Ln,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(r,e,n){[...e].forEach(e=>{var t=n||this._getRegistryForType(e);n||t.isForType(e)||t===this.plugins&&e.id?this._exec(r,t,e):S(e,e=>{var t=n||this._getRegistryForType(e);this._exec(r,t,e)})})}_exec(e,t,r){var n=K(e);d(r["before"+n],[],r),t[e](r),d(r["after"+n],[],r)}_getRegistryForType(t){for(let e=0;e<this._typedRegistries.length;e++){var r=this._typedRegistries[e];if(r.isForType(t))return r}return this.plugins}_get(e,t,r){t=t.get(e);if(void 0===t)throw new Error('"'+e+'" is not a registered '+r+".");return t}};class Hn{constructor(){this._init=[]}notify(e,t,r,n){"beforeInit"===t&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));n=n?this._descriptors(e).filter(n):this._descriptors(e),r=this._notify(n,e,t,r);return"afterDestroy"===t&&(this._notify(n,e,"stop"),this._notify(this._init,e,"uninstall")),r}_notify(e,t,r,n){n=n||{};for(const i of e){const e=i.plugin;if(!1===d(e[r],[t,n,i.options],e)&&n.cancelable)return!1}return!0}invalidate(){x(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){var t;return this._cache||(t=this._cache=this._createDescriptors(e),this._notifyStateChanges(e),t)}_createDescriptors(e,t){var r=e&&e.config,n=I(r.options&&r.options.plugins,{}),r=function(e){const t={},r=[],n=Object.keys(T.plugins.items);for(let e=0;e<n.length;e++)r.push(T.getPlugin(n[e]));var i=e.plugins||[];for(let e=0;e<i.length;e++){const n=i[e];-1===r.indexOf(n)&&(r.push(n),t[n.id]=!0)}return{plugins:r,localIds:t}}(r);if(!1!==n||t){var i,o,s,a,l,c,[u,{plugins:d,localIds:h},p,f]=[e,r,n,t],g=[],m=u.getContext();for(const y of d){const d=y.id,v=(c=p[d],f||!1!==c?!0===c?{}:c:null);null!==v&&g.push({plugin:y,options:([c,{plugin:i,local:o},s,a]=[u.config,{plugin:y,local:h[d]},v,m],l=void 0,l=c.pluginScopeKeys(i),s=c.getOptionScopes(s,l),o&&i.defaults&&s.push(i.defaults),c.createResolver(s,a,[""],{scriptable:!1,indexable:!1,allKeys:!0}))})}return g}return[]}_notifyStateChanges(e){var t=this._oldCache||[],r=this._cache,n=(e,r)=>e.filter(t=>!r.some(e=>t.plugin.id===e.plugin.id));this._notify(n(t,r),e,"stop"),this._notify(n(r,t),e,"start")}}function Un(e,t){var r=D.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||r.indexAxis||"x"}function Vn(e){if("x"===e||"y"===e||"r"===e)return e}function Wn(e,...t){if(Vn(e))return e;for(const n of t){const t=n.axis||("top"===(r=n.position)||"bottom"===r?"x":"left"===r||"right"===r?"y":void 0)||1<e.length&&Vn(e[0].toLowerCase());if(t)return t}var r;throw new Error(`Cannot determine type of '${e}' axis. Please provide 'axis' or 'position' option.`)}function $n(e,t,r){if(r[t+"AxisID"]===e)return{axis:t}}function Bn(e){var t=e.options||(e.options={});t.plugins=I(t.plugins,{}),t.scales=function(s,t){const o=pt[s.type]||{scales:{}},a=t.scales||{},l=Un(s.type,t),c=Object.create(null);return Object.keys(a).forEach(e=>{var t=a[e];if(!O(t))return console.error("Invalid scale configuration for scale: "+e);if(t._proxy)return console.warn("Ignoring resolver passed as options for scale: "+e);const r=Wn(e,t,function(t,e){if(e.data&&e.data.datasets){e=e.data.datasets.filter(e=>e.xAxisID===t||e.yAxisID===t);if(e.length)return $n(t,"x",e[0])||$n(t,"y",e[0])}return{}}(e,s),D.scales[t.type]),n=r===l?"_index_":"_value_",i=o.scales||{};c[e]=z(Object.create(null),[{axis:r},t,i[r],i[n]])}),s.data.datasets.forEach(n=>{const e=n.type||s.type,i=n.indexAxis||Un(e,t),o=(pt[e]||{}).scales||{};Object.keys(o).forEach(e=>{var t=function(e,t){let r=e;return"_index_"===e?r=t:"_value_"===e&&(r="x"===t?"y":"x"),r}(e,i),r=n[t+"AxisID"]||t;c[r]=c[r]||Object.create(null),z(c[r],[{axis:t},a[r],o[e]])})}),Object.keys(c).forEach(e=>{e=c[e];z(e,[D.scales[e.type],D.scale])}),c}(e,t)}function jn(e){return(e=e||{}).datasets=e.datasets||[],e.labels=e.labels||[],e}const zn=new Map,Yn=new Set;function Gn(e,t){let r=zn.get(e);return r||(r=t(),zn.set(e,r),Yn.add(r)),r}const qn=(e,t,r)=>{t=f(t,r);void 0!==t&&e.add(t)};class Kn{constructor(e){this._config=((e=(e=e)||{}).data=jn(e.data),Bn(e),e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=jn(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){var e=this._config;this.clearCache(),Bn(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return Gn(e,()=>[["datasets."+e,""]])}datasetAnimationScopeKeys(e,t){return Gn(e+".transition."+t,()=>[[`datasets.${e}.transitions.`+t,"transitions."+t],["datasets."+e,""]])}datasetElementScopeKeys(e,t){return Gn(e+"-"+t,()=>[[`datasets.${e}.elements.`+t,"datasets."+e,"elements."+t,""]])}pluginScopeKeys(e){const t=e.id;return Gn(this.type+"-plugin-"+t,()=>[["plugins."+t,...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){var r=this._scopeCache;let n=r.get(e);return n&&!t||(n=new Map,r.set(e,n)),n}getOptionScopes(t,e,r){const{options:n,type:i}=this,o=this._cachedScopes(t,r),s=o.get(e);if(s)return s;const a=new Set;e.forEach(e=>{t&&(a.add(t),e.forEach(e=>qn(a,t,e))),e.forEach(e=>qn(a,n,e)),e.forEach(e=>qn(a,pt[i]||{},e)),e.forEach(e=>qn(a,D,e)),e.forEach(e=>qn(a,ft,e))});r=Array.from(a);return 0===r.length&&r.push(Object.create(null)),Yn.has(e)&&o.set(e,r),r}chartOptionScopes(){var{options:e,type:t}=this;return[e,pt[t]||{},D.datasets[t]||{},{type:t},D,ft]}resolveNamedOptions(e,t,r,n=[""]){var i={$shared:!0},{resolver:n,subPrefixes:o}=Xn(this._resolverCache,e,n);let s=n;!function(e,t){var{isScriptable:r,isIndexable:n}=zt(e);for(const i of t){const t=r(i),o=n(i),s=(o||t)&&e[i];if(t&&(p(s)||Jn(s))||o&&N(s))return 1}}(n,t)||(i.$shared=!1,s=jt(n,r=p(r)?r():r,this.createResolver(e,r,o)));for(const e of t)i[e]=s[e];return i}createResolver(e,t,r=[""],n){e=Xn(this._resolverCache,e,r).resolver;return O(t)?jt(e,t,void 0,n):e}}function Xn(e,t,r){let n=e.get(t);n||(n=new Map,e.set(t,n));e=r.join();let i=n.get(e);return i||(i={resolver:Bt(t,r),subPrefixes:r.filter(e=>!e.toLowerCase().includes("hover"))},n.set(e,i)),i}const Jn=t=>O(t)&&Object.getOwnPropertyNames(t).some(e=>p(t[e])),Zn=["top","bottom","left","right","chartArea"];function Qn(e,t){return"top"===e||"bottom"===e||-1===Zn.indexOf(e)&&"x"===t}function ei(r,n){return function(e,t){return e[r]===t[r]?e[n]-t[n]:e[r]-t[r]}}function ti(e){var t=e.chart,r=t.options.animation;t.notifyPlugins("afterRender"),d(r&&r.onComplete,[e],t)}function ri(e){var t=e.chart,r=t.options.animation;d(r&&r.onProgress,[e],t)}function ni(e){return yt()&&"string"==typeof e?e=document.getElementById(e):e&&e.length&&(e=e[0]),e=e&&e.canvas?e.canvas:e}const ii={},oi=e=>{const t=ni(e);return Object.values(ii).filter(e=>e.canvas===t).pop()};function si(e,t,r){return(e.options.clip?e:t)[r]}class r{static defaults=D;static instances=ii;static overrides=pt;static registry=T;static version="4.4.1";static getChart=oi;static register(...e){T.add(...e),ai()}static unregister(...e){T.remove(...e),ai()}constructor(e,t){var t=this.config=new Kn(t),e=ni(e),r=oi(e);if(r)throw new Error("Canvas is already in use. Chart with ID '"+r.id+"' must be destroyed before the canvas with ID '"+r.canvas.id+"' can be reused.");var r=t.createResolver(t.chartOptionScopes(),this.getContext()),t=(this.platform=new(t.platform||fn(e)),this.platform.updateConfig(t),this.platform.acquireContext(e,r.aspectRatio)),e=t&&t.canvas,n=e&&e.height,i=e&&e.width;this.id=F(),this.ctx=t,this.canvas=e,this.width=i,this.height=n,this._options=r,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new Hn,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=xe(e=>this.update(e),r.resizeDelay||0),this._dataChanges=[],ii[this.id]=this,t&&e?(o.listen(this,"complete",ti),o.listen(this,"progress",ri),this._initialize(),this.attached&&this.update()):console.error("Failed to create chart: can't acquire context from the given item")}get aspectRatio(){var{options:{aspectRatio:e,maintainAspectRatio:t},width:r,height:n,_aspectRatio:i}=this;return x(e)?t&&i?i:n?r/n:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return T}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():Rt(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Dt(this.canvas,this.ctx),this}stop(){return o.stop(this),this}resize(e,t){o.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){var r=this.options,n=this.canvas,i=r.maintainAspectRatio&&this.aspectRatio,n=this.platform.getMaximumSize(n,e,t,i),e=r.devicePixelRatio||this.platform.getDevicePixelRatio(),t=this.width?"resize":"attach";this.width=n.width,this.height=n.height,this._aspectRatio=this.aspectRatio,Rt(this,e,!0)&&(this.notifyPlugins("resize",{size:n}),d(r.onResize,[this,n],this),this.attached)&&this._doResize(t)&&this.render()}ensureScalesHaveIDs(){S(this.options.scales||{},(e,t)=>{e.id=t})}buildOrUpdateScales(){const s=this.options,n=s.scales,a=this.scales,l=Object.keys(a).reduce((e,t)=>(e[t]=!1,e),{});let e=[];S(e=n?e.concat(Object.keys(n).map(e=>{var t=n[e],e=Wn(e,t),r="r"===e,e="x"===e;return{options:t,dposition:r?"chartArea":e?"bottom":"left",dtype:r?"radialLinear":e?"category":"linear"}})):e,e=>{var t=e.options,r=t.id,n=Wn(r,t),i=I(t.type,e.dtype);void 0!==t.position&&Qn(t.position,n)===Qn(e.dposition)||(t.position=e.dposition),l[r]=!0;let o=null;r in a&&a[r].type===i?o=a[r]:(o=new(T.getScale(i))({id:r,type:i,ctx:this.ctx,chart:this}),a[o.id]=o),o.init(t,s)}),S(l,(e,t)=>{e||delete a[t]}),S(a,e=>{i.configure(this,e,e.options),i.addBox(this,e)})}_updateMetasets(){var e=this._metasets,t=this.data.datasets.length,r=e.length;if(e.sort((e,t)=>e.index-t.index),t<r){for(let e=t;e<r;++e)this._destroyDatasetMeta(e);e.splice(t,r-t)}this._sortedMetasets=e.slice(0).sort(ei("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:r}}=this;e.length>r.length&&delete this._stacks,e.forEach((t,e)=>{0===r.filter(e=>e===t._dataset).length&&this._destroyDatasetMeta(e)})}buildOrUpdateControllers(){const t=[],r=this.data.datasets;let n,i;for(this._removeUnreferencedMetasets(),n=0,i=r.length;n<i;n++){const i=r[n];let e=this.getDatasetMeta(n);var o=i.type||this.config.type;if(e.type&&e.type!==o&&(this._destroyDatasetMeta(n),e=this.getDatasetMeta(n)),e.type=o,e.indexAxis=i.indexAxis||Un(o,this.options),e.order=i.order||0,e.index=n,e.label=""+i.label,e.visible=this.isDatasetVisible(n),e.controller)e.controller.updateIndex(n),e.controller.linkScales();else{const r=T.getController(o),{datasetElementType:i,dataElementType:s}=D.datasets[o];Object.assign(r,{dataElementType:T.getElement(s),datasetElementType:i&&T.getElement(i)}),e.controller=new r(this,n),t.push(e.controller)}}return this._updateMetasets(),t}_resetElements(){S(this.data.datasets,(e,t)=>{this.getDatasetMeta(t).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const n=this.config,i=(n.update(),this._options=n.createResolver(n.chartOptionScopes(),this.getContext())),o=this._animationsDisabled=!i.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),!1!==this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})){var s=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let r=0;for(let e=0,t=this.data.datasets.length;e<t;e++){const n=this.getDatasetMeta(e)["controller"],i=!o&&-1===s.indexOf(n);n.buildOrUpdateElements(i),r=Math.max(+n.getMaxOverflow(),r)}r=this._minPadding=i.layout.autoPadding?r:0,this._updateLayout(r),o||S(s,e=>{e.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(ei("z","_idx"));var{_active:e,_lastEvent:t}=this;t?this._eventHandler(t,!0):e.length&&this._updateHoverStyles(e,e,!0),this.render()}}_updateScales(){S(this.scales,e=>{i.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){var e=this.options,t=new Set(Object.keys(this._listeners)),r=new Set(e.events);J(t,r)&&!!this._responsiveListeners===e.responsive||(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){var e,t,r,n,i=this["_hiddenIndices"];for({method:e,start:t,count:r}of this._getUniformDataChanges()||[]){o=void 0;s=void 0;a=void 0;n=void 0;var o=i;var s=t;var a="_removeElements"===e?-r:r;const l=Object.keys(o);for(const c of l){const l=+c;l>=s&&(n=o[c],delete o[c],0<a||l>s)&&(o[l+a]=n)}}}_getUniformDataChanges(){const e=this._dataChanges;if(e&&e.length){this._dataChanges=[];var t=this.data.datasets.length,r=t=>new Set(e.filter(e=>e[0]===t).map((e,t)=>t+","+e.splice(1).join(","))),n=r(0);for(let e=1;e<t;e++)if(!J(n,r(e)))return;return Array.from(n).map(e=>e.split(",")).map(e=>({method:e[1],start:+e[2],count:+e[3]}))}}_updateLayout(e){if(!1!==this.notifyPlugins("beforeLayout",{cancelable:!0})){i.update(this,this.width,this.height,e);const t=this.chartArea,r=t.width<=0||t.height<=0;this._layers=[],S(this.boxes,e=>{r&&"chartArea"===e.position||(e.configure&&e.configure(),this._layers.push(...e._layers()))},this),this._layers.forEach((e,t)=>{e._idx=t}),this.notifyPlugins("afterLayout")}}_updateDatasets(r){if(!1!==this.notifyPlugins("beforeDatasetsUpdate",{mode:r,cancelable:!0})){for(let e=0,t=this.data.datasets.length;e<t;++e)this.getDatasetMeta(e).controller.configure();for(let e=0,t=this.data.datasets.length;e<t;++e)this._updateDataset(e,p(r)?r({datasetIndex:e}):r);this.notifyPlugins("afterDatasetsUpdate",{mode:r})}}_updateDataset(e,t){var r=this.getDatasetMeta(e),e={meta:r,index:e,mode:t,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetUpdate",e)&&(r.controller._update(t),e.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",e))}render(){!1!==this.notifyPlugins("beforeRender",{cancelable:!0})&&(o.has(this)?this.attached&&!o.running(this)&&o.start(this):(this.draw(),ti({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:e,height:t}=this._resizeBeforeDraw;this._resize(e,t),this._resizeBeforeDraw=null}if(this.clear(),!(this.width<=0||this.height<=0)&&!1!==this.notifyPlugins("beforeDraw",{cancelable:!0})){const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}}_getSortedDatasetMetas(e){var t=this._sortedMetasets,r=[];let n,i;for(n=0,i=t.length;n<i;++n){const i=t[n];e&&!i.visible||r.push(i)}return r}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(!1!==this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})){var t=this.getSortedVisibleDatasetMetas();for(let e=t.length-1;0<=e;--e)this._drawDataset(t[e]);this.notifyPlugins("afterDatasetsDraw")}}_drawDataset(n){var e=this.ctx,t=n._clip,r=!t.disabled,i=function(e){var{xScale:t,yScale:r}=n;return t&&r?{left:si(t,e,"left"),right:si(t,e,"right"),top:si(r,e,"top"),bottom:si(r,e,"bottom")}:e}(this.chartArea),o={meta:n,index:n.index,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetDraw",o)&&(r&&Ft(e,{left:!1===t.left?0:i.left-t.left,right:!1===t.right?this.width:i.right+t.right,top:!1===t.top?0:i.top-t.top,bottom:!1===t.bottom?this.height:i.bottom+t.bottom}),n.controller.draw(),r&&Ht(e),o.cancelable=!1,this.notifyPlugins("afterDatasetDraw",o))}isPointInArea(e){return E(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,r,n){t=Wr.modes[t];return"function"==typeof t?t(this,e,r,n):[]}getDatasetMeta(e){const t=this.data.datasets[e],r=this._metasets;let n=r.filter(e=>e&&e._dataset===t).pop();return n||(n={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},r.push(n)),n}getContext(){return this.$context||(this.$context=_r(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){var t=this.data.datasets[e];return!!t&&("boolean"==typeof(e=this.getDatasetMeta(e)).hidden?!e.hidden:!t.hidden)}setDatasetVisibility(e,t){this.getDatasetMeta(e).hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(t,e,r){const n=r?"show":"hide",i=this.getDatasetMeta(t),o=i.controller._resolveAnimations(void 0,n);X(e)?(i.data[e].hidden=!r,this.update()):(this.setDatasetVisibility(t,r),o.update(i,{visible:r}),this.update(e=>e.datasetIndex===t?n:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){var t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),o.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");var{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),Dt(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete ii[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const r=this._listeners,n=this.platform,t=(e,t)=>{n.addEventListener(this,e,t),r[e]=t},i=(e,t,r)=>{e.offsetX=t,e.offsetY=r,this._eventHandler(e)};S(this.options.events,e=>t(e,i))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const r=this._responsiveListeners,n=this.platform,e=(e,t)=>{n.addEventListener(this,e,t),r[e]=t},t=(e,t)=>{r[e]&&(n.removeEventListener(this,e,t),delete r[e])},i=(e,t)=>{this.canvas&&this.resize(e,t)};let o;const s=()=>{t("attach",s),this.attached=!0,this.resize(),e("resize",i),e("detach",o)};o=()=>{this.attached=!1,t("resize",i),this._stop(),this._resize(0,0),e("attach",s)},(n.isAttached(this.canvas)?s:o)()}unbindEvents(){S(this._listeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._listeners={},S(this._responsiveListeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,t,r){var n=r?"set":"remove";let i,o,s;for("dataset"===t&&this.getDatasetMeta(e[0].datasetIndex).controller["_"+n+"DatasetHoverStyle"](),o=0,s=e.length;o<s;++o){const t=(i=e[o])&&this.getDatasetMeta(i.datasetIndex).controller;t&&t[n+"HoverStyle"](i.element,i.datasetIndex,i.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){var t=this._active||[],e=e.map(({datasetIndex:e,index:t})=>{var r=this.getDatasetMeta(e);if(r)return{datasetIndex:e,element:r.data[t],index:t};throw new Error("No dataset found at index "+e)});V(e,t)||(this._active=e,this._lastEvent=null,this._updateHoverStyles(e,t))}notifyPlugins(e,t,r){return this._plugins.notify(this,e,t,r)}isPluginEnabled(t){return 1===this._plugins._cache.filter(e=>e.plugin.id===t).length}_updateHoverStyles(e,t,r){var n=this.options.hover,i=(e,r)=>e.filter(t=>!r.some(e=>t.datasetIndex===e.datasetIndex&&t.index===e.index)),o=i(t,e),r=r?e:i(e,t);o.length&&this.updateHoverStyle(o,n.mode,!1),r.length&&n.mode&&this.updateHoverStyle(r,n.mode,!0)}_eventHandler(t,e){var r={event:t,replay:e,cancelable:!0,inChartArea:this.isPointInArea(t)},n=e=>(e.options.events||this.options.events).includes(t.native.type);if(!1!==this.notifyPlugins("beforeEvent",r,n))return e=this._handleEvent(t,e,r.inChartArea),r.cancelable=!1,this.notifyPlugins("afterEvent",r,n),(e||r.changed)&&this.render(),this}_handleEvent(e,t,r){const{_active:n=[],options:i}=this,o=t,s=this._getActiveElements(e,n,r,o),a=Z(e),l=(c=e,u=this._lastEvent,r&&"mouseout"!==c.type?a?u:c:null);r&&(this._lastEvent=null,d(i.onHover,[e,s,this],this),a)&&d(i.onClick,[e,s,this],this);var c,u=!V(s,n);return(u||t)&&(this._active=s,this._updateHoverStyles(s,n,t)),this._lastEvent=l,u}_getActiveElements(e,t,r,n){return"mouseout"===e.type?[]:r?(r=this.options.hover,this.getElementsAtEventForMode(e,r.mode,r,n)):t}}function ai(){S(r.instances,e=>e._plugins.invalidate())}function li(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}var ci={_date:class Go{static override(e){Object.assign(Go.prototype,e)}options;constructor(e){this.options=e||{}}init(){}formats(){return li()}parse(){return li()}format(){return li()}add(){return li()}diff(){return li()}startOf(){return li()}endOf(){return li()}}};function ui(r,n,i,o){if(N(r)){var s=r,a=n,l=i,c=o,u=l.parse(s[0],c),s=l.parse(s[1],c),c=Math.min(u,s),d=Math.max(u,s);let e=c,t=d;Math.abs(c)>Math.abs(d)&&(e=d,t=c),a[l.axis]=t,a._custom={barStart:e,barEnd:t,start:u,end:s,min:c,max:d}}else n[i.axis]=i.parse(r,o);return n}function di(e,t,r,n){var i=e.iScale,o=e.vScale,s=i.getLabels(),a=i===o,l=[];let c,u,d,h;for(u=(c=r)+n;c<u;++c)h=t[c],(d={})[i.axis]=a||i.parse(s[c],c),l.push(ui(h,d,o,c));return l}function hi(e){return e&&void 0!==e.barStart&&void 0!==e.barEnd}function pi(e,t,r,n){return e=n?fi(e=e===t?r:e===r?t:e,r,t):fi(e,t,r)}function fi(e,t,r){return"start"===e?t:"end"===e?r:e}class gi extends Nn{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:e=>"spacing"!==e,_indexable:e=>"spacing"!==e&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(n){var e=n.data;if(e.labels.length&&e.datasets.length){const{pointStyle:i,color:o}=n.legend.options["labels"];return e.labels.map((e,t)=>{var r=n.getDatasetMeta(0).controller.getStyle(t);return{text:e,fillStyle:r.backgroundColor,strokeStyle:r.borderColor,fontColor:o,lineWidth:r.borderWidth,pointStyle:i,hidden:!n.getDataVisibility(t),index:t}})}return[]}},onClick(e,t,r){r.chart.toggleDataVisibility(t.index),r.chart.update()}}}};constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(n,i){const o=this.getDataset().data,s=this._cachedMeta;if(!1===this._parsing)s._parsed=o;else{let e,t,r=e=>+o[e];if(O(o[n])){const{key:n="value"}=this._parsing;r=e=>+f(o[e],n)}for(t=(e=n)+i;e<t;++e)s._parsed[e]=r(e)}}_getRotation(){return M(this.options.rotation-90)}_getCircumference(){return M(this.options.circumference)}_getRotationExtents(){let t=b,r=-b;for(let e=0;e<this.chart.data.datasets.length;++e){var n,i;this.chart.isDatasetVisible(e)&&this.chart.getDatasetMeta(e).type===this._type&&(n=(i=this.chart.getDatasetMeta(e).controller)._getRotation(),i=i._getCircumference(),t=Math.min(t,n),r=Math.max(r,n+i))}return{rotation:t,circumference:r-t}}update(e){var t=this.chart["chartArea"],r=this._cachedMeta,n=r.data,i=this.getMaxBorderWidth()+this.getMaxOffset(n)+this.options.spacing,o=Math.max((Math.min(t.width,t.height)-i)/2,0),o=Math.min(H(this.options.cutout,o),1),s=this._getRingWeight(this.index),{circumference:a,rotation:l}=this._getRotationExtents(),{ratioX:l,ratioY:a,offsetX:c,offsetY:u}=function(e,t,n){let r=1,i=1,o=0,s=0;if(t<b){const a=e,l=a+t,c=Math.cos(a),u=Math.sin(a),d=Math.cos(l),h=Math.sin(l),p=(e,t,r)=>ge(e,a,l,!0)?1:Math.max(t,t*n,r,r*n),f=(e,t,r)=>ge(e,a,l,!0)?-1:Math.min(t,t*n,r,r*n),g=p(0,c,d),m=p(R,u,h),y=f(_,c,d),v=f(_+R,u,h);r=(g-y)/2,i=(m-v)/2,o=-(g+y)/2,s=-(m+v)/2}return{ratioX:r,ratioY:i,offsetX:o,offsetY:s}}(l,a,o),l=(t.width-i)/l,t=(t.height-i)/a,i=Math.max(Math.min(l,t)/2,0),a=U(this.options.radius,i),l=(a-Math.max(a*o,0))/this._getVisibleDatasetWeightTotal();this.offsetX=c*a,this.offsetY=u*a,r.total=this.calculateTotal(),this.outerRadius=a-l*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-l*s,0),this.updateElements(n,0,n.length,e)}_circumference(e,t){var r=this.options,n=this._cachedMeta,i=this._getCircumference();return t&&r.animation.animateRotate||!this.chart.getDataVisibility(e)||null===n._parsed[e]||n.data[e].hidden?0:this.calculateCircumference(n._parsed[e]*i/b)}updateElements(e,t,r,n){const i="reset"===n,o=this.chart,s=o.chartArea,a=o.options.animation,l=(s.left+s.right)/2,c=(s.top+s.bottom)/2,u=i&&a.animateScale,d=u?0:this.innerRadius,h=u?0:this.outerRadius,{sharedOptions:p,includeOptions:f}=this._getSharedOptions(t,n);let g,m=this._getRotation();for(g=0;g<t;++g)m+=this._circumference(g,i);for(g=t;g<t+r;++g){const t=this._circumference(g,i),r=e[g],o={x:l+this.offsetX,y:c+this.offsetY,startAngle:m,endAngle:m+t,circumference:t,outerRadius:h,innerRadius:d};f&&(o.options=p||this.resolveDataElementOptions(g,r.active?"active":n)),m+=t,this.updateElement(r,g,o,n)}}calculateTotal(){var e=this._cachedMeta,t=e.data;let r,n=0;for(r=0;r<t.length;r++){var i=e._parsed[r];null===i||isNaN(i)||!this.chart.getDataVisibility(r)||t[r].hidden||(n+=Math.abs(i))}return n}calculateCircumference(e){var t=this._cachedMeta.total;return 0<t&&!isNaN(e)?b*(Math.abs(e)/t):0}getLabelAndValue(e){var t=this._cachedMeta,r=this.chart,n=r.data.labels||[],t=ut(t._parsed[e],r.options.locale);return{label:n[e]||"",value:t}}getMaxBorderWidth(e){let t=0;var r=this.chart;let n,i,o,s,a;if(!e)for(n=0,i=r.data.datasets.length;n<i;++n)if(r.isDatasetVisible(n)){e=(o=r.getDatasetMeta(n)).data,s=o.controller;break}if(!e)return 0;for(n=0,i=e.length;n<i;++n)"inner"!==(a=s.resolveDataElementOptions(n)).borderAlign&&(t=Math.max(t,a.borderWidth||0,a.hoverBorderWidth||0));return t}getMaxOffset(r){let n=0;for(let e=0,t=r.length;e<t;++e){const r=this.resolveDataElementOptions(e);n=Math.max(n,r.offset||0,r.hoverOffset||0)}return n}_getRingWeightOffset(t){let r=0;for(let e=0;e<t;++e)this.chart.isDatasetVisible(e)&&(r+=this._getRingWeight(e));return r}_getRingWeight(e){return Math.max(I(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class mi extends Nn{static id="polarArea";static defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(n){var e=n.data;if(e.labels.length&&e.datasets.length){const{pointStyle:i,color:o}=n.legend.options["labels"];return e.labels.map((e,t)=>{var r=n.getDatasetMeta(0).controller.getStyle(t);return{text:e,fillStyle:r.backgroundColor,strokeStyle:r.borderColor,fontColor:o,lineWidth:r.borderWidth,pointStyle:i,hidden:!n.getDataVisibility(t),index:t}})}return[]}},onClick(e,t,r){r.chart.toggleDataVisibility(t.index),r.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};constructor(e,t){super(e,t),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(e){var t=this._cachedMeta,r=this.chart,n=r.data.labels||[],t=ut(t._parsed[e].r,r.options.locale);return{label:n[e]||"",value:t}}parseObjectData(e,t,r,n){return tr.bind(this)(e,t,r,n)}update(e){var t=this._cachedMeta.data;this._updateRadius(),this.updateElements(t,0,t.length,e)}getMinMax(){const e=this._cachedMeta,n={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return e.data.forEach((e,t)=>{var r=this.getParsed(t).r;!isNaN(r)&&this.chart.getDataVisibility(t)&&(r<n.min&&(n.min=r),r>n.max)&&(n.max=r)}),n}_updateRadius(){var e=this.chart,t=e.chartArea,r=e.options,t=Math.min(t.right-t.left,t.bottom-t.top),t=Math.max(t/2,0),r=(t-Math.max(r.cutoutPercentage?t/100*r.cutoutPercentage:1,0))/e.getVisibleDatasetCount();this.outerRadius=t-r*this.index,this.innerRadius=this.outerRadius-r}updateElements(n,i,e,o){var s="reset"===o,a=this.chart,l=a.options.animation,c=this._cachedMeta.rScale,u=c.xCenter,d=c.yCenter,h=c.getIndexAngle(0)-.5*_;let p,f=h;var g=360/this.countVisibleElements();for(p=0;p<i;++p)f+=this._computeAngle(p,o,g);for(p=i;p<i+e;p++){const i=n[p];let e=f,t=f+this._computeAngle(p,o,g),r=a.getDataVisibility(p)?c.getDistanceFromCenterForValue(this.getParsed(p).r):0;f=t,s&&(l.animateScale&&(r=0),l.animateRotate)&&(e=t=h);var m={x:u,y:d,innerRadius:0,outerRadius:r,startAngle:e,endAngle:t,options:this.resolveDataElementOptions(p,i.active?"active":o)};this.updateElement(i,p,m,o)}}countVisibleElements(){var e=this._cachedMeta;let r=0;return e.data.forEach((e,t)=>{!isNaN(this.getParsed(t).r)&&this.chart.getDataVisibility(t)&&r++}),r}_computeAngle(e,t,r){return this.chart.getDataVisibility(e)?M(this.resolveDataElementOptions(e,t).angle||r):0}}var yi=Object.freeze({__proto__:null,BarController:class extends Nn{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(e,t,r,n){return di(e,t,r,n)}parseArrayData(e,t,r,n){return di(e,t,r,n)}parseObjectData(e,t,r,n){var{iScale:i,vScale:o}=e,{xAxisKey:e="x",yAxisKey:s="y"}=this._parsing,a="x"===i.axis?e:s,l="x"===o.axis?e:s,c=[];let u,d,h,p;for(d=(u=r)+n;u<d;++u)p=t[u],(h={})[i.axis]=i.parse(f(p,a),u),c.push(ui(f(p,l),h,o,u));return c}updateRangeFromParsed(e,t,r,n){super.updateRangeFromParsed(e,t,r,n);n=r._custom;n&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,n.min),e.max=Math.max(e.max,n.max))}getMaxOverflow(){return 0}getLabelAndValue(e){var{iScale:t,vScale:r}=this._cachedMeta,e=this.getParsed(e),n=e._custom,n=hi(n)?"["+n.start+", "+n.end+"]":""+r.getLabelForValue(e[r.axis]);return{label:""+t.getLabelForValue(e[t.axis]),value:n}}initialize(){this.enableOptionSharing=!0,super.initialize(),this._cachedMeta.stack=this.getDataset().stack}update(e){var t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(t,r,n,i){var o="reset"===i,{index:s,_cachedMeta:{vScale:a}}=this,l=a.getBasePixel(),c=a.isHorizontal(),u=this._getRuler(),{sharedOptions:d,includeOptions:h}=this._getSharedOptions(r,i);for(let e=r;e<r+n;e++){const r=this.getParsed(e),n=o||x(r[a.axis])?{base:l,head:l}:this._calculateBarValuePixels(e),T=this._calculateBarIndexPixels(e,u),S=(r._stacks||{})[a.axis],_={horizontal:c,base:n.base,enableBorderRadius:!S||hi(r._custom)||s===S._top||s===S._bottom,x:c?n.head:T.center,y:c?T.center:n.head,height:c?T.size:Math.abs(n.size),width:c?Math.abs(n.size):T.size};h&&(_.options=d||this.resolveDataElementOptions(e,t[e].active?"active":i));var p=_.options||t[e].options;{f=void 0;g=void 0;m=void 0;y=void 0;v=void 0;b=void 0;w=void 0;C=void 0;E=void 0;var f=_;var g=p;var m=S;var y=s;let e=g.borderSkipped;var v,b,w,C,E,g={};e?!0===e?f.borderSkipped={top:!0,right:!0,bottom:!0,left:!0}:({start:v,end:b,reverse:w,top:C,bottom:E}=function(){let e,t,r,n,i;return r=f.horizontal?(e=f.base>f.x,t="left","right"):(e=f.base<f.y,t="bottom","top"),i=e?(n="end","start"):(n="start","end"),{start:t,end:r,reverse:e,top:n,bottom:i}}(),"middle"===e&&m&&(f.enableBorderRadius=!0,e=(m._top||0)===y?C:(m._bottom||0)===y?E:(g[pi(E,v,b,w)]=!0,C)),g[pi(e,v,b,w)]=!0,f.borderSkipped=g):f.borderSkipped=g}[m,y,E]=[_,p["inflateAmount"],u.ratio],m.inflateAmount="auto"===y?1===E?.33:0:y,this.updateElement(t[e],e,_,i)}}_getStacks(e,r){const t=this._cachedMeta["iScale"],n=t.getMatchingVisibleMetas(this._type).filter(e=>e.controller.options.grouped),i=t.options.stacked,o=[];for(const t of n)if((void 0===r||!(e=>{var t=e.controller.getParsed(r),t=t&&t[e.vScale.axis];if(x(t)||isNaN(t))return!0})(t))&&((!1===i||-1===o.indexOf(t.stack)||void 0===i&&void 0===t.stack)&&o.push(t.stack),t.index===e))break;return o.length||o.push(void 0),o}_getStackCount(e){return this._getStacks(void 0,e).length}_getStackIndex(e,t,r){e=this._getStacks(e,r),r=void 0!==t?e.indexOf(t):-1;return-1===r?e.length-1:r}_getRuler(){var e=this.options,t=this._cachedMeta,r=t.iScale,n=[];let i,o;for(i=0,o=t.data.length;i<o;++i)n.push(r.getPixelForValue(this.getParsed(i)[r.axis],i));var s=e.barThickness;return{min:s||function(e){var t=e.iScale,r=function(n,e){if(!n._cache.$bar){var i=n.getMatchingVisibleMetas(e);let r=[];for(let e=0,t=i.length;e<t;e++)r=r.concat(i[e].controller.getAllParsedValues(n));n._cache.$bar=Te(r.sort((e,t)=>e-t))}return n._cache.$bar}(t,e.type);let n,i,o,s,a=t._length;var l=()=>{32767!==o&&-32768!==o&&(X(s)&&(a=Math.min(a,Math.abs(o-s)||a)),s=o)};for(n=0,i=r.length;n<i;++n)o=t.getPixelForValue(r[n]),l();for(s=void 0,n=0,i=t.ticks.length;n<i;++n)o=t.getPixelForTick(n),l();return a}(t),pixels:n,start:r._startPixel,end:r._endPixel,stackCount:this._getStackCount(),scale:r,grouped:e.grouped,ratio:s?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:t,_stacked:r,index:n},options:{base:i,minBarLength:o}}=this,s=i||0,a=this.getParsed(e),l=a._custom,c=hi(l);let u,d,h=a[t.axis],p=0,f=r?this.applyStack(t,a,r):h;f!==h&&(p=f-h,f=h),c&&(h=l.barStart,f=l.barEnd-l.barStart,0!==h&&w(h)!==w(l.barEnd)&&(p=0),p+=h);var g,m,y=x(i)||c?p:i;let v=t.getPixelForValue(y);if(u=this.chart.getDataVisibility(e)?t.getPixelForValue(p+f):v,d=u-v,Math.abs(d)<o){d=(y=d,g=t,m=s,(0!==y?w(y):(g.isHorizontal()?1:-1)*(g.min>=m?1:-1))*o),h===s&&(v-=d/2);const e=t.getPixelForDecimal(0),x=t.getPixelForDecimal(1),i=Math.min(e,x),l=Math.max(e,x);v=Math.max(Math.min(v,l),i),u=v+d,r&&!c&&(a._stacks[t.axis]._visualValues[n]=t.getValueForPixel(u)-t.getValueForPixel(v))}if(v===t.getPixelForValue(s)){const e=w(d)*t.getLineWidthForValue(s)/2;v+=e,d-=e}return{size:d,base:v,head:u,center:u+d/2}}_calculateBarIndexPixels(e,t){const r=t.scale,n=this.options,i=n.skipNull,o=I(n.maxBarThickness,1/0);let s,a;if(t.grouped){const r=i?this._getStackCount(e):t.stackCount,I=("flex"===n.barThickness?function(e,t,r,n){var i=t.pixels,o=i[e];let s=0<e?i[e-1]:null,a=e<i.length-1?i[e+1]:null;i=r.categoryPercentage,null===s&&(s=o-(null===a?t.end-t.start:a-o)),null===a&&(a=o+o-s),e=o-(o-Math.min(s,a))/2*i;return{chunk:Math.abs(a-s)/2*i/n,ratio:r.barPercentage,start:e}}:function(e,t,r,n){var i=r.barThickness;let o,s;return s=x(i)?(o=t.min*r.categoryPercentage,r.barPercentage):(o=i*n,1),{chunk:o/n,ratio:s,start:t.pixels[e]-o/2}})(e,t,n,r),l=this._getStackIndex(this.index,this._cachedMeta.stack,i?e:void 0);s=I.start+I.chunk*l+I.chunk/2,a=Math.min(o,I.chunk*I.ratio)}else s=r.getPixelForValue(this.getParsed(e)[r.axis],e),a=Math.min(o,t.min*t.ratio);return{base:s-a/2,head:s+a/2,center:s,size:a}}draw(){var e=this._cachedMeta,t=e.vScale,r=e.data,n=r.length;let i=0;for(;i<n;++i)null!==this.getParsed(i)[t.axis]&&r[i].draw(this._ctx)}},BubbleController:class extends Nn{static id="bubble";static defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}};static overrides={scales:{x:{type:"linear"},y:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(e,t,r,n){var i=super.parsePrimitiveData(e,t,r,n);for(let e=0;e<i.length;e++)i[e]._custom=this.resolveDataElementOptions(e+r).radius;return i}parseArrayData(e,t,r,n){var i=super.parseArrayData(e,t,r,n);for(let e=0;e<i.length;e++){const n=t[r+e];i[e]._custom=I(n[2],this.resolveDataElementOptions(e+r).radius)}return i}parseObjectData(e,t,r,n){var i=super.parseObjectData(e,t,r,n);for(let e=0;e<i.length;e++){const n=t[r+e];i[e]._custom=I(n&&n.r&&+n.r,this.resolveDataElementOptions(e+r).radius)}return i}getMaxOverflow(){var t=this._cachedMeta.data;let r=0;for(let e=t.length-1;0<=e;--e)r=Math.max(r,t[e].size(this.resolveDataElementOptions(e))/2);return 0<r&&r}getLabelAndValue(e){var t=this._cachedMeta,r=this.chart.data.labels||[],{xScale:t,yScale:n}=t,i=this.getParsed(e),t=t.getLabelForValue(i.x),n=n.getLabelForValue(i.y),i=i._custom;return{label:r[e]||"",value:"("+t+", "+n+(i?", "+i:"")+")"}}update(e){var t=this._cachedMeta.data;this.updateElements(t,0,t.length,e)}updateElements(t,r,n,i){var o="reset"===i,{iScale:s,vScale:a}=this._cachedMeta,{sharedOptions:l,includeOptions:c}=this._getSharedOptions(r,i),u=s.axis,d=a.axis;for(let e=r;e<r+n;e++){const r=t[e],n=!o&&this.getParsed(e),h={},p=h[u]=o?s.getPixelForDecimal(.5):s.getPixelForValue(n[u]),f=h[d]=o?a.getBasePixel():a.getPixelForValue(n[d]);h.skip=isNaN(p)||isNaN(f),c&&(h.options=l||this.resolveDataElementOptions(e,r.active?"active":i),o)&&(h.options.radius=0),this.updateElement(r,e,h,i)}}resolveDataElementOptions(e,t){var r=this.getParsed(e);let n=super.resolveDataElementOptions(e,t);e=(n=n.$shared?Object.assign({},n,{$shared:!1}):n).radius;return"active"!==t&&(n.radius=0),n.radius+=I(r&&r._custom,e),n}},DoughnutController:gi,LineController:class extends Nn{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){var t=this._cachedMeta,{dataset:r,data:n=[],_dataset:i}=t,o=this.chart._animationsDisabled;let{start:s,count:a}=Ne(t,n,o);this._drawStart=s,this._drawCount=a,Oe(t)&&(s=0,a=n.length),r._chart=this.chart,r._datasetIndex=this.index,r._decimated=!!i._decimated,r.points=n;t=this.resolveDatasetElementOptions(e);this.options.showLine||(t.borderWidth=0),t.segment=this.options.segment,this.updateElement(r,void 0,{animated:!o,options:t},e),this.updateElements(n,s,a,e)}updateElements(t,r,e,n){const i="reset"===n,{iScale:o,vScale:s,_stacked:a,_dataset:l}=this._cachedMeta,{sharedOptions:c,includeOptions:u}=this._getSharedOptions(r,n),d=o.axis,h=s.axis,{spanGaps:p,segment:f}=this.options,g=ae(p)?p:Number.POSITIVE_INFINITY,m=this.chart._animationsDisabled||i||"none"===n,y=r+e,v=t.length;let b=0<r&&this.getParsed(r-1);for(let e=0;e<v;++e){const p=t[e],v=m?p:{};var w,C,E,T;e<r||e>=y?v.skip=!0:(C=x((w=this.getParsed(e))[h]),E=v[d]=o.getPixelForValue(w[d],e),T=v[h]=i||C?s.getBasePixel():s.getPixelForValue(a?this.applyStack(s,w,a):w[h],e),v.skip=isNaN(E)||isNaN(T)||C,v.stop=0<e&&Math.abs(w[d]-b[d])>g,f&&(v.parsed=w,v.raw=l.data[e]),u&&(v.options=c||this.resolveDataElementOptions(e,p.active?"active":n)),m||this.updateElement(p,e,v,n),b=w)}}getMaxOverflow(){var e,t=this._cachedMeta,r=t.dataset,r=r.options&&r.options.borderWidth||0,t=t.data||[];return t.length?(e=t[0].size(this.resolveDataElementOptions(0)),t=t[t.length-1].size(this.resolveDataElementOptions(t.length-1)),Math.max(r,e,t)/2):r}draw(){var e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}},PieController:class extends gi{static id="pie";static defaults={cutout:0,rotation:0,circumference:360,radius:"100%"}},PolarAreaController:mi,RadarController:class extends Nn{static id="radar";static defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}};static overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};getLabelAndValue(e){var t=this._cachedMeta.vScale,r=this.getParsed(e);return{label:t.getLabels()[e],value:""+t.getLabelForValue(r[t.axis])}}parseObjectData(e,t,r,n){return tr.bind(this)(e,t,r,n)}update(e){const t=this._cachedMeta,r=t.dataset,n=t.data||[],i=t.iScale.getLabels();if(r.points=n,"resize"!==e){const t=this.resolveDatasetElementOptions(e);this.options.showLine||(t.borderWidth=0);var o={_loop:!0,_fullLoop:i.length===n.length,options:t};this.updateElement(r,void 0,o,e)}this.updateElements(n,0,n.length,e)}updateElements(t,r,n,i){var o=this._cachedMeta.rScale,s="reset"===i;for(let e=r;e<r+n;e++){const r=t[e],n=this.resolveDataElementOptions(e,r.active?"active":i),a=o.getPointPositionForValue(e,this.getParsed(e).r),l=s?o.xCenter:a.x,c=s?o.yCenter:a.y,u={x:l,y:c,angle:a.angle,skip:isNaN(l)||isNaN(c),options:n};this.updateElement(r,e,u,i)}}},ScatterController:class extends Nn{static id="scatter";static defaults={datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1};static overrides={interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}};getLabelAndValue(e){var t=this._cachedMeta,r=this.chart.data.labels||[],{xScale:t,yScale:n}=t,i=this.getParsed(e),t=t.getLabelForValue(i.x),n=n.getLabelForValue(i.y);return{label:r[e]||"",value:"("+t+", "+n+")"}}update(e){var t=this._cachedMeta,{data:r=[]}=t,n=this.chart._animationsDisabled;let{start:i,count:o}=Ne(t,r,n);if(this._drawStart=i,this._drawCount=o,Oe(t)&&(i=0,o=r.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:i,_dataset:o}=t;i._chart=this.chart,i._datasetIndex=this.index,i._decimated=!!o._decimated,i.points=r;var s=this.resolveDatasetElementOptions(e);s.segment=this.options.segment,this.updateElement(i,void 0,{animated:!n,options:s},e)}else this.datasetElementType&&(delete t.dataset,this.datasetElementType=!1);this.updateElements(r,i,o,e)}addElements(){var e=this.options["showLine"];!this.datasetElementType&&e&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(t,r,n,i){const o="reset"===i,{iScale:s,vScale:a,_stacked:l,_dataset:c}=this._cachedMeta,e=this.resolveDataElementOptions(r,i),u=this.getSharedOptions(e),d=this.includeOptions(i,u),h=s.axis,p=a.axis,{spanGaps:f,segment:g}=this.options,m=ae(f)?f:Number.POSITIVE_INFINITY,y=this.chart._animationsDisabled||o||"none"===i;let v=0<r&&this.getParsed(r-1);for(let e=r;e<r+n;++e){const r=t[e],n=this.getParsed(e),f=y?r:{},b=x(n[p]),w=f[h]=s.getPixelForValue(n[h],e),C=f[p]=o||b?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,n,l):n[p],e);f.skip=isNaN(w)||isNaN(C)||b,f.stop=0<e&&Math.abs(n[h]-v[h])>m,g&&(f.parsed=n,f.raw=c.data[e]),d&&(f.options=u||this.resolveDataElementOptions(e,r.active?"active":i)),y||this.updateElement(r,e,f,i),v=n}this.updateSharedOptions(u,i,e)}getMaxOverflow(){var e,t,r=this._cachedMeta,n=r.data||[];if(this.options.showLine)return r=(r=r.dataset).options&&r.options.borderWidth||0,n.length?(e=n[0].size(this.resolveDataElementOptions(0)),t=n[n.length-1].size(this.resolveDataElementOptions(n.length-1)),Math.max(r,e,t)/2):r;{let t=0;for(let e=n.length-1;0<=e;--e)t=Math.max(t,n[e].size(this.resolveDataElementOptions(e))/2);return 0<t&&t}}}});function vi(e,t,r,n){return{x:r+e*Math.cos(t),y:n+e*Math.sin(t)}}function bi(e,t,r,n,i,o){var{x:s,y:a,startAngle:l,pixelMargin:c,innerRadius:u}=t,d=Math.max(t.outerRadius+n+r-c,0),c=0<u?u+n+r+c:0;let h=0;var p=i-l;if(n){const e=((0<u?u-n:0)+(0<d?d-n:0))/2;h=(p-(0!=e?p*e/(e+n):p))/2}var u=(p-Math.max(.001,p*d-r/_)/d)/2,p=l+u+h,l=i-u-h,{outerStart:u,outerEnd:f,innerStart:g,innerEnd:m}=function(e,t,r,n){e=wr(e.options.borderRadius,["outerStart","outerEnd","innerStart","innerEnd"]);const i=(r-t)/2,o=Math.min(i,n*t/2),s=e=>{var t=(r-Math.min(i,e))*n/2;return A(e,0,Math.min(i,t))};return{outerStart:s(e.outerStart),outerEnd:s(e.outerEnd),innerStart:A(e.innerStart,0,o),innerEnd:A(e.innerEnd,0,o)}}(t,c,d,l-p),y=d-u,v=d-f,b=p+u/y,w=l-f/v,C=c+g,E=c+m,T=p+g/C,S=l-m/E;if(e.beginPath(),o){const t=(b+w)/2;if(e.arc(s,a,d,b,t),e.arc(s,a,d,t,w),0<f){const t=vi(v,w,s,a);e.arc(t.x,t.y,f,w,l+R)}const r=vi(E,l,s,a);if(e.lineTo(r.x,r.y),0<m){const t=vi(E,S,s,a);e.arc(t.x,t.y,m,l+R,S+Math.PI)}const n=(l-m/c+(p+g/c))/2;if(e.arc(s,a,c,l-m/c,n,!0),e.arc(s,a,c,n,p+g/c,!0),0<g){const t=vi(C,T,s,a);e.arc(t.x,t.y,g,T+Math.PI,p-R)}const i=vi(y,p,s,a);if(e.lineTo(i.x,i.y),0<u){const t=vi(y,b,s,a);e.arc(t.x,t.y,u,p-R,b)}}else{e.moveTo(s,a);const t=Math.cos(b)*d+s,r=Math.sin(b)*d+a,n=(e.lineTo(t,r),Math.cos(w)*d+s),i=Math.sin(w)*d+a;e.lineTo(n,i)}e.closePath()}function wi(e,t,r=t){e.lineCap=I(r.borderCapStyle,t.borderCapStyle),e.setLineDash(I(r.borderDash,t.borderDash)),e.lineDashOffset=I(r.borderDashOffset,t.borderDashOffset),e.lineJoin=I(r.borderJoinStyle,t.borderJoinStyle),e.lineWidth=I(r.borderWidth,t.borderWidth),e.strokeStyle=I(r.borderColor,t.borderColor)}function Ci(e,t,r){e.lineTo(r.x,r.y)}function Ei(e,t,r={}){var e=e.length,{start:r=0,end:n=e-1}=r,{start:i,end:o}=t,s=Math.max(r,i),a=Math.min(n,o);return{count:e,start:s,loop:t.loop,ilen:a<s&&!(r<i&&n<i||o<r&&o<n)?e+a-s:a-s}}function Ti(e,t,r,n){const{points:i,options:o}=t,{count:s,start:a,loop:l,ilen:c}=Ei(i,r,n),u=o.stepped?Ut:o.tension||"monotone"===o.cubicInterpolationMode?Vt:Ci;let d,h,p,{move:f=!0,reverse:g}=n||{};for(d=0;d<=c;++d)(h=i[(a+(g?c-d:d))%s]).skip||(f?(e.moveTo(h.x,h.y),f=!1):u(e,p,h,g,o.stepped),p=h);return l&&(h=i[(a+(g?c:0))%s],u(e,p,h,g,o.stepped)),!!l}function Si(e,t,r,n){const i=t.points,{count:o,start:s,ilen:a}=Ei(i,r,n),{move:l=!0,reverse:c}=n||{};let u,d,h,p,f,g,m=0,y=0;var v=e=>(s+(c?a-e:e))%o,b=()=>{p!==f&&(e.lineTo(m,f),e.lineTo(m,p),e.lineTo(m,g))};for(l&&(d=i[v(0)],e.moveTo(d.x,d.y)),u=0;u<=a;++u)if(!(d=i[v(u)]).skip){const t=d.x,r=d.y,n=0|t;n===h?(r<p?p=r:r>f&&(f=r),m=(y*m+t)/++y):(b(),e.lineTo(t,r),h=n,y=0,p=f=r),g=r}b()}function _i(e){var t=e.options,r=t.borderDash&&t.borderDash.length;return e._decimated||e._loop||t.tension||"monotone"===t.cubicInterpolationMode||t.stepped||r?Ti:Si}const xi="function"==typeof Path2D;class Ri extends t{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:e=>"borderDash"!==e&&"fill"!==e};constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,t){var r,n=this.options;!n.tension&&"monotone"!==n.cubicInterpolationMode||n.stepped||this._pointsUpdated||(r=n.spanGaps?this._loop:this._fullLoop,lr(this._points,n,e,r,t),this._pointsUpdated=!0)}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=kr(this,this.options.segment))}first(){var e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){var e=this.segments,t=this.points,r=e.length;return r&&t[e[r-1].end]}interpolate(r,n){var i=this.options,o=r[n],s=this.points,a=Mr(this,{property:n,start:o,end:o});if(a.length){var l,c=[],u=i.stepped?fr:i.tension||"monotone"===i.cubicInterpolationMode?gr:pr;let t,e;for(t=0,e=a.length;t<e;++t){const{start:e,end:d}=a[t],h=s[e],p=s[d];h===p?c.push(h):((l=u(h,p,Math.abs((o-h[n])/(p[n]-h[n])),i.stepped))[n]=r[n],c.push(l))}return 1===c.length?c[0]:c}}pathSegment(e,t,r){return _i(this)(e,this,t,r)}path(e,t,r){var n=this.segments,i=_i(this);let o=this._loop;t=t||0,r=r||this.points.length-t;for(const s of n)o&=i(e,this,s,{start:t,end:t+r-1});return!!o}draw(e,t,r,n){var i,o=this.options||{};(this.points||[]).length&&o.borderWidth&&(e.save(),o=e,i=this,r=r,n=n,(xi&&!i.options.segment?function(e,t,r,n){let i=t._path;i||(i=t._path=new Path2D,t.path(i,r,n)&&i.closePath()),wi(e,t.options),e.stroke(i)}:function(e,t,r,n){var{segments:i,options:o}=t,s=_i(t);for(const a of i)wi(e,o,a.style),e.beginPath(),s(e,t,a,{start:r,end:r+n-1})&&e.closePath(),e.stroke()})(o,i,r,n),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function Ai(e,t,r,n){var i=e.options,{[r]:e}=e.getProps([r],n);return Math.abs(t-e)<i.radius+i.hitRadius}function Ni(e,t){var{x:t,y:r,base:n,width:i,height:o}=e.getProps(["x","y","base","width","height"],t);let s,a,l,c,u;return c=e.horizontal?(u=o/2,s=Math.min(t,n),a=Math.max(t,n),l=r-u,r+u):(u=i/2,s=t-u,a=t+u,l=Math.min(r,n),Math.max(r,n)),{left:s,top:l,right:a,bottom:c}}function Oi(e,t,r,n){return e?0:A(t,r,n)}function Ii(e,t,r,n){var i=null===t,o=null===r,e=e&&!(i&&o)&&Ni(e,n);return e&&(i||u(t,e.left,e.right))&&(o||u(r,e.top,e.bottom))}function Mi(e,t){e.rect(t.x,t.y,t.w,t.h)}function ki(e,t,r={}){var n=e.x!==r.x?-t:0,i=e.y!==r.y?-t:0,o=(e.x+e.w!==r.x+r.w?t:0)-n,r=(e.y+e.h!==r.y+r.h?t:0)-i;return{x:e.x+n,y:e.y+i,w:e.w+o,h:e.h+r,radius:e.radius}}var Di=Object.freeze({__proto__:null,ArcElement:class extends t{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:e=>"borderDash"!==e};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(e){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,t,r){var{angle:e,distance:t}=he(this.getProps(["x","y"],r),{x:e,y:t}),{startAngle:r,endAngle:n,innerRadius:i,outerRadius:o,circumference:s}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],r),a=(this.options.spacing+this.options.borderWidth)/2,s=I(s,n-r)>=b||ge(e,r,n),e=u(t,i+a,o+a);return s&&e}getCenterPoint(e){var{x:e,y:t,startAngle:r,endAngle:n,innerRadius:i,outerRadius:o}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:s,spacing:a}=this.options,r=(r+n)/2,n=(i+o+a+s)/2;return{x:e+Math.cos(r)*n,y:t+Math.sin(r)*n}}tooltipPosition(e){return this.getCenterPoint(e)}draw(t){var{options:r,circumference:n}=this,i=(r.offset||0)/4,o=(r.spacing||0)/2,s=r.circular;if(this.pixelMargin="inner"===r.borderAlign?.33:0,this.fullCircles=n>b?Math.floor(n/b):0,!(0===n||this.innerRadius<0||this.outerRadius<0)){t.save();var a=(this.startAngle+this.endAngle)/2,a=(t.translate(Math.cos(a)*i,Math.sin(a)*i),i*(1-Math.sin(Math.min(_,n||0))));t.fillStyle=r.backgroundColor,t.strokeStyle=r.borderColor;{var l=t;i=this;n=a;r=o;var c=s;var{fullCircles:u,startAngle:d,circumference:h}=i;let e=i.endAngle;if(u){bi(l,i,n,r,e,c);for(let e=0;e<u;++e)l.fill();isNaN(h)||(e=d+(h%b||b))}bi(l,i,n,r,e,c),l.fill()}var p=t,d=this,h=a,i=o,n=s,{fullCircles:f,startAngle:r,circumference:c,options:a}=d,{borderWidth:o,borderJoinStyle:s,borderDash:g,borderDashOffset:m}=a,a="inner"===a.borderAlign;if(o){p.setLineDash(g||[]),p.lineDashOffset=m,a?(p.lineWidth=2*o,p.lineJoin=s||"round"):(p.lineWidth=o,p.lineJoin=s||"bevel");let e=d.endAngle;if(f){bi(p,d,h,i,e,n);for(let e=0;e<f;++e)p.stroke();isNaN(c)||(e=r+(c%b||b))}if(a){g=p;m=d;o=e;var{startAngle:m,pixelMargin:s,x:r,y:c,outerRadius:a,innerRadius:y}=m,v=s/a;g.beginPath(),g.arc(r,c,a,m-v,o+v),s<y?g.arc(r,c,y,o+(v=s/y),m-v,!0):g.arc(r,c,s,o+R,m-R),g.closePath(),g.clip()}f||(bi(p,d,h,i,e,n),p.stroke())}t.restore()}}},BarElement:class extends t{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){var t,r,n,i,o,s,a,{inflateAmount:l,options:{borderColor:c,backgroundColor:u}}=this,{inner:d,outer:h}=(n=Ni(t=this),i=n.right-n.left,o=n.bottom-n.top,h=i/2,s=o/2,a=(r=t).options.borderWidth,r=r.borderSkipped,a=Cr(a),s={t:Oi(r.top,a.top,0,s),r:Oi(r.right,a.right,0,h),b:Oi(r.bottom,a.bottom,0,s),l:Oi(r.left,a.left,0,h)},r=i/2,a=o/2,t=(h=t).getProps(["enableBorderRadius"]).enableBorderRadius,d=h.options.borderRadius,p=Er(d),r=Math.min(r,a),a=h.borderSkipped,t={topLeft:Oi(!(h=t||O(d))||a.top||a.left,p.topLeft,0,r),topRight:Oi(!h||a.top||a.right,p.topRight,0,r),bottomLeft:Oi(!h||a.bottom||a.left,p.bottomLeft,0,r),bottomRight:Oi(!h||a.bottom||a.right,p.bottomRight,0,r)},{outer:{x:n.left,y:n.top,w:i,h:o,radius:t},inner:{x:n.left+s.l,y:n.top+s.t,w:i-s.l-s.r,h:o-s.t-s.b,radius:{topLeft:Math.max(0,t.topLeft-Math.max(s.t,s.l)),topRight:Math.max(0,t.topRight-Math.max(s.t,s.r)),bottomLeft:Math.max(0,t.bottomLeft-Math.max(s.b,s.l)),bottomRight:Math.max(0,t.bottomRight-Math.max(s.b,s.r))}}}),p=(a=h.radius).topLeft||a.topRight||a.bottomLeft||a.bottomRight?$t:Mi;e.save(),h.w===d.w&&h.h===d.h||(e.beginPath(),p(e,ki(h,l,d)),e.clip(),p(e,ki(d,-l,h)),e.fillStyle=c,e.fill("evenodd")),e.beginPath(),p(e,ki(d,l)),e.fillStyle=u,e.fill(),e.restore()}inRange(e,t,r){return Ii(this,e,t,r)}inXRange(e,t){return Ii(this,e,null,t)}inYRange(e,t){return Ii(this,null,e,t)}getCenterPoint(e){var{x:e,y:t,base:r,horizontal:n}=this.getProps(["x","y","base","horizontal"],e);return{x:n?(e+r)/2:e,y:n?t:(t+r)/2}}getRange(e){return"x"===e?this.width/2:this.height/2}},LineElement:Ri,PointElement:class extends t{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,t,r){var n=this.options,{x:r,y:i}=this.getProps(["x","y"],r);return Math.pow(e-r,2)+Math.pow(t-i,2)<Math.pow(n.hitRadius+n.radius,2)}inXRange(e,t){return Ai(this,e,"x",t)}inYRange(e,t){return Ai(this,e,"y",t)}getCenterPoint(e){var{x:e,y:t}=this.getProps(["x","y"],e);return{x:e,y:t}}size(e){var t=(e=e||this.options||{}).radius||0;return 2*((t=Math.max(t,t&&e.hoverRadius||0))+(t&&e.borderWidth||0))}draw(e,t){var r=this.options;this.skip||r.radius<.1||!E(this,t,this.size(r)/2)||(e.strokeStyle=r.borderColor,e.lineWidth=r.borderWidth,e.fillStyle=r.backgroundColor,Pt(e,r,this.x,this.y))}getRange(){var e=this.options||{};return e.radius+e.hitRadius}}});function Pi(e){var t=this.getLabels();return 0<=e&&e<t.length?t[e]:e}function Li(e,t,{horizontal:r,minRotation:n}){n=M(n),r=(r?Math.sin(n):Math.cos(n))||.001;return Math.min(t/r,.75*t*(""+e).length)}class Fi extends Ln{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return x(e)||("number"==typeof e||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const e=this.options["beginAtZero"],{minDefined:t,maxDefined:r}=this.getUserBounds();let{min:n,max:i}=this;var o,s=e=>n=t?n:e,a=e=>i=r?i:e;if(e){const e=w(n),t=w(i);e<0&&t<0?a(0):0<e&&0<t&&s(0)}n===i&&(o=0===i?1:Math.abs(.05*i),a(i+o),e||s(n-o)),this.min=n,this.max=i}getTickLimit(){let e,{maxTicksLimit:t,stepSize:r}=this.options.ticks;return r?1e3<(e=Math.ceil(this.max/r)-Math.floor(this.min/r)+1)&&(console.warn(`scales.${this.id}.ticks.stepSize: ${r} would result generating up to ${e} ticks. Limiting to 1000.`),e=1e3):(e=this.computeTickLimit(),t=t||11),e=t?Math.min(t,e):e}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){var e=this.options,t=e.ticks,r=this.getTickLimit(),r=function(e,t){var r=[],{bounds:n,step:i,min:o,max:s,precision:a,count:l,maxTicks:c,maxDigits:u,includeBounds:d}=e,h=i||1,p=c-1,{min:t,max:f}=t,g=!x(o),m=!x(s),y=!x(l),u=(f-t)/(u+1);let v,b,w,C,E=oe((f-t)/p/h)*h;if(E<1e-14&&!g&&!m)return[{value:t},{value:f}];(C=Math.ceil(f/E)-Math.floor(t/E))>p&&(E=oe(C*E/p/h)*h),x(a)||(v=Math.pow(10,a),E=Math.ceil(E*v)/v),w="ticks"===n?(b=Math.floor(t/E)*E,Math.ceil(f/E)*E):(b=t,f),g&&m&&i&&le((s-o)/i,E/1e3)?(C=Math.round(Math.min((s-o)/E,c)),E=(s-o)/C,b=o,w=s):y?(b=g?o:b,w=m?s:w,C=l-1,E=(w-b)/C):C=ie(C=(w-b)/E,Math.round(C),E/1e3)?Math.round(C):Math.ceil(C);p=Math.max(de(E),de(b));v=Math.pow(10,x(a)?p:a),b=Math.round(b*v)/v,w=Math.round(w*v)/v;let T=0;for(g&&(d&&b!==o?(r.push({value:o}),b<o&&T++,ie(Math.round((b+T*E)*v)/v,o,Li(o,u,e))&&T++):b<o&&T++);T<C;++T){const e=Math.round((b+T*E)*v)/v;if(m&&e>s)break;r.push({value:e})}return m&&d&&w!==s?r.length&&ie(r[r.length-1].value,s,Li(s,u,e))?r[r.length-1].value=s:r.push({value:s}):m&&w!==s||r.push({value:w}),r}({maxTicks:Math.max(2,r),bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:!1!==t.includeBounds},this._range||this);return"ticks"===e.bounds&&ce(r,this,"value"),e.reverse?(r.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),r}configure(){var e=this.ticks;let t=this.min,r=this.max;super.configure(),this.options.offset&&e.length&&(e=(r-t)/Math.max(e.length-1,1)/2,t-=e,r+=e),this._startValue=t,this._endValue=r,this._valueRange=r-t}getLabelForValue(e){return ut(e,this.chart.options.locale,this.options.ticks.format)}}class Hi extends Fi{static id="linear";static defaults={ticks:{callback:ht.formatters.numeric}};determineDataLimits(){var{min:e,max:t}=this.getMinMax(!0);this.min=g(e)?e:0,this.max=g(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){var e=this.isHorizontal(),t=e?this.width:this.height,r=M(this.options.ticks.minRotation),e=(e?Math.sin(r):Math.cos(r))||.001,r=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,r.lineHeight/e))}getPixelForValue(e){return null===e?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}const Ui=e=>Math.floor(a(e)),Vi=(e,t)=>Math.pow(10,Ui(e)+t);function Wi(e){return 1==e/Math.pow(10,Ui(e))}function $i(e,t,r){r=Math.pow(10,r),e=Math.floor(e/r);return Math.ceil(t/r)-e}class Bi extends Ln{static id="logarithmic";static defaults={ticks:{callback:ht.formatters.logarithmic,major:{enabled:!0}}};constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,t){e=Fi.prototype.parse.apply(this,[e,t]);if(0!==e)return g(e)&&0<e?e:null;this._zero=!0}determineDataLimits(){var{min:e,max:t}=this.getMinMax(!0);this.min=g(e)?Math.max(0,e):null,this.max=g(t)?Math.max(0,t):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!g(this._userMin)&&(this.min=e===Vi(this.min,0)?Vi(this.min,-1):Vi(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:t,maxDefined:r}=this.getUserBounds();let n=this.min,i=this.max;var e=e=>n=t?n:e,o=e=>i=r?i:e;n===i&&(n<=0?(e(1),o(10)):(e(Vi(n,-1)),o(Vi(i,1)))),n<=0&&e(Vi(i,-1)),i<=0&&o(Vi(n,1)),this.min=n,this.max=i}buildTicks(){var e=this.options,t=function(e,{min:t,max:r}){t=h(e.min,t);var n=[],i=Ui(t);let o=function(e,t){let r=Ui(t-e);for(;10<$i(e,t,r);)r++;for(;$i(e,t,r)<10;)r--;return Math.min(r,Ui(e))}(t,r),s=o<0?Math.pow(10,Math.abs(o)):1;var a=Math.pow(10,o),l=i>o?Math.pow(10,i):0,i=Math.round((t-l)*s)/s,c=Math.floor((t-l)/a/10)*a*10;let u=Math.floor((i-c)/Math.pow(10,o)),d=h(e.min,Math.round((l+c+u*Math.pow(10,o))*s)/s);for(;d<r;)n.push({value:d,major:Wi(d),significand:u}),10<=u?u=u<15?15:20:u++,20<=u&&(o++,u=2,s=0<=o?1:s),d=Math.round((l+c+u*Math.pow(10,o))*s)/s;return t=h(e.max,d),n.push({value:t,major:Wi(t),significand:u}),n}({min:this._userMin,max:this._userMax},this);return"ticks"===e.bounds&&ce(t,this,"value"),e.reverse?(t.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),t}getLabelForValue(e){return void 0===e?"0":ut(e,this.chart.options.locale,this.options.ticks.format)}configure(){var e=this.min;super.configure(),this._startValue=a(e),this._valueRange=a(this.max)-a(e)}getPixelForValue(e){return null===(e=void 0!==e&&0!==e?e:this.min)||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(a(e)-this._startValue)/this._valueRange)}getValueForPixel(e){e=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+e*this._valueRange)}}function ji(e){var t=e.ticks;if(t.display&&e.display){const e=P(t.backdropPadding);return I(t.font&&t.font.size,D.font.size)+e.height}return 0}function zi(e,t,r,n,i){return e===n||e===i?{start:t-r/2,end:t+r/2}:e<n||i<e?{start:t-r,end:t}:{start:t,end:t+r}}function Yi(t){const r={l:t.left+t._padding.left,r:t.right-t._padding.right,t:t.top+t._padding.top,b:t.bottom-t._padding.bottom},n=Object.assign({},r),i=[],o=[],s=t._pointLabels.length,a=t.options.pointLabels,l=a.centerPointLabels?_/s:0;for(let e=0;e<s;e++){const s=a.setContext(t.getPointLabelContext(e));o[e]=s.padding;var c=t.getPointPosition(e,t.drawingArea+o[e],l),u=L(s.font),d=(d=t.ctx,u=u,h=N(h=t._pointLabels[e])?h:[h],{w:Mt(d,u.string,h),h:h.length*u.lineHeight}),h=(i[e]=d,C(t.getIndexAngle(e)+l)),u=Math.round(ue(h));{p=void 0;f=void 0;g=void 0;m=void 0;y=void 0;v=void 0;var p=n;var f=r;var g=h;var m=zi(u,c.x,d.w,0,180);var y=zi(u,c.y,d.h,90,270);var v=Math.abs(Math.sin(g)),g=Math.abs(Math.cos(g));let e=0,t=0;m.start<f.l?(e=(f.l-m.start)/v,p.l=Math.min(p.l,f.l-e)):m.end>f.r&&(e=(m.end-f.r)/v,p.r=Math.max(p.r,f.r+e)),y.start<f.t?(t=(f.t-y.start)/g,p.t=Math.min(p.t,f.t-t)):y.end>f.b&&(t=(y.end-f.b)/g,p.b=Math.max(p.b,f.b+t))}}var d,h;t.setCenterPoint(r.l-n.l,n.r-r.r,r.t-n.t,n.b-r.b),t._pointLabelItems=function(t,r,n){const i=[],o=t._pointLabels.length,e=t.options,{centerPointLabels:s,display:a}=e.pointLabels,l={extra:ji(e)/2,additionalAngle:s?_/o:0};let c;for(let e=0;e<o;e++){l.padding=n[e],l.size=r[e];const o=function(e,t,r){const n=e.drawingArea,{extra:i,additionalAngle:o,padding:s,size:a}=r,l=e.getPointPosition(t,n+i+s,o),c=Math.round(ue(C(l.angle+R))),u=function(e,t){return 90===c||270===c?e-=t/2:(270<c||c<90)&&(e-=t),e}(l.y,a.h),d=function(e){return 0===e||180===e?"center":e<180?"left":"right"}(c),h=function(e,t){return"right"===d?e-=t:"center"===d&&(e-=t/2),e}(l.x,a.w);return{visible:!0,x:l.x,y:u,textAlign:d,left:h,top:u,right:h+a.w,bottom:u+a.h}}(t,e,l);i.push(o),"auto"===a&&(o.visible=function(e,t){if(!t)return!0;var{left:e,top:r,right:n,bottom:i}=e;return!(E({x:e,y:r},t)||E({x:e,y:i},t)||E({x:n,y:r},t)||E({x:n,y:i},t))}(o,c),o.visible)&&(c=o)}return i}(t,i,o)}function Gi(t,r,e,n){var i=t["ctx"];if(e)i.arc(t.xCenter,t.yCenter,r,0,b);else{var o=t.getPointPosition(0,r);i.moveTo(o.x,o.y);for(let e=1;e<n;e++)o=t.getPointPosition(e,r),i.lineTo(o.x,o.y)}}class qi extends Fi{static id="radialLinear";static defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:ht.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback:e=>e,padding:5,centerPointLabels:!1}};static defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"};static descriptors={angleLines:{_fallback:"grid"}};constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){var e=this._padding=P(ji(this.options)/2),t=this.width=this.maxWidth-e.width,r=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+t/2+e.left),this.yCenter=Math.floor(this.top+r/2+e.top),this.drawingArea=Math.floor(Math.min(t,r)/2)}determineDataLimits(){var{min:e,max:t}=this.getMinMax(!1);this.min=g(e)&&!isNaN(e)?e:0,this.max=g(t)&&!isNaN(t)?t:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/ji(this.options))}generateTickLabels(e){Fi.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((e,t)=>{e=d(this.options.pointLabels.callback,[e,t],this);return e||0===e?e:""}).filter((e,t)=>this.chart.getDataVisibility(t))}fit(){var e=this.options;e.display&&e.pointLabels.display?Yi(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,t,r,n){this.xCenter+=Math.floor((e-t)/2),this.yCenter+=Math.floor((r-n)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,t,r,n))}getIndexAngle(e){return C(e*(b/(this._pointLabels.length||1))+M(this.options.startAngle||0))}getDistanceFromCenterForValue(e){var t;return x(e)?NaN:(t=this.drawingArea/(this.max-this.min),this.options.reverse?(this.max-e)*t:(e-this.min)*t)}getValueForDistanceFromCenter(e){return x(e)?NaN:(e=e/(this.drawingArea/(this.max-this.min)),this.options.reverse?this.max-e:this.min+e)}getPointLabelContext(e){var t=this._pointLabels||[];if(0<=e&&e<t.length)return t=t[e],_r(this.getContext(),{label:t,index:e,type:"pointLabel"})}getPointPosition(e,t,r=0){e=this.getIndexAngle(e)-R+r;return{x:Math.cos(e)*t+this.xCenter,y:Math.sin(e)*t+this.yCenter,angle:e}}getPointPositionForValue(e,t){return this.getPointPosition(e,this.getDistanceFromCenterForValue(t))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){var{left:e,top:t,right:r,bottom:n}=this._pointLabelItems[e];return{left:e,top:t,right:r,bottom:n}}drawBackground(){var e,{backgroundColor:t,grid:{circular:r}}=this.options;t&&((e=this.ctx).save(),e.beginPath(),Gi(this,this.getDistanceFromCenterForValue(this._endValue),r,this._pointLabels.length),e.closePath(),e.fillStyle=t,e.fill(),e.restore())}drawGrid(){const e=this.ctx,t=this.options,{angleLines:r,grid:l,border:c}=t,u=this._pointLabels.length;let n,d,i;if(t.pointLabels.display){var o=this,s=u,{ctx:a,options:{pointLabels:h}}=o;for(let e=s-1;0<=e;e--){const s=o._pointLabelItems[e];if(s.visible){var p,f=h.setContext(o.getPointLabelContext(e)),g=(p=C=w=b=v=y=m=g=void 0,a),m=f,y=s,{left:v,top:b,right:w,bottom:C}=y;if(!x(p=m["backdropColor"])){const y=Er(m.borderRadius),x=P(m.backdropPadding);g.fillStyle=p;m=v-x.left,p=b-x.top,w=w-v+x.width,v=C-b+x.height;Object.values(y).some(e=>0!==e)?(g.beginPath(),$t(g,{x:m,y:p,w:w,h:v,radius:y}),g.fill()):g.fillRect(m,p,w,v)}var y=L(f.font),{x:C,y:b,textAlign:g}=s;Wt(a,o._pointLabels[e],C,b+y.lineHeight/2,y,{color:f.color,textAlign:g,textBaseline:"middle"})}}}if(l.display&&this.ticks.forEach((e,t)=>{var r,n,i,o,s,a;0!==t&&(d=this.getDistanceFromCenterForValue(e.value),e=this.getContext(t),t=l.setContext(e),e=c.setContext(e),r=this,t=t,n=d,i=u,e=e,o=r.ctx,s=t.circular,{color:t,lineWidth:a}=t,!s&&!i||!t||!a||n<0||(o.save(),o.strokeStyle=t,o.lineWidth=a,o.setLineDash(e.dash),o.lineDashOffset=e.dashOffset,o.beginPath(),Gi(r,n,s,i),o.closePath(),o.stroke(),o.restore()))}),r.display){for(e.save(),n=u-1;0<=n;n--){const l=r.setContext(this.getPointLabelContext(n)),{color:c,lineWidth:u}=l;u&&c&&(e.lineWidth=u,e.strokeStyle=c,e.setLineDash(l.borderDash),e.lineDashOffset=l.borderDashOffset,d=this.getDistanceFromCenterForValue(t.ticks.reverse?this.min:this.max),i=this.getPointPosition(n,d),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(i.x,i.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const s=this.ctx,a=this.options,l=a.ticks;if(l.display){var e=this.getIndexAngle(0);let i,o;s.save(),s.translate(this.xCenter,this.yCenter),s.rotate(e),s.textAlign="center",s.textBaseline="middle",this.ticks.forEach((e,t)=>{if(0!==t||a.reverse){var r=l.setContext(this.getContext(t)),n=L(r.font);if(i=this.getDistanceFromCenterForValue(this.ticks[t].value),r.showLabelBackdrop){s.font=n.string,o=s.measureText(e.label).width,s.fillStyle=r.backdropColor;const a=P(r.backdropPadding);s.fillRect(-o/2-a.left,-i-n.size/2-a.top,o+a.width,n.size+a.height)}Wt(s,e.label,0,-i,n,{color:r.color,strokeColor:r.textStrokeColor,strokeWidth:r.textStrokeWidth})}}),s.restore()}}drawTitle(){}}const Ki={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},c=Object.keys(Ki);function Xi(e,t){return e-t}function Ji(e,t){if(x(t))return null;var r=e._adapter,{parser:e,round:n,isoWeekday:i}=e._parseOpts;let o=t;return null===(o=g(o="function"==typeof e?e(o):o)?o:"string"==typeof e?r.parse(o,e):r.parse(o))?null:+(o=n?"week"!==n||!ae(i)&&!0!==i?r.startOf(o,n):r.startOf(o,"isoWeek",i):o)}function Zi(t,r,n,i){const o=c.length;for(let e=c.indexOf(t);e<o-1;++e){const t=Ki[c[e]],o=t.steps||Number.MAX_SAFE_INTEGER;if(t.common&&Math.ceil((n-r)/(o*t.size))<=i)return c[e]}return c[o-1]}function Qi(e,t,r){var n,i;r?r.length&&({lo:n,hi:i}=ye(r,t),e[r[n]>=t?r[n]:r[i]]=!0):e[t]=!0}function eo(r,e,n){var i=[],o={},t=e.length;let s,a;for(s=0;s<t;++s)o[a=e[s]]=s,i.push({value:a,major:!1});if(0!==t&&n){var l=i,c=o,u=n,d=r._adapter,n=+d.startOf(l[0].value,u),h=l[l.length-1].value;let e,t;for(e=n;e<=h;e=+d.add(e,1,u))0<=(t=c[e])&&(l[t].major=!0);return l}return i}class to extends Ln{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,t={}){var r=e.time||(e.time={}),n=this._adapter=new ci._date(e.adapters.date);n.init(t),z(r.displayFormats,n.formats()),this._parseOpts={parser:r.parser,round:r.round,isoWeekday:r.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return void 0===e?null:Ji(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){var e=this.options,t=this._adapter,r=e.time.unit||"day";let{min:n,max:i,minDefined:o,maxDefined:s}=this.getUserBounds();function a(e){o||isNaN(e.min)||(n=Math.min(n,e.min)),s||isNaN(e.max)||(i=Math.max(i,e.max))}o&&s||(a(this._getLabelBounds()),"ticks"===e.bounds&&"labels"===e.ticks.source)||a(this.getMinMax(!1)),n=g(n)&&!isNaN(n)?n:+t.startOf(Date.now(),r),i=g(i)&&!isNaN(i)?i:+t.endOf(Date.now(),r)+1,this.min=Math.min(n,i-1),this.max=Math.max(n+1,i)}_getLabelBounds(){var e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],r=e[e.length-1]),{min:t,max:r}}buildTicks(){var e=this.options,t=e.time,r=e.ticks,n="labels"===r.source?this.getLabelTimestamps():this._generate(),i=("ticks"===e.bounds&&n.length&&(this.min=this._userMin||n[0],this.max=this._userMax||n[n.length-1]),this.min),o=be(n,i,this.max);return this._unit=t.unit||(r.autoSkip?Zi(t.minUnit,this.min,this.max,this._getLabelCapacity(i)):function(t,r,n,i,o){for(let e=c.length-1;e>=c.indexOf(n);e--){const n=c[e];if(Ki[n].common&&t._adapter.diff(o,i,n)>=r-1)return n}return c[n?c.indexOf(n):0]}(this,o.length,t.minUnit,this.min,this.max)),this._majorUnit=r.major.enabled&&"year"!==this._unit?function(r){for(let e=c.indexOf(r)+1,t=c.length;e<t;++e)if(Ki[c[e]].common)return c[e]}(this._unit):void 0,this.initOffsets(n),e.reverse&&o.reverse(),eo(this,o,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let t,r,n=0,i=0;this.options.offset&&e.length&&(t=this.getDecimalForValue(e[0]),n=1===e.length?1-t:(this.getDecimalForValue(e[1])-t)/2,r=this.getDecimalForValue(e[e.length-1]),i=1===e.length?r:(r-this.getDecimalForValue(e[e.length-2]))/2);e=e.length<3?.5:.25;n=A(n,0,e),i=A(i,0,e),this._offsets={start:n,end:i,factor:1/(n+1+i)}}_generate(){var e=this._adapter,t=this.min,r=this.max,n=this.options,i=n.time,o=i.unit||Zi(i.minUnit,t,r,this._getLabelCapacity(t)),s=I(n.ticks.stepSize,1),i="week"===o&&i.isoWeekday,a=ae(i)||!0===i,l={};let c,u,d=t;if(a&&(d=+e.startOf(d,"isoWeek",i)),d=+e.startOf(d,a?"day":o),e.diff(r,t,o)>1e5*s)throw new Error(t+" and "+r+" are too far apart with stepSize of "+s+" "+o);var h="data"===n.ticks.source&&this.getDataTimestamps();for(c=d,u=0;c<r;c=+e.add(c,s,o),u++)Qi(l,c,h);return c!==r&&"ticks"!==n.bounds&&1!==u||Qi(l,c,h),Object.keys(l).sort(Xi).map(e=>+e)}getLabelForValue(e){var t=this._adapter,r=this.options.time;return r.tooltipFormat?t.format(e,r.tooltipFormat):t.format(e,r.displayFormats.datetime)}format(e,t){var r=this.options.time.displayFormats,n=this._unit,t=t||r[n];return this._adapter.format(e,t)}_tickFormatFunction(e,t,r,n){var i,o=this.options,s=o.ticks.callback;return s?d(s,[e,t,r],this):(s=o.time.displayFormats,o=this._unit,i=this._majorUnit,o=o&&s[o],s=i&&s[i],r=r[t],t=i&&s&&r&&r.major,this._adapter.format(e,n||(t?s:o)))}generateTickLabels(e){let t,r,n;for(t=0,r=e.length;t<r;++t)(n=e[t]).label=this._tickFormatFunction(n.value,t,e)}getDecimalForValue(e){return null===e?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){var t=this._offsets,e=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+e)*t.factor)}getValueForPixel(e){var t=this._offsets,e=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+e*(this.max-this.min)}_getLabelSize(e){var t=this.options.ticks,e=this.ctx.measureText(e).width,t=M(this.isHorizontal()?t.maxRotation:t.minRotation),r=Math.cos(t),t=Math.sin(t),n=this._resolveTickFontOptions(0).size;return{w:e*r+n*t,h:e*t+n*r}}_getLabelCapacity(e){var t=this.options.time,r=t.displayFormats,t=r[t.unit]||r.millisecond,r=this._tickFormatFunction(e,0,eo(this,[e],this._majorUnit),t),e=this._getLabelSize(r),t=Math.floor(this.isHorizontal()?this.width/e.w:this.height/e.h)-1;return 0<t?t:1}getDataTimestamps(){let e,t,r=this._cache.data||[];if(r.length)return r;var n=this.getMatchingVisibleMetas();if(this._normalized&&n.length)return this._cache.data=n[0].controller.getAllParsedValues(this);for(e=0,t=n.length;e<t;++e)r=r.concat(n[e].controller.getAllParsedValues(this));return this._cache.data=this.normalize(r)}getLabelTimestamps(){var e=this._cache.labels||[];let t,r;if(e.length)return e;var n=this.getLabels();for(t=0,r=n.length;t<r;++t)e.push(Ji(this,n[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return Te(e.sort(Xi))}}function ro(e,t,r){let n,i,o,s,a=0,l=e.length-1;r?(t>=e[a].pos&&t<=e[l].pos&&({lo:a,hi:l}=m(e,"pos",t)),{pos:n,time:o}=e[a],{pos:i,time:s}=e[l]):(t>=e[a].time&&t<=e[l].time&&({lo:a,hi:l}=m(e,"time",t)),{time:n,pos:o}=e[a],{time:i,pos:s}=e[l]);r=i-n;return r?o+(s-o)*(t-n)/r:o}var no=Object.freeze({__proto__:null,CategoryScale:class extends Ln{static id="category";static defaults={ticks:{callback:Pi}};constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){var t=this._addedLabels;if(t.length){const e=this.getLabels();for(var{index:r,label:n}of t)e[r]===n&&e.splice(r,1);this._addedLabels=[]}super.init(e)}parse(e,t){var r,n,i,o,s,a,l;return x(e)||(r=this.getLabels(),o=t=isFinite(t)&&r[t]===e?t:(n=r,i=I(t,e=e),o=this._addedLabels,-1===(l=n.indexOf(e))?(a=i,o=o,"string"==typeof(s=e)?(a=n.push(s)-1,o.unshift({index:a,label:s})):isNaN(s)&&(a=null),a):l!==n.lastIndexOf(e)?i:l),s=r.length-1,null===o)?null:A(Math.round(o),0,s)}determineDataLimits(){var{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:r,max:n}=this.getMinMax(!0);"ticks"===this.options.bounds&&(e||(r=0),t||(n=this.getLabels().length-1)),this.min=r,this.max=n}buildTicks(){var t=this.min,r=this.max,e=this.options.offset,n=[];let i=this.getLabels();i=0===t&&r===i.length-1?i:i.slice(t,r+1),this._valueRange=Math.max(i.length-(e?0:1),1),this._startValue=this.min-(e?.5:0);for(let e=t;e<=r;e++)n.push({value:e});return n}getLabelForValue(e){return Pi.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return null===(e="number"!=typeof e?this.parse(e):e)?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){var t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}},LinearScale:Hi,LogarithmicScale:Bi,RadialLinearScale:qi,TimeScale:to,TimeSeriesScale:class extends to{static id="timeseries";static defaults=to.defaults;constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){var e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=ro(t,this.min),this._tableRange=ro(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){var{min:t,max:r}=this,n=[],i=[];let o,s,a,l,c;for(o=0,s=e.length;o<s;++o)(l=e[o])>=t&&l<=r&&n.push(l);if(n.length<2)return[{time:t,pos:0},{time:r,pos:1}];for(o=0,s=n.length;o<s;++o)c=n[o+1],a=n[o-1],l=n[o],Math.round((c+a)/2)!==l&&i.push({time:l,pos:o/(s-1)});return i}_generate(){var e=this.min,t=this.max,r=super.getDataTimestamps();return r.includes(e)&&r.length||r.splice(0,0,e),r.includes(t)&&1!==r.length||r.push(t),r.sort((e,t)=>e-t)}_getTimestampsForTable(){var e,t,r=this._cache.all||[];return r.length||(e=this.getDataTimestamps(),t=this.getLabelTimestamps(),r=e.length&&t.length?this.normalize(e.concat(t)):e.length?e:t,r=this._cache.all=r),r}getDecimalForValue(e){return(ro(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){var t=this._offsets,e=this.getDecimalForPixel(e)/t.factor-t.end;return ro(this._table,e*this._tableRange+this._minPos,!0)}}});const io=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],oo=io.map(e=>e.replace("rgb(","rgba(").replace(")",", 0.5)"));function so(e){return io[e%io.length]}function ao(e){return oo[e%oo.length]}function lo(o){let s=0;return(e,t)=>{var r,n,i,t=o.getDatasetMeta(t).controller;t instanceof gi?s=(n=e,i=s,n.backgroundColor=n.data.map(()=>so(i++)),i):t instanceof mi?s=(n=e,r=s,n.backgroundColor=n.data.map(()=>ao(r++)),r):t&&(s=(t=e,e=s,t.borderColor=so(e),t.backgroundColor=ao(e),++e))}}function co(e){let t;for(t in e)if(e[t].borderColor||e[t].backgroundColor)return 1}var uo={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(e,t,r){var n,i,o;r.enabled&&({data:{datasets:n},options:i}=e.config,o=i["elements"],!r.forceOverride&&(co(n)||i&&(i.borderColor||i.backgroundColor)||o&&co(o))||(r=lo(e),n.forEach(r)))}};function ho(e){var t;e._decimated&&(t=e._data,delete e._decimated,delete e._data,Object.defineProperty(e,"data",{configurable:!0,enumerable:!0,writable:!0,value:t}))}function po(e){e.data.datasets.forEach(e=>{ho(e)})}var fo={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(a,e,E)=>{if(E.enabled){const l=a.width;a.data.datasets.forEach((t,e)=>{var{_data:r,indexAxis:n}=t,c=a.getDatasetMeta(e),i=r||t.data;if("y"!==Tr([n,a.options.indexAxis])&&c.controller.supportsDecimation){e=a.scales[c.xAxisID];if(("linear"===e.type||"time"===e.type)&&!a.options.parsing){var{start:o,count:s}=function(e){var t=e.length;let r,n=0;var i=c["iScale"],{min:o,max:s,minDefined:a,maxDefined:l}=i.getUserBounds();return a&&(n=A(m(e,i.axis,o).lo,0,t-1)),r=l?A(m(e,i.axis,s).hi+1,n,t)-n:t-n,{start:n,count:r}}(i);if(s<=(E.threshold||4*l))ho(t);else{let e;switch(x(r)&&(t._data=i,delete t.data,Object.defineProperty(t,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(e){this._data=e}})),E.algorithm){case"lttb":e=function(n,i,o,e){var t=E.samples||e;if(o<=t)return n.slice(i,i+o);var s=[],a=(o-2)/(t-2);let l=0;const c=i+o-1;let u,d,h,p,f,g=i;for(s[l++]=n[g],u=0;u<t-2;u++){let e,t=0,r=0;const c=Math.floor((u+1)*a)+1+i,w=Math.min(Math.floor((u+2)*a)+1,o)+i,C=w-c;for(e=c;e<w;e++)t+=n[e].x,r+=n[e].y;t/=C,r/=C;var m=Math.floor(u*a)+1+i,y=Math.min(Math.floor((u+1)*a)+1,o)+i,{x:v,y:b}=n[g];for(h=-1,e=m;e<y;e++)(p=.5*Math.abs((v-t)*(n[e].y-b)-(v-n[e].x)*(r-b)))>h&&(h=p,d=n[e],f=e);s[l++]=d,g=f}return s[l++]=n[c],s}(i,o,s,l);break;case"min-max":e=function(e,t,r,n){let i,o,s,a,l,c,u,d,h,p,f=0,g=0;var m=[],y=e[t].x,v=e[t+r-1].x-y;for(i=t;i<t+r;++i){s=((o=e[i]).x-y)/v*n,a=o.y;const t=0|s;if(t===l)a<h?(h=a,c=i):a>p&&(p=a,u=i),f=(g*f+o.x)/++g;else{const r=i-1;if(!x(c)&&!x(u)){const t=Math.min(c,u),x=Math.max(c,u);t!==d&&t!==r&&m.push({...e[t],x:f}),x!==d&&x!==r&&m.push({...e[x],x:f})}0<i&&r!==d&&m.push(e[r]),m.push(o),l=t,g=0,h=p=a,c=u=d=i}}return m}(i,o,s,l);break;default:throw new Error(`Unsupported decimation algorithm '${E.algorithm}'`)}t._decimated=e}}}})}else po(a)},destroy(e){po(e)}};function go(r,n,i,e){if(!e){let e=n[r],t=i[r];return"angle"===r&&(e=C(e),t=C(t)),{property:r,start:e,end:t}}}function mo(e,t,r){for(;e<t;t--){const e=r[t];if(!isNaN(e.x)&&!isNaN(e.y))break}return t}function yo(e,t,r,n){return e&&t?n(e[r],t[r]):e?e[r]:t?t[r]:0}function vo(t,e){let r=[],n=!1;return(r=N(t)?(n=!0,t):function(e){const{x:r=null,y:n=null}=t||{},i=e.points,o=[];return e.segments.forEach(({start:e,end:t})=>{t=mo(e,t,i);e=i[e],t=i[t];null!==n?(o.push({x:e.x,y:n}),o.push({x:t.x,y:n})):null!==r&&(o.push({x:r,y:e.y}),o.push({x:r,y:t.y}))}),o}(e)).length?new Ri({points:r,options:{tension:0},_loop:n,_fullLoop:n}):null}function bo(e){return e&&!1!==e.fill}function wo(t,r,n){var i=[];for(let e=0;e<n.length;e++){var{first:o,last:s,point:a}=function(e,t,r){const n=e.interpolate(t,r);if(!n)return{};var i=n[r],o=e.segments,s=e.points;let a=!1,l=!1;for(let e=0;e<o.length;e++){const t=o[e],n=s[t.start][r],c=s[t.end][r];if(u(i,n,c)){a=i===n,l=i===c;break}}return{first:a,last:l,point:n}}(n[e],r,"x");if(!(!a||o&&s))if(o)i.unshift(a);else if(t.push(a),!s)break}t.push(...i)}class Co{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,t,r){var{x:n,y:i,radius:o}=this;return t=t||{start:0,end:b},e.arc(n,i,o,t.end,t.start,!0),!r.bounds}interpolate(e){var{x:t,y:r,radius:n}=this,e=e.angle;return{x:t+Math.cos(e)*n,y:r+Math.sin(e)*n,angle:e}}}function Eo(e){var t,r,{chart:n,fill:i,line:o}=e;if(g(i))return t=i,(r=(n=n).getDatasetMeta(t))&&n.isDatasetVisible(t)?r.dataset:null;if("stack"!==i)return"shape"===i||((n=function(e){if((e.scale||{}).getPointPositionForValue){var t=e;const{scale:i,fill:o}=t,s=i.options,a=i.getLabels().length,l=s.reverse?i.max:i.min,c=(t=o,n=i,"start"===t?l:"end"===t?n.options.reverse?n.min:n.max:O(t)?t.value:n.getBaseValue()),u=[];if(s.grid.circular){const t=i.getPointPositionForValue(0,l);return new Co({x:t.x,y:t.y,radius:i.getDistanceFromCenterForValue(c)})}for(let e=0;e<a;++e)u.push(i.getPointPositionForValue(e,c));return u}var r=e,{scale:t={},fill:r}=r,n=function(e,t){let r=null;return"start"===e?r=t.bottom:"end"===e?r=t.top:O(e)?r=t.getPixelForValue(e.value):t.getBasePixel&&(r=t.getBasePixel()),r}(r,t);if(g(n)){const r=t.isHorizontal();return{x:r?n:null,y:r?null:n}}return null}(e))instanceof Co?n:vo(n,o));{const{scale:s,index:a,line:l}=e,c=[],u=l.segments,d=l.points,h=function(e,t){var r=[],n=e.getMatchingVisibleMetas("line");for(let e=0;e<n.length;e++){var i=n[e];if(i.index===t)break;i.hidden||r.unshift(i.dataset)}return r}(s,a);h.push(vo({x:null,y:s.bottom},l));for(let e=0;e<u.length;e++){const s=u[e];for(let e=s.start;e<=s.end;e++)wo(c,d[e],h)}return new Ri({points:c,options:{}})}}function To(e,t,r){var n,i=Eo(t),{line:t,scale:o,axis:s}=t,a=t.options,l=a.fill,a=a.backgroundColor,{above:l=a,below:a=a}=l||{};i&&t.points.length&&(Ft(e,r),n=e,{line:i,target:l,above:a,below:r,area:o,scale:s}=t={line:t,target:i,above:l,below:a,area:r,scale:o,axis:s},t=i._loop?"angle":t.axis,n.save(),"x"===t&&r!==a&&(So(n,l,o.top),_o(n,{line:i,target:l,color:a,scale:s,property:t}),n.restore(),n.save(),So(n,l,o.bottom)),_o(n,{line:i,target:l,color:r,scale:s,property:t}),n.restore(),Ht(e))}function So(e,t,r){const{segments:n,points:i}=t;let o=!0,s=!1;e.beginPath();for(const a of n){const{start:n,end:l}=a,c=i[n],u=i[mo(n,l,i)];o?(e.moveTo(c.x,c.y),o=!1):(e.lineTo(c.x,r),e.lineTo(c.x,c.y)),(s=!!t.pathSegment(e,a,{move:s}))?e.closePath():e.lineTo(u.x,r)}e.lineTo(t.first().x,r),e.closePath(),e.clip()}function _o(t,r){const{line:n,target:i,property:o,color:s,scale:a}=r,l=function(e,t,r){const n=e.segments,i=e.points,o=t.points,s=[];for(const e of n){var{start:a,end:l}=e,l=mo(a,l,i),c=go(r,i[a],i[l],e.loop);if(t.segments){var u=Mr(t,c);for(const t of u){const n=go(r,o[t.start],o[t.end],t.loop),d=Ir(e,i,n);for(const e of d)s.push({source:e,target:t,start:{[r]:yo(c,n,"start",Math.max)},end:{[r]:yo(c,n,"end",Math.min)}})}}else s.push({source:e,target:c,start:i[a],end:i[l]})}return s}(n,i,o);for(const{source:r,target:g,start:m,end:y}of l){const{style:{backgroundColor:l=s}={}}=r,v=!0!==i;t.save(),t.fillStyle=l,f=p=h=d=u=c=void 0;var c=t,u=a,d=v&&go(o,m,y),{top:u,bottom:h}=u.chart.chartArea,{property:d,start:p,end:f}=d||{},d=("x"===d&&(c.beginPath(),c.rect(p,u,f-p,h-u),c.clip()),t.beginPath(),!!n.pathSegment(t,r));let e;if(v){d?t.closePath():xo(t,i,y,o);const r=!!i.pathSegment(t,g,{move:d,reverse:!0});(e=d&&r)||xo(t,i,m,o)}t.closePath(),t.fill(e?"evenodd":"nonzero"),t.restore()}}function xo(e,t,r,n){t=t.interpolate(r,n);t&&e.lineTo(t.x,t.y)}var Ro={id:"filler",afterDatasetsUpdate(e,t,r){var n,i,o,s,a,l,c=(e.data.datasets||[]).length,u=[];let d,h,p,f;for(h=0;h<c;++h)p=(d=e.getDatasetMeta(h)).dataset,f=null,p&&p.options&&p instanceof Ri&&(f={visible:e.isDatasetVisible(h),index:h,fill:(n=p,i=h,o=c,l=a=s=void 0,O(l=function(){var e=n.options,t=e.fill;let r=I(t&&t.target,t);return!1!==(r=void 0===r?!!e.backgroundColor:r)&&null!==r&&(!0===r?"origin":r)}())?!isNaN(l.value)&&l:g(a=parseFloat(l))&&Math.floor(a)===a?(s=l[0],a=a,!((a="-"!==s&&"+"!==s?a:i+a)===i||a<0||o<=a)&&a):0<=["origin","start","end","stack","shape"].indexOf(l)&&l),chart:e,axis:d.controller.options.indexAxis,scale:d.vScale,line:p}),d.$filler=f,u.push(f);for(h=0;h<c;++h)(f=u[h])&&!1!==f.fill&&(f.fill=function(e,t,r){let n=e[t].fill;var i,o=[t];if(!r)return n;for(;!1!==n&&-1===o.indexOf(n);){if(!g(n))return n;if(!(i=e[n]))return!1;if(i.visible)return n;o.push(n),n=i.fill}return!1}(u,h,r.propagate))},beforeDraw(t,e,r){var n="beforeDraw"===r.drawTime,i=t.getSortedVisibleDatasetMetas(),o=t.chartArea;for(let e=i.length-1;0<=e;--e){const r=i[e].$filler;r&&(r.line.updateControlPoints(o,r.axis),n)&&r.fill&&To(t.ctx,r,o)}},beforeDatasetsDraw(t,e,r){if("beforeDatasetsDraw"===r.drawTime){var n=t.getSortedVisibleDatasetMetas();for(let e=n.length-1;0<=e;--e){const r=n[e].$filler;bo(r)&&To(t.ctx,r,t.chartArea)}}},beforeDatasetDraw(e,t,r){t=t.meta.$filler;bo(t)&&"beforeDatasetDraw"===r.drawTime&&To(e.ctx,t,e.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const Ao=(e,t)=>{let{boxHeight:r=t,boxWidth:n=t}=e;return e.usePointStyle&&(r=Math.min(r,t),n=e.pointStyleWidth||Math.min(n,t)),{boxWidth:n,boxHeight:r,itemHeight:Math.max(t,r)}};class No extends t{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,r){this.maxWidth=e,this.maxHeight=t,this._margins=r,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const r=this.options.labels||{};let e=d(r.generateLabels,[this.chart],this)||[];r.filter&&(e=e.filter(e=>r.filter(e,this.chart.data))),r.sort&&(e=e.sort((e,t)=>r.sort(e,t,this.chart.data))),this.options.reverse&&e.reverse(),this.legendItems=e}fit(){var{options:r,ctx:n}=this;if(r.display){var i=r.labels,o=L(i.font),s=o.size,a=this._computeTitleHeight(),{boxWidth:i,itemHeight:l}=Ao(i,s);let e,t;n.font=o.string,this.isHorizontal()?(e=this.maxWidth,t=this._fitRows(a,s,i,l)+10):(t=this.maxHeight,e=this._fitCols(a,o,i,l)+10),this.width=Math.min(e,r.maxWidth||this.maxWidth),this.height=Math.min(t,r.maxHeight||this.maxHeight)}else this.width=this.height=0}_fitRows(e,r,n,i){const{ctx:o,maxWidth:s,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.lineWidths=[0],u=i+a;let d=e,h=(o.textAlign="left",o.textBaseline="middle",-1),p=-u;return this.legendItems.forEach((e,t)=>{e=n+r/2+o.measureText(e.text).width;(0===t||c[c.length-1]+e+2*a>s)&&(d+=u,c[c.length-(0<t?0:1)]=0,p+=u,h++),l[t]={left:0,top:p,row:h,width:e,height:i},c[c.length-1]+=e+a}),d}_fitCols(e,a,l,c){const{ctx:u,maxHeight:t,options:{labels:{padding:d}}}=this,h=this.legendHitBoxes=[],p=this.columnSizes=[],f=t-e;let g=d,m=0,y=0,v=0,b=0;return this.legendItems.forEach((e,t)=>{s=l,r=a,n=u,i=e,o=c;var r,n,i,o,{itemWidth:e,itemHeight:s}={itemWidth:function(e,t,r){let n=i.text;return n&&"string"!=typeof n&&(n=n.reduce((e,t)=>e.length>t.length?e:t)),e+t.size/2+r.measureText(n).width}(s,r,n),itemHeight:function(e){let t=o;return t="string"!=typeof i.text?Oo(i,e):t}(r.lineHeight)};0<t&&y+s+2*d>f&&(g+=m+d,p.push({width:m,height:y}),v+=m+d,b++,m=y=0),h[t]={left:v,top:y,col:b,width:e,height:s},m=Math.max(m,e),y+=s+d}),g+=m,p.push({width:m,height:y}),g}adjustHitBoxes(){if(this.options.display){var r=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:i,labels:{padding:o},rtl:e}}=this,s=xr(e,this.left,this.width);if(this.isHorizontal()){let e=0,t=k(i,this.left+o,this.right-this.lineWidths[e]);for(const a of n)e!==a.row&&(e=a.row,t=k(i,this.left+o,this.right-this.lineWidths[e])),a.top+=this.top+r+o,a.left=s.leftForLtr(s.x(t),a.width),t+=a.width+o}else{let e=0,t=k(i,this.top+r+o,this.bottom-this.columnSizes[e].height);for(const l of n)l.col!==e&&(e=l.col,t=k(i,this.top+r+o,this.bottom-this.columnSizes[e].height)),l.top=t,l.left+=this.left+o,l.left=s.leftForLtr(s.x(l.left),l.width),t+=l.height+o}}}isHorizontal(){return"top"===this.options.position||"bottom"===this.options.position}draw(){var e;this.options.display&&(Ft(e=this.ctx,this),this._draw(),Ht(e))}_draw(){const{options:c,columnSizes:u,lineWidths:d,ctx:h}=this,{align:p,labels:f}=c,g=D.color,m=xr(c.rtl,this.left,this.width),y=L(f.font),v=f["padding"],b=y.size,w=b/2;let C;this.drawTitle(),h.textAlign=m.textAlign("left"),h.textBaseline="middle",h.lineWidth=.5,h.font=y.string;const{boxWidth:E,boxHeight:T,itemHeight:S}=Ao(f,b),_=this.isHorizontal(),x=this._computeTitleHeight(),R=(C=_?{x:k(p,this.left+v,this.right-d[0]),y:this.top+v+x,line:0}:{x:this.left+v,y:k(p,this.top+x+v,this.bottom-u[0].height),line:0},Rr(this.ctx,c.textDirection),S+v);this.legendItems.forEach((e,t)=>{h.strokeStyle=e.fontColor,h.fillStyle=e.fontColor;var r=h.measureText(e.text).width,n=m.textAlign(e.textAlign||(e.textAlign=f.textAlign)),r=E+w+r;let i=C.x,o=C.y;m.setWidth(this.width),_?0<t&&i+r+v>this.right&&(o=C.y+=R,C.line++,i=C.x=k(p,this.left+v,this.right-d[C.line])):0<t&&o+R>this.bottom&&(i=C.x=i+u[C.line].width+v,C.line++,o=C.y=k(p,this.top+x+v,this.bottom-u[C.line].height));var t=m.x(i),s=o,a=e;if(!(isNaN(E)||E<=0||isNaN(T)||T<0)){h.save();var l=I(a.lineWidth,1);if(h.fillStyle=I(a.fillStyle,g),h.lineCap=I(a.lineCap,"butt"),h.lineDashOffset=I(a.lineDashOffset,0),h.lineJoin=I(a.lineJoin,"miter"),h.lineWidth=l,h.strokeStyle=I(a.strokeStyle,g),h.setLineDash(I(a.lineDash,[])),f.usePointStyle){const g={radius:T*Math.SQRT2/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:l},I=m.xPlus(t,E/2);Lt(h,g,I,s+w,f.pointStyleWidth&&E)}else{const f=s+Math.max((b-T)/2,0),g=m.leftForLtr(t,E),I=Er(a.borderRadius);h.beginPath(),Object.values(I).some(e=>0!==e)?$t(h,{x:g,y:f,w:E,h:T,radius:I}):h.rect(g,f,E,T),h.fill(),0!==l&&h.stroke()}h.restore()}if(i=Ae(n,i+E+w,_?i+r:this.right,c.rtl),s=m.x(i),t=o,a=e,Wt(h,a.text,s,t+S/2,y,{strikethrough:a.hidden,textAlign:m.textAlign(a.textAlign)}),_)C.x+=r+v;else if("string"!=typeof e.text){const c=y.lineHeight;C.y+=Oo(e,c)+v}else C.y+=R}),Ar(this.ctx,c.textDirection)}drawTitle(){const n=this.options,i=n.title,o=L(i.font),s=P(i.padding);if(i.display){var a=xr(n.rtl,this.left,this.width),l=this.ctx,c=i.position,u=o.size/2,u=s.top+u;let e,t=this.left,r=this.width;if(this.isHorizontal())r=Math.max(...this.lineWidths),e=this.top+u,t=k(n.align,t,this.right-r);else{const i=this.columnSizes.reduce((e,t)=>Math.max(e,t.height),0);e=u+k(n.align,this.top,this.bottom-i-n.labels.padding-this._computeTitleHeight())}u=k(c,t,t+r);l.textAlign=a.textAlign(Re(c)),l.textBaseline="middle",l.strokeStyle=i.color,l.fillStyle=i.color,l.font=o.string,Wt(l,i.text,u,e,o)}}_computeTitleHeight(){var e=this.options.title,t=L(e.font),r=P(e.padding);return e.display?t.lineHeight+r.height:0}_getLegendItemAt(e,t){let r,n,i;if(u(e,this.left,this.right)&&u(t,this.top,this.bottom))for(i=this.legendHitBoxes,r=0;r<i.length;++r)if(u(e,(n=i[r]).left,n.left+n.width)&&u(t,n.top,n.top+n.height))return this.legendItems[r];return null}handleEvent(e){var t,r,n,i=this.options;("mousemove"!==(t=e.type)&&"mouseout"!==t||!i.onHover&&!i.onLeave)&&(!i.onClick||"click"!==t&&"mouseup"!==t)||(t=this._getLegendItemAt(e.x,e.y),"mousemove"===e.type||"mouseout"===e.type?(n=null!==(r=this._hoveredItem)&&null!==t&&r.datasetIndex===t.datasetIndex&&r.index===t.index,r&&!n&&d(i.onLeave,[e,r,this],this),(this._hoveredItem=t)&&!n&&d(i.onHover,[e,t,this],this)):t&&d(i.onClick,[e,t,this],this))}}function Oo(e,t){return t*(e.text?e.text.length:0)}var Io={id:"legend",_element:No,start(e,t,r){var n=e.legend=new No({ctx:e.ctx,options:r,chart:e});i.configure(e,n,r),i.addBox(e,n)},stop(e){i.removeBox(e,e.legend),delete e.legend},beforeUpdate(e,t,r){var n=e.legend;i.configure(e,n,r),n.options=r},afterUpdate(e){e=e.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(e,t){t.replay||e.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(e,t,r){var n=t.datasetIndex,r=r.chart;r.isDatasetVisible(n)?(r.hide(n),t.hidden=!0):(r.show(n),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:e=>e.chart.options.color,boxWidth:40,padding:10,generateLabels(e){const n=e.data.datasets,{usePointStyle:i,pointStyle:o,textAlign:s,color:a,useBorderRadius:l,borderRadius:c}=e.legend.options["labels"];return e._getSortedDatasetMetas().map(e=>{var t=e.controller.getStyle(i?0:void 0),r=P(t.borderWidth);return{text:n[e.index].label,fillStyle:t.backgroundColor,fontColor:a,hidden:!e.visible,lineCap:t.borderCapStyle,lineDash:t.borderDash,lineDashOffset:t.borderDashOffset,lineJoin:t.borderJoinStyle,lineWidth:(r.width+r.height)/4,strokeStyle:t.borderColor,pointStyle:o||t.pointStyle,rotation:t.rotation,textAlign:s||t.textAlign,borderRadius:l&&(c||t.borderRadius),datasetIndex:e.index}},this)}},title:{color:e=>e.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:e=>!e.startsWith("on"),labels:{_scriptable:e=>!["generateLabels","filter","sort"].includes(e)}}};class Mo extends t{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t){var r=this.options;this.left=0,this.top=0,r.display?(this.width=this.right=e,this.height=this.bottom=t,e=N(r.text)?r.text.length:1,this._padding=P(r.padding),t=e*L(r.font).lineHeight+this._padding.height,this.isHorizontal()?this.height=t:this.width=t):this.width=this.height=this.right=this.bottom=0}isHorizontal(){var e=this.options.position;return"top"===e||"bottom"===e}_drawArgs(e){var{top:t,left:r,bottom:n,right:i,options:o}=this,s=o.align;let a,l,c,u=0;return a=this.isHorizontal()?(l=k(s,r,i),c=t+e,i-r):(u="left"===o.position?(l=r+e,c=k(s,n,t),-.5*_):(l=i-e,c=k(s,t,n),.5*_),n-t),{titleX:l,titleY:c,maxWidth:a,rotation:u}}draw(){var e,t,r,n,i,o=this.ctx,s=this.options;s.display&&(t=(e=L(s.font)).lineHeight/2+this._padding.top,{titleX:t,titleY:r,maxWidth:n,rotation:i}=this._drawArgs(t),Wt(o,s.text,0,0,e,{color:s.color,maxWidth:n,rotation:i,textAlign:Re(s.align),textBaseline:"middle",translation:[t,r]}))}}var ko={id:"title",_element:Mo,start(e,t,r){var n;e=e,r=r,n=new Mo({ctx:e.ctx,options:r,chart:e}),i.configure(e,n,r),i.addBox(e,n),e.titleBlock=n},stop(e){var t=e.titleBlock;i.removeBox(e,t),delete e.titleBlock},beforeUpdate(e,t,r){var n=e.titleBlock;i.configure(e,n,r),n.options=r},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Do=new WeakMap;var Po={id:"subtitle",start(e,t,r){var n=new Mo({ctx:e.ctx,options:r,chart:e});i.configure(e,n,r),i.addBox(e,n),Do.set(e,n)},stop(e){i.removeBox(e,Do.get(e)),Do.delete(e)},beforeUpdate(e,t,r){var n=Do.get(e);i.configure(e,n,r),n.options=r},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Lo={average(e){if(!e.length)return!1;let t,r,n=0,i=0,o=0;for(t=0,r=e.length;t<r;++t){const r=e[t].element;if(r&&r.hasValue()){const e=r.tooltipPosition();n+=e.x,i+=e.y,++o}}return{x:n/o,y:i/o}},nearest(e,t){if(!e.length)return!1;let r,n,i,o=t.x,s=t.y,a=Number.POSITIVE_INFINITY;for(r=0,n=e.length;r<n;++r){const n=e[r].element;if(n&&n.hasValue()){const e=pe(t,n.getCenterPoint());e<a&&(a=e,i=n)}}if(i){const e=i.tooltipPosition();o=e.x,s=e.y}return{x:o,y:s}}};function y(e,t){return t&&(N(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function Fo(e){return("string"==typeof e||e instanceof String)&&-1<e.indexOf("\n")?e.split("\n"):e}function Ho(e,t){const r=e.chart.ctx,{body:n,footer:i,title:o}=e,{boxWidth:s,boxHeight:a}=t,l=L(t.bodyFont),c=L(t.titleFont),u=L(t.footerFont),d=o.length,h=i.length,p=n.length,f=P(t.padding);let g=f.height,m=0,y=n.reduce((e,t)=>e+t.before.length+t.lines.length+t.after.length,0),v=(y+=e.beforeBody.length+e.afterBody.length,d&&(g+=d*c.lineHeight+(d-1)*t.titleSpacing+t.titleMarginBottom),y&&(g+=p*(t.displayColors?Math.max(a,l.lineHeight):l.lineHeight)+(y-p)*l.lineHeight+(y-1)*t.bodySpacing),h&&(g+=t.footerMarginTop+h*u.lineHeight+(h-1)*t.footerSpacing),0);function b(e){m=Math.max(m,r.measureText(e).width+v)}return r.save(),r.font=c.string,S(e.title,b),r.font=l.string,S(e.beforeBody.concat(e.afterBody),b),v=t.displayColors?s+2+t.boxPadding:0,S(n,e=>{S(e.before,b),S(e.lines,b),S(e.after,b)}),v=0,r.font=u.string,S(e.footer,b),r.restore(),{width:m+=f.width,height:g}}function Uo(r,e,n){var t=n.yAlign||e.yAlign||function(){var{y:e,height:t}=n;return e<t/2?"top":e>r.height-t/2?"bottom":"center"}();return{xAlign:n.xAlign||e.xAlign||function(i,o,s,e){var{x:t,width:r}=s,{width:n,chartArea:{left:a,right:l}}=i;let c="center";return"center"===e?c=t<=(a+l)/2?"left":"right":t<=r/2?c="left":n-r/2<=t&&(c="right"),c=function(e){var{x:t,width:r}=s,n=o.caretSize+o.caretPadding;return"left"===e&&t+r+n>i.width||"right"===e&&t-r-n<0}(c)?"center":c}(r,e,n,t),yAlign:t}}function Vo(e,r,t,n){var{caretSize:e,caretPadding:i,cornerRadius:o}=e,{xAlign:s,yAlign:a}=t,l=e+i,{topLeft:t,topRight:i,bottomLeft:o,bottomRight:c}=Er(o);let u=function(){let{x:e,width:t}=r;return"right"===s?e-=t:"center"===s&&(e-=t/2),e}();var d=function(){let{y:e,height:t}=r;return"top"===a?e+=l:e-="bottom"===a?t+l:t/2,e}();return"center"===a?"left"===s?u+=l:"right"===s&&(u-=l):"left"===s?u-=Math.max(t,o)+e:"right"===s&&(u+=Math.max(i,c)+e),{x:A(u,0,n.width-r.width),y:A(d,0,n.height-r.height)}}function Wo(e,t,r){r=P(r.padding);return"center"===t?e.x+e.width/2:"right"===t?e.x+e.width-r.right:e.x+r.left}function $o(e){return y([],Fo(e))}function Bo(e,t){t=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return t?e.override(t):e}const jo={beforeTitle:e,title(e){if(0<e.length){var e=e[0],t=e.chart.data.labels,r=t?t.length:0;if(this&&this.options&&"dataset"===this.options.mode)return e.dataset.label||"";if(e.label)return e.label;if(0<r&&e.dataIndex<r)return t[e.dataIndex]}return""},afterTitle:e,beforeBody:e,beforeLabel:e,label(e){if(this&&this.options&&"dataset"===this.options.mode)return e.label+": "+e.formattedValue||e.formattedValue;let t=e.dataset.label||"";t&&(t+=": ");e=e.formattedValue;return x(e)||(t+=e),t},labelColor(e){e=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:e.borderColor,backgroundColor:e.backgroundColor,borderWidth:e.borderWidth,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(e){e=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:e.pointStyle,rotation:e.rotation}},afterLabel:e,afterBody:e,beforeFooter:e,footer:e,afterFooter:e};function v(e,t,r,n){e=e[t].call(r,n);return void 0===e?jo[t].call(r,n):e}class zo extends t{static positioners=Lo;constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){var e,t=this._cachedAnimations;return t||(t=this.chart,t=(e=this.options.setContext(this.getContext())).enabled&&t.options.animation&&e.animations,e=new vn(this.chart,t),t._cacheable&&(this._cachedAnimations=Object.freeze(e)),e)}getContext(){return this.$context||(this.$context=(e=this.chart.getContext(),_r(e,{tooltip:this,tooltipItems:this._tooltipItems,type:"tooltip"})));var e}getTitle(e,t){var t=t["callbacks"],r=v(t,"beforeTitle",this,e),n=v(t,"title",this,e),t=v(t,"afterTitle",this,e),e=y([],Fo(r));return e=y(e,Fo(n)),y(e,Fo(t))}getBeforeBody(e,t){return $o(v(t.callbacks,"beforeBody",this,e))}getBody(e,t){const n=t["callbacks"],i=[];return S(e,e=>{var t={before:[],lines:[],after:[]},r=Bo(n,e);y(t.before,Fo(v(r,"beforeLabel",this,e))),y(t.lines,v(r,"label",this,e)),y(t.after,Fo(v(r,"afterLabel",this,e))),i.push(t)}),i}getAfterBody(e,t){return $o(v(t.callbacks,"afterBody",this,e))}getFooter(e,t){var t=t["callbacks"],r=v(t,"beforeFooter",this,e),n=v(t,"footer",this,e),t=v(t,"afterFooter",this,e),e=y([],Fo(r));return e=y(e,Fo(n)),y(e,Fo(t))}_createItems(n){const e=this._active,i=this.chart.data,r=[],o=[],s=[];let t,a,l=[];for(t=0,a=e.length;t<a;++t)l.push(function(e,t){var{element:t,datasetIndex:r,index:n}=t,i=e.getDatasetMeta(r).controller,{label:o,value:s}=i.getLabelAndValue(n);return{chart:e,label:o,parsed:i.getParsed(n),raw:e.data.datasets[r].data[n],formattedValue:s,dataset:i.getDataset(),dataIndex:n,datasetIndex:r,element:t}}(this.chart,e[t]));return n.filter&&(l=l.filter((e,t,r)=>n.filter(e,t,r,i))),S(l=n.itemSort?l.sort((e,t)=>n.itemSort(e,t,i)):l,e=>{var t=Bo(n.callbacks,e);r.push(v(t,"labelColor",this,e)),o.push(v(t,"labelPointStyle",this,e)),s.push(v(t,"labelTextColor",this,e))}),this.labelColors=r,this.labelPointStyles=o,this.labelTextColors=s,this.dataPoints=l}update(e,t){var r=this.options.setContext(this.getContext()),n=this._active;let i,o=[];if(n.length){const e=Lo[r.position].call(this,n,this._eventPosition),t=(o=this._createItems(r),this.title=this.getTitle(o,r),this.beforeBody=this.getBeforeBody(o,r),this.body=this.getBody(o,r),this.afterBody=this.getAfterBody(o,r),this.footer=this.getFooter(o,r),this._size=Ho(this,r)),s=Object.assign({},e,t),a=Uo(this.chart,r,s),l=Vo(r,s,a,this.chart);this.xAlign=a.xAlign,this.yAlign=a.yAlign,i={opacity:1,x:l.x,y:l.y,width:t.width,height:t.height,caretX:e.x,caretY:e.y}}else 0!==this.opacity&&(i={opacity:0});this._tooltipItems=o,this.$context=void 0,i&&this._resolveAnimations().update(this,i),e&&r.external&&r.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,r,n){e=this.getCaretPosition(e,r,n);t.lineTo(e.x1,e.y1),t.lineTo(e.x2,e.y2),t.lineTo(e.x3,e.y3)}getCaretPosition(e,t,r){var{xAlign:n,yAlign:i}=this,{caretSize:r,cornerRadius:o}=r,{topLeft:o,topRight:s,bottomLeft:a,bottomRight:l}=Er(o),{x:e,y:c}=e,{width:t,height:u}=t;let d,h,p,f,g,m;return"center"===i?(g=c+u/2,m="left"===n?(d=e,h=d-r,f=g+r,g-r):(d=e+t,h=d+r,f=g-r,g+r),p=d):(h="left"===n?e+Math.max(o,a)+r:"right"===n?e+t-Math.max(s,l)-r:this.caretX,p="top"===i?(f=c,g=f-r,d=h-r,h+r):(f=c+u,g=f+r,d=h+r,h-r),m=f),{x1:d,x2:h,x3:p,y1:f,y2:g,y3:m}}drawTitle(e,t,r){var n=this.title,i=n.length;let o,s,a;if(i){var l=xr(r.rtl,this.x,this.width);for(e.x=Wo(this,r.titleAlign,r),t.textAlign=l.textAlign(r.titleAlign),t.textBaseline="middle",o=L(r.titleFont),s=r.titleSpacing,t.fillStyle=r.titleColor,t.font=o.string,a=0;a<i;++a)t.fillText(n[a],l.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+s,a+1===i&&(e.y+=r.titleMarginBottom-s)}}_drawColorBox(e,t,r,n,i){const o=this.labelColors[r],s=this.labelPointStyles[r],{boxHeight:a,boxWidth:l}=i,c=L(i.bodyFont),u=Wo(this,"left",i),d=n.x(u),h=a<c.lineHeight?(c.lineHeight-a)/2:0,p=t.y+h;if(i.usePointStyle){const t={radius:Math.min(l,a)/2,pointStyle:s.pointStyle,rotation:s.rotation,borderWidth:1},r=n.leftForLtr(d,l)+l/2,O=p+a/2;e.strokeStyle=i.multiKeyBackground,e.fillStyle=i.multiKeyBackground,Pt(e,t,r,O),e.strokeStyle=o.borderColor,e.fillStyle=o.backgroundColor,Pt(e,t,r,O)}else{e.lineWidth=O(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,e.strokeStyle=o.borderColor,e.setLineDash(o.borderDash||[]),e.lineDashOffset=o.borderDashOffset||0;const t=n.leftForLtr(d,l),r=n.leftForLtr(n.xPlus(d,1),l-2),s=Er(o.borderRadius);Object.values(s).some(e=>0!==e)?(e.beginPath(),e.fillStyle=i.multiKeyBackground,$t(e,{x:t,y:p,w:l,h:a,radius:s}),e.fill(),e.stroke(),e.fillStyle=o.backgroundColor,e.beginPath(),$t(e,{x:r,y:p+1,w:l-2,h:a-2,radius:s}),e.fill()):(e.fillStyle=i.multiKeyBackground,e.fillRect(t,p,l,a),e.strokeRect(t,p,l,a),e.fillStyle=o.backgroundColor,e.fillRect(r,p+1,l-2,a-2))}e.fillStyle=this.labelTextColors[r]}drawBody(t,r,e){const n=this["body"],{bodySpacing:i,bodyAlign:o,displayColors:s,boxHeight:a,boxWidth:l,boxPadding:c}=e,u=L(e.bodyFont);let d=u.lineHeight,h=0;function p(e){r.fillText(e,f.x(t.x+h),t.y+d/2),t.y+=d+i}const f=xr(e.rtl,this.x,this.width),g=f.textAlign(o);let m,y,v,b,w,C,E;for(r.textAlign=o,r.textBaseline="middle",r.font=u.string,t.x=Wo(this,g,e),r.fillStyle=e.bodyColor,S(this.beforeBody,p),h=s&&"right"!==g?"center"===o?l/2+c:l+2+c:0,b=0,C=n.length;b<C;++b){for(m=n[b],y=this.labelTextColors[b],r.fillStyle=y,S(m.before,p),v=m.lines,s&&v.length&&(this._drawColorBox(r,t,b,f,e),d=Math.max(u.lineHeight,a)),w=0,E=v.length;w<E;++w)p(v[w]),d=u.lineHeight;S(m.after,p)}h=0,d=u.lineHeight,S(this.afterBody,p),t.y-=i}drawFooter(e,t,r){var n=this.footer,i=n.length;let o,s;if(i){var a=xr(r.rtl,this.x,this.width);for(e.x=Wo(this,r.footerAlign,r),e.y+=r.footerMarginTop,t.textAlign=a.textAlign(r.footerAlign),t.textBaseline="middle",o=L(r.footerFont),t.fillStyle=r.footerColor,t.font=o.string,s=0;s<i;++s)t.fillText(n[s],a.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+r.footerSpacing}}drawBackground(e,t,r,n){var{xAlign:i,yAlign:o}=this,{x:s,y:a}=e,{width:l,height:c}=r,{topLeft:u,topRight:d,bottomLeft:h,bottomRight:p}=Er(n.cornerRadius);t.fillStyle=n.backgroundColor,t.strokeStyle=n.borderColor,t.lineWidth=n.borderWidth,t.beginPath(),t.moveTo(s+u,a),"top"===o&&this.drawCaret(e,t,r,n),t.lineTo(s+l-d,a),t.quadraticCurveTo(s+l,a,s+l,a+d),"center"===o&&"right"===i&&this.drawCaret(e,t,r,n),t.lineTo(s+l,a+c-p),t.quadraticCurveTo(s+l,a+c,s+l-p,a+c),"bottom"===o&&this.drawCaret(e,t,r,n),t.lineTo(s+h,a+c),t.quadraticCurveTo(s,a+c,s,a+c-h),"center"===o&&"left"===i&&this.drawCaret(e,t,r,n),t.lineTo(s,a+u),t.quadraticCurveTo(s,a,s+u,a),t.closePath(),t.fill(),0<n.borderWidth&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,r=this.$animations,n=r&&r.x,i=r&&r.y;if(n||i){const r=Lo[e.position].call(this,this._active,this._eventPosition);var o,s;r&&(o=this._size=Ho(this,e),s=Vo(e,s=Object.assign({},r,this._size),e=Uo(t,e,s),t),n._to===s.x&&i._to===s.y||(this.xAlign=e.xAlign,this.yAlign=e.yAlign,this.width=o.width,this.height=o.height,this.caretX=r.x,this.caretY=r.y,this._resolveAnimations().update(this,s)))}}_willRender(){return!!this.opacity}draw(e){var t,r,n,i,o=this.options.setContext(this.getContext()),s=this.opacity;s&&(this._updateAnimationTarget(o),t={width:this.width,height:this.height},r={x:this.x,y:this.y},s=Math.abs(s)<.001?0:s,n=P(o.padding),i=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length,o.enabled)&&i&&(e.save(),e.globalAlpha=s,this.drawBackground(r,e,t,o),Rr(e,o.textDirection),r.y+=n.top,this.drawTitle(r,e,o),this.drawBody(r,e,o),this.drawFooter(r,e,o),Ar(e,o.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){var r=this._active,e=e.map(({datasetIndex:e,index:t})=>{var r=this.chart.getDatasetMeta(e);if(r)return{datasetIndex:e,element:r.data[t],index:t};throw new Error("Cannot find a dataset at index "+e)}),r=!V(r,e),n=this._positionChanged(e,t);(r||n)&&(this._active=e,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t,r=!0){if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;var n=this.options,i=this._active||[],r=this._getActiveElements(e,i,t,r),o=this._positionChanged(r,e),i=t||!V(r,i)||o;return i&&(this._active=r,n.enabled||n.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t)),i}_getActiveElements(e,t,r,n){var i=this.options;return"mouseout"===e.type?[]:n?(n=this.chart.getElementsAtEventForMode(e,i.mode,i,r),i.reverse&&n.reverse(),n):t.filter(e=>this.chart.data.datasets[e.datasetIndex]&&void 0!==this.chart.getDatasetMeta(e.datasetIndex).controller.getParsed(e.index))}_positionChanged(e,t){var{caretX:r,caretY:n,options:i}=this,i=Lo[i.position].call(this,e,t);return!1!==i&&(r!==i.x||n!==i.y)}}var Yo={id:"tooltip",_element:zo,positioners:Lo,afterInit(e,t,r){r&&(e.tooltip=new zo({chart:e,options:r}))},beforeUpdate(e,t,r){e.tooltip&&e.tooltip.initialize(r)},reset(e,t,r){e.tooltip&&e.tooltip.initialize(r)},afterDraw(e){var t,r=e.tooltip;r&&r._willRender()&&!(t={tooltip:r})!==e.notifyPlugins("beforeTooltipDraw",{...t,cancelable:!0})&&(r.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",t))},afterEvent(e,t){var r;e.tooltip&&(r=t.replay,e.tooltip.handleEvent(t.event,r,t.inChartArea))&&(t.changed=!0)},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(e,t)=>t.bodyFont.size,boxWidth:(e,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:jo},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:e=>"filter"!==e&&"itemSort"!==e&&"external"!==e,_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};return r.register(yi,no,Di,n),r.helpers={...Lr},r._adapters=ci,r.Animation=yn,r.Animations=vn,r.animator=o,r.controllers=T.controllers.items,r.DatasetController=Nn,r.Element=t,r.elements=Di,r.Interaction=Wr,r.layouts=i,r.platforms=At,r.Scale=Ln,r.Ticks=ht,Object.assign(r,yi,no,Di,n,At),r.Chart=r,"undefined"!=typeof window&&(window.Chart=r),r}),(()=>{"use strict";const s=(e,t,r)=>Math.max(Math.min(e,r),t);function L(e){return s(2.55*e+.5|0,0,255)}function a(e){return s(255*e+.5|0,0,255)}function l(e){return s((e/2.55+.5|0)/100,0,1)}function F(e){return s(100*e+.5|0,0,100)}const o={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},H=[..."0123456789ABCDEF"],U=e=>H[15&e],V=e=>H[(240&e)>>4]+H[15&e],W=e=>(240&e)>>4==(15&e),$=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function B(r,e,n){const i=e*Math.min(n,1-n),t=(e,t=(e+r/30)%12)=>n-i*Math.max(Math.min(t-3,9-t,1),-1);return[t(0),t(8),t(4)]}function j(r,n,i){var e=(e,t=(e+r/60)%6)=>i-i*n*Math.max(Math.min(t,4-t,1),0);return[e(5),e(3),e(1)]}function z(e,t,r){var n=B(e,1,.5);let i;for(1<t+r&&(t*=i=1/(t+r),r*=i),i=0;i<3;i++)n[i]*=1-t-r,n[i]+=t;return n}function Y(e){var t=e.r/255,r=e.g/255,e=e.b/255,n=Math.max(t,r,e),i=Math.min(t,r,e),o=(n+i)/2;let s,a,l;return n!==i&&(l=n-i,a=.5<o?l/(2-n-i):l/(n+i),s=60*(s=(i=r,r=e,(e=t)===n?(i-r)/l+(i<r?6:0):i===n?(r-e)/l+2:(e-i)/l+4))+.5),[0|s,a||0,o]}function G(e,t,r,n){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,r,n)).map(a)}function q(e,t,r){return G(B,e,t,r)}function K(e){return(e%360+360)%360}const X={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},J={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};let Z;const Q=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/,ee=e=>e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055,c=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function te(t,r,n){if(t){let e=Y(t);e[r]=Math.max(0,Math.min(e[r]+e[r]*n,0===r?360:1)),e=q(e),t.r=e[0],t.g=e[1],t.b=e[2]}}function re(e,t){return e&&Object.assign(t||{},e)}function ne(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?3<=e.length&&(t={r:e[0],g:e[1],b:e[2],a:255},3<e.length)&&(t.a=a(e[3])):(t=re(e,{r:0,g:0,b:0,a:1})).a=a(t.a),t}class ie{constructor(e){if(e instanceof ie)return e;var t,r,n=typeof e;let i;"object"==n?i=ne(e):"string"==n&&(r=(n=e).length,"#"===n[0]&&(4===r||5===r?t={r:255&17*o[n[1]],g:255&17*o[n[2]],b:255&17*o[n[3]],a:5===r?17*o[n[4]]:255}:7!==r&&9!==r||(t={r:o[n[1]]<<4|o[n[2]],g:o[n[3]]<<4|o[n[4]],b:o[n[5]]<<4|o[n[6]],a:9===r?o[n[7]]<<4|o[n[8]]:255})),i=t||function(e){Z||((Z=function(){var e={},t=Object.keys(J),r=Object.keys(X);let n,i,o,s,a;for(n=0;n<t.length;n++){for(s=a=t[n],i=0;i<r.length;i++)o=r[i],a=a.replace(o,X[o]);o=parseInt(J[s],16),e[a]=[o>>16&255,o>>8&255,255&o]}return e}()).transparent=[0,0,0,0]);e=Z[e.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:4===e.length?e[3]:255}}(e)||("r"===(r=e).charAt(0)?function(e){var t=Q.exec(e);let r,n,i,o=255;if(t){if(void 0!==t[7]){const e=+t[7];o=t[8]?L(e):s(255*e,0,255)}return r=+t[1],n=+t[3],i=+t[5],{r:255&(t[2]?L(r):s(r,0,255)),g:255&(t[4]?L(n):s(n,0,255)),b:255&(t[6]?L(i):s(i,0,255)),a:o}}}:function(e){var t,r,n,e=$.exec(e);let i,o=255;if(e)return void 0!==e[5]&&(o=(e[6]?L:a)(+e[5])),t=K(+e[2]),r=+e[3]/100,n=+e[4]/100,{r:(i="hwb"===e[1]?G(z,t,r,n):"hsv"===e[1]?G(j,t,r,n):q(t,r,n))[0],g:i[1],b:i[2],a:o}})(r)),this._rgb=i,this._valid=!!i}get valid(){return this._valid}get rgb(){var e=re(this._rgb);return e&&(e.a=l(e.a)),e}set rgb(e){this._rgb=ne(e)}rgbString(){return this._valid?(e=this._rgb)&&(e.a<255?`rgba(${e.r}, ${e.g}, ${e.b}, ${l(e.a)})`:`rgb(${e.r}, ${e.g}, ${e.b})`):void 0;var e}hexString(){return this._valid&&(e=this._rgb,t=e,t=W(t.r)&&W(t.g)&&W(t.b)&&W(t.a)?U:V,e)?"#"+t(e.r)+t(e.g)+t(e.b)+((e=e.a)<255?t(e):""):void 0;var e,t}hslString(){if(this._valid){var e,t,r,n=this._rgb;if(n)return e=(r=Y(n))[0],t=F(r[1]),r=F(r[2]),n.a<255?`hsla(${e}, ${t}%, ${r}%, ${l(n.a)})`:`hsl(${e}, ${t}%, ${r}%)`}}mix(e,t){var r,n,i;return e&&(r=this.rgb,e=e.rgb,i=r.a-e.a,r.r=255&(n=(1+((n=2*(t=void 0===t?.5:t)-1)*i==-1?n:(n+i)/(1+n*i)))/2)*r.r+(i=1-n)*e.r+.5,r.g=255&n*r.g+i*e.g+.5,r.b=255&n*r.b+i*e.b+.5,r.a=t*r.a+(1-t)*e.a,this.rgb=r),this}interpolate(e,t){return e&&(this._rgb=(r=this._rgb,e=e._rgb,t=t,n=c(l(r.r)),i=c(l(r.g)),o=c(l(r.b)),{r:a(ee(n+t*(c(l(e.r))-n))),g:a(ee(i+t*(c(l(e.g))-i))),b:a(ee(o+t*(c(l(e.b))-o))),a:r.a+t*(e.a-r.a)})),this;var r,n,i,o}clone(){return new ie(this.rgb)}alpha(e){return this._rgb.a=a(e),this}clearer(e){return this._rgb.a*=1-e,this}greyscale(){var e=this._rgb,t=.3*e.r+.59*e.g+.11*e.b+.5|0;return e.r=e.g=e.b=t,this}opaquer(e){return this._rgb.a*=1+e,this}negate(){var e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return te(this._rgb,2,e),this}darken(e){return te(this._rgb,2,-e),this}saturate(e){return te(this._rgb,1,e),this}desaturate(e){return te(this._rgb,1,-e),this}rotate(e){return t=this._rgb,e=e,(r=Y(t))[0]=K(r[0]+e),r=q(r),t.r=r[0],t.g=r[1],t.b=r[2],this;var t,r}}class e extends Error{}class oe extends e{constructor(e){super("Invalid DateTime: "+e.toMessage())}}class se extends e{constructor(e){super("Invalid Interval: "+e.toMessage())}}class ae extends e{constructor(e){super("Invalid Duration: "+e.toMessage())}}class le extends e{}class ce extends e{constructor(e){super("Invalid unit "+e)}}class u extends e{}class r extends e{constructor(){super("Zone is an abstract class")}}const t="numeric",n="short",i="long",ue={year:t,month:t,day:t},de={year:t,month:n,day:t},he={year:t,month:n,day:t,weekday:n},pe={year:t,month:i,day:t},fe={year:t,month:i,day:t,weekday:i},ge={hour:t,minute:t},me={hour:t,minute:t,second:t},ye={hour:t,minute:t,second:t,timeZoneName:n},ve={hour:t,minute:t,second:t,timeZoneName:i},be={hour:t,minute:t,hourCycle:"h23"},we={hour:t,minute:t,second:t,hourCycle:"h23"},Ce={hour:t,minute:t,second:t,hourCycle:"h23",timeZoneName:n},Ee={hour:t,minute:t,second:t,hourCycle:"h23",timeZoneName:i},Te={year:t,month:t,day:t,hour:t,minute:t},Se={year:t,month:t,day:t,hour:t,minute:t,second:t},_e={year:t,month:n,day:t,hour:t,minute:t},xe={year:t,month:n,day:t,hour:t,minute:t,second:t},Re={year:t,month:n,day:t,weekday:n,hour:t,minute:t},Ae={year:t,month:i,day:t,hour:t,minute:t,timeZoneName:n},Ne={year:t,month:i,day:t,hour:t,minute:t,second:t,timeZoneName:n},Oe={year:t,month:i,day:t,weekday:i,hour:t,minute:t,timeZoneName:i},Ie={year:t,month:i,day:t,weekday:i,hour:t,minute:t,second:t,timeZoneName:i};function y(e){return void 0===e}function d(e){return"number"==typeof e}function Me(e){return"number"==typeof e&&e%1==0}function ke(){try{return"undefined"!=typeof Intl&&!!Intl.RelativeTimeFormat}catch(e){return!1}}function De(e,r,n){if(0!==e.length)return e.reduce((e,t)=>{t=[r(t),t];return e&&n(e[0],t[0])===e[0]?e:t},null)[1]}function h(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function m(e,t,r){return Me(e)&&t<=e&&e<=r}function p(e,t=2){return e<0?"-"+(""+-e).padStart(t,"0"):(""+e).padStart(t,"0")}function f(e){return y(e)||null===e||""===e?void 0:parseInt(e,10)}function g(e){return y(e)||null===e||""===e?void 0:parseFloat(e)}function Pe(e){if(!y(e)&&null!==e&&""!==e)return e=1e3*parseFloat("0."+e),Math.floor(e)}function Le(e,t,r=!1){t=10**t;return(r?Math.trunc:Math.round)(e*t)/t}function Fe(e){return e%4==0&&(e%100!=0||e%400==0)}function He(e){return Fe(e)?366:365}function Ue(e,t){var r=(r=t-1)-12*Math.floor(r/12)+1;return 2==r?Fe(e+(t-r)/12)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][r-1]}function Ve(e){let t=Date.UTC(e.year,e.month-1,e.day,e.hour,e.minute,e.second,e.millisecond);return e.year<100&&0<=e.year&&(t=new Date(t)).setUTCFullYear(t.getUTCFullYear()-1900),+t}function We(e){var t=(e+Math.floor(e/4)-Math.floor(e/100)+Math.floor(e/400))%7,e=e-1,e=(e+Math.floor(e/4)-Math.floor(e/100)+Math.floor(e/400))%7;return 4==t||3==e?53:52}function $e(e){return 99<e?e:60<e?1900+e:2e3+e}function Be(e,t,r,n=null){var e=new Date(e),i={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"},n=(n&&(i.timeZone=n),{timeZoneName:t,...i}),t=new Intl.DateTimeFormat(r,n).formatToParts(e).find(e=>"timezonename"===e.type.toLowerCase());return t?t.value:null}function je(e,t){let r=parseInt(e,10);Number.isNaN(r)&&(r=0);e=parseInt(t,10)||0;return 60*r+(r<0||Object.is(r,-0)?-e:e)}function ze(e){var t=Number(e);if("boolean"==typeof e||""===e||Number.isNaN(t))throw new u("Invalid unit value "+e);return t}function Ye(e,t){var r={};for(const i in e)if(h(e,i)){var n=e[i];if(null==n)continue;r[t(i)]=ze(n)}return r}function Ge(e,t){var r=Math.trunc(Math.abs(e/60)),n=Math.trunc(Math.abs(e%60)),i=0<=e?"+":"-";switch(t){case"short":return i+p(r,2)+":"+p(n,2);case"narrow":return i+r+(0<n?":"+n:"");case"techie":return i+p(r,2)+p(n,2);default:throw new RangeError(`Value format ${t} is out of range for property format`)}}function qe(e){return r=e,["hour","minute","second","millisecond"].reduce((e,t)=>(e[t]=r[t],e),{});var r}const Ke=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/,Xe=["January","February","March","April","May","June","July","August","September","October","November","December"],Je=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Ze=["J","F","M","A","M","J","J","A","S","O","N","D"];function Qe(e){switch(e){case"narrow":return[...Ze];case"short":return[...Je];case"long":return[...Xe];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}const et=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],tt=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],rt=["M","T","W","T","F","S","S"];function nt(e){switch(e){case"narrow":return[...rt];case"short":return[...tt];case"long":return[...et];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}const it=["AM","PM"],ot=["Before Christ","Anno Domini"],st=["BC","AD"],at=["B","A"];function lt(e){switch(e){case"narrow":return[...at];case"short":return[...st];case"long":return[...ot];default:return null}}function ct(e,t){let r="";for(const n of e)n.literal?r+=n.val:r+=t(n.val);return r}const ut={D:ue,DD:de,DDD:pe,DDDD:fe,t:ge,tt:me,ttt:ye,tttt:ve,T:be,TT:we,TTT:Ce,TTTT:Ee,f:Te,ff:_e,fff:Ae,ffff:Oe,F:Se,FF:xe,FFF:Ne,FFFF:Ie};class v{static create(e,t={}){return new v(e,t)}static parseFormat(t){let r=null,n="",i=!1;var o=[];for(let e=0;e<t.length;e++){var s=t.charAt(e);"'"===s?(0<n.length&&o.push({literal:i,val:n}),r=null,n="",i=!i):i||s===r?n+=s:(0<n.length&&o.push({literal:!1,val:n}),n=s,r=s)}return 0<n.length&&o.push({literal:i,val:n}),o}static macroTokenToFormatOpts(e){return ut[e]}constructor(e,t){this.opts=t,this.loc=e,this.systemLoc=null}formatWithSystemDefault(e,t){return null===this.systemLoc&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(e,{...this.opts,...t}).format()}formatDateTime(e,t={}){return this.loc.dtFormatter(e,{...this.opts,...t}).format()}formatDateTimeParts(e,t={}){return this.loc.dtFormatter(e,{...this.opts,...t}).formatToParts()}resolvedOptions(e,t={}){return this.loc.dtFormatter(e,{...this.opts,...t}).resolvedOptions()}num(e,t=0){var r;return this.opts.forceSimple?p(e,t):(r={...this.opts},0<t&&(r.padTo=t),this.loc.numberFormatter(r).format(e))}formatDateTimeFromString(n,e){const i="en"===this.loc.listingMode(),r=this.loc.outputCalendar&&"gregory"!==this.loc.outputCalendar,o=(e,t)=>this.loc.extract(n,e,t),s=e=>n.isOffsetFixed&&0===n.offset&&e.allowZ?"Z":n.isValid?n.zone.formatOffset(n.ts,e.format):"",a=(e,t)=>{return i?(r=n,Qe(e)[r.month-1]):o(t?{month:e}:{month:e,day:"numeric"},"month");var r},l=(e,t)=>{return i?(r=n,nt(e)[r.weekday-1]):o(t?{weekday:e}:{weekday:e,month:"long",day:"numeric"},"weekday");var r},c=e=>{var t=v.macroTokenToFormatOpts(e);return t?this.formatWithSystemDefault(n,t):e},u=e=>{return i?(t=n,lt(e)[t.year<0?0:1]):o({era:e},"era");var t};return ct(v.parseFormat(e),e=>{switch(e){case"S":return this.num(n.millisecond);case"u":case"SSS":return this.num(n.millisecond,3);case"s":return this.num(n.second);case"ss":return this.num(n.second,2);case"uu":return this.num(Math.floor(n.millisecond/10),2);case"uuu":return this.num(Math.floor(n.millisecond/100));case"m":return this.num(n.minute);case"mm":return this.num(n.minute,2);case"h":return this.num(n.hour%12==0?12:n.hour%12);case"hh":return this.num(n.hour%12==0?12:n.hour%12,2);case"H":return this.num(n.hour);case"HH":return this.num(n.hour,2);case"Z":return s({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return s({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return s({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return n.zone.offsetName(n.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return n.zone.offsetName(n.ts,{format:"long",locale:this.loc.locale});case"z":return n.zoneName;case"a":return i?(t=n,it[t.hour<12?0:1]):o({hour:"numeric",hourCycle:"h12"},"dayperiod");case"d":return r?o({day:"numeric"},"day"):this.num(n.day);case"dd":return r?o({day:"2-digit"},"day"):this.num(n.day,2);case"c":case"E":return this.num(n.weekday);case"ccc":return l("short",!0);case"cccc":return l("long",!0);case"ccccc":return l("narrow",!0);case"EEE":return l("short",!1);case"EEEE":return l("long",!1);case"EEEEE":return l("narrow",!1);case"L":return r?o({month:"numeric",day:"numeric"},"month"):this.num(n.month);case"LL":return r?o({month:"2-digit",day:"numeric"},"month"):this.num(n.month,2);case"LLL":return a("short",!0);case"LLLL":return a("long",!0);case"LLLLL":return a("narrow",!0);case"M":return r?o({month:"numeric"},"month"):this.num(n.month);case"MM":return r?o({month:"2-digit"},"month"):this.num(n.month,2);case"MMM":return a("short",!1);case"MMMM":return a("long",!1);case"MMMMM":return a("narrow",!1);case"y":return r?o({year:"numeric"},"year"):this.num(n.year);case"yy":return r?o({year:"2-digit"},"year"):this.num(n.year.toString().slice(-2),2);case"yyyy":return r?o({year:"numeric"},"year"):this.num(n.year,4);case"yyyyyy":return r?o({year:"numeric"},"year"):this.num(n.year,6);case"G":return u("short");case"GG":return u("long");case"GGGGG":return u("narrow");case"kk":return this.num(n.weekYear.toString().slice(-2),2);case"kkkk":return this.num(n.weekYear,4);case"W":return this.num(n.weekNumber);case"WW":return this.num(n.weekNumber,2);case"o":return this.num(n.ordinal);case"ooo":return this.num(n.ordinal,3);case"q":return this.num(n.quarter);case"qq":return this.num(n.quarter,2);case"X":return this.num(Math.floor(n.ts/1e3));case"x":return this.num(n.ts);default:return c(e)}var t})}formatDurationFromString(e,t){const r=e=>{switch(e[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},n=v.parseFormat(t),i=n.reduce((e,{literal:t,val:r})=>t?e:e.concat(r),[]);return ct(n,(o=e.shiftTo(...i.map(r).filter(e=>e)),e=>{var t=r(e);return t?this.num(o.get(t),e.length):e}));var o}}class b{constructor(e,t){this.reason=e,this.explanation=t}toMessage(){return this.explanation?this.reason+": "+this.explanation:this.reason}}class dt{get type(){throw new r}get name(){throw new r}get ianaName(){return this.name}get isUniversal(){throw new r}offsetName(e,t){throw new r}formatOffset(e,t){throw new r}offset(e){throw new r}equals(e){throw new r}get isValid(){throw new r}}let ht=null;class pt extends dt{static get instance(){return ht=null===ht?new pt:ht}get type(){return"system"}get name(){return(new Intl.DateTimeFormat).resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(e,{format:t,locale:r}){return Be(e,t,r)}formatOffset(e,t){return Ge(this.offset(e),t)}offset(e){return-new Date(e).getTimezoneOffset()}equals(e){return"system"===e.type}get isValid(){return!0}}let ft={};const gt={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};let mt={};class w extends dt{static create(e){return mt[e]||(mt[e]=new w(e)),mt[e]}static resetCache(){mt={},ft={}}static isValidSpecifier(e){return this.isValidZone(e)}static isValidZone(e){if(!e)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:e}).format(),!0}catch(e){return!1}}constructor(e){super(),this.zoneName=e,this.valid=w.isValidZone(e)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(e,{format:t,locale:r}){return Be(e,t,r,this.name)}formatOffset(e,t){return Ge(this.offset(e),t)}offset(e){var a=new Date(e);if(isNaN(a))return NaN;e=this.name,ft[e]||(ft[e]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:e,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"}));var l=ft[e];let[t,r,n,i,o,s,c]=l.formatToParts?function(t){var r=l.formatToParts(t),n=[];for(let e=0;e<r.length;e++){const{type:t,value:i}=r[e],o=gt[t];"era"===t?n[o]=i:y(o)||(n[o]=parseInt(i,10))}return n}(a):function(){var e=l.format(a).replace(/\u200E/g,""),[,e,t,r,n,i,o,s]=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(e);return[r,e,t,n,i,o,s]}();"BC"===i&&(t=1-Math.abs(t));var e=+a,u=e%1e3;return e-=0<=u?u:1e3+u,(Ve({year:t,month:r,day:n,hour:24===o?0:o,minute:s,second:c,millisecond:0})-e)/6e4}equals(e){return"iana"===e.type&&e.name===this.name}get isValid(){return this.valid}}let yt=null;class C extends dt{static get utcInstance(){return yt=null===yt?new C(0):yt}static instance(e){return 0===e?C.utcInstance:new C(e)}static parseSpecifier(e){if(e){e=e.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(e)return new C(je(e[1],e[2]))}return null}constructor(e){super(),this.fixed=e}get type(){return"fixed"}get name(){return 0===this.fixed?"UTC":"UTC"+Ge(this.fixed,"narrow")}get ianaName(){return 0===this.fixed?"Etc/UTC":"Etc/GMT"+Ge(-this.fixed,"narrow")}offsetName(){return this.name}formatOffset(e,t){return Ge(this.fixed,t)}get isUniversal(){return!0}offset(){return this.fixed}equals(e){return"fixed"===e.type&&e.fixed===this.fixed}get isValid(){return!0}}class vt extends dt{constructor(e){super(),this.zoneName=e}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}function E(e,t){var r;return y(e)||null===e?t:e instanceof dt?e:"string"==typeof e?"default"===(r=e.toLowerCase())?t:"local"===r||"system"===r?pt.instance:"utc"===r||"gmt"===r?C.utcInstance:C.parseSpecifier(r)||w.create(e):d(e)?C.instance(e):"object"==typeof e&&e.offset&&"number"==typeof e.offset?e:new vt(e)}let bt,wt=()=>Date.now(),Ct="system",Et=null,Tt=null,St=null;class T{static get now(){return wt}static set now(e){wt=e}static set defaultZone(e){Ct=e}static get defaultZone(){return E(Ct,pt.instance)}static get defaultLocale(){return Et}static set defaultLocale(e){Et=e}static get defaultNumberingSystem(){return Tt}static set defaultNumberingSystem(e){Tt=e}static get defaultOutputCalendar(){return St}static set defaultOutputCalendar(e){St=e}static get throwOnInvalid(){return bt}static set throwOnInvalid(e){bt=e}static resetCaches(){S.resetCache(),w.resetCache()}}let _t={},xt={};function Rt(e,t={}){var r=JSON.stringify([e,t]);let n=xt[r];return n||(n=new Intl.DateTimeFormat(e,t),xt[r]=n),n}let At={},Nt={},Ot=null;function It(e,t,r,n,i){e=e.listingMode(r);return"error"===e?null:("en"===e?n:i)(t)}class Mt{constructor(e,t,r){this.padTo=r.padTo||0,this.floor=r.floor||!1;const{padTo:n,floor:i,...o}=r;if(!t||0<Object.keys(o).length){const t={useGrouping:!1,...r};0<r.padTo&&(t.minimumIntegerDigits=r.padTo),this.inf=function(e,t={}){var r=JSON.stringify([e,t]);let n=At[r];return n||(n=new Intl.NumberFormat(e,t),At[r]=n),n}(e,t)}}format(e){var t;return this.inf?(t=this.floor?Math.floor(e):e,this.inf.format(t)):p(this.floor?Math.floor(e):Le(e,3),this.padTo)}}class kt{constructor(e,t,r){let n;if(this.opts=r,e.zone.isUniversal){const t=e.offset/60*-1,i=0<=t?"Etc/GMT+"+t:"Etc/GMT"+t;0!==e.offset&&w.create(i).valid?(n=i,this.dt=e):(n="UTC",r.timeZoneName?this.dt=e:this.dt=0===e.offset?e:P.fromMillis(e.ts+60*e.offset*1e3))}else"system"===e.zone.type?this.dt=e:(this.dt=e,n=e.zone.name);const i={...this.opts};n&&(i.timeZone=n),this.dtf=Rt(t,i)}format(){return this.dtf.format(this.dt.toJSDate())}formatToParts(){return this.dtf.formatToParts(this.dt.toJSDate())}resolvedOptions(){return this.dtf.resolvedOptions()}}class Dt{constructor(e,t,r){this.opts={style:"long",...r},!t&&ke()&&(this.rtf=function(e,t={}){const{base:r,...n}=t,i=JSON.stringify([e,n]);let o=Nt[i];return o||(o=new Intl.RelativeTimeFormat(e,t),Nt[i]=o),o}(e,r))}format(e,t){if(this.rtf)return this.rtf.format(e,t);var[r,t,n="always",e]=[t,e,this.opts.numeric,"long"!==this.opts.style],i={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},o=-1===["hours","minutes","seconds"].indexOf(r);if("auto"===n&&o){const n="days"===r;switch(t){case 1:return n?"tomorrow":"next "+i[r][0];case-1:return n?"yesterday":"last "+i[r][0];case 0:return n?"today":"this "+i[r][0]}}var n=Object.is(t,-0)||t<0,t=1===(o=Math.abs(t)),s=i[r],e=e?!t&&s[2]||s[1]:t?i[r][0]:r;return n?o+` ${e} ago`:`in ${o} `+e}formatToParts(e,t){return this.rtf?this.rtf.formatToParts(e,t):[]}}class S{static fromOpts(e){return S.create(e.locale,e.numberingSystem,e.outputCalendar,e.defaultToEN)}static create(e,t,r,n=!1){e=e||T.defaultLocale,n=e||(n?"en-US":Ot||(Ot=(new Intl.DateTimeFormat).resolvedOptions().locale)),t=t||T.defaultNumberingSystem,r=r||T.defaultOutputCalendar;return new S(n,t,r,e)}static resetCache(){Ot=null,xt={},At={},Nt={}}static fromObject({locale:e,numberingSystem:t,outputCalendar:r}={}){return S.create(e,t,r)}constructor(e,t,r,n){var[e,i,o]=function(t){var r=t.indexOf("-u-");if(-1===r)return[t];{let e;r=t.substring(0,r);try{e=Rt(t).resolvedOptions()}catch(t){e=Rt(r).resolvedOptions()}var{numberingSystem:n,calendar:i}=e;return[r,n,i]}}(e);this.locale=e,this.numberingSystem=t||i||null,this.outputCalendar=r||o||null,this.intl=(e=this.locale,t=this.numberingSystem,((i=this.outputCalendar)||t)&&(e+="-u",i&&(e+="-ca-"+i),t)&&(e+="-nu-"+t),e),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=n,this.fastNumbersCached=null}get fastNumbers(){return null==this.fastNumbersCached&&(this.fastNumbersCached=(!this.numberingSystem||"latn"===this.numberingSystem)&&("latn"===this.numberingSystem||!this.locale||this.locale.startsWith("en")||"latn"===new Intl.DateTimeFormat(this.intl).resolvedOptions().numberingSystem)),this.fastNumbersCached}listingMode(){var e=this.isEnglish(),t=!(null!==this.numberingSystem&&"latn"!==this.numberingSystem||null!==this.outputCalendar&&"gregory"!==this.outputCalendar);return e&&t?"en":"intl"}clone(e){return e&&0!==Object.getOwnPropertyNames(e).length?S.create(e.locale||this.specifiedLocale,e.numberingSystem||this.numberingSystem,e.outputCalendar||this.outputCalendar,e.defaultToEN||!1):this}redefaultToEN(e={}){return this.clone({...e,defaultToEN:!0})}redefaultToSystem(e={}){return this.clone({...e,defaultToEN:!1})}months(r,n=!1,e=!0){return It(this,r,e,Qe,()=>{const t=n?{month:r,day:"numeric"}:{month:r},e=n?"format":"standalone";return this.monthsCache[e][r]||(this.monthsCache[e][r]=function(t){var r=[];for(let e=1;e<=12;e++){var n=P.utc(2016,e,1);r.push(t(n))}return r}(e=>this.extract(e,t,"month"))),this.monthsCache[e][r]})}weekdays(r,n=!1,e=!0){return It(this,r,e,nt,()=>{const t=n?{weekday:r,year:"numeric",month:"long",day:"numeric"}:{weekday:r},e=n?"format":"standalone";return this.weekdaysCache[e][r]||(this.weekdaysCache[e][r]=function(t){var r=[];for(let e=1;e<=7;e++){var n=P.utc(2016,11,13+e);r.push(t(n))}return r}(e=>this.extract(e,t,"weekday"))),this.weekdaysCache[e][r]})}meridiems(e=!0){return It(this,void 0,e,()=>it,()=>{if(!this.meridiemCache){const t={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[P.utc(2016,11,13,9),P.utc(2016,11,13,19)].map(e=>this.extract(e,t,"dayperiod"))}return this.meridiemCache})}eras(e,t=!0){return It(this,e,t,lt,()=>{const t={era:e};return this.eraCache[e]||(this.eraCache[e]=[P.utc(-40,1,1),P.utc(2017,1,1)].map(e=>this.extract(e,t,"era"))),this.eraCache[e]})}extract(e,t,r){e=this.dtFormatter(e,t).formatToParts().find(e=>e.type.toLowerCase()===r);return e?e.value:null}numberFormatter(e={}){return new Mt(this.intl,e.forceSimple||this.fastNumbers,e)}dtFormatter(e,t={}){return new kt(e,this.intl,t)}relFormatter(e={}){return new Dt(this.intl,this.isEnglish(),e)}listFormatter(t={}){{var[t,r={}]=[this.intl,t],n=JSON.stringify([t,r]);let e=_t[n];return e||(e=new Intl.ListFormat(t,r),_t[n]=e),e}}isEnglish(){return"en"===this.locale||"en-us"===this.locale.toLowerCase()||new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")}equals(e){return this.locale===e.locale&&this.numberingSystem===e.numberingSystem&&this.outputCalendar===e.outputCalendar}}function _(...e){e=e.reduce((e,t)=>e+t.source,"");return RegExp(`^${e}$`)}function x(...e){return o=>e.reduce(([e,t,r],n)=>{var[n,r,i]=n(o,r);return[{...e,...n},r||t,i]},[{},null,1]).slice(0,2)}function Pt(e,...t){if(null!=e)for(var[r,n]of t){const t=r.exec(e);if(t)return n(t)}return[null,null]}function Lt(...i){return(e,t)=>{var r={};let n;for(n=0;n<i.length;n++)r[i[n]]=f(e[t+n]);return[r,null,t+n]}}var Ft=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,Ht=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,Ut=RegExp(Ht.source+`(?:${Ft.source}?(?:\\[(${Ke.source})\\])?)?`),Vt=RegExp(`(?:T${Ut.source})?`),Wt=Lt("weekYear","weekNumber","weekDay"),$t=Lt("year","ordinal"),Ft=RegExp(Ht.source+` ?(?:${Ft.source}|(${Ke.source}))?`),Bt=RegExp(`(?: ${Ft.source})?`);function jt(e,t,r){e=e[t];return y(e)?r:f(e)}function zt(e,t){return[{hours:jt(e,t,0),minutes:jt(e,t+1,0),seconds:jt(e,t+2,0),milliseconds:Pe(e[t+3])},null,t+4]}function Yt(e,t){var r=!e[t]&&!e[t+1],e=je(e[t+1],e[t+2]);return[{},r?null:C.instance(e),t+3]}function Gt(e,t){return[{},e[t]?w.create(e[t]):null,t+1]}const qt=RegExp(`^T?${Ht.source}$`),Kt=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function Xt(e){const[t,r,n,i,o,s,a,l,c]=e,u="-"===t[0],d=l&&"-"===l[0],h=(e,t=!1)=>void 0!==e&&(t||e&&u)?-e:e;return[{years:h(g(r)),months:h(g(n)),weeks:h(g(i)),days:h(g(o)),hours:h(g(s)),minutes:h(g(a)),seconds:h(g(l),"-0"===l),milliseconds:h(Pe(c),d)}]}const Jt={GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function Zt(e,t,r,n,i,o,s){t={year:2===t.length?$e(f(t)):f(t),month:Je.indexOf(r)+1,day:f(n),hour:f(i),minute:f(o)};return s&&(t.second=f(s)),e&&(t.weekday=3<e.length?et.indexOf(e)+1:tt.indexOf(e)+1),t}const Qt=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function er(e){var[,e,t,r,n,i,o,s,a,l,c,u]=e,e=Zt(e,n,r,t,i,o,s),n=a?Jt[a]:l?0:je(c,u);return[e,new C(n)]}const tr=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,rr=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,nr=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function ir(e){var[,e,t,r,n,i,o,s]=e;return[Zt(e,n,r,t,i,o,s),C.utcInstance]}function or(e){var[,e,t,r,n,i,o,s]=e;return[Zt(e,s,t,r,n,i,o),C.utcInstance]}const sr=_(/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,Vt),ar=_(/(\d{4})-?W(\d\d)(?:-?(\d))?/,Vt),lr=_(/(\d{4})-?(\d{3})/,Vt),cr=_(Ut),ur=x(function(e,t){return[{year:jt(e,t),month:jt(e,t+1,1),day:jt(e,t+2,1)},null,t+3]},zt,Yt,Gt),dr=x(Wt,zt,Yt,Gt),hr=x($t,zt,Yt,Gt),pr=x(zt,Yt,Gt),fr=x(zt),gr=_(/(\d{4})-(\d\d)-(\d\d)/,Bt),mr=_(Ft),yr=x(zt,Yt,Gt),vr={weeks:{days:7,hours:168,minutes:10080,seconds:604800,milliseconds:6048e5},days:{hours:24,minutes:1440,seconds:86400,milliseconds:864e5},hours:{minutes:60,seconds:3600,milliseconds:36e5},minutes:{seconds:60,milliseconds:6e4},seconds:{milliseconds:1e3}},br={years:{quarters:4,months:12,weeks:52,days:365,hours:8760,minutes:525600,seconds:31536e3,milliseconds:31536e6},quarters:{months:3,weeks:13,days:91,hours:2184,minutes:131040,seconds:7862400,milliseconds:78624e5},months:{weeks:4,days:30,hours:720,minutes:43200,seconds:2592e3,milliseconds:2592e6},...vr},wr={years:{quarters:4,months:12,weeks:52.1775,days:365.2425,hours:8765.82,minutes:525949.2,seconds:525949.2*60,milliseconds:525949.2*60*1e3},quarters:{months:3,weeks:13.044375,days:91.310625,hours:2191.455,minutes:131487.3,seconds:525949.2*60/4,milliseconds:7889237999.999999},months:{weeks:4.3481250000000005,days:30.436875,hours:730.485,minutes:43829.1,seconds:2629746,milliseconds:2629746e3},...vr},R=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],Cr=R.slice(0).reverse();function A(e,t,r=!1){r={values:r?t.values:{...e.values,...t.values||{}},loc:e.loc.clone(t.loc),conversionAccuracy:t.conversionAccuracy||e.conversionAccuracy};return new N(r)}function Er(e,t,r,n,i){var e=e[i][r],o=t[r]/e,s=Math.sign(o)!==Math.sign(n[i])&&0!==n[i]&&Math.abs(o)<=1?(s=o)<0?Math.floor(s):Math.ceil(s):Math.trunc(o);n[i]+=s,t[r]-=s*e}class N{constructor(e){var t="longterm"===e.conversionAccuracy||!1;this.values=e.values,this.loc=e.loc||S.create(),this.conversionAccuracy=t?"longterm":"casual",this.invalid=e.invalid||null,this.matrix=t?wr:br,this.isLuxonDuration=!0}static fromMillis(e,t){return N.fromObject({milliseconds:e},t)}static fromObject(e,t={}){if(null==e||"object"!=typeof e)throw new u("Duration.fromObject: argument expected to be an object, got "+(null===e?"null":typeof e));return new N({values:Ye(e,N.normalizeUnit),loc:S.fromObject(t),conversionAccuracy:t.conversionAccuracy})}static fromDurationLike(e){if(d(e))return N.fromMillis(e);if(N.isDuration(e))return e;if("object"==typeof e)return N.fromObject(e);throw new u(`Unknown duration argument ${e} of type `+typeof e)}static fromISO(e,t){var[r]=Pt(e,[Kt,Xt]);return r?N.fromObject(r,t):N.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static fromISOTime(e,t){var[r]=Pt(e,[qt,fr]);return r?N.fromObject(r,t):N.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static invalid(e,t=null){if(!e)throw new u("need to specify a reason the Duration is invalid");e=e instanceof b?e:new b(e,t);if(T.throwOnInvalid)throw new ae(e);return new N({invalid:e})}static normalizeUnit(e){var t={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[e&&e.toLowerCase()];if(t)return t;throw new ce(e)}static isDuration(e){return e&&e.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(e,t={}){t={...t,floor:!1!==t.round&&!1!==t.floor};return this.isValid?v.create(this.loc,t).formatDurationFromString(this,e):"Invalid Duration"}toHuman(r={}){var e=R.map(e=>{var t=this.values[e];return y(t)?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...r,unit:e.slice(0,-1)}).format(t)}).filter(e=>e);return this.loc.listFormatter({type:"conjunction",style:r.listStyle||"narrow",...r}).format(e)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let e="P";return 0!==this.years&&(e+=this.years+"Y"),0===this.months&&0===this.quarters||(e+=this.months+3*this.quarters+"M"),0!==this.weeks&&(e+=this.weeks+"W"),0!==this.days&&(e+=this.days+"D"),0===this.hours&&0===this.minutes&&0===this.seconds&&0===this.milliseconds||(e+="T"),0!==this.hours&&(e+=this.hours+"H"),0!==this.minutes&&(e+=this.minutes+"M"),0===this.seconds&&0===this.milliseconds||(e+=Le(this.seconds+this.milliseconds/1e3,3)+"S"),"P"===e&&(e+="T0S"),e}toISOTime(e={}){if(!this.isValid)return null;var t=this.toMillis();if(t<0||864e5<=t)return null;e={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...e};t=this.shiftTo("hours","minutes","seconds","milliseconds");let r="basic"===e.format?"hhmm":"hh:mm",n=(e.suppressSeconds&&0===t.seconds&&0===t.milliseconds||(r+="basic"===e.format?"ss":":ss",e.suppressMilliseconds&&0===t.milliseconds)||(r+=".SSS"),t.toFormat(r));return n=e.includePrefix?"T"+n:n}toJSON(){return this.toISO()}toString(){return this.toISO()}toMillis(){return this.as("milliseconds")}valueOf(){return this.toMillis()}plus(e){if(!this.isValid)return this;var t=N.fromDurationLike(e),r={};for(const e of R)(h(t.values,e)||h(this.values,e))&&(r[e]=t.get(e)+this.get(e));return A(this,{values:r},!0)}minus(e){return this.isValid?(e=N.fromDurationLike(e),this.plus(e.negate())):this}mapUnits(e){if(!this.isValid)return this;var t={};for(const r of Object.keys(this.values))t[r]=ze(e(this.values[r],r));return A(this,{values:t},!0)}get(e){return this[N.normalizeUnit(e)]}set(e){return this.isValid?A(this,{values:{...this.values,...Ye(e,N.normalizeUnit)}}):this}reconfigure({locale:e,numberingSystem:t,conversionAccuracy:r}={}){e={loc:this.loc.clone({locale:e,numberingSystem:t})};return r&&(e.conversionAccuracy=r),A(this,e)}as(e){return this.isValid?this.shiftTo(e).get(e):NaN}normalize(){var e,r,n;return this.isValid?(e=this.toObject(),r=this.matrix,n=e,Cr.reduce((e,t)=>y(n[t])?e:(e&&Er(r,n,e,n,t),t),null),A(this,{values:e},!0)):this}shiftTo(...t){if(!this.isValid)return this;if(0===t.length)return this;t=t.map(e=>N.normalizeUnit(e));const r={},n={},i=this.toObject();let o;for(const a of R)if(0<=t.indexOf(a)){o=a;let e=0;for(const r in n)e+=this.matrix[r][a]*n[r],n[r]=0;d(i[a])&&(e+=i[a]);var s=Math.trunc(e);r[a]=s,n[a]=(1e3*e-1e3*s)/1e3;for(const t in i)R.indexOf(t)>R.indexOf(a)&&Er(this.matrix,i,t,r,a)}else d(i[a])&&(n[a]=i[a]);for(const t in n)0!==n[t]&&(r[o]+=t===o?n[t]:n[t]/this.matrix[o][t]);return A(this,{values:r},!0).normalize()}negate(){if(!this.isValid)return this;var e={};for(const t of Object.keys(this.values))e[t]=0===this.values[t]?0:-this.values[t];return A(this,{values:e},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return null===this.invalid}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(e){if(!this.isValid||!e.isValid)return!1;if(!this.loc.equals(e.loc))return!1;for(const n of R)if(t=this.values[n],r=e.values[n],!(void 0===t||0===t?void 0===r||0===r:t===r))return!1;var t,r;return!0}}const Tr="Invalid Interval";class O{constructor(e){this.s=e.start,this.e=e.end,this.invalid=e.invalid||null,this.isLuxonInterval=!0}static invalid(e,t=null){if(!e)throw new u("need to specify a reason the Interval is invalid");e=e instanceof b?e:new b(e,t);if(T.throwOnInvalid)throw new se(e);return new O({invalid:e})}static fromDateTimes(e,t){var r,e=bn(e),t=bn(t),n=(r=t,(n=e)&&n.isValid?r&&r.isValid?r<n?O.invalid("end before start",`The end of an interval must be after its start, but you had start=${n.toISO()} and end=`+r.toISO()):null:O.invalid("missing or invalid end"):O.invalid("missing or invalid start"));return null==n?new O({start:e,end:t}):n}static after(e,t){t=N.fromDurationLike(t),e=bn(e);return O.fromDateTimes(e,e.plus(t))}static before(e,t){t=N.fromDurationLike(t),e=bn(e);return O.fromDateTimes(e.minus(t),e)}static fromISO(i,o){const[s,a]=(i||"").split("/",2);if(s&&a){let e,t,r,n;try{e=P.fromISO(s,o),t=e.isValid}catch(a){t=!1}try{r=P.fromISO(a,o),n=r.isValid}catch(a){n=!1}if(t&&n)return O.fromDateTimes(e,r);if(t){const s=N.fromISO(a,o);if(s.isValid)return O.after(e,s)}else if(n){const i=N.fromISO(s,o);if(i.isValid)return O.before(r,i)}}return O.invalid("unparsable",`the input "${i}" can't be parsed as ISO 8601`)}static isInterval(e){return e&&e.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get isValid(){return null===this.invalidReason}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(e="milliseconds"){return this.isValid?this.toDuration(e).get(e):NaN}count(e="milliseconds"){var t,r;return this.isValid?(t=this.start.startOf(e),r=this.end.startOf(e),Math.floor(r.diff(t,e).get(e))+1):NaN}hasSame(e){return!!this.isValid&&(this.isEmpty()||this.e.minus(1).hasSame(this.s,e))}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(e){return!!this.isValid&&this.s>e}isBefore(e){return!!this.isValid&&this.e<=e}contains(e){return!!this.isValid&&this.s<=e&&this.e>e}set({start:e,end:t}={}){return this.isValid?O.fromDateTimes(e||this.s,t||this.e):this}splitAt(...e){if(!this.isValid)return[];var t=e.map(bn).filter(e=>this.contains(e)).sort(),r=[];let n=this["s"],i=0;for(;n<this.e;){const e=t[i]||this.e,o=+e>+this.e?this.e:e;r.push(O.fromDateTimes(n,o)),n=o,i+=1}return r}splitBy(e){var t=N.fromDurationLike(e);if(!this.isValid||!t.isValid||0===t.as("milliseconds"))return[];let r,n=this["s"],i=1;for(var o=[];n<this.e;){const e=this.start.plus(t.mapUnits(e=>e*i));r=+e>+this.e?this.e:e,o.push(O.fromDateTimes(n,r)),n=r,i+=1}return o}divideEqually(e){return this.isValid?this.splitBy(this.length()/e).slice(0,e):[]}overlaps(e){return this.e>e.s&&this.s<e.e}abutsStart(e){return!!this.isValid&&+this.e==+e.s}abutsEnd(e){return!!this.isValid&&+e.e==+this.s}engulfs(e){return!!this.isValid&&this.s<=e.s&&this.e>=e.e}equals(e){return!(!this.isValid||!e.isValid)&&this.s.equals(e.s)&&this.e.equals(e.e)}intersection(e){var t;return this.isValid?(t=(this.s>e.s?this:e).s,(e=(this.e<e.e?this:e).e)<=t?null:O.fromDateTimes(t,e)):this}union(e){var t;return this.isValid?(t=(this.s<e.s?this:e).s,e=(this.e>e.e?this:e).e,O.fromDateTimes(t,e)):this}static merge(e){var[e,t]=e.sort((e,t)=>e.s-t.s).reduce(([e,t],r)=>t?t.overlaps(r)||t.abutsStart(r)?[e,t.union(r)]:[e.concat([t]),r]:[e,r],[[],null]);return t&&e.push(t),e}static xor(e){let t=null,r=0;var n=[],i=e.map(e=>[{time:e.s,type:"s"},{time:e.e,type:"e"}]);for(const e of Array.prototype.concat(...i).sort((e,t)=>e.time-t.time))r+="s"===e.type?1:-1,t=1===r?e.time:(t&&+t!=+e.time&&n.push(O.fromDateTimes(t,e.time)),null);return O.merge(n)}difference(...e){return O.xor([this].concat(e)).map(e=>this.intersection(e)).filter(e=>e&&!e.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()} – ${this.e.toISO()})`:Tr}toISO(e){return this.isValid?this.s.toISO(e)+"/"+this.e.toISO(e):Tr}toISODate(){return this.isValid?this.s.toISODate()+"/"+this.e.toISODate():Tr}toISOTime(e){return this.isValid?this.s.toISOTime(e)+"/"+this.e.toISOTime(e):Tr}toFormat(e,{separator:t=" – "}={}){return this.isValid?""+this.s.toFormat(e)+t+this.e.toFormat(e):Tr}toDuration(e,t){return this.isValid?this.e.diff(this.s,e,t):N.invalid(this.invalidReason)}mapEndpoints(e){return O.fromDateTimes(e(this.s),e(this.e))}}class Sr{static hasDST(e=T.defaultZone){var t=P.now().setZone(e).set({month:12});return!e.isUniversal&&t.offset!==t.set({month:6}).offset}static isValidIANAZone(e){return w.isValidZone(e)}static normalizeZone(e){return E(e,T.defaultZone)}static months(e="long",{locale:t=null,numberingSystem:r=null,locObj:n=null,outputCalendar:i="gregory"}={}){return(n||S.create(t,r,i)).months(e)}static monthsFormat(e="long",{locale:t=null,numberingSystem:r=null,locObj:n=null,outputCalendar:i="gregory"}={}){return(n||S.create(t,r,i)).months(e,!0)}static weekdays(e="long",{locale:t=null,numberingSystem:r=null,locObj:n=null}={}){return(n||S.create(t,r,null)).weekdays(e)}static weekdaysFormat(e="long",{locale:t=null,numberingSystem:r=null,locObj:n=null}={}){return(n||S.create(t,r,null)).weekdays(e,!0)}static meridiems({locale:e=null}={}){return S.create(e).meridiems()}static eras(e="short",{locale:t=null}={}){return S.create(t,null,"gregory").eras(e)}static features(){return{relative:ke()}}}function _r(e,t){var r=e=>e.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),t=r(t)-r(e);return Math.floor(N.fromMillis(t).as("days"))}const xr={arab:"[٠-٩]",arabext:"[۰-۹]",bali:"[᭐-᭙]",beng:"[০-৯]",deva:"[०-९]",fullwide:"[０-９]",gujr:"[૦-૯]",hanidec:"[〇|一|二|三|四|五|六|七|八|九]",khmr:"[០-៩]",knda:"[೦-೯]",laoo:"[໐-໙]",limb:"[᥆-᥏]",mlym:"[൦-൯]",mong:"[᠐-᠙]",mymr:"[၀-၉]",orya:"[୦-୯]",tamldec:"[௦-௯]",telu:"[౦-౯]",thai:"[๐-๙]",tibt:"[༠-༩]",latn:"\\d"},Rr={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},Ar=xr.hanidec.replace(/[\[|\]]/g,"").split("");function I({numberingSystem:e},t=""){return new RegExp(""+xr[e||"latn"]+t)}function M(e,t=e=>e){return{regex:e,deser:([e])=>t(function(t){let r=parseInt(t,10);if(isNaN(r)){r="";for(let e=0;e<t.length;e++){var n=t.charCodeAt(e);if(-1!==t[e].search(xr.hanidec))r+=Ar.indexOf(t[e]);else for(const t in Rr){var[i,o]=Rr[t];i<=n&&n<=o&&(r+=n-i)}}return parseInt(r,10)}return r}(e))}}const Nr=`[ ${String.fromCharCode(160)}]`,Or=new RegExp(Nr,"g");function Ir(e){return e.replace(/\./g,"\\.?").replace(Or,Nr)}function Mr(e){return e.replace(/\./g,"").replace(Or," ").toLowerCase()}function k(e,r){return null===e?null:{regex:RegExp(e.map(Ir).join("|")),deser:([t])=>e.findIndex(e=>Mr(t)===Mr(e))+r}}function kr(e,t){return{regex:e,deser:([,e,t])=>je(e,t),groups:t}}function Dr(e){return{regex:e,deser:([e])=>e}}const Pr={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour:{numeric:"h","2-digit":"hh"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};let Lr=null;function Fr(m,e,t){t=v.parseFormat(t),o=m;const r=Array.prototype.concat(...t.map(e=>{return t=o,(e=e).literal||null==(t=Hr(v.macroTokenToFormatOpts(e.val),t))||t.includes(void 0)?e:t;var t})),n=r.map(e=>{{var t=e,r=m;const n=I(r),i=I(r,"{2}"),o=I(r,"{3}"),s=I(r,"{4}"),a=I(r,"{6}"),l=I(r,"{1,2}"),c=I(r,"{1,3}"),u=I(r,"{1,6}"),d=I(r,"{1,9}"),h=I(r,"{2,4}"),p=I(r,"{4,6}"),f=e=>{return{regex:RegExp(e.val.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")),deser:([e])=>e,literal:!0}},g=(e=>{if(t.literal)return f(e);switch(e.val){case"G":return k(r.eras("short",!1),0);case"GG":return k(r.eras("long",!1),0);case"y":return M(u);case"yy":case"kk":return M(h,$e);case"yyyy":case"kkkk":return M(s);case"yyyyy":return M(p);case"yyyyyy":return M(a);case"M":case"L":case"d":case"H":case"h":case"m":case"q":case"s":case"W":return M(l);case"MM":case"LL":case"dd":case"HH":case"hh":case"mm":case"qq":case"ss":case"WW":return M(i);case"MMM":return k(r.months("short",!0,!1),1);case"MMMM":return k(r.months("long",!0,!1),1);case"LLL":return k(r.months("short",!1,!1),1);case"LLLL":return k(r.months("long",!1,!1),1);case"o":case"S":return M(c);case"ooo":case"SSS":return M(o);case"u":return Dr(d);case"uu":return Dr(l);case"uuu":case"E":case"c":return M(n);case"a":return k(r.meridiems(),0);case"EEE":return k(r.weekdays("short",!1,!1),1);case"EEEE":return k(r.weekdays("long",!1,!1),1);case"ccc":return k(r.weekdays("short",!0,!1),1);case"cccc":return k(r.weekdays("long",!0,!1),1);case"Z":case"ZZ":return kr(new RegExp(`([+-]${l.source})(?::(${i.source}))?`),2);case"ZZZ":return kr(new RegExp(`([+-]${l.source})(${i.source})?`),2);case"z":return Dr(/[a-z_+-/]{1,256}?/i);default:return f(e)}})(t)||{invalidReason:"missing Intl.DateTimeFormat.formatToParts support"};return g.token=t,g}}),i=n.find(e=>e.invalidReason);var o,s;if(i)return{input:e,tokens:r,invalidReason:i.invalidReason};{const[m,t]=[`^${(s=n).map(e=>e.regex).reduce((e,t)=>`${e}(${t.source})`,"")}$`,s],i=RegExp(m,"i"),[a,l]=function(t,e,r){var n,i,o=t.match(e);if(o){const t={};let e=1;for(const s in r)h(r,s)&&(i=(n=r[s]).groups?n.groups+1:1,!n.literal&&n.token&&(t[n.token.val[0]]=n.deser(o.slice(e,e+i))),e+=i);return[o,t]}return[o,{}]}(e,i,t),[c,u,d]=l?function(n){let e,t=null;return y(n.z)||(t=w.create(n.z)),y(n.Z)||(t=t||new C(n.Z),e=n.Z),y(n.q)||(n.M=3*(n.q-1)+1),y(n.h)||(n.h<12&&1===n.a?n.h+=12:12===n.h&&0===n.a&&(n.h=0)),0===n.G&&n.y&&(n.y=-n.y),y(n.u)||(n.S=Pe(n.u)),[Object.keys(n).reduce((e,t)=>{var r=(()=>{switch(t){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}})();return r&&(e[r]=n[t]),e},{}),t,e]}(l):[null,null,void 0];if(h(l,"a")&&h(l,"H"))throw new le("Can't include meridiem when specifying 24-hour format");return{input:e,tokens:r,regex:i,rawMatches:a,matches:l,result:c,zone:u,specificOffset:d}}}function Hr(n,e){return n?v.create(e,n).formatDateTimeParts(Lr=Lr||P.fromMillis(1555555555555)).map(t=>{{var{type:t,value:r}=t;if("literal"===t)return{literal:!0,val:r};r=n[t];let e=Pr[t];return(e="object"==typeof e?e[r]:e)?{literal:!1,val:e}:void 0}}):null}const Ur=[0,31,59,90,120,151,181,212,243,273,304,334],Vr=[0,31,60,91,121,152,182,213,244,274,305,335];function D(e,t){return new b("unit out of range",`you specified ${t} (of type ${typeof t}) as a ${e}, which is invalid`)}function Wr(e,t,r){t=new Date(Date.UTC(e,t-1,r)),e<100&&0<=e&&t.setUTCFullYear(t.getUTCFullYear()-1900),r=t.getUTCDay();return 0===r?7:r}function $r(e,t,r){return r+(Fe(e)?Vr:Ur)[t-1]}function Br(e,t){var e=Fe(e)?Vr:Ur,r=e.findIndex(e=>e<t);return{month:r+1,day:t-e[r]}}function jr(e){var{year:t,month:r,day:n}=e,i=$r(t,r,n),r=Wr(t,r,n);let o,s=Math.floor((i-r+10)/7);return s<1?(o=t-1,s=We(o)):s>We(t)?(o=t+1,s=1):o=t,{weekYear:o,weekNumber:s,weekday:r,...qe(e)}}function zr(e){var{weekYear:t,weekNumber:r,weekday:n}=e,i=Wr(t,1,4),o=He(t);let s,a=7*r+n-i-3;a<1?(s=t-1,a+=He(s)):a>o?(s=t+1,a-=He(t)):s=t;var{month:r,day:n}=Br(s,a);return{year:s,month:r,day:n,...qe(e)}}function Yr(e){var{year:t,month:r,day:n}=e;return{year:t,ordinal:$r(t,r,n),...qe(e)}}function Gr(e){var{year:t,ordinal:r}=e,{month:r,day:n}=Br(t,r);return{year:t,month:r,day:n,...qe(e)}}function qr(e){var t=Me(e.year),r=m(e.month,1,12),n=m(e.day,1,Ue(e.year,e.month));return t?r?!n&&D("day",e.day):D("month",e.month):D("year",e.year)}function Kr(e){var{hour:e,minute:t,second:r,millisecond:n}=e,i=m(e,0,23)||24===e&&0===t&&0===r&&0===n,o=m(t,0,59),s=m(r,0,59),a=m(n,0,999);return i?o?s?!a&&D("millisecond",n):D("second",r):D("minute",t):D("hour",e)}const Xr="Invalid DateTime";function Jr(e){return new b("unsupported zone",`the zone "${e.name}" is not supported`)}function Zr(e){return null===e.weekData&&(e.weekData=jr(e.c)),e.weekData}function Qr(e,t){e={ts:e.ts,zone:e.zone,c:e.c,o:e.o,loc:e.loc,invalid:e.invalid};return new P({...e,...t,old:e})}function en(e,t,r){var n=e-60*t*1e3,i=r.offset(n);return t===i?[n,t]:i===(r=r.offset(n-=60*(i-t)*1e3))?[n,i]:[e-60*Math.min(i,r)*1e3,Math.max(i,r)]}function tn(e,t){t=new Date(e+=60*t*1e3);return{year:t.getUTCFullYear(),month:t.getUTCMonth()+1,day:t.getUTCDate(),hour:t.getUTCHours(),minute:t.getUTCMinutes(),second:t.getUTCSeconds(),millisecond:t.getUTCMilliseconds()}}function rn(e,t,r){return en(Ve(e),t,r)}function nn(e,t){var r=e.o,n=e.c.year+Math.trunc(t.years),i=e.c.month+Math.trunc(t.months)+3*Math.trunc(t.quarters),n={...e.c,year:n,month:i,day:Math.min(e.c.day,Ue(n,i))+Math.trunc(t.days)+7*Math.trunc(t.weeks)},i=N.fromObject({years:t.years-Math.trunc(t.years),quarters:t.quarters-Math.trunc(t.quarters),months:t.months-Math.trunc(t.months),weeks:t.weeks-Math.trunc(t.weeks),days:t.days-Math.trunc(t.days),hours:t.hours,minutes:t.minutes,seconds:t.seconds,milliseconds:t.milliseconds}).as("milliseconds");let[o,s]=en(Ve(n),r,e.zone);return 0!==i&&(o+=i,s=e.zone.offset(o)),{ts:o,o:s}}function on(e,t,r,n,i,o){var{setZone:s,zone:a}=r;if(e&&0!==Object.keys(e).length){const n=t||a,i=P.fromObject(e,{...r,zone:n,specificOffset:o});return s?i:i.setZone(a)}return P.invalid(new b("unparsable",`the input "${i}" can't be parsed as `+n))}function sn(e,t,r=!0){return e.isValid?v.create(S.create("en-US"),{allowZ:r,forceSimple:!0}).formatDateTimeFromString(e,t):null}function an(e,t){var r=9999<e.c.year||e.c.year<0;let n="";return r&&0<=e.c.year&&(n+="+"),n+=p(e.c.year,r?6:4),t?n=(n+="-")+p(e.c.month)+"-":n+=p(e.c.month),n+=p(e.c.day)}function ln(e,t,r,n,i,o){let s=p(e.c.hour);return t?(s=(s+=":")+p(e.c.minute),0===e.c.second&&r||(s+=":")):s+=p(e.c.minute),0===e.c.second&&r||(s+=p(e.c.second),0===e.c.millisecond&&n)||(s=(s+=".")+p(e.c.millisecond,3)),i&&(e.isOffsetFixed&&0===e.offset&&!o?s+="Z":e.o<0?s=(s=(s+="-")+p(Math.trunc(-e.o/60))+":")+p(Math.trunc(-e.o%60)):s=(s=(s+="+")+p(Math.trunc(e.o/60))+":")+p(Math.trunc(e.o%60))),o&&(s+="["+e.zone.ianaName+"]"),s}const cn={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},un={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},dn={ordinal:1,hour:0,minute:0,second:0,millisecond:0},hn=["year","month","day","hour","minute","second","millisecond"],pn=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],fn=["year","ordinal","hour","minute","second","millisecond"];function gn(e){var t={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[e.toLowerCase()];if(t)return t;throw new ce(e)}function mn(e,t){const r=E(t.zone,T.defaultZone),n=S.fromObject(t),i=T.now();let o,s;if(y(e.year))o=i;else{for(const t of hn)y(e[t])&&(e[t]=cn[t]);const t=qr(e)||Kr(e);if(t)return P.invalid(t);const n=r.offset(i);[o,s]=rn(e,n,r)}return new P({ts:o,zone:r,loc:n,o:s})}function yn(t,r,n){const i=!!y(n.round)||n.round,e=(e,t)=>(e=Le(e,i||n.calendary?0:2,!0),r.loc.clone(n).relFormatter(n).format(e,t)),o=e=>n.calendary?r.hasSame(t,e)?0:r.startOf(e).diff(t.startOf(e),e).get(e):r.diff(t,e).get(e);if(n.unit)return e(o(n.unit),n.unit);for(const t of n.units){const r=o(t);if(1<=Math.abs(r))return e(r,t)}return e(r<t?-0:0,n.units[n.units.length-1])}function vn(e){let t,r={};return t=0<e.length&&"object"==typeof e[e.length-1]?(r=e[e.length-1],Array.from(e).slice(0,e.length-1)):Array.from(e),[r,t]}class P{constructor(e){var t=e.zone||T.defaultZone;let r=e.invalid||(Number.isNaN(e.ts)?new b("invalid input"):null)||(t.isValid?null:Jr(t)),n=(this.ts=y(e.ts)?T.now():e.ts,null),i=null;if(!r)if(e.old&&e.old.ts===this.ts&&e.old.zone.equals(t))[n,i]=[e.old.c,e.old.o];else{const e=t.offset(this.ts);n=tn(this.ts,e),r=Number.isNaN(n.year)?new b("invalid input"):null,n=r?null:n,i=r?null:e}this._zone=t,this.loc=e.loc||S.create(),this.invalid=r,this.weekData=null,this.c=n,this.o=i,this.isLuxonDateTime=!0}static now(){return new P({})}static local(){var[e,t]=vn(arguments),[t,r,n,i,o,s,a]=t;return mn({year:t,month:r,day:n,hour:i,minute:o,second:s,millisecond:a},e)}static utc(){var[e,t]=vn(arguments),[t,r,n,i,o,s,a]=t;return e.zone=C.utcInstance,mn({year:t,month:r,day:n,hour:i,minute:o,second:s,millisecond:a},e)}static fromJSDate(e,t={}){var r,e="[object Date]"===Object.prototype.toString.call(e)?e.valueOf():NaN;return Number.isNaN(e)?P.invalid("invalid input"):(r=E(t.zone,T.defaultZone)).isValid?new P({ts:e,zone:r,loc:S.fromObject(t)}):P.invalid(Jr(r))}static fromMillis(e,t={}){if(d(e))return e<-864e13||864e13<e?P.invalid("Timestamp out of range"):new P({ts:e,zone:E(t.zone,T.defaultZone),loc:S.fromObject(t)});throw new u(`fromMillis requires a numerical input, but received a ${typeof e} with value `+e)}static fromSeconds(e,t={}){if(d(e))return new P({ts:1e3*e,zone:E(t.zone,T.defaultZone),loc:S.fromObject(t)});throw new u("fromSeconds requires a numerical input")}static fromObject(e,t={}){e=e||{};var r=E(t.zone,T.defaultZone);if(!r.isValid)return P.invalid(Jr(r));var n=T.now(),i=y(t.specificOffset)?r.offset(n):t.specificOffset,o=Ye(e,gn),s=!y(o.ordinal),a=!y(o.year),l=!y(o.month)||!y(o.day),a=a||l,c=o.weekYear||o.weekNumber,t=S.fromObject(t);if((a||s)&&c)throw new le("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(l&&s)throw new le("Can't mix ordinal dates with month/day");l=c||o.weekday&&!a;let u,d,h=tn(n,i),p=(l?(u=pn,d=un,h=jr(h)):s?(u=fn,d=dn,h=Yr(h)):(u=hn,d=cn),!1);for(const e of u)y(o[e])?o[e]=(p?d:h)[e]:p=!0;var f,g,c=(l?(n=Me((c=o).weekYear),f=m(c.weekNumber,1,We(c.weekYear)),g=m(c.weekday,1,7),n?f?!g&&D("weekday",c.weekday):D("week",c.week):D("weekYear",c.weekYear)):s?(f=Me((n=o).year),g=m(n.ordinal,1,He(n.year)),f?!g&&D("ordinal",n.ordinal):D("year",n.year)):qr(o))||Kr(o);return c?P.invalid(c):([n,c]=rn(l?zr(o):s?Gr(o):o,i,r),l=new P({ts:n,zone:r,o:c,loc:t}),o.weekday&&a&&e.weekday!==l.weekday?P.invalid("mismatched weekday",`you can't specify both a weekday of ${o.weekday} and a date of `+l.toISO()):l)}static fromISO(e,t={}){var[r,n]=Pt(e,[sr,ur],[ar,dr],[lr,hr],[cr,pr]);return on(r,n,t,"ISO 8601",e)}static fromRFC2822(e,t={}){var[r,n]=Pt(e.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim(),[Qt,er]);return on(r,n,t,"RFC 2822",e)}static fromHTTP(e,t={}){var[e,r]=Pt(e,[tr,ir],[rr,ir],[nr,or]);return on(e,r,t,"HTTP",t)}static fromFormat(i,o,e={}){if(y(i)||y(o))throw new u("fromFormat requires an input string and a format");const{locale:t=null,numberingSystem:r=null}=e,s=S.fromOpts({locale:t,numberingSystem:r,defaultToEN:!0}),[n,a,l,c]=function(){var{result:e,zone:t,specificOffset:r,invalidReason:n}=Fr(s,i,o);return[e,t,r,n]}();return c?P.invalid(c):on(n,a,e,"format "+o,i,l)}static fromString(e,t,r={}){return P.fromFormat(e,t,r)}static fromSQL(e,t={}){var[r,n]=Pt(e,[gr,ur],[mr,yr]);return on(r,n,t,"SQL",e)}static invalid(e,t=null){if(!e)throw new u("need to specify a reason the DateTime is invalid");e=e instanceof b?e:new b(e,t);if(T.throwOnInvalid)throw new oe(e);return new P({invalid:e})}static isDateTime(e){return e&&e.isLuxonDateTime||!1}static parseFormatForOpts(e,t={}){e=Hr(e,S.fromObject(t));return e?e.map(e=>e?e.val:null).join(""):null}get(e){return this[e]}get isValid(){return null===this.invalid}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?Zr(this).weekYear:NaN}get weekNumber(){return this.isValid?Zr(this).weekNumber:NaN}get weekday(){return this.isValid?Zr(this).weekday:NaN}get ordinal(){return this.isValid?Yr(this.c).ordinal:NaN}get monthShort(){return this.isValid?Sr.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?Sr.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?Sr.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?Sr.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return!this.isOffsetFixed&&(this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset)}get isInLeapYear(){return Fe(this.year)}get daysInMonth(){return Ue(this.year,this.month)}get daysInYear(){return this.isValid?He(this.year):NaN}get weeksInWeekYear(){return this.isValid?We(this.weekYear):NaN}resolvedLocaleOptions(e={}){var{locale:e,numberingSystem:t,calendar:r}=v.create(this.loc.clone(e),e).resolvedOptions(this);return{locale:e,numberingSystem:t,outputCalendar:r}}toUTC(e=0,t={}){return this.setZone(C.instance(e),t)}toLocal(){return this.setZone(T.defaultZone)}setZone(t,{keepLocalTime:r=!1,keepCalendarTime:n=!1}={}){if((t=E(t,T.defaultZone)).equals(this.zone))return this;if(t.isValid){let e=this.ts;if(r||n){const r=t.offset(this.ts),n=this.toObject();[e]=rn(n,r,t)}return Qr(this,{ts:e,zone:t})}return P.invalid(Jr(t))}reconfigure({locale:e,numberingSystem:t,outputCalendar:r}={}){return Qr(this,{loc:this.loc.clone({locale:e,numberingSystem:t,outputCalendar:r})})}setLocale(e){return this.reconfigure({locale:e})}set(e){if(!this.isValid)return this;var e=Ye(e,gn),t=!y(e.weekYear)||!y(e.weekNumber)||!y(e.weekday),r=!y(e.ordinal),n=!y(e.year),i=!y(e.month)||!y(e.day),o=e.weekYear||e.weekNumber;if((n||i||r)&&o)throw new le("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(i&&r)throw new le("Can't mix ordinal dates with month/day");let s;t?s=zr({...jr(this.c),...e}):y(e.ordinal)?(s={...this.toObject(),...e},y(e.day)&&(s.day=Math.min(Ue(s.year,s.month),s.day))):s=Gr({...Yr(this.c),...e});var[n,o]=rn(s,this.o,this.zone);return Qr(this,{ts:n,o:o})}plus(e){return this.isValid?Qr(this,nn(this,N.fromDurationLike(e))):this}minus(e){return this.isValid?Qr(this,nn(this,N.fromDurationLike(e).negate())):this}startOf(e){if(!this.isValid)return this;var t={},e=N.normalizeUnit(e);switch(e){case"years":t.month=1;case"quarters":case"months":t.day=1;case"weeks":case"days":t.hour=0;case"hours":t.minute=0;case"minutes":t.second=0;case"seconds":t.millisecond=0}if("weeks"===e&&(t.weekday=1),"quarters"===e){const e=Math.ceil(this.month/3);t.month=3*(e-1)+1}return this.set(t)}endOf(e){return this.isValid?this.plus({[e]:1}).startOf(e).minus(1):this}toFormat(e,t={}){return this.isValid?v.create(this.loc.redefaultToEN(t)).formatDateTimeFromString(this,e):Xr}toLocaleString(e=ue,t={}){return this.isValid?v.create(this.loc.clone(t),e).formatDateTime(this):Xr}toLocaleParts(e={}){return this.isValid?v.create(this.loc.clone(e),e).formatDateTimeParts(this):[]}toISO({format:e="extended",suppressSeconds:t=!1,suppressMilliseconds:r=!1,includeOffset:n=!0,extendedZone:i=!1}={}){var o;return this.isValid?(o=an(this,e="extended"===e),(o+="T")+ln(this,e,t,r,n,i)):null}toISODate({format:e="extended"}={}){return this.isValid?an(this,"extended"===e):null}toISOWeekDate(){return sn(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:e=!1,suppressSeconds:t=!1,includeOffset:r=!0,includePrefix:n=!1,extendedZone:i=!1,format:o="extended"}={}){return this.isValid?(n?"T":"")+ln(this,"extended"===o,t,e,r,i):null}toRFC2822(){return sn(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return sn(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?an(this,!0):null}toSQLTime({includeOffset:e=!0,includeZone:t=!1,includeOffsetSpace:r=!0}={}){let n="HH:mm:ss.SSS";return(t||e)&&(r&&(n+=" "),t?n+="z":e&&(n+="ZZ")),sn(this,n,!0)}toSQL(e={}){return this.isValid?this.toSQLDate()+" "+this.toSQLTime(e):null}toString(){return this.isValid?this.toISO():Xr}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(e={}){var t;return this.isValid?(t={...this.c},e.includeConfig&&(t.outputCalendar=this.outputCalendar,t.numberingSystem=this.loc.numberingSystem,t.locale=this.loc.locale),t):{}}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(e,t="milliseconds",r={}){var n;return this.isValid&&e.isValid?(r={locale:this.locale,numberingSystem:this.numberingSystem,...r},t=t,t=(Array.isArray(t)?t:[t]).map(N.normalizeUnit),e=function(e,t,r,n){let[i,o,s,a]=function(t,r,e){var n,i,o={};let s,a;for([n,i]of[["years",(e,t)=>t.year-e.year],["quarters",(e,t)=>t.quarter-e.quarter],["months",(e,t)=>t.month-e.month+12*(t.year-e.year)],["weeks",(e,t)=>{e=_r(e,t);return(e-e%7)/7}],["days",_r]])if(0<=e.indexOf(n)){s=n;let e=i(t,r);(a=t.plus({[n]:e}))>r?(t=t.plus({[n]:e-1}),--e):t=a,o[n]=e}return[t,o,a,s]}(e,t,r);e=t-i,r=r.filter(e=>0<=["hours","minutes","seconds","milliseconds"].indexOf(e)),0===r.length&&(s=s<t?i.plus({[a]:1}):s)!==i&&(o[a]=(o[a]||0)+e/(s-i)),t=N.fromObject(o,n);return 0<r.length?N.fromMillis(e,n).shiftTo(...r).plus(t):t}((n=e.valueOf()>this.valueOf())?this:e,n?e:this,t,r),n?e.negate():e):N.invalid("created by diffing an invalid DateTime")}diffNow(e="milliseconds",t={}){return this.diff(P.now(),e,t)}until(e){return this.isValid?O.fromDateTimes(this,e):this}hasSame(e,t){var r;return!!this.isValid&&(r=e.valueOf(),(e=this.setZone(e.zone,{keepLocalTime:!0})).startOf(t)<=r)&&r<=e.endOf(t)}equals(e){return this.isValid&&e.isValid&&this.valueOf()===e.valueOf()&&this.zone.equals(e.zone)&&this.loc.equals(e.loc)}toRelative(e={}){if(!this.isValid)return null;var t=e.base||P.fromObject({},{zone:this.zone}),r=e.padding?this<t?-e.padding:e.padding:0;let n=["years","months","days","hours","minutes","seconds"],i=e.unit;return Array.isArray(e.unit)&&(n=e.unit,i=void 0),yn(t,this.plus(r),{...e,numeric:"always",units:n,unit:i})}toRelativeCalendar(e={}){return this.isValid?yn(e.base||P.fromObject({},{zone:this.zone}),this,{...e,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...e){if(e.every(P.isDateTime))return De(e,e=>e.valueOf(),Math.min);throw new u("min requires all arguments be DateTimes")}static max(...e){if(e.every(P.isDateTime))return De(e,e=>e.valueOf(),Math.max);throw new u("max requires all arguments be DateTimes")}static fromFormatExplain(e,t,r={}){var{locale:r=null,numberingSystem:n=null}=r;return Fr(S.fromOpts({locale:r,numberingSystem:n,defaultToEN:!0}),e,t)}static fromStringExplain(e,t,r={}){return P.fromFormatExplain(e,t,r)}static get DATE_SHORT(){return ue}static get DATE_MED(){return de}static get DATE_MED_WITH_WEEKDAY(){return he}static get DATE_FULL(){return pe}static get DATE_HUGE(){return fe}static get TIME_SIMPLE(){return ge}static get TIME_WITH_SECONDS(){return me}static get TIME_WITH_SHORT_OFFSET(){return ye}static get TIME_WITH_LONG_OFFSET(){return ve}static get TIME_24_SIMPLE(){return be}static get TIME_24_WITH_SECONDS(){return we}static get TIME_24_WITH_SHORT_OFFSET(){return Ce}static get TIME_24_WITH_LONG_OFFSET(){return Ee}static get DATETIME_SHORT(){return Te}static get DATETIME_SHORT_WITH_SECONDS(){return Se}static get DATETIME_MED(){return _e}static get DATETIME_MED_WITH_SECONDS(){return xe}static get DATETIME_MED_WITH_WEEKDAY(){return Re}static get DATETIME_FULL(){return Ae}static get DATETIME_FULL_WITH_SECONDS(){return Ne}static get DATETIME_HUGE(){return Oe}static get DATETIME_HUGE_WITH_SECONDS(){return Ie}}function bn(e){if(P.isDateTime(e))return e;if(e&&e.valueOf&&d(e.valueOf()))return P.fromJSDate(e);if(e&&"object"==typeof e)return P.fromObject(e);throw new u(`Unknown datetime argument: ${e}, of type `+typeof e)}Ht=(()=>{const t={MONTHS:["January","February","March","April","May","June","July","August","September","October","November","December"],COLORS:["#4dc9f6","#f67019","#f53794","#537bc4","#acc236","#166a8f","#00a950","#58595b","#8549ba"],CHART_COLORS:{red:"rgb(214, 57, 57)",orange:"rgb(247, 103, 7)",yellow:"rgb(245, 159, 0)",green:"rgb(47, 179, 68)",blue:"rgb(32, 107, 196)",purple:"rgb(174, 62, 201)",grey:"rgb(108, 122, 145)",azure:"rgb(66, 153, 225)",indigo:"rgb(66, 99, 235)",pink:"rgb(214, 51, 108)",lime:"rgb(116, 184, 22)",teal:"rgb(12, 166, 120)",cyan:"rgb(23, 162, 184)",olive:"rgb(107, 142, 35)",plum:"rgb(221, 160, 221)",slate:"rgb(123, 104, 238)",brown:"rgb(139, 69, 19)"}};class r{constructor(e){this._seed=Date.now(),this.MONTHS=e.MONTHS,this.COLORS=e.COLORS,this.CHART_COLORS=e.CHART_COLORS,this.NAMED_COLORS=[this.CHART_COLORS.red,this.CHART_COLORS.orange,this.CHART_COLORS.yellow,this.CHART_COLORS.green,this.CHART_COLORS.blue,this.CHART_COLORS.purple,this.CHART_COLORS.grey,this.CHART_COLORS.azure,this.CHART_COLORS.indigo,this.CHART_COLORS.pink,this.CHART_COLORS.lime,this.CHART_COLORS.teal,this.CHART_COLORS.cyan,this.CHART_COLORS.olive,this.CHART_COLORS.plum,this.CHART_COLORS.slate,this.CHART_COLORS.brown]}valueOrDefault(e,t){return void 0===e?t:e}srand(e){this._seed=e}rand(e,t){return e=this.valueOrDefault(e,0),t=this.valueOrDefault(t,0),this._seed=(9301*this._seed+49297)%233280,e+this._seed/233280*(t-e)}numbers(e){var e=e||{},t=this.valueOrDefault(e.min,0),r=this.valueOrDefault(e.max,100),n=this.valueOrDefault(e.from,[]),i=this.valueOrDefault(e.count,8),o=this.valueOrDefault(e.decimals,8),s=this.valueOrDefault(e.continuity,1),a=Math.pow(10,o)||0,l=[];let c,u;for(c=0;c<i;++c)u=(n[c]||0)+this.rand(t,r),this.rand()<=s?l.push(Math.round(a*u)/a):l.push(null);return l}points(e){const t=this.numbers(e),r=this.numbers(e);return t.map((e,t)=>({x:e,y:r[t]}))}bubbles(t){return this.points(t).map(e=>(e.r=this.rand(t.rmin,t.rmax),e))}labels(e){var e=e||{},t=e.min||0,r=e.max||100,n=(r-t)/(e.count||8),i=e.decimals||8,o=Math.pow(10,i)||0,s=e.prefix||"",a=[];let l;for(l=t;l<r;l+=n)a.push(s+Math.round(o*l)/o);return a}months(e){var e=e||{},t=e.count||12,r=e.section,n=[];let i,o;for(i=0;i<t;++i)o=this.MONTHS[Math.ceil(i)%12],n.push(o.substring(0,r));return n}color(e){return this.COLORS[e%this.COLORS.length]}transparentize(e,t){t=void 0===t?.5:1-t;return new ie(e).alpha(t).rgbString()}namedColor(e){return this.NAMED_COLORS[e%this.NAMED_COLORS.length]}newDate(e){return P.now().plus({days:e}).toJSDate()}newDateString(e){return P.now().plus({days:e}).toISO()}parseISODate(e){return P.fromISO(e)}}return{init:e=>{e=Object.assign({},t,e);return new r(e)}}})();window.ChartUtils=Ht})(),!function(J,Z){var n="__instance__",o="firstChild",u=setTimeout;function d(e){return void 0!==e}function h(e){return"object"==typeof e}function p(e){return Object.keys(e).length}function Q(e,t,r){return e<t?t:r<e?r:e}function f(e){return Math.round(e)}function ee(e){var t,r,n,i=+e[0],o=+e[1],s=+e[2],e=Math.floor(6*i),i=6*i-e,a=s*(1-o),l=s*(1-i*o),c=s*(1-(1-i)*o);switch(l=l||0,c=c||0,(e||0)%6){case 0:t=s,r=c,n=a;break;case 1:t=l,r=s,n=a;break;case 2:t=a,r=s,n=c;break;case 3:t=a,r=l,n=s;break;case 4:t=c,r=a,n=s;break;case 5:t=s,r=a,n=l}return[f(255*t),f(255*r),f(255*n)]}function te(e){return t(ee(e))}function t(e){return("000000"+(+e[2]|+e[1]<<8|+e[0]<<16).toString(16)).slice(-6)}J.CP=function(g,m,j){var z=Z.body,s=Z.documentElement,y=this,t=J.CP,r=!1,i={},v=Z.createElement("div"),b="touchstart mousedown",w="touchmove mousemove",Y="touchend mouseup",G="orientationchange resize";if(!(y instanceof t))return new t(g,m);function C(e,t,r){for(var n=0,i=(e=e.split(/\s+/)).length;n<i;++n)t.addEventListener(e[n],r,!1)}function E(e,t,r){for(var n=0,i=(e=e.split(/\s+/)).length;n<i;++n)t.removeEventListener(e[n],r)}function q(e,t){var r="touches",n=(t[r]?t[r][0]:t).clientX,r=(t[r]?t[r][0]:t).clientY,t=a(e);return{x:n-t.l,y:r-t.t}}function a(e){var t,e=e===J?(t=J.pageXOffset||s.scrollLeft,J.pageYOffset||s.scrollTop):(t=(e=e.getBoundingClientRect()).left,e.top);return{l:t,t:e}}function T(e,t){for(;(e=e.parentElement)&&e!==t;);return e}function S(e){e&&e.preventDefault()}function _(e){return e===J?{w:J.innerWidth,h:J.innerHeight}:{w:e.offsetWidth,h:e.offsetHeight}}function x(e){return r||!!d(e)&&e}function R(e){r=e}function A(e,t,r){if(d(i[e]))if(d(r))d(i[e][r])&&i[e][r].apply(y,t);else for(var n in i[e])i[e][n].apply(y,t);return y}t[n][g.id||g.name||p(t[n])]=y,d(m)&&!0!==m||(m=b),R(t.parse(g.getAttribute("data-color")||g.value||[0,1,1])),v.className="color-picker",v.innerHTML='<div class="color-picker-container"><span class="color-picker-h"><i></i></span><span class="color-picker-sv"><i></i></span></div>';var N,e=v[o].children,O=x([0,1,1]),I=e[0],M=e[1],k=I[o],D=M[o],P=0,L=0,F=0,H=0,l=0,c=0,K=0,X=0,U=[te(O)];function V(e,t){e&&"h"!==e||A("change:h",t),e&&"sv"!==e||A("change:sv",t),A("change",t)}function W(){return v.parentNode}function $(e,t){e||((j||t||z).appendChild(v),y.visible=!0),K=_(v).w,X=_(v).h;var t=_(M),r=_(D),n=_(I).h,i=t.w,o=t.h,s=_(k).h,a=r.w,l=r.h;function c(e){e=e.target;e===g||T(e,g)===g?W()||($(),A("enter")):y.exit()}function u(e){ee(O);var t=ee([O[0],1,1]);M.style.backgroundColor="rgb("+t.join(",")+")",R(O),S(e)}function d(e){var t,r;F&&(t=Q(q(I,r=e).y,0,n),O[0]=(n-t)/n,k.style.top=t-s/2+"px",u(r),U=[te(O)],P||(A("drag:h",U),A("drag",U),V("h",U))),H&&(e=Q((r=q(M,t=e)).x,0,i),r=Q(r.y,0,o),O[1]=1-(i-e)/i,O[2]=(o-r)/o,D.style.right=i-e-a/2+"px",D.style.top=r-l/2+"px",u(t),U=[te(O)],L||(A("drag:sv",U),A("drag",U),V("sv",U))),L=P=0}function h(e){var e=e.target,t=F?"h":"sv",r=[te(O),y],n=e===g||T(e,g)===g,e=e===v||T(e,v)===v;n||e?e&&(A("stop:"+t,r),A("stop",r),V(t,r)):W()&&!1!==m&&(y.exit(),V(0,r)),H=F=0}function p(e){F=P=1,d(e),S(e),A("start:h",U),A("start",U),V("h",U)}function f(e){H=L=1,d(e),S(e),A("start:sv",U),A("start",U),V("sv",U)}e?(!(v.style.left=v.style.top="-9999px")!==m&&C(m,g,c),y.create=function(){return $(1),A("create"),y},y.destroy=function(){return!1!==m&&E(m,g,c),y.exit(),R(!1),A("destroy"),y}):B(),N=function(){O=x(O),u(),k.style.top=n-s/2-n*+O[0]+"px",D.style.right=i-a/2-i*+O[1]+"px",D.style.top=o-l/2-o*+O[2]+"px"},y.exit=function(e){var t=W();return t&&(t.removeChild(v),y.visible=!1),E(b,I,p),E(b,M,f),E(w,Z,d),E(Y,Z,h),E(G,J,B),A("exit"),y},N(),e||(C(b,I,p),C(b,M,f),C(w,Z,d),C(Y,Z,h),C(G,J,B))}function B(){return y.fit()}return $(1),u(function(){var e=[te(O)];A("create",e),V(0,e)},0),y.fit=function(e){var t=_(J),r=_(s),r=t.w-r.w,n=t.h-s.clientHeight,i=a(J),o=a(g);return l=o.l+i.l,c=o.t+i.t+_(g).h,h(e)?(d(e[0])&&(l=e[0]),d(e[1])&&(c=e[1])):(o=i.l,e=i.t,r=i.l+t.w-K-r,i=i.t+t.h-X-n,l=Q(l,o,r)>>0,c=Q(c,e,i)>>0),v.style.left=l+"px",v.style.top=c+"px",A("fit"),y},y.set=function(e){return d(e)?(R(e="string"==typeof e?t.parse(e):e),N(),y):x()},y.get=x,y.source=g,y.self=v,y.visible=!1,y.on=function(e,t,r){return d(e)?d(t)?(d(i[e])||(i[e]={}),d(r)||(r=p(i[e])),i[e][r]=t,y):i[e]:i},y.off=function(e,t){return d(e)?d(t)?delete i[e][t]:i[e]={}:i={},y},y.fire=A,y.hooks=i,y.enter=function(e){return $(0,e),A("enter"),y},y}}(window,document),!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.ISpin=t()}(this,function(){"use strict";function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function s(n){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},t=Object.keys(i);(t="function"==typeof Object.getOwnPropertySymbols?t.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable})):t).forEach(function(e){var t,r;t=n,r=i[e=e],e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r})}return n}function a(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var e=function(){function n(e,t){if(!(this instanceof n))throw new TypeError("Cannot call a class as a function");this.el=e,this.options={},this._onKeyDown=this._onKeyDown.bind(this),this._onMouseDown=this._onMouseDown.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onMouseLeave=this._onMouseLeave.bind(this),this._onWheel=this._onWheel.bind(this),this.build(),this.update(t)}var e,t,r;return e=n,(t=[{key:"build",value:function(){var t=this;this._wrapper=document.createElement("div"),this.el.parentNode&&this.el.parentNode.replaceChild(this._wrapper,this.el),this._wrapper.appendChild(this.el),this._buttons={inc:document.createElement("button"),dec:document.createElement("button")},Object.keys(this._buttons).forEach(function(e){e=t._buttons[e];t._wrapper.appendChild(e),e.setAttribute("type","button"),e.addEventListener("mousedown",t._onMouseDown),e.addEventListener("mouseup",t._onMouseUp),e.addEventListener("mouseleave",t._onMouseLeave)}),this.el.addEventListener("keydown",this._onKeyDown),this.el.addEventListener("wheel",this._onWheel)}},{key:"update",value:function(t){var r=this;(t=s({},n.DEFAULTS,this.options,t)).wrapperClass!==this.options.wrapperClass&&(this.options.wrapperClass&&this._wrapper.classList.remove(this.options.wrapperClass),t.wrapperClass)&&this._wrapper.classList.add(t.wrapperClass),t.buttonsClass!==this.options.buttonsClass&&(this.options.buttonsClass&&Object.keys(this._buttons).forEach(function(e){r._buttons[e].classList.remove(r.options.buttonsClass),r._buttons[e].classList.remove(r.options.buttonsClass+"-"+e)}),t.buttonsClass)&&Object.keys(this._buttons).forEach(function(e){r._buttons[e].classList.add(t.buttonsClass),r._buttons[e].classList.add(t.buttonsClass+"-"+e)}),this.disabled=t.disabled,o(this.options,t)}},{key:"destroy",value:function(){this._wrapper.parentNode&&this._wrapper.parentNode.replaceChild(this.el,this._wrapper),delete this.el,delete this._wrapper,delete this._buttons}},{key:"_onKeyDown",value:function(e){switch(e.keyCode){case 38:return e.preventDefault(),this.spin(this.options.step);case 40:return e.preventDefault(),this.spin(-this.options.step);case 33:return e.preventDefault(),this.spin(this.options.pageStep);case 34:return e.preventDefault(),this.spin(-this.options.pageStep)}}},{key:"_onMouseDown",value:function(e){e.preventDefault();e=e.currentTarget===this._buttons.inc?1:-1;this.spin(e*this.options.step),this.el.focus(),this._startSpinning(e)}},{key:"_onMouseUp",value:function(e){this._stopSpinning()}},{key:"_onMouseLeave",value:function(e){this._stopSpinning()}},{key:"_startSpinning",value:function(e){var t=this;this._stopSpinning(),this._spinTimer=setInterval(function(){return t.spin(e*t.options.step)},this.options.repeatInterval)}},{key:"_stopSpinning",value:function(){clearInterval(this._spinTimer)}},{key:"_onWheel",value:function(e){document.activeElement===this.el&&(e.preventDefault(),e=0<e.deltaY?-1:1,this.spin(e*this.options.step))}},{key:"adjustValue",value:function(e){return e=Number(e.toFixed(this.precision)),null!=this.options.max&&e>this.options.max&&(e=this.options.max),e=null!=this.options.min&&e<this.options.min?this.options.min:e}},{key:"wrapValue",value:function(e){return this.options.wrapOverflow&&null!=this.options.max&&null!=this.options.min&&(e<this.options.min?e=this.options.max:e>this.options.max&&(e=this.options.min)),e}},{key:"spin",value:function(e){this.value=this.adjustValue(this.wrapValue(this.value+e))}},{key:"value",get:function(){return this.options.parse(this.el.value)||0},set:function(e){e=this.options.format(this.options.parse(String(e)));this.el.value=e,this.options.onChange&&this.options.onChange(e)}},{key:"disabled",get:function(){return this._buttons.inc.disabled},set:function(e){this.disabled!==e&&(this._buttons.inc.disabled=this._buttons.dec.disabled=e)}},{key:"precision",get:function(){return Math.max.apply(Math,a([this.options.step,this.options.min].filter(function(e){return null!=e}).map(l)))}}])&&i(e.prototype,t),r&&i(e,r),n}();function l(e){return(String(e).split(".")[1]||"").length}return e.DEFAULTS={wrapperClass:"ispin-wrapper",buttonsClass:"ispin-button",step:1,pageStep:10,disabled:!1,repeatInterval:200,wrapOverflow:!1,parse:Number,format:String},e}),!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.moment=t()}(this,function(){"use strict";var L;function g(){return L.apply(null,arguments)}function m(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function F(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function h(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function H(e){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(e).length;for(var t in e)if(h(e,t))return;return 1}function y(e){return void 0===e}function v(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function U(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function V(e,t){for(var r=[],n=e.length,i=0;i<n;++i)r.push(t(e[i],i));return r}function W(e,t){for(var r in t)h(t,r)&&(e[r]=t[r]);return h(t,"toString")&&(e.toString=t.toString),h(t,"valueOf")&&(e.valueOf=t.valueOf),e}function c(e,t,r,n){return It(e,t,r,n,!0).utc()}function b(e){return null==e._pf&&(e._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}),e._pf}function $(e){var t,r,n=e._d&&!isNaN(e._d.getTime());return n&&(t=b(e),r=j.call(t.parsedDateParts,function(e){return null!=e}),n=t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r),e._strict)&&(n=n&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour),null!=Object.isFrozen&&Object.isFrozen(e)?n:(e._isValid=n,e._isValid)}function B(e){var t=c(NaN);return null!=e?W(b(t),e):b(t).userInvalidated=!0,t}var j=Array.prototype.some||function(e){for(var t=Object(this),r=t.length>>>0,n=0;n<r;n++)if(n in t&&e.call(this,t[n],n,t))return!0;return!1},z=g.momentProperties=[],Y=!1;function G(e,t){var r,n,i,o=z.length;if(y(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),y(t._i)||(e._i=t._i),y(t._f)||(e._f=t._f),y(t._l)||(e._l=t._l),y(t._strict)||(e._strict=t._strict),y(t._tzm)||(e._tzm=t._tzm),y(t._isUTC)||(e._isUTC=t._isUTC),y(t._offset)||(e._offset=t._offset),y(t._pf)||(e._pf=b(t)),y(t._locale)||(e._locale=t._locale),0<o)for(r=0;r<o;r++)y(i=t[n=z[r]])||(e[n]=i);return e}function q(e){G(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===Y&&(Y=!0,g.updateOffset(this),Y=!1)}function w(e){return e instanceof q||null!=e&&null!=e._isAMomentObject}function K(e){!1===g.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function e(o,s){var a=!0;return W(function(){if(null!=g.deprecationHandler&&g.deprecationHandler(null,o),a){for(var e,t,r=[],n=arguments.length,i=0;i<n;i++){if(e="","object"==typeof arguments[i]){for(t in e+="\n["+i+"] ",arguments[0])h(arguments[0],t)&&(e+=t+": "+arguments[0][t]+", ");e=e.slice(0,-2)}else e=arguments[i];r.push(e)}K(o+"\nArguments: "+Array.prototype.slice.call(r).join("")+"\n"+(new Error).stack),a=!1}return s.apply(this,arguments)},s)}var X={};function J(e,t){null!=g.deprecationHandler&&g.deprecationHandler(e,t),X[e]||(K(t),X[e]=!0)}function s(e){return"undefined"!=typeof Function&&e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function Z(e,t){var r,n=W({},e);for(r in t)h(t,r)&&(F(e[r])&&F(t[r])?(n[r]={},W(n[r],e[r]),W(n[r],t[r])):null!=t[r]?n[r]=t[r]:delete n[r]);for(r in e)h(e,r)&&!h(t,r)&&F(e[r])&&(n[r]=W({},n[r]));return n}function Q(e){null!=e&&this.set(e)}g.suppressDeprecationWarnings=!1,g.deprecationHandler=null;var ee=Object.keys||function(e){var t,r=[];for(t in e)h(e,t)&&r.push(t);return r};function o(e,t,r){var n=""+Math.abs(e);return(0<=e?r?"+":"":"-")+Math.pow(10,Math.max(0,t-n.length)).toString().substr(1)+n}var te=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,re=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,ne={},ie={};function n(e,t,r,n){var i="string"==typeof n?function(){return this[n]()}:n;e&&(ie[e]=i),t&&(ie[t[0]]=function(){return o(i.apply(this,arguments),t[1],t[2])}),r&&(ie[r]=function(){return this.localeData().ordinal(i.apply(this,arguments),e)})}function oe(e,t){return e.isValid()?(t=se(t,e.localeData()),ne[t]=ne[t]||function(n){for(var e,i=n.match(te),t=0,o=i.length;t<o;t++)ie[i[t]]?i[t]=ie[i[t]]:i[t]=(e=i[t]).match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"");return function(e){for(var t="",r=0;r<o;r++)t+=s(i[r])?i[r].call(e,n):i[r];return t}}(t),ne[t](e)):e.localeData().invalidDate()}function se(e,t){var r=5;function n(e){return t.longDateFormat(e)||e}for(re.lastIndex=0;0<=r&&re.test(e);)e=e.replace(re,n),re.lastIndex=0,--r;return e}var ae={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function a(e){return"string"==typeof e?ae[e]||ae[e.toLowerCase()]:void 0}function le(e){var t,r,n={};for(r in e)h(e,r)&&(t=a(r))&&(n[t]=e[r]);return n}var ce={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};var ue=/\d/,t=/\d\d/,de=/\d{3}/,he=/\d{4}/,pe=/[+-]?\d{6}/,r=/\d\d?/,fe=/\d\d\d\d?/,ge=/\d\d\d\d\d\d?/,me=/\d{1,3}/,ye=/\d{1,4}/,ve=/[+-]?\d{1,6}/,be=/\d+/,we=/[+-]?\d+/,Ce=/Z|[+-]\d\d:?\d\d/gi,Ee=/Z|[+-]\d\d(?::?\d\d)?/gi,i=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,l=/^[1-9]\d?/,u=/^([1-9]\d|\d)/;function d(e,r,n){Se[e]=s(r)?r:function(e,t){return e&&n?n:r}}function Te(e,t){return h(Se,e)?Se[e](t._strict,t._locale):new RegExp(p(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,r,n,i){return t||r||n||i})))}function p(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function f(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function C(e){var e=+e,t=0;return t=0!=e&&isFinite(e)?f(e):t}var Se={},_e={};function E(e,r){var t,n,i=r;for("string"==typeof e&&(e=[e]),v(r)&&(i=function(e,t){t[r]=C(e)}),n=e.length,t=0;t<n;t++)_e[e[t]]=i}function xe(e,i){E(e,function(e,t,r,n){r._w=r._w||{},i(e,r._w,r,n)})}function Re(e){return e%4==0&&e%100!=0||e%400==0}var T=0,S=1,_=2,x=3,R=4,A=5,Ae=6,Ne=7,Oe=8;function Ie(e){return Re(e)?366:365}n("Y",0,0,function(){var e=this.year();return e<=9999?o(e,4):"+"+e}),n(0,["YY",2],0,function(){return this.year()%100}),n(0,["YYYY",4],0,"year"),n(0,["YYYYY",5],0,"year"),n(0,["YYYYYY",6,!0],0,"year"),d("Y",we),d("YY",r,t),d("YYYY",ye,he),d("YYYYY",ve,pe),d("YYYYYY",ve,pe),E(["YYYYY","YYYYYY"],T),E("YYYY",function(e,t){t[T]=2===e.length?g.parseTwoDigitYear(e):C(e)}),E("YY",function(e,t){t[T]=g.parseTwoDigitYear(e)}),E("Y",function(e,t){t[T]=parseInt(e,10)}),g.parseTwoDigitYear=function(e){return C(e)+(68<C(e)?1900:2e3)};var N,Me=ke("FullYear",!0);function ke(t,r){return function(e){return null!=e?(Pe(this,t,e),g.updateOffset(this,r),this):De(this,t)}}function De(e,t){if(!e.isValid())return NaN;var r=e._d,n=e._isUTC;switch(t){case"Milliseconds":return n?r.getUTCMilliseconds():r.getMilliseconds();case"Seconds":return n?r.getUTCSeconds():r.getSeconds();case"Minutes":return n?r.getUTCMinutes():r.getMinutes();case"Hours":return n?r.getUTCHours():r.getHours();case"Date":return n?r.getUTCDate():r.getDate();case"Day":return n?r.getUTCDay():r.getDay();case"Month":return n?r.getUTCMonth():r.getMonth();case"FullYear":return n?r.getUTCFullYear():r.getFullYear();default:return NaN}}function Pe(e,t,r){var n,i,o;if(e.isValid()&&!isNaN(r)){switch(n=e._d,i=e._isUTC,t){case"Milliseconds":return i?n.setUTCMilliseconds(r):n.setMilliseconds(r);case"Seconds":return i?n.setUTCSeconds(r):n.setSeconds(r);case"Minutes":return i?n.setUTCMinutes(r):n.setMinutes(r);case"Hours":return i?n.setUTCHours(r):n.setHours(r);case"Date":return i?n.setUTCDate(r):n.setDate(r);case"FullYear":break;default:return}t=r,o=e.month(),e=29!==(e=e.date())||1!==o||Re(t)?e:28,i?n.setUTCFullYear(t,o,e):n.setFullYear(t,o,e)}}function Le(e,t){var r;return isNaN(e)||isNaN(t)?NaN:(r=(t%(r=12)+r)%r,e+=(t-r)/12,1==r?Re(e)?29:28:31-r%7%2)}N=Array.prototype.indexOf||function(e){for(var t=0;t<this.length;++t)if(this[t]===e)return t;return-1},n("M",["MM",2],"Mo",function(){return this.month()+1}),n("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),n("MMMM",0,0,function(e){return this.localeData().months(this,e)}),d("M",r,l),d("MM",r,t),d("MMM",function(e,t){return t.monthsShortRegex(e)}),d("MMMM",function(e,t){return t.monthsRegex(e)}),E(["M","MM"],function(e,t){t[S]=C(e)-1}),E(["MMM","MMMM"],function(e,t,r,n){n=r._locale.monthsParse(e,n,r._strict);null!=n?t[S]=n:b(r).invalidMonth=e});var Fe="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),He="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Ue=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Ve=i,We=i;function $e(e,t){if(e.isValid()){if("string"==typeof t)if(/^\d+$/.test(t))t=C(t);else if(!v(t=e.localeData().monthsParse(t)))return;var r=(r=e.date())<29?r:Math.min(r,Le(e.year(),t));e._isUTC?e._d.setUTCMonth(t,r):e._d.setMonth(t,r)}}function Be(e){return null!=e?($e(this,e),g.updateOffset(this,!0),this):De(this,"Month")}function je(){function e(e,t){return t.length-e.length}for(var t,r,n=[],i=[],o=[],s=0;s<12;s++)r=c([2e3,s]),t=p(this.monthsShort(r,"")),r=p(this.months(r,"")),n.push(t),i.push(r),o.push(r),o.push(t);n.sort(e),i.sort(e),o.sort(e),this._monthsRegex=new RegExp("^("+o.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+n.join("|")+")","i")}function ze(e,t,r,n,i,o,s){var a;return e<100&&0<=e?(a=new Date(e+400,t,r,n,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(e)):a=new Date(e,t,r,n,i,o,s),a}function Ye(e){var t;return e<100&&0<=e?((t=Array.prototype.slice.call(arguments))[0]=e+400,t=new Date(Date.UTC.apply(null,t)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function Ge(e,t,r){r=7+t-r;return r-(7+Ye(e,0,r).getUTCDay()-t)%7-1}function qe(e,t,r,n,i){var o,t=1+7*(t-1)+(7+r-n)%7+Ge(e,n,i),r=t<=0?Ie(o=e-1)+t:t>Ie(e)?(o=e+1,t-Ie(e)):(o=e,t);return{year:o,dayOfYear:r}}function Ke(e,t,r){var n,i,o=Ge(e.year(),t,r),o=Math.floor((e.dayOfYear()-o-1)/7)+1;return o<1?n=o+O(i=e.year()-1,t,r):o>O(e.year(),t,r)?(n=o-O(e.year(),t,r),i=e.year()+1):(i=e.year(),n=o),{week:n,year:i}}function O(e,t,r){var n=Ge(e,t,r),t=Ge(e+1,t,r);return(Ie(e)-n+t)/7}n("w",["ww",2],"wo","week"),n("W",["WW",2],"Wo","isoWeek"),d("w",r,l),d("ww",r,t),d("W",r,l),d("WW",r,t),xe(["w","ww","W","WW"],function(e,t,r,n){t[n.substr(0,1)]=C(e)});function Xe(e,t){return e.slice(t,7).concat(e.slice(0,t))}n("d",0,"do","day"),n("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),n("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),n("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),n("e",0,0,"weekday"),n("E",0,0,"isoWeekday"),d("d",r),d("e",r),d("E",r),d("dd",function(e,t){return t.weekdaysMinRegex(e)}),d("ddd",function(e,t){return t.weekdaysShortRegex(e)}),d("dddd",function(e,t){return t.weekdaysRegex(e)}),xe(["dd","ddd","dddd"],function(e,t,r,n){n=r._locale.weekdaysParse(e,n,r._strict);null!=n?t.d=n:b(r).invalidWeekday=e}),xe(["d","e","E"],function(e,t,r,n){t[n]=C(e)});var Je="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Ze="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Qe="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),et=i,tt=i,rt=i;function nt(){function e(e,t){return t.length-e.length}for(var t,r,n,i=[],o=[],s=[],a=[],l=0;l<7;l++)n=c([2e3,1]).day(l),t=p(this.weekdaysMin(n,"")),r=p(this.weekdaysShort(n,"")),n=p(this.weekdays(n,"")),i.push(t),o.push(r),s.push(n),a.push(t),a.push(r),a.push(n);i.sort(e),o.sort(e),s.sort(e),a.sort(e),this._weekdaysRegex=new RegExp("^("+a.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+o.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+i.join("|")+")","i")}function it(){return this.hours()%12||12}function ot(e,t){n(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function st(e,t){return t._meridiemParse}n("H",["HH",2],0,"hour"),n("h",["hh",2],0,it),n("k",["kk",2],0,function(){return this.hours()||24}),n("hmm",0,0,function(){return""+it.apply(this)+o(this.minutes(),2)}),n("hmmss",0,0,function(){return""+it.apply(this)+o(this.minutes(),2)+o(this.seconds(),2)}),n("Hmm",0,0,function(){return""+this.hours()+o(this.minutes(),2)}),n("Hmmss",0,0,function(){return""+this.hours()+o(this.minutes(),2)+o(this.seconds(),2)}),ot("a",!0),ot("A",!1),d("a",st),d("A",st),d("H",r,u),d("h",r,l),d("k",r,l),d("HH",r,t),d("hh",r,t),d("kk",r,t),d("hmm",fe),d("hmmss",ge),d("Hmm",fe),d("Hmmss",ge),E(["H","HH"],x),E(["k","kk"],function(e,t,r){e=C(e);t[x]=24===e?0:e}),E(["a","A"],function(e,t,r){r._isPm=r._locale.isPM(e),r._meridiem=e}),E(["h","hh"],function(e,t,r){t[x]=C(e),b(r).bigHour=!0}),E("hmm",function(e,t,r){var n=e.length-2;t[x]=C(e.substr(0,n)),t[R]=C(e.substr(n)),b(r).bigHour=!0}),E("hmmss",function(e,t,r){var n=e.length-4,i=e.length-2;t[x]=C(e.substr(0,n)),t[R]=C(e.substr(n,2)),t[A]=C(e.substr(i)),b(r).bigHour=!0}),E("Hmm",function(e,t,r){var n=e.length-2;t[x]=C(e.substr(0,n)),t[R]=C(e.substr(n))}),E("Hmmss",function(e,t,r){var n=e.length-4,i=e.length-2;t[x]=C(e.substr(0,n)),t[R]=C(e.substr(n,2)),t[A]=C(e.substr(i))});i=ke("Hours",!0);var at,lt={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:Fe,monthsShort:He,week:{dow:0,doy:6},weekdays:Je,weekdaysMin:Qe,weekdaysShort:Ze,meridiemParse:/[ap]\.?m?\.?/i},I={},ct={};function ut(e){return e&&e.toLowerCase().replace("_","-")}function dt(e){for(var t,r,n,i,o=0;o<e.length;){for(t=(i=ut(e[o]).split("-")).length,r=(r=ut(e[o+1]))?r.split("-"):null;0<t;){if(n=ht(i.slice(0,t).join("-")))return n;if(r&&r.length>=t&&function(e,t){for(var r=Math.min(e.length,t.length),n=0;n<r;n+=1)if(e[n]!==t[n])return n;return r}(i,r)>=t-1)break;t--}o++}return at}function ht(t){var e,r;if(void 0===I[t]&&"undefined"!=typeof module&&module&&module.exports&&(r=t)&&r.match("^[^/\\\\]*$"))try{e=at._abbr,require("./locale/"+t),pt(e)}catch(e){I[t]=null}return I[t]}function pt(e,t){return e&&((t=y(t)?M(e):ft(e,t))?at=t:"undefined"!=typeof console&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),at._abbr}function ft(e,t){if(null===t)return delete I[e],null;var r,n=lt;if(t.abbr=e,null!=I[e])J("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=I[e]._config;else if(null!=t.parentLocale)if(null!=I[t.parentLocale])n=I[t.parentLocale]._config;else{if(null==(r=ht(t.parentLocale)))return ct[t.parentLocale]||(ct[t.parentLocale]=[]),ct[t.parentLocale].push({name:e,config:t}),null;n=r._config}return I[e]=new Q(Z(n,t)),ct[e]&&ct[e].forEach(function(e){ft(e.name,e.config)}),pt(e),I[e]}function M(e){var t;if(!(e=e&&e._locale&&e._locale._abbr?e._locale._abbr:e))return at;if(!m(e)){if(t=ht(e))return t;e=[e]}return dt(e)}function gt(e){var t=e._a;return t&&-2===b(e).overflow&&(t=t[S]<0||11<t[S]?S:t[_]<1||t[_]>Le(t[T],t[S])?_:t[x]<0||24<t[x]||24===t[x]&&(0!==t[R]||0!==t[A]||0!==t[Ae])?x:t[R]<0||59<t[R]?R:t[A]<0||59<t[A]?A:t[Ae]<0||999<t[Ae]?Ae:-1,b(e)._overflowDayOfYear&&(t<T||_<t)&&(t=_),b(e)._overflowWeeks&&-1===t&&(t=Ne),b(e)._overflowWeekday&&-1===t&&(t=Oe),b(e).overflow=t),e}var mt=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,yt=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,vt=/Z|[+-]\d\d(?::?\d\d)?/,bt=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],wt=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Ct=/^\/?Date\((-?\d+)/i,Et=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Tt={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function St(e){var t,r,n,i,o,s,a=e._i,l=mt.exec(a)||yt.exec(a),a=bt.length,c=wt.length;if(l){for(b(e).iso=!0,t=0,r=a;t<r;t++)if(bt[t][1].exec(l[1])){i=bt[t][0],n=!1!==bt[t][2];break}if(null==i)e._isValid=!1;else{if(l[3]){for(t=0,r=c;t<r;t++)if(wt[t][1].exec(l[3])){o=(l[2]||" ")+wt[t][0];break}if(null==o)return void(e._isValid=!1)}if(n||null==o){if(l[4]){if(!vt.exec(l[4]))return void(e._isValid=!1);s="Z"}e._f=i+(o||"")+(s||""),Nt(e)}else e._isValid=!1}}else e._isValid=!1}function _t(e,t,r,n,i,o){e=[function(e){e=parseInt(e,10);{if(e<=49)return 2e3+e;if(e<=999)return 1900+e}return e}(e),He.indexOf(t),parseInt(r,10),parseInt(n,10),parseInt(i,10)];return o&&e.push(parseInt(o,10)),e}function xt(e){var t,r,n=Et.exec(e._i.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,""));n?(t=_t(n[4],n[3],n[2],n[5],n[6],n[7]),function(e,t,r){if(!e||Ze.indexOf(e)===new Date(t[0],t[1],t[2]).getDay())return 1;b(r).weekdayMismatch=!0,r._isValid=!1}(n[1],t,e)&&(e._a=t,e._tzm=(t=n[8],r=n[9],n=n[10],t?Tt[t]:r?0:60*(((t=parseInt(n,10))-(r=t%100))/100)+r),e._d=Ye.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),b(e).rfc2822=!0)):e._isValid=!1}function Rt(e,t,r){return null!=e?e:null!=t?t:r}function At(e){var t,r,n,i,o,s,a,l,c,u,d,h=[];if(!e._d){for(n=e,i=new Date(g.now()),r=n._useUTC?[i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate()]:[i.getFullYear(),i.getMonth(),i.getDate()],e._w&&null==e._a[_]&&null==e._a[S]&&(null!=(i=(n=e)._w).GG||null!=i.W||null!=i.E?(l=1,c=4,o=Rt(i.GG,n._a[T],Ke(k(),1,4).year),s=Rt(i.W,1),((a=Rt(i.E,1))<1||7<a)&&(u=!0)):(l=n._locale._week.dow,c=n._locale._week.doy,d=Ke(k(),l,c),o=Rt(i.gg,n._a[T],d.year),s=Rt(i.w,d.week),null!=i.d?((a=i.d)<0||6<a)&&(u=!0):null!=i.e?(a=i.e+l,(i.e<0||6<i.e)&&(u=!0)):a=l),s<1||s>O(o,l,c)?b(n)._overflowWeeks=!0:null!=u?b(n)._overflowWeekday=!0:(d=qe(o,s,a,l,c),n._a[T]=d.year,n._dayOfYear=d.dayOfYear)),null!=e._dayOfYear&&(i=Rt(e._a[T],r[T]),(e._dayOfYear>Ie(i)||0===e._dayOfYear)&&(b(e)._overflowDayOfYear=!0),u=Ye(i,0,e._dayOfYear),e._a[S]=u.getUTCMonth(),e._a[_]=u.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=h[t]=r[t];for(;t<7;t++)e._a[t]=h[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[x]&&0===e._a[R]&&0===e._a[A]&&0===e._a[Ae]&&(e._nextDay=!0,e._a[x]=0),e._d=(e._useUTC?Ye:ze).apply(null,h),o=e._useUTC?e._d.getUTCDay():e._d.getDay(),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[x]=24),e._w&&void 0!==e._w.d&&e._w.d!==o&&(b(e).weekdayMismatch=!0)}}function Nt(e){if(e._f===g.ISO_8601)St(e);else if(e._f===g.RFC_2822)xt(e);else{e._a=[],b(e).empty=!0;for(var t,r,n,i,o,s=""+e._i,a=s.length,l=0,c=se(e._f,e._locale).match(te)||[],u=c.length,d=0;d<u;d++)r=c[d],(t=(s.match(Te(r,e))||[])[0])&&(0<(n=s.substr(0,s.indexOf(t))).length&&b(e).unusedInput.push(n),s=s.slice(s.indexOf(t)+t.length),l+=t.length),ie[r]?(t?b(e).empty=!1:b(e).unusedTokens.push(r),n=r,o=e,null!=(i=t)&&h(_e,n)&&_e[n](i,o._a,o,n)):e._strict&&!t&&b(e).unusedTokens.push(r);b(e).charsLeftOver=a-l,0<s.length&&b(e).unusedInput.push(s),e._a[x]<=12&&!0===b(e).bigHour&&0<e._a[x]&&(b(e).bigHour=void 0),b(e).parsedDateParts=e._a.slice(0),b(e).meridiem=e._meridiem,e._a[x]=function(e,t,r){if(null==r)return t;return null!=e.meridiemHour?e.meridiemHour(t,r):null!=e.isPM?((e=e.isPM(r))&&t<12&&(t+=12),t=e||12!==t?t:0):t}(e._locale,e._a[x],e._meridiem),null!==(a=b(e).era)&&(e._a[T]=e._locale.erasConvertYear(a,e._a[T])),At(e),gt(e)}}function Ot(e){var t,r,n,i=e._i,o=e._f;if(e._locale=e._locale||M(e._l),null===i||void 0===o&&""===i)return B({nullInput:!0});if("string"==typeof i&&(e._i=i=e._locale.preparse(i)),w(i))return new q(gt(i));if(U(i))e._d=i;else if(m(o)){var s,a,l,c,u,d,h=e,p=!1,f=h._f.length;if(0===f)b(h).invalidFormat=!0,h._d=new Date(NaN);else{for(c=0;c<f;c++)u=0,d=!1,s=G({},h),null!=h._useUTC&&(s._useUTC=h._useUTC),s._f=h._f[c],Nt(s),$(s)&&(d=!0),u=(u+=b(s).charsLeftOver)+10*b(s).unusedTokens.length,b(s).score=u,p?u<l&&(l=u,a=s):(null==l||u<l||d)&&(l=u,a=s,d)&&(p=!0);W(h,a||s)}}else if(o)Nt(e);else if(y(o=(i=e)._i))i._d=new Date(g.now());else U(o)?i._d=new Date(o.valueOf()):"string"==typeof o?(r=i,null!==(t=Ct.exec(r._i))?r._d=new Date(+t[1]):(St(r),!1===r._isValid&&(delete r._isValid,xt(r),!1===r._isValid)&&(delete r._isValid,r._strict?r._isValid=!1:g.createFromInputFallback(r)))):m(o)?(i._a=V(o.slice(0),function(e){return parseInt(e,10)}),At(i)):F(o)?(t=i)._d||(n=void 0===(r=le(t._i)).day?r.date:r.day,t._a=V([r.year,r.month,n,r.hour,r.minute,r.second,r.millisecond],function(e){return e&&parseInt(e,10)}),At(t)):v(o)?i._d=new Date(o):g.createFromInputFallback(i);return $(e)||(e._d=null),e}function It(e,t,r,n,i){var o={};return!0!==t&&!1!==t||(n=t,t=void 0),!0!==r&&!1!==r||(n=r,r=void 0),(F(e)&&H(e)||m(e)&&0===e.length)&&(e=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=r,o._i=e,o._f=t,o._strict=n,(i=new q(gt(Ot(i=o))))._nextDay&&(i.add(1,"d"),i._nextDay=void 0),i}function k(e,t,r,n){return It(e,t,r,n,!1)}g.createFromInputFallback=e("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),g.ISO_8601=function(){},g.RFC_2822=function(){};fe=e("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=k.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:B()}),ge=e("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=k.apply(null,arguments);return this.isValid()&&e.isValid()?this<e?this:e:B()});function Mt(e,t){var r,n;if(!(t=1===t.length&&m(t[0])?t[0]:t).length)return k();for(r=t[0],n=1;n<t.length;++n)t[n].isValid()&&!t[n][e](r)||(r=t[n]);return r}var kt=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Dt(e){var e=le(e),t=e.year||0,r=e.quarter||0,n=e.month||0,i=e.week||e.isoWeek||0,o=e.day||0,s=e.hour||0,a=e.minute||0,l=e.second||0,c=e.millisecond||0;this._isValid=function(e){var t,r,n=!1,i=kt.length;for(t in e)if(h(e,t)&&(-1===N.call(kt,t)||null!=e[t]&&isNaN(e[t])))return!1;for(r=0;r<i;++r)if(e[kt[r]]){if(n)return!1;parseFloat(e[kt[r]])!==C(e[kt[r]])&&(n=!0)}return!0}(e),this._milliseconds=+c+1e3*l+6e4*a+1e3*s*60*60,this._days=+o+7*i,this._months=+n+3*r+12*t,this._data={},this._locale=M(),this._bubble()}function Pt(e){return e instanceof Dt}function Lt(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function Ft(e,r){n(e,0,0,function(){var e=this.utcOffset(),t="+";return e<0&&(e=-e,t="-"),t+o(~~(e/60),2)+r+o(~~e%60,2)})}Ft("Z",":"),Ft("ZZ",""),d("Z",Ee),d("ZZ",Ee),E(["Z","ZZ"],function(e,t,r){r._useUTC=!0,r._tzm=Ut(Ee,e)});var Ht=/([\+\-]|\d\d)/gi;function Ut(e,t){var t=(t||"").match(e);return null===t?null:0===(t=60*(e=((t[t.length-1]||[])+"").match(Ht)||["-",0,0])[1]+C(e[2]))?0:"+"===e[0]?t:-t}function Vt(e,t){var r;return t._isUTC?(t=t.clone(),r=(w(e)||U(e)?e:k(e)).valueOf()-t.valueOf(),t._d.setTime(t._d.valueOf()+r),g.updateOffset(t,!1),t):k(e).local()}function Wt(e){return-Math.round(e._d.getTimezoneOffset())}function $t(){return!!this.isValid()&&this._isUTC&&0===this._offset}g.updateOffset=function(){};var Bt=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,jt=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function D(e,t){var r,n=e;return Pt(e)?n={ms:e._milliseconds,d:e._days,M:e._months}:v(e)||!isNaN(+e)?(n={},t?n[t]=+e:n.milliseconds=+e):(t=Bt.exec(e))?(r="-"===t[1]?-1:1,n={y:0,d:C(t[_])*r,h:C(t[x])*r,m:C(t[R])*r,s:C(t[A])*r,ms:C(Lt(1e3*t[Ae]))*r}):(t=jt.exec(e))?(r="-"===t[1]?-1:1,n={y:zt(t[2],r),M:zt(t[3],r),w:zt(t[4],r),d:zt(t[5],r),h:zt(t[6],r),m:zt(t[7],r),s:zt(t[8],r)}):null==n?n={}:"object"==typeof n&&("from"in n||"to"in n)&&(t=function(e,t){var r;if(!e.isValid()||!t.isValid())return{milliseconds:0,months:0};t=Vt(t,e),e.isBefore(t)?r=Yt(e,t):((r=Yt(t,e)).milliseconds=-r.milliseconds,r.months=-r.months);return r}(k(n.from),k(n.to)),(n={}).ms=t.milliseconds,n.M=t.months),r=new Dt(n),Pt(e)&&h(e,"_locale")&&(r._locale=e._locale),Pt(e)&&h(e,"_isValid")&&(r._isValid=e._isValid),r}function zt(e,t){e=e&&parseFloat(e.replace(",","."));return(isNaN(e)?0:e)*t}function Yt(e,t){var r={};return r.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(r.months,"M").isAfter(t)&&--r.months,r.milliseconds=+t-+e.clone().add(r.months,"M"),r}function Gt(n,i){return function(e,t){var r;return null===t||isNaN(+t)||(J(i,"moment()."+i+"(period, number) is deprecated. Please use moment()."+i+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),r=e,e=t,t=r),qt(this,D(e,t),n),this}}function qt(e,t,r,n){var i=t._milliseconds,o=Lt(t._days),t=Lt(t._months);e.isValid()&&(n=null==n||n,t&&$e(e,De(e,"Month")+t*r),o&&Pe(e,"Date",De(e,"Date")+o*r),i&&e._d.setTime(e._d.valueOf()+i*r),n)&&g.updateOffset(e,o||t)}D.fn=Dt.prototype,D.invalid=function(){return D(NaN)};Fe=Gt(1,"add"),Je=Gt(-1,"subtract");function Kt(e){return"string"==typeof e||e instanceof String}function Xt(e){return w(e)||U(e)||Kt(e)||v(e)||function(t){var e=m(t),r=!1;e&&(r=0===t.filter(function(e){return!v(e)&&Kt(t)}).length);return e&&r}(e)||function(e){var t,r,n=F(e)&&!H(e),i=!1,o=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],s=o.length;for(t=0;t<s;t+=1)r=o[t],i=i||h(e,r);return n&&i}(e)||null==e}function Jt(e,t){var r,n;return e.date()<t.date()?-Jt(t,e):-((r=12*(t.year()-e.year())+(t.month()-e.month()))+(t-(n=e.clone().add(r,"months"))<0?(t-n)/(n-e.clone().add(r-1,"months")):(t-n)/(e.clone().add(1+r,"months")-n)))||0}function Zt(e){return void 0===e?this._locale._abbr:(null!=(e=M(e))&&(this._locale=e),this)}g.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",g.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";Qe=e("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return void 0===e?this.localeData():this.locale(e)});function Qt(){return this._locale}var er=126227808e5;function tr(e,t){return(e%t+t)%t}function rr(e,t,r){return e<100&&0<=e?new Date(e+400,t,r)-er:new Date(e,t,r).valueOf()}function nr(e,t,r){return e<100&&0<=e?Date.UTC(e+400,t,r)-er:Date.UTC(e,t,r)}function ir(e,t){return t.erasAbbrRegex(e)}function or(){for(var e,t,r,n=[],i=[],o=[],s=[],a=this.eras(),l=0,c=a.length;l<c;++l)e=p(a[l].name),t=p(a[l].abbr),r=p(a[l].narrow),i.push(e),n.push(t),o.push(r),s.push(e),s.push(t),s.push(r);this._erasRegex=new RegExp("^("+s.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+i.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+o.join("|")+")","i")}function sr(e,t){n(0,[e,e.length],0,t)}function ar(e,t,r,n,i){var o;return null==e?Ke(this,n,i).year:(o=O(e,n,i),function(e,t,r,n,i){e=qe(e,t,r,n,i),t=Ye(e.year,0,e.dayOfYear);return this.year(t.getUTCFullYear()),this.month(t.getUTCMonth()),this.date(t.getUTCDate()),this}.call(this,e,t=o<t?o:t,r,n,i))}n("N",0,0,"eraAbbr"),n("NN",0,0,"eraAbbr"),n("NNN",0,0,"eraAbbr"),n("NNNN",0,0,"eraName"),n("NNNNN",0,0,"eraNarrow"),n("y",["y",1],"yo","eraYear"),n("y",["yy",2],0,"eraYear"),n("y",["yyy",3],0,"eraYear"),n("y",["yyyy",4],0,"eraYear"),d("N",ir),d("NN",ir),d("NNN",ir),d("NNNN",function(e,t){return t.erasNameRegex(e)}),d("NNNNN",function(e,t){return t.erasNarrowRegex(e)}),E(["N","NN","NNN","NNNN","NNNNN"],function(e,t,r,n){n=r._locale.erasParse(e,n,r._strict);n?b(r).era=n:b(r).invalidEra=e}),d("y",be),d("yy",be),d("yyy",be),d("yyyy",be),d("yo",function(e,t){return t._eraYearOrdinalRegex||be}),E(["y","yy","yyy","yyyy"],T),E(["yo"],function(e,t,r,n){var i;r._locale._eraYearOrdinalRegex&&(i=e.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?t[T]=r._locale.eraYearOrdinalParse(e,i):t[T]=parseInt(e,10)}),n(0,["gg",2],0,function(){return this.weekYear()%100}),n(0,["GG",2],0,function(){return this.isoWeekYear()%100}),sr("gggg","weekYear"),sr("ggggg","weekYear"),sr("GGGG","isoWeekYear"),sr("GGGGG","isoWeekYear"),d("G",we),d("g",we),d("GG",r,t),d("gg",r,t),d("GGGG",ye,he),d("gggg",ye,he),d("GGGGG",ve,pe),d("ggggg",ve,pe),xe(["gggg","ggggg","GGGG","GGGGG"],function(e,t,r,n){t[n.substr(0,2)]=C(e)}),xe(["gg","GG"],function(e,t,r,n){t[n]=g.parseTwoDigitYear(e)}),n("Q",0,"Qo","quarter"),d("Q",ue),E("Q",function(e,t){t[S]=3*(C(e)-1)}),n("D",["DD",2],"Do","date"),d("D",r,l),d("DD",r,t),d("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient}),E(["D","DD"],_),E("Do",function(e,t){t[_]=C(e.match(r)[0])});ye=ke("Date",!0);n("DDD",["DDDD",3],"DDDo","dayOfYear"),d("DDD",me),d("DDDD",de),E(["DDD","DDDD"],function(e,t,r){r._dayOfYear=C(e)}),n("m",["mm",2],0,"minute"),d("m",r,u),d("mm",r,t),E(["m","mm"],R);var lr,he=ke("Minutes",!1),ve=(n("s",["ss",2],0,"second"),d("s",r,u),d("ss",r,t),E(["s","ss"],A),ke("Seconds",!1));for(n("S",0,0,function(){return~~(this.millisecond()/100)}),n(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),n(0,["SSS",3],0,"millisecond"),n(0,["SSSS",4],0,function(){return 10*this.millisecond()}),n(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),n(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),n(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),n(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),n(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),d("S",me,ue),d("SS",me,t),d("SSS",me,de),lr="SSSS";lr.length<=9;lr+="S")d(lr,be);function cr(e,t){t[Ae]=C(1e3*("0."+e))}for(lr="S";lr.length<=9;lr+="S")E(lr,cr);pe=ke("Milliseconds",!1),n("z",0,0,"zoneAbbr"),n("zz",0,0,"zoneName");l=q.prototype;function ur(e){return e}l.add=Fe,l.calendar=function(e,t){1===arguments.length&&(arguments[0]?Xt(arguments[0])?(e=arguments[0],t=void 0):function(e){for(var t=F(e)&&!H(e),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i=0;i<n.length;i+=1)r=r||h(e,n[i]);return t&&r}(arguments[0])&&(t=arguments[0],e=void 0):t=e=void 0);var e=e||k(),r=Vt(e,this).startOf("day"),r=g.calendarFormat(this,r)||"sameElse",t=t&&(s(t[r])?t[r].call(this,e):t[r]);return this.format(t||this.localeData().calendar(r,this,k(e)))},l.clone=function(){return new q(this)},l.diff=function(e,t,r){var n,i,o;if(!this.isValid())return NaN;if(!(n=Vt(e,this)).isValid())return NaN;switch(i=6e4*(n.utcOffset()-this.utcOffset()),t=a(t)){case"year":o=Jt(this,n)/12;break;case"month":o=Jt(this,n);break;case"quarter":o=Jt(this,n)/3;break;case"second":o=(this-n)/1e3;break;case"minute":o=(this-n)/6e4;break;case"hour":o=(this-n)/36e5;break;case"day":o=(this-n-i)/864e5;break;case"week":o=(this-n-i)/6048e5;break;default:o=this-n}return r?o:f(o)},l.endOf=function(e){var t,r;if(void 0!==(e=a(e))&&"millisecond"!==e&&this.isValid()){switch(r=this._isUTC?nr:rr,e){case"year":t=r(this.year()+1,0,1)-1;break;case"quarter":t=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=r(this.year(),this.month()+1,1)-1;break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=36e5-tr(t+(this._isUTC?0:6e4*this.utcOffset()),36e5)-1;break;case"minute":t=this._d.valueOf(),t+=6e4-tr(t,6e4)-1;break;case"second":t=this._d.valueOf(),t+=1e3-tr(t,1e3)-1}this._d.setTime(t),g.updateOffset(this,!0)}return this},l.format=function(e){return e=e||(this.isUtc()?g.defaultFormatUtc:g.defaultFormat),e=oe(this,e),this.localeData().postformat(e)},l.from=function(e,t){return this.isValid()&&(w(e)&&e.isValid()||k(e).isValid())?D({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},l.fromNow=function(e){return this.from(k(),e)},l.to=function(e,t){return this.isValid()&&(w(e)&&e.isValid()||k(e).isValid())?D({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},l.toNow=function(e){return this.to(k(),e)},l.get=function(e){return s(this[e=a(e)])?this[e]():this},l.invalidAt=function(){return b(this).overflow},l.isAfter=function(e,t){return e=w(e)?e:k(e),!(!this.isValid()||!e.isValid())&&("millisecond"===(t=a(t)||"millisecond")?this.valueOf()>e.valueOf():e.valueOf()<this.clone().startOf(t).valueOf())},l.isBefore=function(e,t){return e=w(e)?e:k(e),!(!this.isValid()||!e.isValid())&&("millisecond"===(t=a(t)||"millisecond")?this.valueOf()<e.valueOf():this.clone().endOf(t).valueOf()<e.valueOf())},l.isBetween=function(e,t,r,n){return e=w(e)?e:k(e),t=w(t)?t:k(t),!!(this.isValid()&&e.isValid()&&t.isValid())&&("("===(n=n||"()")[0]?this.isAfter(e,r):!this.isBefore(e,r))&&(")"===n[1]?this.isBefore(t,r):!this.isAfter(t,r))},l.isSame=function(e,t){var e=w(e)?e:k(e);return!(!this.isValid()||!e.isValid())&&("millisecond"===(t=a(t)||"millisecond")?this.valueOf()===e.valueOf():(e=e.valueOf(),this.clone().startOf(t).valueOf()<=e&&e<=this.clone().endOf(t).valueOf()))},l.isSameOrAfter=function(e,t){return this.isSame(e,t)||this.isAfter(e,t)},l.isSameOrBefore=function(e,t){return this.isSame(e,t)||this.isBefore(e,t)},l.isValid=function(){return $(this)},l.lang=Qe,l.locale=Zt,l.localeData=Qt,l.max=ge,l.min=fe,l.parsingFlags=function(){return W({},b(this))},l.set=function(e,t){if("object"==typeof e)for(var r=function(e){var t,r=[];for(t in e)h(e,t)&&r.push({unit:t,priority:ce[t]});return r.sort(function(e,t){return e.priority-t.priority}),r}(e=le(e)),n=r.length,i=0;i<n;i++)this[r[i].unit](e[r[i].unit]);else if(s(this[e=a(e)]))return this[e](t);return this},l.startOf=function(e){var t,r;if(void 0!==(e=a(e))&&"millisecond"!==e&&this.isValid()){switch(r=this._isUTC?nr:rr,e){case"year":t=r(this.year(),0,1);break;case"quarter":t=r(this.year(),this.month()-this.month()%3,1);break;case"month":t=r(this.year(),this.month(),1);break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=r(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=tr(t+(this._isUTC?0:6e4*this.utcOffset()),36e5);break;case"minute":t=this._d.valueOf(),t-=tr(t,6e4);break;case"second":t=this._d.valueOf(),t-=tr(t,1e3)}this._d.setTime(t),g.updateOffset(this,!0)}return this},l.subtract=Je,l.toArray=function(){return[this.year(),this.month(),this.date(),this.hour(),this.minute(),this.second(),this.millisecond()]},l.toObject=function(){return{years:this.year(),months:this.month(),date:this.date(),hours:this.hours(),minutes:this.minutes(),seconds:this.seconds(),milliseconds:this.milliseconds()}},l.toDate=function(){return new Date(this.valueOf())},l.toISOString=function(e){var t;return this.isValid()?(t=(e=!0!==e)?this.clone().utc():this).year()<0||9999<t.year()?oe(t,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):s(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",oe(t,"Z")):oe(t,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ"):null},l.inspect=function(){var e,t,r;return this.isValid()?(t="moment",e="",this.isLocal()||(t=0===this.utcOffset()?"moment.utc":"moment.parseZone",e="Z"),t="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",this.format(t+r+"-MM-DD[T]HH:mm:ss.SSS"+(e+'[")]'))):"moment.invalid(/* "+this._i+" */)"},"undefined"!=typeof Symbol&&null!=Symbol.for&&(l[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),l.toJSON=function(){return this.isValid()?this.toISOString():null},l.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},l.unix=function(){return Math.floor(this.valueOf()/1e3)},l.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},l.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},l.eraName=function(){for(var e,t=this.localeData().eras(),r=0,n=t.length;r<n;++r){if(e=this.clone().startOf("day").valueOf(),t[r].since<=e&&e<=t[r].until)return t[r].name;if(t[r].until<=e&&e<=t[r].since)return t[r].name}return""},l.eraNarrow=function(){for(var e,t=this.localeData().eras(),r=0,n=t.length;r<n;++r){if(e=this.clone().startOf("day").valueOf(),t[r].since<=e&&e<=t[r].until)return t[r].narrow;if(t[r].until<=e&&e<=t[r].since)return t[r].narrow}return""},l.eraAbbr=function(){for(var e,t=this.localeData().eras(),r=0,n=t.length;r<n;++r){if(e=this.clone().startOf("day").valueOf(),t[r].since<=e&&e<=t[r].until)return t[r].abbr;if(t[r].until<=e&&e<=t[r].since)return t[r].abbr}return""},l.eraYear=function(){for(var e,t,r=this.localeData().eras(),n=0,i=r.length;n<i;++n)if(e=r[n].since<=r[n].until?1:-1,t=this.clone().startOf("day").valueOf(),r[n].since<=t&&t<=r[n].until||r[n].until<=t&&t<=r[n].since)return(this.year()-g(r[n].since).year())*e+r[n].offset;return this.year()},l.year=Me,l.isLeapYear=function(){return Re(this.year())},l.weekYear=function(e){return ar.call(this,e,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)},l.isoWeekYear=function(e){return ar.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)},l.quarter=l.quarters=function(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)},l.month=Be,l.daysInMonth=function(){return Le(this.year(),this.month())},l.week=l.weeks=function(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")},l.isoWeek=l.isoWeeks=function(e){var t=Ke(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")},l.weeksInYear=function(){var e=this.localeData()._week;return O(this.year(),e.dow,e.doy)},l.weeksInWeekYear=function(){var e=this.localeData()._week;return O(this.weekYear(),e.dow,e.doy)},l.isoWeeksInYear=function(){return O(this.year(),1,4)},l.isoWeeksInISOWeekYear=function(){return O(this.isoWeekYear(),1,4)},l.date=ye,l.day=l.days=function(e){var t,r,n;return this.isValid()?(t=De(this,"Day"),null!=e?(r=e,n=this.localeData(),e="string"!=typeof r?r:isNaN(r)?"number"==typeof(r=n.weekdaysParse(r))?r:null:parseInt(r,10),this.add(e-t,"d")):t):null!=e?this:NaN},l.weekday=function(e){var t;return this.isValid()?(t=(this.day()+7-this.localeData()._week.dow)%7,null==e?t:this.add(e-t,"d")):null!=e?this:NaN},l.isoWeekday=function(e){var t,r;return this.isValid()?null!=e?(t=e,r=this.localeData(),r="string"==typeof t?r.weekdaysParse(t)%7||7:isNaN(t)?null:t,this.day(this.day()%7?r:r-7)):this.day()||7:null!=e?this:NaN},l.dayOfYear=function(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")},l.hour=l.hours=i,l.minute=l.minutes=he,l.second=l.seconds=ve,l.millisecond=l.milliseconds=pe,l.utcOffset=function(e,t,r){var n,i=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null==e)return this._isUTC?i:Wt(this);if("string"==typeof e){if(null===(e=Ut(Ee,e)))return this}else Math.abs(e)<16&&!r&&(e*=60);return!this._isUTC&&t&&(n=Wt(this)),this._offset=e,this._isUTC=!0,null!=n&&this.add(n,"m"),i!==e&&(!t||this._changeInProgress?qt(this,D(e-i,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,g.updateOffset(this,!0),this._changeInProgress=null)),this},l.utc=function(e){return this.utcOffset(0,e)},l.local=function(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e)&&this.subtract(Wt(this),"m"),this},l.parseZone=function(){var e;return null!=this._tzm?this.utcOffset(this._tzm,!1,!0):"string"==typeof this._i&&(null!=(e=Ut(Ce,this._i))?this.utcOffset(e):this.utcOffset(0,!0)),this},l.hasAlignedHourOffset=function(e){return!!this.isValid()&&(e=e?k(e).utcOffset():0,(this.utcOffset()-e)%60==0)},l.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},l.isLocal=function(){return!!this.isValid()&&!this._isUTC},l.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},l.isUtc=$t,l.isUTC=$t,l.zoneAbbr=function(){return this._isUTC?"UTC":""},l.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},l.dates=e("dates accessor is deprecated. Use date instead.",ye),l.months=e("months accessor is deprecated. Use month instead",Be),l.years=e("years accessor is deprecated. Use year instead",Me),l.zone=e("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",function(e,t){return null!=e?(this.utcOffset(e="string"!=typeof e?-e:e,t),this):-this.utcOffset()}),l.isDSTShifted=e("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",function(){var e,t;return y(this._isDSTShifted)&&(G(e={},this),(e=Ot(e))._a?(t=(e._isUTC?c:k)(e._a),this._isDSTShifted=this.isValid()&&0<function(e,t,r){for(var n=Math.min(e.length,t.length),i=Math.abs(e.length-t.length),o=0,s=0;s<n;s++)(r&&e[s]!==t[s]||!r&&C(e[s])!==C(t[s]))&&o++;return o+i}(e._a,t.toArray())):this._isDSTShifted=!1),this._isDSTShifted});u=Q.prototype;function dr(e,t,r,n){var i=M(),n=c().set(n,t);return i[r](n,e)}function hr(e,t,r){if(v(e)&&(t=e,e=void 0),e=e||"",null!=t)return dr(e,t,r,"month");for(var n=[],i=0;i<12;i++)n[i]=dr(e,i,r,"month");return n}function pr(e,t,r,n){t=("boolean"==typeof e?v(t)&&(r=t,t=void 0):(t=e,e=!1,v(r=t)&&(r=t,t=void 0)),t||"");var i,o=M(),s=e?o._week.dow:0,a=[];if(null!=r)return dr(t,(r+s)%7,n,"day");for(i=0;i<7;i++)a[i]=dr(t,(i+s)%7,n,"day");return a}u.calendar=function(e,t,r){return s(e=this._calendar[e]||this._calendar.sameElse)?e.call(t,r):e},u.longDateFormat=function(e){var t=this._longDateFormat[e],r=this._longDateFormat[e.toUpperCase()];return t||!r?t:(this._longDateFormat[e]=r.match(te).map(function(e){return"MMMM"===e||"MM"===e||"DD"===e||"dddd"===e?e.slice(1):e}).join(""),this._longDateFormat[e])},u.invalidDate=function(){return this._invalidDate},u.ordinal=function(e){return this._ordinal.replace("%d",e)},u.preparse=ur,u.postformat=ur,u.relativeTime=function(e,t,r,n){var i=this._relativeTime[r];return s(i)?i(e,t,r,n):i.replace(/%d/i,e)},u.pastFuture=function(e,t){return s(e=this._relativeTime[0<e?"future":"past"])?e(t):e.replace(/%s/i,t)},u.set=function(e){var t,r;for(r in e)h(e,r)&&(s(t=e[r])?this[r]=t:this["_"+r]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)},u.eras=function(e,t){for(var r,n=this._eras||M("en")._eras,i=0,o=n.length;i<o;++i)switch("string"==typeof n[i].since&&(r=g(n[i].since).startOf("day"),n[i].since=r.valueOf()),typeof n[i].until){case"undefined":n[i].until=1/0;break;case"string":r=g(n[i].until).startOf("day").valueOf(),n[i].until=r.valueOf()}return n},u.erasParse=function(e,t,r){var n,i,o,s,a,l=this.eras();for(e=e.toUpperCase(),n=0,i=l.length;n<i;++n)if(o=l[n].name.toUpperCase(),s=l[n].abbr.toUpperCase(),a=l[n].narrow.toUpperCase(),r)switch(t){case"N":case"NN":case"NNN":if(s===e)return l[n];break;case"NNNN":if(o===e)return l[n];break;case"NNNNN":if(a===e)return l[n]}else if(0<=[o,s,a].indexOf(e))return l[n]},u.erasConvertYear=function(e,t){var r=e.since<=e.until?1:-1;return void 0===t?g(e.since).year():g(e.since).year()+(t-e.offset)*r},u.erasAbbrRegex=function(e){return h(this,"_erasAbbrRegex")||or.call(this),e?this._erasAbbrRegex:this._erasRegex},u.erasNameRegex=function(e){return h(this,"_erasNameRegex")||or.call(this),e?this._erasNameRegex:this._erasRegex},u.erasNarrowRegex=function(e){return h(this,"_erasNarrowRegex")||or.call(this),e?this._erasNarrowRegex:this._erasRegex},u.months=function(e,t){return e?(m(this._months)?this._months:this._months[(this._months.isFormat||Ue).test(t)?"format":"standalone"])[e.month()]:m(this._months)?this._months:this._months.standalone},u.monthsShort=function(e,t){return e?(m(this._monthsShort)?this._monthsShort:this._monthsShort[Ue.test(t)?"format":"standalone"])[e.month()]:m(this._monthsShort)?this._monthsShort:this._monthsShort.standalone},u.monthsParse=function(e,t,r){var n,i;if(this._monthsParseExact)return function(e,t,r){var n,i,o,e=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)o=c([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(o,"").toLocaleLowerCase();return r?"MMM"===t?-1!==(i=N.call(this._shortMonthsParse,e))?i:null:-1!==(i=N.call(this._longMonthsParse,e))?i:null:"MMM"===t?-1!==(i=N.call(this._shortMonthsParse,e))||-1!==(i=N.call(this._longMonthsParse,e))?i:null:-1!==(i=N.call(this._longMonthsParse,e))||-1!==(i=N.call(this._shortMonthsParse,e))?i:null}.call(this,e,t,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(i=c([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),r||this._monthsParse[n]||(i="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[n]=new RegExp(i.replace(".",""),"i")),r&&"MMMM"===t&&this._longMonthsParse[n].test(e))return n;if(r&&"MMM"===t&&this._shortMonthsParse[n].test(e))return n;if(!r&&this._monthsParse[n].test(e))return n}},u.monthsRegex=function(e){return this._monthsParseExact?(h(this,"_monthsRegex")||je.call(this),e?this._monthsStrictRegex:this._monthsRegex):(h(this,"_monthsRegex")||(this._monthsRegex=We),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)},u.monthsShortRegex=function(e){return this._monthsParseExact?(h(this,"_monthsRegex")||je.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(h(this,"_monthsShortRegex")||(this._monthsShortRegex=Ve),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)},u.week=function(e){return Ke(e,this._week.dow,this._week.doy).week},u.firstDayOfYear=function(){return this._week.doy},u.firstDayOfWeek=function(){return this._week.dow},u.weekdays=function(e,t){return t=m(this._weekdays)?this._weekdays:this._weekdays[e&&!0!==e&&this._weekdays.isFormat.test(t)?"format":"standalone"],!0===e?Xe(t,this._week.dow):e?t[e.day()]:t},u.weekdaysMin=function(e){return!0===e?Xe(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin},u.weekdaysShort=function(e){return!0===e?Xe(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort},u.weekdaysParse=function(e,t,r){var n,i;if(this._weekdaysParseExact)return function(e,t,r){var n,i,o,e=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)o=c([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(o,"").toLocaleLowerCase();return r?"dddd"===t?-1!==(i=N.call(this._weekdaysParse,e))?i:null:"ddd"===t?-1!==(i=N.call(this._shortWeekdaysParse,e))?i:null:-1!==(i=N.call(this._minWeekdaysParse,e))?i:null:"dddd"===t?-1!==(i=N.call(this._weekdaysParse,e))||-1!==(i=N.call(this._shortWeekdaysParse,e))||-1!==(i=N.call(this._minWeekdaysParse,e))?i:null:"ddd"===t?-1!==(i=N.call(this._shortWeekdaysParse,e))||-1!==(i=N.call(this._weekdaysParse,e))||-1!==(i=N.call(this._minWeekdaysParse,e))?i:null:-1!==(i=N.call(this._minWeekdaysParse,e))||-1!==(i=N.call(this._weekdaysParse,e))||-1!==(i=N.call(this._shortWeekdaysParse,e))?i:null}.call(this,e,t,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(i=c([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(i="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[n]=new RegExp(i.replace(".",""),"i")),r&&"dddd"===t&&this._fullWeekdaysParse[n].test(e))return n;if(r&&"ddd"===t&&this._shortWeekdaysParse[n].test(e))return n;if(r&&"dd"===t&&this._minWeekdaysParse[n].test(e))return n;if(!r&&this._weekdaysParse[n].test(e))return n}},u.weekdaysRegex=function(e){return this._weekdaysParseExact?(h(this,"_weekdaysRegex")||nt.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(h(this,"_weekdaysRegex")||(this._weekdaysRegex=et),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)},u.weekdaysShortRegex=function(e){return this._weekdaysParseExact?(h(this,"_weekdaysRegex")||nt.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(h(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=tt),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},u.weekdaysMinRegex=function(e){return this._weekdaysParseExact?(h(this,"_weekdaysRegex")||nt.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(h(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=rt),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},u.isPM=function(e){return"p"===(e+"").toLowerCase().charAt(0)},u.meridiem=function(e,t,r){return 11<e?r?"pm":"PM":r?"am":"AM"},pt("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===C(e%100/10)?"th":1==t?"st":2==t?"nd":3==t?"rd":"th")}}),g.lang=e("moment.lang is deprecated. Use moment.locale instead.",pt),g.langData=e("moment.langData is deprecated. Use moment.localeData instead.",M);var fr=Math.abs;function gr(e,t,r,n){t=D(t,r);return e._milliseconds+=n*t._milliseconds,e._days+=n*t._days,e._months+=n*t._months,e._bubble()}function mr(e){return e<0?Math.floor(e):Math.ceil(e)}function yr(e){return 4800*e/146097}function vr(e){return 146097*e/4800}function br(e){return function(){return this.as(e)}}ue=br("ms"),t=br("s"),me=br("m"),de=br("h"),Fe=br("d"),ge=br("w"),fe=br("M"),Je=br("Q"),i=br("y"),he=ue;function wr(e){return function(){return this.isValid()?this._data[e]:NaN}}var ve=wr("milliseconds"),pe=wr("seconds"),ye=wr("minutes"),Me=wr("hours"),u=wr("days"),Cr=wr("months"),Er=wr("years");var Tr=Math.round,Sr={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function _r(e,t,r,n){var i=D(e).abs(),o=Tr(i.as("s")),s=Tr(i.as("m")),a=Tr(i.as("h")),l=Tr(i.as("d")),c=Tr(i.as("M")),u=Tr(i.as("w")),i=Tr(i.as("y")),o=(o<=r.ss?["s",o]:o<r.s&&["ss",o])||(s<=1?["m"]:s<r.m&&["mm",s])||(a<=1?["h"]:a<r.h&&["hh",a])||(l<=1?["d"]:l<r.d&&["dd",l]);return(o=(o=null!=r.w?o||(u<=1?["w"]:u<r.w&&["ww",u]):o)||(c<=1?["M"]:c<r.M&&["MM",c])||(i<=1?["y"]:["yy",i]))[2]=t,o[3]=0<+e,o[4]=n,function(e,t,r,n,i){return i.relativeTime(t||1,!!r,e,n)}.apply(null,o)}var xr=Math.abs;function Rr(e){return(0<e)-(e<0)||+e}function Ar(){var e,t,r,n,i,o,s,a,l,c,u;return this.isValid()?(e=xr(this._milliseconds)/1e3,t=xr(this._days),r=xr(this._months),(a=this.asSeconds())?(n=f(e/60),i=f(n/60),e%=60,n%=60,o=f(r/12),r%=12,s=e?e.toFixed(3).replace(/\.?0+$/,""):"",l=Rr(this._months)!==Rr(a)?"-":"",c=Rr(this._days)!==Rr(a)?"-":"",u=Rr(this._milliseconds)!==Rr(a)?"-":"",(a<0?"-":"")+"P"+(o?l+o+"Y":"")+(r?l+r+"M":"")+(t?c+t+"D":"")+(i||n||e?"T":"")+(i?u+i+"H":"")+(n?u+n+"M":"")+(e?u+s+"S":"")):"P0D"):this.localeData().invalidDate()}var P=Dt.prototype;return P.isValid=function(){return this._isValid},P.abs=function(){var e=this._data;return this._milliseconds=fr(this._milliseconds),this._days=fr(this._days),this._months=fr(this._months),e.milliseconds=fr(e.milliseconds),e.seconds=fr(e.seconds),e.minutes=fr(e.minutes),e.hours=fr(e.hours),e.months=fr(e.months),e.years=fr(e.years),this},P.add=function(e,t){return gr(this,e,t,1)},P.subtract=function(e,t){return gr(this,e,t,-1)},P.as=function(e){if(!this.isValid())return NaN;var t,r,n=this._milliseconds;if("month"===(e=a(e))||"quarter"===e||"year"===e)switch(t=this._days+n/864e5,r=this._months+yr(t),e){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(t=this._days+Math.round(vr(this._months)),e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return 24*t+n/36e5;case"minute":return 1440*t+n/6e4;case"second":return 86400*t+n/1e3;case"millisecond":return Math.floor(864e5*t)+n;default:throw new Error("Unknown unit "+e)}},P.asMilliseconds=ue,P.asSeconds=t,P.asMinutes=me,P.asHours=de,P.asDays=Fe,P.asWeeks=ge,P.asMonths=fe,P.asQuarters=Je,P.asYears=i,P.valueOf=he,P._bubble=function(){var e=this._milliseconds,t=this._days,r=this._months,n=this._data;return 0<=e&&0<=t&&0<=r||e<=0&&t<=0&&r<=0||(e+=864e5*mr(vr(r)+t),r=t=0),n.milliseconds=e%1e3,e=f(e/1e3),n.seconds=e%60,e=f(e/60),n.minutes=e%60,e=f(e/60),n.hours=e%24,t+=f(e/24),r+=e=f(yr(t)),t-=mr(vr(e)),e=f(r/12),r%=12,n.days=t,n.months=r,n.years=e,this},P.clone=function(){return D(this)},P.get=function(e){return e=a(e),this.isValid()?this[e+"s"]():NaN},P.milliseconds=ve,P.seconds=pe,P.minutes=ye,P.hours=Me,P.days=u,P.weeks=function(){return f(this.days()/7)},P.months=Cr,P.years=Er,P.humanize=function(e,t){var r,n;return this.isValid()?(r=!1,n=Sr,"object"==typeof e&&(t=e,e=!1),"boolean"==typeof e&&(r=e),"object"==typeof t&&(n=Object.assign({},Sr,t),null!=t.s)&&null==t.ss&&(n.ss=t.s-1),e=this.localeData(),t=_r(this,!r,n,e),r&&(t=e.pastFuture(+this,t)),e.postformat(t)):this.localeData().invalidDate()},P.toISOString=Ar,P.toString=Ar,P.toJSON=Ar,P.locale=Zt,P.localeData=Qt,P.toIsoString=e("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Ar),P.lang=Qe,n("X",0,0,"unix"),n("x",0,0,"valueOf"),d("x",we),d("X",/[+-]?\d+(\.\d{1,3})?/),E("X",function(e,t,r){r._d=new Date(1e3*parseFloat(e))}),E("x",function(e,t,r){r._d=new Date(C(e))}),g.version="2.30.1",L=k,g.fn=l,g.min=function(){return Mt("isBefore",[].slice.call(arguments,0))},g.max=function(){return Mt("isAfter",[].slice.call(arguments,0))},g.now=function(){return Date.now?Date.now():+new Date},g.utc=c,g.unix=function(e){return k(1e3*e)},g.months=function(e,t){return hr(e,t,"months")},g.isDate=U,g.locale=pt,g.invalid=B,g.duration=D,g.isMoment=w,g.weekdays=function(e,t,r){return pr(e,t,r,"weekdays")},g.parseZone=function(){return k.apply(null,arguments).parseZone()},g.localeData=M,g.isDuration=Pt,g.monthsShort=function(e,t){return hr(e,t,"monthsShort")},g.weekdaysMin=function(e,t,r){return pr(e,t,r,"weekdaysMin")},g.defineLocale=ft,g.updateLocale=function(e,t){var r,n;return null!=t?(n=lt,null!=I[e]&&null!=I[e].parentLocale?I[e].set(Z(I[e]._config,t)):(t=Z(n=null!=(r=ht(e))?r._config:n,t),null==r&&(t.abbr=e),(n=new Q(t)).parentLocale=I[e],I[e]=n),pt(e)):null!=I[e]&&(null!=I[e].parentLocale?(I[e]=I[e].parentLocale,e===pt()&&pt(e)):null!=I[e]&&delete I[e]),I[e]},g.locales=function(){return ee(I)},g.weekdaysShort=function(e,t,r){return pr(e,t,r,"weekdaysShort")},g.normalizeUnits=a,g.relativeTimeRounding=function(e){return void 0===e?Tr:"function"==typeof e&&(Tr=e,!0)},g.relativeTimeThreshold=function(e,t){return void 0!==Sr[e]&&(void 0===t?Sr[e]:(Sr[e]=t,"s"===e&&(Sr.ss=t-1),!0))},g.calendarFormat=function(e,t){return(e=e.diff(t,"days",!0))<-6?"sameElse":e<-1?"lastWeek":e<0?"lastDay":e<1?"sameDay":e<2?"nextDay":e<7?"nextWeek":"sameElse"},g.prototype=l,g.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},g}),!function(e,t){"use strict";var r;if("object"==typeof exports){try{r=require("moment")}catch(e){}module.exports=t(r)}else"function"==typeof define&&define.amd?define(function(e){try{r=e("moment")}catch(e){}return t(r)}):e.Pikaday=t(e.moment)}(this,function(O){"use strict";function i(e,t,r,n){l?e.addEventListener(t,r,!!n):e.attachEvent("on"+t,r)}function t(e,t,r,n){l?e.removeEventListener(t,r,!!n):e.detachEvent("on"+t,r)}function o(e,t){return-1!==(" "+e.className+" ").indexOf(" "+t+" ")}function h(e,t){o(e,t)||(e.className=""===e.className?t:e.className+" "+t)}function p(e,t){e.className=(e=(" "+e.className+" ").replace(" "+t+" "," ")).trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function m(e){return/Array/.test(Object.prototype.toString.call(e))}function I(e){return/Date/.test(Object.prototype.toString.call(e))&&!isNaN(e.getTime())}function M(e,t){return[31,(e=e)%4==0&&e%100!=0||e%400==0?29:28,31,30,31,30,31,31,30,31,30,31][t]}function k(e){I(e)&&e.setHours(0,0,0,0)}function D(e,t){return e.getTime()===t.getTime()}function s(e,t,r){var n,i;for(n in t)(i=void 0!==e[n])&&"object"==typeof t[n]&&null!==t[n]&&void 0===t[n].nodeName?I(t[n])?r&&(e[n]=new Date(t[n].getTime())):m(t[n])?r&&(e[n]=t[n].slice(0)):e[n]=s({},t[n],r):!r&&i||(e[n]=t[n]);return e}function a(e,t,r){var n;f.createEvent?((n=f.createEvent("HTMLEvents")).initEvent(t,!0,!1),n=s(n,r),e.dispatchEvent(n)):f.createEventObject&&(n=f.createEventObject(),n=s(n,r),e.fireEvent("on"+t,n))}function r(e){return e.month<0&&(e.year-=Math.ceil(Math.abs(e.month)/12),e.month+=12),11<e.month&&(e.year+=Math.floor(Math.abs(e.month)/12),e.month-=12),e}function P(e,t){function r(e){return(e+7-1)%7}e.setHours(0,0,0,0);var n=e.getDate(),i=e.getDay(),o=t-1,n=(e.setDate(n+o-r(i)),new Date(e.getFullYear(),0,t)),i=(e.getTime()-n.getTime())/864e5;return 1+Math.round((i-o+r(n.getDay()))/7)}function L(e,t,r){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+r+'">'+function(e){var t,r=[];for(e.showWeekNumber&&r.push("<th></th>"),t=0;t<7;t++)r.push('<th scope="col"><abbr title="'+u(e,t)+'">'+u(e,t,!0)+"</abbr></th>");return"<thead><tr>"+(e.isRTL?r.reverse():r).join("")+"</tr></thead>"}(e)+"<tbody>"+t.join("")+"</tbody></table>"}function e(e){var r=this,n=r.config(e),e=(r._onMouseDown=function(e){if(r._v){var t=(e=e||window.event).target||e.srcElement;if(t)if(o(t,"is-disabled")||(!o(t,"pika-button")||o(t,"is-empty")||o(t.parentNode,"is-disabled")?o(t,"pika-prev")?r.prevMonth():o(t,"pika-next")&&r.nextMonth():(r.setDate(new Date(t.getAttribute("data-pika-year"),t.getAttribute("data-pika-month"),t.getAttribute("data-pika-day"))),n.bound&&c(function(){r.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()},100))),o(t,"pika-select"))r._c=!0;else{if(!e.preventDefault)return e.returnValue=!1;e.preventDefault()}}},r._onChange=function(e){e=(e=e||window.event).target||e.srcElement;e&&(o(e,"pika-select-month")?r.gotoMonth(e.value):o(e,"pika-select-year")&&r.gotoYear(e.value))},r._onKeyChange=function(e){if(e=e||window.event,r.isVisible())switch(e.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:r.adjustDate("subtract",1);break;case 38:r.adjustDate("subtract",7);break;case 39:r.adjustDate("add",1);break;case 40:r.adjustDate("add",7);break;case 8:case 46:r.setDate(null)}},r._parseFieldValue=function(){var e;return n.parse?n.parse(n.field.value,n.format):F?(e=O(n.field.value,n.format,n.formatStrict))&&e.isValid()?e.toDate():null:new Date(Date.parse(n.field.value))},r._onInputChange=function(e){e.firedBy===r||(e=r._parseFieldValue(),I(e)&&r.setDate(e),r._v)||r.show()},r._onInputFocus=function(){r.show()},r._onInputClick=function(){r.show()},r._onInputBlur=function(){var e=f.activeElement;do{if(o(e,"pika-single"))return}while(e=e.parentNode);r._c||(r._b=c(function(){r.hide()},50)),r._c=!1},r._onClick=function(e){var e=(e=e||window.event).target||e.srcElement,t=e;if(e){l||!o(e,"pika-select")||e.onchange||(e.setAttribute("onchange","return;"),i(e,"change",r._onChange));do{if(o(t,"pika-single")||t===n.trigger)return}while(t=t.parentNode);r._v&&e!==n.trigger&&t!==n.trigger&&r.hide()}},r.el=f.createElement("div"),r.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),i(r.el,"mousedown",r._onMouseDown,!0),i(r.el,"touchend",r._onMouseDown,!0),i(r.el,"change",r._onChange),n.keyboardInput&&i(f,"keydown",r._onKeyChange),n.field&&(n.container?n.container.appendChild(r.el):n.bound?f.body.appendChild(r.el):n.field.parentNode.insertBefore(r.el,n.field.nextSibling),i(n.field,"change",r._onInputChange),n.defaultDate||(n.defaultDate=r._parseFieldValue(),n.setDefaultDate=!0)),n.defaultDate);I(e)?n.setDefaultDate?r.setDate(e,!0):r.gotoDate(e):r.gotoDate(new Date),n.bound?(this.hide(),r.el.className+=" is-bound",i(n.trigger,"click",r._onInputClick),i(n.trigger,"focus",r._onInputFocus),i(n.trigger,"blur",r._onInputBlur)):this.show()}var F="function"==typeof O,l=!!window.addEventListener,f=window.document,c=window.setTimeout,n={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},u=function(e,t,r){for(t+=e.firstDay;7<=t;)t-=7;return(r?e.i18n.weekdaysShort:e.i18n.weekdays)[t]};return e.prototype={config:function(e){this._o||(this._o=s({},n,!0));var e=s(this._o,e,!0),t=(e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme="string"==typeof e.theme&&e.theme?e.theme:null,e.bound=!!(void 0!==e.bound?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn="function"==typeof e.disableDayFn?e.disableDayFn:null,parseInt(e.numberOfMonths,10)||1);return e.numberOfMonths=4<t?4:t,I(e.minDate)||(e.minDate=!1),I(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),m(e.yearRange)?(t=(new Date).getFullYear()-10,e.yearRange[0]=parseInt(e.yearRange[0],10)||t,e.yearRange[1]=parseInt(e.yearRange[1],10)||t):(e.yearRange=Math.abs(parseInt(e.yearRange,10))||n.yearRange,100<e.yearRange&&(e.yearRange=100)),e},toString:function(e){return e=e||this._o.format,I(this._d)?this._o.toString?this._o.toString(this._d,e):F?O(this._d).format(e):this._d.toDateString():""},getMoment:function(){return F?O(this._d):null},setMoment:function(e,t){F&&O.isMoment(e)&&this.setDate(e.toDate(),t)},getDate:function(){return I(this._d)?new Date(this._d.getTime()):null},setDate:function(e,t){if(!e)return this._d=null,this._o.field&&(this._o.field.value="",a(this._o.field,"change",{firedBy:this})),this.draw();var r,n;"string"==typeof e&&(e=new Date(Date.parse(e))),I(e)&&(r=this._o.minDate,n=this._o.maxDate,I(r)&&e<r?e=r:I(n)&&n<e&&(e=n),this._d=new Date(e.getTime()),k(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),a(this._o.field,"change",{firedBy:this})),t||"function"!=typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate()))},clear:function(){this.setDate(null)},gotoDate:function(e){var t,r,n,i=!0;I(e)&&(this.calendars&&(t=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),n=e.getTime(),r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),i=n<t.getTime()||r.getTime()<n),i&&(this.calendars=[{month:e.getMonth(),year:e.getFullYear()}],"right"===this._o.mainCalendar)&&(this.calendars[0].month+=1-this._o.numberOfMonths),this.adjustCalendars())},adjustDate:function(e,t){var r,n=this.getDate()||new Date,t=24*parseInt(t)*60*60*1e3;"add"===e?r=new Date(n.valueOf()+t):"subtract"===e&&(r=new Date(n.valueOf()-t)),this.setDate(r)},adjustCalendars:function(){this.calendars[0]=r(this.calendars[0]);for(var e=1;e<this._o.numberOfMonths;e++)this.calendars[e]=r({month:this.calendars[0].month+e,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(e){isNaN(e)||(this.calendars[0].month=parseInt(e,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(e){isNaN(e)||(this.calendars[0].year=parseInt(e,10),this.adjustCalendars())},setMinDate:function(e){e instanceof Date?(k(e),this._o.minDate=e,this._o.minYear=e.getFullYear(),this._o.minMonth=e.getMonth()):(this._o.minDate=n.minDate,this._o.minYear=n.minYear,this._o.minMonth=n.minMonth,this._o.startRange=n.startRange),this.draw()},setMaxDate:function(e){e instanceof Date?(k(e),this._o.maxDate=e,this._o.maxYear=e.getFullYear(),this._o.maxMonth=e.getMonth()):(this._o.maxDate=n.maxDate,this._o.maxYear=n.maxYear,this._o.maxMonth=n.maxMonth,this._o.endRange=n.endRange),this.draw()},setStartRange:function(e){this._o.startRange=e},setEndRange:function(e){this._o.endRange=e},draw:function(e){if(this._v||e){var t,r=this._o,e=r.minYear,n=r.maxYear,i=r.minMonth,o=r.maxMonth,s="";this._y<=e&&(this._y=e,!isNaN(i))&&this._m<i&&(this._m=i),this._y>=n&&(this._y=n,!isNaN(o))&&this._m>o&&(this._m=o);for(var a=0;a<r.numberOfMonths;a++)t="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),s+='<div class="pika-lendar">'+function(e,t,r,n,i,o){for(var s,a,l,c=e._o,u=r===c.minYear,d=r===c.maxYear,o='<div id="'+o+'" class="pika-title" role="heading" aria-live="assertive">',h=!0,p=!0,f=[],g=0;g<12;g++)f.push('<option value="'+(r===i?g-t:12+g-t)+'"'+(g===n?' selected="selected"':"")+(u&&g<c.minMonth||d&&g>c.maxMonth?' disabled="disabled"':"")+">"+c.i18n.months[g]+"</option>");for(a='<div class="pika-label">'+c.i18n.months[n]+'<select class="pika-select pika-select-month" tabindex="-1">'+f.join("")+"</select></div>",s=m(c.yearRange)?(g=c.yearRange[0],c.yearRange[1]+1):(g=r-c.yearRange,1+r+c.yearRange),f=[];g<s&&g<=c.maxYear;g++)g>=c.minYear&&f.push('<option value="'+g+'"'+(g===r?' selected="selected"':"")+">"+g+"</option>");return l='<div class="pika-label">'+r+c.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+f.join("")+"</select></div>",c.showMonthAfterYear?o+=l+a:o+=a+l,u&&(0===n||c.minMonth>=n)&&(h=!1),d&&(11===n||c.maxMonth<=n)&&(p=!1),0===t&&(o+='<button class="pika-prev'+(h?"":" is-disabled")+'" type="button">'+c.i18n.previousMonth+"</button>"),t===e._o.numberOfMonths-1&&(o+='<button class="pika-next'+(p?"":" is-disabled")+'" type="button">'+c.i18n.nextMonth+"</button>"),o+"</div>"}(this,a,this.calendars[a].year,this.calendars[a].month,this.calendars[0].year,t)+this.render(this.calendars[a].year,this.calendars[a].month,t)+"</div>";this.el.innerHTML=s,r.bound&&"hidden"!==r.field.type&&c(function(){r.trigger.focus()},1),"function"==typeof this._o.onDraw&&this._o.onDraw(this),r.bound&&r.field.setAttribute("aria-label",r.ariaLabel)}},adjustPosition:function(){var e,t,r,n,i,o,s,a,l,c,u,d;if(!this._o.container){if(this.el.style.position="absolute",t=e=this._o.trigger,r=this.el.offsetWidth,n=this.el.offsetHeight,i=window.innerWidth||f.documentElement.clientWidth,o=window.innerHeight||f.documentElement.clientHeight,s=window.pageYOffset||f.body.scrollTop||f.documentElement.scrollTop,d=u=!0,"function"==typeof e.getBoundingClientRect)a=(c=e.getBoundingClientRect()).left+window.pageXOffset,l=c.bottom+window.pageYOffset;else for(a=t.offsetLeft,l=t.offsetTop+t.offsetHeight;t=t.offsetParent;)a+=t.offsetLeft,l+=t.offsetTop;(this._o.reposition&&i<a+r||-1<this._o.position.indexOf("right")&&0<a-r+e.offsetWidth)&&(a=a-r+e.offsetWidth,u=!1),(this._o.reposition&&o+s<l+n||-1<this._o.position.indexOf("top")&&0<l-n-e.offsetHeight)&&(l=l-n-e.offsetHeight,d=!1),this.el.style.left=a+"px",this.el.style.top=l+"px",h(this.el,u?"left-aligned":"right-aligned"),h(this.el,d?"bottom-aligned":"top-aligned"),p(this.el,u?"right-aligned":"left-aligned"),p(this.el,d?"top-aligned":"bottom-aligned")}},render:function(e,t,r){for(var n=this._o,i=new Date,o=M(e,t),s=new Date(e,t,1).getDay(),a=[],l=[],c=(k(i),0<n.firstDay&&(s-=n.firstDay)<0&&(s+=7),0===t?11:t-1),u=11===t?0:t+1,d=0===t?e-1:e,h=11===t?e+1:e,p=M(d,c),f=o+s,g=f;7<g;)g-=7;f+=7-g;for(var m=!1,y=0,v=0;y<f;y++){var b=new Date(e,t,y-s+1),w=!!I(this._d)&&D(b,this._d),C=D(b,i),E=-1!==n.events.indexOf(b.toDateString()),T=y<s||o+s<=y,S=y-s+1,_=t,x=e,R=n.startRange&&D(n.startRange,b),A=n.endRange&&D(n.endRange,b),N=n.startRange&&n.endRange&&n.startRange<b&&b<n.endRange,S=(T&&(x=y<s?(S=p+S,_=c,d):(S-=o,_=u,h)),{day:S,month:_,year:x,hasEvent:E,isSelected:w,isToday:C,isDisabled:n.minDate&&b<n.minDate||n.maxDate&&b>n.maxDate||n.disableWeekends&&function(e){e=e.getDay();return 0===e||6===e}(b)||n.disableDayFn&&n.disableDayFn(b),isEmpty:T,isStartRange:R,isEndRange:A,isInRange:N,showDaysInNextAndPreviousMonths:n.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:n.enableSelectionDaysInNextAndPreviousMonths});n.pickWholeWeek&&w&&(m=!0),l.push(function(e){var t=[],r="false";if(e.isEmpty){if(!e.showDaysInNextAndPreviousMonths)return'<td class="is-empty"></td>';t.push("is-outside-current-month"),e.enableSelectionDaysInNextAndPreviousMonths||t.push("is-selection-disabled")}return e.isDisabled&&t.push("is-disabled"),e.isToday&&t.push("is-today"),e.isSelected&&(t.push("is-selected"),r="true"),e.hasEvent&&t.push("has-event"),e.isInRange&&t.push("is-inrange"),e.isStartRange&&t.push("is-startrange"),e.isEndRange&&t.push("is-endrange"),'<td data-day="'+e.day+'" class="'+t.join(" ")+'" aria-selected="'+r+'"><button class="pika-button pika-day" type="button" data-pika-year="'+e.year+'" data-pika-month="'+e.month+'" data-pika-day="'+e.day+'">'+e.day+"</button></td>"}(S)),7==++v&&(n.showWeekNumber&&l.unshift(function(e,t,r,n){r=new Date(r,t,e);return'<td class="pika-week">'+(F?O(r).isoWeek():P(r,n))+"</td>"}(y-s,t,e,n.firstWeekOfYearMinDays)),a.push((_=l,x=n.isRTL,'<tr class="pika-row'+(n.pickWholeWeek?" pick-whole-week":"")+(m?" is-selected":"")+'">'+(x?_.reverse():_).join("")+"</tr>")),v=0,m=!(l=[]))}return L(n,a,r)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),p(this.el,"is-hidden"),this._o.bound&&(i(f,"click",this._onClick),this.adjustPosition()),"function"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){var e=this._v;!1!==e&&(this._o.bound&&t(f,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),h(this.el,"is-hidden"),this._v=!1,void 0!==e)&&"function"==typeof this._o.onClose&&this._o.onClose.call(this)},destroy:function(){var e=this._o;this.hide(),t(this.el,"mousedown",this._onMouseDown,!0),t(this.el,"touchend",this._onMouseDown,!0),t(this.el,"change",this._onChange),e.keyboardInput&&t(f,"keydown",this._onKeyChange),e.field&&(t(e.field,"change",this._onInputChange),e.bound)&&(t(e.trigger,"click",this._onInputClick),t(e.trigger,"focus",this._onInputFocus),t(e.trigger,"blur",this._onInputBlur)),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},e}),!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).Popper={})}(this,function(e){"use strict";function b(e){var t;return null==e?window:"[object Window]"!==e.toString()?(t=e.ownerDocument)&&t.defaultView||window:e}function p(e){return e instanceof b(e).Element||e instanceof Element}function l(e){return e instanceof b(e).HTMLElement||e instanceof HTMLElement}function o(e){return"undefined"!=typeof ShadowRoot&&(e instanceof b(e).ShadowRoot||e instanceof ShadowRoot)}var x=Math.max,R=Math.min,w=Math.round;function s(){var e=navigator.userAgentData;return null!=e&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function S(){return!/^((?!chrome|android).)*safari/i.test(s())}function d(e,t,r){void 0===t&&(t=!1),void 0===r&&(r=!1);var n=e.getBoundingClientRect(),i=1,o=1;t&&l(e)&&(i=0<e.offsetWidth&&w(n.width)/e.offsetWidth||1,o=0<e.offsetHeight&&w(n.height)/e.offsetHeight||1);t=(p(e)?b(e):window).visualViewport,e=!S()&&r,r=(n.left+(e&&t?t.offsetLeft:0))/i,e=(n.top+(e&&t?t.offsetTop:0))/o,t=n.width/i,i=n.height/o;return{width:t,height:i,top:e,right:r+t,bottom:e+i,left:r,x:r,y:e}}function h(e){e=b(e);return{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function c(e){return e?(e.nodeName||"").toLowerCase():null}function C(e){return((p(e)?e.ownerDocument:e.document)||window.document).documentElement}function f(e){return d(C(e)).left+h(e).scrollLeft}function E(e){return b(e).getComputedStyle(e)}function u(e){var e=E(e),t=e.overflow,r=e.overflowX,e=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+e+r)}function _(e,t,r){void 0===r&&(r=!1);var n=l(t),i=l(t)&&(s=(i=t).getBoundingClientRect(),o=w(s.width)/i.offsetWidth||1,s=w(s.height)/i.offsetHeight||1,1!==o||1!==s),o=C(t),s=d(e,i,r),e={scrollLeft:0,scrollTop:0},a={x:0,y:0};return!n&&r||("body"===c(t)&&!u(o)||(e=(n=t)!==b(n)&&l(n)?{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}:h(n)),l(t)?((a=d(t,!0)).x+=t.clientLeft,a.y+=t.clientTop):o&&(a.x=f(o))),{x:s.left+e.scrollLeft-a.x,y:s.top+e.scrollTop-a.y,width:s.width,height:s.height}}function A(e){var t=d(e),r=e.offsetWidth,n=e.offsetHeight;return Math.abs(t.width-r)<=1&&(r=t.width),Math.abs(t.height-n)<=1&&(n=t.height),{x:e.offsetLeft,y:e.offsetTop,width:r,height:n}}function a(e){return"html"===c(e)?e:e.assignedSlot||e.parentNode||(o(e)?e.host:null)||C(e)}function g(e,t){void 0===t&&(t=[]);var r=function e(t){return 0<=["html","body","#document"].indexOf(c(t))?t.ownerDocument.body:l(t)&&u(t)?t:e(a(t))}(e),e=r===(null==(e=e.ownerDocument)?void 0:e.body),n=b(r),n=e?[n].concat(n.visualViewport||[],u(r)?r:[]):r,r=t.concat(n);return e?r:r.concat(g(a(n)))}function i(e){return l(e)&&"fixed"!==E(e).position?e.offsetParent:null}function N(e){for(var t,r=b(e),n=i(e);n&&(t=n,0<=["table","td","th"].indexOf(c(t)))&&"static"===E(n).position;)n=i(n);return(!n||"html"!==c(n)&&("body"!==c(n)||"static"!==E(n).position))&&(n||function(e){var t=/firefox/i.test(s()),r=/Trident/i.test(s());if(!r||!l(e)||"fixed"!==E(e).position){var n=a(e);for(o(n)&&(n=n.host);l(n)&&["html","body"].indexOf(c(n))<0;){var i=E(n);if("none"!==i.transform||"none"!==i.perspective||"paint"===i.contain||-1!==["transform","perspective"].indexOf(i.willChange)||t&&"filter"===i.willChange||t&&i.filter&&"none"!==i.filter)return n;n=n.parentNode}}return null}(e))||r}var O="top",I="bottom",M="right",k="left",D="auto",P=[O,I,M,k],L="start",T="end",$="clippingParents",B="viewport",m="popper",j="reference",z=P.reduce(function(e,t){return e.concat([t+"-"+L,t+"-"+T])},[]),Y=[].concat(P,[D]).reduce(function(e,t){return e.concat([t,t+"-"+L,t+"-"+T])},[]),G=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function q(e){var r=new Map,n=new Set,i=[];return e.forEach(function(e){r.set(e.name,e)}),e.forEach(function(e){n.has(e.name)||!function t(e){n.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach(function(e){n.has(e)||(e=r.get(e))&&t(e)}),i.push(e)}(e)}),i}function K(e,t){var r=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(r&&o(r)){var n=t;do{if(n&&e.isSameNode(n))return!0}while(n=n.parentNode||n.host)}return!1}function y(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function X(e,t,r){return t===B?y((i=r,s=b(n=e),a=C(n),s=s.visualViewport,l=a.clientWidth,a=a.clientHeight,u=c=0,s&&(l=s.width,a=s.height,(o=S())||!o&&"fixed"===i)&&(c=s.offsetLeft,u=s.offsetTop),{width:l,height:a,x:c+f(n),y:u})):p(t)?((i=d(o=t,!1,"fixed"===(i=r))).top=i.top+o.clientTop,i.left=i.left+o.clientLeft,i.bottom=i.top+o.clientHeight,i.right=i.left+o.clientWidth,i.width=o.clientWidth,i.height=o.clientHeight,i.x=i.left,i.y=i.top,i):y((s=C(e),l=C(s),a=h(s),c=null==(c=s.ownerDocument)?void 0:c.body,n=x(l.scrollWidth,l.clientWidth,c?c.scrollWidth:0,c?c.clientWidth:0),u=x(l.scrollHeight,l.clientHeight,c?c.scrollHeight:0,c?c.clientHeight:0),s=-a.scrollLeft+f(s),a=-a.scrollTop,"rtl"===E(c||l).direction&&(s+=x(l.clientWidth,c?c.clientWidth:0)-n),{width:n,height:u,x:s,y:a}));var n,i,o,s,a,l,c,u}function J(r,e,t,n){var i,o="clippingParents"===e?(s=g(a(o=r)),p(i=0<=["absolute","fixed"].indexOf(E(o).position)&&l(o)?N(o):o)?s.filter(function(e){return p(e)&&K(e,i)&&"body"!==c(e)}):[]):[].concat(e),s=[].concat(o,[t]),e=s[0],t=s.reduce(function(e,t){t=X(r,t,n);return e.top=x(t.top,e.top),e.right=R(t.right,e.right),e.bottom=R(t.bottom,e.bottom),e.left=x(t.left,e.left),e},X(r,e,n));return t.width=t.right-t.left,t.height=t.bottom-t.top,t.x=t.left,t.y=t.top,t}function F(e){return e.split("-")[0]}function H(e){return e.split("-")[1]}function Z(e){return 0<=["top","bottom"].indexOf(e)?"x":"y"}function Q(e){var t,r=e.reference,n=e.element,e=e.placement,i=e?F(e):null,e=e?H(e):null,o=r.x+r.width/2-n.width/2,s=r.y+r.height/2-n.height/2;switch(i){case O:t={x:o,y:r.y-n.height};break;case I:t={x:o,y:r.y+r.height};break;case M:t={x:r.x+r.width,y:s};break;case k:t={x:r.x-n.width,y:s};break;default:t={x:r.x,y:r.y}}var a=i?Z(i):null;if(null!=a){var l="y"===a?"height":"width";switch(e){case L:t[a]=t[a]-(r[l]/2-n[l]/2);break;case T:t[a]=t[a]+(r[l]/2-n[l]/2)}}return t}function ee(){return{top:0,right:0,bottom:0,left:0}}function te(e){return Object.assign({},ee(),e)}function re(r,e){return e.reduce(function(e,t){return e[t]=r,e},{})}function U(e,t){var n,t=t=void 0===t?{}:t,r=t.placement,r=void 0===r?e.placement:r,i=t.strategy,i=void 0===i?e.strategy:i,o=t.boundary,o=void 0===o?$:o,s=t.rootBoundary,s=void 0===s?B:s,a=t.elementContext,a=void 0===a?m:a,l=t.altBoundary,l=void 0!==l&&l,t=t.padding,t=void 0===t?0:t,t=te("number"!=typeof t?t:re(t,P)),c=e.rects.popper,l=e.elements[l?a===m?j:m:a],l=J(p(l)?l:l.contextElement||C(e.elements.popper),o,s,i),o=d(e.elements.reference),s=Q({reference:o,element:c,strategy:"absolute",placement:r}),i=y(Object.assign({},c,s)),c=a===m?i:o,u={top:l.top-c.top+t.top,bottom:c.bottom-l.bottom+t.bottom,left:l.left-c.left+t.left,right:c.right-l.right+t.right},s=e.modifiersData.offset;return a===m&&s&&(n=s[r],Object.keys(u).forEach(function(e){var t=0<=[M,I].indexOf(e)?1:-1,r=0<=[O,I].indexOf(e)?"y":"x";u[e]+=n[r]*t})),u}var ne={placement:"bottom",modifiers:[],strategy:"absolute"};function ie(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return!t.some(function(e){return!(e&&"function"==typeof e.getBoundingClientRect)})}function t(e){var e=e=void 0===e?{}:e,t=e.defaultModifiers,d=void 0===t?[]:t,t=e.defaultOptions,h=void 0===t?ne:t;return function(n,i,t){void 0===t&&(t=h);var r,o,s={placement:"bottom",orderedModifiers:[],options:Object.assign({},ne,h),modifiersData:{},elements:{reference:n,popper:i},attributes:{},styles:{}},a=[],l=!1,c={state:s,setOptions:function(e){var r,t,e="function"==typeof e?e(s.options):e,e=(u(),s.options=Object.assign({},h,s.options,e),s.scrollParents={reference:p(n)?g(n):n.contextElement?g(n.contextElement):[],popper:g(i)},e=[].concat(d,s.options.modifiers),t=e.reduce(function(e,t){var r=e[t.name];return e[t.name]=r?Object.assign({},r,t,{options:Object.assign({},r.options,t.options),data:Object.assign({},r.data,t.data)}):t,e},{}),e=Object.keys(t).map(function(e){return t[e]}),r=q(e),G.reduce(function(e,t){return e.concat(r.filter(function(e){return e.phase===t}))},[]));return s.orderedModifiers=e.filter(function(e){return e.enabled}),s.orderedModifiers.forEach(function(e){var t=e.name,r=e.options,e=e.effect;"function"==typeof e&&(e=e({state:s,name:t,instance:c,options:void 0===r?{}:r}),a.push(e||function(){}))}),c.update()},forceUpdate:function(){if(!l){var e=s.elements,t=e.reference,e=e.popper;if(ie(t,e)){s.rects={reference:_(t,N(e),"fixed"===s.options.strategy),popper:A(e)},s.reset=!1,s.placement=s.options.placement,s.orderedModifiers.forEach(function(e){return s.modifiersData[e.name]=Object.assign({},e.data)});for(var r,n,i,o=0;o<s.orderedModifiers.length;o++)!0===s.reset?(s.reset=!1,o=-1):(r=(i=s.orderedModifiers[o]).fn,n=i.options,i=i.name,"function"==typeof r&&(s=r({state:s,options:void 0===n?{}:n,name:i,instance:c})||s))}}},update:(r=function(){return new Promise(function(e){c.forceUpdate(),e(s)})},function(){return o=o||new Promise(function(e){Promise.resolve().then(function(){o=void 0,e(r())})})}),destroy:function(){u(),l=!0}};return ie(n,i)&&c.setOptions(t).then(function(e){!l&&t.onFirstUpdate&&t.onFirstUpdate(e)}),c;function u(){a.forEach(function(e){return e()}),a=[]}}}var v={passive:!0};var r={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,r=e.instance,n=(e=e.options).scroll,i=void 0===n||n,o=void 0===(n=e.resize)||n,s=b(t.elements.popper),a=[].concat(t.scrollParents.reference,t.scrollParents.popper);return i&&a.forEach(function(e){e.addEventListener("scroll",r.update,v)}),o&&s.addEventListener("resize",r.update,v),function(){i&&a.forEach(function(e){e.removeEventListener("scroll",r.update,v)}),o&&s.removeEventListener("resize",r.update,v)}},data:{}};var n={name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,e=e.name;t.modifiersData[e]=Q({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}},oe={top:"auto",right:"auto",bottom:"auto",left:"auto"};function se(e){var t,r=e.popper,n=e.popperRect,i=e.placement,o=e.variation,s=e.offsets,a=e.position,l=e.gpuAcceleration,c=e.adaptive,u=e.roundOffsets,e=e.isFixed,d=s.x,d=void 0===d?0:d,h=s.y,h=void 0===h?0:h,p="function"==typeof u?u({x:d,y:h}):{x:d,y:h},p=(d=p.x,h=p.y,s.hasOwnProperty("x")),s=s.hasOwnProperty("y"),f=k,g=O,m=window,y=(c&&(y="clientHeight",t="clientWidth",(v=N(r))===b(r)&&"static"!==E(v=C(r)).position&&"absolute"===a&&(y="scrollHeight",t="scrollWidth"),i!==O&&(i!==k&&i!==M||o!==T)||(g=I,h=(h-((e&&v===m&&m.visualViewport?m.visualViewport.height:v[y])-n.height))*(l?1:-1)),i!==k&&(i!==O&&i!==I||o!==T)||(f=M,d=(d-((e&&v===m&&m.visualViewport?m.visualViewport.width:v[t])-n.width))*(l?1:-1))),Object.assign({position:a},c&&oe)),v=!0===u?(i={x:d,y:h},o=b(r),e=i.x,i=i.y,o=o.devicePixelRatio||1,{x:w(e*o)/o||0,y:w(i*o)/o||0}):{x:d,y:h};return d=v.x,h=v.y,l?Object.assign({},y,((t={})[g]=s?"0":"",t[f]=p?"0":"",t.transform=(m.devicePixelRatio||1)<=1?"translate("+d+"px, "+h+"px)":"translate3d("+d+"px, "+h+"px, 0)",t)):Object.assign({},y,((n={})[g]=s?h+"px":"",n[f]=p?d+"px":"",n.transform="",n))}var ae={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,e=e.options,r=void 0===(r=e.gpuAcceleration)||r,n=void 0===(n=e.adaptive)||n,e=void 0===(e=e.roundOffsets)||e,r={placement:F(t.placement),variation:H(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:r,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,se(Object.assign({},r,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:n,roundOffsets:e})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,se(Object.assign({},r,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:e})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}};var le={name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var i=e.state;Object.keys(i.elements).forEach(function(e){var t=i.styles[e]||{},r=i.attributes[e]||{},n=i.elements[e];l(n)&&c(n)&&(Object.assign(n.style,t),Object.keys(r).forEach(function(e){var t=r[e];!1===t?n.removeAttribute(e):n.setAttribute(e,!0===t?"":t)}))})},effect:function(e){var n=e.state,i={popper:{position:n.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(n.elements.popper.style,i.popper),n.styles=i,n.elements.arrow&&Object.assign(n.elements.arrow.style,i.arrow),function(){Object.keys(n.elements).forEach(function(e){var t=n.elements[e],r=n.attributes[e]||{},e=Object.keys((n.styles.hasOwnProperty(e)?n.styles:i)[e]).reduce(function(e,t){return e[t]="",e},{});l(t)&&c(t)&&(Object.assign(t.style,e),Object.keys(r).forEach(function(e){t.removeAttribute(e)}))})}},requires:["computeStyles"]};var ce={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var s=e.state,t=e.options,e=e.name,a=void 0===(t=t.offset)?[0,0]:t,t=Y.reduce(function(e,t){var r,n,i,o;return e[t]=(t=t,r=s.rects,n=a,i=F(t),o=0<=[k,O].indexOf(i)?-1:1,t=(r="function"==typeof n?n(Object.assign({},r,{placement:t})):n)[0]||0,n=(r[1]||0)*o,0<=[k,M].indexOf(i)?{x:n,y:t}:{x:t,y:n}),e},{}),r=(n=t[s.placement]).x,n=n.y;null!=s.modifiersData.popperOffsets&&(s.modifiersData.popperOffsets.x+=r,s.modifiersData.popperOffsets.y+=n),s.modifiersData[e]=t}},ue={left:"right",right:"left",bottom:"top",top:"bottom"};function V(e){return e.replace(/left|right|bottom|top/g,function(e){return ue[e]})}var de={start:"end",end:"start"};function he(e){return e.replace(/start|end/g,function(e){return de[e]})}var pe={name:"flip",enabled:!0,phase:"main",fn:function(e){var d=e.state,t=e.options,e=e.name;if(!d.modifiersData[e]._skip){for(var r=t.mainAxis,n=void 0===r||r,r=t.altAxis,i=void 0===r||r,r=t.fallbackPlacements,h=t.padding,p=t.boundary,f=t.rootBoundary,o=t.altBoundary,s=t.flipVariations,g=void 0===s||s,m=t.allowedAutoPlacements,s=d.options.placement,t=F(s),r=r||(t===s||!g?[V(s)]:F(r=s)===D?[]:(t=V(r),[he(r),t,he(t)])),a=[s].concat(r).reduce(function(e,t){return e.concat(F(t)===D?(r=d,n=(e=e=void 0===(e={placement:t,boundary:p,rootBoundary:f,padding:h,flipVariations:g,allowedAutoPlacements:m})?{}:e).placement,i=e.boundary,o=e.rootBoundary,s=e.padding,a=e.flipVariations,l=void 0===(e=e.allowedAutoPlacements)?Y:e,c=H(n),e=c?a?z:z.filter(function(e){return H(e)===c}):P,u=(n=0===(n=e.filter(function(e){return 0<=l.indexOf(e)})).length?e:n).reduce(function(e,t){return e[t]=U(r,{placement:t,boundary:i,rootBoundary:o,padding:s})[F(t)],e},{}),Object.keys(u).sort(function(e,t){return u[e]-u[t]})):t);var r,n,i,o,s,a,l,c,u},[]),l=d.rects.reference,c=d.rects.popper,u=new Map,y=!0,v=a[0],b=0;b<a.length;b++){var w=a[b],C=F(w),E=H(w)===L,T=0<=[O,I].indexOf(C),S=T?"width":"height",_=U(d,{placement:w,boundary:p,rootBoundary:f,altBoundary:o,padding:h}),T=T?E?M:k:E?I:O,E=(l[S]>c[S]&&(T=V(T)),V(T)),S=[];if(n&&S.push(_[C]<=0),i&&S.push(_[T]<=0,_[E]<=0),S.every(function(e){return e})){v=w,y=!1;break}u.set(w,S)}if(y)for(var x=g?3:1;0<x;x--)if("break"===function(t){var e=a.find(function(e){e=u.get(e);if(e)return e.slice(0,t).every(function(e){return e})});if(e)return v=e,"break"}(x))break;d.placement!==v&&(d.modifiersData[e]._skip=!0,d.placement=v,d.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function W(e,t,r){return x(e,R(t,r))}var fe={name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t,r,n,i,o,s,a,l,c,u=e.state,d=e.options,e=e.name,h=void 0===(h=d.mainAxis)||h,p=void 0!==(p=d.altAxis)&&p,f=d.boundary,g=d.rootBoundary,m=d.altBoundary,y=d.padding,v=void 0===(v=d.tether)||v,d=void 0===(d=d.tetherOffset)?0:d,f=U(u,{boundary:f,rootBoundary:g,padding:y,altBoundary:m}),g=F(u.placement),m=!(y=H(u.placement)),b=Z(g),w="x"===b?"y":"x",C=u.modifiersData.popperOffsets,E=u.rects.reference,T=u.rects.popper,d="number"==typeof(d="function"==typeof d?d(Object.assign({},u.rects,{placement:u.placement})):d)?{mainAxis:d,altAxis:d}:Object.assign({mainAxis:0,altAxis:0},d),S=u.modifiersData.offset?u.modifiersData.offset[u.placement]:null,_={x:0,y:0};C&&(h&&(h="y"===b?"height":"width",s=(a=C[b])+f[r="y"===b?O:k],l=a-f[c="y"===b?I:M],t=v?-T[h]/2:0,i=(y===L?E:T)[h],y=y===L?-T[h]:-E[h],o=u.elements.arrow,o=v&&o?A(o):{width:0,height:0},r=(n=u.modifiersData["arrow#persistent"]?u.modifiersData["arrow#persistent"].padding:ee())[r],n=n[c],c=W(0,E[h],o[h]),o=m?E[h]/2-t-c-r-d.mainAxis:i-c-r-d.mainAxis,i=m?-E[h]/2+t+c+n+d.mainAxis:y+c+n+d.mainAxis,m=(r=u.elements.arrow&&N(u.elements.arrow))?"y"===b?r.clientTop||0:r.clientLeft||0:0,y=a+i-(t=null!=(h=null==S?void 0:S[b])?h:0),c=W(v?R(s,a+o-t-m):s,a,v?x(l,y):l),C[b]=c,_[b]=c-a),p&&(n="y"==w?"height":"width",i=(r=C[w])+f["x"===b?O:k],h=r-f["x"===b?I:M],o=-1!==[O,k].indexOf(g),m=null!=(t=null==S?void 0:S[w])?t:0,s=o?i:r-E[n]-T[n]-m+d.altAxis,y=o?r+E[n]+T[n]-m-d.altAxis:h,a=v&&o?(l=W(l=s,r,c=y),c<l?c:l):W(v?s:i,r,v?y:h),C[w]=a,_[w]=a-r),u.modifiersData[e]=_)},requiresIfExists:["offset"]};var ge={name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,r,n,i,o=e.state,s=e.name,e=e.options,a=o.elements.arrow,l=o.modifiersData.popperOffsets,c=Z(u=F(o.placement)),u=0<=[k,M].indexOf(u)?"height":"width";a&&l&&(e=e.padding,r=o,r=te("number"!=typeof(e="function"==typeof e?e(Object.assign({},r.rects,{placement:r.placement})):e)?e:re(e,P)),e=A(a),i="y"===c?O:k,n="y"===c?I:M,t=o.rects.reference[u]+o.rects.reference[c]-l[c]-o.rects.popper[u],l=l[c]-o.rects.reference[c],a=(a=N(a))?"y"===c?a.clientHeight||0:a.clientWidth||0:0,i=r[i],r=a-e[u]-r[n],i=W(i,n=a/2-e[u]/2+(t/2-l/2),r),o.modifiersData[s]=((a={})[c]=i,a.centerOffset=i-n,a))},effect:function(e){var t=e.state;null!=(e=void 0===(e=e.options.element)?"[data-popper-arrow]":e)&&("string"!=typeof e||(e=t.elements.popper.querySelector(e)))&&K(t.elements.popper,e)&&(t.elements.arrow=e)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function me(e,t,r){return{top:e.top-t.height-(r=void 0===r?{x:0,y:0}:r).y,right:e.right-t.width+r.x,bottom:e.bottom-t.height+r.y,left:e.left-t.width-r.x}}function ye(t){return[O,M,I,k].some(function(e){return 0<=t[e]})}var ve={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,e=e.name,r=t.rects.reference,n=t.rects.popper,i=t.modifiersData.preventOverflow,o=U(t,{elementContext:"reference"}),s=U(t,{altBoundary:!0}),o=me(o,r),r=me(s,n,i),s=ye(o),n=ye(r);t.modifiersData[e]={referenceClippingOffsets:o,popperEscapeOffsets:r,isReferenceHidden:s,hasPopperEscaped:n},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":s,"data-popper-escaped":n})}},be=t({defaultModifiers:[r,n,ae,le]}),we=[r,n,ae,le,ce,pe,fe,ge,ve],Ce=t({defaultModifiers:we});e.applyStyles=le,e.arrow=ge,e.computeStyles=ae,e.createPopper=Ce,e.createPopperLite=be,e.defaultModifiers=we,e.detectOverflow=U,e.eventListeners=r,e.flip=pe,e.hide=ve,e.offset=ce,e.popperGenerator=t,e.popperOffsets=n,e.preventOverflow=fe,Object.defineProperty(e,"__esModule",{value:!0})}),!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("@popperjs/core")):"function"==typeof define&&define.amd?define(["@popperjs/core"],t):(e=e||self).tippy=t(e.Popper)}(this,function(ee){"use strict";var e="undefined"!=typeof window&&"undefined"!=typeof document,Ee=e&&!!window.msCrypto,n="tippy-content",o="tippy-backdrop",r="tippy-arrow",i="tippy-svg-arrow",te={passive:!0,capture:!0},re=function(){return document.body};function ne(e,t,r){var n;return Array.isArray(e)?null==(n=e[t])?Array.isArray(r)?r[t]:r:n:e}function s(e,t){e={}.toString.call(e);return 0===e.indexOf("[object")&&-1<e.indexOf(t+"]")}function ie(e,t){return"function"==typeof e?e.apply(void 0,t):e}function oe(t,r){var n;return 0===r?t:function(e){clearTimeout(n),n=setTimeout(function(){t(e)},r)}}function y(e,t){var r=Object.assign({},e);return t.forEach(function(e){delete r[e]}),r}function se(e){return[].concat(e)}function ae(e,t){-1===e.indexOf(t)&&e.push(t)}function Te(e){return e.split("-")[0]}function le(e){return[].slice.call(e)}function Se(r){return Object.keys(r).reduce(function(e,t){return void 0!==r[t]&&(e[t]=r[t]),e},{})}function ce(){return document.createElement("div")}function a(t){return["Element","Fragment"].some(function(e){return s(t,e)})}function ue(e){return s(e,"MouseEvent")}function u(e){return e&&e._tippy&&e._tippy.reference===e}function d(e){return a(e)?[e]:s(e,"NodeList")?le(e):Array.isArray(e)?e:le(document.querySelectorAll(e))}function de(e,t){e.forEach(function(e){e&&(e.style.transitionDuration=t+"ms")})}function he(e,t){e.forEach(function(e){e&&e.setAttribute("data-state",t)})}function _e(e){var t,e=se(e)[0];return null!=e&&null!=(t=e.ownerDocument)&&t.body?e.ownerDocument:document}function pe(t,e,r){var n=e+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(e){t[n](e,r)})}function xe(e,t){for(var r,n=t;n;){if(e.contains(n))return!0;n=null==n.getRootNode||null==(r=n.getRootNode())?void 0:r.host}return!1}var fe={isTouch:!1},h=0;function p(){fe.isTouch||(fe.isTouch=!0,window.performance&&document.addEventListener("mousemove",m))}function m(){var e=performance.now();e-h<20&&(fe.isTouch=!1,document.removeEventListener("mousemove",m)),h=e}function b(){var e,t=document.activeElement;u(t)&&(e=t._tippy,t.blur)&&!e.state.isVisible&&t.blur()}function ge(e){return[e+"() was called on a"+("destroy"===e?"n already-":" ")+"destroyed instance. This is a no-op but","indicates a potential memory leak."].join(" ")}function w(e){return e.replace(/[ \t]{2,}/g," ").replace(/^[ \t]*/gm,"").trim()}function C(e){return[w("\n  %ctippy.js\n\n  %c"+w(e)+"\n\n  %c👷‍ This is a development-only message. It will be removed in production.\n  "),"color: #00C584; font-size: 1.3em; font-weight: bold;","line-height: 1.5","color: #a6a095;"]}function me(e,t){e&&!l.has(t)&&(l.add(t),(e=console).warn.apply(e,C(t)))}function ye(e,t){e&&!l.has(t)&&(l.add(t),(e=console).error.apply(e,C(t)))}var l=new Set,E={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},ve=Object.assign({appendTo:re,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},E,{allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999}),T=Object.keys(ve);function Re(n){var e=(n.plugins||[]).reduce(function(e,t){var r=t.name,t=t.defaultValue;return r&&(e[r]=void 0!==n[r]?n[r]:null!=(r=ve[r])?r:t),e},{});return Object.assign({},n,e)}function Ae(e,t){var i,e=Object.assign({},t,{content:ie(t.content,[e])},t.ignoreAttributes?{}:(i=e,((e=t.plugins)?Object.keys(Re(Object.assign({},ve,{plugins:e}))):T).reduce(function(t,r){var n=(i.getAttribute("data-tippy-"+r)||"").trim();if(n)if("content"===r)t[r]=n;else try{t[r]=JSON.parse(n)}catch(e){t[r]=n}return t},{})));return e.aria=Object.assign({},ve.aria,e.aria),e.aria={expanded:"auto"===e.aria.expanded?t.interactive:e.aria.expanded,content:"auto"===e.aria.content?t.interactive?null:"describedby":e.aria.content},e}function S(e,r){void 0===e&&(e={}),void 0===r&&(r=[]),Object.keys(e).forEach(function(t){var e=y(ve,Object.keys(E));me(!{}.hasOwnProperty.call(e,t)&&0===r.filter(function(e){return e.name===t}).length,["`"+t+"`","is not a valid prop. You may have spelled it incorrectly, or if it's","a plugin, forgot to pass it in an array as props.plugins.","\n\n","All props: https://atomiks.github.io/tippyjs/v6/all-props/\n","Plugins: https://atomiks.github.io/tippyjs/v6/plugins/"].join(" "))})}function _(){return"innerHTML"}function c(e,t){e[_()]=t}function x(e){var t=ce();return!0===e?t.className=r:(t.className=i,a(e)?t.appendChild(e):c(t,e)),t}function R(e,t){a(t.content)?(c(e,""),e.appendChild(t.content)):"function"!=typeof t.content&&(t.allowHTML?c(e,t.content):e.textContent=t.content)}function be(e){var e=e.firstElementChild,t=le(e.children);return{box:e,content:t.find(function(e){return e.classList.contains(n)}),arrow:t.find(function(e){return e.classList.contains(r)||e.classList.contains(i)}),backdrop:t.find(function(e){return e.classList.contains(o)})}}function A(o){var s=ce(),e=ce(),t=(e.className="tippy-box",e.setAttribute("data-state","hidden"),e.setAttribute("tabindex","-1"),ce());function r(e,t){var r=be(s),n=r.box,i=r.content,r=r.arrow;t.theme?n.setAttribute("data-theme",t.theme):n.removeAttribute("data-theme"),"string"==typeof t.animation?n.setAttribute("data-animation",t.animation):n.removeAttribute("data-animation"),t.inertia?n.setAttribute("data-inertia",""):n.removeAttribute("data-inertia"),n.style.maxWidth="number"==typeof t.maxWidth?t.maxWidth+"px":t.maxWidth,t.role?n.setAttribute("role",t.role):n.removeAttribute("role"),e.content===t.content&&e.allowHTML===t.allowHTML||R(i,o.props),t.arrow?r?e.arrow!==t.arrow&&(n.removeChild(r),n.appendChild(x(t.arrow))):n.appendChild(x(t.arrow)):r&&n.removeChild(r)}return t.className=n,t.setAttribute("data-state","hidden"),R(t,o.props),s.appendChild(e),e.appendChild(t),r(o.props,o.props),{popper:s,onUpdate:r}}A.$$tippy=!0;var Ne=1,we=[],Ce=[];function N(s,e){var n,t,r,i,o,a,l,c,u,d,h,p,f=Ae(s,Object.assign({},ve,Re(Se(e)))),g=!1,m=!1,y=!1,v=!1,b=[],w=oe(G,f.interactiveDebounce),e=Ne++,C=(c=f.plugins).filter(function(e,t){return c.indexOf(e)===t}),E={id:e,reference:s,popper:ce(),popperInstance:null,props:f,state:{isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},plugins:C,clearDelayTimeouts:function(){clearTimeout(n),clearTimeout(t),cancelAnimationFrame(r)},setProps:function(e){var t,r;me(E.state.isDestroyed,ge("setProps")),E.state.isDestroyed||(A("onBeforeUpdate",[E,e]),z(),t=E.props,r=Ae(s,Object.assign({},t,Se(e),{ignoreAttributes:!0})),E.props=r,j(),t.interactiveDebounce!==r.interactiveDebounce&&(O(),w=oe(G,r.interactiveDebounce)),t.triggerTarget&&!r.triggerTarget?se(t.triggerTarget).forEach(function(e){e.removeAttribute("aria-expanded")}):r.triggerTarget&&s.removeAttribute("aria-expanded"),N(),R(),d&&d(t,r),E.popperInstance&&(J(),D().forEach(function(e){requestAnimationFrame(e._tippy.popperInstance.forceUpdate)})),A("onAfterUpdate",[E,e]))},setContent:function(e){E.setProps({content:e})},show:function(){me(E.state.isDestroyed,ge("show"));var e=E.state.isVisible,t=E.state.isDestroyed,r=!E.state.isEnabled,n=fe.isTouch&&!E.props.touch,i=ne(E.props.duration,0,ve.duration);e||t||r||n||S().hasAttribute("disabled")||(A("onShow",[E],!1),!1!==E.props.onShow(E)&&(E.state.isVisible=!0,T()&&(u.style.visibility="visible"),R(),$(),E.state.isMounted||(u.style.transition="none"),T()&&(e=x(),t=e.box,r=e.content,de([t,r],0)),a=function(){var e,t;E.state.isVisible&&!v&&(v=!0,u.offsetHeight,u.style.transition=E.props.moveTransition,T()&&E.props.animation&&(de([e=(t=x()).box,t=t.content],i),he([e,t],"visible")),U(),N(),ae(Ce,E),null!=(e=E.popperInstance)&&e.forceUpdate(),A("onMount",[E]),E.props.animation)&&T()&&B(i,function(){E.state.isShown=!0,A("onShown",[E])})},n=E.props.appendTo,e=S(),(t=E.props.interactive&&n===re||"parent"===n?e.parentNode:ie(n,[e])).contains(u)||t.appendChild(u),E.state.isMounted=!0,J(),me(E.props.interactive&&n===ve.appendTo&&e.nextElementSibling!==u,["Interactive tippy element may not be accessible via keyboard","navigation because it is not directly after the reference element","in the DOM source order.","\n\n","Using a wrapper <div> or <span> tag around the reference element","solves this by creating a new parentNode context.","\n\n","Specifying `appendTo: document.body` silences this warning, but it","assumes you are using a focus management solution to handle","keyboard navigation.","\n\n","See: https://atomiks.github.io/tippyjs/v6/accessibility/#interactivity"].join(" "))))},hide:function(){me(E.state.isDestroyed,ge("hide"));var e,t=!E.state.isVisible,r=E.state.isDestroyed,n=!E.state.isEnabled,i=ne(E.props.duration,1,ve.duration);t||r||n||(A("onHide",[E],!1),!1!==E.props.onHide(E)&&(E.state.isVisible=!1,E.state.isShown=!1,g=v=!1,T()&&(u.style.visibility="hidden"),O(),M(),R(!0),T()&&(t=x(),r=t.box,n=t.content,E.props.animation)&&(de([r,n],i),he([r,n],"hidden")),U(),N(),E.props.animation?T()&&(e=E.unmount,B(i,function(){!E.state.isVisible&&u.parentNode&&u.parentNode.contains(u)&&e()})):E.unmount()))},hideWithInteractivity:function(e){me(E.state.isDestroyed,ge("hideWithInteractivity")),_().addEventListener("mousemove",w),ae(we,w),w(e)},enable:function(){E.state.isEnabled=!0},disable:function(){E.hide(),E.state.isEnabled=!1},unmount:function(){me(E.state.isDestroyed,ge("unmount")),E.state.isVisible&&E.hide();E.state.isMounted&&(Z(),D().forEach(function(e){e._tippy.unmount()}),u.parentNode&&u.parentNode.removeChild(u),Ce=Ce.filter(function(e){return e!==E}),E.state.isMounted=!1,A("onHidden",[E]))},destroy:function(){me(E.state.isDestroyed,ge("destroy")),E.state.isDestroyed||(E.clearDelayTimeouts(),E.unmount(),z(),delete s._tippy,E.state.isDestroyed=!0,A("onDestroy",[E]))}};return f.render?(e=f.render(E),u=e.popper,d=e.onUpdate,h=(u.setAttribute("data-tippy-root",""),u.id="tippy-"+E.id,E.popper=u,s._tippy=E,u._tippy=E,C.map(function(e){return e.fn(E)})),p=s.hasAttribute("aria-expanded"),j(),N(),R(),A("onCreate",[E]),f.showOnCreate&&Q(),u.addEventListener("mouseenter",function(){E.props.interactive&&E.state.isVisible&&E.clearDelayTimeouts()}),u.addEventListener("mouseleave",function(){E.props.interactive&&0<=E.props.trigger.indexOf("mouseenter")&&_().addEventListener("mousemove",w)})):ye(!0,"render() function has not been supplied."),E;function L(){var e=E.props.touch;return Array.isArray(e)?e:[e,0]}function F(){return"hold"===L()[0]}function T(){var e;return null!=(e=E.props.render)&&e.$$tippy}function S(){return l||s}function _(){var e=S().parentNode;return e?_e(e):document}function x(){return be(u)}function H(e){return E.state.isMounted&&!E.state.isVisible||fe.isTouch||i&&"focus"===i.type?0:ne(E.props.delay,e?0:1,ve.delay)}function R(e){void 0===e&&(e=!1),u.style.pointerEvents=E.props.interactive&&!e?"":"none",u.style.zIndex=""+E.props.zIndex}function A(t,r,e){void 0===e&&(e=!0),h.forEach(function(e){e[t]&&e[t].apply(e,r)}),e&&(e=E.props)[t].apply(e,r)}function U(){var r,n,e=E.props.aria;e.content&&(r="aria-"+e.content,n=u.id,se(E.props.triggerTarget||s).forEach(function(e){var t=e.getAttribute(r);E.state.isVisible?e.setAttribute(r,t?t+" "+n:n):(t=t&&t.replace(n,"").trim())?e.setAttribute(r,t):e.removeAttribute(r)}))}function N(){!p&&E.props.aria.expanded&&se(E.props.triggerTarget||s).forEach(function(e){E.props.interactive?e.setAttribute("aria-expanded",E.state.isVisible&&e===S()?"true":"false"):e.removeAttribute("aria-expanded")})}function O(){_().removeEventListener("mousemove",w),we=we.filter(function(e){return e!==w})}function I(e){if(!fe.isTouch||!y&&"mousedown"!==e.type){var t=e.composedPath&&e.composedPath()[0]||e.target;if(!E.props.interactive||!xe(u,t)){if(se(E.props.triggerTarget||s).some(function(e){return xe(e,t)})){if(fe.isTouch)return;if(E.state.isVisible&&0<=E.props.trigger.indexOf("click"))return}else A("onClickOutside",[E,e]);!0===E.props.hideOnClick&&(E.clearDelayTimeouts(),E.hide(),m=!0,setTimeout(function(){m=!1}),E.state.isMounted||M())}}}function V(){y=!0}function W(){y=!1}function $(){var e=_();e.addEventListener("mousedown",I,!0),e.addEventListener("touchend",I,te),e.addEventListener("touchstart",W,te),e.addEventListener("touchmove",V,te)}function M(){var e=_();e.removeEventListener("mousedown",I,!0),e.removeEventListener("touchend",I,te),e.removeEventListener("touchstart",W,te),e.removeEventListener("touchmove",V,te)}function B(e,t){var r=x().box;function n(e){e.target===r&&(pe(r,"remove",n),t())}if(0===e)return t();pe(r,"remove",o),pe(r,"add",n),o=n}function k(t,r,n){void 0===n&&(n=!1),se(E.props.triggerTarget||s).forEach(function(e){e.addEventListener(t,r,n),b.push({node:e,eventType:t,handler:r,options:n})})}function j(){F()&&(k("touchstart",Y,{passive:!0}),k("touchend",q,{passive:!0})),E.props.trigger.split(/\s+/).filter(Boolean).forEach(function(e){if("manual"!==e)switch(k(e,Y),e){case"mouseenter":k("mouseleave",q);break;case"focus":k(Ee?"focusout":"blur",K);break;case"focusin":k("focusout",K)}})}function z(){b.forEach(function(e){var t=e.node,r=e.eventType,n=e.handler,e=e.options;t.removeEventListener(r,n,e)}),b=[]}function Y(t){var e,r=!1;!E.state.isEnabled||X(t)||m||(e="focus"===(null==i?void 0:i.type),l=(i=t).currentTarget,N(),!E.state.isVisible&&ue(t)&&we.forEach(function(e){return e(t)}),"click"===t.type&&(E.props.trigger.indexOf("mouseenter")<0||g)&&!1!==E.props.hideOnClick&&E.state.isVisible?r=!0:Q(t),"click"===t.type&&(g=!r),r&&!e&&P(t))}function G(e){var a,l,t=e.target,t=S().contains(t)||u.contains(t);"mousemove"===e.type&&t||(t=D().concat(u).map(function(e){var t=null==(t=e._tippy.popperInstance)?void 0:t.state;return t?{popperRect:e.getBoundingClientRect(),popperState:t,props:f}:null}).filter(Boolean),a=e.clientX,l=e.clientY,t.every(function(e){var t,r,n,i=e.popperRect,o=e.popperState,e=e.props.interactiveBorder,s=Te(o.placement),o=o.modifiersData.offset;return!o||(t="bottom"===s?o.top.y:0,r="top"===s?o.bottom.y:0,n="right"===s?o.left.x:0,s="left"===s?o.right.x:0,o=i.top-l+t>e,t=l-i.bottom-r>e,r=i.left-a+n>e,n=a-i.right-s>e,o)||t||r||n})&&(O(),P(e)))}function q(e){X(e)||0<=E.props.trigger.indexOf("click")&&g||(E.props.interactive?E.hideWithInteractivity(e):P(e))}function K(e){E.props.trigger.indexOf("focusin")<0&&e.target!==S()||E.props.interactive&&e.relatedTarget&&u.contains(e.relatedTarget)||P(e)}function X(e){return!!fe.isTouch&&F()!==0<=e.type.indexOf("touch")}function J(){Z();var e=E.props,t=e.popperOptions,r=e.placement,n=e.offset,i=e.getReferenceClientRect,e=e.moveTransition,o=T()?be(u).arrow:null,i=i?{getBoundingClientRect:i,contextElement:i.contextElement||S()}:s,n=[{name:"offset",options:{offset:n}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!e}},{name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(e){var t,r=e.state;T()&&(t=x().box,["placement","reference-hidden","escaped"].forEach(function(e){"placement"===e?t.setAttribute("data-placement",r.placement):r.attributes.popper["data-popper-"+e]?t.setAttribute("data-"+e,""):t.removeAttribute("data-"+e)}),r.attributes.popper={})}}];T()&&o&&n.push({name:"arrow",options:{element:o,padding:3}}),n.push.apply(n,(null==t?void 0:t.modifiers)||[]),E.popperInstance=ee.createPopper(i,u,Object.assign({},t,{placement:r,onFirstUpdate:a,modifiers:n}))}function Z(){E.popperInstance&&(E.popperInstance.destroy(),E.popperInstance=null)}function D(){return le(u.querySelectorAll("[data-tippy-root]"))}function Q(e){E.clearDelayTimeouts(),e&&A("onTrigger",[E,e]),$();var e=H(!0),t=L(),r=t[0],t=t[1];(e=fe.isTouch&&"hold"===r&&t?t:e)?n=setTimeout(function(){E.show()},e):E.show()}function P(e){E.clearDelayTimeouts(),A("onUntrigger",[E,e]),E.state.isVisible?0<=E.props.trigger.indexOf("mouseenter")&&0<=E.props.trigger.indexOf("click")&&0<=["mouseleave","mousemove"].indexOf(e.type)&&g||((e=H(!1))?t=setTimeout(function(){E.state.isVisible&&E.hide()},e):r=requestAnimationFrame(function(){E.hide()})):M()}}function v(e,t){var r=ve.plugins.concat((t=void 0===t?{}:t).plugins||[]),n=(i=!(o=e),s="[object Object]"===Object.prototype.toString.call(o)&&!o.addEventListener,ye(i,["tippy() was passed","`"+String(o)+"`","as its targets (first) argument. Valid types are: String, Element,","Element[], or NodeList."].join(" ")),ye(s,["tippy() was passed a plain object which is not supported as an argument","for virtual positioning. Use props.getReferenceClientRect instead."].join(" ")),S(t,r),document.addEventListener("touchstart",p,te),window.addEventListener("blur",b),Object.assign({},t,{plugins:r})),i=d(e),o=a(n.content),s=1<i.length,t=(me(o&&s,["tippy() was passed an Element as the `content` prop, but more than","one tippy instance was created by this invocation. This means the","content element will only be appended to the last tippy instance.","\n\n","Instead, pass the .innerHTML of the element, or use a function that","returns a cloned version of the element instead.","\n\n","1) content: element.innerHTML\n","2) content: () => element.cloneNode(true)"].join(" ")),i.reduce(function(e,t){t=t&&N(t,n);return t&&e.push(t),e},[]));return a(e)?t[0]:t}v.defaultProps=ve,v.setDefaultProps=function(t){S(t,[]),Object.keys(t).forEach(function(e){ve[e]=t[e]})},v.currentInput=fe;var O=Object.assign({},ee.applyStyles,{effect:function(e){var e=e.state,t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow)}}),I={mouseover:"mouseenter",focusin:"focus",click:"click"};var M={name:"animateFill",defaultValue:!1,fn:function(e){var r,n,i,t;return null!=(t=e.props.render)&&t.$$tippy?(t=be(e.popper),r=t.box,n=t.content,i=e.props.animateFill?((t=ce()).className=o,he([t],"hidden"),t):null,{onCreate:function(){i&&(r.insertBefore(i,r.firstElementChild),r.setAttribute("data-animatefill",""),r.style.overflow="hidden",e.setProps({arrow:!1,animation:"shift-away"}))},onMount:function(){var e,t;i&&(e=r.style.transitionDuration,t=Number(e.replace("ms","")),n.style.transitionDelay=Math.round(t/10)+"ms",i.style.transitionDuration=e,he([i],"visible"))},onShow:function(){i&&(i.style.transitionDuration="0ms")},onHide:function(){i&&he([i],"hidden")}}):(ye(e.props.animateFill,"The `animateFill` plugin requires the default render function."),{})}};var f={clientX:0,clientY:0},g=[];function k(e){var t=e.clientX,e=e.clientY;f={clientX:t,clientY:e}}var D={name:"followCursor",defaultValue:!1,fn:function(r){var u=r.reference,t=_e(r.props.triggerTarget||u),n=!1,i=!1,e=!0,o=r.props;function s(){return"initial"===r.props.followCursor&&r.state.isVisible}function a(){t.addEventListener("mousemove",d)}function l(){t.removeEventListener("mousemove",d)}function c(){n=!0,r.setProps({getReferenceClientRect:null}),n=!1}function d(e){var t=!e.target||u.contains(e.target),o=r.props.followCursor,s=e.clientX,a=e.clientY,e=u.getBoundingClientRect(),l=s-e.left,c=a-e.top;!t&&r.props.interactive||r.setProps({getReferenceClientRect:function(){var e=u.getBoundingClientRect(),t=s,r=a,n=("initial"===o&&(t=e.left+l,r=e.top+c),"horizontal"===o?e.top:r),i="vertical"===o?e.right:t,r="horizontal"===o?e.bottom:r,e="vertical"===o?e.left:t;return{width:i-e,height:r-n,top:n,right:i,bottom:r,left:e}}})}function h(){r.props.followCursor&&(g.push({instance:r,doc:t}),t.addEventListener("mousemove",k))}function p(){0===(g=g.filter(function(e){return e.instance!==r})).filter(function(e){return e.doc===t}).length&&t.removeEventListener("mousemove",k)}return{onCreate:h,onDestroy:p,onBeforeUpdate:function(){o=r.props},onAfterUpdate:function(e,t){t=t.followCursor;n||void 0!==t&&o.followCursor!==t&&(p(),t?(h(),!r.state.isMounted||i||s()||a()):(l(),c()))},onMount:function(){r.props.followCursor&&!i&&(e&&(d(f),e=!1),s()||a())},onTrigger:function(e,t){ue(t)&&(f={clientX:t.clientX,clientY:t.clientY}),i="focus"===t.type},onHidden:function(){r.props.followCursor&&(c(),l(),e=!0)}}}};var P={name:"inlinePositioning",defaultValue:!1,fn:function(i){var t,p=i.reference;var f=-1,r=!1,n=[],o={name:"tippyInlinePositioning",enabled:!0,phase:"afterWrite",fn:function(e){var h=e.state;i.props.inlinePositioning&&(-1!==n.indexOf(h.placement)&&(n=[]),t!==h.placement&&-1===n.indexOf(h.placement)&&(n.push(h.placement),i.setProps({getReferenceClientRect:function(){var t=Te(h.placement),e=p.getBoundingClientRect(),r=le(p.getClientRects()),n=f;if(r.length<2||null===t)return e;if(2===r.length&&0<=n&&r[0].left>r[1].right)return r[n]||e;switch(t){case"top":case"bottom":var i=r[0],o=r[r.length-1],s="top"===t,a=i.top,l=o.bottom,c=(s?i:o).left,s=(s?i:o).right;return{top:a,bottom:l,left:c,right:s,width:s-c,height:l-a};case"left":case"right":var u=Math.min.apply(Math,r.map(function(e){return e.left})),d=Math.max.apply(Math,r.map(function(e){return e.right})),i=r.filter(function(e){return"left"===t?e.left===u:e.right===d}),o=i[0].top,s=i[i.length-1].bottom;return{top:o,bottom:s,left:u,right:d,width:d-u,height:s-o};default:return e}}})),t=h.placement)}};function e(){var e,t;r||(e=i.props,t=o,e={popperOptions:Object.assign({},e.popperOptions,{modifiers:[].concat(((null==(e=e.popperOptions)?void 0:e.modifiers)||[]).filter(function(e){return e.name!==t.name}),[t])})},r=!0,i.setProps(e),r=!1)}return{onCreate:e,onAfterUpdate:e,onTrigger:function(e,t){var r,n;ue(t)&&(r=(n=le(i.reference.getClientRects())).find(function(e){return e.left-2<=t.clientX&&e.right+2>=t.clientX&&e.top-2<=t.clientY&&e.bottom+2>=t.clientY}),n=n.indexOf(r),f=-1<n?n:f)},onHidden:function(){f=-1}}}};var t,L,F={name:"sticky",defaultValue:!1,fn:function(r){var n=r.reference,i=r.popper;function o(e){return!0===r.props.sticky||r.props.sticky===e}var s=null,a=null;function l(){var e=o("reference")?(r.popperInstance?r.popperInstance.state.elements.reference:n).getBoundingClientRect():null,t=o("popper")?i.getBoundingClientRect():null;(e&&H(s,e)||t&&H(a,t))&&r.popperInstance&&r.popperInstance.update(),s=e,a=t,r.state.isMounted&&requestAnimationFrame(l)}return{onMount:function(){r.props.sticky&&l()}}}};function H(e,t){return!e||!t||e.top!==t.top||e.right!==t.right||e.bottom!==t.bottom||e.left!==t.left}return e&&(e='.tippy-box[data-animation=fade][data-state=hidden]{opacity:0}[data-tippy-root]{max-width:calc(100vw - 10px)}.tippy-box{position:relative;background-color:#333;color:#fff;border-radius:4px;font-size:14px;line-height:1.4;white-space:normal;outline:0;transition-property:transform,visibility,opacity}.tippy-box[data-placement^=top]>.tippy-arrow{bottom:0}.tippy-box[data-placement^=top]>.tippy-arrow:before{bottom:-7px;left:0;border-width:8px 8px 0;border-top-color:initial;transform-origin:center top}.tippy-box[data-placement^=bottom]>.tippy-arrow{top:0}.tippy-box[data-placement^=bottom]>.tippy-arrow:before{top:-7px;left:0;border-width:0 8px 8px;border-bottom-color:initial;transform-origin:center bottom}.tippy-box[data-placement^=left]>.tippy-arrow{right:0}.tippy-box[data-placement^=left]>.tippy-arrow:before{border-width:8px 0 8px 8px;border-left-color:initial;right:-7px;transform-origin:center left}.tippy-box[data-placement^=right]>.tippy-arrow{left:0}.tippy-box[data-placement^=right]>.tippy-arrow:before{left:-7px;border-width:8px 8px 8px 0;border-right-color:initial;transform-origin:center right}.tippy-box[data-inertia][data-state=visible]{transition-timing-function:cubic-bezier(.54,1.5,.38,1.11)}.tippy-arrow{width:16px;height:16px;color:#333}.tippy-arrow:before{content:"";position:absolute;border-color:transparent;border-style:solid}.tippy-content{position:relative;padding:5px 9px;z-index:1}',(t=document.createElement("style")).textContent=e,t.setAttribute("data-tippy-stylesheet",""),e=document.head,(L=document.querySelector("head>style,head>link"))?e.insertBefore(t,L):e.appendChild(t)),v.setDefaultProps({plugins:[M,D,P,F],render:A}),v.createSingleton=function(e,t){void 0===t&&(t={}),ye(!Array.isArray(e),["The first argument passed to createSingleton() must be an array of","tippy instances. The passed value was",String(e)].join(" "));var i,o=e,n=[],s=[],a=t.overrides,r=[],l=!1;function c(){s=o.map(function(e){return se(e.props.triggerTarget||e.reference)}).reduce(function(e,t){return e.concat(t)},[])}function u(){n=o.map(function(e){return e.reference})}function d(t){o.forEach(function(e){t?e.enable():e.disable()})}function h(n){return o.map(function(t){var r=t.setProps;return t.setProps=function(e){r(e),t.reference===i&&n.setProps(e)},function(){t.setProps=r}})}function p(e,t){var r=s.indexOf(t);t!==i&&(i=t,t=(a||[]).concat("content").reduce(function(e,t){return e[t]=o[r].props[t],e},{}),e.setProps(Object.assign({},t,{getReferenceClientRect:"function"==typeof t.getReferenceClientRect?t.getReferenceClientRect:function(){var e;return null==(e=n[r])?void 0:e.getBoundingClientRect()}})))}d(!1),u(),c();var e={fn:function(){return{onDestroy:function(){d(!0)},onHidden:function(){i=null},onClickOutside:function(e){e.props.showOnCreate&&!l&&(l=!0,i=null)},onShow:function(e){e.props.showOnCreate&&!l&&(l=!0,p(e,n[0]))},onTrigger:function(e,t){p(e,t.currentTarget)}}}},f=v(ce(),Object.assign({},y(t,["overrides"]),{plugins:[e].concat(t.plugins||[]),triggerTarget:s,popperOptions:Object.assign({},t.popperOptions,{modifiers:[].concat((null==(e=t.popperOptions)?void 0:e.modifiers)||[],[O])})})),g=f.show,m=(f.show=function(e){var t;return g(),i||null!=e?i&&null==e?void 0:"number"==typeof e?n[e]&&p(f,n[e]):0<=o.indexOf(e)?(t=e.reference,p(f,t)):0<=n.indexOf(e)?p(f,e):void 0:p(f,n[0])},f.showNext=function(){var e=n[0];if(!i)return f.show(0);var t=n.indexOf(i);f.show(n[t+1]||e)},f.showPrevious=function(){var e=n[n.length-1];if(!i)return f.show(e);var t=n.indexOf(i),t=n[t-1]||e;f.show(t)},f.setProps);return f.setProps=function(e){a=e.overrides||a,m(e)},f.setInstances=function(e){d(!0),r.forEach(function(e){return e()}),o=e,d(!1),u(),c(),r=h(f),f.setProps({triggerTarget:s})},r=h(f),f},v.delegate=function(e,n){ye(!(n&&n.target),["You must specity a `target` prop indicating a CSS selector string matching","the target elements that should receive a tippy."].join(" "));var i=[],o=[],s=!1,a=n.target,t=y(n,["target"]),r=Object.assign({},t,{trigger:"manual",touch:!1}),l=Object.assign({touch:ve.touch},t,{showOnCreate:!0});function c(e){var t,r;e.target&&!s&&(t=e.target.closest(a))&&(r=t.getAttribute("data-tippy-trigger")||n.trigger||ve.trigger,t._tippy||"touchstart"===e.type&&"boolean"==typeof l.touch||"touchstart"!==e.type&&r.indexOf(I[e.type])<0||(r=v(t,l))&&(o=o.concat(r)))}function u(e,t,r,n){e.addEventListener(t,r,n=void 0===n?!1:n),i.push({node:e,eventType:t,handler:r,options:n})}return se(t=v(e,r)).forEach(function(e){var t=e.destroy,r=e.enable,n=e.disable;e.destroy=function(e){(e=void 0===e?!0:e)&&o.forEach(function(e){e.destroy()}),o=[],i.forEach(function(e){var t=e.node,r=e.eventType,n=e.handler,e=e.options;t.removeEventListener(r,n,e)}),i=[],t()},e.enable=function(){r(),o.forEach(function(e){return e.enable()}),s=!1},e.disable=function(){n(),o.forEach(function(e){return e.disable()}),s=!0},u(e=(e=e).reference,"touchstart",c,te),u(e,"mouseover",c),u(e,"focusin",c),u(e,"click",c)}),t},v.hideAll=function(e){var e=void 0===e?{}:e,r=e.exclude,n=e.duration;Ce.forEach(function(e){var t=!1;(t=r?u(r)?e.reference===r:e.popper===r.popper:t)||(t=e.props.duration,e.setProps({duration:n}),e.hide(),e.state.isDestroyed)||e.setProps({duration:t})})},v.roundArrow='<svg width="16" height="6" xmlns="http://www.w3.org/2000/svg"><path d="M0 6s1.796-.013 4.67-3.615C5.851.9 6.93.006 8 0c1.07-.006 2.148.887 3.343 2.385C14.233 6.005 16 6 16 6H0z"></svg>',v}),!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).introJs=t()}(this,function(){"use strict";function _(){_=function(){return s};var s={},e=Object.prototype,l=e.hasOwnProperty,c=Object.defineProperty||function(e,t,r){e[t]=r.value},t="function"==typeof Symbol?Symbol:{},n=t.iterator||"@@iterator",r=t.asyncIterator||"@@asyncIterator",i=t.toStringTag||"@@toStringTag";function o(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(e){o=function(e,t,r){return e[t]=r}}function a(e,t,r,n){var i,o,s,a,t=t&&t.prototype instanceof h?t:h,t=Object.create(t.prototype),n=new C(n||[]);return c(t,"_invoke",{value:(i=e,o=r,s=n,a="suspendedStart",function(e,t){if("executing"===a)throw new Error("Generator is already running");if("completed"===a){if("throw"===e)throw t;return T()}for(s.method=e,s.arg=t;;){var r=s.delegate;if(r){r=function e(t,r){var n=r.method,i=t.iterator[n];if(void 0===i)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=void 0,e(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;n=u(i,t.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,d;i=n.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,d):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}(r,s);if(r){if(r===d)continue;return r}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if("suspendedStart"===a)throw a="completed",s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);a="executing";r=u(i,o,s);if("normal"===r.type){if(a=s.done?"completed":"suspendedYield",r.arg===d)continue;return{value:r.arg,done:s.done}}"throw"===r.type&&(a="completed",s.method="throw",s.arg=r.arg)}})}),t}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}s.wrap=a;var d={};function h(){}function p(){}function f(){}var t={},g=(o(t,n,function(){return this}),Object.getPrototypeOf),g=g&&g(g(E([]))),m=(g&&g!==e&&l.call(g,n)&&(t=g),f.prototype=h.prototype=Object.create(t));function y(e){["next","throw","return"].forEach(function(t){o(e,t,function(e){return this._invoke(t,e)})})}function v(s,a){var t;c(this,"_invoke",{value:function(r,n){function e(){return new a(function(e,t){!function t(e,r,n,i){var o,e=u(s[e],s,r);if("throw"!==e.type)return(r=(o=e.arg).value)&&"object"==typeof r&&l.call(r,"__await")?a.resolve(r.__await).then(function(e){t("next",e,n,i)},function(e){t("throw",e,n,i)}):a.resolve(r).then(function(e){o.value=e,n(o)},function(e){return t("throw",e,n,i)});i(e.arg)}(r,n,e,t)})}return t=t?t.then(e,e):e()}})}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function E(t){if(t){var r,e=t[n];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return r=-1,(e=function e(){for(;++r<t.length;)if(l.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e}).next=e}return{next:T}}function T(){return{value:void 0,done:!0}}return c(m,"constructor",{value:p.prototype=f,configurable:!0}),c(f,"constructor",{value:p,configurable:!0}),p.displayName=o(f,i,"GeneratorFunction"),s.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},s.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,o(e,i,"GeneratorFunction")),e.prototype=Object.create(m),e},s.awrap=function(e){return{__await:e}},y(v.prototype),o(v.prototype,r,function(){return this}),s.AsyncIterator=v,s.async=function(e,t,r,n,i){void 0===i&&(i=Promise);var o=new v(a(e,t,r,n),i);return s.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},y(m),o(m,i,"Generator"),o(m,n,function(){return this}),o(m,"toString",function(){return"[object Generator]"}),s.keys=function(e){var t,r=Object(e),n=[];for(t in r)n.push(t);return n.reverse(),function e(){for(;n.length;){var t=n.pop();if(t in r)return e.value=t,e.done=!1,e}return e.done=!0,e}},s.values=E,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!e)for(var t in this)"t"===t.charAt(0)&&l.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function e(e,t){return o.type="throw",o.arg=r,n.next=e,t&&(n.method="next",n.arg=void 0),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var i=this.tryEntries[t],o=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var s=l.call(i,"catchLoc"),a=l.call(i,"finallyLoc");if(s&&a){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!a)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&l.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}var o=(i=i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc?null:i)?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),w(r),d}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r,n,i=this.tryEntries[t];if(i.tryLoc===e)return"throw"===(r=i.completion).type&&(n=r.arg,w(i)),n}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:E(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},s}function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t,r,n,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return r(e)}a.done?t(l):Promise.resolve(l).then(n,i)}function x(a){return function(){var e=this,s=arguments;return new Promise(function(t,r){var n=a.apply(e,s);function i(e){m(n,t,r,i,o,"next",e)}function o(e){m(n,t,r,i,o,"throw",e)}i(void 0)})}}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function H(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,B(n.key),n)}}function U(e,t,r){t&&H(e.prototype,t),r&&H(e,r),Object.defineProperty(e,"prototype",{writable:!1})}function a(e,t,r){(t=B(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}function V(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,s,a=[],l=!0,c=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);l=!0);}catch(e){c=!0,i=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw i}}return a}}(e,t)||W(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function W(e,t){var r;if(e)return"string"==typeof e?$(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?$(e,t):void 0}function $(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function v(e,t){var r,n,i,o,s="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(s)return i=!(n=!0),{s:function(){s=s.call(e)},n:function(){var e=s.next();return n=e.done,e},e:function(e){i=!0,r=e},f:function(){try{n||null==s.return||s.return()}finally{if(i)throw r}}};if(Array.isArray(e)||(s=W(e))||t&&e&&"number"==typeof e.length)return s&&(e=s),o=0,{s:t=function(){},n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function B(e){e=function(e){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0===t)return String(e);t=t.call(e,"string");if("object"!=typeof t)return t;throw new TypeError("@@toPrimitive must return a primitive value.")}(e);return"symbol"==typeof e?e:String(e)}function j(e,t,r){a(n={},e,t),a(n,"path","/"),a(n,"expires",void 0);var n,i,o=n,s=(r&&((t=new Date).setTime(t.getTime()+24*r*60*60*1e3),o.expires=t.toUTCString()),[]);for(i in o)s.push("".concat(i,"=").concat(o[i]));document.cookie=s.join("; "),z(e)}function z(e){return r={},document.cookie.split(";").forEach(function(e){var e=V(e.split("="),2),t=e[0],e=e[1];r[t.trim()]=e}),r[e];var r}function i(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"introjs-stamp";return r[t]=r[t]||0,void 0===e[t]&&(e[t]=r[t]++),e[t]}r={};U(e,[{key:"_id",value:function(e,t,r){return e+i(t)+(r?"_".concat(i(r)):"")}},{key:"on",value:function(t,e,r,n,i){function o(e){return r(n||t,e||window.event)}var s=this._id(e,r,n);"addEventListener"in t?t.addEventListener(e,o,i):"attachEvent"in t&&t.attachEvent("on".concat(e),o),t[this.events_key]=t[this.events_key]||{},t[this.events_key][s]=o}},{key:"off",value:function(e,t,r,n,i){r=this._id(t,r,n),n=e[this.events_key]&&e[this.events_key][r];n&&("removeEventListener"in e?e.removeEventListener(t,n,i):"detachEvent"in e&&e.detachEvent("on".concat(t),n),e[this.events_key][r]=null)}}]);var r,p=new e,R=function(e){return"function"==typeof e};function e(){y(this,e),a(this,"events_key","introjs_event")}function A(e,t){if(e instanceof SVGElement){var r=e.getAttribute("class")||"";r.match(t)||e.setAttribute("class","".concat(r," ").concat(t))}else if(void 0!==e.classList){var n,i=v(t.split(" "));try{for(i.s();!(n=i.n()).done;){var o=n.value;e.classList.add(o)}}catch(e){i.e(e)}finally{i.f()}}else e.className.match(t)||(e.className+=" ".concat(t))}function N(e,t){var r="";return"currentStyle"in e?r=e.currentStyle[t]:document.defaultView&&document.defaultView.getComputedStyle&&(r=document.defaultView.getComputedStyle(e,null).getPropertyValue(t)),r&&r.toLowerCase?r.toLowerCase():r}function Y(e,t){e&&(e=function(e){var t=window.getComputedStyle(e),r="absolute"===t.position,n=/(auto|scroll)/;if("fixed"!==t.position)for(var i=e;i=i.parentElement;)if(t=window.getComputedStyle(i),(!r||"static"!==t.position)&&n.test(t.overflow+t.overflowY+t.overflowX))return i;return document.body}(t))!==document.body&&(e.scrollTop=t.offsetTop-e.offsetTop)}function b(){var e;return void 0!==window.innerWidth?{width:window.innerWidth,height:window.innerHeight}:{width:(e=document.documentElement).clientWidth,height:e.clientHeight}}function G(e,t,r,n,i){"off"===t||!e||(e=("tooltip"===t?i:n).getBoundingClientRect(),0<=(t=n.getBoundingClientRect()).top&&0<=t.left&&t.bottom+80<=window.innerHeight&&t.right<=window.innerWidth)||(i=b().height,e.bottom-(e.bottom-e.top)<0||n.clientHeight>i?window.scrollBy(0,e.top-(i/2-e.height/2)-r):window.scrollBy(0,e.top-(i/2-e.height/2)+r))}function O(e){e.setAttribute("role","button"),e.tabIndex=0}function c(e){var t=e.parentElement;return!(!t||"HTML"===t.nodeName)&&("fixed"===N(e,"position")||c(t))}function w(e,t){var r=document.body,n=document.documentElement,i=window.pageYOffset||n.scrollTop||r.scrollTop,n=window.pageXOffset||n.scrollLeft||r.scrollLeft,r=(t=t||r,e.getBoundingClientRect()),o=t.getBoundingClientRect(),s=N(t,"position"),a={width:r.width,height:r.height};return"body"!==t.tagName.toLowerCase()&&"relative"===s||"sticky"===s?Object.assign(a,{top:r.top-o.top,left:r.left-o.left}):c(e)?Object.assign(a,{top:r.top,left:r.left}):Object.assign(a,{top:r.top+i,left:r.left+n})}function o(e,t){var r;e instanceof SVGElement?(r=e.getAttribute("class")||"",e.setAttribute("class",r.replace(t,"").replace(/^\s+|\s+$/g,""))):e.className=e.className.replace(t,"").replace(/^\s+|\s+$/g,"")}function I(e,t){var r="";if(e.style.cssText&&(r+=e.style.cssText),"string"==typeof t)r+=t;else for(var n in t)r+="".concat(n,":").concat(t[n],";");e.style.cssText=r}function M(e,t,r){var n;r&&t&&(n=w(t.element,e._targetElement),e=e._options.helperElementPadding,(t.element instanceof Element&&c(t.element)?A:o)(r,"introjs-fixedTooltip"),"floating"===t.position&&(e=0),I(r,{width:"".concat(n.width+e,"px"),height:"".concat(n.height+e,"px"),top:"".concat(n.top-e/2,"px"),left:"".concat(n.left-e/2,"px")}))}function C(e,t,r,n,i){e.left+t+r.width>n.width?i.style.left="".concat(n.width-r.width-e.left,"px"):i.style.left="".concat(t,"px")}function E(e,t,r,n){return e.left+e.width-t-r.width<0?(n.style.left="".concat(-e.left,"px"),0):(n.style.right="".concat(t,"px"),1)}function T(e,t){e.includes(t)&&e.splice(e.indexOf(t),1)}function k(e,t,r,n,i){var o,s,a,l,c,u,d,h,p=4<arguments.length&&void 0!==i&&i;if(t){var f,g,m,i="",y=(r.style.top="",r.style.right="",r.style.bottom="",r.style.left="",r.style.marginLeft="",r.style.marginTop="",n.style.display="inherit",i=("string"==typeof t.tooltipClass?t:e._options).tooltipClass,r.className=["introjs-tooltip",i].filter(Boolean).join(" "),r.setAttribute("role","dialog"),"floating"!==(i=t.position)&&e._options.autoPosition&&(o=e._options.positionPrecedence,s=t.element,a=r,l=i,o=o.slice(),u=b(),d=w(a).height+10,a=w(a).width+20,s=s.getBoundingClientRect(),h="floating",s.bottom+d>u.height&&T(o,"bottom"),s.top-d<0&&T(o,"top"),s.right+a>u.width&&T(o,"right"),s.left-a<0&&T(o,"left"),l=l&&l.split("-")[0],"top"!==(h=o.length&&(h=o[0],o.includes(l))?l:h)&&"bottom"!==h||(d=[],d="top"===h?["top-left-aligned",c="top-middle-aligned","top-right-aligned"]:["bottom-left-aligned",c="bottom-middle-aligned","bottom-right-aligned"],o=s.left,l=a,s=u.width,a=d,u=l/2,(s=Math.min(s,window.screen.width))-o<l&&(T(a,"top-left-aligned"),T(a,"bottom-left-aligned")),(o<u||s-o<u)&&(T(a,"top-middle-aligned"),T(a,"bottom-middle-aligned")),o<l&&(T(a,"top-right-aligned"),T(a,"bottom-right-aligned")),h=(a.length?a[0]:null)||c),i=h),g=w(t.element),f=w(r),m=b(),A(r,"introjs-".concat(i)),g.width/2-f.width/2);switch(i){case"top-right-aligned":n.className="introjs-arrow bottom-right";var v=0;E(g,v,f,r),r.style.bottom="".concat(g.height+20,"px");break;case"top-middle-aligned":n.className="introjs-arrow bottom-middle",p&&(y+=5),E(g,y,f,r)&&(r.style.right="",C(g,y,f,m,r)),r.style.bottom="".concat(g.height+20,"px");break;case"top-left-aligned":case"top":n.className="introjs-arrow bottom",C(g,p?0:15,f,m,r),r.style.bottom="".concat(g.height+20,"px");break;case"right":r.style.left="".concat(g.width+20,"px"),g.top+f.height>m.height?(n.className="introjs-arrow left-bottom",r.style.top="-".concat(f.height-g.height-20,"px")):n.className="introjs-arrow left";break;case"left":p||!0!==e._options.showStepNumbers||(r.style.top="15px"),g.top+f.height>m.height?(r.style.top="-".concat(f.height-g.height-20,"px"),n.className="introjs-arrow right-bottom"):n.className="introjs-arrow right",r.style.right="".concat(g.width+20,"px");break;case"floating":n.style.display="none",r.style.left="50%",r.style.top="50%",r.style.marginLeft="-".concat(f.width/2,"px"),r.style.marginTop="-".concat(f.height/2,"px");break;case"bottom-right-aligned":n.className="introjs-arrow top-right",E(g,v=0,f,r),r.style.top="".concat(g.height+20,"px");break;case"bottom-middle-aligned":n.className="introjs-arrow top-middle",p&&(y+=5),E(g,y,f,r)&&(r.style.right="",C(g,y,f,m,r)),r.style.top="".concat(g.height+20,"px");break;default:n.className="introjs-arrow top",C(g,0,f,m,r),r.style.top="".concat(g.height+20,"px")}}}function q(){for(var e=0,t=Array.from(document.querySelectorAll(".introjs-showElement"));e<t.length;e++)o(t[e],/introjs-[a-zA-Z]+/g)}function D(e,t){var r,n=document.createElement(e),i=/^(?:role|data-|aria-)/;for(r in t=t||{}){var o=t[r];"style"===r&&"function"!=typeof o?I(n,o):"string"==typeof o&&r.match(i)?n.setAttribute(r,o):n[r]=o}return n}function K(e,t,r){var n;2<arguments.length&&void 0!==r&&r&&(n=t.style.opacity||"1",I(t,{opacity:"0"}),window.setTimeout(function(){I(t,{opacity:n})},10)),e.appendChild(t)}function X(e,t){return(e+1)/t*100}function J(t,e){var r=D("div",{className:"introjs-bullets"}),n=(!1===t._options.showBullets&&(r.style.display="none"),D("ul"));n.setAttribute("role","tablist");for(var i=function(){var e=this.getAttribute("data-step-number");null!=e&&t.goToStep(parseInt(e,10))},o=0;o<t._introItems.length;o++){var s=t._introItems[o].step,a=D("li"),l=D("a");a.setAttribute("role","presentation"),l.setAttribute("role","tab"),l.onclick=i,o===e.step-1&&(l.className="active"),O(l),l.innerHTML="&nbsp;",l.setAttribute("data-step-number",s.toString()),a.appendChild(l),n.appendChild(a)}return r.appendChild(n),r}function Z(e,t,r){e=e.querySelector(".introjs-progress .introjs-progressbar");e&&(t=X(t,r),e.style.cssText="width:".concat(t,"%;"),e.setAttribute("aria-valuenow",t.toString()))}function Q(){return ee.apply(this,arguments)}function ee(){return(ee=x(_().mark(function e(s,a){var l,c,u,d,h,p,f,g,m,y,v,b,w,C,E,T,S;return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(R(s._introChangeCallback))return e.next=3,s._introChangeCallback.call(s,a.element);e.next=3;break;case 3:if(E=document.querySelector(".introjs-helperLayer"),l=document.querySelector(".introjs-tooltipReferenceLayer"),y="introjs-helperLayer","string"==typeof a.highlightClass&&(y+=" ".concat(a.highlightClass)),"string"==typeof s._options.highlightClass&&(y+=" ".concat(s._options.highlightClass)),null!==E&&null!==l?(h=l.querySelector(".introjs-helperNumberLayer"),p=l.querySelector(".introjs-tooltiptext"),f=l.querySelector(".introjs-tooltip-title"),g=l.querySelector(".introjs-arrow"),m=l.querySelector(".introjs-tooltip"),d=l.querySelector(".introjs-skipbutton"),u=l.querySelector(".introjs-prevbutton"),c=l.querySelector(".introjs-nextbutton"),E.className=y,m.style.opacity="0",m.style.display="none",Y(s._options.scrollToElement,a.element),M(s,a,E),M(s,a,l),q(),s._lastShowElementTimer&&window.clearTimeout(s._lastShowElementTimer),s._lastShowElementTimer=window.setTimeout(function(){var e,t,r;null!==h&&(h.innerHTML="".concat(a.step," ").concat(s._options.stepNumbersOfLabel," ").concat(s._introItems.length)),p.innerHTML=a.intro||"",f.innerHTML=a.title||"",m.style.display="block",k(s,a,m,g),e=s._options.showBullets,t=l,r=a,e&&(e=t.querySelector(".introjs-bullets li > a.active"),t=t.querySelector('.introjs-bullets li > a[data-step-number="'.concat(r.step,'"]')),e)&&t&&(e.className="",t.className="active"),Z(l,s._currentStep,s._introItems.length),m.style.opacity="1",(null!=c&&/introjs-donebutton/gi.test(c.className)||null!=c)&&c.focus(),G(s._options.scrollToElement,a.scrollTo,s._options.scrollPadding,a.element,p)},350)):(E=D("div",{className:y}),y=D("div",{className:"introjs-tooltipReferenceLayer"}),v=D("div",{className:"introjs-arrow"}),b=D("div",{className:"introjs-tooltip"}),S=D("div",{className:"introjs-tooltiptext"}),w=D("div",{className:"introjs-tooltip-header"}),T=D("h1",{className:"introjs-tooltip-title"}),C=D("div"),I(E,{"box-shadow":"0 0 1px 2px rgba(33, 33, 33, 0.8), rgba(33, 33, 33, ".concat(s._options.overlayOpacity.toString(),") 0 0 0 5000px")}),Y(s._options.scrollToElement,a.element),M(s,a,E),M(s,a,y),K(s._targetElement,E,!0),K(s._targetElement,y),S.innerHTML=a.intro,T.innerHTML=a.title,!(C.className="introjs-tooltipbuttons")===s._options.showButtons&&(C.style.display="none"),w.appendChild(T),b.appendChild(w),b.appendChild(S),s._options.dontShowAgain&&(E=D("div",{className:"introjs-dontShowAgain"}),(T=D("input",{type:"checkbox",id:"introjs-dontShowAgain",name:"introjs-dontShowAgain"})).onchange=function(e){s.setDontShowAgain(e.target.checked)},(S=D("label",{htmlFor:"introjs-dontShowAgain"})).innerText=s._options.dontShowAgainLabel,E.appendChild(T),E.appendChild(S),b.appendChild(E)),b.appendChild(J(s,a)),b.appendChild((n=s,o=i=void 0,!((i=D("div")).className="introjs-progress")===n._options.showProgress&&(i.style.display="none"),o=D("div",{className:"introjs-progressbar"}),n._options.progressBarAdditionalClass&&(o.className+=" "+n._options.progressBarAdditionalClass),n=X(n._currentStep,n._introItems.length),o.setAttribute("role","progress"),o.setAttribute("aria-valuemin","0"),o.setAttribute("aria-valuemax","100"),o.setAttribute("aria-valuenow",n.toString()),o.style.cssText="width:".concat(n,"%;"),i.appendChild(o),i)),T=D("div"),!0===s._options.showStepNumbers&&(T.className="introjs-helperNumberLayer",T.innerHTML="".concat(a.step," ").concat(s._options.stepNumbersOfLabel," ").concat(s._introItems.length),b.appendChild(T)),b.appendChild(v),y.appendChild(b),(c=D("a")).onclick=x(_().mark(function e(){return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s._introItems.length-1!==s._currentStep)return e.next=3,P(s);e.next=5;break;case 3:e.next=11;break;case 5:if(/introjs-donebutton/gi.test(c.className)){if(R(s._introCompleteCallback))return e.next=9,s._introCompleteCallback.call(s,s._currentStep,"done");e.next=9}else e.next=11;break;case 9:return e.next=11,F(s,s._targetElement);case 11:case"end":return e.stop()}},e)})),O(c),c.innerHTML=s._options.nextLabel,(u=D("a")).onclick=x(_().mark(function e(){return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0<s._currentStep)return e.next=3,L(s);e.next=3;break;case 3:case"end":return e.stop()}},e)})),O(u),u.innerHTML=s._options.prevLabel,O(d=D("a",{className:"introjs-skipbutton"})),d.innerHTML=s._options.skipLabel,d.onclick=x(_().mark(function e(){return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s._introItems.length-1===s._currentStep&&R(s._introCompleteCallback))return e.next=3,s._introCompleteCallback.call(s,s._currentStep,"skip");e.next=3;break;case 3:if(R(s._introSkipCallback))return e.next=6,s._introSkipCallback.call(s,s._currentStep);e.next=6;break;case 6:return e.next=8,F(s,s._targetElement);case 8:case"end":return e.stop()}},e)})),w.appendChild(d),1<s._introItems.length&&C.appendChild(u),C.appendChild(c),b.appendChild(C),k(s,a,b,v),G(s._options.scrollToElement,a.scrollTo,s._options.scrollPadding,a.element,b)),(S=s._targetElement.querySelector(".introjs-disableInteraction"))&&S.parentNode&&S.parentNode.removeChild(S),a.disableInteraction&&(n=s,o=a,i=void 0,null===(i=document.querySelector(".introjs-disableInteraction"))&&(i=D("div",{className:"introjs-disableInteraction"}),n._targetElement.appendChild(i)),M(n,o,i)),0===s._currentStep&&1<s._introItems.length?(null!=c&&(c.className="".concat(s._options.buttonClass," introjs-nextbutton"),c.innerHTML=s._options.nextLabel),!0===s._options.hidePrev?(null!=u&&(u.className="".concat(s._options.buttonClass," introjs-prevbutton introjs-hidden")),null!=c&&A(c,"introjs-fullbutton")):null!=u&&(u.className="".concat(s._options.buttonClass," introjs-prevbutton introjs-disabled"))):s._introItems.length-1===s._currentStep||1===s._introItems.length?(null!=u&&(u.className="".concat(s._options.buttonClass," introjs-prevbutton")),!0===s._options.hideNext?(null!=c&&(c.className="".concat(s._options.buttonClass," introjs-nextbutton introjs-hidden")),null!=u&&A(u,"introjs-fullbutton")):null!=c&&(!0===s._options.nextToDone?(c.innerHTML=s._options.doneLabel,A(c,"".concat(s._options.buttonClass," introjs-nextbutton introjs-donebutton"))):c.className="".concat(s._options.buttonClass," introjs-nextbutton introjs-disabled"))):(null!=u&&(u.className="".concat(s._options.buttonClass," introjs-prevbutton")),null!=c&&(c.className="".concat(s._options.buttonClass," introjs-nextbutton"),c.innerHTML=s._options.nextLabel)),null!=u&&u.setAttribute("role","button"),null!=c&&c.setAttribute("role","button"),null!=d&&d.setAttribute("role","button"),null!=c&&c.focus(),t=a.element,r=void 0,A(t,"introjs-showElement"),"absolute"!==(r=N(t,"position"))&&"relative"!==r&&"sticky"!==r&&"fixed"!==r&&A(t,"introjs-relativePosition"),R(s._introAfterChangeCallback))return e.next=21,s._introAfterChangeCallback.call(s,a.element);e.next=21;break;case 21:case"end":return e.stop()}var t,r,n,i,o},e)}))).apply(this,arguments)}function te(){return(te=x(_().mark(function e(t,r){return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t._currentStep=r-2,void 0!==t._introItems)return e.next=4,P(t);e.next=4;break;case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function re(){return(re=x(_().mark(function e(t,r){return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t._currentStepNumber=r,void 0!==t._introItems)return e.next=4,P(t);e.next=4;break;case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function P(){return ne.apply(this,arguments)}function ne(){return(ne=x(_().mark(function e(t){var r,n,i;return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t._direction="forward",void 0!==t._currentStepNumber)for(r=0;r<t._introItems.length;r++)t._introItems[r].step===t._currentStepNumber&&(t._currentStep=r-1,t._currentStepNumber=void 0);if(-1===t._currentStep?t._currentStep=0:++t._currentStep,n=t._introItems[t._currentStep],i=!0,R(t._introBeforeChangeCallback))return e.next=8,t._introBeforeChangeCallback.call(t,n&&n.element,t._currentStep,t._direction);e.next=9;break;case 8:i=e.sent;case 9:if(!1===i)return--t._currentStep,e.abrupt("return",!1);e.next=12;break;case 12:if(t._introItems.length<=t._currentStep){if(R(t._introCompleteCallback))return e.next=16,t._introCompleteCallback.call(t,t._currentStep,"end");e.next=16}else e.next=19;break;case 16:return e.next=18,F(t,t._targetElement);case 18:return e.abrupt("return",!1);case 19:return e.next=21,Q(t,n);case 21:return e.abrupt("return",!0);case 22:case"end":return e.stop()}},e)}))).apply(this,arguments)}function L(){return ie.apply(this,arguments)}function ie(){return(ie=x(_().mark(function e(t){var r,n;return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t._direction="backward",t._currentStep<=0)return e.abrupt("return",!1);e.next=3;break;case 3:if(--t._currentStep,r=t._introItems[t._currentStep],n=!0,R(t._introBeforeChangeCallback))return e.next=9,t._introBeforeChangeCallback.call(t,r&&r.element,t._currentStep,t._direction);e.next=10;break;case 9:n=e.sent;case 10:if(!1===n)return++t._currentStep,e.abrupt("return",!1);e.next=13;break;case 13:return e.next=15,Q(t,r);case 15:return e.abrupt("return",!0);case 16:case"end":return e.stop()}},e)}))).apply(this,arguments)}function oe(e,t){return se.apply(this,arguments)}function se(){return(se=x(_().mark(function e(t,r){var n,i;return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("Escape"!==(n=null===(n=void 0===r.code?r.which:r.code)?null===r.charCode?r.keyCode:r.charCode:n)&&27!==n||!0!==t._options.exitOnEsc){e.next=7;break}return e.next=5,F(t,t._targetElement);case 5:e.next=39;break;case 7:if("ArrowLeft"===n||37===n)return e.next=10,L(t);e.next=12;break;case 10:e.next=39;break;case 12:if("ArrowRight"===n||39===n)return e.next=15,P(t);e.next=17;break;case 15:e.next=39;break;case 17:if("Enter"!==n&&"NumpadEnter"!==n&&13!==n)e.next=39;else{if((i=r.target||r.srcElement)&&i.className.match("introjs-prevbutton"))return e.next=22,L(t);e.next=24}break;case 22:e.next=38;break;case 24:if(i&&i.className.match("introjs-skipbutton")){if(t._introItems.length-1===t._currentStep&&R(t._introCompleteCallback))return e.next=28,t._introCompleteCallback.call(t,t._currentStep,"skip");e.next=28}else e.next=32;break;case 28:return e.next=30,F(t,t._targetElement);case 30:e.next=38;break;case 32:i&&i.getAttribute("data-step-number")?(i.click(),e.next=38):e.next=36;break;case 36:return e.next=38,P(t);case 38:r.preventDefault?r.preventDefault():r.returnValue=!1;case 39:case"end":return e.stop()}},e)}))).apply(this,arguments)}function S(e){if(null===e||"object"!==n(e)||"nodeType"in e)return e;var t,r={};for(t in e)"jQuery"in window&&e[t]instanceof window.jQuery?r[t]=e[t]:r[t]=S(e[t]);return r}function s(e){var t=document.querySelector(".introjs-hints");return t?Array.from(t.querySelectorAll(e)):[]}function u(){return ae.apply(this,arguments)}function ae(){return(ae=x(_().mark(function e(t,r){var n;return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=s('.introjs-hint[data-step="'.concat(r,'"]'))[0],f(),n&&A(n,"introjs-hidehint"),R(t._hintCloseCallback))return e.next=6,t._hintCloseCallback.call(t,r);e.next=6;break;case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function le(){return(le=x(_().mark(function e(t){var r,n;return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=s(".introjs-hint"),r=v(r),e.prev=2,r.s();case 4:if((n=r.n()).done){e.next=13;break}if(n=n.value,n=n.getAttribute("data-step")){e.next=9;break}return e.abrupt("continue",11);case 9:return e.next=11,u(t,parseInt(n,10));case 11:e.next=4;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),r.e(e.t0);case 18:return e.prev=18,r.f(),e.finish(18);case 21:case"end":return e.stop()}},e,null,[[2,15,18,21]])}))).apply(this,arguments)}function ce(){return(ce=x(_().mark(function e(t){var r,n;return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=s(".introjs-hint"))||!r.length){e.next=23;break}r=v(r),e.prev=3,r.s();case 5:if((n=r.n()).done){e.next=13;break}if(n=n.value,n=n.getAttribute("data-step")){e.next=10;break}return e.abrupt("continue",11);case 10:ue(parseInt(n,10));case 11:e.next=5;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),r.e(e.t0);case 18:return e.prev=18,r.f(),e.finish(18);case 21:e.next=25;break;case 23:return e.next=25,me(t,t._targetElement);case 25:case"end":return e.stop()}},e,null,[[3,15,18,21]])}))).apply(this,arguments)}function ue(e){e=s('.introjs-hint[data-step="'.concat(e,'"]'))[0];e&&o(e,/introjs-hidehint/g)}function de(e){e=s('.introjs-hint[data-step="'.concat(e,'"]'))[0];e&&e.parentNode&&e.parentNode.removeChild(e)}function he(){return(he=x(_().mark(function e(r){var t,n,i,o,s,a,l;return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:null===(t=document.querySelector(".introjs-hints"))&&(t=D("div",{className:"introjs-hints"})),n=function(t){return function(e){e=e||window.event;e&&e.stopPropagation&&e.stopPropagation(),e&&null!==e.cancelBubble&&(e.cancelBubble=!0),fe(r,t)}},i=0;case 4:if(i<r._hintItems.length){if(o=r._hintItems[i],document.querySelector('.introjs-hint[data-step="'.concat(i,'"]')))return e.abrupt("return");e.next=8}else e.next=25;break;case 8:O(s=D("a",{className:"introjs-hint"})),s.onclick=n(i),o.hintAnimation||A(s,"introjs-hint-no-anim"),c(o.element)&&A(s,"introjs-fixedhint"),a=D("div",{className:"introjs-hint-dot"}),l=D("div",{className:"introjs-hint-pulse"}),s.appendChild(a),s.appendChild(l),s.setAttribute("data-step",i.toString()),o.hintTargetElement=o.element,o.element=s,pe(o.hintPosition,s,o.hintTargetElement),t.appendChild(s);case 22:i++,e.next=4;break;case 25:if(document.body.appendChild(t),R(r._hintsAddedCallback))return e.next=29,r._hintsAddedCallback.call(r);e.next=29;break;case 29:0<=r._options.hintAutoRefreshInterval&&(r._hintsAutoRefreshFunction=function(n,i){var o;return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];window.clearTimeout(o),o=window.setTimeout(function(){n(t)},i)}}(function(){g(r)},r._options.hintAutoRefreshInterval),p.on(window,"scroll",r._hintsAutoRefreshFunction,r,!0));case 30:case"end":return e.stop()}},e)}))).apply(this,arguments)}function pe(e,t,r){if(void 0!==r){var n=w(r);switch(e){default:case"top-left":t.style.left="".concat(n.left,"px"),t.style.top="".concat(n.top,"px");break;case"top-right":t.style.left="".concat(n.left+n.width-20,"px"),t.style.top="".concat(n.top,"px");break;case"bottom-left":t.style.left="".concat(n.left,"px"),t.style.top="".concat(n.top+n.height-20,"px");break;case"bottom-right":t.style.left="".concat(n.left+n.width-20,"px"),t.style.top="".concat(n.top+n.height-20,"px");break;case"middle-left":t.style.left="".concat(n.left,"px"),t.style.top="".concat(n.top+(n.height-20)/2,"px");break;case"middle-right":t.style.left="".concat(n.left+n.width-20,"px"),t.style.top="".concat(n.top+(n.height-20)/2,"px");break;case"middle-middle":t.style.left="".concat(n.left+(n.width-20)/2,"px"),t.style.top="".concat(n.top+(n.height-20)/2,"px");break;case"bottom-middle":t.style.left="".concat(n.left+(n.width-20)/2,"px"),t.style.top="".concat(n.top+n.height-20,"px");break;case"top-middle":t.style.left="".concat(n.left+(n.width-20)/2,"px"),t.style.top="".concat(n.top,"px")}}}function fe(){return ge.apply(this,arguments)}function ge(){return(ge=x(_().mark(function e(t,r){var n,i,o,s,a,l,c;return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=document.querySelector('.introjs-hint[data-step="'.concat(r,'"]')),i=t._hintItems[r],R(t._hintClickCallback))return e.next=5,t._hintClickCallback.call(t,n,i,r);e.next=5;break;case 5:if(void 0!==(o=f())&&parseInt(o,10)===r)return e.abrupt("return");e.next=8;break;case 8:o=D("div",{className:"introjs-tooltip"}),c=D("div"),s=D("div"),a=D("div"),o.onclick=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},c.className="introjs-tooltiptext",(l=D("p")).innerHTML=i.hint||"",c.appendChild(l),t._options.hintShowButton&&((l=D("a")).className=t._options.buttonClass,l.setAttribute("role","button"),l.innerHTML=t._options.hintButtonLabel,l.onclick=function(){return u(t,r)},c.appendChild(l)),s.className="introjs-arrow",o.appendChild(s),o.appendChild(c),l=n.getAttribute("data-step")||"",t._currentStep=parseInt(l,10),c=t._hintItems[t._currentStep],a.className="introjs-tooltipReferenceLayer introjs-hintReference",a.setAttribute("data-step",l),M(t,c,a),a.appendChild(o),document.body.appendChild(a),k(t,c,o,s,!0);case 30:case"end":return e.stop()}},e)}))).apply(this,arguments)}function f(){var e=document.querySelector(".introjs-hintReference");if(e&&e.parentNode){var t=e.getAttribute("data-step");if(t)return e.parentNode.removeChild(e),t}}function me(){return ye.apply(this,arguments)}function ye(){return(ye=x(_().mark(function e(t,r){var n,i,o,s,a,l,c,u,d,h;return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t._hintItems=[],t._options.hints&&0<t._options.hints.length){n=v(t._options.hints);try{for(n.s();!(i=n.n()).done;)o=i.value,"string"==typeof(s=S(o)).element&&(s.element=document.querySelector(s.element)),s.hintPosition=s.hintPosition||t._options.hintPosition,s.hintAnimation=s.hintAnimation||t._options.hintAnimation,null!==s.element&&t._hintItems.push(s)}catch(e){n.e(e)}finally{n.f()}e.next=10}else e.next=6;break;case 6:if((a=Array.from(r.querySelectorAll("*[data-hint]")))&&a.length){e.next=9;break}return e.abrupt("return",!1);case 9:for(l=0,c=a;l<c.length;l++)u=c[l],d=u.getAttribute("data-hint-animation"),h=t._options.hintAnimation,d&&(h="true"===d),t._hintItems.push({element:u,hint:u.getAttribute("data-hint")||"",hintPosition:u.getAttribute("data-hint-position")||t._options.hintPosition,hintAnimation:h,tooltipClass:u.getAttribute("data-tooltip-class")||void 0,position:u.getAttribute("data-position")||t._options.tooltipPosition});case 10:return e.next=12,function(){return he.apply(this,arguments)}(t);case 12:return p.on(document,"click",f,t,!1),p.on(window,"resize",g,t,!0),e.abrupt("return",!0);case 15:case"end":return e.stop()}},e)}))).apply(this,arguments)}function g(e){var t,r=v(e._hintItems);try{for(r.s();!(t=r.n()).done;){var n=t.value,i=n.hintTargetElement;pe(n.hintPosition,n.element,i)}}catch(e){r.e(e)}finally{r.f()}}function ve(e,t){var t=Array.from(t.querySelectorAll("*[data-intro]")),r=[];if(e._options.steps&&e._options.steps.length){var n,i=v(e._options.steps);try{for(i.s();!(n=i.n()).done;){var o,s=S(n.value);s.step=r.length+1,s.title=s.title||"","string"==typeof s.element&&(s.element=document.querySelector(s.element)||void 0),void 0!==s.element&&null!==s.element||(null===(o=document.querySelector(".introjsFloatingElement"))&&(o=D("div",{className:"introjsFloatingElement"}),document.body.appendChild(o)),s.element=o,s.position="floating"),s.position=s.position||e._options.tooltipPosition,s.scrollTo=s.scrollTo||e._options.scrollTo,void 0===s.disableInteraction&&(s.disableInteraction=e._options.disableInteraction),null!==s.element&&r.push(s)}}catch(e){i.e(e)}finally{i.f()}}else{if(t.length<1)return[];var a,l=v(t);try{for(l.s();!(a=l.n()).done;){var c,u,d=a.value;e._options.group&&d.getAttribute("data-intro-group")!==e._options.group||"none"===d.style.display||(c=parseInt(d.getAttribute("data-step")||"",10),u=e._options.disableInteraction,d.hasAttribute("data-disable-interaction")&&(u=!!d.getAttribute("data-disable-interaction")),0<c&&(r[c-1]={step:c,element:d,title:d.getAttribute("data-title")||"",intro:d.getAttribute("data-intro")||"",tooltipClass:d.getAttribute("data-tooltip-class")||void 0,highlightClass:d.getAttribute("data-highlight-class")||void 0,position:d.getAttribute("data-position")||e._options.tooltipPosition,scrollTo:d.getAttribute("data-scroll-to")||e._options.scrollTo,disableInteraction:u}))}}catch(e){l.e(e)}finally{l.f()}var h,p=0,f=v(t);try{for(f.s();!(h=f.n()).done;){var g=h.value;if((!e._options.group||g.getAttribute("data-intro-group")===e._options.group)&&null===g.getAttribute("data-step")){for(;void 0!==r[p];)p++;u=g.hasAttribute("data-disable-interaction")?!!g.getAttribute("data-disable-interaction"):e._options.disableInteraction,r[p]={element:g,title:g.getAttribute("data-title")||"",intro:g.getAttribute("data-intro")||"",step:p+1,tooltipClass:g.getAttribute("data-tooltip-class")||void 0,highlightClass:g.getAttribute("data-highlight-class")||void 0,position:g.getAttribute("data-position")||e._options.tooltipPosition,scrollTo:g.getAttribute("data-scroll-to")||e._options.scrollTo,disableInteraction:u}}}}catch(e){f.e(e)}finally{f.f()}}for(var m=[],y=0;y<r.length;y++)r[y]&&m.push(r[y]);return(r=m).sort(function(e,t){return e.step-t.step}),r}function be(e,t){var r,n,i,o,s=e._currentStep;null!=s&&-1!=s&&(n=e._introItems[s],r=document.querySelector(".introjs-tooltipReferenceLayer"),o=document.querySelector(".introjs-helperLayer"),i=document.querySelector(".introjs-disableInteraction"),M(e,n,o),M(e,n,r),M(e,n,i),t&&(e._introItems=ve(e,e._targetElement),o=n,(i=e)._options.showBullets&&(t=document.querySelector(".introjs-bullets"))&&t.parentNode&&t.parentNode.replaceChild(J(i,o),t),Z(r,s,e._introItems.length)),n=document.querySelector(".introjs-arrow"),(i=document.querySelector(".introjs-tooltip"))&&n&&k(e,e._introItems[s],i,n),g(e))}function we(e){be(e)}function d(e,t){var r;e&&e.parentElement&&(r=e.parentElement,1<arguments.length&&void 0!==t&&t?(I(e,{opacity:"0"}),window.setTimeout(function(){try{r.removeChild(e)}catch(e){}},500)):r.removeChild(e))}function F(){return Ce.apply(this,arguments)}function Ce(){return(Ce=x(_().mark(function e(t,r){var n,i,o,s,a,l=arguments;return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=2<l.length&&void 0!==l[2]&&l[2],i=!0,void 0!==t._introBeforeExitCallback)return e.next=5,t._introBeforeExitCallback.call(t,r);e.next=6;break;case 5:i=e.sent;case 6:if(n||!1!==i){e.next=8;break}return e.abrupt("return");case 8:if((o=Array.from(r.querySelectorAll(".introjs-overlay")))&&o.length){s=v(o);try{for(s.s();!(a=s.n()).done;)d(a.value)}catch(e){s.e(e)}finally{s.f()}}if(d(r.querySelector(".introjs-helperLayer"),!0),d(r.querySelector(".introjs-tooltipReferenceLayer")),d(r.querySelector(".introjs-disableInteraction")),d(document.querySelector(".introjsFloatingElement")),q(),p.off(window,"keydown",oe,t,!0),p.off(window,"resize",we,t,!0),R(t._introExitCallback))return e.next=24,t._introExitCallback.call(t);e.next=24;break;case 24:t._currentStep=-1;case 25:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Ee(){return(Ee=x(_().mark(function e(i,o){var s;return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i.isActive()){e.next=2;break}return e.abrupt("return",!1);case 2:if(R(i._introStartCallback))return e.next=5,i._introStartCallback.call(i,o);e.next=5;break;case 5:if(0===(s=ve(i,o)).length)return e.abrupt("return",!1);e.next=8;break;case 8:i._introItems=s;var t=i,r=o,n=D("div",{className:"introjs-overlay"});return I(n,{top:0,bottom:0,left:0,right:0,position:"fixed"}),r.appendChild(n),!0===t._options.exitOnOverlayClick&&(I(n,{cursor:"pointer"}),n.onclick=x(_().mark(function e(){return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F(t,r);case 2:case"end":return e.stop()}},e)}))),e.next=12,P(i);case 12:o.addEventListener,i._options.keyboardNavigation&&p.on(window,"keydown",oe,i,!0),p.on(window,"resize",we,i,!0);case 15:return e.abrupt("return",!1);case 16:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Te(e,t,r){return e[t]=r,e}function l(e){var t;if("object"===n(e))t=new h(e);else if("string"==typeof e){e=document.querySelector(e);if(!e)throw new Error("There is no element with given selector.");t=new h(e)}else t=new h(document.body);return l.instances[i(t,"introjs-instance")]=t}U(t,[{key:"isActive",value:function(){return(!this._options.dontShowAgain||""===(e=z(this._options.dontShowAgainCookie))||"true"!==e)&&this._options.isActive;var e}},{key:"clone",value:function(){return new t(this._targetElement)}},{key:"setOption",value:function(e,t){return this._options=Te(this._options,e,t),this}},{key:"setOptions",value:function(i){return this._options=function(e){for(var t=0,r=Object.entries(i);t<r.length;t++){var n=V(r[t],2);e=Te(e,n[0],n[1])}return e}(this._options),this}},{key:"start",value:(ke=x(_().mark(function e(){return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,function(){return Ee.apply(this,arguments)}(this,this._targetElement);case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}},e,this)})),function(){return ke.apply(this,arguments)})},{key:"goToStep",value:(Me=x(_().mark(function e(t){return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,function(){return te.apply(this,arguments)}(this,t);case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}},e,this)})),function(e){return Me.apply(this,arguments)})},{key:"addStep",value:function(e){return this._options.steps||(this._options.steps=[]),this._options.steps.push(e),this}},{key:"addSteps",value:function(e){if(e.length)for(var t=0;t<e.length;t++)this.addStep(e[t]);return this}},{key:"goToStepNumber",value:(Ie=x(_().mark(function e(t){return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,function(){return re.apply(this,arguments)}(this,t);case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}},e,this)})),function(e){return Ie.apply(this,arguments)})},{key:"nextStep",value:(Oe=x(_().mark(function e(){return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P(this);case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}},e,this)})),function(){return Oe.apply(this,arguments)})},{key:"previousStep",value:(Ne=x(_().mark(function e(){return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L(this);case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}},e,this)})),function(){return Ne.apply(this,arguments)})},{key:"currentStep",value:function(){return this._currentStep}},{key:"exit",value:(Ae=x(_().mark(function e(t){return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F(this,this._targetElement,t);case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}},e,this)})),function(e){return Ae.apply(this,arguments)})},{key:"refresh",value:function(e){return be(this,e),this}},{key:"setDontShowAgain",value:function(e){return t=this,e?j(t._options.dontShowAgainCookie,"true",t._options.dontShowAgainCookieDays):j(t._options.dontShowAgainCookie,"",-1),this;var t}},{key:"onbeforechange",value:function(e){if(R(e))return this._introBeforeChangeCallback=e,this;throw new Error("Provided callback for onbeforechange was not a function")}},{key:"onchange",value:function(e){if(R(e))return this._introChangeCallback=e,this;throw new Error("Provided callback for onchange was not a function.")}},{key:"onafterchange",value:function(e){if(R(e))return this._introAfterChangeCallback=e,this;throw new Error("Provided callback for onafterchange was not a function")}},{key:"oncomplete",value:function(e){if(R(e))return this._introCompleteCallback=e,this;throw new Error("Provided callback for oncomplete was not a function.")}},{key:"onhintsadded",value:function(e){if(R(e))return this._hintsAddedCallback=e,this;throw new Error("Provided callback for onhintsadded was not a function.")}},{key:"onhintclick",value:function(e){if(R(e))return this._hintClickCallback=e,this;throw new Error("Provided callback for onhintclick was not a function.")}},{key:"onhintclose",value:function(e){if(R(e))return this._hintCloseCallback=e,this;throw new Error("Provided callback for onhintclose was not a function.")}},{key:"onstart",value:function(e){if(R(e))return this._introStartCallback=e,this;throw new Error("Provided callback for onstart was not a function.")}},{key:"onexit",value:function(e){if(R(e))return this._introExitCallback=e,this;throw new Error("Provided callback for onexit was not a function.")}},{key:"onskip",value:function(e){if(R(e))return this._introSkipCallback=e,this;throw new Error("Provided callback for onskip was not a function.")}},{key:"onbeforeexit",value:function(e){if(R(e))return this._introBeforeExitCallback=e,this;throw new Error("Provided callback for onbeforeexit was not a function.")}},{key:"addHints",value:(De=x(_().mark(function e(){return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,me(this,this._targetElement);case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}},e,this)})),function(){return De.apply(this,arguments)})},{key:"hideHint",value:(Re=x(_().mark(function e(t){return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u(this,t);case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}},e,this)})),function(e){return Re.apply(this,arguments)})},{key:"hideHints",value:(xe=x(_().mark(function e(){return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,function(){return le.apply(this,arguments)}(this);case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}},e,this)})),function(){return xe.apply(this,arguments)})},{key:"showHint",value:function(e){return ue(e),this}},{key:"showHints",value:(_e=x(_().mark(function e(){return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,function(){return ce.apply(this,arguments)}(this);case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}},e,this)})),function(){return _e.apply(this,arguments)})},{key:"removeHints",value:function(){var e,t=this,r=v(s(".introjs-hint"));try{for(r.s();!(e=r.n()).done;){var n=e.value.getAttribute("data-step");n&&de(parseInt(n,10))}}catch(t){r.e(t)}finally{r.f()}return p.off(document,"click",f,t,!1),p.off(window,"resize",g,t,!0),t._hintsAutoRefreshFunction&&p.off(window,"scroll",t._hintsAutoRefreshFunction,t,!0),this}},{key:"removeHint",value:function(e){return de(e),this}},{key:"showHintDialog",value:(Se=x(_().mark(function e(t){return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fe(this,t);case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}},e,this)})),function(e){return Se.apply(this,arguments)})}]);var Se,_e,xe,Re,Ae,Ne,Oe,Ie,Me,ke,De,h=t;function t(e){y(this,t),a(this,"_currentStep",-1),a(this,"_currentStepNumber",void 0),a(this,"_direction",void 0),a(this,"_targetElement",void 0),a(this,"_introItems",[]),a(this,"_hintItems",[]),a(this,"_options",void 0),a(this,"_introBeforeChangeCallback",void 0),a(this,"_introChangeCallback",void 0),a(this,"_introAfterChangeCallback",void 0),a(this,"_introCompleteCallback",void 0),a(this,"_introStartCallback",void 0),a(this,"_introExitCallback",void 0),a(this,"_introSkipCallback",void 0),a(this,"_introBeforeExitCallback",void 0),a(this,"_hintsAddedCallback",void 0),a(this,"_hintClickCallback",void 0),a(this,"_hintCloseCallback",void 0),a(this,"_lastShowElementTimer",void 0),a(this,"_hintsAutoRefreshFunction",void 0),this._targetElement=e,this._options={steps:[],hints:[],isActive:!0,nextLabel:"Next",prevLabel:"Back",skipLabel:"×",doneLabel:"Done",hidePrev:!1,hideNext:!1,nextToDone:!0,tooltipPosition:"bottom",tooltipClass:"",group:"",highlightClass:"",exitOnEsc:!0,exitOnOverlayClick:!0,showStepNumbers:!1,stepNumbersOfLabel:"of",keyboardNavigation:!0,showButtons:!0,showBullets:!0,showProgress:!1,scrollToElement:!0,scrollTo:"element",scrollPadding:30,overlayOpacity:.5,autoPosition:!0,positionPrecedence:["bottom","top","right","left"],disableInteraction:!1,dontShowAgain:!1,dontShowAgainLabel:"Don't show this again",dontShowAgainCookie:"introjs-dontShowAgain",dontShowAgainCookieDays:365,helperElementPadding:10,hintPosition:"top-middle",hintButtonLabel:"Got it",hintShowButton:!0,hintAutoRefreshInterval:10,hintAnimation:!0,buttonClass:"introjs-button",progressBarAdditionalClass:!1}}return l.version="7.2.0",l.instances={},l}),!function(){var r="placeholder"in document.createElement("input");var s=Object.freeze({START:"start",STOP:"stop",NOTHING:!1}),a={letterDelay:100,sentenceDelay:1e3,loop:!1,startOnFocus:!0,shuffle:!1,showCursor:!0,cursor:"|",autoStart:!1,onFocusAction:s.START,onBlurAction:s.STOP};function n(e,t,r){var n,i;if(this.el=e,this.texts=t,this.options=function(e,t){var r,n={};for(r in e)n[r]=(void 0===t[r]?e:t)[r];return n}(a,r=r||{}),this.options.startOnFocus||(console.warn("Superplaceholder.js: `startOnFocus` option has been deprecated. Please use `onFocusAction`, `onBlurAction` and `autoStart`"),this.options.autoStart=!0,this.options.onFocusAction=s.NOTHING,this.options.onBlurAction=s.NOTHING),this.timeouts=[],this.isPlaying=!1,this.options.shuffle)for(var o=this.texts.length;o--;)i=~~(Math.random()*o),n=this.texts[i],this.texts[i]=this.texts[o],this.texts[o]=n;this.begin()}n.prototype.begin=function(){var e=this;e.originalPlaceholder=e.el.getAttribute("placeholder"),(e.options.onFocusAction||e.options.onBlurAction)&&(e.listeners={focus:e.onFocus.bind(e),blur:e.onBlur.bind(e)},e.el.addEventListener("focus",e.listeners.focus),e.el.addEventListener("blur",e.listeners.blur)),e.options.autoStart&&e.processText(0)},n.prototype.onFocus=function(){this.options.onFocusAction===s.START?this.isInProgress()||this.processText(0):this.options.onFocusAction===s.STOP&&this.cleanUp()},n.prototype.onBlur=function(){this.options.onBlurAction===s.STOP?this.cleanUp():this.options.onBlurAction!==s.START||this.isInProgress()||this.processText(0)},n.prototype.cleanUp=function(){for(var e=this.timeouts.length;e--;)clearTimeout(this.timeouts[e]);null===this.originalPlaceholder?this.el.removeAttribute("placeholder"):this.el.setAttribute("placeholder",this.originalPlaceholder),this.timeouts.length=0,this.isPlaying=!1},n.prototype.isInProgress=function(){return this.isPlaying},n.prototype.typeString=function(t,r){var e,n=this;if(!t)return!1;function i(e){n.el.setAttribute("placeholder",t.substr(0,e+1)+(e!==t.length-1&&n.options.showCursor?n.options.cursor:"")),e===t.length-1&&r()}for(var o=0;o<t.length;o++)e=setTimeout(i,o*n.options.letterDelay,o),n.timeouts.push(e)},n.prototype.processText=function(e){var t,r=this;this.isPlaying=!0,r.typeString(r.texts[e],function(){r.timeouts.length=0,r.options.loop||r.texts[e+1]||(r.isPlaying=!1),t=setTimeout(function(){r.processText(r.options.loop?(e+1)%r.texts.length:e+1)},r.options.sentenceDelay),r.timeouts.push(t)})};function e(e){var t;if(r)return t=new n(e.el,e.sentences,e.options),{start:function(){t.isInProgress()||t.processText(0)},stop:function(){t.cleanUp()},destroy:function(){for(var e in t.cleanUp(),t.listeners)t.el.removeEventListener(e,t.listeners[e])}}}e.Actions=s,"object"==typeof exports?module.exports=e:"function"==typeof define&&define.amd?define(function(){return e}):window.superplaceholder=e}(),!function(e,t){"function"==typeof define&&define.amd?define(function(){return t(e)}):"object"==typeof module&&module.exports?module.exports=t(e):(void 0===e.tail&&(e.tail={}),e.tail.select=t(e),"undefined"!=typeof jQuery&&(jQuery.fn.tailselect=function(e){var t,r=[];return this.each(function(){!1!==(t=tail.select(this,e))&&r.push(t)}),1===r.length?r[0]:0!==r.length&&r}),"undefined"!=typeof MooTools&&Element.implement({tailselect:function(e){return new tail.select(this,e)}}))}(window,function(e){"use strict";var s=e,c=e.document;function p(e,t){return!!(e&&"classList"in e)&&e.classList.contains(t)}function a(e,t){e&&"classList"in e&&e.classList.add(t)}function l(e,t){e&&"classList"in e&&e.classList.remove(t)}function i(e,t,r){var n;CustomEvent&&CustomEvent.name?n=new CustomEvent(t,r):(n=c.createEvent("CustomEvent")).initCustomEvent(t,!!r.bubbles,!!r.cancelable,r.detail),e.dispatchEvent(n)}function u(e,t){if("function"==typeof Object.assign)return Object.assign({},e,t||{});var r,n=Object.constructor();for(r in e)n[r]=(r in t?t:e)[r];return n}function f(e,t){e=c.createElement(e);return e.className=t&&t.join?t.join(" "):t||"",e}function d(e,t){if((e="string"==typeof e?c.querySelectorAll(e):e)instanceof NodeList||e instanceof HTMLCollection||e instanceof Array){for(var r=[],n=e.length,i=0;i<n;i++)r.push(new d(e[i],u(t,{})));return 1===r.length?r[0]:0!==r.length&&r}var o,s,a;return e instanceof Element&&this instanceof d?d.inst[e.getAttribute("data-tail-select")]?d.inst[e.getAttribute("data-tail-select")]:(e.getAttribute("data-select")&&(o=JSON.parse(e.getAttribute("data-select").replace(/\'/g,'"')))instanceof Object&&(t=u(t,o)),o=e.getAttribute("placeholder")||e.getAttribute("data-placeholder"),s="bindSourceSelect",a="sourceHide",(t="object"==typeof t?t:{}).multiple=("multiple"in t?t:e).multiple,t.disabled=("disabled"in t?t:e).disabled,t.placeholder=o||t.placeholder||null,t.width="auto"===t.width?e.offsetWidth+50:t.width,t.sourceBind=s in t?t[s]:t.sourceBind||!1,t.sourceHide=a in t?t[a]:t.sourceHide||!0,t.multiLimit=0<=t.multiLimit?t.multiLimit:1/0,this.e=e,this.id=++d.count,this.con=u(d.defaults,t),this.events={},(d.inst["tail-"+this.id]=this).init().bind()):e instanceof Element&&new d(e,t)}var h;return d.count=0,d.inst={},d.defaults={animate:!0,classNames:null,csvOutput:!1,csvSeparator:",",descriptions:!1,deselect:!1,disabled:!1,height:350,hideDisabled:!1,hideSelected:!1,items:{},locale:"en",linguisticRules:{"е":"ё",a:"ä",o:"ö",u:"ü",ss:"ß"},multiple:!1,multiLimit:1/0,multiPinSelected:!1,multiContainer:!1,multiShowCount:!0,multiShowLimit:!1,multiSelectAll:!1,multiSelectGroup:!0,openAbove:null,placeholder:null,search:!1,searchConfig:["text","value"],searchFocus:!0,searchMarked:!0,searchMinLength:1,searchDisabled:!0,sortItems:!1,sortGroups:!1,sourceBind:!1,sourceHide:!0,startOpen:!1,stayOpen:!1,width:null,cbComplete:void 0,cbEmpty:void 0,cbLoopItem:void 0,cbLoopGroup:void 0},d.strings={en:{all:"All",none:"None",empty:"No Options available",emptySearch:"No Options found",limit:"You can't select more Options",placeholder:"Select an Option...",placeholderMulti:"Select up to :limit Options...",search:"Type in to search...",disabled:"This Field is disabled"},modify:function(e,t,r){if(!(e in this))return!1;if(t instanceof Object)for(var n in t)this.modify(e,n,t[n]);else this[e][t]="string"==typeof r?r:this[e][t];return!0},register:function(e,t){return"string"==typeof e&&t instanceof Object&&(this[e]=t,!0)}},d.prototype={_e:function(e,t,r){if(!(e in this.__))return r||e;if("function"==typeof(e=this.__[e])&&(e=e.call(this,t)),"object"==typeof t)for(var n in t)e=e.replace(n,t[n]);return e},init:function(){var t=this,e=["tail-select"],r=this.con,n=!0===r.classNames?this.e.className:r.classNames;e.push(n&&n.push?n.join(" "):n&&n.split?n:"no-classes"),r.hideSelected&&e.push("hide-selected"),r.hideDisabled&&e.push("hide-disabled"),0==r.multiLimit&&e.push("disabled"),r.multiple&&e.push("multiple"),r.deselect&&e.push("deselect"),r.disabled&&e.push("disabled"),this.__=u(d.strings.en,d.strings[r.locale]||{}),this._init=!0,this._query=!1,this.select=f("DIV",e),this.label=f("DIV","select-label"),this.dropdown=f("DIV","select-dropdown"),this.search=f("DIV","dropdown-search"),this.csvInput=f("INPUT","select-search"),null!==this.e.getAttribute("tabindex")?this.select.setAttribute("tabindex",this.e.getAttribute("tabindex")):this.select.setAttribute("tabindex",0),r.width&&/^[0-9.]+(?:cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|\%)$/i.test(r.width)?this.select.style.width=r.width:r.width&&!isNaN(parseFloat(r.width,10))&&(this.select.style.width=r.width+"px"),this.label.addEventListener("click",function(e){t.toggle.call(t,t.con.animate)}),this.select.appendChild(this.label),isNaN(parseInt(r.height,10))||(this.dropdown.style.maxHeight=parseInt(r.height,10)+"px"),r.search&&(this.search.innerHTML='<input type="text" class="search-input" />',this.search.children[0].placeholder=this._e("search"),this.search.children[0].addEventListener("input",function(e){t.query.call(t,this.value.length>r.searchMinLength?this.value:void 0)}),this.dropdown.appendChild(this.search)),this.select.appendChild(this.dropdown),this.csvInput.type="hidden",r.csvOutput&&(this.csvInput.name=this.e.name,this.e.removeAttribute("name"),this.select.appendChild(this.csvInput)),r.multiple&&r.multiContainer&&(c.querySelector(r.multiContainer)?(this.container=c.querySelector(r.multiContainer),this.container.className+=" tail-select-container"):!0===r.multiContainer&&(this.container=this.label,this.container.className+=" tail-select-container")),this.options=new h(this.e,this);for(var i,o=this.e.options.length,s=0;s<o;s++)this.options.set(this.e.options[s],!1);for(i in r.items)"string"==typeof r.items[i]&&(r.items[i]={value:r.items[i]}),this.options.add(r.items[i].key||i,r.items[i].value,r.items[i].group,r.items[i].selected,r.items[i].disabled,r.items[i].description);return this.query(),this.e.nextElementSibling?this.e.parentElement.insertBefore(this.select,this.e.nextElementSibling):this.e.parentElement.appendChild(this.select),r.sourceHide&&("none"==this.e.style.display?(this.select.style.display="none",this.e.setAttribute("data-select-hidden","display")):"hidden"==this.e.style.visibility?(this.select.style.visibiltiy="hidden",this.e.setAttribute("data-select-hidden","visibility")):(this.e.style.display="none",this.e.setAttribute("data-select-hidden","0"))),this.e.setAttribute("data-tail-select","tail-"+this.id),t.con.startOpen&&this.open(r.animate),(r.cbComplete||function(){}).call(this,this.select),this._init=!1,this},bind:function(){var s=this;if(void 0===this.options_initial){for(var e=[],t=0;t<this.options.selected.length;++t)e.push(this.options.selected[t]);this.options_initial={selected:e}}return c.addEventListener("keydown",function(e){var t,r,n,i,o=e.keyCode||e.which;if(!(32==o&&s.select===document.activeElement)&&(!p(s.select,"active")||[13,27,38,40].indexOf(o)<0))return!1;if(e.preventDefault(),e.stopPropagation(),32===o)return s.open(s.con.animate);if(13==o&&(t=s.dropdown.querySelector(".dropdown-option.hover:not(.disabled)"))&&(t.classList.contains("selected")?s.options.unselect:s.options.select).call(s.options,t),27==o||13==o)return s.close(s.con.animate);if(t=s.dropdown.querySelector(".dropdown-option.hover:not(.disabled)"))for(l(t,"hover"),n=[(40==o?"next":"previous")+"ElementSibling"];(t=null!==(i=t[n])&&"LI"==t.tagName?i:null!==(i=t.parentElement[n])&&0<i.children.length&&"UL"==i.tagName&&i.children[40==o?0:i.children.length-1])&&(!p(t,"dropdown-option")||p(t,"disabled")););return t||40!=o?t||38!=o||(t=(e=s.dropdown.querySelectorAll(".dropdown-option:not(.disabled)"))[e.length-1]):t=s.dropdown.querySelector(".dropdown-option:not(.disabled)"),t&&(r=s.dropdown.querySelector(".dropdown-inner"))&&(e=function(e){for(var t={top:e.offsetTop,height:e.offsetHeight};(e=e.parentElement)!=r;)t.top+=e.offsetTop;return t}(t),a(t,"hover"),r.scrollTop=Math.max(0,e.top-2*e.height)),!0}),c.addEventListener("click",function(e){if(!p(s.select,"active")||p(s.select,"idle"))return!1;if(!0===s.con.stayOpen)return!1;for(var t=[s.e,s.select,s.container],r=t.length,n=0;n<r;n++){if(t[n]&&(t[n].contains(e.target)||t[n]==e.target))return!1;if(!e.target.parentElement)return!1}return s.close.call(s,s.con.animate)}),this.con.sourceBind&&this.e.addEventListener("change",function(e){if(null!=e.detail)return!1;var t;e.preventDefault(),e.stopPropagation(),!this.multiple&&this.selectedIndex?s.options.select.call(s.options,this.options[this.selectedIndex]):(t=[].concat(s.options.selected),e=[].filter.call(this.querySelectorAll("option:checked"),function(e){return!(0<=t.indexOf(e)&&(t.splice(t.indexOf(e),1),1))}),s.options.walk.call(s.options,"unselect",t),s.options.walk.call(s.options,"select",e))}),!0},callback:function(e,t,r){var n="[data-key='"+e.key.replace(/('|\\)/g,"\\$1")+"'][data-group='"+e.group.replace(/('|\\)/g,"\\$1")+"']";return"rebuild"==t?this.query():((n=this.dropdown.querySelector(n))&&0<=["select","disable"].indexOf(t)?a(n,"select"==t?"selected":"disabled"):n&&0<=["unselect","enable"].indexOf(t)&&l(n,"unselect"==t?"selected":"disabled"),this.update(e),!0===r||this.trigger("change",e,t))},trigger:function(e){var t,r,n;return!this._init&&(t={bubbles:!1,cancelable:!0,detail:{args:arguments,self:this}},"change"==e&&arguments[2]&&0<=arguments[2].indexOf("select")&&(i(this.e,"input",t),i(this.e,"change",t)),i(this.select,"tail::"+e,t),r=[],Array.prototype.map.call(arguments,function(e,t){0<t&&r.push(e)}),(this.events[e]||[]).forEach(function(e){(n=[].concat(r)).push(e.args||null),(e.cb||function(){}).apply(t.detail.self,n)}),!0)},calc:function(){var e=this.dropdown.cloneNode(!0),t=this.con.height,r=0,n=this.dropdown.querySelector(".dropdown-inner"),e=((e=this.dropdown.cloneNode(!0)).style.cssText="height:auto;min-height:auto;max-height:none;opacity:0;display:block;visibility:hidden;",e.style.maxHeight=this.con.height+"px",e.className+=" cloned",this.dropdown.parentElement.appendChild(e),t=t>e.clientHeight?e.clientHeight:t,this.con.search&&(r=e.querySelector(".dropdown-search").clientHeight),this.dropdown.parentElement.removeChild(e),this.select.getBoundingClientRect()),i=s.innerHeight-(e.top+e.height),o=i<t+r&&e.top>i;return(!0===this.con.openAbove||!1!==this.con.openAbove&&o?(o=!0,t=Math.min(t,e.top-10),a):(o=!1,t=Math.min(t,i-10),l))(this.select,"open-top"),n&&(this.dropdown.style.maxHeight=t+"px",n.style.maxHeight=t-r+"px"),this},query:function(e,t){var r,n,i,o,s,a=this,l=this.con,c="getAttribute",u=f("DIV","dropdown-inner"),d=e?"finder":"walker",h=e?[e,t]:[l.sortItems,l.sortGroups];for(this._query="string"==typeof e&&e;r=this.options[d].apply(this.options,h);){if(!i||i[c]("data-group")!==r.group){if(!((n=(l.cbLoopGroup||this.cbGroup).call(this,r.group,e,u))instanceof Element))break;(i=n).setAttribute("data-group",r.group),u.appendChild(i)}if(null!==(o=(l.cbLoopItem||this.cbItem).call(this,r,i,e,u))){if(!1===o)break;o.setAttribute("data-key",r.key),o.setAttribute("data-group",r.group),o.addEventListener("click",function(e){if(!this.hasAttribute("data-key"))return!1;var t=this[c]("data-key"),r=this[c]("data-group")||"#";a.options.toggle.call(a.options,t,r)&&!1===a.con.stayOpen&&!a.con.multiple&&a.close.call(a,a.con.animate)}),i.appendChild(o)}}var t=u.querySelectorAll("*[data-key]").length,t=(0==t&&(this.con.cbEmpty||function(e){var t=f("SPAN","dropdown-empty");t.innerText=this._e("empty"),e.appendChild(t)}).call(this,u,e),0<t&&l.multiple&&l.multiLimit==1/0&&l.multiSelectAll&&(t=f("BUTTON","tail-all"),s=f("BUTTON","tail-none"),t.innerText=this._e("all"),t.addEventListener("click",function(e){e.preventDefault();e=a.dropdown.querySelectorAll(".dropdown-inner .dropdown-option");a.options.walk.call(a.options,"select",e)}),s.innerText=this._e("none"),s.addEventListener("click",function(e){e.preventDefault();e=a.dropdown.querySelectorAll(".dropdown-inner .dropdown-option");a.options.walk.call(a.options,"unselect",e)}),(o=f("SPAN","dropdown-action")).appendChild(t),o.appendChild(s),u.insertBefore(o,u.children[0])),this.dropdown.querySelector(".dropdown-inner"));return this.dropdown[(t?"replace":"append")+"Child"](u,t),p(this.select,"active")&&this.calc(),this.updateCSV().updateLabel()},cbGroup:function(e,t){var r,n=f("UL","dropdown-optgroup"),i=this;return"#"!=e&&(n.innerHTML='<li class="optgroup-title"><b>'+e+"</b></li>",this.con.multiple&&this.con.multiLimit==1/0&&this.con.multiSelectAll)&&(e=f("BUTTON","tail-none"),r=f("BUTTON","tail-all"),e.innerText=this._e("none"),e.addEventListener("click",function(e){e.preventDefault();e=this.parentElement.parentElement.getAttribute("data-group");i.options.all.call(i.options,"unselect",e)}),r.innerText=this._e("all"),r.addEventListener("click",function(e){e.preventDefault();e=this.parentElement.parentElement.getAttribute("data-group");i.options.all.call(i.options,"select",e)}),n.children[0].appendChild(e),n.children[0].appendChild(r)),n},cbItem:function(e,t,r){var n=f("LI","dropdown-option"+(e.selected?" selected":"")+(e.disabled?" disabled":""));return n.title=e.option.title,r&&0<r.length&&this.con.searchMarked?(r=this.options.applyLinguisticRules(r),n.innerHTML=e.value.replace(new RegExp("("+r+")","i"),"<mark>$1</mark>")):n.innerText=e.value,this.con.descriptions&&e.description&&(n.innerHTML+='<span class="option-description">'+e.description+"</span>"),n},update:function(e){return this.updateLabel().updateContainer(e).updatePin(e).updateCSV(e)},updateLabel:function(e){var t,r,n;return this.container==this.label&&0<this.options.selected.length?(this.label.querySelector(".label-inner")&&this.label.removeChild(this.label.querySelector(".label-inner")),this.label.querySelector(".label-count")&&this.label.removeChild(this.label.querySelector(".label-count"))):(t=this.con,r=this.options.selected.length,"string"!=typeof e&&(e=t.disabled?"disabled":0==this.dropdown.querySelectorAll("*[data-key]").length?"empty"+(p(this.select,"in-search")?"Search":""):t.multiLimit<=r?"limit":!t.multiple&&0<this.options.selected.length?this.options.selected[0].innerText:"string"==typeof t.placeholder?t.placeholder:"placeholder"+(t.multiple&&t.multiLimit<1/0?"Multi":"")),e='<span class="label-inner">'+(e=this._e(e,{":limit":t.multiLimit},e))+"</span>",n=t.multiShowLimit&&t.multiLimit<1/0,t.multiple&&t.multiShowCount&&(e=(e='<span class="label-count '+(r?"label-count--selected":"")+'">:c</span>'+e).replace(":c",r+(n?" / "+t.multiLimit:""))),this.label.innerHTML=e),this},updateContainer:function(e){var r,t;return this.container&&this.con.multiContainer&&(t="[data-group='"+e.group+"'][data-key='"+e.key+"']",this.container.querySelector(t)?e.selected||this.container.removeChild(this.container.querySelector(t)):e.selected&&(r=this,(t=f("DIV","select-handle")).innerText=e.value,t.setAttribute("data-key",e.key),t.setAttribute("data-group",e.group),t.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation();var e=this.getAttribute("data-key"),t=this.getAttribute("data-group");r.options.unselect.call(r.options,e,t)}),this.container.appendChild(t))),this},updatePin:function(e){var t=this.dropdown.querySelector(".dropdown-inner ul"),r="li[data-key='"+e.key+"'][data-group='"+e.group+"']";if(this.con.multiPinSelected&&t&&!1===this._query)if(r=this.dropdown.querySelector(r),e.selected)t.insertBefore(r,t.children[0]);else{for(var n=this.dropdown.querySelector("ul[data-group='"+e.group+"']"),i=this.options[e.index-1],o=!1;i&&i.group==e.group&&!(o=n.querySelector("li[data-key='"+i.key+"']"));)i=this.options[i.index-1];o&&o.nextElementSibling?n.insertBefore(r,o.nextElementSibling):n.appendChild(r)}return this},updateCSV:function(e){if(this.csvInput&&this.con.csvOutput){for(var t=[],r=this.options.selected.length,n=0;n<r;n++)t.push(this.options.selected[n].value);this.csvInput.value=t.join(this.con.csvSeparator||",")}return this},open:function(e){if(p(this.select,"active")||p(this.select,"idle")||this.con.disabled)return!1;this.calc();function n(){a(i.select,"active"),l(i.select,"idle"),this.dropdown.style.height="auto",this.dropdown.style.overflow="visible",this.label.removeAttribute("style"),this.con.search&&this.con.searchFocus&&this.dropdown.querySelector("input").focus(),this.trigger.call(this,"open")}var i=this,o=this.dropdown.style;return!1!==e?(this.label.style.zIndex=25,this.dropdown.style.cssText+="height:0;display:block;overflow:hidden;",a(i.select,"idle"),function e(){var t=parseInt(o.height,10),r=parseInt(o.maxHeight,10);return r<=t?n.call(i):(o.height=(r<t+50?r:t+50)+"px",void setTimeout(e,20))}()):(o.cssText="height:"+o.maxHeight+";display:block;overflow:hidden;",n.call(this)),this},close:function(e){var t,r,n;return!(!p(this.select,"active")||p(this.select,"idle"))&&(n=(r=this).dropdown,!(t=function(){l(this.select,"active"),l(this.select,"idle"),this.dropdown.removeAttribute("style"),this.dropdown.querySelector(".dropdown-inner").removeAttribute("style"),this.trigger.call(this,"close")})!==e?(a(this.select,"idle"),this.dropdown.style.overflow="hidden",function e(){return parseInt(n.offsetHeight,10)-50<=0?t.call(r):(n.style.height=parseInt(n.offsetHeight,10)-50+"px",void setTimeout(e,20))}()):t.call(this),this)},toggle:function(e){return p(this.select,"active")?this.close(e):p(this.select,"idle")?this:this.open(e)},remove:function(){if(this.e.removeAttribute("data-tail-select"),this.e.hasAttribute("data-select-hidden")&&("0"==this.e.getAttribute("data-select-hidden")&&this.e.style.removeProperty("display"),this.e.removeAttribute("data-select-hidden")),Array.prototype.map.call(this.e.querySelectorAll("[data-select-option='add']"),function(e){e.parentElement.removeChild(e)}),Array.prototype.map.call(this.e.querySelectorAll("[data-select-optgroup='add']"),function(e){e.parentElement.removeChild(e)}),this.e.name=(this.csvInput.hasAttribute("name")?this.csvInput:this.e).name,this.select.parentElement&&this.select.parentElement.removeChild(this.select),this.container)for(var e=this.container.querySelectorAll(".select-handle"),t=e.length,r=0;r<t;r++)this.container.removeChild(e[r]);return this},reload:function(){return this.remove().init()},reset:function(){for(var e=0;e<this.options.element.length;++e)this.options.element[e].selected=!1,this.options.unselect(this.options.element[e].value,"#",!0);for(e=0;e<this.options_initial.selected.length;++e)this.options_initial.selected[e].selected=!0,this.options.select(this.options_initial.selected[e].value,"#",!0);this.dropdown.querySelector("input").value="",this.query.call(this,"")},config:function(e,t,r){if(e instanceof Object){for(var n in e)this.config(n,e[n],!1);return this.reload(),this.con}return void 0===e?this.con:e in this.con&&(void 0===t?this.con[e]:(this.con[e]=t,!1!==r&&this.reload(),this))},enable:function(e){return l(this.select,"disabled"),this.e.disabled=!1,(this.con.disabled=!1)===e?this:this.reload()},disable:function(e){return a(this.select,"disabled"),this.e.disabled=!0,!(this.con.disabled=!0)===e?this:this.reload()},on:function(e,t,r){return!(["open","close","change"].indexOf(e)<0||"function"!=typeof t)&&(e in this.events||(this.events[e]=[]),this.events[e].push({cb:t,args:r instanceof Array?r:[]}),this)},value:function(){return 0==this.options.selected.length?null:this.con.multiple?this.options.selected.map(function(e){return e.value}):this.options.selected[0].value}},(h=d.options=function(e,t){return this instanceof h?(this.self=t,this.element=e,this.length=0,this.selected=[],this.disabled=[],this.items={"#":{}},this.groups={},this):new h(e,t)}).prototype={_r:function(e){return e.replace("disabled","disable").replace("enabled","enable").replace("selected","select").replace("unselected","unselect")},get:function(e,t){var r="getAttribute";if("object"==typeof e&&e.key&&e.group)t=e.group||t,e=e.key;else if(e instanceof Element)"OPTION"==e.tagName?(t=e.parentElement.label||"#",e=e.value||e.innerText):e.hasAttribute("data-key")&&(t=e[r]("data-group")||e.parentElement[r]("data-group")||"#",e=e[r]("data-key"));else if("string"!=typeof e)return!1;return e=/^[0-9]+$/.test(e)?"_"+e:e,t in this.items&&this.items[t][e]},set:function(e,t){var r,n,i=e.value||e.innerText,o=e.parentElement.label||"#";return o in this.items||(this.items[o]={},this.groups[o]=e.parentElement),!(i in this.items[o])&&(r=/^[0-9]+$/.test(i)?"_"+i:i,(n=this.self.con).multiple&&this.selected.length>=n.multiLimit&&(e.selected=!1),!e.selected||!n.deselect||e.hasAttribute("selected")&&0!=n.multiLimit||(e.selected=!1,e.parentElement.selectedIndex=-1),e.hasAttribute("data-description")&&((n=f("SPAN")).innerHTML=e.getAttribute("data-description"),e.setAttribute("data-description",n.innerHTML)),this.items[o][r]={key:i,value:e.text,description:e.getAttribute("data-description")||null,group:o,option:e,optgroup:"#"!=o?this.groups[o]:void 0,selected:e.selected,disabled:e.disabled,hidden:e.hidden||!1},this.length++,e.selected&&this.select(this.items[o][r]),e.disabled&&this.disable(this.items[o][r]),!t||this.self.callback(this.items[o][i],"rebuild"))},add:function(e,t,r,n,i,o,s){if(e instanceof Object){for(var a in e)this.add(e[a].key||a,e[a].value,e[a].group,e[a].selected,e[a].disabled,e[a].description,!1);return this.self.query()}var l;return!this.get(e,r)&&("#"===(r="string"==typeof r?r:"#")||r in this.groups||((l=f("OPTGROUP")).label=r,l.setAttribute("data-select-optgroup","add"),this.element.appendChild(l),this.items[r]={},this.groups[r]=l),this.self.con.multiple&&this.selected.length>=this.self.con.multiLimit&&(n=!1),i=!!i,(l=c.createElement("OPTION")).value=e,l.selected=n,l.disabled=i,l.innerText=t,l.setAttribute("data-select-option","add"),o&&0<o.length&&l.setAttribute("data-description",o),("#"==r?this.element:this.groups[r]).appendChild(l),this.set(l,s))},move:function(e,t,r,n){return!!(e=this.get(e,t))&&("#"===r||r in this.groups||((t=f("OPTGROUP")).label=r,this.element.appendChild(t),this.items[r]={},this.groups[r]=t,this.groups[r].appendChild(e.option)),delete this.items[e.group][e.key],e.group=r,e.optgroup=this.groups[r]||void 0,this.items[r][e.key]=e,!n||this.self.query())},remove:function(e,t,r){if(!(e=this.get(e,t)))return!1;e.selected&&this.unselect(e),e.disabled&&this.enable(e),e.option.parentElement.removeChild(e.option);t=/^[0-9]+$/.test(e.key)?"_"+e.key:e.key;return delete this.items[e.group][t],this.length--,0===Object.keys(this.items[e.group]).length&&(delete this.items[e.group],delete this.groups[e.group]),!r||this.self.query()},is:function(e,t,r){e=this._r(e),t=this.get(t,r);return!t||["select","unselect","disable","enable"].indexOf(e)<0?null:"disable"==e||"enable"==e?"disable"==e?t.disabled:!t.disabled:("select"==e||"unselect"==e)&&("select"==e?t.selected:!t.selected)},handle:function(e,t,r,n){t=this.get(t,r),e=this._r(e);if(!t||["select","unselect","disable","enable"].indexOf(e)<0)return null;if("disable"==e||"enable"==e)return t.option in this.disabled||"disable"!=e?t.option in this.disabled&&"enable"==e&&this.disabled.splice(this.disabled.indexOf(t.option),1):this.disabled.push(t.option),t.disabled="disable"==e,t.option.disabled="disable"==e,this.self.callback.call(this.self,t,e);var r=p(this.self.select,"disabled")||t.disabled||t.option.disabled,i=this.self.con.multiple&&this.self.con.multiLimit<=this.selected.length,o=!this.self.con.multiple&&0<this.selected.indexOf(t.option),s=0==this.self.con.multiLimit&&1==this.self.con.deselect,a=!this.self.con.multiple&&!this.self.con.deselect&&!0!==n;if("select"==e){if(r||i||s||o)return!1;if(!this.self.con.multiple)for(var l in this.selected)this.unselect(this.selected[l],void 0,!0);this.selected.indexOf(t.option)<0&&this.selected.push(t.option)}else if("unselect"==e){if(r||a)return!1;this.selected.splice(this.selected.indexOf(t.option),1)}return t.selected="select"==e,t.option.selected="select"==e,t.option[(6<e.length?"remove":"set")+"Attribute"]("selected","selected"),this.self.callback.call(this.self,t,e,n)},enable:function(e,t){return this.handle("enable",e,t,!1)},disable:function(e,t){return this.handle("disable",e,t,!1)},select:function(e,t){return this.handle("select",e,t,!1)},unselect:function(e,t,r){return this.handle("unselect",e,t,r)},toggle:function(e,t){return!!(e=this.get(e,t))&&this.handle(e.selected?"unselect":"select",e,t,!1)},invert:function(t){t=this._r(t),0<=["enable","disable"].indexOf(t)?(r=this.disabled,n="enable"==t?"disable":"enable"):0<=["select","unselect"].indexOf(t)&&(r=this.selected,n="select"==t?"unselect":"select");var r,n,e=Array.prototype.filter.call(this,function(e){return!(e in r)}),i=this;return[].concat(r).forEach(function(e){i.handle.call(i,n,e)}),[].concat(e).forEach(function(e){i.handle.call(i,t,e)}),!0},all:function(t,r){var n=this,e=this;return r in this.items?e=Object.keys(this.items[r]):0<=["unselect","enable"].indexOf(t)&&(e=[].concat("unselect"==t?this.selected:this.disabled)),Array.prototype.forEach.call(e,function(e){n.handle.call(n,t,e,r,!1)}),!0},walk:function(t,e,r){if(e instanceof Array||e.length)for(var n=e.length,i=0;i<n;i++)this.handle.apply(this,[t,e[i],null].concat(r));else if(e instanceof Object){var o=this;if(e.forEach)e.forEach(function(e){o.handle.apply(o,[t,e,null].concat(r))});else for(var s in e)("string"==typeof e[s]||"number"==typeof e[s]||e[s]instanceof Element)&&this.handle.apply(this,[t,e[s],s in this.items?s:null]).concat(r)}return this},applyLinguisticRules:function(e,t){var r=this.self.con.linguisticRules,n=[];return Object.keys(r).forEach(function(e){n.push("("+e+"|["+r[e]+"])")}),t&&(n=n.concat(n.map(function(e){return e.toUpperCase()}))),e.replace(new RegExp(n.join("|"),t?"g":"ig"),function(e){return n[[].indexOf.call(arguments,e,1)-1]})},find:function(e,t){var r,n,i,o,s=this,a={};return"function"==typeof(t=t||this.self.con.searchConfig)?o=t.bind(this,e):((t=t instanceof Array?t:[t]).forEach(function(e){"string"==typeof e&&(a[e]=!0)}),a.any=a.any||a.attributes&&a.value,a.regex&&!a.text||(e=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")),a.exactglyphes||(e=this.self.options.applyLinguisticRules(e,a.case)),a.word&&(e="\\b"+e+"\\b"),r=new RegExp(e,a.case?"m":"mi"),n=function(e){return r.test(e.text||e.value)},o=a.any?function(e){return n(e)||[].some.call(e.attributes,n)}:a.attributes?function(e){return[].some.call(e.attributes,n)}:n,this.self.con.searchDisabled||(i=o,o=function(e){return!e.disabled&&i(e)})),[].filter.call(this.self.e.options,o).map(function(e){return!e.hidden&&s.get(e)})},finder:function(e,t){return void 0===this._finderLoop&&(this._finderLoop=this.find(e,t)),void 0!==(e=this._finderLoop.shift())?e:(delete this._finderLoop,!1)},walker:function(e,t){if(void 0!==this._inLoop&&this._inLoop){if(0<this._inItems.length){do{var r=this.items[this._inGroup][this._inItems.shift()]}while(!0===r.hidden);return r}if(0<this._inGroups.length){for(;0<this._inGroups.length;){var n=this._inGroups.shift();if(!(n in this.items))return!1;var i=Object.keys(this.items[n]);if(0<i.length)break}return"ASC"==e?i.sort():"DESC"==e?i.sort().reverse():"function"==typeof e&&(i=e.call(this,i)),this._inItems=i,this._inGroup=n,this.walker(null,null)}return delete this._inLoop,delete this._inItems,delete this._inGroup,delete this._inGroups,!1}var o=Object.keys(this.groups)||[];return"ASC"==t?o.sort():"DESC"==t?o.sort().reverse():"function"==typeof t&&(o=t.call(this,o)),o.unshift("#"),this._inLoop=!0,this._inItems=[],this._inGroups=o,this.walker(e,null)}},d}),!function(e,t){"function"==typeof define&&define.amd?define(t):"object"==typeof exports?module.exports=t():e.VMasker=t()}(this,function(){function u(e){return(e={delimiter:(e=e||{}).delimiter||".",lastOutput:e.lastOutput,precision:e.hasOwnProperty("precision")?e.precision:2,separator:e.separator||",",showSignal:e.showSignal,suffixUnit:e.suffixUnit&&" "+e.suffixUnit.replace(/[\s]/g,"")||"",unit:e.unit&&e.unit.replace(/[\s]/g,"")+" "||"",zeroCents:e.zeroCents}).moneyPrecision=e.zeroCents?0:e.precision,e}function d(e,t,r){for(;t<e.length;t++)"9"!==e[t]&&"A"!==e[t]&&"S"!==e[t]||(e[t]=r);return e}function t(e){this.elements=e}var o=[9,16,17,18,36,37,38,39,40,91,92,93],s=(t.prototype.unbindElementToMask=function(){for(var e=0,t=this.elements.length;e<t;e++)this.elements[e].lastOutput="",this.elements[e].onkeyup=!1,this.elements[e].onkeydown=!1,this.elements[e].value.length&&(this.elements[e].value=this.elements[e].value.replace(/\D/g,""))},t.prototype.bindElementToMask=function(r){function e(e){var t=(e=e||window.event).target||e.srcElement;!function(e){for(var t=0,r=o.length;t<r;t++)if(e==o[t])return!1;return!0}(e.keyCode)||setTimeout(function(){n.opts.lastOutput=t.lastOutput,t.value=s[r](t.value,n.opts),t.lastOutput=t.value,t.setSelectionRange&&n.opts.suffixUnit&&t.setSelectionRange(t.value.length,t.value.length-n.opts.suffixUnit.length)},0)}for(var n=this,t=0,i=this.elements.length;t<i;t++)this.elements[t].lastOutput="",this.elements[t].onkeyup=e,this.elements[t].value.length&&(this.elements[t].value=s[r](this.elements[t].value,this.opts))},t.prototype.maskMoney=function(e){this.opts=u(e),this.bindElementToMask("toMoney")},t.prototype.maskNumber=function(){this.opts={},this.bindElementToMask("toNumber")},t.prototype.maskAlphaNum=function(){this.opts={},this.bindElementToMask("toAlphaNumeric")},t.prototype.maskPattern=function(e){this.opts={pattern:e},this.bindElementToMask("toPattern")},t.prototype.unMask=function(){this.unbindElementToMask()},function(e){if(e)return e="length"in e?e.length?e:[]:[e],new t(e);throw new Error("VanillaMasker: There is no element to bind.")});return s.toMoney=function(e,t){for(var r=(e=(t=u(t)).zeroCents&&(t.lastOutput=t.lastOutput||"",r="("+t.separator+"[0]{0,"+t.precision+"})",r=new RegExp(r,"g"),n=e.toString().replace(/[\D]/g,"").length||0,i=t.lastOutput.toString().replace(/[\D]/g,"").length||0,e=e.toString().replace(r,""),n<i)?e.slice(0,e.length-1):e).toString().replace(/[\D]/g,""),n=new RegExp("^(0|\\"+t.delimiter+")"),i=new RegExp("(\\"+t.separator+")$"),o=r.substr(0,r.length-t.moneyPrecision),s=o.substr(0,o.length%3),a=new Array(t.precision+1).join("0"),l=0,c=(o=o.substr(o.length%3,o.length)).length;l<c;l++)l%3==0&&(s+=t.delimiter),s+=o[l];s=(s=s.replace(n,"")).length?s:"0",n="";return!0===t.showSignal&&(n=e<0||e.startsWith&&e.startsWith("-")?"-":""),t.zeroCents||(e=r.length-t.precision,e=(r=r.substr(e,t.precision)).length,a=(a+r).slice(-(t.precision>e?t.precision:e))),(t.unit+n+s+t.separator+a).replace(i,"")+t.suffixUnit},s.toPattern=function(e,t){for(var r="object"==typeof t?t.pattern:t,n=r.replace(/\W/g,""),i=r.split(""),o=e.toString().replace(/\W/g,""),s=o.replace(/\W/g,""),a=0,l=i.length,c="object"==typeof t?t.placeholder:void 0,u=0;u<l;u++){if(a>=o.length){if(n.length==s.length)return i.join("");if(void 0!==c&&n.length>s.length)return d(i,u,c).join("");break}if("9"===i[u]&&o[a].match(/[0-9]/)||"A"===i[u]&&o[a].match(/[a-zA-Z]/)||"S"===i[u]&&o[a].match(/[0-9a-zA-Z]/))i[u]=o[a++];else if("9"===i[u]||"A"===i[u]||"S"===i[u])return(void 0!==c?d(i,u,c):i.slice(0,u)).join("")}return i.join("").substr(0,u)},s.toNumber=function(e){return e.toString().replace(/(?!^-)[^0-9]/g,"")},s.toAlphaNumeric=function(e){return e.toString().replace(/[^a-z0-9 ]+/i,"")},s}),!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).CodeMirror=t()}(this,function(){"use strict";var e=navigator.userAgent,a=navigator.platform,m=/gecko\/\d/i.test(e),t=/MSIE \d/.test(e),l=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(e),c=/Edge\/(\d+)/.exec(e),w=t||l||c,y=w&&(t?document.documentMode||6:+(c||l)[1]),C=!c&&/WebKit\//.test(e),t=C&&/Qt\/\d+\.\d+/.test(e),$=!c&&/Chrome\/(\d+)/.exec(e),B=$&&+$[1],j=/Opera\//.test(e),z=/Apple Computer/.test(navigator.vendor),u=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(e),Y=/PhantomJS/.test(e),h=z&&(/Mobile\/\w+/.test(e)||2<navigator.maxTouchPoints),G=/Android/.test(e),q=h||G||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(e),E=h||/Mac/.test(a),K=/\bCrOS\b/.test(e),l=/win/i.test(a),c=j&&e.match(/Version\/(\d*\.\d*)/),X=((c=c&&Number(c[1]))&&15<=c&&(C=!(j=!1)),E&&(t||j&&(null==c||c<12.11))),J=m||w&&9<=y;function Z(e){return new RegExp("(^|\\s)"+e+"(?:$|\\s)\\s*")}var Q=function(e,t){var r,n=e.className,t=Z(t).exec(n);t&&(r=n.slice(t.index+t[0].length),e.className=n.slice(0,t.index)+(r?t[1]+r:""))};function ee(e){for(var t=e.childNodes.length;0<t;--t)e.removeChild(e.firstChild);return e}function v(e,t){return ee(e).appendChild(t)}function R(e,t,r,n){var i=document.createElement(e);if(r&&(i.className=r),n&&(i.style.cssText=n),"string"==typeof t)i.appendChild(document.createTextNode(t));else if(t)for(var o=0;o<t.length;++o)i.appendChild(t[o]);return i}function te(e,t,r,n){e=R(e,t,r,n);return e.setAttribute("role","presentation"),e}function re(e,t){if(3==t.nodeType&&(t=t.parentNode),e.contains)return e.contains(t);do{if((t=11==t.nodeType?t.host:t)==e)return!0}while(t=t.parentNode)}function A(t){var r;try{r=t.activeElement}catch(e){r=t.body||null}for(;r&&r.shadowRoot&&r.shadowRoot.activeElement;)r=r.shadowRoot.activeElement;return r}function ne(e,t){var r=e.className;Z(t).test(r)||(e.className+=(r?" ":"")+t)}function ie(e,t){for(var r=e.split(" "),n=0;n<r.length;n++)r[n]&&!Z(r[n]).test(t)&&(t+=" "+r[n]);return t}var oe=document.createRange?function(e,t,r,n){var i=document.createRange();return i.setEnd(n||e,r),i.setStart(e,t),i}:function(e,t,r){var n=document.body.createTextRange();try{n.moveToElementText(e.parentNode)}catch(e){return n}return n.collapse(!0),n.moveEnd("character",r),n.moveStart("character",t),n},se=function(e){e.select()};function ae(e){return e.display.wrapper.ownerDocument}function le(e){return ae(e).defaultView}function ce(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t)}}function ue(e,t,r){for(var n in t=t||{},e)!e.hasOwnProperty(n)||!1===r&&t.hasOwnProperty(n)||(t[n]=e[n]);return t}function de(e,t,r,n,i){null==t&&-1==(t=e.search(/[^\s\u00a0]/))&&(t=e.length);for(var o=n||0,s=i||0;;){var a=e.indexOf("\t",o);if(a<0||t<=a)return s+(t-o);s=(s+=a-o)+(r-s%r),o=a+1}}h?se=function(e){e.selectionStart=0,e.selectionEnd=e.value.length}:w&&(se=function(e){try{e.select()}catch(e){}});function he(){this.id=null,this.f=null,this.time=0,this.handler=ce(this.onTimeout,this)}function T(e,t){for(var r=0;r<e.length;++r)if(e[r]==t)return r;return-1}he.prototype.onTimeout=function(e){e.id=0,e.time<=+new Date?e.f():setTimeout(e.handler,e.time-+new Date)};var pe=50,fe={toString:function(){return"CodeMirror.Pass"}},ge={scroll:!(he.prototype.set=function(e,t){this.f=t;t=+new Date+e;(!this.id||t<this.time)&&(clearTimeout(this.id),this.id=setTimeout(this.handler,e),this.time=t)})},me={origin:"*mouse"},ye={origin:"+move"};function ve(e,t,r){for(var n=0,i=0;;){var o=e.indexOf("\t",n),s=(o=-1==o?e.length:o)-n;if(o==e.length||t<=i+s)return n+Math.min(s,t-i);if(i+=o-n,n=o+1,t<=(i+=r-i%r))return n}}var be=[""];function we(e){for(;be.length<=e;)be.push(H(be)+" ");return be[e]}function H(e){return e[e.length-1]}function Ce(e,t){for(var r=[],n=0;n<e.length;n++)r[n]=t(e[n],n);return r}function Ee(){}function Te(e,t){e=Object.create?Object.create(e):(Ee.prototype=e,new Ee);return t&&ue(t,e),e}var Se=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;function _e(e){return/\w/.test(e)||""<e&&(e.toUpperCase()!=e.toLowerCase()||Se.test(e))}function xe(e,t){return t?!!(-1<t.source.indexOf("\\w")&&_e(e))||t.test(e):_e(e)}function Re(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return;return 1}var Ae=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function Ne(e){return 768<=e.charCodeAt(0)&&Ae.test(e)}function Oe(e,t,r){for(;(r<0?0<t:t<e.length)&&Ne(e.charAt(t));)t+=r;return t}function Ie(e,t,r){for(var n=r<t?-1:1;;){if(t==r)return t;var i=(t+r)/2,i=n<0?Math.ceil(i):Math.floor(i);if(i==t)return e(i)?t:r;e(i)?r=i:t=i+n}}var Me=null;function ke(e,t,r){var n;Me=null;for(var i=0;i<e.length;++i){var o=e[i];if(o.from<t&&o.to>t)return i;o.to==t&&(o.from!=o.to&&"before"==r?n=i:Me=i),o.from==t&&(o.from!=o.to&&"before"!=r?n=i:Me=i)}return null!=n?n:Me}De=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,Pe=/[stwN]/,Le=/[LRr]/,Fe=/[Lb1n]/,He=/[1n]/;var De,Pe,Le,Fe,He,Ue=function(e,t){var r="ltr"==t?"L":"R";if(0==e.length||"ltr"==t&&!De.test(e))return!1;for(var n,i=e.length,o=[],s=0;s<i;++s)o.push((n=e.charCodeAt(s))<=247?"bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN".charAt(n):1424<=n&&n<=1524?"R":1536<=n&&n<=1785?"nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111".charAt(n-1536):1774<=n&&n<=2220?"r":8192<=n&&n<=8203?"w":8204==n?"b":"L");for(var a=0,l=r;a<i;++a){var c=o[a];"m"==c?o[a]=l:l=c}for(var u=0,d=r;u<i;++u){var h=o[u];"1"==h&&"r"==d?o[u]="n":Le.test(h)&&"r"==(d=h)&&(o[u]="R")}for(var p=1,f=o[0];p<i-1;++p){var g=o[p];"+"==g&&"1"==f&&"1"==o[p+1]?o[p]="1":","!=g||f!=o[p+1]||"1"!=f&&"n"!=f||(o[p]=f),f=g}for(var m=0;m<i;++m){var y=o[m];if(","==y)o[m]="N";else if("%"==y){for(var v=void 0,v=m+1;v<i&&"%"==o[v];++v);for(var b=m&&"!"==o[m-1]||v<i&&"1"==o[v]?"1":"N",w=m;w<v;++w)o[w]=b;m=v-1}}for(var C=0,E=r;C<i;++C){var T=o[C];"L"==E&&"1"==T?o[C]="L":Le.test(T)&&(E=T)}for(var S=0;S<i;++S)if(Pe.test(o[S])){for(var _=void 0,_=S+1;_<i&&Pe.test(o[_]);++_);for(var x="L"==(S?o[S-1]:r),R=x==("L"==(_<i?o[_]:r))?x?"L":"R":r,A=S;A<_;++A)o[A]=R;S=_-1}for(var N,O=[],I=0;I<i;)if(Fe.test(o[I])){var L=I;for(++I;I<i&&Fe.test(o[I]);++I);O.push(new Ve(0,L,I))}else{var M=I,k=O.length,D="rtl"==t?1:0;for(++I;I<i&&"L"!=o[I];++I);for(var P=M;P<I;)if(He.test(o[P])){M<P&&(O.splice(k,0,new Ve(1,M,P)),k+=D);var F=P;for(++P;P<I&&He.test(o[P]);++P);O.splice(k,0,new Ve(2,F,P)),k+=D,M=P}else++P;M<I&&O.splice(k,0,new Ve(1,M,I))}return"ltr"==t&&(1==O[0].level&&(N=e.match(/^\s+/))&&(O[0].from=N[0].length,O.unshift(new Ve(0,0,N[0].length))),1==H(O).level)&&(N=e.match(/\s+$/))&&(H(O).to-=N[0].length,O.push(new Ve(0,i-N[0].length,i))),"rtl"==t?O.reverse():O};function Ve(e,t,r){this.level=e,this.from=t,this.to=r}function We(e,t){var r=e.order;return r=null==r?e.order=Ue(e.text,t):r}var $e=[],S=function(e,t,r){e.addEventListener?e.addEventListener(t,r,!1):e.attachEvent?e.attachEvent("on"+t,r):(e=e._handlers||(e._handlers={}))[t]=(e[t]||$e).concat(r)};function Be(e,t){return e._handlers&&e._handlers[t]||$e}function _(e,t,r){var n;e.removeEventListener?e.removeEventListener(t,r,!1):e.detachEvent?e.detachEvent("on"+t,r):(n=(e=e._handlers)&&e[t])&&-1<(r=T(n,r))&&(e[t]=n.slice(0,r).concat(n.slice(r+1)))}function N(e,t){var r=Be(e,t);if(r.length)for(var n=Array.prototype.slice.call(arguments,2),i=0;i<r.length;++i)r[i].apply(null,n)}function O(e,t,r){return"string"==typeof t&&(t={type:t,preventDefault:function(){this.defaultPrevented=!0}}),N(e,r||t.type,e,t),qe(t)||t.codemirrorIgnore}function je(e){var t=e._handlers&&e._handlers.cursorActivity;if(t)for(var r=e.curOp.cursorActivityHandlers||(e.curOp.cursorActivityHandlers=[]),n=0;n<t.length;++n)-1==T(r,t[n])&&r.push(t[n])}function ze(e,t){return 0<Be(e,t).length}function Ye(e){e.prototype.on=function(e,t){S(this,e,t)},e.prototype.off=function(e,t){_(this,e,t)}}function x(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function Ge(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function qe(e){return null!=e.defaultPrevented?e.defaultPrevented:0==e.returnValue}function Ke(e){x(e),Ge(e)}function Xe(e){return e.target||e.srcElement}function Je(e){var t=e.which;return null==t&&(1&e.button?t=1:2&e.button?t=3:4&e.button&&(t=2)),t=E&&e.ctrlKey&&1==t?3:t}var Ze,Qe,et=!(w&&y<9)&&("draggable"in(a=R("div"))||"dragDrop"in a);var tt=3!="\n\nb".split(/\n/).length?function(e){for(var t=0,r=[],n=e.length;t<=n;){var i=e.indexOf("\n",t),o=(-1==i&&(i=e.length),e.slice(t,"\r"==e.charAt(i-1)?i-1:i)),s=o.indexOf("\r");-1!=s?(r.push(o.slice(0,s)),t+=s+1):(r.push(o),t=i+1)}return r}:function(e){return e.split(/\r\n?|\n/)},rt=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch(e){return!1}}:function(e){var t;try{t=e.ownerDocument.selection.createRange()}catch(e){}return!(!t||t.parentElement()!=e)&&0!=t.compareEndPoints("StartToEnd",t)},nt="oncopy"in(e=R("div"))||(e.setAttribute("oncopy","return;"),"function"==typeof e.oncopy),it=null;var ot={},st={};function at(e){if("string"==typeof e&&st.hasOwnProperty(e))e=st[e];else if(e&&"string"==typeof e.name&&st.hasOwnProperty(e.name)){var t=st[e.name];(e=Te(t="string"==typeof t?{name:t}:t,e)).name=t.name}else{if("string"==typeof e&&/^[\w\-]+\/[\w\-]+\+xml$/.test(e))return at("application/xml");if("string"==typeof e&&/^[\w\-]+\/[\w\-]+\+json$/.test(e))return at("application/json")}return"string"==typeof e?{name:e}:e||{name:"null"}}function lt(e,t){t=at(t);var r=ot[t.name];if(!r)return lt(e,"text/plain");var n=r(e,t);if(ct.hasOwnProperty(t.name)){var i,o=ct[t.name];for(i in o)o.hasOwnProperty(i)&&(n.hasOwnProperty(i)&&(n["_"+i]=n[i]),n[i]=o[i])}if(n.name=t.name,t.helperType&&(n.helperType=t.helperType),t.modeProps)for(var s in t.modeProps)n[s]=t.modeProps[s];return n}var ct={};function ut(e,t){ue(t,ct.hasOwnProperty(e)?ct[e]:ct[e]={})}function dt(e,t){if(!0===t)return t;if(e.copyState)return e.copyState(t);var r,n={};for(r in t){var i=t[r];i instanceof Array&&(i=i.concat([])),n[r]=i}return n}function ht(e,t){for(var r;e.innerMode&&(r=e.innerMode(t))&&r.mode!=e;)t=r.state,e=r.mode;return r||{mode:e,state:t}}function pt(e,t,r){return!e.startState||e.startState(t,r)}var g=function(e,t,r){this.pos=this.start=0,this.string=e,this.tabSize=t||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0,this.lineOracle=r};function I(e,t){if((t-=e.first)<0||t>=e.size)throw new Error("There is no line "+(t+e.first)+" in the document.");for(var r=e;!r.lines;)for(var n=0;;++n){var i=r.children[n],o=i.chunkSize();if(t<o){r=i;break}t-=o}return r.lines[t]}function ft(e,t,r){var n=[],i=t.line;return e.iter(t.line,r.line+1,function(e){e=e.text;i==r.line&&(e=e.slice(0,r.ch)),i==t.line&&(e=e.slice(t.ch)),n.push(e),++i}),n}function gt(e,t,r){var n=[];return e.iter(t,r,function(e){n.push(e.text)}),n}function mt(e,t){var r=t-e.height;if(r)for(var n=e;n;n=n.parent)n.height+=r}function M(e){if(null==e.parent)return null;for(var t=e.parent,r=T(t.lines,e),n=t.parent;n;n=(t=n).parent)for(var i=0;n.children[i]!=t;++i)r+=n.children[i].chunkSize();return r+t.first}function yt(e,t){var r=e.first;e:do{for(var n=0;n<e.children.length;++n){var i=e.children[n],o=i.height;if(t<o){e=i;continue e}t-=o,r+=i.chunkSize()}return r}while(!e.lines);for(var s=0;s<e.lines.length;++s){var a=e.lines[s].height;if(t<a)break;t-=a}return r+s}function vt(e,t){return t>=e.first&&t<e.first+e.size}function bt(e,t){return String(e.lineNumberFormatter(t+e.firstLineNumber))}function k(e,t,r){if(void 0===r&&(r=null),!(this instanceof k))return new k(e,t,r);this.line=e,this.ch=t,this.sticky=r}function D(e,t){return e.line-t.line||e.ch-t.ch}function wt(e,t){return e.sticky==t.sticky&&0==D(e,t)}function Ct(e){return k(e.line,e.ch)}function Et(e,t){return D(e,t)<0?t:e}function Tt(e,t){return D(e,t)<0?e:t}function St(e,t){return Math.max(e.first,Math.min(t,e.first+e.size-1))}function P(e,t){var r;return t.line<e.first?k(e.first,0):(r=e.first+e.size-1,t.line>r?k(r,I(e,r).text.length):(e=I(e,(r=t).line).text.length,null==(t=r.ch)||e<t?k(r.line,e):t<0?k(r.line,0):r))}function _t(e,t){for(var r=[],n=0;n<t.length;n++)r[n]=P(e,t[n]);return r}g.prototype.eol=function(){return this.pos>=this.string.length},g.prototype.sol=function(){return this.pos==this.lineStart},g.prototype.peek=function(){return this.string.charAt(this.pos)||void 0},g.prototype.next=function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},g.prototype.eat=function(e){var t=this.string.charAt(this.pos),e="string"==typeof e?t==e:t&&(e.test?e.test(t):e(t));if(e)return++this.pos,t},g.prototype.eatWhile=function(e){for(var t=this.pos;this.eat(e););return this.pos>t},g.prototype.eatSpace=function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},g.prototype.skipToEnd=function(){this.pos=this.string.length},g.prototype.skipTo=function(e){e=this.string.indexOf(e,this.pos);if(-1<e)return this.pos=e,!0},g.prototype.backUp=function(e){this.pos-=e},g.prototype.column=function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=de(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?de(this.string,this.lineStart,this.tabSize):0)},g.prototype.indentation=function(){return de(this.string,null,this.tabSize)-(this.lineStart?de(this.string,this.lineStart,this.tabSize):0)},g.prototype.match=function(e,t,r){var n;return"string"!=typeof e?(n=this.string.slice(this.pos).match(e))&&0<n.index?null:(n&&!1!==t&&(this.pos+=n[0].length),n):(n=function(e){return r?e.toLowerCase():e})(this.string.substr(this.pos,e.length))==n(e)?(!1!==t&&(this.pos+=e.length),!0):void 0},g.prototype.current=function(){return this.string.slice(this.start,this.pos)},g.prototype.hideFirstChars=function(e,t){this.lineStart+=e;try{return t()}finally{this.lineStart-=e}},g.prototype.lookAhead=function(e){var t=this.lineOracle;return t&&t.lookAhead(e)},g.prototype.baseToken=function(){var e=this.lineOracle;return e&&e.baseToken(this.pos)};function xt(e,t){this.state=e,this.lookAhead=t}var Rt=function(e,t,r,n){this.state=t,this.doc=e,this.line=r,this.maxLookAhead=n||0,this.baseTokens=null,this.baseTokenPos=1};function At(t,r,n,e){for(var l=[t.state.modeGen],i={},c=(Ft(t,r.text,t.doc.mode,n,function(e,t){l.push(e,t)},i,e),n.state),o=0;o<t.state.overlays.length;++o)!function(e){n.baseTokens=l;var o=t.state.overlays[e],s=1,a=0;n.state=!0,Ft(t,r.text,o.mode,n,function(e,t){for(var r=s;a<e;){var n=l[s];e<n&&l.splice(s,1,e,l[s+1],n),s+=2,a=Math.min(e,n)}if(t)if(o.opaque)l.splice(r,s-r,e,"overlay "+t),s=r+2;else for(;r<s;r+=2){var i=l[r+1];l[r+1]=(i?i+" ":"")+"overlay "+t}},i),n.state=c,n.baseTokens=null,n.baseTokenPos=1}(o);return{styles:l,classes:i.bgClass||i.textClass?i:null}}function Nt(e,t,r){var n,i,o;return t.styles&&t.styles[0]==e.state.modeGen||(n=Ot(e,M(t)),i=t.text.length>e.options.maxHighlightLength&&dt(e.doc.mode,n.state),o=At(e,t,n),i&&(n.state=i),t.stateAfter=n.save(!i),t.styles=o.styles,o.classes?t.styleClasses=o.classes:t.styleClasses&&(t.styleClasses=null),r===e.doc.highlightFrontier&&(e.doc.modeFrontier=Math.max(e.doc.modeFrontier,++e.doc.highlightFrontier))),t.styles}function Ot(r,n,e){var t,i,o,s=r.doc,a=r.display;return s.mode.startState?(i=(t=function(e,t,r){for(var n,i,o=e.doc,s=r?-1:t-(e.doc.mode.innerMode?1e3:100),a=t;s<a;--a){if(a<=o.first)return o.first;var l=I(o,a-1),c=l.stateAfter;if(c&&(!r||a+(c instanceof xt?c.lookAhead:0)<=o.modeFrontier))return a;c=de(l.text,null,e.options.tabSize);(null==i||c<n)&&(i=a-1,n=c)}return i}(r,n,e))>s.first&&I(s,t-1).stateAfter,o=i?Rt.fromSaved(s,i,t):new Rt(s,pt(s.mode),t),s.iter(t,n,function(e){It(r,e.text,o);var t=o.line;e.stateAfter=t==n-1||t%5==0||t>=a.viewFrom&&t<a.viewTo?o.save():null,o.nextLine()}),e&&(s.modeFrontier=o.line),o):new Rt(s,!0,n)}function It(e,t,r,n){var i=e.doc.mode,o=new g(t,e.options.tabSize,r);for(o.start=o.pos=n||0,""==t&&Mt(i,r.state);!o.eol();)kt(i,o,r.state),o.start=o.pos}function Mt(e,t){return e.blankLine?e.blankLine(t):e.innerMode&&(e=ht(e,t)).mode.blankLine?e.mode.blankLine(e.state):void 0}function kt(e,t,r,n){for(var i=0;i<10;i++){n&&(n[0]=ht(e,r).mode);var o=e.token(t,r);if(t.pos>t.start)return o}throw new Error("Mode "+e.name+" failed to advance stream.")}Rt.prototype.lookAhead=function(e){var t=this.doc.getLine(this.line+e);return null!=t&&e>this.maxLookAhead&&(this.maxLookAhead=e),t},Rt.prototype.baseToken=function(e){if(!this.baseTokens)return null;for(;this.baseTokens[this.baseTokenPos]<=e;)this.baseTokenPos+=2;var t=this.baseTokens[this.baseTokenPos+1];return{type:t&&t.replace(/( |^)overlay .*/,""),size:this.baseTokens[this.baseTokenPos]-e}},Rt.prototype.nextLine=function(){this.line++,0<this.maxLookAhead&&this.maxLookAhead--},Rt.fromSaved=function(e,t,r){return t instanceof xt?new Rt(e,dt(e.mode,t.state),r,t.lookAhead):new Rt(e,dt(e.mode,t),r)},Rt.prototype.save=function(e){e=!1!==e?dt(this.doc.mode,this.state):this.state;return 0<this.maxLookAhead?new xt(e,this.maxLookAhead):e};var Dt=function(e,t,r){this.start=e.start,this.end=e.pos,this.string=e.current(),this.type=t||null,this.state=r};function Pt(e,t,r,n){var i,o,s=e.doc,a=s.mode,l=I(s,(t=P(s,t)).line),c=Ot(e,t.line,r),u=new g(l.text,e.options.tabSize,c);for(n&&(o=[]);(n||u.pos<t.ch)&&!u.eol();)u.start=u.pos,i=kt(a,u,c.state),n&&o.push(new Dt(u,i,dt(s.mode,c.state)));return n?o:new Dt(u,i,c.state)}function Lt(e,t){if(e)for(;;){var r=e.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!r)break;e=e.slice(0,r.index)+e.slice(r.index+r[0].length);var n=r[1]?"bgClass":"textClass";null==t[n]?t[n]=r[2]:new RegExp("(?:^|\\s)"+r[2]+"(?:$|\\s)").test(t[n])||(t[n]+=" "+r[2])}return e}function Ft(e,t,r,n,i,o,s){var a=r.flattenSpans,l=(null==a&&(a=e.options.flattenSpans),0),c=null,u=new g(t,e.options.tabSize,n),d=e.options.addModeClass&&[null];for(""==t&&Lt(Mt(r,n.state),o);!u.eol();){var h,p=u.pos>e.options.maxHighlightLength?(a=!1,s&&It(e,t,n,u.pos),u.pos=t.length,null):Lt(kt(r,u,n.state,d),o);if(d&&(h=d[0].name)&&(p="m-"+(p?h+" "+p:h)),!a||c!=p){for(;l<u.start;)i(l=Math.min(u.start,l+5e3),c);c=p}u.start=u.pos}for(;l<u.pos;){var f=Math.min(u.pos,l+5e3);i(f,c),l=f}}var Ht=!1,Ut=!1;function Vt(e,t,r){this.marker=e,this.from=t,this.to=r}function Wt(e,t){if(e)for(var r=0;r<e.length;++r){var n=e[r];if(n.marker==t)return n}}function $t(e,t){if(t.full)return null;var r=vt(e,t.from.line)&&I(e,t.from.line).markedSpans,e=vt(e,t.to.line)&&I(e,t.to.line).markedSpans;if(!r&&!e)return null;var n=t.from.ch,i=t.to.ch,o=0==D(t.from,t.to),s=function(e,t,r){var n;if(e)for(var i=0;i<e.length;++i){var o,s=e[i],a=s.marker;!(null==s.from||(a.inclusiveLeft?s.from<=t:s.from<t))&&(s.from!=t||"bookmark"!=a.type||r&&s.marker.insertLeft)||(o=null==s.to||(a.inclusiveRight?s.to>=t:s.to>t),(n=n||[]).push(new Vt(a,s.from,o?null:s.to)))}return n}(r,n,o),a=function(e,t,r){var n;if(e)for(var i=0;i<e.length;++i){var o,s=e[i],a=s.marker;!(null==s.to||(a.inclusiveRight?s.to>=t:s.to>t))&&(s.from!=t||"bookmark"!=a.type||r&&!s.marker.insertLeft)||(o=null==s.from||(a.inclusiveLeft?s.from<=t:s.from<t),(n=n||[]).push(new Vt(a,o?null:s.from-t,null==s.to?null:s.to-t)))}return n}(e,i,o),l=1==t.text.length,c=H(t.text).length+(l?n:0);if(s)for(var u=0;u<s.length;++u){var d,h=s[u];null==h.to&&((d=Wt(a,h.marker))?l&&(h.to=null==d.to?null:d.to+c):h.to=n)}if(a)for(var p=0;p<a.length;++p){var f=a[p];null!=f.to&&(f.to+=c),null==f.from?Wt(s,f.marker)||(f.from=c,l&&(s=s||[]).push(f)):(f.from+=c,l&&(s=s||[]).push(f))}s=s&&Bt(s),a&&a!=s&&(a=Bt(a));var g=[s];if(!l){var m,y=t.text.length-2;if(0<y&&s)for(var v=0;v<s.length;++v)null==s[v].to&&(m=m||[]).push(new Vt(s[v].marker,null,null));for(var b=0;b<y;++b)g.push(m);g.push(a)}return g}function Bt(e){for(var t=0;t<e.length;++t){var r=e[t];null!=r.from&&r.from==r.to&&!1!==r.marker.clearWhenEmpty&&e.splice(t--,1)}return e.length?e:null}function jt(e){var t=e.markedSpans;if(t){for(var r=0;r<t.length;++r)t[r].marker.detachLine(e);e.markedSpans=null}}function zt(e,t){if(t){for(var r=0;r<t.length;++r)t[r].marker.attachLine(e);e.markedSpans=t}}function Yt(e){return e.inclusiveLeft?-1:0}function Gt(e){return e.inclusiveRight?1:0}function qt(e,t){var r,n,i=e.lines.length-t.lines.length;return 0!=i?i:(i=e.find(),r=t.find(),(n=D(i.from,r.from)||Yt(e)-Yt(t))?-n:D(i.to,r.to)||Gt(e)-Gt(t)||t.id-e.id)}function Kt(e,t){var r,n=Ut&&e.markedSpans;if(n)for(var i,o=0;o<n.length;++o)(i=n[o]).marker.collapsed&&null==(t?i.from:i.to)&&(!r||qt(r,i.marker)<0)&&(r=i.marker);return r}function Xt(e){return Kt(e,!0)}function Jt(e){return Kt(e,!1)}function Zt(e,t,r,n,i){var e=I(e,t),o=Ut&&e.markedSpans;if(o)for(var s=0;s<o.length;++s){var a=o[s];if(a.marker.collapsed){var l=a.marker.find(0),c=D(l.from,r)||Yt(a.marker)-Yt(i),u=D(l.to,n)||Gt(a.marker)-Gt(i);if(!(0<=c&&u<=0||c<=0&&0<=u)&&(c<=0&&(a.marker.inclusiveRight&&i.inclusiveLeft?0<=D(l.to,r):0<D(l.to,r))||0<=c&&(a.marker.inclusiveRight&&i.inclusiveLeft?D(l.from,n)<=0:D(l.from,n)<0)))return 1}}}function Qt(e){for(var t;t=Xt(e);)e=t.find(-1,!0).line;return e}function er(e,t){var e=I(e,t),r=Qt(e);return e==r?t:M(r)}function tr(e,t){if(t>e.lastLine())return t;var r,n=I(e,t);if(!rr(e,n))return t;for(;r=Jt(n);)n=r.find(1,!0).line;return M(n)+1}function rr(e,t){var r=Ut&&t.markedSpans;if(r)for(var n,i=0;i<r.length;++i)if((n=r[i]).marker.collapsed){if(null==n.from)return!0;if(!n.marker.widgetNode&&0==n.from&&n.marker.inclusiveLeft&&function e(t,r,n){{var i;if(null==n.to)return i=n.marker.find(1,!0),e(t,i.line,Wt(i.line.markedSpans,n.marker))}if(n.marker.inclusiveRight&&n.to==r.text.length)return!0;for(var o=void 0,s=0;s<r.markedSpans.length;++s)if((o=r.markedSpans[s]).marker.collapsed&&!o.marker.widgetNode&&o.from==n.to&&(null==o.to||o.to!=n.from)&&(o.marker.inclusiveLeft||n.marker.inclusiveRight)&&e(t,r,o))return!0}(e,t,n))return!0}}function nr(e){for(var t=0,r=(e=Qt(e)).parent,n=0;n<r.lines.length;++n){var i=r.lines[n];if(i==e)break;t+=i.height}for(var o=r.parent;o;o=(r=o).parent)for(var s=0;s<o.children.length;++s){var a=o.children[s];if(a==r)break;t+=a.height}return t}function ir(e){if(0==e.height)return 0;for(var t,r=e.text.length,n=e;t=Xt(n);){var i=t.find(0,!0),n=i.from.line;r+=i.from.ch-i.to.ch}for(n=e;t=Jt(n);)var o=t.find(0,!0),r=(r-=n.text.length-o.from.ch)+((n=o.to.line).text.length-o.to.ch);return r}function or(e){var r=e.display,e=e.doc;r.maxLine=I(e,e.first),r.maxLineLength=ir(r.maxLine),r.maxLineChanged=!0,e.iter(function(e){var t=ir(e);t>r.maxLineLength&&(r.maxLineLength=t,r.maxLine=e)})}var sr=function(e,t,r){this.text=e,zt(this,t),this.height=r?r(this):1};sr.prototype.lineNo=function(){return M(this)},Ye(sr);var ar={},lr={};function cr(e,t){return!e||/^\s*$/.test(e)?null:(t=t.addModeClass?lr:ar)[e]||(t[e]=e.replace(/\S+/g,"cm-$&"))}function ur(e,t){var r=te("span",null,null,C?"padding-right: .1px":null),n={pre:te("pre",[r],"CodeMirror-line"),content:r,col:0,pos:0,cm:e,trailingSpace:!1,splitSpaces:e.getOption("lineWrapping")};t.measure={};for(var i,o,s=0;s<=(t.rest?t.rest.length:0);s++){var a=s?t.rest[s-1]:t.line,l=void 0,c=(n.pos=0,n.addToken=hr,c=e.display.measure,o=i=void 0,(null!=Qe?Qe:(o=v(c,document.createTextNode("AخA")),i=oe(o,0,1).getBoundingClientRect(),o=oe(o,1,2).getBoundingClientRect(),ee(c),i&&i.left!=i.right&&(Qe=o.right-i.right<3)))&&(l=We(a,e.doc.direction))&&(n.addToken=function(d,h){return function(e,t,r,n,i,o,s){r=r?r+" cm-force-border":"cm-force-border";for(var a=e.pos,l=a+t.length;;){for(var c=void 0,u=0;u<h.length&&!((c=h[u]).to>a&&c.from<=a);u++);if(c.to>=l)return d(e,t,r,n,i,o,s);d(e,t.slice(0,c.to-a),r,n,null,o,s),n=null,t=t.slice(c.to-a),a=c.to}}}(n.addToken,l)),n.map=[],t!=e.display.externalMeasured&&M(a));!function(e,t,r){var n=e.markedSpans,i=e.text,o=0;if(n)for(var s,a,l,c,u,d,h,p=i.length,f=0,g=1,m="",y=0;;){if(y==f){l=c=u=a="",d=h=null,y=1/0;for(var v=[],b=void 0,w=0;w<n.length;++w){var C=n[w],E=C.marker;if("bookmark"==E.type&&C.from==f&&E.widgetNode)v.push(E);else if(C.from<=f&&(null==C.to||C.to>f||E.collapsed&&C.to==f&&C.from==f)){if(null!=C.to&&C.to!=f&&y>C.to&&(y=C.to,c=""),E.className&&(l+=" "+E.className),E.css&&(a=(a?a+";":"")+E.css),E.startStyle&&C.from==f&&(u+=" "+E.startStyle),E.endStyle&&C.to==y&&(b=b||[]).push(E.endStyle,C.to),E.title&&((h=h||{}).title=E.title),E.attributes)for(var T in E.attributes)(h=h||{})[T]=E.attributes[T];E.collapsed&&(!d||qt(d.marker,E)<0)&&(d=C)}else C.from>f&&y>C.from&&(y=C.from)}if(b)for(var S=0;S<b.length;S+=2)b[S+1]==y&&(c+=" "+b[S]);if(!d||d.from==f)for(var _=0;_<v.length;++_)pr(t,0,v[_]);if(d&&(d.from||0)==f){if(pr(t,(null==d.to?p+1:d.to)-f,d.marker,null==d.from),null==d.to)return;d.to==f&&(d=!1)}}if(p<=f)break;for(var x=Math.min(p,y);;){if(m){var R,A=f+m.length;if(d||(R=x<A?m.slice(0,x-f):m,t.addToken(t,R,s?s+l:l,u,f+R.length==y?c:"",a,h)),x<=A){m=m.slice(x-f),f=x;break}f=A,u=""}m=i.slice(o,o=r[g++]),s=cr(r[g++],t.cm.options)}}else for(var N=1;N<r.length;N+=2)t.addToken(t,i.slice(o,o=r[N]),cr(r[N+1],t.cm.options))}(a,n,Nt(e,a,c)),a.styleClasses&&(a.styleClasses.bgClass&&(n.bgClass=ie(a.styleClasses.bgClass,n.bgClass||"")),a.styleClasses.textClass)&&(n.textClass=ie(a.styleClasses.textClass,n.textClass||"")),0==n.map.length&&n.map.push(0,0,n.content.appendChild((o=e.display.measure,i=void 0,(o=(Ze=null==Ze&&(i=R("span","​"),v(o,R("span",[i,document.createTextNode("x")])),0!=o.firstChild.offsetHeight)?i.offsetWidth<=1&&2<i.offsetHeight&&!(w&&y<8):Ze)?R("span","​"):R("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px")).setAttribute("cm-text",""),o))),0==s?(t.measure.map=n.map,t.measure.cache={}):((t.measure.maps||(t.measure.maps=[])).push(n.map),(t.measure.caches||(t.measure.caches=[])).push({}))}return C&&(r=n.content.lastChild,/\bcm-tab\b/.test(r.className)||r.querySelector&&r.querySelector(".cm-tab"))&&(n.content.className="cm-tab-wrap-hack"),N(e,"renderLine",e,t.line,n.pre),n.pre.className&&(n.textClass=ie(n.pre.className,n.textClass||"")),n}function dr(e){var t=R("span","•","cm-invalidchar");return t.title="\\u"+e.charCodeAt(0).toString(16),t.setAttribute("aria-label",t.title),t}function hr(e,t,r,n,i,o,s){if(t){var a=e.splitSpaces?function(e,t){if(1<e.length&&!/  /.test(e))return e;for(var r=t,n="",i=0;i<e.length;i++){var o=e.charAt(i);" "!=o||!r||i!=e.length-1&&32!=e.charCodeAt(i+1)||(o=" "),n+=o,r=" "==o}return n}(t,e.trailingSpace):t,l=e.cm.state.specialChars,c=!1;if(l.test(t))for(var u=document.createDocumentFragment(),d=0;;){l.lastIndex=d;var h=l.exec(t),p=h?h.index-d:t.length-d;if(p&&(f=document.createTextNode(a.slice(d,d+p)),w&&y<9?u.appendChild(R("span",[f])):u.appendChild(f),e.map.push(e.pos,e.pos+p,f),e.col+=p,e.pos+=p),!h)break;d+=1+p;var f=void 0;"\t"==h[0]?(p=(p=e.cm.options.tabSize)-e.col%p,(f=u.appendChild(R("span",we(p),"cm-tab"))).setAttribute("role","presentation"),f.setAttribute("cm-text","\t"),e.col+=p):("\r"==h[0]||"\n"==h[0]?(f=u.appendChild(R("span","\r"==h[0]?"␍":"␤","cm-invalidchar"))).setAttribute("cm-text",h[0]):((f=e.cm.options.specialCharPlaceholder(h[0])).setAttribute("cm-text",h[0]),w&&y<9?u.appendChild(R("span",[f])):u.appendChild(f)),e.col+=1),e.map.push(e.pos,e.pos+1,f),e.pos++}else e.col+=t.length,u=document.createTextNode(a),e.map.push(e.pos,e.pos+t.length,u),w&&y<9&&(c=!0),e.pos+=t.length;if(e.trailingSpace=32==a.charCodeAt(t.length-1),r||n||i||c||o||s){var c=r||"",g=(n&&(c+=n),i&&(c+=i),R("span",[u],c,o));if(s)for(var m in s)s.hasOwnProperty(m)&&"style"!=m&&"class"!=m&&g.setAttribute(m,s[m]);return e.content.appendChild(g)}e.content.appendChild(u)}}function pr(e,t,r,n){var i=!n&&r.widgetNode;i&&e.map.push(e.pos,e.pos+t,i),!n&&e.cm.display.input.needsContentAttribute&&(i=i||e.content.appendChild(document.createElement("span"))).setAttribute("cm-marker",r.id),i&&(e.cm.display.input.setUneditable(i),e.content.appendChild(i)),e.pos+=t,e.trailingSpace=!1}function fr(e,t,r){this.line=t,this.rest=function(e){for(var t,r;t=Jt(e);)e=t.find(1,!0).line,(r=r||[]).push(e);return r}(t),this.size=this.rest?M(H(this.rest))-r+1:1,this.node=this.text=null,this.hidden=rr(e,t)}function gr(e,t,r){for(var n=[],i=t;i<r;i=s){var o=new fr(e.doc,I(e.doc,i),i),s=i+o.size;n.push(o)}return n}var mr=null;var yr=null;function b(e,t){var r=Be(e,t);if(r.length)for(var n,i=Array.prototype.slice.call(arguments,2),o=(mr?n=mr.delayedCallbacks:yr?n=yr:(n=yr=[],setTimeout(vr,0)),0);o<r.length;++o)!function(e){n.push(function(){return r[e].apply(null,i)})}(o)}function vr(){var e=yr;yr=null;for(var t=0;t<e.length;++t)e[t]()}function br(e,t,r,n){for(var i=0;i<t.changes.length;i++){var o=t.changes[i];if("text"==o){c=l=a=s=void 0;var s=e,a=t,l=a.text.className,c=Cr(s,a);a.text==a.node&&(a.node=c.pre),a.text.parentNode.replaceChild(c.pre,a.text),a.text=c.pre,c.bgClass!=a.bgClass||c.textClass!=a.textClass?(a.bgClass=c.bgClass,a.textClass=c.textClass,Er(s,a)):l&&(a.text.className=l)}else if("gutter"==o)Tr(e,t,r,n);else if("class"==o)Er(e,t);else if("widget"==o){p=h=d=s=u=c=void 0;var c=e,u=t,s=n;u.alignable&&(u.alignable=null);for(var d=Z("CodeMirror-linewidget"),h=u.node.firstChild,p=void 0;h;h=p)p=h.nextSibling,d.test(h.className)&&u.node.removeChild(h);Sr(c,u,s)}}t.changes=null}function wr(e){return e.node==e.text&&(e.node=R("div",null,null,"position: relative"),e.text.parentNode&&e.text.parentNode.replaceChild(e.node,e.text),e.node.appendChild(e.text),w)&&y<8&&(e.node.style.zIndex=2),e.node}function Cr(e,t){var r=e.display.externalMeasured;return r&&r.line==t.line?(e.display.externalMeasured=null,t.measure=r.measure,r.built):ur(e,t)}function Er(e,t){e=e,(i=(r=t).bgClass?r.bgClass+" "+(r.line.bgClass||""):r.line.bgClass)&&(i+=" CodeMirror-linebackground"),r.background?i?r.background.className=i:(r.background.parentNode.removeChild(r.background),r.background=null):i&&(n=wr(r),r.background=n.insertBefore(R("div",null,i),n.firstChild),e.display.input.setUneditable(r.background)),t.line.wrapClass?wr(t).className=t.line.wrapClass:t.node!=t.text&&(t.node.className="");var r,n,i=t.textClass?t.textClass+" "+(t.line.textClass||""):t.line.textClass;t.text.className=i||""}function Tr(e,t,r,n){t.gutter&&(t.node.removeChild(t.gutter),t.gutter=null),t.gutterBackground&&(t.node.removeChild(t.gutterBackground),t.gutterBackground=null),t.line.gutterClass&&(o=wr(t),t.gutterBackground=R("div",null,"CodeMirror-gutter-background "+t.line.gutterClass,"left: "+(e.options.fixedGutter?n.fixedPos:-n.gutterTotalWidth)+"px; width: "+n.gutterTotalWidth+"px"),e.display.input.setUneditable(t.gutterBackground),o.insertBefore(t.gutterBackground,t.text));var i=t.line.gutterMarkers;if(e.options.lineNumbers||i){var o=wr(t),s=t.gutter=R("div",null,"CodeMirror-gutter-wrapper","left: "+(e.options.fixedGutter?n.fixedPos:-n.gutterTotalWidth)+"px");if(s.setAttribute("aria-hidden","true"),e.display.input.setUneditable(s),o.insertBefore(s,t.text),t.line.gutterClass&&(s.className+=" "+t.line.gutterClass),!e.options.lineNumbers||i&&i["CodeMirror-linenumbers"]||(t.lineNumber=s.appendChild(R("div",bt(e.options,r),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+n.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+e.display.lineNumInnerWidth+"px"))),i)for(var a=0;a<e.display.gutterSpecs.length;++a){var l=e.display.gutterSpecs[a].className,c=i.hasOwnProperty(l)&&i[l];c&&s.appendChild(R("div",[c],"CodeMirror-gutter-elt","left: "+n.gutterLeft[l]+"px; width: "+n.gutterWidth[l]+"px"))}}}function Sr(e,t,r){if(_r(e,t.line,t,r,!0),t.rest)for(var n=0;n<t.rest.length;n++)_r(e,t.rest[n],t,r,!1)}function _r(e,t,r,n,i){if(t.widgets)for(var o=wr(r),s=0,a=t.widgets;s<a.length;++s){var l=a[s],c=R("div",[l.node],"CodeMirror-linewidget"+(l.className?" "+l.className:"")),u=(l.handleMouseEvents||c.setAttribute("cm-ignore-events","true"),p=h=d=u=void 0,l),d=c,h=r,p=n;u.noHScroll&&((h.alignable||(h.alignable=[])).push(d),h=p.wrapperWidth,d.style.left=p.fixedPos+"px",u.coverGutter||(h-=p.gutterTotalWidth,d.style.paddingLeft=p.gutterTotalWidth+"px"),d.style.width=h+"px"),u.coverGutter&&(d.style.zIndex=5,d.style.position="relative",u.noHScroll||(d.style.marginLeft=-p.gutterTotalWidth+"px")),e.display.input.setUneditable(c),i&&l.above?o.insertBefore(c,r.gutter||r.text):o.appendChild(c),b(l,"redraw")}}function xr(e){var t,r;return null!=e.height?e.height:(t=e.doc.cm)?(re(document.body,e.node)||(r="position: relative;",e.coverGutter&&(r+="margin-left: -"+t.display.gutters.offsetWidth+"px;"),e.noHScroll&&(r+="width: "+t.display.wrapper.clientWidth+"px;"),v(t.display.measure,R("div",[e.node],null,r))),e.height=e.node.parentNode.offsetHeight):0}function Rr(e,t){for(var r=Xe(t);r!=e.wrapper;r=r.parentNode)if(!r||1==r.nodeType&&"true"==r.getAttribute("cm-ignore-events")||r.parentNode==e.sizer&&r!=e.mover)return 1}function Ar(e){return e.lineSpace.offsetTop}function Nr(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight}function Or(e){var t;return e.cachedPaddingH||(t=v(e.measure,R("pre","x","CodeMirror-line-like")),t=window.getComputedStyle?window.getComputedStyle(t):t.currentStyle,t={left:parseInt(t.paddingLeft),right:parseInt(t.paddingRight)},isNaN(t.left)||isNaN(t.right)||(e.cachedPaddingH=t),t)}function Ir(e){return pe-e.display.nativeBarWidth}function Mr(e){return e.display.scroller.clientWidth-Ir(e)-e.display.barWidth}function kr(e){return e.display.scroller.clientHeight-Ir(e)-e.display.barHeight}function Dr(e,t,r){if(e.line==t)return{map:e.measure.map,cache:e.measure.cache};if(e.rest){for(var n=0;n<e.rest.length;n++)if(e.rest[n]==t)return{map:e.measure.maps[n],cache:e.measure.caches[n]};for(var i=0;i<e.rest.length;i++)if(M(e.rest[i])>r)return{map:e.measure.maps[i],cache:e.measure.caches[i],before:!0}}}function Pr(e,t,r,n){return Hr(e,Fr(e,t),r,n)}function Lr(e,t){return t>=e.display.viewFrom&&t<e.display.viewTo?e.display.view[fn(e,t)]:(e=e.display.externalMeasured)&&t>=e.lineN&&t<e.lineN+e.size?e:void 0}function Fr(e,t){var r,n,i=M(t),o=Lr(e,i),e=(o&&!o.text?o=null:o&&o.changes&&(br(e,o,i,cn(e)),e.curOp.forceUpdate=!0),o||(e=e,n=M(r=Qt(r=t)),(r=e.display.externalMeasured=new fr(e.doc,r,n)).lineN=n,n=r.built=ur(e,r),r.text=n.pre,v(e.display.lineMeasure,n.pre),o=r),Dr(o,t,i));return{line:t,view:o,rect:null,map:e.map,cache:e.cache,before:e.before,hasHeights:!1}}function Hr(e,t,r,n,i){var o,s=(r=t.before?-1:r)+(n||"");if(t.cache.hasOwnProperty(s))o=t.cache[s];else{if(t.rect||(t.rect=t.view.text.getBoundingClientRect()),!t.hasHeights){var a=e,l=t.view,c=t.rect,u=a.options.lineWrapping,a=u&&Mr(a);if(!l.measure.heights||u&&l.measure.width!=a){var d=l.measure.heights=[];if(u){l.measure.width=a;for(var h=l.text.firstChild.getClientRects(),p=0;p<h.length-1;p++){var f=h[p],g=h[p+1];2<Math.abs(f.bottom-g.bottom)&&d.push((f.bottom+g.top)/2-c.top)}}d.push(c.bottom-c.top)}t.hasHeights=!0}(o=function(e,t,r,n){var i,o=Wr(t.map,r,n),s=o.node,a=o.start,l=o.end,c=o.collapse;if(3==s.nodeType){for(var u=0;u<4;u++){for(;a&&Ne(t.line.text.charAt(o.coverStart+a));)--a;for(;o.coverStart+l<o.coverEnd&&Ne(t.line.text.charAt(o.coverStart+l));)++l;if((i=w&&y<9&&0==a&&l==o.coverEnd-o.coverStart?s.parentNode.getBoundingClientRect():function(e,t){var r=Vr;if("left"==t)for(var n=0;n<e.length&&(r=e[n]).left==r.right;n++);else for(var i=e.length-1;0<=i&&(r=e[i]).left==r.right;i--);return r}(oe(s,a,l).getClientRects(),n)).left||i.right||0==a)break;l=a,a-=1,c="right"}w&&y<11&&(i=function(e,t){var r;return window.screen&&null!=screen.logicalXDPI&&screen.logicalXDPI!=screen.deviceXDPI&&function(e){var t;return null!=it?it:(t=(e=v(e,R("span","x"))).getBoundingClientRect(),e=oe(e,0,1).getBoundingClientRect(),it=1<Math.abs(t.left-e.left))}(e)?(e=screen.logicalXDPI/screen.deviceXDPI,r=screen.logicalYDPI/screen.deviceYDPI,{left:t.left*e,right:t.right*e,top:t.top*r,bottom:t.bottom*r}):t}(e.display.measure,i))}else 0<a&&(c=n="right"),i=e.options.lineWrapping&&1<(r=s.getClientRects()).length?r["right"==n?r.length-1:0]:s.getBoundingClientRect();!(w&&y<9)||a||i&&(i.left||i.right)||(r=s.parentNode.getClientRects()[0],i=r?{left:r.left,right:r.left+ln(e.display),top:r.top,bottom:r.bottom}:Vr);for(var r=i.top-t.rect.top,d=i.bottom-t.rect.top,h=(r+d)/2,p=t.view.measure.heights,f=0;f<p.length-1&&!(h<p[f]);f++);var g=f?p[f-1]:0,m=p[f],g={left:("right"==c?i.right:i.left)-t.rect.left,right:("left"==c?i.left:i.right)-t.rect.left,top:g,bottom:m};i.left||i.right||(g.bogus=!0);e.options.singleCursorHeightPerLine||(g.rtop=r,g.rbottom=d);return g}(e,t,r,n)).bogus||(t.cache[s]=o)}return{left:o.left,right:o.right,top:i?o.rtop:o.top,bottom:i?o.rbottom:o.bottom}}var Ur,Vr={left:0,right:0,top:0,bottom:0};function Wr(e,t,r){for(var n,i,o,s,a,l,c=0;c<e.length;c+=3)if(a=e[c],l=e[c+1],t<a?(i=0,o=1,s="left"):t<l?o=(i=t-a)+1:(c==e.length-3||t==l&&e[c+3]>t)&&(i=(o=l-a)-1,l<=t)&&(s="right"),null!=i){if(n=e[c+2],a==l&&r==(n.insertLeft?"left":"right")&&(s=r),"left"==r&&0==i)for(;c&&e[c-2]==e[c-3]&&e[c-1].insertLeft;)n=e[2+(c-=3)],s="left";if("right"==r&&i==l-a)for(;c<e.length-3&&e[c+3]==e[c+4]&&!e[c+5].insertLeft;)n=e[(c+=3)+2],s="right";break}return{node:n,start:i,end:o,collapse:s,coverStart:a,coverEnd:l}}function $r(e){if(e.measure&&(e.measure.cache={},e.measure.heights=null,e.rest))for(var t=0;t<e.rest.length;t++)e.measure.caches[t]={}}function Br(e){e.display.externalMeasure=null,ee(e.display.lineMeasure);for(var t=0;t<e.display.view.length;t++)$r(e.display.view[t])}function jr(e){Br(e),e.display.cachedCharWidth=e.display.cachedTextHeight=e.display.cachedPaddingH=null,e.options.lineWrapping||(e.display.maxLineChanged=!0),e.display.lineNumChars=null}function zr(e){return $&&G?-(e.body.getBoundingClientRect().left-parseInt(getComputedStyle(e.body).marginLeft)):e.defaultView.pageXOffset||(e.documentElement||e.body).scrollLeft}function Yr(e){return $&&G?-(e.body.getBoundingClientRect().top-parseInt(getComputedStyle(e.body).marginTop)):e.defaultView.pageYOffset||(e.documentElement||e.body).scrollTop}function Gr(e){var t=Qt(e).widgets,r=0;if(t)for(var n=0;n<t.length;++n)t[n].above&&(r+=xr(t[n]));return r}function qr(e,t,r,n,i){return i||(i=Gr(t),r.top+=i,r.bottom+=i),"line"!=n&&(n=n||"local",i=nr(t),"local"==n?i+=Ar(e.display):i-=e.display.viewOffset,"page"!=n&&"window"!=n||(i+=(t=e.display.lineSpace.getBoundingClientRect()).top+("window"==n?0:Yr(ae(e))),t=t.left+("window"==n?0:zr(ae(e))),r.left+=t,r.right+=t),r.top+=i,r.bottom+=i),r}function Kr(e,t,r){var n;return"div"==r?t:(n=t.left,t=t.top,"page"==r?(n-=zr(ae(e)),t-=Yr(ae(e))):"local"!=r&&r||(n+=(r=e.display.sizer.getBoundingClientRect()).left,t+=r.top),{left:n-(r=e.display.lineSpace.getBoundingClientRect()).left,top:t-r.top})}function Xr(e,t,r,n,i){return qr(e,n=n||I(e.doc,t.line),Pr(e,n,t.ch,i),r)}function Jr(r,e,n,i,o,s){function a(e,t){e=Hr(r,o,e,t?"right":"left",s);return t?e.left=e.right:e.right=e.left,qr(r,i,e,n)}i=i||I(r.doc,e.line),o=o||Fr(r,i);var t,l,c=We(i,r.doc.direction),u=e.ch,e=e.sticky;return u>=i.text.length?(u=i.text.length,e="before"):u<=0&&(u=0,e="after"),c?(l=ke(c,u,e),t=Me,l=d(u,l,"before"==e),null!=t&&(l.other=d(u,t,"before"!=e)),l):a("before"==e?u-1:u,"before"==e);function d(e,t,r){return a(r?e-1:e,1==c[t].level!=r)}}function Zr(e,t){var r=0,t=(t=P(e.doc,t),e.options.lineWrapping||(r=ln(e.display)*t.ch),I(e.doc,t.line)),e=nr(t)+Ar(e.display);return{left:r,right:r,top:e,bottom:e+t.height}}function Qr(e,t,r,n,i){e=k(e,t,r);return e.xRel=i,n&&(e.outside=n),e}function en(e,t,r){var n=e.doc;if((r+=e.display.viewOffset)<0)return Qr(n.first,0,null,-1,-1);var i=yt(n,r),o=n.first+n.size-1;if(o<i)return Qr(n.first+n.size-1,I(n,o).text.length,null,1,1);t<0&&(t=0);for(var s=I(n,i);;){var a=function(r,e,t,n,i){i-=nr(e);var o=Fr(r,e),s=Gr(e),a=0,l=e.text.length,c=!0,u=We(e,r.doc.direction);u&&(u=(r.options.lineWrapping?sn:on)(r,e,t,o,u,n,i),c=1!=u.level,a=c?u.from:u.to-1,l=c?u.to:u.from-1);var d=null,h=null,u=Ie(function(e){var t=Hr(r,o,e);return t.top+=s,t.bottom+=s,nn(t,n,i,!1)&&(t.top<=i&&t.left<=n&&(d=e,h=t),1)},a,l),p=!1;{var f,g;h?(f=n-h.left<h.right-n,u=d+((g=f==c)?0:1),g=g?"after":"before",f=f?h.left:h.right):(c||u!=l&&u!=a||u++,g=0==u||u!=e.text.length&&Hr(r,o,u-(c?1:0)).bottom+s<=i==c?"after":"before",l=Jr(r,k(t,u,g),"line",e,o),f=l.left,p=i<l.top?-1:i>=l.bottom?1:0)}return u=Oe(e.text,u,1),Qr(t,u,g,p,n-f)}(e,s,i,t,r),l=function(e,t){var r,n=Ut&&e.markedSpans;if(n)for(var i=0;i<n.length;++i){var o=n[i];o.marker.collapsed&&(null==o.from||o.from<t)&&(null==o.to||o.to>t)&&(!r||qt(r,o.marker)<0)&&(r=o.marker)}return r}(s,a.ch+(0<a.xRel||0<a.outside?1:0));if(!l)return a;a=l.find(1);if(a.line==i)return a;s=I(n,i=a.line)}}function tn(t,e,r,n){n-=Gr(e);var e=e.text.length,i=Ie(function(e){return Hr(t,r,e-1).bottom<=n},e,0);return{begin:i,end:Ie(function(e){return Hr(t,r,e).top>n},i,e)}}function rn(e,t,r,n){return tn(e,t,r=r||Fr(e,t),qr(e,t,Hr(e,r,n),"line").top)}function nn(e,t,r,n){return!(e.bottom<=r)&&(e.top>r||(n?e.left:e.right)>t)}function on(r,n,i,o,s,a,l){var e,t=Ie(function(e){var e=s[e],t=1!=e.level;return nn(Jr(r,k(i,t?e.to:e.from,t?"before":"after"),"line",n,o),a,l,!0)},0,s.length-1),c=s[t];return c=0<t&&(e=1!=c.level,nn(e=Jr(r,k(i,e?c.from:c.to,e?"after":"before"),"line",n,o),a,l,!0))&&e.top>l?s[t-1]:c}function sn(e,t,r,n,i,o,s){for(var s=tn(e,t,n,s),a=s.begin,l=s.end,c=(/\s/.test(t.text.charAt(l-1))&&l--,null),u=null,d=0;d<i.length;d++){var h,p=i[d];p.from>=l||p.to<=a||(h=(h=Hr(e,n,1!=p.level?Math.min(l,p.to)-1:Math.max(a,p.from)).right)<o?o-h+1e9:h-o,(!c||h<u)&&(c=p,u=h))}return c=(c=(c=c||i[i.length-1]).from<a?{from:a,to:c.to,level:c.level}:c).to>l?{from:c.from,to:l,level:c.level}:c}function an(e){if(null!=e.cachedTextHeight)return e.cachedTextHeight;if(null==Ur){Ur=R("pre",null,"CodeMirror-line-like");for(var t=0;t<49;++t)Ur.appendChild(document.createTextNode("x")),Ur.appendChild(R("br"));Ur.appendChild(document.createTextNode("x"))}v(e.measure,Ur);var r=Ur.offsetHeight/50;return 3<r&&(e.cachedTextHeight=r),ee(e.measure),r||1}function ln(e){var t,r;return null!=e.cachedCharWidth?e.cachedCharWidth:(r=R("span","xxxxxxxxxx"),t=R("pre",[r],"CodeMirror-line-like"),v(e.measure,t),2<(r=((t=r.getBoundingClientRect()).right-t.left)/10)&&(e.cachedCharWidth=r),r||10)}function cn(e){for(var t=e.display,r={},n={},i=t.gutters.clientLeft,o=t.gutters.firstChild,s=0;o;o=o.nextSibling,++s){var a=e.display.gutterSpecs[s].className;r[a]=o.offsetLeft+o.clientLeft+i,n[a]=o.clientWidth}return{fixedPos:un(t),gutterTotalWidth:t.gutters.offsetWidth,gutterLeft:r,gutterWidth:n,wrapperWidth:t.wrapper.clientWidth}}function un(e){return e.scroller.getBoundingClientRect().left-e.sizer.getBoundingClientRect().left}function dn(n){var i=an(n.display),o=n.options.lineWrapping,s=o&&Math.max(5,n.display.scroller.clientWidth/ln(n.display)-3);return function(e){if(rr(n.doc,e))return 0;var t=0;if(e.widgets)for(var r=0;r<e.widgets.length;r++)e.widgets[r].height&&(t+=e.widgets[r].height);return o?t+(Math.ceil(e.text.length/s)||1)*i:t+i}}function hn(e){var t=e.doc,r=dn(e);t.iter(function(e){var t=r(e);t!=e.height&&mt(e,t)})}function pn(e,t,r,n){var i=e.display;if(!r&&"true"==Xe(t).getAttribute("cm-not-content"))return null;var o,s,r=i.lineSpace.getBoundingClientRect();try{o=t.clientX-r.left,s=t.clientY-r.top}catch(e){return null}i=en(e,o,s);return n&&0<i.xRel&&(t=I(e.doc,i.line).text).length==i.ch&&(r=de(t,t.length,e.options.tabSize)-t.length,i=k(i.line,Math.max(0,Math.round((o-Or(e.display).left)/ln(e.display))-r))),i}function fn(e,t){if(t>=e.display.viewTo)return null;if((t-=e.display.viewFrom)<0)return null;for(var r=e.display.view,n=0;n<r.length;n++)if((t-=r[n].size)<0)return n}function L(e,t,r,n){null==t&&(t=e.doc.first),null==r&&(r=e.doc.first+e.doc.size);var i,o=e.display,s=((n=n||0)&&r<o.viewTo&&(null==o.updateLineNumbers||o.updateLineNumbers>t)&&(o.updateLineNumbers=t),e.curOp.viewChanged=!0,t>=o.viewTo?Ut&&er(e.doc,t)<o.viewTo&&mn(e):r<=o.viewFrom?Ut&&tr(e.doc,r+n)>o.viewFrom?mn(e):(o.viewFrom+=n,o.viewTo+=n):t<=o.viewFrom&&r>=o.viewTo?mn(e):t<=o.viewFrom?(s=yn(e,r,r+n,1))?(o.view=o.view.slice(s.index),o.viewFrom=s.lineN,o.viewTo+=n):mn(e):r>=o.viewTo?(s=yn(e,t,t,-1))?(o.view=o.view.slice(0,s.index),o.viewTo=s.lineN):mn(e):(s=yn(e,t,t,-1),i=yn(e,r,r+n,1),s&&i?(o.view=o.view.slice(0,s.index).concat(gr(e,s.lineN,i.lineN)).concat(o.view.slice(i.index)),o.viewTo+=n):mn(e)),o.externalMeasured);s&&(r<s.lineN?s.lineN+=n:t<s.lineN+s.size&&(o.externalMeasured=null))}function gn(e,t,r){e.curOp.viewChanged=!0;var n=e.display,i=e.display.externalMeasured;i&&t>=i.lineN&&t<i.lineN+i.size&&(n.externalMeasured=null),t<n.viewFrom||t>=n.viewTo||null!=(i=n.view[fn(e,t)]).node&&-1==T(n=i.changes||(i.changes=[]),r)&&n.push(r)}function mn(e){e.display.viewFrom=e.display.viewTo=e.doc.first,e.display.view=[],e.display.viewOffset=0}function yn(e,t,r,n){var i,o=fn(e,t),s=e.display.view;if(Ut&&r!=e.doc.first+e.doc.size){for(var a=e.display.viewFrom,l=0;l<o;l++)a+=s[l].size;if(a!=t){if(0<n){if(o==s.length-1)return null;i=a+s[o].size-t,o++}else i=a-t;t+=i,r+=i}for(;er(e.doc,r)!=r;){if(o==(n<0?0:s.length-1))return null;r+=n*s[o-(n<0?1:0)].size,o+=n}}return{index:o,lineN:r}}function vn(e){for(var t=e.display.view,r=0,n=0;n<t.length;n++){var i=t[n];i.hidden||i.node&&!i.changes||++r}return r}function bn(e){e.display.input.showSelection(e.display.input.prepareSelection())}function wn(e,t){void 0===t&&(t=!0);var r=e.doc,n={},i=n.cursors=document.createDocumentFragment(),o=n.selection=document.createDocumentFragment(),s=e.options.$customCursor;s&&(t=!0);for(var a,l,c,u=0;u<r.sel.ranges.length;u++)!t&&u==r.sel.primIndex||((a=r.sel.ranges[u]).from().line>=e.display.viewTo||a.to().line<e.display.viewFrom||(l=a.empty(),s?(c=s(e,a))&&Cn(e,c,i):(l||e.options.showCursorWhenSelecting)&&Cn(e,a.head,i),l))||function(i,e,t){var r=i.display,o=i.doc,s=document.createDocumentFragment(),n=Or(i.display),T=n.left,S=Math.max(r.sizerWidth,Mr(i)-r.sizer.offsetLeft)-n.right,_="ltr"==o.direction;function x(e,t,r,n){t<0&&(t=0),t=Math.round(t),n=Math.round(n),s.appendChild(R("div",null,"CodeMirror-selected","position: absolute; left: "+e+"px;\n                             top: "+t+"px; width: "+(null==r?S-e:r)+"px;\n                             height: "+(n-t)+"px"))}function a(r,g,m){var y,v,n=I(o,r),b=n.text.length;function w(e,t){return Xr(i,k(r,e),"div",n,t)}function C(e,t,r){e=rn(i,n,null,e),t="ltr"==t==("after"==r)?"left":"right";return w("after"==r?e.begin:e.end-(/\s/.test(n.text.charAt(e.end-1))?2:1),t)[t]}var E=We(n,o.direction);return function(e,t,r,n){if(!e)return n(t,r,"ltr",0);for(var i=!1,o=0;o<e.length;++o){var s=e[o];(s.from<r&&s.to>t||t==r&&s.to==t)&&(n(Math.max(s.from,t),Math.min(s.to,r),1==s.level?"rtl":"ltr",o),i=!0)}i||n(t,r,"ltr")}(E,g||0,null==m?b:m,function(e,t,r,n){var i,o,s,a,l,c="ltr"==r,u=w(e,c?"left":"right"),d=w(t-1,c?"right":"left"),h=null==g&&0==e,p=null==m&&t==b,f=0==n,n=!E||n==E.length-1;d.top-u.top<=3?(i=(_?h:p)&&f?T:(c?u:d).left,l=(_?p:h)&&n?S:(c?d:u).right,x(i,u.top,l-i,u.bottom)):(l=c?(o=_&&h&&f?T:u.left,s=_?S:C(e,r,"before"),a=_?T:C(t,r,"after"),_&&p&&n?S:d.right):(o=_?C(e,r,"before"):T,s=!_&&h&&f?S:u.right,a=!_&&p&&n?T:d.left,_?C(t,r,"after"):S),x(o,u.top,s-o,u.bottom),u.bottom<d.top&&x(T,u.bottom,null,d.top),x(a,d.top,l-a,d.bottom)),(!y||En(u,y)<0)&&(y=u),En(d,y)<0&&(y=d),(!v||En(u,v)<0)&&(v=u),En(d,v)<0&&(v=d)}),{start:y,end:v}}r=e.from(),n=e.to();{var l;r.line==n.line?a(r.line,r.ch,n.ch):(e=I(o,r.line),l=I(o,n.line),l=Qt(e)==Qt(l),r=a(r.line,r.ch,l?e.text.length+1:null).end,e=a(n.line,l?0:null,n.ch).start,l&&(r.top<e.top-2?(x(r.right,r.top,null,r.bottom),x(T,e.top,e.left,e.bottom)):x(r.right,r.top,e.left-r.right,r.bottom)),r.bottom<e.top&&x(T,r.bottom,null,e.top))}t.appendChild(s)}(e,a,o);return n}function Cn(e,t,r){var n=Jr(e,t,"div",null,null,!e.options.singleCursorHeightPerLine),i=r.appendChild(R("div"," ","CodeMirror-cursor"));i.style.left=n.left+"px",i.style.top=n.top+"px",i.style.height=Math.max(0,n.bottom-n.top)*e.options.cursorHeight+"px",/\bcm-fat-cursor\b/.test(e.getWrapperElement().className)&&(t=(t=Xr(e,t,"div",null,null)).right-t.left,i.style.width=(0<t?t:e.defaultCharWidth())+"px"),n.other&&((i=r.appendChild(R("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"))).style.display="",i.style.left=n.other.left+"px",i.style.top=n.other.top+"px",i.style.height=.85*(n.other.bottom-n.other.top)+"px")}function En(e,t){return e.top-t.top||e.left-t.left}function Tn(e){var t,r;e.state.focused&&(t=e.display,clearInterval(t.blinker),r=!0,t.cursorDiv.style.visibility="",0<e.options.cursorBlinkRate?t.blinker=setInterval(function(){e.hasFocus()||Rn(e),t.cursorDiv.style.visibility=(r=!r)?"":"hidden"},e.options.cursorBlinkRate):e.options.cursorBlinkRate<0&&(t.cursorDiv.style.visibility="hidden"))}function Sn(e){e.hasFocus()||(e.display.input.focus(),e.state.focused)||xn(e)}function _n(e){e.state.delayingBlurEvent=!0,setTimeout(function(){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1,e.state.focused)&&Rn(e)},100)}function xn(e,t){e.state.delayingBlurEvent&&!e.state.draggingText&&(e.state.delayingBlurEvent=!1),"nocursor"!=e.options.readOnly&&(e.state.focused||(N(e,"focus",e,t),e.state.focused=!0,ne(e.display.wrapper,"CodeMirror-focused"),e.curOp||e.display.selForContextMenu==e.doc.sel||(e.display.input.reset(),C&&setTimeout(function(){return e.display.input.reset(!0)},20)),e.display.input.receivedFocus()),Tn(e))}function Rn(e,t){e.state.delayingBlurEvent||(e.state.focused&&(N(e,"blur",e,t),e.state.focused=!1,Q(e.display.wrapper,"CodeMirror-focused")),clearInterval(e.display.blinker),setTimeout(function(){e.state.focused||(e.display.shift=!1)},150))}function An(e){for(var t=e.display,r=t.lineDiv.offsetTop,n=Math.max(0,t.scroller.getBoundingClientRect().top),i=t.lineDiv.getBoundingClientRect().top,o=0,s=0;s<t.view.length;s++){var a=t.view[s],l=e.options.lineWrapping,c=void 0,u=0;if(!a.hidden){i+=a.line.height,w&&y<8?(c=(d=a.node.offsetTop+a.node.offsetHeight)-r,r=d):(c=(d=a.node.getBoundingClientRect()).bottom-d.top,!l&&a.text.firstChild&&(u=a.text.firstChild.getBoundingClientRect().right-d.left-1));var d,l=a.line.height-c;if((.005<l||l<-.005)&&(i<n&&(o-=l),mt(a.line,c),Nn(a.line),a.rest))for(var h=0;h<a.rest.length;h++)Nn(a.rest[h]);u>e.display.sizerWidth&&(l=Math.ceil(u/ln(e.display)))>e.display.maxLineLength&&(e.display.maxLineLength=l,e.display.maxLine=a.line,e.display.maxLineChanged=!0)}}2<Math.abs(o)&&(t.scroller.scrollTop+=o)}function Nn(e){if(e.widgets)for(var t=0;t<e.widgets.length;++t){var r=e.widgets[t],n=r.node.parentNode;n&&(r.height=n.offsetHeight)}}function On(e,t,r){var n,i=r&&null!=r.top?Math.max(0,r.top):e.scroller.scrollTop,i=Math.floor(i-Ar(e)),o=r&&null!=r.bottom?r.bottom:i+e.wrapper.clientHeight,i=yt(t,i),o=yt(t,o);return r&&r.ensure&&(n=r.ensure.from.line,r=r.ensure.to.line,n<i?o=yt(t,nr(I(t,i=n))+e.wrapper.clientHeight):Math.min(r,t.lastLine())>=o&&(i=yt(t,nr(I(t,r))-e.wrapper.clientHeight),o=r)),{from:i,to:Math.max(o,i+1)}}function In(e,t){var r=e.display,n=an(e.display),i=(t.top<0&&(t.top=0),(e.curOp&&null!=e.curOp.scrollTop?e.curOp:r.scroller).scrollTop),o=kr(e),s={},a=(t.bottom-t.top>o&&(t.bottom=t.top+o),e.doc.height+Nr(r)),l=t.top<n,n=t.bottom>a-n,n=(t.top<i?s.scrollTop=l?0:t.top:t.bottom>i+o&&(l=Math.min(t.top,(n?a:t.bottom)-o))!=i&&(s.scrollTop=l),e.options.fixedGutter?0:r.gutters.offsetWidth),a=e.curOp&&null!=e.curOp.scrollLeft?e.curOp.scrollLeft:r.scroller.scrollLeft-n,o=Mr(e)-r.gutters.offsetWidth,i=t.right-t.left>o;return i&&(t.right=t.left+o),t.left<10?s.scrollLeft=0:t.left<a?s.scrollLeft=Math.max(0,t.left+n-(i?0:10)):t.right>o+a-3&&(s.scrollLeft=t.right+(i?0:10)-o),s}function Mn(e,t){null!=t&&(Pn(e),e.curOp.scrollTop=(null==e.curOp.scrollTop?e.doc:e.curOp).scrollTop+t)}function kn(e){Pn(e);var t=e.getCursor();e.curOp.scrollToPos={from:t,to:t,margin:e.options.cursorScrollMargin}}function Dn(e,t,r){null==t&&null==r||Pn(e),null!=t&&(e.curOp.scrollLeft=t),null!=r&&(e.curOp.scrollTop=r)}function Pn(e){var t=e.curOp.scrollToPos;t&&(e.curOp.scrollToPos=null,Ln(e,Zr(e,t.from),Zr(e,t.to),t.margin))}function Ln(e,t,r,n){t=In(e,{left:Math.min(t.left,r.left),top:Math.min(t.top,r.top)-n,right:Math.max(t.right,r.right),bottom:Math.max(t.bottom,r.bottom)+n});Dn(e,t.scrollLeft,t.scrollTop)}function Fn(e,t){Math.abs(e.doc.scrollTop-t)<2||(m||ti(e,{top:t}),Hn(e,t,!0),m&&ti(e),Xn(e,100))}function Hn(e,t,r){t=Math.max(0,Math.min(e.display.scroller.scrollHeight-e.display.scroller.clientHeight,t)),e.display.scroller.scrollTop==t&&!r||(e.doc.scrollTop=t,e.display.scrollbars.setScrollTop(t),e.display.scroller.scrollTop==t)||(e.display.scroller.scrollTop=t)}function Un(e,t,r,n){t=Math.max(0,Math.min(t,e.display.scroller.scrollWidth-e.display.scroller.clientWidth)),(r?t==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-t)<2)&&!n||(e.doc.scrollLeft=t,ii(e),e.display.scroller.scrollLeft!=t&&(e.display.scroller.scrollLeft=t),e.display.scrollbars.setScrollLeft(t))}function Vn(e){var t=e.display,r=t.gutters.offsetWidth,n=Math.round(e.doc.height+Nr(e.display));return{clientHeight:t.scroller.clientHeight,viewHeight:t.wrapper.clientHeight,scrollWidth:t.scroller.scrollWidth,clientWidth:t.scroller.clientWidth,viewWidth:t.wrapper.clientWidth,barLeft:e.options.fixedGutter?r:0,docHeight:n,scrollHeight:n+Ir(e)+t.barHeight,nativeBarWidth:t.nativeBarWidth,gutterWidth:r}}function Wn(e,t,r){this.cm=r;var n=this.vert=R("div",[R("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),i=this.horiz=R("div",[R("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");n.tabIndex=i.tabIndex=-1,e(n),e(i),S(n,"scroll",function(){n.clientHeight&&t(n.scrollTop,"vertical")}),S(i,"scroll",function(){i.clientWidth&&t(i.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,w&&y<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")}function $n(){}Wn.prototype.update=function(e){var t,r=e.scrollWidth>e.clientWidth+1,n=e.scrollHeight>e.clientHeight+1,i=e.nativeBarWidth;return n?(this.vert.style.display="block",this.vert.style.bottom=r?i+"px":"0",t=e.viewHeight-(r?i:0),this.vert.firstChild.style.height=Math.max(0,e.scrollHeight-e.clientHeight+t)+"px"):(this.vert.scrollTop=0,this.vert.style.display="",this.vert.firstChild.style.height="0"),r?(this.horiz.style.display="block",this.horiz.style.right=n?i+"px":"0",this.horiz.style.left=e.barLeft+"px",t=e.viewWidth-e.barLeft-(n?i:0),this.horiz.firstChild.style.width=Math.max(0,e.scrollWidth-e.clientWidth+t)+"px"):(this.horiz.style.display="",this.horiz.firstChild.style.width="0"),!this.checkedZeroWidth&&0<e.clientHeight&&(0==i&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:n?i:0,bottom:r?i:0}},Wn.prototype.setScrollLeft=function(e){this.horiz.scrollLeft!=e&&(this.horiz.scrollLeft=e),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")},Wn.prototype.setScrollTop=function(e){this.vert.scrollTop!=e&&(this.vert.scrollTop=e),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert,"vert")},Wn.prototype.zeroWidthHack=function(){this.horiz.style.height=this.vert.style.width=E&&!u?"12px":"18px",this.horiz.style.visibility=this.vert.style.visibility="hidden",this.disableHoriz=new he,this.disableVert=new he},Wn.prototype.enableZeroWidthBar=function(r,n,i){r.style.visibility="",n.set(1e3,function e(){var t=r.getBoundingClientRect();("vert"==i?document.elementFromPoint(t.right-1,(t.top+t.bottom)/2):document.elementFromPoint((t.right+t.left)/2,t.bottom-1))!=r?r.style.visibility="hidden":n.set(1e3,e)})},Wn.prototype.clear=function(){var e=this.horiz.parentNode;e.removeChild(this.horiz),e.removeChild(this.vert)};function Bn(e,t){t=t||Vn(e);var r=e.display.barWidth,n=e.display.barHeight;jn(e,t);for(var i=0;i<4&&r!=e.display.barWidth||n!=e.display.barHeight;i++)r!=e.display.barWidth&&e.options.lineWrapping&&An(e),jn(e,Vn(e)),r=e.display.barWidth,n=e.display.barHeight}function jn(e,t){var r=e.display,n=r.scrollbars.update(t);r.sizer.style.paddingRight=(r.barWidth=n.right)+"px",r.sizer.style.paddingBottom=(r.barHeight=n.bottom)+"px",r.heightForcer.style.borderBottom=n.bottom+"px solid transparent",n.right&&n.bottom?(r.scrollbarFiller.style.display="block",r.scrollbarFiller.style.height=n.bottom+"px",r.scrollbarFiller.style.width=n.right+"px"):r.scrollbarFiller.style.display="",n.bottom&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter?(r.gutterFiller.style.display="block",r.gutterFiller.style.height=n.bottom+"px",r.gutterFiller.style.width=t.gutterWidth+"px"):r.gutterFiller.style.display=""}$n.prototype.update=function(){return{bottom:0,right:0}},$n.prototype.setScrollLeft=function(){},$n.prototype.setScrollTop=function(){},$n.prototype.clear=function(){};var zn={native:Wn,null:$n};function Yn(r){r.display.scrollbars&&(r.display.scrollbars.clear(),r.display.scrollbars.addClass)&&Q(r.display.wrapper,r.display.scrollbars.addClass),r.display.scrollbars=new zn[r.options.scrollbarStyle](function(e){r.display.wrapper.insertBefore(e,r.display.scrollbarFiller),S(e,"mousedown",function(){r.state.focused&&setTimeout(function(){return r.display.input.focus()},0)}),e.setAttribute("cm-not-content","true")},function(e,t){("horizontal"==t?Un:Fn)(r,e)},r),r.display.scrollbars.addClass&&ne(r.display.wrapper,r.display.scrollbars.addClass)}var Gn=0;function qn(e){e.curOp={cm:e,viewChanged:!1,startHeight:e.doc.height,forceUpdate:!1,updateInput:0,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++Gn,markArrays:null},e=e.curOp,mr?mr.ops.push(e):e.ownsGroup=mr={ops:[e],delayedCallbacks:[]}}function Kn(e){e=e.curOp;if(e){var t=function(e){for(var t=0;t<e.ops.length;t++)e.ops[t].cm.curOp=null;for(var r=e.ops,n=0;n<r.length;n++){s=o=i=void 0;var i=r[n],o=i.cm,s=o.display;(function(e){var t=e.display;!t.scrollbarsClipped&&t.scroller.offsetWidth&&(t.nativeBarWidth=t.scroller.offsetWidth-t.scroller.clientWidth,t.heightForcer.style.height=Ir(e)+"px",t.sizer.style.marginBottom=-t.nativeBarWidth+"px",t.sizer.style.borderRightWidth=Ir(e)+"px",t.scrollbarsClipped=!0)})(o),i.updateMaxLine&&or(o),i.mustUpdate=i.viewChanged||i.forceUpdate||null!=i.scrollTop||i.scrollToPos&&(i.scrollToPos.from.line<s.viewFrom||i.scrollToPos.to.line>=s.viewTo)||s.maxLineChanged&&o.options.lineWrapping,i.update=i.mustUpdate&&new Zn(o,i.mustUpdate&&{top:i.scrollTop,ensure:i.scrollToPos},i.forceUpdate)}for(var a=0;a<r.length;a++){l=void 0;var l=r[a];l.updatedDisplay=l.mustUpdate&&Qn(l.cm,l.update)}for(var c=0;c<r.length;c++){u=void 0;d=void 0;h=void 0;var u=r[c];var d=u.cm,h=d.display;u.updatedDisplay&&An(d);u.barMeasure=Vn(d),h.maxLineChanged&&!d.options.lineWrapping&&(u.adjustWidthTo=Pr(d,h.maxLine,h.maxLine.text.length).left+3,d.display.sizerWidth=u.adjustWidthTo,u.barMeasure.scrollWidth=Math.max(h.scroller.clientWidth,h.sizer.offsetLeft+u.adjustWidthTo+Ir(d)+d.display.barWidth),u.maxScrollLeft=Math.max(0,h.sizer.offsetLeft+u.adjustWidthTo-Mr(d)));(u.updatedDisplay||u.selectionChanged)&&(u.preparedSelection=h.input.prepareSelection())}for(var p=0;p<r.length;p++){f=void 0;g=void 0;m=void 0;var f=r[p];var g=f.cm;null!=f.adjustWidthTo&&(g.display.sizer.style.minWidth=f.adjustWidthTo+"px",f.maxScrollLeft<g.doc.scrollLeft&&Un(g,Math.min(g.display.scroller.scrollLeft,f.maxScrollLeft),!0),g.display.maxLineChanged=!1);var m=f.focus&&f.focus==A(ae(g));f.preparedSelection&&g.display.input.showSelection(f.preparedSelection,m);!f.updatedDisplay&&f.startHeight==g.doc.height||Bn(g,f.barMeasure);f.updatedDisplay&&ni(g,f.barMeasure);f.selectionChanged&&Tn(g);g.state.focused&&f.updateInput&&g.display.input.reset(f.typing);m&&Sn(f.cm)}for(var y,v=0;v<r.length;v++){b=void 0;w=void 0;C=void 0;E=void 0;y=void 0;T=void 0;S=void 0;_=void 0;x=void 0;var b=r[v];var w=b.cm,C=w.display,E=w.doc;b.updatedDisplay&&ei(w,b.update);null==C.wheelStartX||null==b.scrollTop&&null==b.scrollLeft&&!b.scrollToPos||(C.wheelStartX=C.wheelStartY=null);null!=b.scrollTop&&Hn(w,b.scrollTop,b.forceScroll);null!=b.scrollLeft&&Un(w,b.scrollLeft,!0,!0);b.scrollToPos&&(y=function(e,t,r,n){null==n&&(n=0),e.options.lineWrapping||t!=r||(r="before"==t.sticky?k(t.line,t.ch+1,"before"):t,t=t.ch?k(t.line,"before"==t.sticky?t.ch-1:t.ch,"after"):t);for(var i=0;i<5;i++){var o,s=!1,a=Jr(e,t),l=r&&r!=t?Jr(e,r):a,a=In(e,o={left:Math.min(a.left,l.left),top:Math.min(a.top,l.top)-n,right:Math.max(a.left,l.left),bottom:Math.max(a.bottom,l.bottom)+n}),l=e.doc.scrollTop,c=e.doc.scrollLeft;if(null!=a.scrollTop&&(Fn(e,a.scrollTop),1<Math.abs(e.doc.scrollTop-l))&&(s=!0),!(s=null!=a.scrollLeft&&(Un(e,a.scrollLeft),1<Math.abs(e.doc.scrollLeft-c))?!0:s))break}return o}(w,P(E,b.scrollToPos.from),P(E,b.scrollToPos.to),b.scrollToPos.margin),function(e,t){var r,n,i,o;O(e,"scrollCursorIntoView")||(o=(r=e.display).sizer.getBoundingClientRect(),n=null,i=r.wrapper.ownerDocument,t.top+o.top<0?n=!0:t.bottom+o.top>(i.defaultView.innerHeight||i.documentElement.clientHeight)&&(n=!1),null==n)||Y||(o=R("div","​",null,"position: absolute;\n                         top: "+(t.top-r.viewOffset-Ar(e.display))+"px;\n                         height: "+(t.bottom-t.top+Ir(e)+r.barHeight)+"px;\n                         left: "+t.left+"px; width: "+Math.max(2,t.right-t.left)+"px;"),e.display.lineSpace.appendChild(o),o.scrollIntoView(n),e.display.lineSpace.removeChild(o))}(w,y));var T=b.maybeHiddenMarkers,S=b.maybeUnhiddenMarkers;if(T)for(var _=0;_<T.length;++_)T[_].lines.length||N(T[_],"hide");if(S)for(var x=0;x<S.length;++x)S[x].lines.length&&N(S[x],"unhide");C.wrapper.offsetHeight&&(E.scrollTop=w.display.scroller.scrollTop);b.changeObjs&&N(w,"changes",w,b.changeObjs);b.update&&b.update.finish()}};if(e=e.ownsGroup)try{var r=e,n=r.delayedCallbacks,i=0;do{for(;i<n.length;i++)n[i].call(null);for(var o=0;o<r.ops.length;o++){var s=r.ops[o];if(s.cursorActivityHandlers)for(;s.cursorActivityCalled<s.cursorActivityHandlers.length;)s.cursorActivityHandlers[s.cursorActivityCalled++].call(null,s.cm)}}while(i<n.length)}finally{mr=null,t(e)}}}function d(e,t){if(e.curOp)return t();qn(e);try{return t()}finally{Kn(e)}}function F(e,t){return function(){if(e.curOp)return t.apply(e,arguments);qn(e);try{return t.apply(e,arguments)}finally{Kn(e)}}}function r(e){return function(){if(this.curOp)return e.apply(this,arguments);qn(this);try{return e.apply(this,arguments)}finally{Kn(this)}}}function n(t){return function(){var e=this.cm;if(!e||e.curOp)return t.apply(this,arguments);qn(e);try{return t.apply(this,arguments)}finally{Kn(e)}}}function Xn(e,t){e.doc.highlightFrontier<e.display.viewTo&&e.state.highlight.set(t,ce(Jn,e))}function Jn(s){var a,l,c,u=s.doc;u.highlightFrontier>=s.display.viewTo||(a=+new Date+s.options.workTime,l=Ot(s,u.highlightFrontier),c=[],u.iter(l.line,Math.min(u.first+u.size,s.display.viewTo+500),function(e){if(l.line>=s.display.viewFrom){for(var t=e.styles,r=e.text.length>s.options.maxHighlightLength?dt(u.mode,l.state):null,n=At(s,e,l,!0),r=(r&&(l.state=r),e.styles=n.styles,e.styleClasses),n=n.classes,i=(n?e.styleClasses=n:r&&(e.styleClasses=null),!t||t.length!=e.styles.length||r!=n&&(!r||!n||r.bgClass!=n.bgClass||r.textClass!=n.textClass)),o=0;!i&&o<t.length;++o)i=t[o]!=e.styles[o];i&&c.push(l.line),e.stateAfter=l.save()}else e.text.length<=s.options.maxHighlightLength&&It(s,e.text,l),e.stateAfter=l.line%5==0?l.save():null;if(l.nextLine(),+new Date>a)return Xn(s,s.options.workDelay),!0}),u.highlightFrontier=l.line,u.modeFrontier=Math.max(u.modeFrontier,l.line),c.length&&d(s,function(){for(var e=0;e<c.length;e++)gn(s,c[e],"text")}))}var Zn=function(e,t,r){var n=e.display;this.viewport=t,this.visible=On(n,e.doc,t),this.editorIsHidden=!n.wrapper.offsetWidth,this.wrapperHeight=n.wrapper.clientHeight,this.wrapperWidth=n.wrapper.clientWidth,this.oldDisplayWidth=Mr(e),this.force=r,this.dims=cn(e),this.events=[]};function Qn(e,t){var r=e.display,n=e.doc;if(t.editorIsHidden)return mn(e),!1;if(!t.force&&t.visible.from>=r.viewFrom&&t.visible.to<=r.viewTo&&(null==r.updateLineNumbers||r.updateLineNumbers>=r.viewTo)&&r.renderedView==r.view&&0==vn(e))return!1;oi(e)&&(mn(e),t.dims=cn(e));var i=n.first+n.size,o=Math.max(t.visible.from-e.options.viewportMargin,n.first),s=Math.min(i,t.visible.to+e.options.viewportMargin),n=(r.viewFrom<o&&o-r.viewFrom<20&&(o=Math.max(n.first,r.viewFrom)),r.viewTo>s&&r.viewTo-s<20&&(s=Math.min(i,r.viewTo)),Ut&&(o=er(e.doc,o),s=tr(e.doc,s)),o!=r.viewFrom||s!=r.viewTo||r.lastWrapHeight!=t.wrapperHeight||r.lastWrapWidth!=t.wrapperWidth),i=(i=o,o=s,0==(a=(s=e).display).view.length||i>=a.viewTo||o<=a.viewFrom?(a.view=gr(s,i,o),a.viewFrom=i):(a.viewFrom>i?a.view=gr(s,i,a.viewFrom).concat(a.view):a.viewFrom<i&&(a.view=a.view.slice(fn(s,i))),a.viewFrom=i,a.viewTo<o?a.view=a.view.concat(gr(s,a.viewTo,o)):a.viewTo>o&&(a.view=a.view.slice(0,fn(s,o)))),a.viewTo=o,r.viewOffset=nr(I(e.doc,r.viewFrom)),e.display.mover.style.top=r.viewOffset+"px",vn(e));if(!n&&0==i&&!t.force&&r.renderedView==r.view&&(null==r.updateLineNumbers||r.updateLineNumbers>=r.viewTo))return!1;var a,s=!(s=e).hasFocus()&&(a=A(ae(s)))&&re(s.display.lineDiv,a)?(a={activeElt:a},window.getSelection&&(o=le(s).getSelection()).anchorNode&&o.extend&&re(s.display.lineDiv,o.anchorNode)&&(a.anchorNode=o.anchorNode,a.anchorOffset=o.anchorOffset,a.focusNode=o.focusNode,a.focusOffset=o.focusOffset),a):null,l=(4<i&&(r.lineDiv.style.display="none"),e),c=r.updateLineNumbers,u=t.dims,o=l.display,d=l.options.lineNumbers,h=o.lineDiv,p=h.firstChild;function f(e){var t=e.nextSibling;return C&&E&&l.display.currentWheelTarget==e?e.style.display="none":e.parentNode.removeChild(e),t}for(var g=o.view,m=o.viewFrom,y=0;y<g.length;y++){var v=g[y];if(!v.hidden)if(v.node&&v.node.parentNode==h){for(;p!=v.node;)p=f(p);var b=d&&null!=c&&c<=m&&v.lineNumber;v.changes&&(-1<T(v.changes,"gutter")&&(b=!1),br(l,v,m,u)),b&&(ee(v.lineNumber),v.lineNumber.appendChild(document.createTextNode(bt(l.options,m)))),p=v.node.nextSibling}else{b=function(e,t,r,n){var i=Cr(e,t);return t.text=t.node=i.pre,i.bgClass&&(t.bgClass=i.bgClass),i.textClass&&(t.textClass=i.textClass),Er(e,t),Tr(e,t,r,n),Sr(e,t,n),t.node}(l,v,m,u);h.insertBefore(b,p)}m+=v.size}for(;p;)p=f(p);return 4<i&&(r.lineDiv.style.display=""),r.renderedView=r.view,(a=s)&&a.activeElt&&a.activeElt!=A(a.activeElt.ownerDocument)&&(a.activeElt.focus(),!/^(INPUT|TEXTAREA)$/.test(a.activeElt.nodeName))&&a.anchorNode&&re(document.body,a.anchorNode)&&re(document.body,a.focusNode)&&(i=(o=a.activeElt.ownerDocument).defaultView.getSelection(),(o=o.createRange()).setEnd(a.anchorNode,a.anchorOffset),o.collapse(!1),i.removeAllRanges(),i.addRange(o),i.extend(a.focusNode,a.focusOffset)),ee(r.cursorDiv),ee(r.selectionDiv),r.gutters.style.height=r.sizer.style.minHeight=0,n&&(r.lastWrapHeight=t.wrapperHeight,r.lastWrapWidth=t.wrapperWidth,Xn(e,400)),!(r.updateLineNumbers=null)}function ei(e,t){for(var r=t.viewport,n=!0;;n=!1){if(n&&e.options.lineWrapping&&t.oldDisplayWidth!=Mr(e))n&&(t.visible=On(e.display,e.doc,r));else if(r&&null!=r.top&&(r={top:Math.min(e.doc.height+Nr(e.display)-kr(e),r.top)}),t.visible=On(e.display,e.doc,r),t.visible.from>=e.display.viewFrom&&t.visible.to<=e.display.viewTo)break;if(!Qn(e,t))break;An(e);var i=Vn(e);bn(e),Bn(e,i),ni(e,i),t.force=!1}t.signal(e,"update",e),e.display.viewFrom==e.display.reportedViewFrom&&e.display.viewTo==e.display.reportedViewTo||(t.signal(e,"viewportChange",e,e.display.viewFrom,e.display.viewTo),e.display.reportedViewFrom=e.display.viewFrom,e.display.reportedViewTo=e.display.viewTo)}function ti(e,t){var r,t=new Zn(e,t);Qn(e,t)&&(An(e),ei(e,t),r=Vn(e),bn(e),Bn(e,r),ni(e,r),t.finish())}function ri(e){var t=e.gutters.offsetWidth;e.sizer.style.marginLeft=t+"px",b(e,"gutterChanged",e)}function ni(e,t){e.display.sizer.style.minHeight=t.docHeight+"px",e.display.heightForcer.style.top=t.docHeight+"px",e.display.gutters.style.height=t.docHeight+e.display.barHeight+Ir(e)+"px"}function ii(e){var t=e.display,r=t.view;if(t.alignWidgets||t.gutters.firstChild&&e.options.fixedGutter){for(var n=un(t)-t.scroller.scrollLeft+e.doc.scrollLeft,i=t.gutters.offsetWidth,o=n+"px",s=0;s<r.length;s++)if(!r[s].hidden){e.options.fixedGutter&&(r[s].gutter&&(r[s].gutter.style.left=o),r[s].gutterBackground)&&(r[s].gutterBackground.style.left=o);var a=r[s].alignable;if(a)for(var l=0;l<a.length;l++)a[l].style.left=o}e.options.fixedGutter&&(t.gutters.style.left=n+i+"px")}}function oi(e){var t,r,n,i;if(e.options.lineNumbers)return t=e.doc,t=bt(e.options,t.first+t.size-1),r=e.display,t.length!=r.lineNumChars?(n=(i=r.measure.appendChild(R("div",[R("div",t)],"CodeMirror-linenumber CodeMirror-gutter-elt"))).firstChild.offsetWidth,i=i.offsetWidth-n,r.lineGutter.style.width="",r.lineNumInnerWidth=Math.max(n,r.lineGutter.offsetWidth-i)+1,r.lineNumWidth=r.lineNumInnerWidth+i,r.lineNumChars=r.lineNumInnerWidth?t.length:-1,r.lineGutter.style.width=r.lineNumWidth+"px",ri(e.display),1):void 0}function si(e,t){for(var r=[],n=!1,i=0;i<e.length;i++){var o=e[i],s=null;if("string"!=typeof o&&(s=o.style,o=o.className),"CodeMirror-linenumbers"==o){if(!t)continue;n=!0}r.push({className:o,style:s})}return t&&!n&&r.push({className:"CodeMirror-linenumbers",style:null}),r}function ai(e){var t=e.gutters,r=e.gutterSpecs;ee(t),e.lineGutter=null;for(var n=0;n<r.length;++n){var i=r[n],o=i.className,i=i.style,s=t.appendChild(R("div",null,"CodeMirror-gutter "+o));i&&(s.style.cssText=i),"CodeMirror-linenumbers"==o&&((e.lineGutter=s).style.width=(e.lineNumWidth||1)+"px")}t.style.display=r.length?"":"none",ri(e)}function li(e){ai(e.display),L(e),ii(e)}function ci(e,t,r,n){var i=this,o=(this.input=r,i.scrollbarFiller=R("div",null,"CodeMirror-scrollbar-filler"),i.scrollbarFiller.setAttribute("cm-not-content","true"),i.gutterFiller=R("div",null,"CodeMirror-gutter-filler"),i.gutterFiller.setAttribute("cm-not-content","true"),i.lineDiv=te("div",null,"CodeMirror-code"),i.selectionDiv=R("div",null,null,"position: relative; z-index: 1"),i.cursorDiv=R("div",null,"CodeMirror-cursors"),i.measure=R("div",null,"CodeMirror-measure"),i.lineMeasure=R("div",null,"CodeMirror-measure"),i.lineSpace=te("div",[i.measure,i.lineMeasure,i.selectionDiv,i.cursorDiv,i.lineDiv],null,"position: relative; outline: none"),te("div",[i.lineSpace],"CodeMirror-lines"));i.mover=R("div",[o],null,"position: relative"),i.sizer=R("div",[i.mover],"CodeMirror-sizer"),i.sizerWidth=null,i.heightForcer=R("div",null,null,"position: absolute; height: "+pe+"px; width: 1px;"),i.gutters=R("div",null,"CodeMirror-gutters"),i.lineGutter=null,i.scroller=R("div",[i.sizer,i.heightForcer,i.gutters],"CodeMirror-scroll"),i.scroller.setAttribute("tabIndex","-1"),i.wrapper=R("div",[i.scrollbarFiller,i.gutterFiller,i.scroller],"CodeMirror"),i.wrapper.setAttribute("translate","no"),w&&y<8&&(i.gutters.style.zIndex=-1,i.scroller.style.paddingRight=0),C||m&&q||(i.scroller.draggable=!0),e&&(e.appendChild?e.appendChild(i.wrapper):e(i.wrapper)),i.viewFrom=i.viewTo=t.first,i.reportedViewFrom=i.reportedViewTo=t.first,i.view=[],i.renderedView=null,i.externalMeasured=null,i.viewOffset=0,i.lastWrapHeight=i.lastWrapWidth=0,i.updateLineNumbers=null,i.nativeBarWidth=i.barHeight=i.barWidth=0,i.scrollbarsClipped=!1,i.lineNumWidth=i.lineNumInnerWidth=i.lineNumChars=null,i.alignWidgets=!1,i.cachedCharWidth=i.cachedTextHeight=i.cachedPaddingH=null,i.maxLine=null,i.maxLineLength=0,i.maxLineChanged=!1,i.wheelDX=i.wheelDY=i.wheelStartX=i.wheelStartY=null,i.shift=!1,i.selForContextMenu=null,i.activeTouch=null,i.gutterSpecs=si(n.gutters,n.lineNumbers),ai(i),r.init(i)}Zn.prototype.signal=function(e,t){ze(e,t)&&this.events.push(arguments)},Zn.prototype.finish=function(){for(var e=0;e<this.events.length;e++)N.apply(null,this.events[e])};var ui=0,di=null;function hi(e){var t=e.wheelDeltaX,r=e.wheelDeltaY;return null==t&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(t=e.detail),null==r&&e.detail&&e.axis==e.VERTICAL_AXIS?r=e.detail:null==r&&(r=e.wheelDelta),{x:t,y:r}}function pi(e){e=hi(e);return e.x*=di,e.y*=di,e}function fi(e,t){$&&102==B&&(null==e.display.chromeScrollHack?e.display.sizer.style.pointerEvents="none":clearTimeout(e.display.chromeScrollHack),e.display.chromeScrollHack=setTimeout(function(){e.display.chromeScrollHack=null,e.display.sizer.style.pointerEvents=""},100));var r,n,i=hi(t),o=i.x,i=i.y,s=di,a=(0===t.deltaMode&&(o=t.deltaX,i=t.deltaY,s=1),e.display),l=a.scroller,c=l.scrollWidth>l.clientWidth,u=l.scrollHeight>l.clientHeight;if(o&&c||i&&u){if(i&&E&&C)e:for(var d=t.target,h=a.view;d!=l;d=d.parentNode)for(var p=0;p<h.length;p++)if(h[p].node==d){e.display.currentWheelTarget=d;break e}!o||m||j||null==s?(i&&null!=s&&(n=(c=e.doc.scrollTop)+a.wrapper.clientHeight,(r=i*s)<0?c=Math.max(0,c+r-50):n=Math.min(e.doc.height,n+r+50),ti(e,{top:c,bottom:n})),ui<20&&0!==t.deltaMode&&(null==a.wheelStartX?(a.wheelStartX=l.scrollLeft,a.wheelStartY=l.scrollTop,a.wheelDX=o,a.wheelDY=i,setTimeout(function(){var e,t;null!=a.wheelStartX&&(e=l.scrollLeft-a.wheelStartX,t=(t=l.scrollTop-a.wheelStartY)&&a.wheelDY&&t/a.wheelDY||e&&a.wheelDX&&e/a.wheelDX,a.wheelStartX=a.wheelStartY=null,t)&&(di=(di*ui+t)/(ui+1),++ui)},200)):(a.wheelDX+=o,a.wheelDY+=i))):(i&&u&&Fn(e,Math.max(0,l.scrollTop+i*s)),Un(e,Math.max(0,l.scrollLeft+o*s)),i&&!u||x(t),a.wheelStartX=null)}}w?di=-.53:m?di=15:$?di=-.7:z&&(di=-1/3);var U=function(e,t){this.ranges=e,this.primIndex=t},V=(U.prototype.primary=function(){return this.ranges[this.primIndex]},U.prototype.equals=function(e){if(e!=this){if(e.primIndex!=this.primIndex||e.ranges.length!=this.ranges.length)return!1;for(var t=0;t<this.ranges.length;t++){var r=this.ranges[t],n=e.ranges[t];if(!wt(r.anchor,n.anchor)||!wt(r.head,n.head))return!1}}return!0},U.prototype.deepCopy=function(){for(var e=[],t=0;t<this.ranges.length;t++)e[t]=new V(Ct(this.ranges[t].anchor),Ct(this.ranges[t].head));return new U(e,this.primIndex)},U.prototype.somethingSelected=function(){for(var e=0;e<this.ranges.length;e++)if(!this.ranges[e].empty())return!0;return!1},U.prototype.contains=function(e,t){t=t||e;for(var r=0;r<this.ranges.length;r++){var n=this.ranges[r];if(0<=D(t,n.from())&&D(e,n.to())<=0)return r}return-1},function(e,t){this.anchor=e,this.head=t});function gi(e,t,r){var n=e&&e.options.selectionsMayTouch,e=t[r];t.sort(function(e,t){return D(e.from(),t.from())}),r=T(t,e);for(var i=1;i<t.length;i++){var o,s=t[i],a=t[i-1],l=D(a.to(),s.from());(n&&!s.empty()?0<l:0<=l)&&(l=Tt(a.from(),s.from()),o=Et(a.to(),s.to()),s=a.empty()?s.from()==s.head:a.from()==a.head,i<=r&&--r,t.splice(--i,2,new V(s?o:l,s?l:o)))}return new U(t,r)}function mi(e,t){return new U([new V(e,t||e)],0)}function yi(e){return e.text?k(e.from.line+e.text.length-1,H(e.text).length+(1==e.text.length?e.from.ch:0)):e.to}function vi(e,t){var r,n;return D(e,t.from)<0?e:D(e,t.to)<=0?yi(t):(r=e.line+t.text.length-(t.to.line-t.from.line)-1,n=e.ch,e.line==t.to.line&&(n+=yi(t).ch-t.to.ch),k(r,n))}function bi(e,t){for(var r=[],n=0;n<e.sel.ranges.length;n++){var i=e.sel.ranges[n];r.push(new V(vi(i.anchor,t),vi(i.head,t)))}return gi(e.cm,r,e.sel.primIndex)}function wi(e,t,r){return e.line==t.line?k(r.line,e.ch-t.ch+r.ch):k(r.line+(e.line-t.line),e.ch)}function Ci(e){e.doc.mode=lt(e.options,e.doc.modeOption),Ei(e)}function Ei(e){e.doc.iter(function(e){e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null)}),e.doc.modeFrontier=e.doc.highlightFrontier=e.doc.first,Xn(e,100),e.state.modeGen++,e.curOp&&L(e)}function Ti(e,t){return 0==t.from.ch&&0==t.to.ch&&""==H(t.text)&&(!e.cm||e.cm.options.wholeLineUpdateBefore)}function Si(e,o,t,s){function i(e){return t?t[e]:null}function r(e,t,r){var n,i;t=t,r=r,i=s,(n=e).text=t,n.stateAfter&&(n.stateAfter=null),n.styles&&(n.styles=null),null!=n.order&&(n.order=null),jt(n),zt(n,r),(t=i?i(n):1)!=n.height&&mt(n,t),b(e,"change",e,o)}function n(e,t){for(var r=[],n=e;n<t;++n)r.push(new sr(u[n],i(n),s));return r}var a,l=o.from,c=o.to,u=o.text,d=I(e,l.line),h=I(e,c.line),p=H(u),f=i(u.length-1),g=c.line-l.line;o.full?(e.insert(0,n(0,u.length)),e.remove(u.length,e.size-u.length)):Ti(e,o)?(a=n(0,u.length-1),r(h,h.text,f),g&&e.remove(l.line,g),a.length&&e.insert(l.line,a)):d==h?1==u.length?r(d,d.text.slice(0,l.ch)+p+d.text.slice(c.ch),f):((a=n(1,u.length-1)).push(new sr(p+d.text.slice(c.ch),f,s)),r(d,d.text.slice(0,l.ch)+u[0],i(0)),e.insert(l.line+1,a)):1==u.length?(r(d,d.text.slice(0,l.ch)+u[0]+h.text.slice(c.ch),i(0)),e.remove(l.line+1,g)):(r(d,d.text.slice(0,l.ch)+u[0],i(0)),r(h,p+h.text.slice(c.ch),f),a=n(1,u.length-1),1<g&&e.remove(l.line+1,g-1),e.insert(l.line+1,a)),b(e,"change",e,o)}function _i(e,a,l){!function e(t,r,n){if(t.linked)for(var i=0;i<t.linked.length;++i){var o,s=t.linked[i];s.doc!=r&&(o=n&&s.sharedHist,!l||o)&&(a(s.doc,o),e(s.doc,t,o))}}(e,null,!0)}function xi(e,t){if(t.cm)throw new Error("This document is already in use.");hn((e.doc=t).cm=e),Ci(e),Ri(e),e.options.direction=t.direction,e.options.lineWrapping||or(e),e.options.mode=t.modeOption,L(e)}function Ri(e){("rtl"==e.doc.direction?ne:Q)(e.display.lineDiv,"CodeMirror-rtl")}function Ai(e){this.done=[],this.undone=[],this.undoDepth=e?e.undoDepth:1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=e?e.maxGeneration:1}function Ni(e,t){var r={from:Ct(t.from),to:yi(t),text:ft(e,t.from,t.to)};return Di(e,r,t.from.line,t.to.line+1),_i(e,function(e){return Di(e,r,t.from.line,t.to.line+1)},!0),r}function Oi(e){for(;e.length;){if(!H(e).ranges)break;e.pop()}}function Ii(e,t,r,n){var i,o,s=e.history,a=(s.undone.length=0,+new Date);if((s.lastOp==n||s.lastOrigin==t.origin&&t.origin&&("+"==t.origin.charAt(0)&&s.lastModTime>a-(e.cm?e.cm.options.historyEventDelay:500)||"*"==t.origin.charAt(0)))&&(o=(o=s).lastOp==n?(Oi(o.done),H(o.done)):o.done.length&&!H(o.done).ranges?H(o.done):1<o.done.length&&!o.done[o.done.length-2].ranges?(o.done.pop(),H(o.done)):void 0))i=H(o.changes),0==D(t.from,t.to)&&0==D(t.from,i.to)?i.to=yi(t):o.changes.push(Ni(e,t));else{var l=H(s.done);for(l&&l.ranges||ki(e.sel,s.done),o={changes:[Ni(e,t)],generation:s.generation},s.done.push(o);s.done.length>s.undoDepth;)s.done.shift(),s.done[0].ranges||s.done.shift()}s.done.push(r),s.generation=++s.maxGeneration,s.lastModTime=s.lastSelTime=a,s.lastOp=s.lastSelOp=n,s.lastOrigin=s.lastSelOrigin=t.origin,i||N(e,"historyAdded")}function Mi(e,t,r,n){var i,o,s,a=e.history,l=n&&n.origin;r==a.lastSelOp||l&&a.lastSelOrigin==l&&(a.lastModTime==a.lastSelTime&&a.lastOrigin==l||(e=e,i=l,o=H(a.done),s=t,"*"==(i=i.charAt(0)))||"+"==i&&o.ranges.length==s.ranges.length&&o.somethingSelected()==s.somethingSelected()&&new Date-e.history.lastSelTime<=(e.cm?e.cm.options.historyEventDelay:500))?a.done[a.done.length-1]=t:ki(t,a.done),a.lastSelTime=+new Date,a.lastSelOrigin=l,a.lastSelOp=r,n&&!1!==n.clearRedo&&Oi(a.undone)}function ki(e,t){var r=H(t);r&&r.ranges&&r.equals(e)||t.push(e)}function Di(t,r,e,n){var i=r["spans_"+t.id],o=0;t.iter(Math.max(t.first,e),Math.min(t.first+t.size,n),function(e){e.markedSpans&&((i=i||(r["spans_"+t.id]={}))[o]=e.markedSpans),++o})}function Pi(e,t){var r=t["spans_"+e.id];if(!r)return null;for(var n=[],i=0;i<t.text.length;++i)n.push(function(e){if(!e)return null;for(var t,r=0;r<e.length;++r)e[r].marker.explicitlyCleared?t=t||e.slice(0,r):t&&t.push(e[r]);return t?t.length?t:null:e}(r[i]));return n}function Li(e,t){var r=Pi(e,t),n=$t(e,t);if(!r)return n;if(n)for(var i=0;i<r.length;++i){var o=r[i],s=n[i];if(o&&s)e:for(var a=0;a<s.length;++a){for(var l=s[a],c=0;c<o.length;++c)if(o[c].marker==l.marker)continue e;o.push(l)}else s&&(r[i]=s)}return r}function Fi(e,t,r){for(var n=[],i=0;i<e.length;++i){var o=e[i];if(o.ranges)n.push(r?U.prototype.deepCopy.call(o):o);else{var s=o.changes,a=[];n.push({changes:a});for(var l=0;l<s.length;++l){var c,u=s[l];if(a.push({from:u.from,to:u.to,text:u.text}),t)for(var d in u)(c=d.match(/^spans_(\d+)$/))&&-1<T(t,Number(c[1]))&&(H(a)[d]=u[d],delete u[d])}}}return n}function Hi(e,t,r,n){return n?(n=e.anchor,r&&((e=D(t,n)<0)!=D(r,n)<0?(n=t,t=r):e!=D(t,r)<0&&(t=r)),new V(n,t)):new V(r||t,t)}function Ui(e,t,r,n,i){null==i&&(i=e.cm&&(e.cm.display.shift||e.extend)),W(e,new U([Hi(e.sel.primary(),t,r,i)],0),n)}function Vi(e,t,r){for(var n=[],i=e.cm&&(e.cm.display.shift||e.extend),o=0;o<e.sel.ranges.length;o++)n[o]=Hi(e.sel.ranges[o],t[o],null,i);W(e,gi(e.cm,n,e.sel.primIndex),r)}function Wi(e,t,r,n){var i=e.sel.ranges.slice(0);i[t]=r,W(e,gi(e.cm,i,e.sel.primIndex),n)}function $i(e,t,r,n){W(e,mi(t,r),n)}function Bi(e,t,r){var n=e.history.done,i=H(n);i&&i.ranges?ji(e,n[n.length-1]=t,r):W(e,t,r)}function W(e,t,r){ji(e,t,r),Mi(e,e.sel,e.cm?e.cm.curOp.id:NaN,r)}function ji(e,t,r){(ze(e,"beforeSelectionChange")||e.cm&&ze(e.cm,"beforeSelectionChange"))&&(n=e,o=r,o={ranges:(i=t).ranges,update:function(e){this.ranges=[];for(var t=0;t<e.length;t++)this.ranges[t]=new V(P(n,e[t].anchor),P(n,e[t].head))},origin:o&&o.origin},N(n,"beforeSelectionChange",n,o),n.cm&&N(n.cm,"beforeSelectionChange",n.cm,o),t=o.ranges!=i.ranges?gi(n.cm,o.ranges,o.ranges.length-1):i);var n,i,o=r&&r.bias||(D(t.primary().head,e.sel.primary().head)<0?-1:1);zi(e,Gi(e,t,o,!0)),r&&!1===r.scroll||!e.cm||"nocursor"==e.cm.getOption("readOnly")||kn(e.cm)}function zi(e,t){t.equals(e.sel)||(e.sel=t,e.cm&&(e.cm.curOp.updateInput=1,e.cm.curOp.selectionChanged=!0,je(e.cm)),b(e,"cursorActivity",e))}function Yi(e){zi(e,Gi(e,e.sel,null,!1))}function Gi(e,t,r,n){for(var i,o=0;o<t.ranges.length;o++){var s=t.ranges[o],a=t.ranges.length==e.sel.ranges.length&&e.sel.ranges[o],l=Ki(e,s.anchor,a&&a.anchor,r,n),a=s.head==s.anchor?l:Ki(e,s.head,a&&a.head,r,n);!i&&l==s.anchor&&a==s.head||((i=i||t.ranges.slice(0,o))[o]=new V(l,a))}return i?gi(e.cm,i,t.primIndex):t}function qi(e,t,r,n,i){var o=I(e,t.line);if(o.markedSpans)for(var s=0;s<o.markedSpans.length;++s){var a=o.markedSpans[s],l=a.marker,c="selectLeft"in l?!l.selectLeft:l.inclusiveLeft,u="selectRight"in l?!l.selectRight:l.inclusiveRight;if((null==a.from||(c?a.from<=t.ch:a.from<t.ch))&&(null==a.to||(u?a.to>=t.ch:a.to>t.ch))){if(i&&(N(l,"beforeCursorEnter"),l.explicitlyCleared)){if(o.markedSpans){--s;continue}break}if(l.atomic){if(r){var a=l.find(n<0?1:-1),d=void 0;if((a=(n<0?u:c)?Xi(e,a,-n,a&&a.line==t.line?o:null):a)&&a.line==t.line&&(d=D(a,r))&&(n<0?d<0:0<d))return qi(e,a,t,n,i)}d=l.find(n<0?-1:1);return(d=(n<0?c:u)?Xi(e,d,n,d.line==t.line?o:null):d)?qi(e,d,t,n,i):null}}}return t}function Ki(e,t,r,n,i){n=n||1,i=qi(e,t,r,n,i)||!i&&qi(e,t,r,n,!0)||qi(e,t,r,-n,i)||!i&&qi(e,t,r,-n,!0);return i||(e.cantEdit=!0,k(e.first,0))}function Xi(e,t,r,n){return r<0&&0==t.ch?t.line>e.first?P(e,k(t.line-1)):null:0<r&&t.ch==(n||I(e,t.line)).text.length?t.line<e.first+e.size-1?k(t.line+1,0):null:new k(t.line,t.ch+r)}function Ji(e){e.setSelection(k(e.firstLine(),0),k(e.lastLine()),ge)}function Zi(i,e,t){var o={canceled:!1,from:e.from,to:e.to,text:e.text,origin:e.origin,cancel:function(){return o.canceled=!0}};return t&&(o.update=function(e,t,r,n){e&&(o.from=P(i,e)),t&&(o.to=P(i,t)),r&&(o.text=r),void 0!==n&&(o.origin=n)}),N(i,"beforeChange",i,o),i.cm&&N(i.cm,"beforeChange",i.cm,o),o.canceled?(i.cm&&(i.cm.curOp.updateInput=2),null):{from:o.from,to:o.to,text:o.text,origin:o.origin}}function Qi(e,t,r){if(e.cm){if(!e.cm.curOp)return F(e.cm,Qi)(e,t,r);if(e.cm.state.suppressEdits)return}if(!(ze(e,"beforeChange")||e.cm&&ze(e.cm,"beforeChange"))||(t=Zi(e,t,!0))){var n=Ht&&!r&&function(e,t,r){var n=null;if(e.iter(t.line,r.line+1,function(e){if(e.markedSpans)for(var t=0;t<e.markedSpans.length;++t){var r=e.markedSpans[t].marker;!r.readOnly||n&&-1!=T(n,r)||(n=n||[]).push(r)}}),!n)return null;for(var i=[{from:t,to:r}],o=0;o<n.length;++o)for(var s=n[o],a=s.find(0),l=0;l<i.length;++l){var c,u,d,h=i[l];D(h.to,a.from)<0||0<D(h.from,a.to)||(c=[l,1],u=D(h.from,a.from),d=D(h.to,a.to),(u<0||!s.inclusiveLeft&&!u)&&c.push({from:h.from,to:a.from}),(0<d||!s.inclusiveRight&&!d)&&c.push({from:a.to,to:h.to}),i.splice.apply(i,c),l+=c.length-3)}return i}(e,t.from,t.to);if(n)for(var i=n.length-1;0<=i;--i)eo(e,{from:n[i].from,to:n[i].to,text:i?[""]:t.text,origin:t.origin});else eo(e,t)}}function eo(e,r){var t,n;1==r.text.length&&""==r.text[0]&&0==D(r.from,r.to)||(t=bi(e,r),Ii(e,r,t,e.cm?e.cm.curOp.id:NaN),no(e,r,t,$t(e,r)),n=[],_i(e,function(e,t){t||-1!=T(n,e.history)||(ao(e.history,r),n.push(e.history)),no(e,r,null,$t(e,r))}))}function to(i,o,e){var t=i.cm&&i.cm.state.suppressEdits;if(!t||e){for(var s,r=i.history,n=i.sel,a="undo"==o?r.done:r.undone,l="undo"==o?r.undone:r.done,c=0;c<a.length&&(s=a[c],e?!s.ranges||s.equals(i.sel):s.ranges);c++);if(c!=a.length){for(r.lastOrigin=r.lastSelOrigin=null;;){if(!(s=a.pop()).ranges){if(t)return void a.push(s);break}if(ki(s,l),e&&!s.equals(i.sel))return void W(i,s,{clearRedo:!1});n=s}for(var u=[],d=(ki(n,l),l.push({changes:u,generation:r.generation}),r.generation=s.generation||++r.maxGeneration,ze(i,"beforeChange")||i.cm&&ze(i.cm,"beforeChange")),h=s.changes.length-1;0<=h;--h){var p=function(e){var r=s.changes[e];if(r.origin=o,d&&!Zi(i,r,!1))return a.length=0,{};u.push(Ni(i,r));var t=e?bi(i,r):H(a),n=(no(i,r,t,Li(i,r)),!e&&i.cm&&i.cm.scrollIntoView({from:r.from,to:yi(r)}),[]);_i(i,function(e,t){t||-1!=T(n,e.history)||(ao(e.history,r),n.push(e.history)),no(e,r,null,Li(e,r))})}(h);if(p)return p.v}}}}function ro(e,t){if(0!=t&&(e.first+=t,e.sel=new U(Ce(e.sel.ranges,function(e){return new V(k(e.anchor.line+t,e.anchor.ch),k(e.head.line+t,e.head.ch))}),e.sel.primIndex),e.cm)){L(e.cm,e.first,e.first-t,t);for(var r=e.cm.display,n=r.viewFrom;n<r.viewTo;n++)gn(e.cm,n,"gutter")}}function no(e,t,r,n){if(e.cm&&!e.cm.curOp)return F(e.cm,no)(e,t,r,n);if(t.to.line<e.first)ro(e,t.text.length-1-(t.to.line-t.from.line));else if(!(t.from.line>e.lastLine())){t.from.line<e.first&&(ro(e,i=t.text.length-1-(e.first-t.from.line)),t={from:k(e.first,0),to:k(t.to.line+i,t.to.ch),text:[H(t.text)],origin:t.origin});var i=e.lastLine();if((t=t.to.line>i?{from:t.from,to:k(i,I(e,i).text.length),text:[t.text[0]],origin:t.origin}:t).removed=ft(e,t.from,t.to),r=r||bi(e,t),e.cm){var i=e.cm,o=t,s=n,a=i.doc,l=i.display,c=o.from,u=o.to,d=!1,h=c.line,p=(i.options.lineWrapping||(h=M(Qt(I(a,c.line))),a.iter(h,u.line+1,function(e){if(e==l.maxLine)return d=!0})),-1<a.sel.contains(o.from,o.to)&&je(i),Si(a,o,s,dn(i)),i.options.lineWrapping||(a.iter(h,c.line+o.text.length,function(e){var t=ir(e);t>l.maxLineLength&&(l.maxLine=e,l.maxLineLength=t,l.maxLineChanged=!0,d=!1)}),d&&(i.curOp.updateMaxLine=!0)),a),f=c.line;if(p.modeFrontier=Math.min(p.modeFrontier,f),!(p.highlightFrontier<f-10)){for(var g=p.first,m=f-1;g<m;m--){var y=I(p,m).stateAfter;if(y&&(!(y instanceof xt)||m+y.lookAhead<f)){g=m+1;break}}p.highlightFrontier=Math.min(p.highlightFrontier,g)}Xn(i,400),s=o.text.length-(u.line-c.line)-1,o.full?L(i):c.line!=u.line||1!=o.text.length||Ti(i.doc,o)?L(i,c.line,u.line+1,s):gn(i,c.line,"text"),h=ze(i,"changes"),((a=ze(i,"change"))||h)&&(s={from:c,to:u,text:o.text,removed:o.removed,origin:o.origin},a&&b(i,"change",i,s),h)&&(i.curOp.changeObjs||(i.curOp.changeObjs=[])).push(s),i.display.selForContextMenu=null}else Si(e,t,n);ji(e,r,ge),e.cantEdit&&Ki(e,k(e.firstLine(),0))&&(e.cantEdit=!1)}}function io(e,t,r,n,i){var o;D(n=n||r,r)<0&&(r=(o=[n,r])[0],n=o[1]),"string"==typeof t&&(t=e.splitLines(t)),Qi(e,{from:r,to:n,text:t,origin:i})}function oo(e,t,r,n){r<e.line?e.line+=n:t<e.line&&(e.line=t,e.ch=0)}function so(e,t,r,n){for(var i=0;i<e.length;++i){var o=e[i],s=!0;if(o.ranges){o.copied||((o=e[i]=o.deepCopy()).copied=!0);for(var a=0;a<o.ranges.length;a++)oo(o.ranges[a].anchor,t,r,n),oo(o.ranges[a].head,t,r,n)}else{for(var l=0;l<o.changes.length;++l){var c=o.changes[l];if(r<c.from.line)c.from=k(c.from.line+n,c.from.ch),c.to=k(c.to.line+n,c.to.ch);else if(t<=c.to.line){s=!1;break}}s||(e.splice(0,i+1),i=0)}}}function ao(e,t){var r=t.from.line,n=t.to.line,t=t.text.length-(n-r)-1;so(e.done,r,n,t),so(e.undone,r,n,t)}function lo(e,t,r,n){var i=t,o=t;return"number"==typeof t?o=I(e,St(e,t)):i=M(t),null==i?null:(n(o,i)&&e.cm&&gn(e.cm,i,r),o)}function co(e){this.lines=e,this.parent=null;for(var t=0,r=0;r<e.length;++r)e[r].parent=this,t+=e[r].height;this.height=t}function uo(e){this.children=e;for(var t=0,r=0,n=0;n<e.length;++n){var i=e[n];t+=i.chunkSize(),r+=i.height,i.parent=this}this.size=t,this.height=r,this.parent=null}V.prototype.from=function(){return Tt(this.anchor,this.head)},V.prototype.to=function(){return Et(this.anchor,this.head)},V.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch},co.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,t){for(var r,n=e,i=e+t;n<i;++n){var o=this.lines[n];this.height-=o.height,(r=o).parent=null,jt(r),b(o,"delete")}this.lines.splice(e,t)},collapse:function(e){e.push.apply(e,this.lines)},insertInner:function(e,t,r){this.height+=r,this.lines=this.lines.slice(0,e).concat(t).concat(this.lines.slice(e));for(var n=0;n<t.length;++n)t[n].parent=this},iterN:function(e,t,r){for(var n=e+t;e<n;++e)if(r(this.lines[e]))return!0}},uo.prototype={chunkSize:function(){return this.size},removeInner:function(e,t){this.size-=t;for(var r,n=0;n<this.children.length;++n){var i=this.children[n],o=i.chunkSize();if(e<o){var s=Math.min(t,o-e),a=i.height;if(i.removeInner(e,s),this.height-=a-i.height,o==s&&(this.children.splice(n--,1),i.parent=null),0==(t-=s))break;e=0}else e-=o}this.size-t<25&&(1<this.children.length||!(this.children[0]instanceof co))&&(this.collapse(r=[]),this.children=[new co(r)],this.children[0].parent=this)},collapse:function(e){for(var t=0;t<this.children.length;++t)this.children[t].collapse(e)},insertInner:function(e,t,r){this.size+=t.length,this.height+=r;for(var n=0;n<this.children.length;++n){var i=this.children[n],o=i.chunkSize();if(e<=o){if(i.insertInner(e,t,r),i.lines&&50<i.lines.length){for(var s=i.lines.length%25+25,a=s;a<i.lines.length;){var l=new co(i.lines.slice(a,a+=25));i.height-=l.height,this.children.splice(++n,0,l),l.parent=this}i.lines=i.lines.slice(0,s),this.maybeSpill()}break}e-=o}},maybeSpill:function(){if(!(this.children.length<=10)){var e=this;do{var t,r=new uo(e.children.splice(e.children.length-5,5))}while(e.parent?(e.size-=r.size,e.height-=r.height,t=T(e.parent.children,e),e.parent.children.splice(t+1,0,r)):(((t=new uo(e.children)).parent=e).children=[t,r],e=t),r.parent=e.parent,10<e.children.length);e.parent.maybeSpill()}},iterN:function(e,t,r){for(var n=0;n<this.children.length;++n){var i=this.children[n],o=i.chunkSize();if(e<o){var s=Math.min(t,o-e);if(i.iterN(e,s,r))return!0;if(0==(t-=s))break;e=0}else e-=o}}};function ho(e,t,r){if(r)for(var n in r)r.hasOwnProperty(n)&&(this[n]=r[n]);this.doc=e,this.node=t}function po(e,t,r){nr(t)<(e.curOp&&e.curOp.scrollTop||e.doc.scrollTop)&&Mn(e,r)}ho.prototype.clear=function(){var e=this.doc.cm,t=this.line.widgets,r=this.line,n=M(r);if(null!=n&&t){for(var i=0;i<t.length;++i)t[i]==this&&t.splice(i--,1);t.length||(r.widgets=null);var o=xr(this);mt(r,Math.max(0,r.height-o)),e&&(d(e,function(){po(e,r,-o),gn(e,n,"widget")}),b(e,"lineWidgetCleared",e,this,n))}},ho.prototype.changed=function(){var e=this,t=this.height,r=this.doc.cm,n=this.line,i=(this.height=null,xr(this)-t);i&&(rr(this.doc,n)||mt(n,n.height+i),r)&&d(r,function(){r.curOp.forceUpdate=!0,po(r,n,i),b(r,"lineWidgetChanged",r,e,M(n))})},Ye(ho);function fo(e,t){this.lines=[],this.type=t,this.doc=e,this.id=++go}var go=0;function mo(n,i,o,e,t){if(e&&e.shared)return p=n,r=i,s=o,l=t,(a=ue(a=e)).shared=!1,c=[mo(p,r,s,a,l)],u=c[0],d=a.widgetNode,_i(p,function(e){d&&(a.widgetNode=d.cloneNode(!0)),c.push(mo(e,P(e,r),P(e,s),a,l));for(var t=0;t<e.linked.length;++t)if(e.linked[t].isParent)return;u=H(c)}),new yo(c,u);var r,s,a,l,c,u,d;if(n.cm&&!n.cm.curOp)return F(n.cm,mo)(n,i,o,e,t);var h=new fo(n,t),p=D(i,o);if(e&&ue(e,h,!1),!(0<p||0==p&&!1!==h.clearWhenEmpty)){if(h.replacedWith&&(h.collapsed=!0,h.widgetNode=te("span",[h.replacedWith],"CodeMirror-widget"),e.handleMouseEvents||h.widgetNode.setAttribute("cm-ignore-events","true"),e.insertLeft)&&(h.widgetNode.insertLeft=!0),h.collapsed){if(Zt(n,i.line,i,o,h)||i.line!=o.line&&Zt(n,o.line,i,o,h))throw new Error("Inserting collapsed marker partially overlapping an existing one");Ut=!0}h.addToHistory&&Ii(n,{from:i,to:o,origin:"markText"},n.sel,NaN);var f,g=i.line,m=n.cm;if(n.iter(g,o.line+1,function(e){var t,r;m&&h.collapsed&&!m.options.lineWrapping&&Qt(e)==m.display.maxLine&&(f=!0),h.collapsed&&g!=i.line&&mt(e,0),e=e,t=new Vt(h,g==i.line?i.ch:null,g==o.line?o.ch:null),(r=(r=n.cm&&n.cm.curOp)&&window.WeakSet&&(r.markedSpans||(r.markedSpans=new WeakSet)))&&e.markedSpans&&r.has(e.markedSpans)?e.markedSpans.push(t):(e.markedSpans=e.markedSpans?e.markedSpans.concat([t]):[t],r&&r.add(e.markedSpans)),t.marker.attachLine(e),++g}),h.collapsed&&n.iter(i.line,o.line+1,function(e){rr(n,e)&&mt(e,0)}),h.clearOnEnter&&S(h,"beforeCursorEnter",function(){return h.clear()}),h.readOnly&&(Ht=!0,n.history.done.length||n.history.undone.length)&&n.clearHistory(),h.collapsed&&(h.id=++go,h.atomic=!0),m){if(f&&(m.curOp.updateMaxLine=!0),h.collapsed)L(m,i.line,o.line+1);else if(h.className||h.startStyle||h.endStyle||h.css||h.attributes||h.title)for(var y=i.line;y<=o.line;y++)gn(m,y,"text");h.atomic&&Yi(m.doc),b(m,"markerAdded",m,h)}}return h}fo.prototype.clear=function(){if(!this.explicitlyCleared){for(var e,t=this.doc.cm,r=t&&!t.curOp,n=(r&&qn(t),ze(this,"clear")&&(e=this.find())&&b(this,"clear",e.from,e.to),null),i=null,o=0;o<this.lines.length;++o){var s=this.lines[o],a=Wt(s.markedSpans,this);t&&!this.collapsed?gn(t,M(s),"text"):t&&(null!=a.to&&(i=M(s)),null!=a.from)&&(n=M(s)),s.markedSpans=function(e,t){for(var r,n=0;n<e.length;++n)e[n]!=t&&(r=r||[]).push(e[n]);return r}(s.markedSpans,a),null==a.from&&this.collapsed&&!rr(this.doc,s)&&t&&mt(s,an(t.display))}if(t&&this.collapsed&&!t.options.lineWrapping)for(var l=0;l<this.lines.length;++l){var c=Qt(this.lines[l]),u=ir(c);u>t.display.maxLineLength&&(t.display.maxLine=c,t.display.maxLineLength=u,t.display.maxLineChanged=!0)}null!=n&&t&&this.collapsed&&L(t,n,i+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,t)&&Yi(t.doc),t&&b(t,"markerCleared",t,this,n,i),r&&Kn(t),this.parent&&this.parent.clear()}},fo.prototype.find=function(e,t){var r,n;null==e&&"bookmark"==this.type&&(e=1);for(var i=0;i<this.lines.length;++i){var o=this.lines[i],s=Wt(o.markedSpans,this);if(null!=s.from&&(r=k(t?o:M(o),s.from),-1==e))return r;if(null!=s.to&&(n=k(t?o:M(o),s.to),1==e))return n}return r&&{from:r,to:n}},fo.prototype.changed=function(){var r=this,n=this.find(-1,!0),i=this,o=this.doc.cm;n&&o&&d(o,function(){var e=n.line,t=M(n.line),t=Lr(o,t);t&&($r(t),o.curOp.selectionChanged=o.curOp.forceUpdate=!0),o.curOp.updateMaxLine=!0,!rr(i.doc,e)&&null!=i.height&&(t=i.height,i.height=null,t=xr(i)-t)&&mt(e,e.height+t),b(o,"markerChanged",o,r)})},fo.prototype.attachLine=function(e){var t;this.lines.length||!this.doc.cm||(t=this.doc.cm.curOp).maybeHiddenMarkers&&-1!=T(t.maybeHiddenMarkers,this)||(t.maybeUnhiddenMarkers||(t.maybeUnhiddenMarkers=[])).push(this),this.lines.push(e)},fo.prototype.detachLine=function(e){this.lines.splice(T(this.lines,e),1),!this.lines.length&&this.doc.cm&&((e=this.doc.cm.curOp).maybeHiddenMarkers||(e.maybeHiddenMarkers=[])).push(this)},Ye(fo);var yo=function(e,t){this.markers=e,this.primary=t;for(var r=0;r<e.length;++r)e[r].parent=this};function vo(e){return e.findMarks(k(e.first,0),e.clipPos(k(e.lastLine())),function(e){return e.parent})}function bo(o){for(var e=0;e<o.length;e++)!function(e){var t=o[e],r=[t.primary.doc];_i(t.primary.doc,function(e){return r.push(e)});for(var n=0;n<t.markers.length;n++){var i=t.markers[n];-1==T(r,i.doc)&&(i.parent=null,t.markers.splice(n--,1))}}(e)}yo.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var e=0;e<this.markers.length;++e)this.markers[e].clear();b(this,"clear")}},yo.prototype.find=function(e,t){return this.primary.find(e,t)},Ye(yo);function p(e,t,r,n,i){if(!(this instanceof p))return new p(e,t,r,n,i);null==r&&(r=0),uo.call(this,[new co([new sr("",null)])]),this.first=r,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,r=k(this.modeFrontier=this.highlightFrontier=r,0),this.sel=mi(r),this.history=new Ai(null),this.id=++wo,this.modeOption=t,this.lineSep=n,this.direction="rtl"==i?"rtl":"ltr",this.extend=!1,"string"==typeof e&&(e=this.splitLines(e)),Si(this,{from:r,to:r,text:e}),W(this,mi(r),ge)}var wo=0,Co=((p.prototype=Te(uo.prototype,{constructor:p,iter:function(e,t,r){r?this.iterN(e-this.first,t-e,r):this.iterN(this.first,this.first+this.size,e)},insert:function(e,t){for(var r=0,n=0;n<t.length;++n)r+=t[n].height;this.insertInner(e-this.first,t,r)},remove:function(e,t){this.removeInner(e-this.first,t)},getValue:function(e){var t=gt(this,this.first,this.first+this.size);return!1===e?t:t.join(e||this.lineSeparator())},setValue:n(function(e){var t=k(this.first,0),r=this.first+this.size-1;Qi(this,{from:t,to:k(r,I(this,r).text.length),text:this.splitLines(e),origin:"setValue",full:!0},!0),this.cm&&Dn(this.cm,0,0),W(this,mi(t),ge)}),replaceRange:function(e,t,r,n){io(this,e,t=P(this,t),r=r?P(this,r):t,n)},getRange:function(e,t,r){e=ft(this,P(this,e),P(this,t));return!1===r?e:""===r?e.join(""):e.join(r||this.lineSeparator())},getLine:function(e){e=this.getLineHandle(e);return e&&e.text},getLineHandle:function(e){if(vt(this,e))return I(this,e)},getLineNumber:M,getLineHandleVisualStart:function(e){return Qt(e="number"==typeof e?I(this,e):e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return P(this,e)},getCursor:function(e){var t=this.sel.primary(),e=null==e||"head"==e?t.head:"anchor"==e?t.anchor:"end"==e||"to"==e||!1===e?t.to():t.from();return e},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:n(function(e,t,r){$i(this,P(this,"number"==typeof e?k(e,t||0):e),null,r)}),setSelection:n(function(e,t,r){$i(this,P(this,e),P(this,t||e),r)}),extendSelection:n(function(e,t,r){Ui(this,P(this,e),t&&P(this,t),r)}),extendSelections:n(function(e,t){Vi(this,_t(this,e),t)}),extendSelectionsBy:n(function(e,t){Vi(this,_t(this,Ce(this.sel.ranges,e)),t)}),setSelections:n(function(e,t,r){if(e.length){for(var n=[],i=0;i<e.length;i++)n[i]=new V(P(this,e[i].anchor),P(this,e[i].head||e[i].anchor));null==t&&(t=Math.min(e.length-1,this.sel.primIndex)),W(this,gi(this.cm,n,t),r)}}),addSelection:n(function(e,t,r){var n=this.sel.ranges.slice(0);n.push(new V(P(this,e),P(this,t||e))),W(this,gi(this.cm,n,n.length-1),r)}),getSelection:function(e){for(var t=this.sel.ranges,r=0;r<t.length;r++)var n=ft(this,t[r].from(),t[r].to()),i=i?i.concat(n):n;return!1===e?i:i.join(e||this.lineSeparator())},getSelections:function(e){for(var t=[],r=this.sel.ranges,n=0;n<r.length;n++){var i=ft(this,r[n].from(),r[n].to());!1!==e&&(i=i.join(e||this.lineSeparator())),t[n]=i}return t},replaceSelection:function(e,t,r){for(var n=[],i=0;i<this.sel.ranges.length;i++)n[i]=e;this.replaceSelections(n,t,r||"+input")},replaceSelections:n(function(e,t,r){for(var n=[],i=this.sel,o=0;o<i.ranges.length;o++){var s=i.ranges[o];n[o]={from:s.from(),to:s.to(),text:this.splitLines(e[o]),origin:r}}for(var t=t&&"end"!=t&&function(e,t,r){for(var n=[],i=c=k(e.first,0),o=0;o<t.length;o++){var s=t[o],a=wi(s.from,c,i),l=wi(yi(s),c,i),c=s.to,i=l;"around"==r?(s=D((s=e.sel.ranges[o]).head,s.anchor)<0,n[o]=new V(s?l:a,s?a:l)):n[o]=new V(a,a)}return new U(n,e.sel.primIndex)}(this,n,t),a=n.length-1;0<=a;a--)Qi(this,n[a]);t?Bi(this,t):this.cm&&kn(this.cm)}),undo:n(function(){to(this,"undo")}),redo:n(function(){to(this,"redo")}),undoSelection:n(function(){to(this,"undo",!0)}),redoSelection:n(function(){to(this,"redo",!0)}),setExtending:function(e){this.extend=e},getExtending:function(){return this.extend},historySize:function(){for(var e=this.history,t=0,r=0,n=0;n<e.done.length;n++)e.done[n].ranges||++t;for(var i=0;i<e.undone.length;i++)e.undone[i].ranges||++r;return{undo:t,redo:r}},clearHistory:function(){var t=this;this.history=new Ai(this.history),_i(this,function(e){return e.history=t.history},!0)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(e){return e&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:Fi(this.history.done),undone:Fi(this.history.undone)}},setHistory:function(e){var t=this.history=new Ai(this.history);t.done=Fi(e.done.slice(0),null,!0),t.undone=Fi(e.undone.slice(0),null,!0)},setGutterMarker:n(function(e,r,n){return lo(this,e,"gutter",function(e){var t=e.gutterMarkers||(e.gutterMarkers={});return!(t[r]=n)&&Re(t)&&(e.gutterMarkers=null),1})}),clearGutter:n(function(t){var r=this;this.iter(function(e){e.gutterMarkers&&e.gutterMarkers[t]&&lo(r,e,"gutter",function(){return e.gutterMarkers[t]=null,Re(e.gutterMarkers)&&(e.gutterMarkers=null),1})})}),lineInfo:function(e){var t;if("number"==typeof e){if(!vt(this,e))return null;if(!(e=I(this,t=e)))return null}else if(null==(t=M(e)))return null;return{line:t,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},addLineClass:n(function(e,r,n){return lo(this,e,"gutter"==r?"gutter":"class",function(e){var t="text"==r?"textClass":"background"==r?"bgClass":"gutter"==r?"gutterClass":"wrapClass";if(e[t]){if(Z(n).test(e[t]))return;e[t]+=" "+n}else e[t]=n;return 1})}),removeLineClass:n(function(e,o,s){return lo(this,e,"gutter"==o?"gutter":"class",function(e){var t="text"==o?"textClass":"background"==o?"bgClass":"gutter"==o?"gutterClass":"wrapClass",r=e[t];if(r){if(null==s)e[t]=null;else{var n=r.match(Z(s));if(!n)return;var i=n.index+n[0].length;e[t]=r.slice(0,n.index)+(n.index&&i!=r.length?" ":"")+r.slice(i)||null}return 1}})}),addLineWidget:n(function(e,t,r){return e=e,i=new ho(n=this,t,r),(o=n.cm)&&i.noHScroll&&(o.display.alignWidgets=!0),lo(n,e,"widget",function(e){var t=e.widgets||(e.widgets=[]);return null==i.insertAt?t.push(i):t.splice(Math.min(t.length,Math.max(0,i.insertAt)),0,i),i.line=e,o&&!rr(n,e)&&(t=nr(e)<n.scrollTop,mt(e,e.height+xr(i)),t&&Mn(o,i.height),o.curOp.forceUpdate=!0),1}),o&&b(o,"lineWidgetAdded",o,i,"number"==typeof e?e:M(e)),i;var n,i,o}),removeLineWidget:function(e){e.clear()},markText:function(e,t,r){return mo(this,P(this,e),P(this,t),r,r&&r.type||"range")},setBookmark:function(e,t){t={replacedWith:t&&(null==t.nodeType?t.widget:t),insertLeft:t&&t.insertLeft,clearWhenEmpty:!1,shared:t&&t.shared,handleMouseEvents:t&&t.handleMouseEvents};return mo(this,e=P(this,e),e,t,"bookmark")},findMarksAt:function(e){var t=[],r=I(this,(e=P(this,e)).line).markedSpans;if(r)for(var n=0;n<r.length;++n){var i=r[n];(null==i.from||i.from<=e.ch)&&(null==i.to||i.to>=e.ch)&&t.push(i.marker.parent||i.marker)}return t},findMarks:function(i,o,s){i=P(this,i),o=P(this,o);var a=[],l=i.line;return this.iter(i.line,o.line+1,function(e){var t=e.markedSpans;if(t)for(var r=0;r<t.length;r++){var n=t[r];null!=n.to&&l==i.line&&i.ch>=n.to||null==n.from&&l!=i.line||null!=n.from&&l==o.line&&n.from>=o.ch||s&&!s(n.marker)||a.push(n.marker.parent||n.marker)}++l}),a},getAllMarks:function(){var n=[];return this.iter(function(e){var t=e.markedSpans;if(t)for(var r=0;r<t.length;++r)null!=t[r].from&&n.push(t[r].marker)}),n},posFromIndex:function(t){var r,n=this.first,i=this.lineSeparator().length;return this.iter(function(e){e=e.text.length+i;if(t<e)return r=t,!0;t-=e,++n}),P(this,k(n,r))},indexFromPos:function(e){var t,r=(e=P(this,e)).ch;return e.line<this.first||e.ch<0?0:(t=this.lineSeparator().length,this.iter(this.first,e.line,function(e){r+=e.text.length+t}),r)},copy:function(e){var t=new p(gt(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);return t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft,t.sel=this.sel,t.extend=!1,e&&(t.history.undoDepth=this.history.undoDepth,t.setHistory(this.getHistory())),t},linkedDoc:function(e){for(var t=this.first,r=this.first+this.size,r=(null!=(e=e||{}).from&&e.from>t&&(t=e.from),null!=e.to&&e.to<r&&(r=e.to),new p(gt(this,t,r),e.mode||this.modeOption,t,this.lineSep,this.direction)),n=(e.sharedHist&&(r.history=this.history),(this.linked||(this.linked=[])).push({doc:r,sharedHist:e.sharedHist}),r.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],r),i=vo(this),o=0;o<i.length;o++){var s=i[o],a=s.find(),l=n.clipPos(a.from),a=n.clipPos(a.to);D(l,a)&&(l=mo(n,l,a,s.primary,s.primary.type),s.markers.push(l),l.parent=s)}return r},unlinkDoc:function(e){if(e instanceof f&&(e=e.doc),this.linked)for(var t=0;t<this.linked.length;++t){var r=this.linked[t];if(r.doc==e){this.linked.splice(t,1),e.unlinkDoc(this),bo(vo(this));break}}var n;e.history==this.history&&(n=[e.id],_i(e,function(e){return n.push(e.id)},!0),e.history=new Ai(null),e.history.done=Fi(this.history.done,n),e.history.undone=Fi(this.history.undone,n))},iterLinkedDocs:function(e){_i(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(e){return this.lineSep?e.split(this.lineSep):tt(e)},lineSeparator:function(){return this.lineSep||"\n"},setDirection:n(function(e){var t;(e="rtl"!=e?"ltr":e)!=this.direction&&(this.direction=e,this.iter(function(e){return e.order=null}),this.cm)&&d(t=this.cm,function(){Ri(t),L(t)})})})).eachLine=p.prototype.iter,0);function Eo(e){var n=this;if(To(n),!O(n,e)&&!Rr(n.display,e)){x(e),w&&(Co=+new Date);var t=pn(n,e,!0),r=e.dataTransfer.files;if(t&&!n.isReadOnly())if(r&&r.length&&window.FileReader&&window.File)for(var i=r.length,o=Array(i),s=0,a=function(){++s==i&&F(n,function(){var e={from:t=P(n.doc,t),to:t,text:n.doc.splitLines(o.filter(function(e){return null!=e}).join(n.doc.lineSeparator())),origin:"paste"};Qi(n.doc,e),Bi(n.doc,mi(P(n.doc,t),P(n.doc,yi(e))))})()},l=0;l<r.length;l++)!function(e,t){var r;n.options.allowDropFileTypes&&-1==T(n.options.allowDropFileTypes,e.type)?a():((r=new FileReader).onerror=function(){return a()},r.onload=function(){var e=r.result;/[\x00-\x08\x0e-\x1f]{2}/.test(e)||(o[t]=e),a()},r.readAsText(e))}(r[l],l);else if(n.state.draggingText&&-1<n.doc.sel.contains(t))n.state.draggingText(e),setTimeout(function(){return n.display.input.focus()},20);else try{var c,u=e.dataTransfer.getData("Text");if(u){if(n.state.draggingText&&!n.state.draggingText.copy&&(c=n.listSelections()),ji(n.doc,mi(t,t)),c)for(var d=0;d<c.length;++d)io(n.doc,"",c[d].anchor,c[d].head,"drag");n.replaceSelection(u,"around","paste"),n.display.input.focus()}}catch(e){}}}function To(e){e.display.dragCursor&&(e.display.lineSpace.removeChild(e.display.dragCursor),e.display.dragCursor=null)}function So(t){if(document.getElementsByClassName){for(var e=document.getElementsByClassName("CodeMirror"),r=[],n=0;n<e.length;n++){var i=e[n].CodeMirror;i&&r.push(i)}r.length&&r[0].operation(function(){for(var e=0;e<r.length;e++)t(r[e])})}}var _o=!1;function xo(){var e;_o||(S(window,"resize",function(){null==e&&(e=setTimeout(function(){e=null,So(Ro)},100))}),S(window,"blur",function(){return So(Rn)}),_o=!0)}function Ro(e){var t=e.display;t.cachedCharWidth=t.cachedTextHeight=t.cachedPaddingH=null,t.scrollbarsClipped=!1,e.setSize()}for(var Ao={3:"Pause",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",145:"ScrollLock",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",224:"Mod",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"},No=0;No<10;No++)Ao[No+48]=Ao[No+96]=String(No);for(var Oo=65;Oo<=90;Oo++)Ao[Oo]=String.fromCharCode(Oo);for(var Io=1;Io<=12;Io++)Ao[Io+111]=Ao[Io+63235]="F"+Io;var Mo={};function ko(e){var t,r,n,i,o=e.split(/-(?!$)/);e=o[o.length-1];for(var s=0;s<o.length-1;s++){var a=o[s];if(/^(cmd|meta|m)$/i.test(a))i=!0;else if(/^a(lt)?$/i.test(a))t=!0;else if(/^(c|ctrl|control)$/i.test(a))r=!0;else{if(!/^s(hift)?$/i.test(a))throw new Error("Unrecognized modifier name: "+a);n=!0}}return t&&(e="Alt-"+e),r&&(e="Ctrl-"+e),i&&(e="Cmd-"+e),e=n?"Shift-"+e:e}function Do(e){var t,r,n={};for(t in e)if(e.hasOwnProperty(t)){var i=e[t];if(!/^(name|fallthrough|(de|at)tach)$/.test(t)){if("..."!=i)for(var o=Ce(t.split(" "),ko),s=0;s<o.length;s++){var a=void 0,l=void 0,a=s==o.length-1?(l=o.join(" "),i):(l=o.slice(0,s+1).join(" "),"..."),c=n[l];if(c){if(c!=a)throw new Error("Inconsistent bindings for "+l)}else n[l]=a}delete e[t]}}for(r in n)e[r]=n[r];return e}function Po(e,t,r,n){var i=(t=Uo(t)).call?t.call(e,n):t[e];if(!1===i)return"nothing";if("..."===i)return"multi";if(null!=i&&r(i))return"handled";if(t.fallthrough){if("[object Array]"!=Object.prototype.toString.call(t.fallthrough))return Po(e,t.fallthrough,r,n);for(var o=0;o<t.fallthrough.length;o++){var s=Po(e,t.fallthrough[o],r,n);if(s)return s}}}function Lo(e){e="string"==typeof e?e:Ao[e.keyCode];return"Ctrl"==e||"Alt"==e||"Shift"==e||"Mod"==e}function Fo(e,t,r){var n=e;return t.altKey&&"Alt"!=n&&(e="Alt-"+e),(X?t.metaKey:t.ctrlKey)&&"Ctrl"!=n&&(e="Ctrl-"+e),(X?t.ctrlKey:t.metaKey)&&"Mod"!=n&&(e="Cmd-"+e),e=!r&&t.shiftKey&&"Shift"!=n?"Shift-"+e:e}function Ho(e,t){var r;return!(j&&34==e.keyCode&&e.char||null==(r=Ao[e.keyCode])||e.altGraphKey)&&Fo(r=3==e.keyCode&&e.code?e.code:r,e,t)}function Uo(e){return"string"==typeof e?Mo[e]:e}function Vo(t,e){for(var r=t.doc.sel.ranges,n=[],i=0;i<r.length;i++){for(var o=e(r[i]);n.length&&D(o.from,H(n).to)<=0;){var s=n.pop();if(D(s.from,o.from)<0){o.from=s.from;break}}n.push(o)}d(t,function(){for(var e=n.length-1;0<=e;e--)io(t.doc,"",n[e].from,n[e].to,"+delete");kn(t)})}function Wo(e,t,r){t=Oe(e.text,t+r,r);return t<0||t>e.text.length?null:t}function $o(e,t,r){e=Wo(e,t.ch,r);return null==e?null:new k(t.line,e,r<0?"after":"before")}function Bo(e,t,r,n,i){if(e){"rtl"==t.doc.direction&&(i=-i);var o,s,a,l,e=We(r,t.doc.direction);if(e)return o=i<0==(1==(e=i<0?H(e):e[0]).level)?"after":"before",0<e.level||"rtl"==t.doc.direction?(s=Fr(t,r),a=i<0?r.text.length-1:0,l=Hr(t,s,a).top,a=Ie(function(e){return Hr(t,s,e).top==l},i<0==(1==e.level)?e.from:e.to-1,a),"before"==o&&(a=Wo(r,a,1))):a=i<0?e.to:e.from,new k(n,a,o)}return new k(n,i<0?r.text.length:0,i<0?"before":"after")}function jo(t,r,a,e){var l=We(r,t.doc.direction);if(!l)return $o(r,a,e);a.ch>=r.text.length?(a.ch=r.text.length,a.sticky="before"):a.ch<=0&&(a.ch=0,a.sticky="after");var n=ke(l,a.ch,a.sticky),i=l[n];if("ltr"==t.doc.direction&&i.level%2==0&&(0<e?i.to>a.ch:i.from<a.ch))return $o(r,a,e);function c(e,t){return Wo(r,e instanceof k?e.ch:e,t)}function o(e){return t.options.lineWrapping?(s=s||Fr(t,r),rn(t,r,s,e)):{begin:0,end:r.text.length}}var s,u=o("before"==a.sticky?c(a,-1):a.ch);if("rtl"==t.doc.direction||1==i.level){var d=1==i.level==e<0,h=c(a,d?1:-1);if(null!=h&&(d?h<=i.to&&h<=u.end:h>=i.from&&h>=u.begin))return new k(a.line,h,d?"before":"after")}function p(e,t,r){for(var n=function(e,t){return t?new k(a.line,c(e,1),"before"):new k(a.line,e,"after")};0<=e&&e<l.length;e+=t){var i=l[e],o=0<t==(1!=i.level),s=o?r.begin:c(r.end,-1);if(i.from<=s&&s<i.to)return n(s,o);if(s=o?i.from:c(i.to,-1),r.begin<=s&&s<r.end)return n(s,o)}}i=p(n+e,e,u);return i||(null==(h=0<e?u.end:c(u.begin,-1))||0<e&&h==r.text.length||!(i=p(0<e?0:l.length-1,e,o(h)))?null:i)}Mo.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},Mo.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},Mo.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"},Mo.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},Mo.default=E?Mo.macDefault:Mo.pcDefault;var zo={selectAll:Ji,singleSelection:function(e){return e.setSelection(e.getCursor("anchor"),e.getCursor("head"),ge)},killLine:function(r){return Vo(r,function(e){var t;return e.empty()?(t=I(r.doc,e.head.line).text.length,e.head.ch==t&&e.head.line<r.lastLine()?{from:e.head,to:k(e.head.line+1,0)}:{from:e.head,to:k(e.head.line,t)}):{from:e.from(),to:e.to()}})},deleteLine:function(t){return Vo(t,function(e){return{from:k(e.from().line,0),to:P(t.doc,k(e.to().line+1,0))}})},delLineLeft:function(e){return Vo(e,function(e){return{from:k(e.from().line,0),to:e.from()}})},delWrappedLineLeft:function(r){return Vo(r,function(e){var t=r.charCoords(e.head,"div").top+5;return{from:r.coordsChar({left:0,top:t},"div"),to:e.from()}})},delWrappedLineRight:function(r){return Vo(r,function(e){var t=r.charCoords(e.head,"div").top+5,t=r.coordsChar({left:r.display.lineDiv.offsetWidth+100,top:t},"div");return{from:e.from(),to:t}})},undo:function(e){return e.undo()},redo:function(e){return e.redo()},undoSelection:function(e){return e.undoSelection()},redoSelection:function(e){return e.redoSelection()},goDocStart:function(e){return e.extendSelection(k(e.firstLine(),0))},goDocEnd:function(e){return e.extendSelection(k(e.lastLine()))},goLineStart:function(t){return t.extendSelectionsBy(function(e){return Yo(t,e.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(t){return t.extendSelectionsBy(function(e){return Go(t,e.head)},{origin:"+move",bias:1})},goLineEnd:function(i){return i.extendSelectionsBy(function(e){var t=i,e=e.head.line,r=I(t.doc,e),n=function(e){for(var t;t=Jt(e);)e=t.find(1,!0).line;return e}(r);return n!=r&&(e=M(n)),Bo(!0,t,r,e,-1)},{origin:"+move",bias:-1})},goLineRight:function(t){return t.extendSelectionsBy(function(e){e=t.cursorCoords(e.head,"div").top+5;return t.coordsChar({left:t.display.lineDiv.offsetWidth+100,top:e},"div")},ye)},goLineLeft:function(t){return t.extendSelectionsBy(function(e){e=t.cursorCoords(e.head,"div").top+5;return t.coordsChar({left:0,top:e},"div")},ye)},goLineLeftSmart:function(r){return r.extendSelectionsBy(function(e){var t=r.cursorCoords(e.head,"div").top+5,t=r.coordsChar({left:0,top:t},"div");return t.ch<r.getLine(t.line).search(/\S/)?Go(r,e.head):t},ye)},goLineUp:function(e){return e.moveV(-1,"line")},goLineDown:function(e){return e.moveV(1,"line")},goPageUp:function(e){return e.moveV(-1,"page")},goPageDown:function(e){return e.moveV(1,"page")},goCharLeft:function(e){return e.moveH(-1,"char")},goCharRight:function(e){return e.moveH(1,"char")},goColumnLeft:function(e){return e.moveH(-1,"column")},goColumnRight:function(e){return e.moveH(1,"column")},goWordLeft:function(e){return e.moveH(-1,"word")},goGroupRight:function(e){return e.moveH(1,"group")},goGroupLeft:function(e){return e.moveH(-1,"group")},goWordRight:function(e){return e.moveH(1,"word")},delCharBefore:function(e){return e.deleteH(-1,"codepoint")},delCharAfter:function(e){return e.deleteH(1,"char")},delWordBefore:function(e){return e.deleteH(-1,"word")},delWordAfter:function(e){return e.deleteH(1,"word")},delGroupBefore:function(e){return e.deleteH(-1,"group")},delGroupAfter:function(e){return e.deleteH(1,"group")},indentAuto:function(e){return e.indentSelection("smart")},indentMore:function(e){return e.indentSelection("add")},indentLess:function(e){return e.indentSelection("subtract")},insertTab:function(e){return e.replaceSelection("\t")},insertSoftTab:function(e){for(var t=[],r=e.listSelections(),n=e.options.tabSize,i=0;i<r.length;i++){var o=r[i].from(),o=de(e.getLine(o.line),o.ch,n);t.push(we(n-o%n))}e.replaceSelections(t)},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.execCommand("insertTab")},transposeChars:function(s){return d(s,function(){for(var e,t,r,n=s.listSelections(),i=[],o=0;o<n.length;o++)n[o].empty()&&(e=n[o].head,(t=I(s.doc,e.line).text)&&(0<(e=e.ch==t.length?new k(e.line,e.ch-1):e).ch?(e=new k(e.line,e.ch+1),s.replaceRange(t.charAt(e.ch-1)+t.charAt(e.ch-2),k(e.line,e.ch-2),e,"+transpose")):e.line>s.doc.first&&(r=I(s.doc,e.line-1).text)&&(e=new k(e.line,1),s.replaceRange(t.charAt(0)+s.doc.lineSeparator()+r.charAt(r.length-1),k(e.line-1,r.length-1),e,"+transpose"))),i.push(new V(e,e)));s.setSelections(i)})},newlineAndIndent:function(n){return d(n,function(){for(var e=(t=n.listSelections()).length-1;0<=e;e--)n.replaceRange(n.doc.lineSeparator(),t[e].anchor,t[e].head,"+input");for(var t=n.listSelections(),r=0;r<t.length;r++)n.indentLine(t[r].from().line,null,!0);kn(n)})},openLine:function(e){return e.replaceSelection("\n","start")},toggleOverwrite:function(e){return e.toggleOverwrite()}};function Yo(e,t){var r=I(e.doc,t),n=Qt(r);return Bo(!0,e,n,t=n!=r?M(n):t,1)}function Go(e,t){var r=Yo(e,t.line),n=I(e.doc,r.line),e=We(n,e.doc.direction);return e&&0!=e[0].level?r:(e=Math.max(r.ch,n.text.search(/\S/)),n=t.line==r.line&&t.ch<=e&&t.ch,k(r.line,n?0:e,r.sticky))}function qo(e,t,r){if("string"==typeof t&&!(t=zo[t]))return!1;e.display.input.ensurePolled();var n=e.display.shift,i=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),r&&(e.display.shift=!1),i=t(e)!=fe}finally{e.display.shift=n,e.state.suppressEdits=!1}return i}var Ko=new he;function Xo(e,t,r,n){var i=e.state.keySeq;if(i){if(Lo(t))return"handled";if(/\'$/.test(t)?e.state.keySeq=null:Ko.set(50,function(){e.state.keySeq==i&&(e.state.keySeq=null,e.display.input.reset())}),Jo(e,i+" "+t,r,n))return!0}return Jo(e,t,r,n)}function Jo(e,t,r,n){n=function(e,t,r){for(var n=0;n<e.state.keyMaps.length;n++){var i=Po(t,e.state.keyMaps[n],r,e);if(i)return i}return e.options.extraKeys&&Po(t,e.options.extraKeys,r,e)||Po(t,e.options.keyMap,r,e)}(e,t,n);return"multi"==n&&(e.state.keySeq=t),"handled"==n&&b(e,"keyHandled",e,t,r),"handled"!=n&&"multi"!=n||(x(r),Tn(e)),!!n}function Zo(t,e){var r=Ho(e,!0);return!!r&&(e.shiftKey&&!t.state.keySeq?Xo(t,"Shift-"+r,e,function(e){return qo(t,e,!0)})||Xo(t,r,e,function(e){if("string"==typeof e?/^go[A-Z]/.test(e):e.motion)return qo(t,e)}):Xo(t,r,e,function(e){return qo(t,e)}))}var Qo=null;function es(e){var t,r,n;function i(e){18!=e.keyCode&&e.altKey||(Q(n,"CodeMirror-crosshair"),_(document,"keyup",i),_(document,"mouseover",i))}e.target&&e.target!=this.display.input.getField()||(this.curOp.focus=A(ae(this)),O(this,e))||(w&&y<11&&27==e.keyCode&&(e.returnValue=!1),t=e.keyCode,this.display.shift=16==t||e.shiftKey,r=Zo(this,e),j&&(Qo=r?t:null,!r)&&88==t&&!nt&&(E?e.metaKey:e.ctrlKey)&&this.replaceSelection("",null,"cut"),m&&!E&&!r&&46==t&&e.shiftKey&&!e.ctrlKey&&document.execCommand&&document.execCommand("cut"),18!=t)||/\bCodeMirror-crosshair\b/.test(this.display.lineDiv.className)||(ne(n=this.display.lineDiv,"CodeMirror-crosshair"),S(document,"keyup",i),S(document,"mouseover",i))}function ts(e){16==e.keyCode&&(this.doc.sel.shift=!1),O(this,e)}function rs(e){var t,r,n;e.target&&e.target!=this.display.input.getField()||Rr(this.display,e)||O(this,e)||e.ctrlKey&&!e.altKey||E&&e.metaKey||(r=e.keyCode,t=e.charCode,j&&r==Qo?(Qo=null,x(e)):j&&(!e.which||e.which<10)&&Zo(this,e)||"\b"==(r=String.fromCharCode(null==t?r:t))||Xo(n=this,"'"+r+"'",e,function(e){return qo(n,e,!0)})||this.display.input.onKeyPress(e))}function ns(e,t,r){this.time=e,this.pos=t,this.button=r}var is,os;function ss(e){var t,r,n,i,o,s,a,l,c,u=this,d=u.display;O(u,e)||d.activeTouch&&d.input.supportsTouch()||(d.input.ensurePolled(),d.shift=e.shiftKey,Rr(d,e)?C||(d.scroller.draggable=!1,setTimeout(function(){return d.scroller.draggable=!0},100)):cs(u,e)||(t=pn(u,e),r=Je(e),n=t?(i=t,o=r,n=+new Date,os&&os.compare(n,i,o)?(is=os=null,"triple"):is&&is.compare(n,i,o)?(os=new ns(n,i,o),is=null,"double"):(is=new ns(n,i,o),os=null,"single")):"single",le(u).focus(),1==r&&u.state.selectingText&&u.state.selectingText(e),t&&function(r,e,n,t,i){var o="Click";"double"==t?o="Double"+o:"triple"==t&&(o="Triple"+o);return Xo(r,Fo(o=(1==e?"Left":2==e?"Middle":"Right")+o,i),i,function(e){if(!(e="string"==typeof e?zo[e]:e))return!1;var t=!1;try{r.isReadOnly()&&(r.state.suppressEdits=!0),t=e(r,n)!=fe}finally{r.state.suppressEdits=!1}return t})}(u,r,t,n,e))||(1==r?t?(i=u,o=t,s=n,a=e,w?setTimeout(ce(Sn,i),0):i.curOp.focus=A(ae(i)),l=function(e,t,r){var n=e.getOption("configureMouse"),n=n?n(e,t,r):{};{var i;null==n.unit&&(i=K?r.shiftKey&&r.metaKey:r.altKey,n.unit=i?"rectangle":"single"==t?"char":"double"==t?"word":"line")}null!=n.extend&&!e.doc.extend||(n.extend=e.doc.extend||r.shiftKey);null==n.addNew&&(n.addNew=E?r.metaKey:r.ctrlKey);null==n.moveOnDrag&&(n.moveOnDrag=!(E?r.altKey:r.ctrlKey));return n}(i,s,a),c=i.doc.sel,(i.options.dragDrop&&et&&!i.isReadOnly()&&"single"==s&&-1<(s=c.contains(o))&&(D((s=c.ranges[s]).from(),o)<0||0<o.xRel)&&(0<D(s.to(),o)||o.xRel<0)?function(t,r,n,i){var o=t.display,s=!1,a=F(t,function(e){C&&(o.scroller.draggable=!1),t.state.draggingText=!1,t.state.delayingBlurEvent&&(t.hasFocus()?t.state.delayingBlurEvent=!1:_n(t)),_(o.wrapper.ownerDocument,"mouseup",a),_(o.wrapper.ownerDocument,"mousemove",l),_(o.scroller,"dragstart",c),_(o.scroller,"drop",a),s||(x(e),i.addNew||Ui(t.doc,n,null,null,i.extend),C&&!z||w&&9==y?setTimeout(function(){o.wrapper.ownerDocument.body.focus({preventScroll:!0}),o.input.focus()},20):o.input.focus())}),l=function(e){s=s||10<=Math.abs(r.clientX-e.clientX)+Math.abs(r.clientY-e.clientY)},c=function(){return s=!0};C&&(o.scroller.draggable=!0);(t.state.draggingText=a).copy=!i.moveOnDrag,S(o.wrapper.ownerDocument,"mouseup",a),S(o.wrapper.ownerDocument,"mousemove",l),S(o.scroller,"dragstart",c),S(o.scroller,"drop",a),t.state.delayingBlurEvent=!0,setTimeout(function(){return o.input.focus()},20),o.scroller.dragDrop&&o.scroller.dragDrop()}:function(h,e,p,f){w&&_n(h);var s=h.display,g=h.doc;x(e);var m,y,v=g.sel,t=v.ranges;f.addNew&&!f.extend?(y=g.sel.contains(p),m=-1<y?t[y]:new V(p,p)):(m=g.sel.primary(),y=g.sel.primIndex);"rectangle"==f.unit?(f.addNew||(m=new V(p,p)),p=pn(h,e,!0,!0),y=-1):(e=as(h,p,f.unit),m=f.extend?Hi(m,e.anchor,e.head,f.extend):e);f.addNew?-1==y?(y=t.length,W(g,gi(h,t.concat([m]),y),{scroll:!1,origin:"*mouse"})):1<t.length&&t[y].empty()&&"char"==f.unit&&!f.extend?(W(g,gi(h,t.slice(0,y).concat(t.slice(y+1)),0),{scroll:!1,origin:"*mouse"}),v=g.sel):Wi(g,y,m,me):(W(g,new U([m],y=0),me),v=g.sel);var b=p;function a(e){if(0!=D(b,e))if(b=e,"rectangle"==f.unit){for(var t=[],r=h.options.tabSize,n=de(I(g,p.line).text,p.ch,r),i=de(I(g,e.line).text,e.ch,r),o=Math.min(n,i),s=Math.max(n,i),a=Math.min(p.line,e.line),l=Math.min(h.lastLine(),Math.max(p.line,e.line));a<=l;a++){var c=I(g,a).text,u=ve(c,o,r);o==s?t.push(new V(k(a,u),k(a,u))):c.length>u&&t.push(new V(k(a,u),k(a,ve(c,s,r))))}t.length||t.push(new V(p,p)),W(g,gi(h,v.ranges.slice(0,y).concat(t),y),{origin:"*mouse",scroll:!1}),h.scrollIntoView(e)}else{var d,n=m,i=as(h,e,f.unit),e=n.anchor,e=0<D(i.anchor,e)?(d=i.head,Tt(n.from(),i.anchor)):(d=i.anchor,Et(n.to(),i.head)),n=v.ranges.slice(0);n[y]=function(e,t){var r=t.anchor,n=t.head,i=I(e.doc,r.line);if(0==D(r,n)&&r.sticky==n.sticky)return t;i=We(i);if(!i)return t;var o=ke(i,r.ch,r.sticky),s=i[o];if(s.from!=r.ch&&s.to!=r.ch)return t;var a=o+(s.from==r.ch==(1!=s.level)?0:1);if(0==a||a==i.length)return t;s=n.line!=r.line?0<(n.line-r.line)*("ltr"==e.doc.direction?1:-1):(e=ke(i,n.ch,n.sticky),o=e-o||(n.ch-r.ch)*(1==s.level?-1:1),e==a-1||e==a?o<0:0<o);e=i[a+(s?-1:0)],o=s==(1==e.level),i=o?e.from:e.to,a=o?"after":"before";return r.ch==i&&r.sticky==a?t:new V(new k(r.line,i,a),n)}(h,new V(P(g,e),d)),W(g,gi(h,n,y),me)}}var l=s.wrapper.getBoundingClientRect(),c=0;function r(e){h.state.selectingText=!1,c=1/0,e&&(x(e),s.input.focus()),_(s.wrapper.ownerDocument,"mousemove",n),_(s.wrapper.ownerDocument,"mouseup",i),g.history.lastSelOrigin=null}var n=F(h,function(e){(0!==e.buttons&&Je(e)?function e(t){var r,n,i=++c,o=pn(h,t,!0,"rectangle"==f.unit);o&&(0!=D(o,b)?(h.curOp.focus=A(ae(h)),a(o),r=On(s,g),(o.line>=r.to||o.line<r.from)&&setTimeout(F(h,function(){c==i&&e(t)}),150)):(n=t.clientY<l.top?-20:t.clientY>l.bottom?20:0)&&setTimeout(F(h,function(){c==i&&(s.scroller.scrollTop+=n,e(t))}),50))}:r)(e)}),i=F(h,r);h.state.selectingText=i,S(s.wrapper.ownerDocument,"mousemove",n),S(s.wrapper.ownerDocument,"mouseup",i)})(i,a,o,l)):Xe(e)==d.scroller&&x(e):2==r?(t&&Ui(u.doc,t),setTimeout(function(){return d.input.focus()},20)):3==r&&(J?u.display.input.onContextMenu(e):_n(u))))}function as(e,t,r){return"char"==r?new V(t,t):"word"==r?e.findWordAt(t):"line"==r?new V(k(t.line,0),P(e.doc,k(t.line+1,0))):(r=r(e,t),new V(r.from,r.to))}function ls(e,t,r,n){var i,o;if(t.touches)i=t.touches[0].clientX,o=t.touches[0].clientY;else try{i=t.clientX,o=t.clientY}catch(e){return!1}if(i>=Math.floor(e.display.gutters.getBoundingClientRect().right))return!1;n&&x(t);var s=e.display,n=s.lineDiv.getBoundingClientRect();if(o>n.bottom||!ze(e,r))return qe(t);o-=n.top-s.viewOffset;for(var a=0;a<e.display.gutterSpecs.length;++a){var l=s.gutters.childNodes[a];if(l&&l.getBoundingClientRect().right>=i)return N(e,r,e,yt(e.doc,o),e.display.gutterSpecs[a].className,t),qe(t)}}function cs(e,t){return ls(e,t,"gutterClick",!0)}function us(e,t){var r,n;Rr(e.display,t)||(n=t,ze(r=e,"gutterContextMenu")&&ls(r,n,"gutterContextMenu",!1))||(O(e,t,"contextmenu")||J||e.display.input.onContextMenu(t))}function ds(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),jr(e)}ns.prototype.compare=function(e,t,r){return this.time+400>e&&0==D(t,this.pos)&&r==this.button};var hs={toString:function(){return"CodeMirror.Init"}},ps={},fs={};function gs(e,t,r){!t!=!(r&&r!=hs)&&(r=e.display.dragFunctions,(t=t?S:_)(e.display.scroller,"dragstart",r.start),t(e.display.scroller,"dragenter",r.enter),t(e.display.scroller,"dragover",r.over),t(e.display.scroller,"dragleave",r.leave),t(e.display.scroller,"drop",r.drop))}function ms(e){e.options.lineWrapping?(ne(e.display.wrapper,"CodeMirror-wrap"),e.display.sizer.style.minWidth="",e.display.sizerWidth=null):(Q(e.display.wrapper,"CodeMirror-wrap"),or(e)),hn(e),L(e),jr(e),setTimeout(function(){return Bn(e)},100)}function f(e,t){var r=this;if(!(this instanceof f))return new f(e,t);this.options=t=t?ue(t):{},ue(ps,t,!1);var n,i=t.value,o=("string"==typeof i?i=new p(i,t.mode,null,t.lineSeparator,t.direction):t.mode&&(i.modeOption=t.mode),this.doc=i,new f.inputStyles[t.inputStyle](this)),e=this.display=new ci(e,i,o,t),s=(ds(e.wrapper.CodeMirror=this),t.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),Yn(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:-1,cutIncoming:-1,selectingText:!1,draggingText:!1,highlight:new he,keySeq:null,specialChars:null},t.autofocus&&!q&&e.input.focus(),w&&y<11&&setTimeout(function(){return r.display.input.reset(!0)},20),this),a=s.display;S(a.scroller,"mousedown",F(s,ss)),S(a.scroller,"dblclick",w&&y<11?F(s,function(e){var t;O(s,e)||!(t=pn(s,e))||cs(s,e)||Rr(s.display,e)||(x(e),e=s.findWordAt(t),Ui(s.doc,e.anchor,e.head))}):function(e){return O(s,e)||x(e)}),S(a.scroller,"contextmenu",function(e){return us(s,e)}),S(a.input.getField(),"contextmenu",function(e){a.scroller.contains(e.target)||us(s,e)});var l,c={end:0};function u(){a.activeTouch&&(l=setTimeout(function(){return a.activeTouch=null},1e3),(c=a.activeTouch).end=+new Date)}function d(e,t){var r;return null==t.left||400<(r=t.left-e.left)*r+(r=t.top-e.top)*r}S(a.scroller,"touchstart",function(e){var t;O(s,e)||function(e){if(1==e.touches.length)return(e=e.touches[0]).radiusX<=1&&e.radiusY<=1}(e)||cs(s,e)||(a.input.ensurePolled(),clearTimeout(l),t=+new Date,a.activeTouch={start:t,moved:!1,prev:t-c.end<=300?c:null},1==e.touches.length&&(a.activeTouch.left=e.touches[0].pageX,a.activeTouch.top=e.touches[0].pageY))}),S(a.scroller,"touchmove",function(){a.activeTouch&&(a.activeTouch.moved=!0)}),S(a.scroller,"touchend",function(e){var t,r=a.activeTouch;r&&!Rr(a,e)&&null!=r.left&&!r.moved&&new Date-r.start<300&&(t=s.coordsChar(a.activeTouch,"page"),r=!r.prev||d(r,r.prev)?new V(t,t):!r.prev.prev||d(r,r.prev.prev)?s.findWordAt(t):new V(k(t.line,0),P(s.doc,k(t.line+1,0))),s.setSelection(r.anchor,r.head),s.focus(),x(e)),u()}),S(a.scroller,"touchcancel",u),S(a.scroller,"scroll",function(){a.scroller.clientHeight&&(Fn(s,a.scroller.scrollTop),Un(s,a.scroller.scrollLeft,!0),N(s,"scroll",s))}),S(a.scroller,"mousewheel",function(e){return fi(s,e)}),S(a.scroller,"DOMMouseScroll",function(e){return fi(s,e)}),S(a.wrapper,"scroll",function(){return a.wrapper.scrollTop=a.wrapper.scrollLeft=0}),a.dragFunctions={enter:function(e){O(s,e)||Ke(e)},over:function(e){var t,r;O(s,e)||((r=pn(t=s,r=e))&&(Cn(t,r,r=document.createDocumentFragment()),t.display.dragCursor||(t.display.dragCursor=R("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),t.display.lineSpace.insertBefore(t.display.dragCursor,t.display.cursorDiv)),v(t.display.dragCursor,r)),Ke(e))},start:function(e){var t,r;t=s,e=e,w&&(!t.state.draggingText||+new Date-Co<100)?Ke(e):O(t,e)||Rr(t.display,e)||(e.dataTransfer.setData("Text",t.getSelection()),e.dataTransfer.effectAllowed="copyMove",e.dataTransfer.setDragImage&&!z&&((r=R("img",null,null,"position: fixed; left: 0; top: 0;")).src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",j&&(r.width=r.height=1,t.display.wrapper.appendChild(r),r._top=r.offsetTop),e.dataTransfer.setDragImage(r,0,0),j)&&r.parentNode.removeChild(r))},drop:F(s,Eo),leave:function(e){O(s,e)||To(s)}};o=a.input.getField();for(n in S(o,"keyup",function(e){return ts.call(s,e)}),S(o,"keydown",F(s,es)),S(o,"keypress",F(s,rs)),S(o,"focus",function(e){return xn(s,e)}),S(o,"blur",function(e){return Rn(s,e)}),xo(),qn(this),this.curOp.forceUpdate=!0,xi(this,i),t.autofocus&&!q||this.hasFocus()?setTimeout(function(){r.hasFocus()&&!r.state.focused&&xn(r)},20):Rn(this),fs)fs.hasOwnProperty(n)&&fs[n](this,t[n],hs);oi(this),t.finishInit&&t.finishInit(this);for(var h=0;h<ys.length;++h)ys[h](this);Kn(this),C&&t.lineWrapping&&"optimizelegibility"==getComputedStyle(e.lineDiv).textRendering&&(e.lineDiv.style.textRendering="auto")}f.defaults=ps,f.optionHandlers=fs;var ys=[];function vs(e,t,r,n){var i,o=e.doc,s=("smart"==(r=null==r?"add":r)&&(o.mode.indent?i=Ot(e,t).state:r="prev"),e.options.tabSize),a=I(o,t),l=de(a.text,null,s),c=(a.stateAfter&&(a.stateAfter=null),a.text.match(/^\s*/)[0]);if(n||/\S/.test(a.text)){if("smart"==r&&((u=o.mode.indent(i,a.text.slice(c.length),a.text))==fe||150<u)){if(!n)return;r="prev"}}else u=0,r="not";"prev"==r?u=t>o.first?de(I(o,t-1).text,null,s):0:"add"==r?u=l+e.options.indentUnit:"subtract"==r?u=l-e.options.indentUnit:"number"==typeof r&&(u=l+r);var u=Math.max(0,u),d="",h=0;if(e.options.indentWithTabs)for(var p=Math.floor(u/s);p;--p)h+=s,d+="\t";if(h<u&&(d+=we(u-h)),d!=c)return io(o,d,k(t,0),k(t,c.length),"+input"),!(a.stateAfter=null);for(var f=0;f<o.sel.ranges.length;f++){var g=o.sel.ranges[f];if(g.head.line==t&&g.head.ch<c.length){g=k(t,c.length);Wi(o,f,new V(g,g));break}}}f.defineInitHook=function(e){return ys.push(e)};var bs=null;function ws(e){bs=e}function Cs(e,t,r,n,i){var o=e.doc,s=(e.display.shift=!1,n=n||o.sel,+new Date-200),a="paste"==i||e.state.pasteIncoming>s,l=tt(t),c=null;if(a&&1<n.ranges.length)if(bs&&bs.text.join("\n")==t){if(n.ranges.length%bs.text.length==0)for(var c=[],u=0;u<bs.text.length;u++)c.push(o.splitLines(bs.text[u]))}else l.length==n.ranges.length&&e.options.pasteLinesPerSelection&&(c=Ce(l,function(e){return[e]}));for(var d=e.curOp.updateInput,h=n.ranges.length-1;0<=h;h--){var p=n.ranges[h],f=p.from(),g=p.to(),p=(p.empty()&&(r&&0<r?f=k(f.line,f.ch-r):e.state.overwrite&&!a?g=k(g.line,Math.min(I(o,g.line).text.length,g.ch+H(l).length)):a&&bs&&bs.lineWise&&bs.text.join("\n")==l.join("\n")&&(f=g=k(f.line,0))),{from:f,to:g,text:c?c[h%c.length]:l,origin:i||(a?"paste":e.state.cutIncoming>s?"cut":"+input")});Qi(e.doc,p),b(e,"inputRead",e,p)}t&&!a&&Ts(e,t),kn(e),e.curOp.updateInput<2&&(e.curOp.updateInput=d),e.curOp.typing=!0,e.state.pasteIncoming=e.state.cutIncoming=-1}function Es(e,t){var r=e.clipboardData&&e.clipboardData.getData("Text");return r&&(e.preventDefault(),t.isReadOnly()||t.options.disableInput||!t.hasFocus()||d(t,function(){return Cs(t,r,0,null,"paste")}),1)}function Ts(e,t){if(e.options.electricChars&&e.options.smartIndent)for(var r=e.doc.sel,n=r.ranges.length-1;0<=n;n--){var i=r.ranges[n];if(!(100<i.head.ch||n&&r.ranges[n-1].head.line==i.head.line)){var o=e.getModeAt(i.head),s=!1;if(o.electricChars){for(var a=0;a<o.electricChars.length;a++)if(-1<t.indexOf(o.electricChars.charAt(a))){s=vs(e,i.head.line,"smart");break}}else o.electricInput&&o.electricInput.test(I(e.doc,i.head.line).text.slice(0,i.head.ch))&&(s=vs(e,i.head.line,"smart"));s&&b(e,"electricInput",e,i.head.line)}}}function Ss(e){for(var t=[],r=[],n=0;n<e.doc.sel.ranges.length;n++){var i=e.doc.sel.ranges[n].head.line,i={anchor:k(i,0),head:k(i+1,0)};r.push(i),t.push(e.getRange(i.anchor,i.head))}return{text:t,ranges:r}}function _s(e,t,r,n){e.setAttribute("autocorrect",r?"":"off"),e.setAttribute("autocapitalize",n?"":"off"),e.setAttribute("spellcheck",!!t)}function xs(){var e=R("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; min-height: 1em; outline: none"),t=R("div",[e],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return C?e.style.width="1000px":e.setAttribute("wrap","off"),h&&(e.style.border="1px solid black"),_s(e),t}function Rs(r,n,i,o,s){var e=n,t=i,a=I(r,n.line),l=s&&"rtl"==r.direction?-i:i;function c(e){var t;if(null==(t="codepoint"==o?(t=a.text.charCodeAt(n.ch+(0<i?0:-1)),isNaN(t)?null:(t=0<i?55296<=t&&t<56320:56320<=t&&t<57343,new k(n.line,Math.max(0,Math.min(a.text.length,n.ch+i*(t?2:1))),-i))):s?jo(r.cm,a,n,i):$o(a,n,i))){if(e||(e=n.line+l)<r.first||e>=r.first+r.size||(n=new k(e,n.ch,n.sticky),!(a=I(r,e))))return;n=Bo(s,r.cm,a,n.line,l)}else n=t;return 1}if("char"==o||"codepoint"==o)c();else if("column"==o)c(!0);else if("word"==o||"group"==o)for(var u=null,d="group"==o,h=r.cm&&r.cm.getHelper(n,"wordChars"),p=!0;!(i<0)||c(!p);p=!1){var f=a.text.charAt(n.ch)||"\n",f=xe(f,h)?"w":d&&"\n"==f?"n":!d||/\s/.test(f)?null:"p";if(d&&!p&&(f=f||"s"),u&&u!=f){i<0&&(i=1,c(),n.sticky="after");break}if(f&&(u=f),0<i&&!c(!p))break}t=Ki(r,n,e,t,!0);return wt(e,t)&&(t.hitSide=!0),t}function As(e,t,r,n){var i,o,s,a=e.doc,l=t.left;for("page"==n?(i=Math.min(e.display.wrapper.clientHeight,le(e).innerHeight||a(e).documentElement.clientHeight),i=Math.max(i-.5*an(e.display),3),o=(0<r?t.bottom:t.top)+r*i):"line"==n&&(o=0<r?t.bottom+3:t.top-3);(s=en(e,l,o)).outside;){if(r<0?o<=0:o>=a.height){s.hitSide=!0;break}o+=5*r}return s}function i(e){this.cm=e,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new he,this.composing=null,this.gracePeriod=!1,this.readDOMTimeout=null}function Ns(e,t){var r,n,i=Lr(e,t.line);return!i||i.hidden?null:(r=Dr(i,i=I(e.doc,t.line),t.line),n="left",(i=We(i,e.doc.direction))&&(n=ke(i,t.ch)%2?"right":"left"),(e=Wr(r.map,t.ch,n)).offset="right"==e.collapse?e.end:e.start,e)}function Os(e,t){return t&&(e.bad=!0),e}function Is(e,t,r){var n;if(t==e.display.lineDiv){if(!(n=e.display.lineDiv.childNodes[r]))return Os(e.clipPos(k(e.display.viewTo-1)),!0);t=null,r=0}else for(n=t;;n=n.parentNode){if(!n||n==e.display.lineDiv)return null;if(n.parentNode&&n.parentNode==e.display.lineDiv)break}for(var i=0;i<e.display.view.length;i++){var o=e.display.view[i];if(o.node==n){var c=o,o=t,s=r,a=c.text.firstChild,l=!1;if(!o||!re(a,o))return Os(k(M(c.line),0),!0);if(o==a)if(l=!0,o=a.childNodes[s],s=0,!o)return Os(k(M(u=c.rest?H(c.rest):c.line),u.text.length),l);var u=3==o.nodeType?o:null,d=o;for(u||1!=o.childNodes.length||3!=o.firstChild.nodeType||(u=o.firstChild,s=s&&u.nodeValue.length);d.parentNode!=a;)d=d.parentNode;var h=c.measure,p=h.maps;function f(e,t,r){for(var n=-1;n<(p?p.length:0);n++)for(var i=n<0?h.map:p[n],o=0;o<i.length;o+=3){var s,a,l=i[o+2];if(l==e||l==t)return s=M(n<0?c.line:c.rest[n]),a=i[o]+r,k(s,a=r<0||l!=e?i[o+(r?1:0)]:a)}}var g=f(u,d,s);if(g)return Os(g,l);for(var m=d.nextSibling,y=u?u.nodeValue.length-s:0;m;m=m.nextSibling){if(g=f(m,m.firstChild,0))return Os(k(g.line,g.ch-y),l);y+=m.textContent.length}for(var v=d.previousSibling,b=s;v;v=v.previousSibling){if(g=f(v,v.firstChild,-1))return Os(k(g.line,g.ch+b),l);b+=v.textContent.length}return}}}i.prototype.init=function(e){var t=this,o=this,s=o.cm,a=o.div=e.lineDiv;function l(e){for(var t=e.target;t;t=t.parentNode){if(t==a)return 1;if(/\bCodeMirror-(?:line)?widget\b/.test(t.className))break}}function r(e){if(l(e)&&!O(s,e)){if(s.somethingSelected())ws({lineWise:!1,text:s.getSelections()}),"cut"==e.type&&s.replaceSelection("",null,"cut");else{if(!s.options.lineWiseCopyCut)return;var t=Ss(s);ws({lineWise:!0,text:t.text}),"cut"==e.type&&s.operation(function(){s.setSelections(t.ranges,0,ge),s.replaceSelection("",null,"cut")})}if(e.clipboardData){e.clipboardData.clearData();var r=bs.text.join("\n");if(e.clipboardData.setData("Text",r),e.clipboardData.getData("Text")==r)return void e.preventDefault()}var n=xs(),r=n.firstChild,i=(s.display.lineSpace.insertBefore(n,s.display.lineSpace.firstChild),r.value=bs.text.join("\n"),A(a.ownerDocument));se(r),setTimeout(function(){s.display.lineSpace.removeChild(n),i.focus(),i==a&&o.showPrimarySelection()},50)}}a.contentEditable=!0,_s(a,s.options.spellcheck,s.options.autocorrect,s.options.autocapitalize),S(a,"paste",function(e){!l(e)||O(s,e)||Es(e,s)||y<=11&&setTimeout(F(s,function(){return t.updateFromDOM()}),20)}),S(a,"compositionstart",function(e){t.composing={data:e.data,done:!1}}),S(a,"compositionupdate",function(e){t.composing||(t.composing={data:e.data,done:!1})}),S(a,"compositionend",function(e){t.composing&&(e.data!=t.composing.data&&t.readFromDOMSoon(),t.composing.done=!0)}),S(a,"touchstart",function(){return o.forceCompositionEnd()}),S(a,"input",function(){t.composing||t.readFromDOMSoon()}),S(a,"copy",r),S(a,"cut",r)},i.prototype.screenReaderLabelChanged=function(e){e?this.div.setAttribute("aria-label",e):this.div.removeAttribute("aria-label")},i.prototype.prepareSelection=function(){var e=wn(this.cm,!1);return e.focus=A(this.div.ownerDocument)==this.div,e},i.prototype.showSelection=function(e,t){e&&this.cm.display.view.length&&((e.focus||t)&&this.showPrimarySelection(),this.showMultipleSelections(e))},i.prototype.getSelection=function(){return this.cm.display.wrapper.ownerDocument.getSelection()},i.prototype.showPrimarySelection=function(){var e=this.getSelection(),t=this.cm,r=t.doc.sel.primary(),n=r.from(),r=r.to();if(t.display.viewTo==t.display.viewFrom||n.line>=t.display.viewTo||r.line<t.display.viewFrom)e.removeAllRanges();else{var i=Is(t,e.anchorNode,e.anchorOffset),o=Is(t,e.focusNode,e.focusOffset);if(!i||i.bad||!o||o.bad||0!=D(Tt(i,o),n)||0!=D(Et(i,o),r)){var i=t.display.view,o=n.line>=t.display.viewFrom&&Ns(t,n)||{node:i[0].measure.map[2],offset:0},n=r.line<t.display.viewTo&&Ns(t,r);if(n||(n={node:(i=(r=i[i.length-1].measure).maps?r.maps[r.maps.length-1]:r.map)[i.length-1],offset:i[i.length-2]-i[i.length-3]}),o&&n){var s,r=e.rangeCount&&e.getRangeAt(0);try{s=oe(o.node,o.offset,n.offset,n.node)}catch(e){}s&&(!m&&t.state.focused&&(e.collapse(o.node,o.offset),s.collapsed)||(e.removeAllRanges(),e.addRange(s)),r&&null==e.anchorNode?e.addRange(r):m&&this.startGracePeriod()),this.rememberSelection()}else e.removeAllRanges()}}},i.prototype.startGracePeriod=function(){var e=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){e.gracePeriod=!1,e.selectionChanged()&&e.cm.operation(function(){return e.cm.curOp.selectionChanged=!0})},20)},i.prototype.showMultipleSelections=function(e){v(this.cm.display.cursorDiv,e.cursors),v(this.cm.display.selectionDiv,e.selection)},i.prototype.rememberSelection=function(){var e=this.getSelection();this.lastAnchorNode=e.anchorNode,this.lastAnchorOffset=e.anchorOffset,this.lastFocusNode=e.focusNode,this.lastFocusOffset=e.focusOffset},i.prototype.selectionInEditor=function(){var e=this.getSelection();return!!e.rangeCount&&(e=e.getRangeAt(0).commonAncestorContainer,re(this.div,e))},i.prototype.focus=function(){"nocursor"!=this.cm.options.readOnly&&(this.selectionInEditor()&&A(this.div.ownerDocument)==this.div||this.showSelection(this.prepareSelection(),!0),this.div.focus())},i.prototype.blur=function(){this.div.blur()},i.prototype.getField=function(){return this.div},i.prototype.supportsTouch=function(){return!0},i.prototype.receivedFocus=function(){var e=this,t=this;this.selectionInEditor()?setTimeout(function(){return e.pollSelection()},20):d(this.cm,function(){return t.cm.curOp.selectionChanged=!0}),this.polling.set(this.cm.options.pollInterval,function e(){t.cm.state.focused&&(t.pollSelection(),t.polling.set(t.cm.options.pollInterval,e))})},i.prototype.selectionChanged=function(){var e=this.getSelection();return e.anchorNode!=this.lastAnchorNode||e.anchorOffset!=this.lastAnchorOffset||e.focusNode!=this.lastFocusNode||e.focusOffset!=this.lastFocusOffset},i.prototype.pollSelection=function(){var e,t,r,n;null==this.readDOMTimeout&&!this.gracePeriod&&this.selectionChanged()&&(e=this.getSelection(),t=this.cm,G&&$&&this.cm.display.gutterSpecs.length&&function(e){for(var t=e;t;t=t.parentNode)if(/CodeMirror-gutter-wrapper/.test(t.className))return 1;return}(e.anchorNode)?(this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs}),this.blur(),this.focus()):this.composing||(this.rememberSelection(),r=Is(t,e.anchorNode,e.anchorOffset),n=Is(t,e.focusNode,e.focusOffset),r&&n&&d(t,function(){W(t.doc,mi(r,n),ge),(r.bad||n.bad)&&(t.curOp.selectionChanged=!0)})))},i.prototype.pollContent=function(){null!=this.readDOMTimeout&&(clearTimeout(this.readDOMTimeout),this.readDOMTimeout=null);var e,t=this.cm,r=t.display,n=t.doc.sel.primary(),i=n.from(),n=n.to();if(0==i.ch&&i.line>t.firstLine()&&(i=k(i.line-1,I(t.doc,i.line-1).length)),n.ch==I(t.doc,n.line).text.length&&n.line<t.lastLine()&&(n=k(n.line+1,0)),i.line<r.viewFrom||n.line>r.viewTo-1)return!1;var o,s=i.line==r.viewFrom||0==(s=fn(t,i.line))?(e=M(r.view[0].line),r.view[0].node):(e=M(r.view[s].line),r.view[s-1].node.nextSibling),n=fn(t,n.line),r=n==r.view.length-1?(o=r.viewTo-1,r.lineDiv.lastChild):(o=M(r.view[n+1].line)-1,r.view[n+1].node.previousSibling);if(!s)return!1;for(var a=t.doc.splitLines(function(o,e,t,s,a){var r="",l=!1,c=o.doc.lineSeparator(),u=!1;function d(){l&&(r+=c,u&&(r+=c),l=u=!1)}function h(e){e&&(d(),r+=e)}for(;!function e(t){if(1==t.nodeType){var r=t.getAttribute("cm-text");if(r)h(r);else if(r=t.getAttribute("cm-marker"))(r=o.findMarks(k(s,0),k(a+1,0),(i=+r,function(e){return e.id==i}))).length&&(r=r[0].find(0))&&h(ft(o.doc,r.from,r.to).join(c));else if("false"!=t.getAttribute("contenteditable")&&(r=/^(pre|div|p|li|table|br)$/i.test(t.nodeName),/^br$/i.test(t.nodeName)||0!=t.textContent.length)){r&&d();for(var n=0;n<t.childNodes.length;n++)e(t.childNodes[n]);/^(pre|p)$/i.test(t.nodeName)&&(u=!0),r&&(l=!0)}}else 3==t.nodeType&&h(t.nodeValue.replace(/\u200b/g,"").replace(/\u00a0/g," "));var i}(e),e!=t;)e=e.nextSibling,u=!1;return r}(t,s,r,e,o)),l=ft(t.doc,k(e,0),k(o,I(t.doc,o).text.length));1<a.length&&1<l.length;)if(H(a)==H(l))a.pop(),l.pop(),o--;else{if(a[0]!=l[0])break;a.shift(),l.shift(),e++}for(var c=0,u=0,d=a[0],h=l[0],p=Math.min(d.length,h.length);c<p&&d.charCodeAt(c)==h.charCodeAt(c);)++c;for(var f=H(a),g=H(l),m=Math.min(f.length-(1==a.length?c:0),g.length-(1==l.length?c:0));u<m&&f.charCodeAt(f.length-u-1)==g.charCodeAt(g.length-u-1);)++u;if(1==a.length&&1==l.length&&e==i.line)for(;c&&c>i.ch&&f.charCodeAt(f.length-u-1)==g.charCodeAt(g.length-u-1);)c--,u++;a[a.length-1]=f.slice(0,f.length-u).replace(/^\u200b+/,""),a[0]=a[0].slice(c).replace(/\u200b+$/,"");n=k(e,c),s=k(o,l.length?H(l).length-u:0);return 1<a.length||a[0]||D(n,s)?(io(t.doc,a,n,s,"+input"),!0):void 0},i.prototype.ensurePolled=function(){this.forceCompositionEnd()},i.prototype.reset=function(){this.forceCompositionEnd()},i.prototype.forceCompositionEnd=function(){this.composing&&(clearTimeout(this.readDOMTimeout),this.composing=null,this.updateFromDOM(),this.div.blur(),this.div.focus())},i.prototype.readFromDOMSoon=function(){var e=this;null==this.readDOMTimeout&&(this.readDOMTimeout=setTimeout(function(){if(e.readDOMTimeout=null,e.composing){if(!e.composing.done)return;e.composing=null}e.updateFromDOM()},80))},i.prototype.updateFromDOM=function(){var e=this;!this.cm.isReadOnly()&&this.pollContent()||d(this.cm,function(){return L(e.cm)})},i.prototype.setUneditable=function(e){e.contentEditable="false"},i.prototype.onKeyPress=function(e){0==e.charCode||this.composing||(e.preventDefault(),this.cm.isReadOnly())||F(this.cm,Cs)(this.cm,String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),0)},i.prototype.readOnlyChanged=function(e){this.div.contentEditable=String("nocursor"!=e)},i.prototype.onContextMenu=function(){},i.prototype.resetPosition=function(){},i.prototype.needsContentAttribute=!0;function o(e){this.cm=e,this.prevInput="",this.pollingFast=!1,this.polling=new he,this.hasSelection=!1,this.composing=null}var Ms,ks,Ds,Ps,Ls;function s(e,t,n,r){Ms.defaults[e]=t,n&&(ks[e]=r?function(e,t,r){r!=hs&&n(e,t,r)}:n)}o.prototype.init=function(r){var e=this,n=this,i=this.cm,o=(this.createField(r),this.textarea);function t(e){if(!O(i,e)){if(i.somethingSelected())ws({lineWise:!1,text:i.getSelections()});else{if(!i.options.lineWiseCopyCut)return;var t=Ss(i);ws({lineWise:!0,text:t.text}),"cut"==e.type?i.setSelections(t.ranges,null,ge):(n.prevInput="",o.value=t.text.join("\n"),se(o))}"cut"==e.type&&(i.state.cutIncoming=+new Date)}}r.wrapper.insertBefore(this.wrapper,r.wrapper.firstChild),h&&(o.style.width="0px"),S(o,"input",function(){w&&9<=y&&e.hasSelection&&(e.hasSelection=null),n.poll()}),S(o,"paste",function(e){O(i,e)||Es(e,i)||(i.state.pasteIncoming=+new Date,n.fastPoll())}),S(o,"cut",t),S(o,"copy",t),S(r.scroller,"paste",function(e){var t;Rr(r,e)||O(i,e)||(o.dispatchEvent?((t=new Event("paste")).clipboardData=e.clipboardData,o.dispatchEvent(t)):(i.state.pasteIncoming=+new Date,n.focus()))}),S(r.lineSpace,"selectstart",function(e){Rr(r,e)||x(e)}),S(o,"compositionstart",function(){var e=i.getCursor("from");n.composing&&n.composing.range.clear(),n.composing={start:e,range:i.markText(e,i.getCursor("to"),{className:"CodeMirror-composing"})}}),S(o,"compositionend",function(){n.composing&&(n.poll(),n.composing.range.clear(),n.composing=null)})},o.prototype.createField=function(e){this.wrapper=xs(),this.textarea=this.wrapper.firstChild},o.prototype.screenReaderLabelChanged=function(e){e?this.textarea.setAttribute("aria-label",e):this.textarea.removeAttribute("aria-label")},o.prototype.prepareSelection=function(){var e,t=this.cm,r=t.display,n=t.doc,i=wn(t);return t.options.moveInputWithCursor&&(t=Jr(t,n.sel.primary().head,"div"),n=r.wrapper.getBoundingClientRect(),e=r.lineDiv.getBoundingClientRect(),i.teTop=Math.max(0,Math.min(r.wrapper.clientHeight-10,t.top+e.top-n.top)),i.teLeft=Math.max(0,Math.min(r.wrapper.clientWidth-10,t.left+e.left-n.left))),i},o.prototype.showSelection=function(e){var t=this.cm.display;v(t.cursorDiv,e.cursors),v(t.selectionDiv,e.selection),null!=e.teTop&&(this.wrapper.style.top=e.teTop+"px",this.wrapper.style.left=e.teLeft+"px")},o.prototype.reset=function(e){var t,r;this.contextMenuPending||this.composing||((t=this.cm).somethingSelected()?(this.prevInput="",r=t.getSelection(),this.textarea.value=r,t.state.focused&&se(this.textarea),w&&9<=y&&(this.hasSelection=r)):e||(this.prevInput=this.textarea.value="",w&&9<=y&&(this.hasSelection=null)))},o.prototype.getField=function(){return this.textarea},o.prototype.supportsTouch=function(){return!1},o.prototype.focus=function(){if("nocursor"!=this.cm.options.readOnly&&(!q||A(this.textarea.ownerDocument)!=this.textarea))try{this.textarea.focus()}catch(e){}},o.prototype.blur=function(){this.textarea.blur()},o.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0},o.prototype.receivedFocus=function(){this.slowPoll()},o.prototype.slowPoll=function(){var e=this;this.pollingFast||this.polling.set(this.cm.options.pollInterval,function(){e.poll(),e.cm.state.focused&&e.slowPoll()})},o.prototype.fastPoll=function(){var t=!1,r=this;r.pollingFast=!0,r.polling.set(20,function e(){r.poll()||t?(r.pollingFast=!1,r.slowPoll()):(t=!0,r.polling.set(60,e))})},o.prototype.poll=function(){var e=this,t=this.cm,r=this.textarea,n=this.prevInput;if(this.contextMenuPending||!t.state.focused||rt(r)&&!n&&!this.composing||t.isReadOnly()||t.options.disableInput||t.state.keySeq)return!1;var i=r.value;if(i==n&&!t.somethingSelected())return!1;if(w&&9<=y&&this.hasSelection===i||E&&/[\uf700-\uf7ff]/.test(i))return t.display.input.reset(),!1;if(t.doc.sel==t.display.selForContextMenu){var o=i.charCodeAt(0);if(8203==o&&(n=n||"​"),8666==o)return this.reset(),this.cm.execCommand("undo")}for(var s=0,a=Math.min(n.length,i.length);s<a&&n.charCodeAt(s)==i.charCodeAt(s);)++s;return d(t,function(){Cs(t,i.slice(s),n.length-s,null,e.composing?"*compose":null),1e3<i.length||-1<i.indexOf("\n")?r.value=e.prevInput="":e.prevInput=i,e.composing&&(e.composing.range.clear(),e.composing.range=t.markText(e.composing.start,t.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},o.prototype.ensurePolled=function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},o.prototype.onKeyPress=function(){w&&9<=y&&(this.hasSelection=null),this.fastPoll()},o.prototype.onContextMenu=function(e){var r,n,t,i,o=this,s=o.cm,a=s.display,l=o.textarea,c=(o.contextMenuPending&&o.contextMenuPending(),pn(s,e)),u=a.scroller.scrollTop;function d(){var e,t;null!=l.selectionStart&&(t="​"+((e=s.somethingSelected())?l.value:""),l.value="⇚",l.value=t,o.prevInput=e?"":"​",l.selectionStart=1,l.selectionEnd=t.length,a.selForContextMenu=s.doc.sel)}function h(){var e,t;o.contextMenuPending==h&&(o.contextMenuPending=!1,o.wrapper.style.cssText=n,l.style.cssText=r,w&&y<9&&a.scrollbars.setScrollTop(a.scroller.scrollTop=u),null!=l.selectionStart)&&((!w||y<9)&&d(),e=0,t=function(){a.selForContextMenu==s.doc.sel&&0==l.selectionStart&&0<l.selectionEnd&&"​"==o.prevInput?F(s,Ji)(s):e++<10?a.detectingSelectAll=setTimeout(t,500):(a.selForContextMenu=null,a.input.reset())},a.detectingSelectAll=setTimeout(t,200))}c&&!j&&(s.options.resetSelectionOnContextMenu&&-1==s.doc.sel.contains(c)&&F(s,W)(s.doc,mi(c),ge),r=l.style.cssText,n=o.wrapper.style.cssText,c=o.wrapper.offsetParent.getBoundingClientRect(),o.wrapper.style.cssText="position: static",l.style.cssText="position: absolute; width: 30px; height: 30px;\n      top: "+(e.clientY-c.top-5)+"px; left: "+(e.clientX-c.left-5)+"px;\n      z-index: 1000; background: "+(w?"rgba(255, 255, 255, .05)":"transparent")+";\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",C&&(t=l.ownerDocument.defaultView.scrollY),a.input.focus(),C&&l.ownerDocument.defaultView.scrollTo(null,t),a.input.reset(),s.somethingSelected()||(l.value=o.prevInput=" "),o.contextMenuPending=h,a.selForContextMenu=s.doc.sel,clearTimeout(a.detectingSelectAll),w&&9<=y&&d(),J?(Ke(e),i=function(){_(window,"mouseup",i),setTimeout(h,20)},S(window,"mouseup",i)):setTimeout(h,50))},o.prototype.readOnlyChanged=function(e){e||this.reset(),this.textarea.disabled="nocursor"==e,this.textarea.readOnly=!!e},o.prototype.setUneditable=function(){},o.prototype.needsContentAttribute=!1,ks=(Ms=f).optionHandlers,Ms.defineOption=s,Ms.Init=hs,s("value","",function(e,t){return e.setValue(t)},!0),s("mode",null,function(e,t){e.doc.modeOption=t,Ci(e)},!0),s("indentUnit",2,Ci,!0),s("indentWithTabs",!1),s("smartIndent",!0),s("tabSize",4,function(e){Ei(e),jr(e),L(e)},!0),s("lineSeparator",null,function(e,n){if(e.doc.lineSep=n){var i=[],o=e.doc.first;e.doc.iter(function(e){for(var t=0;;){var r=e.text.indexOf(n,t);if(-1==r)break;t=r+n.length,i.push(k(o,r))}o++});for(var t=i.length-1;0<=t;t--)io(e.doc,n,i[t],k(i[t].line,i[t].ch+n.length))}}),s("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b\u200e\u200f\u2028\u2029\ufeff\ufff9-\ufffc]/g,function(e,t,r){e.state.specialChars=new RegExp(t.source+(t.test("\t")?"":"|\t"),"g"),r!=hs&&e.refresh()}),s("specialCharPlaceholder",dr,function(e){return e.refresh()},!0),s("electricChars",!0),s("inputStyle",q?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),s("spellcheck",!1,function(e,t){return e.getInputField().spellcheck=t},!0),s("autocorrect",!1,function(e,t){return e.getInputField().autocorrect=t},!0),s("autocapitalize",!1,function(e,t){return e.getInputField().autocapitalize=t},!0),s("rtlMoveVisually",!l),s("wholeLineUpdateBefore",!0),s("theme","default",function(e){ds(e),li(e)},!0),s("keyMap","default",function(e,t,r){t=Uo(t),r=r!=hs&&Uo(r);r&&r.detach&&r.detach(e,t),t.attach&&t.attach(e,r||null)}),s("extraKeys",null),s("configureMouse",null),s("lineWrapping",!1,ms,!0),s("gutters",[],function(e,t){e.display.gutterSpecs=si(t,e.options.lineNumbers),li(e)},!0),s("fixedGutter",!0,function(e,t){e.display.gutters.style.left=t?un(e.display)+"px":"0",e.refresh()},!0),s("coverGutterNextToScrollbar",!1,function(e){return Bn(e)},!0),s("scrollbarStyle","native",function(e){Yn(e),Bn(e),e.display.scrollbars.setScrollTop(e.doc.scrollTop),e.display.scrollbars.setScrollLeft(e.doc.scrollLeft)},!0),s("lineNumbers",!1,function(e,t){e.display.gutterSpecs=si(e.options.gutters,t),li(e)},!0),s("firstLineNumber",1,li,!0),s("lineNumberFormatter",function(e){return e},li,!0),s("showCursorWhenSelecting",!1,bn,!0),s("resetSelectionOnContextMenu",!0),s("lineWiseCopyCut",!0),s("pasteLinesPerSelection",!0),s("selectionsMayTouch",!1),s("readOnly",!1,function(e,t){"nocursor"==t&&(Rn(e),e.display.input.blur()),e.display.input.readOnlyChanged(t)}),s("screenReaderLabel",null,function(e,t){e.display.input.screenReaderLabelChanged(t=""===t?null:t)}),s("disableInput",!1,function(e,t){t||e.display.input.reset()},!0),s("dragDrop",!0,gs),s("allowDropFileTypes",null),s("cursorBlinkRate",530),s("cursorScrollMargin",0),s("cursorHeight",1,bn,!0),s("singleCursorHeightPerLine",!0,bn,!0),s("workTime",100),s("workDelay",100),s("flattenSpans",!0,Ei,!0),s("addModeClass",!1,Ei,!0),s("pollInterval",100),s("undoDepth",200,function(e,t){return e.doc.history.undoDepth=t}),s("historyEventDelay",1250),s("viewportMargin",10,function(e){return e.refresh()},!0),s("maxHighlightLength",1e4,Ei,!0),s("moveInputWithCursor",!0,function(e,t){t||e.display.input.resetPosition()}),s("tabindex",null,function(e,t){return e.display.input.getField().tabIndex=t||""}),s("autofocus",null),s("direction","ltr",function(e,t){return e.doc.setDirection(t)},!0),s("phrases",null),Ps=(Ds=f).optionHandlers,Ls=Ds.helpers={},Ds.prototype={constructor:Ds,focus:function(){le(this).focus(),this.display.input.focus()},setOption:function(e,t){var r=this.options,n=r[e];r[e]==t&&"mode"!=e||(r[e]=t,Ps.hasOwnProperty(e)&&F(this,Ps[e])(this,t,n),N(this,"optionChange",this,e))},getOption:function(e){return this.options[e]},getDoc:function(){return this.doc},addKeyMap:function(e,t){this.state.keyMaps[t?"push":"unshift"](Uo(e))},removeKeyMap:function(e){for(var t=this.state.keyMaps,r=0;r<t.length;++r)if(t[r]==e||t[r].name==e)return t.splice(r,1),!0},addOverlay:r(function(e,t){var r=e.token?e:Ds.getMode(this.options,e);if(r.startState)throw new Error("Overlays may not be stateful.");for(var n=this.state.overlays,r={mode:r,modeSpec:e,opaque:t&&t.opaque,priority:t&&t.priority||0},i=function(e){return e.priority},o=0,s=i(r);o<n.length&&i(n[o])<=s;)o++;n.splice(o,0,r),this.state.modeGen++,L(this)}),removeOverlay:r(function(e){for(var t=this.state.overlays,r=0;r<t.length;++r){var n=t[r].modeSpec;if(n==e||"string"==typeof e&&n.name==e)return t.splice(r,1),this.state.modeGen++,void L(this)}}),indentLine:r(function(e,t,r){"string"!=typeof t&&"number"!=typeof t&&(t=null==t?this.options.smartIndent?"smart":"prev":t?"add":"subtract"),vt(this.doc,e)&&vs(this,e,t,r)}),indentSelection:r(function(e){for(var t=this.doc.sel.ranges,r=-1,n=0;n<t.length;n++){var i=t[n];if(i.empty())i.head.line>r&&(vs(this,i.head.line,e,!0),r=i.head.line,n==this.doc.sel.primIndex)&&kn(this);else{for(var o=i.from(),i=i.to(),s=Math.max(r,o.line),r=Math.min(this.lastLine(),i.line-(i.ch?0:1))+1,a=s;a<r;++a)vs(this,a,e);i=this.doc.sel.ranges;0==o.ch&&t.length==i.length&&0<i[n].from().ch&&Wi(this.doc,n,new V(o,i[n].to()),ge)}}}),getTokenAt:function(e,t){return Pt(this,e,t)},getLineTokens:function(e,t){return Pt(this,k(e),t,!0)},getTokenTypeAt:function(e){e=P(this.doc,e);var t,r=Nt(this,I(this.doc,e.line)),n=0,i=(r.length-1)/2,o=e.ch;if(0==o)t=r[2];else for(;;){var s=n+i>>1;if((s?r[2*s-1]:0)>=o)i=s;else{if(!(r[2*s+1]<o)){t=r[2*s+2];break}n=1+s}}e=t?t.indexOf("overlay "):-1;return e<0?t:0==e?null:t.slice(0,e-1)},getModeAt:function(e){var t=this.doc.mode;return t.innerMode?Ds.innerMode(t,this.getTokenAt(e).state).mode:t},getHelper:function(e,t){return this.getHelpers(e,t)[0]},getHelpers:function(e,t){var r=[];if(Ls.hasOwnProperty(t)){var n=Ls[t],i=this.getModeAt(e);if("string"==typeof i[t])n[i[t]]&&r.push(n[i[t]]);else if(i[t])for(var o=0;o<i[t].length;o++){var s=n[i[t][o]];s&&r.push(s)}else i.helperType&&n[i.helperType]?r.push(n[i.helperType]):n[i.name]&&r.push(n[i.name]);for(var a=0;a<n._global.length;a++){var l=n._global[a];l.pred(i,this)&&-1==T(r,l.val)&&r.push(l.val)}}return r},getStateAfter:function(e,t){var r=this.doc;return Ot(this,(e=St(r,null==e?r.first+r.size-1:e))+1,t).state},cursorCoords:function(e,t){var r=this.doc.sel.primary(),e=null==e?r.head:"object"==typeof e?P(this.doc,e):e?r.from():r.to();return Jr(this,e,t||"page")},charCoords:function(e,t){return Xr(this,P(this.doc,e),t||"page")},coordsChar:function(e,t){return en(this,(e=Kr(this,e,t||"page")).left,e.top)},lineAtHeight:function(e,t){return e=Kr(this,{top:e,left:0},t||"page").top,yt(this.doc,e+this.display.viewOffset)},heightAtLine:function(e,t,r){var n=!1,i="number"==typeof e?(i=this.doc.first+this.doc.size-1,e<this.doc.first?e=this.doc.first:i<e&&(e=i,n=!0),I(this.doc,e)):e;return qr(this,i,{top:0,left:0},t||"page",r||n).top+(n?this.doc.height-nr(i):0)},defaultTextHeight:function(){return an(this.display)},defaultCharWidth:function(){return ln(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(e,t,r,n,i){var o,s,a=this.display,l=(e=Jr(this,P(this.doc,e))).bottom,c=e.left;t.style.position="absolute",t.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(t),a.sizer.appendChild(t),"over"==n?l=e.top:"above"!=n&&"near"!=n||(s=Math.max(a.wrapper.clientHeight,this.doc.height),o=Math.max(a.sizer.clientWidth,a.lineSpace.clientWidth),("above"==n||e.bottom+t.offsetHeight>s)&&e.top>t.offsetHeight?l=e.top-t.offsetHeight:e.bottom+t.offsetHeight<=s&&(l=e.bottom),c+t.offsetWidth>o&&(c=o-t.offsetWidth)),t.style.top=l+"px",t.style.left=t.style.right="","right"==i?(c=a.sizer.clientWidth-t.offsetWidth,t.style.right="0px"):("left"==i?c=0:"middle"==i&&(c=(a.sizer.clientWidth-t.offsetWidth)/2),t.style.left=c+"px"),r&&(n=this,s={left:c,top:l,right:c+t.offsetWidth,bottom:l+t.offsetHeight},null!=(s=In(n,s)).scrollTop&&Fn(n,s.scrollTop),null!=s.scrollLeft)&&Un(n,s.scrollLeft)},triggerOnKeyDown:r(es),triggerOnKeyPress:r(rs),triggerOnKeyUp:ts,triggerOnMouseDown:r(ss),execCommand:function(e){if(zo.hasOwnProperty(e))return zo[e].call(null,this)},triggerElectric:r(function(e){Ts(this,e)}),findPosH:function(e,t,r,n){for(var i=1,o=(t<0&&(i=-1,t=-t),P(this.doc,e)),s=0;s<t&&!(o=Rs(this.doc,o,i,r,n)).hitSide;++s);return o},moveH:r(function(t,r){var n=this;this.extendSelectionsBy(function(e){return n.display.shift||n.doc.extend||e.empty()?Rs(n.doc,e.head,t,r,n.options.rtlMoveVisually):t<0?e.from():e.to()},ye)}),deleteH:r(function(r,n){var e=this.doc.sel,i=this.doc;e.somethingSelected()?i.replaceSelection("",null,"+delete"):Vo(this,function(e){var t=Rs(i,e.head,r,n,!1);return r<0?{from:t,to:e.head}:{from:e.head,to:t}})}),findPosV:function(e,t,r,n){for(var i=1,o=n,s=(t<0&&(i=-1,t=-t),P(this.doc,e)),a=0;a<t;++a){var l=Jr(this,s,"div");if(null==o?o=l.left:l.left=o,(s=As(this,l,i,r)).hitSide)break}return s},moveV:r(function(n,i){var o=this,s=this.doc,a=[],l=!this.display.shift&&!s.extend&&s.sel.somethingSelected();if(s.extendSelectionsBy(function(e){var t,r;return l?n<0?e.from():e.to():(t=Jr(o,e.head,"div"),null!=e.goalColumn&&(t.left=e.goalColumn),a.push(t.left),r=As(o,t,n,i),"page"==i&&e==s.sel.primary()&&Mn(o,Xr(o,r,"div").top-t.top),r)},ye),a.length)for(var e=0;e<s.sel.ranges.length;e++)s.sel.ranges[e].goalColumn=a[e]}),findWordAt:function(e){var t=I(this.doc,e.line).text,r=e.ch,n=e.ch;if(t){for(var i=this.getHelper(e,"wordChars"),o=("before"!=e.sticky&&n!=t.length||!r?++n:--r,t.charAt(r)),s=xe(o,i)?function(e){return xe(e,i)}:/\s/.test(o)?function(e){return/\s/.test(e)}:function(e){return!/\s/.test(e)&&!xe(e)};0<r&&s(t.charAt(r-1));)--r;for(;n<t.length&&s(t.charAt(n));)++n}return new V(k(e.line,r),k(e.line,n))},toggleOverwrite:function(e){null!=e&&e==this.state.overwrite||(((this.state.overwrite=!this.state.overwrite)?ne:Q)(this.display.cursorDiv,"CodeMirror-overwrite"),N(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==A(ae(this))},isReadOnly:function(){return!(!this.options.readOnly&&!this.doc.cantEdit)},scrollTo:r(function(e,t){Dn(this,e,t)}),getScrollInfo:function(){var e=this.display.scroller;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight-Ir(this)-this.display.barHeight,width:e.scrollWidth-Ir(this)-this.display.barWidth,clientHeight:kr(this),clientWidth:Mr(this)}},scrollIntoView:r(function(e,t){var r;null==e?(e={from:this.doc.sel.primary().head,to:null},null==t&&(t=this.options.cursorScrollMargin)):"number"==typeof e?e={from:k(e,0),to:null}:null==e.from&&(e={from:e,to:null}),e.to||(e.to=e.from),e.margin=t||0,null!=e.from.line?(t=e,Pn(r=this),r.curOp.scrollToPos=t):Ln(this,e.from,e.to,e.margin)}),setSize:r(function(e,t){function r(e){return"number"==typeof e||/^\d+$/.test(String(e))?e+"px":e}var n=this,i=(null!=e&&(this.display.wrapper.style.width=r(e)),null!=t&&(this.display.wrapper.style.height=r(t)),this.options.lineWrapping&&Br(this),this.display.viewFrom);this.doc.iter(i,this.display.viewTo,function(e){if(e.widgets)for(var t=0;t<e.widgets.length;t++)if(e.widgets[t].noHScroll){gn(n,i,"widget");break}++i}),this.curOp.forceUpdate=!0,N(this,"refresh",this)}),operation:function(e){return d(this,e)},startOperation:function(){return qn(this)},endOperation:function(){return Kn(this)},refresh:r(function(){var e=this.display.cachedTextHeight;L(this),this.curOp.forceUpdate=!0,jr(this),Dn(this,this.doc.scrollLeft,this.doc.scrollTop),ri(this.display),(null==e||.5<Math.abs(e-an(this.display))||this.options.lineWrapping)&&hn(this),N(this,"refresh",this)}),swapDoc:r(function(e){var t=this.doc;return t.cm=null,this.state.selectingText&&this.state.selectingText(),xi(this,e),jr(this),this.display.input.reset(),Dn(this,e.scrollLeft,e.scrollTop),this.curOp.forceScroll=!0,b(this,"swapDoc",this,t),t}),phrase:function(e){var t=this.options.phrases;return t&&Object.prototype.hasOwnProperty.call(t,e)?t[e]:e},getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},Ye(Ds),Ds.registerHelper=function(e,t,r){Ls.hasOwnProperty(e)||(Ls[e]=Ds[e]={_global:[]}),Ls[e][t]=r},Ds.registerGlobalHelper=function(e,t,r,n){Ds.registerHelper(e,t,n),Ls[e]._global.push({pred:r,val:n})};var Fs,Hs="iter insert remove copy getEditor constructor".split(" ");for(Fs in p.prototype)p.prototype.hasOwnProperty(Fs)&&T(Hs,Fs)<0&&(f.prototype[Fs]=function(e){return function(){return e.apply(this.doc,arguments)}}(p.prototype[Fs]));return Ye(p),f.inputStyles={textarea:o,contenteditable:i},f.defineMode=function(e){f.defaults.mode||"null"==e||(f.defaults.mode=e),function(e,t){2<arguments.length&&(t.dependencies=Array.prototype.slice.call(arguments,2)),ot[e]=t}.apply(this,arguments)},f.defineMIME=function(e,t){st[e]=t},f.defineMode("null",function(){return{token:function(e){return e.skipToEnd()}}}),f.defineMIME("text/plain","null"),f.defineExtension=function(e,t){f.prototype[e]=t},f.defineDocExtension=function(e,t){p.prototype[e]=t},f.fromTextArea=function(t,r){var e;function n(){t.value=a.getValue()}if((r=r?ue(r):{}).value=t.value,!r.tabindex&&t.tabIndex&&(r.tabindex=t.tabIndex),!r.placeholder&&t.placeholder&&(r.placeholder=t.placeholder),null==r.autofocus&&(e=A(t.ownerDocument),r.autofocus=e==t||null!=t.getAttribute("autofocus")&&e==document.body),t.form&&(S(t.form,"submit",n),!r.leaveSubmitMethodAlone)){var i=t.form,o=i.submit;try{var s=i.submit=function(){n(),i.submit=o,i.submit(),i.submit=s}}catch(e){}}r.finishInit=function(e){e.save=n,e.getTextArea=function(){return t},e.toTextArea=function(){e.toTextArea=isNaN,n(),t.parentNode.removeChild(e.getWrapperElement()),t.style.display="",t.form&&(_(t.form,"submit",n),r.leaveSubmitMethodAlone||"function"!=typeof t.form.submit||(t.form.submit=o))}},t.style.display="none";var a=f(function(e){return t.parentNode.insertBefore(e,t.nextSibling)},r);return a},(t=f).off=_,t.on=S,t.wheelEventPixels=pi,t.Doc=p,t.splitLines=tt,t.countColumn=de,t.findColumn=ve,t.isWordChar=_e,t.Pass=fe,t.signal=N,t.Line=sr,t.changeEnd=yi,t.scrollbarModel=zn,t.Pos=k,t.cmpPos=D,t.modes=ot,t.mimeModes=st,t.resolveMode=at,t.getMode=lt,t.modeExtensions=ct,t.extendMode=ut,t.copyState=dt,t.startState=pt,t.innerMode=ht,t.commands=zo,t.keyMap=Mo,t.keyName=Ho,t.isModifierKey=Lo,t.lookupKey=Po,t.normalizeKeyMap=Do,t.StringStream=g,t.SharedTextMarker=yo,t.TextMarker=fo,t.LineWidget=ho,t.e_preventDefault=x,t.e_stopPropagation=Ge,t.e_stop=Ke,t.addClass=ne,t.contains=re,t.rmClass=Q,t.keyNames=Ao,f.version="6.65.7",f}),!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():e.download=t()}(this,function(){return function t(e,r,n){function i(e){return String(e)}var o=window,s="application/octet-stream",a=n||s,l=e,e=!r&&!n&&l,c=document.createElement("a"),u=o.Blob||o.MozBlob||o.WebKitBlob||i,d=r||"download",u=u.call?u.bind(o):Blob;if("true"===String(this)&&(a=(l=[l,a])[0],l=l[1]),e&&e.length<2048){var h,d=e.split("/").pop().split("?")[0];if(c.href=e,-1!==c.href.indexOf(e))return(h=new XMLHttpRequest).open("GET",e,!0),h.responseType="blob",h.onload=function(e){t(e.target.response,d,s)},setTimeout(function(){h.send()},0),h}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(l)){if(!(2096103.424<l.length&&u!==i))return navigator.msSaveBlob?navigator.msSaveBlob(m(l),d):y(l);a=(l=m(l)).type||s}else if(/([\x80-\xff])/.test(l)){for(var p=0,f=new Uint8Array(l.length),g=f.length;p<g;++p)f[p]=l.charCodeAt(p);l=new u([f],{type:a})}function m(e){for(var t=e.split(/[:;,]/),r=t[1],n=("base64"==t[0<e.indexOf("charset")?3:2]?atob:decodeURIComponent)(t.pop()),i=n.length,o=0,s=new Uint8Array(i);o<i;++o)s[o]=n.charCodeAt(o);return new u([s],{type:r})}function y(e,t){var r;return"download"in c?(c.href=e,c.setAttribute("download",d),c.className="download-js-link",c.innerHTML="downloading...",c.style.display="none",c.addEventListener("click",function(e){e.stopPropagation(),this.removeEventListener("click",arguments.callee)}),document.body.appendChild(c),setTimeout(function(){c.click(),document.body.removeChild(c),!0===t&&setTimeout(function(){o.URL.revokeObjectURL(c.href)},250)},66),!0):/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent)?(/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,s)),window.open(e)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=e),!0):(r=document.createElement("iframe"),document.body.appendChild(r),!t&&/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,s)),r.src=e,void setTimeout(function(){document.body.removeChild(r)},333))}if(n=l instanceof u?l:new u([l],{type:a}),navigator.msSaveBlob)return navigator.msSaveBlob(n,d);if(o.URL)y(o.URL.createObjectURL(n),!0);else{if("string"==typeof n||n.constructor===i)try{return y("data:"+a+";base64,"+o.btoa(n))}catch(e){return y("data:"+a+","+encodeURIComponent(n))}(r=new FileReader).onload=function(e){y(this.result)},r.readAsDataURL(n)}return!0}}),!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).Mustache=t()}(this,function(){"use strict";var t=Object.prototype.toString,I=Array.isArray||function(e){return"[object Array]"===t.call(e)};function u(e){return"function"==typeof e}function M(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function d(e,t){return null!=e&&"object"==typeof e&&t in e}var r=RegExp.prototype.test;var n=/\S/;function k(e){return!r.call(n,e)}var i={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};var D=/\s*/,P=/\s+/,L=/\s*=/,F=/\s*\}/,H=/#|\^|\/|>|\{|&|=|!/;function s(e,t){if(!e)return[];var r,n,i,o=!1,s=[],a=[],l=[],c=!1,u=!1,d="",h=0;function p(){if(c&&!u)for(;l.length;)delete a[l.pop()];else l=[];u=c=!1}function f(e){if("string"==typeof e&&(e=e.split(P,2)),!I(e)||2!==e.length)throw new Error("Invalid tags: "+e);r=new RegExp(M(e[0])+"\\s*"),n=new RegExp("\\s*"+M(e[1])),i=new RegExp("\\s*"+M("}"+e[1]))}f(t||V.tags);for(var g,m,y,v,b,w,C=new U(e);!C.eos();){if(g=C.pos,y=C.scanUntil(r))for(var E=0,T=y.length;E<T;++E)k(v=y.charAt(E))?(l.push(a.length),d+=v):(o=u=!0,d+=" "),a.push(["text",v,g,g+1]),g+=1,"\n"===v&&(p(),d="",h=0,o=!1);if(!C.scan(r))break;if(c=!0,m=C.scan(H)||"name",C.scan(D),"="===m?(y=C.scanUntil(L),C.scan(L),C.scanUntil(n)):"{"===m?(y=C.scanUntil(i),C.scan(F),C.scanUntil(n),m="&"):y=C.scanUntil(n),!C.scan(n))throw new Error("Unclosed tag at "+C.pos);if(b=">"==m?[m,y,g,C.pos,d,h,o]:[m,y,g,C.pos],h++,a.push(b),"#"===m||"^"===m)s.push(b);else if("/"===m){if(!(w=s.pop()))throw new Error('Unopened section "'+y+'" at '+g);if(w[1]!==y)throw new Error('Unclosed section "'+w[1]+'" at '+g)}else"name"===m||"{"===m||"&"===m?u=!0:"="===m&&f(y)}if(p(),w=s.pop())throw new Error('Unclosed section "'+w[1]+'" at '+C.pos);for(var S,_=function(e){for(var t,r,n=[],i=0,o=e.length;i<o;++i)(t=e[i])&&("text"===t[0]&&r&&"text"===r[0]?(r[1]+=t[1],r[3]=t[3]):(n.push(t),r=t));return n}(a),x=[],R=x,A=[],N=0,O=_.length;N<O;++N)switch((S=_[N])[0]){case"#":case"^":R.push(S),A.push(S),R=S[4]=[];break;case"/":A.pop()[5]=S[2],R=0<A.length?A[A.length-1][4]:x;break;default:R.push(S)}return x}function U(e){this.string=e,this.tail=e,this.pos=0}function o(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function e(){this.templateCache={_cache:{},set:function(e,t){this._cache[e]=t},get:function(e){return this._cache[e]},clear:function(){this._cache={}}}}U.prototype.eos=function(){return""===this.tail},U.prototype.scan=function(e){var e=this.tail.match(e);return e&&0===e.index?(e=e[0],this.tail=this.tail.substring(e.length),this.pos+=e.length,e):""},U.prototype.scanUntil=function(e){var t,r=this.tail.search(e);switch(r){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,r),this.tail=this.tail.substring(r)}return this.pos+=t.length,t},o.prototype.push=function(e){return new o(e,this)},o.prototype.lookup=function(e){var t,r,n,i=this.cache;if(i.hasOwnProperty(e))t=i[e];else{for(var o,s,a,l=this,c=!1;l;){if(0<e.indexOf("."))for(o=l.view,s=e.split("."),a=0;null!=o&&a<s.length;)a===s.length-1&&(c=d(o,s[a])||(r=o,n=s[a],null!=r&&"object"!=typeof r&&r.hasOwnProperty&&r.hasOwnProperty(n))),o=o[s[a++]];else o=l.view[e],c=d(l.view,e);if(c){t=o;break}l=l.parent}i[e]=t}return t=u(t)?t.call(this.view):t},e.prototype.clearCache=function(){void 0!==this.templateCache&&this.templateCache.clear()},e.prototype.parse=function(e,t){var r=this.templateCache,n=e+":"+(t||V.tags).join(":"),i=void 0!==r,o=i?r.get(n):void 0;return null==o&&(o=s(e,t),i)&&r.set(n,o),o},e.prototype.render=function(e,t,r,n){var i=this.getConfigTags(n),i=this.parse(e,i),t=t instanceof o?t:new o(t,void 0);return this.renderTokens(i,t,r,e,n)},e.prototype.renderTokens=function(e,t,r,n,i){for(var o,s,a,l="",c=0,u=e.length;c<u;++c)a=void 0,"#"===(s=(o=e[c])[0])?a=this.renderSection(o,t,r,n,i):"^"===s?a=this.renderInverted(o,t,r,n,i):">"===s?a=this.renderPartial(o,t,r,i):"&"===s?a=this.unescapedValue(o,t):"name"===s?a=this.escapedValue(o,t,i):"text"===s&&(a=this.rawValue(o)),void 0!==a&&(l+=a);return l},e.prototype.renderSection=function(e,t,r,n,i){var o=this,s="",a=t.lookup(e[1]);if(a){if(I(a))for(var l=0,c=a.length;l<c;++l)s+=this.renderTokens(e[4],t.push(a[l]),r,n,i);else if("object"==typeof a||"string"==typeof a||"number"==typeof a)s+=this.renderTokens(e[4],t.push(a),r,n,i);else if(u(a)){if("string"!=typeof n)throw new Error("Cannot use higher-order sections without the original template");null!=(a=a.call(t.view,n.slice(e[3],e[5]),function(e){return o.render(e,t,r,i)}))&&(s+=a)}else s+=this.renderTokens(e[4],t,r,n,i);return s}},e.prototype.renderInverted=function(e,t,r,n,i){var o=t.lookup(e[1]);if(!o||I(o)&&0===o.length)return this.renderTokens(e[4],t,r,n,i)},e.prototype.indentPartial=function(e,t,r){for(var n=t.replace(/[^ \t]/g,""),i=e.split("\n"),o=0;o<i.length;o++)i[o].length&&(0<o||!r)&&(i[o]=n+i[o]);return i.join("\n")},e.prototype.renderPartial=function(e,t,r,n){var i,o,s,a,l;if(r)return i=this.getConfigTags(n),null!=(o=u(r)?r(e[1]):r[e[1]])?(s=e[6],l=e[5],e=e[4],a=o,0==l&&e&&(a=this.indentPartial(o,e,s)),l=this.parse(a,i),this.renderTokens(l,t,r,a,n)):void 0},e.prototype.unescapedValue=function(e,t){t=t.lookup(e[1]);if(null!=t)return t},e.prototype.escapedValue=function(e,t,r){r=this.getConfigEscape(r)||V.escape,t=t.lookup(e[1]);if(null!=t)return("number"==typeof t&&r===V.escape?String:r)(t)},e.prototype.rawValue=function(e){return e[1]},e.prototype.getConfigTags=function(e){return I(e)?e:e&&"object"==typeof e?e.tags:void 0},e.prototype.getConfigEscape=function(e){if(e&&"object"==typeof e&&!I(e))return e.escape};var V={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(e){a.templateCache=e},get templateCache(){return a.templateCache}},a=new e;return V.clearCache=function(){return a.clearCache()},V.parse=function(e,t){return a.parse(e,t)},V.render=function(e,t,r,n){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+(I(i=e)?"array":typeof i)+'" was given as the first argument for mustache#render(template, view, partials)');var i;return a.render(e,t,r,n)},V.escape=function(e){return String(e).replace(/[&<>"'`=\/]/g,function(e){return i[e]})},V.Scanner=U,V.Context=o,V.Writer=e,V}),!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof module&&module.exports?module.exports=t():e.PDFObject=t()}(this,function(){"use strict";if("undefined"==typeof window||void 0===window.navigator||void 0===window.navigator.userAgent)return!1;let v=window,e=v.navigator,t=e.userAgent,b=!1,r=function(e){var t=null;try{t=new ActiveXObject(e)}catch(e){t=null}return!!t};var n,i,o;function w(e,t,r,n,i,o,s,a,l,c,u){h(t);let d=r;if("pdfjs"===e?(e=-1!==u.indexOf("?")?"&":"?",d=u+e+"file="+encodeURIComponent(r)+n):d+=n,(u=document.createElement("iframe")).className="pdfobject",u.type="application/pdf",u.title=a,u.src=d,u.allow="fullscreen",u.frameborder="0",s&&(u.id=s),!l){let e="border: none;";t!==document.body?e+="width: "+i+"; height: "+o+";":e+="position: absolute; top: 0; right: 0; bottom: 0; left: 0; width: 100%; height: 100%;",u.style.cssText=e}return c&&c.key&&-1===["className","type","title","src","style","id","allow","frameborder"].indexOf(c.key)&&u.setAttribute(c.key,void 0!==c.value?c.value:""),t.classList.add("pdfobject-container"),t.appendChild(u),t.getElementsByTagName("iframe")[0]}function s(e,t,r){var n,i,o,s,t=t||!1,r=r||{},a=(b="boolean"==typeof r.suppressConsole&&r.suppressConsole,"string"==typeof r.id?r.id:""),l=r.page||!1,c=r.pdfOpenParams||{},u="string"!=typeof r.fallbackLink&&"boolean"!=typeof r.fallbackLink||r.fallbackLink,d=r.width||"100%",h=r.height||"100%",p=r.title||"Embedded PDF",f="boolean"==typeof r.forcePDFJS&&r.forcePDFJS,g="boolean"==typeof r.omitInlineStyles&&r.omitInlineStyles,m=r.PDFJS_URL||!1,t=function(e){let t=document.body;return"string"==typeof e?t=document.querySelector(e):void 0!==v.jQuery&&e instanceof jQuery&&e.length?t=e.get(0):void 0!==e.nodeType&&1===e.nodeType&&(t=e),t}(t),r=r.customAttribute||{},y="<p>This browser does not support inline PDFs. Please download the PDF to view it: [pdflink]</p>";return"string"!=typeof e?E("URL is not valid"):t?(l&&(c.page=l),l=function(e){let t="",r;var n=[];let i="";if(!(e.comment||e.viewrect||e.highlight)||e.page||(e.page=1,E("The comment, viewrect, and highlight parameters require a page parameter, but none was specified. Defaulting to page 1.")),e.page&&(n.push("page="+encodeURIComponent(e.page)),delete e.page),e.fdf&&(i=e.fdf,delete e.fdf),e){for(r in e)e.hasOwnProperty(r)&&n.push(encodeURIComponent(r)+"="+encodeURIComponent(e[r]));i&&n.push("fdf="+encodeURIComponent(i)),t=(t=n.join("&"))&&"#"+t}return t}(c),f&&m?w("pdfjs",t,e,l,d,h,a,p,g,r,m):C?w("iframe",t,e,l,d,h,a,p,g,r):m?w("pdfjs",t,e,l,d,h,a,p,g,r,m):(u&&("string"==typeof u?t.innerHTML=u.replace(/\[url\]/g,e):-1!==e.indexOf("data:application/pdf;base64")?(c=e,n="file.pdf",i=t,o=y,window.Blob&&window.URL&&window.URL.createObjectURL&&((s=new XMLHttpRequest).open("GET",c,!0),s.responseType="blob",s.onload=function(){var e,t;200===s.status&&(e=s.response,(t=document.createElement("a")).innerText="Download PDF",t.href=URL.createObjectURL(e),t.setAttribute("download",n),i.innerHTML=o.replace(/\[pdflink\]/g,t.outerHTML))},s.send())):t.innerHTML=y.replace(/\[pdflink\]/g,"<a href='"+e+"'>Download PDF</a>")),E("This browser does not support embedded PDFs"))):E("Target element cannot be determined")}let C=!(void 0!==e.platform&&"MacIntel"===e.platform&&void 0!==e.maxTouchPoints&&1<e.maxTouchPoints||/Mobi|Tablet|Android|iPad|iPhone/.test(t)||(n="boolean"==typeof e.pdfViewerEnabled)&&!e.pdfViewerEnabled)&&(n&&e.pdfViewerEnabled||(n=void 0!==v.chrome,i=void 0!==v.safari||void 0!==e.vendor&&/Apple/.test(e.vendor)&&/Safari/.test(t),o=void 0!==v.Mozilla||/irefox/.test(t),n)||i||o||"ActiveXObject"in v&&(r("AcroPDF.PDF")||r("PDF.PdfCtrl"))),E=function(e){return b||console.log("[PDFObject]",e),!1},h=function(e){for(;e.firstChild;)e.removeChild(e.firstChild)};return{embed:s,pdfobjectversion:"2.3.0",supportsPDFs:C}}),!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.printJS=t():e.printJS=t()}(window,function(){return n={},i.m=r={"./src/index.js":function(e,t,r){"use strict";r.r(t),r("./src/sass/index.scss"),r=r("./src/js/init.js").default.init,"undefined"!=typeof window&&(window.printJS=r),t.default=r},"./src/js/browser.js":function(e,t,r){"use strict";r.r(t);var n={isFirefox:function(){return"undefined"!=typeof InstallTrigger},isIE:function(){return-1!==navigator.userAgent.indexOf("MSIE")||!!document.documentMode},isEdge:function(){return!n.isIE()&&!!window.StyleMedia},isChrome:function(e){return!!(0<arguments.length&&void 0!==e?e:window).chrome},isSafari:function(){return 0<Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")||-1!==navigator.userAgent.toLowerCase().indexOf("safari")},isIOSChrome:function(){return-1!==navigator.userAgent.toLowerCase().indexOf("crios")}};t.default=n},"./src/js/functions.js":function(e,t,r){"use strict";r.r(t),r.d(t,"addWrapper",function(){return n}),r.d(t,"capitalizePrint",function(){return a}),r.d(t,"collectStyles",function(){return l}),r.d(t,"addHeader",function(){return c}),r.d(t,"cleanUp",function(){return u}),r.d(t,"isRawHTML",function(){return d});var i=r("./src/js/modal.js"),o=r("./src/js/browser.js");function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){return'<div style="font-family:'+t.font+" !important; font-size: "+t.font_size+' !important; width:100%;">'+e+"</div>"}function a(e){return e.charAt(0).toUpperCase()+e.slice(1)}function l(e,t){for(var r="",n=(document.defaultView||window).getComputedStyle(e,""),i=0;i<n.length;i++)(-1!==t.targetStyles.indexOf("*")||-1!==t.targetStyle.indexOf(n[i])||function(e,t){for(var r=0;r<e.length;r++)if("object"===s(t)&&-1!==t.indexOf(e[r]))return 1}(t.targetStyles,n[i]))&&n.getPropertyValue(n[i])&&(r+=n[i]+":"+n.getPropertyValue(n[i])+";");return r+("max-width: "+t.maxWidth+"px !important; font-size: "+t.font_size)+" !important;"}function c(e,t){var r,n,i=document.createElement("div");d(t.header)?i.innerHTML=t.header:(r=document.createElement("h1"),n=document.createTextNode(t.header),r.appendChild(n),r.setAttribute("style",t.headerStyle),i.appendChild(r)),e.insertBefore(i,e.childNodes[0])}function u(r){r.showModal&&i.default.close(),r.onLoadingEnd&&r.onLoadingEnd(),(r.showModal||r.onLoadingStart)&&window.URL.revokeObjectURL(r.printable);var n="mouseover";(o.default.isChrome()||o.default.isFirefox())&&(n="focus"),window.addEventListener(n,function e(){window.removeEventListener(n,e),r.onPrintDialogClose();var t=document.getElementById(r.frameId);t&&t.remove()})}function d(e){return new RegExp("<([A-Za-z][A-Za-z0-9]*)\\b[^>]*>(.*?)</\\1>").test(e)}},"./src/js/html.js":function(e,t,r){"use strict";r.r(t);var a=r("./src/js/functions.js"),n=r("./src/js/print.js");function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}t.default={print:function(e,t){var r="object"===i(r=e.printable)&&r&&(r instanceof HTMLElement||1===r.nodeType)?e.printable:document.getElementById(e.printable);r?(e.printableElement=function e(t,r){for(var n,i=t.cloneNode(),o=Array.prototype.slice.call(t.childNodes),s=0;s<o.length;s++)-1===r.ignoreElements.indexOf(o[s].id)&&(n=e(o[s],r),i.appendChild(n));switch(r.scanStyles&&1===t.nodeType&&i.setAttribute("style",Object(a.collectStyles)(t,r)),t.tagName){case"SELECT":i.value=t.value;break;case"CANVAS":i.getContext("2d").drawImage(t,0,0)}return i}(r,e),e.header&&Object(a.addHeader)(e.printableElement,e),n.default.send(e,t)):window.console.error("Invalid HTML element id: "+e.printable)}}},"./src/js/image.js":function(e,t,r){"use strict";r.r(t);var i=r("./src/js/functions.js"),o=r("./src/js/print.js"),s=r("./src/js/browser.js");t.default={print:function(n,e){n.printable.constructor!==Array&&(n.printable=[n.printable]),n.printableElement=document.createElement("div"),n.printable.forEach(function(e){var t=document.createElement("img"),r=(t.setAttribute("style",n.imageStyle),t.src=e,s.default.isFirefox()&&(r=t.src,t.src=r),document.createElement("div"));r.appendChild(t),n.printableElement.appendChild(r)}),n.header&&Object(i.addHeader)(n.printableElement,n),o.default.send(n,e)}}},"./src/js/init.js":function(e,t,r){"use strict";r.r(t);var s=r("./src/js/browser.js"),a=r("./src/js/modal.js"),l=r("./src/js/pdf.js"),c=r("./src/js/html.js"),u=r("./src/js/raw-html.js"),d=r("./src/js/image.js"),h=r("./src/js/json.js");function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var f=["pdf","html","image","json","raw-html"];t.default={init:function(e,t){var r={printable:null,fallbackPrintable:null,type:"pdf",header:null,headerStyle:"font-weight: 300;",maxWidth:800,properties:null,gridHeaderStyle:"font-weight: bold; padding: 5px; border: 1px solid #dddddd;",gridStyle:"border: 1px solid lightgray; margin-bottom: -1px;",showModal:!1,onError:function(e){throw e},onLoadingStart:null,onLoadingEnd:null,onPrintDialogClose:function(){},onIncompatibleBrowser:function(){},modalMessage:"Retrieving Document...",frameId:"printJS",printableElement:null,documentTitle:"Document",targetStyle:["clear","display","width","min-width","height","min-height","max-height"],targetStyles:["border","box","break","text-decoration"],ignoreElements:[],repeatTableHeader:!0,css:null,style:null,scanStyles:!0,base64:!1,onPdfOpen:null,font:"TimesNewRoman",font_size:"12pt",honorMarginPadding:!0,honorColor:!1,imageStyle:"max-width: 100%;"},n=e;if(void 0===n)throw new Error("printJS expects at least 1 attribute.");switch(p(n)){case"string":r.printable=encodeURI(n),r.fallbackPrintable=r.printable,r.type=t||r.type;break;case"object":for(var i in r.printable=n.printable,r.fallbackPrintable=void 0!==n.fallbackPrintable?n.fallbackPrintable:r.printable,r.fallbackPrintable=r.base64?"data:application/pdf;base64,".concat(r.fallbackPrintable):r.fallbackPrintable,r)"printable"!==i&&"fallbackPrintable"!==i&&(r[i]=(void 0!==n[i]?n:r)[i]);break;default:throw new Error('Unexpected argument type! Expected "string" or "object", got '+p(n))}if(!r.printable)throw new Error("Missing printable information.");if(!r.type||"string"!=typeof r.type||-1===f.indexOf(r.type.toLowerCase()))throw new Error("Invalid print type. Available types are: pdf, html, image and json.");r.showModal&&a.default.show(r),r.onLoadingStart&&r.onLoadingStart(),(t=document.getElementById(r.frameId))&&t.parentNode.removeChild(t);var o=document.createElement("iframe");switch(s.default.isFirefox()?o.setAttribute("style","width: 1px; height: 100px; position: fixed; left: 0; top: 0; opacity: 0; border-width: 0; margin: 0; padding: 0"):o.setAttribute("style","visibility: hidden; height: 0; width: 0; position: absolute; border: 0"),o.setAttribute("id",r.frameId),"pdf"!==r.type&&(o.srcdoc="<html><head><title>"+r.documentTitle+"</title>",r.css&&(Array.isArray(r.css)||(r.css=[r.css]),r.css.forEach(function(e){o.srcdoc+='<link rel="stylesheet" href="'+e+'">'})),o.srcdoc+="</head><body></body></html>"),r.type){case"pdf":if(s.default.isIE())try{console.info("Print.js doesn't support PDF printing in Internet Explorer."),window.open(r.fallbackPrintable,"_blank").focus(),r.onIncompatibleBrowser()}catch(e){r.onError(e)}finally{r.showModal&&a.default.close(),r.onLoadingEnd&&r.onLoadingEnd()}else l.default.print(r,o);break;case"image":d.default.print(r,o);break;case"html":c.default.print(r,o);break;case"raw-html":u.default.print(r,o);break;case"json":h.default.print(r,o)}}}},"./src/js/json.js":function(e,t,r){"use strict";r.r(t);var u=r("./src/js/functions.js"),n=r("./src/js/print.js");function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}t.default={print:function(t,e){if("object"!==i(t.printable))throw new Error("Invalid javascript data object (JSON).");if("boolean"!=typeof t.repeatTableHeader)throw new Error("Invalid value for repeatTableHeader attribute (JSON).");if(!t.properties||!Array.isArray(t.properties))throw new Error("Invalid properties array for your JSON data.");t.properties=t.properties.map(function(e){return{field:"object"===i(e)?e.field:e,displayName:"object"===i(e)?e.displayName:e,columnSize:"object"===i(e)&&e.columnSize?e.columnSize+";":100/t.properties.length+"%;"}}),t.printableElement=document.createElement("div"),t.header&&Object(u.addHeader)(t.printableElement,t),t.printableElement.innerHTML+=function(e){var t=e.printable,r=e.properties,n='<table style="border-collapse: collapse; width: 100%;">';e.repeatTableHeader&&(n+="<thead>"),n+="<tr>";for(var i=0;i<r.length;i++)n+='<th style="width:'+r[i].columnSize+";"+e.gridHeaderStyle+'">'+Object(u.capitalizePrint)(r[i].displayName)+"</th>";n+="</tr>",e.repeatTableHeader&&(n+="</thead>"),n+="<tbody>";for(var o=0;o<t.length;o++){n+="<tr>";for(var s=0;s<r.length;s++){var a=t[o],l=r[s].field.split(".");if(1<l.length)for(var c=0;c<l.length;c++)a=a[l[c]];else a=a[r[s].field];n+='<td style="width:'+r[s].columnSize+e.gridStyle+'">'+a+"</td>"}n+="</tr>"}return n+"</tbody></table>"}(t),n.default.send(t,e)}}},"./src/js/modal.js":function(e,t,r){"use strict";r.r(t);var i={show:function(e){var t=document.createElement("div"),r=(t.setAttribute("style","font-family:sans-serif; display:table; text-align:center; font-weight:300; font-size:30px; left:0; top:0;position:fixed; z-index: 9990;color: #0460B5; width: 100%; height: 100%; background-color:rgba(255,255,255,.9);transition: opacity .3s ease;"),t.setAttribute("id","printJS-Modal"),document.createElement("div")),n=(r.setAttribute("style","display:table-cell; vertical-align:middle; padding-bottom:100px;"),document.createElement("div"));n.setAttribute("class","printClose"),n.setAttribute("id","printClose"),r.appendChild(n),(n=document.createElement("span")).setAttribute("class","printSpinner"),r.appendChild(n),e=document.createTextNode(e.modalMessage),r.appendChild(e),t.appendChild(r),document.getElementsByTagName("body")[0].appendChild(t),document.getElementById("printClose").addEventListener("click",function(){i.close()})},close:function(){var e=document.getElementById("printJS-Modal");e&&e.parentNode.removeChild(e)}};t.default=i},"./src/js/pdf.js":function(e,t,r){"use strict";r.r(t);var n=r("./src/js/print.js"),i=r("./src/js/functions.js");function o(e,t,r){r=new window.Blob([r],{type:"application/pdf"}),r=window.URL.createObjectURL(r),t.setAttribute("src",r),n.default.send(e,t)}t.default={print:function(e,t){var r,n;e.base64?(r=Uint8Array.from(atob(e.printable),function(e){return e.charCodeAt(0)}),o(e,t,r)):(e.printable=/^(blob|http|\/\/)/i.test(e.printable)?e.printable:window.location.origin+("/"!==e.printable.charAt(0)?"/"+e.printable:e.printable),(n=new window.XMLHttpRequest).responseType="arraybuffer",n.addEventListener("error",function(){Object(i.cleanUp)(e),e.onError(n.statusText,n)}),n.addEventListener("load",function(){return-1===[200,201].indexOf(n.status)?(Object(i.cleanUp)(e),void e.onError(n.statusText,n)):void o(e,t,n.response)}),n.open("GET",e.printable,!0),n.send())}}},"./src/js/print.js":function(e,t,r){"use strict";r.r(t);var i=r("./src/js/browser.js"),n=r("./src/js/functions.js"),r={send:function(r,e){document.getElementsByTagName("body")[0].appendChild(e);var n=document.getElementById(r.frameId);n.onload=function(){var e,t;"pdf"!==r.type?((e=(e=n.contentWindow||n.contentDocument).document?e.document:e).body.appendChild(r.printableElement),"pdf"!==r.type&&r.style&&((t=document.createElement("style")).innerHTML=r.style,e.head.appendChild(t)),0<(e=e.getElementsByTagName("img")).length?(t=(t=Array.from(e)).map(function(e){if(e.src&&e.src!==window.location.href)return r=e,new Promise(function(t){!function e(){r&&void 0!==r.naturalWidth&&0!==r.naturalWidth&&r.complete?t():setTimeout(e,500)}()});var r}),Promise.all(t).then(function(){return o(n,r)})):o(n,r)):i.default.isFirefox()?setTimeout(function(){return o(n,r)},1e3):o(n,r)}}};function o(t,r){try{if(t.focus(),i.default.isEdge()||i.default.isIE())try{t.contentWindow.document.execCommand("print",!1,null)}catch(e){t.contentWindow.print()}else t.contentWindow.print()}catch(e){r.onError(e)}finally{i.default.isFirefox()&&(t.style.visibility="hidden",t.style.left="-1px"),Object(n.cleanUp)(r)}}t.default=r},"./src/js/raw-html.js":function(e,t,r){"use strict";r.r(t);var n=r("./src/js/print.js");t.default={print:function(e,t){e.printableElement=document.createElement("div"),e.printableElement.setAttribute("style","width:100%"),e.printableElement.innerHTML=e.printable,n.default.send(e,t)}}},"./src/sass/index.scss":function(e,t,r){},0:function(e,t,r){e.exports=r("./src/index.js")}},i.c=n,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0).default;function i(e){var t;return(n[e]||(t=n[e]={i:e,l:!1,exports:{}},r[e].call(t.exports,t,t.exports,i),t.l=!0,t)).exports}var r,n}),!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.notifier=t():e.notifier=t()}("undefined"!=typeof self?self:this,function(){let p=0;function f(e,t){var r=document.createElement(e);for(const n in t)r.setAttribute(n,t[n]);return r}var e;function g(e){const t=document.getElementById(e);return!!t&&(t.className=t.className.replace(" shown",""),setTimeout(function(){t.parentNode?.removeChild(t)},600),!0)}return e=f("div",{class:"notifier-container",id:"notifier-container"}),document.body.appendChild(e),{show:function(e,t,r,n,i){let o={autoHideTimeout:3e3,classList:[],payload:{},clickNotify:null};e=e||"알림",t=t||"메시지 입니다.",r=r||"info","number"==typeof i?o.autoHideTimeout=i:"object"==typeof i&&null!==i&&(o.autoHideTimeout="number"==typeof i.autoHideTimeout?i.autoHideTimeout:3e3,o.classList=i.classList||[],o.payload=i.payload||{},o.clickNotify="function"==typeof i.clickNotify?i.clickNotify:null);const s=o.payload.id||"notifier-"+p,a=document.querySelector(".notifier-container"),l=f("div",{class:"notifier "+r}),c=f("h3",{class:"notifier-title"}),u=f("div",{class:"notifier-body"}),d=f("div",{class:"notifier-img"}),h=f("button",{class:"notifier-close",type:"button"});return o.classList&&0<o.classList.length&&o.classList.forEach(e=>{a.classList.contains(e)||a.classList.add(e)}),c.innerHTML=e,u.innerHTML=t,h.innerHTML="&times;",n&&0<n.length&&d.appendChild(f("img",{class:"img",src:n})),l.appendChild(h),l.appendChild(d),l.appendChild(c),l.appendChild(u),a.appendChild(l),d.style.height=d.parentNode.offsetHeight+"px"||null,setTimeout(function(){l.className+=" shown",l.setAttribute("id",s)},100),0<o.autoHideTimeout&&setTimeout(function(){g(s)},o.autoHideTimeout),o.clickNotify&&(l.addEventListener("click",function(e){e.target!==h&&(o.clickNotify(e,o.payload,s),g(s))}),l.style.cursor="pointer"),h.addEventListener("click",function(){g(s)}),p+=1,s},hide:g}}),!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["@master/css"]=t():e["@master/css"]=t()}(this,function(){return r={642:e=>{e.exports={"3xs":360,"2xs":480,xs:600,sm:768,md:1024,lg:1280,xl:1440,"2xl":1600,"3xl":1920,"4xl":2560}},580:e=>{e.exports={fade:{10:"131518",20:"24262d",30:"363944",40:"4c515f",50:"63697c",60:"878d9f",70:"a6abb8",80:"c3c6cf",90:"f4f4f6"},gray:{10:"151515",20:"242424",30:"39393b",40:"515153",50:"6a6a6c",60:"8d8d8f",70:"aaaaac",80:"c6c6c8",90:"f4f4f6"},brown:{10:"1c130f",20:"31221b",30:"4b3429",40:"6a4a3a",50:"8a604c",60:"af836e",70:"c4a394",80:"d8c2b8",90:"f8f3f1"},orange:{10:"221205",20:"3a1f08",30:"582f0d",40:"7c4312",50:"a15717",60:"d5731e",70:"e79855",80:"efbd92",90:"fcf1e7"},gold:{10:"1e1400",20:"342300",30:"4e3400",40:"6e4900",50:"906000",60:"c08000",70:"e89a00",80:"ffba30",90:"fff3da"},yellow:{10:"1b1500",20:"2f2500",30:"473800",40:"634f00",50:"806700",60:"ac8a00",70:"d0a700",80:"f0c100",90:"fff5ca"},grass:{10:"101803",20:"1c2a05",30:"2a4008",40:"3c5a0b",50:"4e750e",60:"689c13",70:"7dbc17",80:"92da1a",90:"ebfad4"},green:{10:"011a0b",20:"022d13",30:"03441d",40:"055f28",50:"067b34",60:"08a345",70:"0ac553",80:"0be561",90:"d5fde5"},beryl:{10:"001912",20:"002b1f",30:"00432f",40:"005d41",50:"007954",60:"00a170",70:"00c387",80:"00e19c",90:"c9ffee"},teal:{10:"001918",20:"002b28",30:"00413d",40:"005b55",50:"00776f",60:"009f94",70:"00bfb2",80:"00ddce",90:"c5fffb"},cyan:{10:"00181f",20:"002a35",30:"003f51",40:"005973",50:"007391",60:"0099c1",70:"00b9e9",80:"3dd7ff",90:"dff8ff"},sky:{10:"021726",20:"032841",30:"043c61",40:"065489",50:"086eb3",60:"0b92ee",70:"4db3f7",80:"8ccefa",90:"eaf6fe"},blue:{10:"051338",20:"09205e",30:"0d318d",40:"1344c4",50:"175fe9",60:"538cee",70:"81acf3",80:"a5c7fd",90:"edf4fe"},indigo:{10:"161031",20:"24195e",30:"332592",40:"4835cc",50:"5a5bd5",60:"7d84e8",70:"a1a5ee",80:"bfc2f4",90:"f1f2ff"},violet:{10:"1f0839",20:"310e63",30:"491595",40:"641ed2",50:"7949e5",60:"9e77f5",70:"b89bf9",80:"d0bdfb",90:"f5f1ff"},purple:{10:"220736",20:"390c5b",30:"551287",40:"7719bd",50:"9832e4",60:"b56cec",70:"ca96f1",80:"dcbaf6",90:"f9f0ff"},fuchsia:{10:"2b0720",20:"470b3d",30:"68105f",40:"8e1691",50:"b61cbb",60:"e04ee5",70:"ea86ed",80:"f1b1f3",90:"feefff"},pink:{10:"2d0519",20:"4c082b",30:"720c40",40:"9d1059",50:"ca1473",60:"ee52a3",70:"f388c0",80:"f7b2d6",90:"fff0f8"},crimson:{10:"33020f",20:"500317",30:"780522",40:"a20d35",50:"ce1a4b",60:"ea5b82",70:"f58ba7",80:"ffb1c6",90:"fff1f4"},red:{10:"350001",20:"530001",30:"780506",40:"a60708",50:"d11a1e",60:"eb5f63",70:"fa8b8d",80:"fdb3b5",90:"fff1f1"},black:"000000",white:"ffffff"}},989:(e,t,r)=>{const c=r(824),u=r(860);r(580),e.exports=function(a){const e=""in(a="string"==typeof a?{"":a}:a);let t=!1;for(const e in a)if(e&&100<=+e){t=!0;break}if(!t&&(!e||1<Object.keys(a).length)){let t,i,o=0,s="0"in a?c(a[0]):[0,0,0];const l=[],n=()=>{const r=t-o,n=i.map((e,t)=>(e-s[t])/r);for(const t of l){const i=t-o,r=s.map((e,t)=>Math.round(e+n[t]*i));a[t]=u.call(this,...r)}};for(let e=1;e<100;e++){var r=e%2==0;e in a?(s=l.length?(t=e,i=c(a[e]),n(),l.length=0,i):c(a[e]),o=e):r&&l.push(e)}l.length&&(t=100,i="100"in a?c(a[100]):[255,255,255],n())}return e||(a[""]=a[t?"500":"50"]),a}},824:e=>{e.exports=function(e){e=e.match(/.{1,2}/g);return[parseInt(e[0],16),parseInt(e[1],16),parseInt(e[2],16)]}},860:e=>{e.exports=function(e,t,r){return((1<<24)+(e<<16)+(t<<8)+r).toString(16).slice(1)}}},n={},Vi.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return Vi.d(t,{a:t}),t},Vi.d=(e,t)=>{for(var r in t)Vi.o(t,r)&&!Vi.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},Vi.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),Vi.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},Wi={},(()=>{"use strict";function C(e,t){return e+":"+(t.unit?t.value+t.unit:t.value)+(t.important?"!important":"")}Vi.r(Wi),Vi.d(Wi,{Style:()=>M,StyleSheet:()=>k,Styles:()=>Pi,breakpoints:()=>Ui,colors:()=>Hi,init:()=>Fi,sheets:()=>Fe});const l=/^([+-.]?\d+(\.?\d+)?)(.*)?/;function E(e,t,s,r,n){let i=r?r[e]:"",o="",a="";if(!i)if("number"==typeof e)i=e,o=t||"";else{if(s){const l=Object.keys(s);e=e.replace(new RegExp(`(^|,| |\\()(${l.join("|")})(?:-([0-9]+))?(?:\\/(\\.?[0-9]+))?(?=(\\)|\\}|,| |$))`,"gm"),(e,t,r,n,i,o)=>{r=s[r][n||""];if(r){let e="#"+r;return i&&(n=+i,n=isNaN(n)?1:Math.min(Math.max(n,0),1),e+=Math.round(255*n).toString(16).toUpperCase().padStart(2,"0")),t+e}return e})}if(t){const s=e.match(l);if(s){if(e.includes("/")){const l=e.split("/");return{value:+l[0]/+l[1]*100+"%",unit:o,unitToken:a}}return i=+s[1],(o=a=s[3]||"")||("rem"!==t&&"em"!==t||(i/=n),o=t||""),{value:i,unit:o,unitToken:a}}}i=(-1===e.indexOf("calc(")?e:function(t){var r=e=>"+"===e||"-"===e||"*"===e||"/"===e;let n,i="",o="",s=!1;function a(){n=null,o=""}for(let e=0;e<t.length;e++){var l=t[e];if("("===l||")"===l)s=")"===l,i+=o+l,a();else if(","===l)i+=o+l+" ",a();else{switch(n){case 1:break;case 2:if(r(l)){i+=o+" "+l+" ",a();continue}break;default:s&&(o+=" "),isNaN(+l)?r(l)||(n=1):n=2}o+=l}}return o&&(i+=o),i}(e)).replace(/\$\(((\w|-)+)\)/g,"var(--$1)")}return{value:i,unit:o,unitToken:a}}const L=[":disabled",":active",":focus",":hover"],F={"(":")","'":"'","{":"}"};var e=Vi(642),H=Vi.n(e);const o=(...e)=>e.join("-"),a="border",t="radius",s="margin",c="padding",r="font",n="currentColor",i="template",u="column",U="columns",d="row",V="rows",W="shadow",h="content",p="image",$="stroke",f="background",g="color",m="scroll",y="animation",B="direction",j="mode",z=o("overscroll","behavior"),Y="height",v="width",b="max",w="min",G="inline",T="flex",S="grid",q="transition",K="rotate",X="timing-function",J="display",Z="hidden",_="box",Q="fill",x="text",ee="align",te="transform",re="word",ne="decoration",R="break",A="auto",ie="position",oe="rem",N="style",se="antialiased",ae="spacing",le=o("letter",ae),ce=o(b,v),ue=o(w,v),de=o(b,Y),he=o(w,Y),O="table",pe="group",fe="list",ge="justify",me="offset",ye="outline",I={full:"100%",fit:o("fit",h),max:o(b,h),min:o(w,h)};for(const C in H())I[C]=H()[C]/16+"rem";const ve=Vi(989),be="matches",we="max-width",Ce="min-width",Ee="::scrollbar",Te="::slider-thumb",Se="::slider-runnable-track",_e="::progress",xe=["!","*",">","+","~",":","[","@","_"],Re=[...xe,void 0,"."],Ae=new RegExp(Ee,"g"),Ne=new RegExp("::search","g"),Oe=new RegExp("::meter","g"),Ie=new RegExp(Se,"g"),Me=new RegExp(Te,"g"),ke=new RegExp("::resizer","g"),De=new RegExp(_e,"g"),Pe=/(\\'(?:.*?)[^\\]\\')(?=[*_>~+,)])|(\[[^=]+='(?:.*?)[^\\]'\])/,Le=e=>e.split(Pe).map((e,t)=>t%3?e:e.replace(/\_/g," ")).join(""),Fe=[];class M{constructor(y,v){this.name=y,this.matching=v,this.at={},this.prioritySelectorIndex=-1;const b=this.constructor;if(void 0!==v||(v=b.match(y))){let d,t,e,{id:r,semantics:n,unit:h,colors:p,key:i,values:f,colorful:o,breakpoints:s,mediaQueries:a,colorSchemes:l,rootSize:g}=b,m=y;if(o||(p=null),"semantics"===v.origin)d=v.value,e=m.slice(v.value.length),this.value=n[v.value];else{if(v.origin===be)if(r===pe){let e=0;for(;e<m.length&&("{"!==m[e]||"\\"===m[e-1]);e++);t=m.slice(0,e),d=m.slice(e)}else{const C=m.indexOf(":");this.prefix=m.slice(0,C+1),d=this.prefix.includes("(")?(this.prefix=void 0,m):m.slice(C+1)}else"symbol"===v.origin&&(this.symbol=m[0],d=m.slice(1));let a,l="",c=[],u=0;!function e(t,r,n=""){let i,o=!1;for(t&&(")"===t&&"$"===l.slice(-1)?i=l.length-1:"'"===t&&(o=!0),l+=d[u++]);u<d.length;u++){var s=d[u];if(s===t){if(l+=s,o){let t=0;for(let e=l.length-2;"\\"===l[e];e--)t++;if(t%2)continue}void 0!==i&&(l=l.slice(0,i)+l.slice(i).replace(/\$\((.*)\)/,"var(--$1)")),r||(o?c.push(l):(a=E(l,h,p,f,g),c.push(a.value+a.unit)),n="",l="");break}if(!o&&s in F)e(F[s],void 0===r?0:r+1,n);else if("|"!==s||"}"===t||o&&"path"!==n){if(!t){if("."===s){if(isNaN(+d[u+1]))break;"-"===d[u-1]&&(l+="0")}else{if(","===s){a=E(l,h,p,f,g),c.push(a.value+a.unit,","),l="";continue}if("#"===s&&(l||c.length&&"|"!==d[u-1])||xe.includes(s))break}n+=s}l+=s}else t?l+=" ":(a=E(l,h,p,f,g),c.push(a.value+a.unit),l="")}}(),l&&(a=E(l,h,p,f,g),c.push(a.value+a.unit)),e=d.slice(u),1===c.length?a?(this.value=a.value,this.unit=a.unit):(this.value=c[0],this.unit=""):this.value=c.reduce((e,t,r)=>e+t+(","===t||","===c[r+1]||r===c.length-1?"":" "),"")}(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.includes(Ee)?e.replace(Ae,"::-webkit-scrollbar"):e).includes("::search")?e.replace(Ne,"::-webkit-search"):e).includes(Te)?e.replace(Me,"::-webkit-slider-thumb"):e).includes(Se)?e.replace(Ie,"::-webkit-slider-runnable-track"):e).includes("::meter")?e.replace(Oe,"::-webkit-meter"):e).includes("::resizer")?e.replace(ke,"::-webkit-resizer"):e).includes(_e)?e.replace(De,"::-webkit-progress"):e).includes(":first")?e.replace(/:first(?![a-z-])/g,":first-child"):e).includes(":last")?e.replace(/:last(?![a-z-])/g,":last-child"):e).includes(":even")?e.replace(/:even(?![a-z-])/g,":nth-child(2n)"):e).includes(":odd")?e.replace(/:odd(?![a-z-])/g,":nth-child(odd)"):e).includes(":nth(")&&(e=e.replace(/:nth\(/g,":nth-child(")),this.parseValue&&(this.value=this.parseValue),f&&this.value in f&&(this.value=f[this.value]),"!"===e[0]&&(this.important=!0,e=e.slice(1)),this.prefixSelector=t?Le(t):"";var w=e.split("@");let c=w[0];if(c){c=Le(c),this.hasWhere=c.includes(":where(");for(let e=0;e<L.length;e++)if(c.includes(L[e])){this.prioritySelectorIndex=e;break}}this.suffixSelector=c;for(let e=1;e<w.length;e++){const y=w[e];if(y)if(l.includes(y))this.colorScheme=y;else if("rtl"===y||"ltr"===y)this.direction=y;else{let e,t;const b=y.indexOf("_");if(-1!==b)e=y.slice(0,b),t=y.slice(b);else{const b=y.indexOf("(");-1!==b&&(e=y.slice(0,b),t=y.slice(b))}if(!e){e="media";const b=[],L=(this.media={token:y,features:{}},y.split("&"));for(const C of L)if("all"===C||"print"===C||"screen"===C||"speech"===C)this.media.type=C;else if("🖨"===C)this.media.type="print";else if("landscape"===C||"portrait"===C)b.push("(orientation:"+C+")");else if("motion"===C||"reduced-motion"===C)b.push("(prefers-reduced-motion:"+("motion"===C?"no-preference":"reduce")+")");else if(C in a)b.push(a[C]);else{const y={token:C};let r="",n="",i=0;switch(C.startsWith("<=")?(n="<=",r=we):C.startsWith(">=")||s[C]?(n=">=",r=Ce):C.startsWith(">")?(n=">",r=Ce,i=.02):C.startsWith("<")&&(n="<",r=we,i=-.02),r){case we:case Ce:const e=n?C.replace(n,""):C,t=s[e];t?Object.assign(y,E(t,"px")):Object.assign(y,E(e,"px")),"px"===y.unit&&(y.value+=i),this.media.features[r]=y,b.push("("+r+":"+(y.value+y.unit)+")")}}t="",this.media.type&&(t=this.media.type),b.length&&(t+=(t?" and ":"")+b.join(" and "))}t&&(this.at[e]=(e in this.at?this.at[e]+" and ":"")+t.replace(/\_/g," "))}}let u="";this.colorScheme&&(u+="."+this.colorScheme+" "),this.prefixSelector&&(u+=this.prefixSelector),this.direction&&(u+="[dir="+this.direction+"] "),this.text=u+"."+CSS.escape(this.name)+this.suffixSelector+(this.name in M.relations?M.relations[this.name].map(e=>", "+u+"."+CSS.escape(e)+this.suffixSelector).join(""):"")+"{"+("object"==typeof this.value?Object.keys(this.value).map(e=>C(e,Object.assign(Object.assign({},this),{unit:"",value:this.value[e]}))).join(";"):this.props?Object.keys(this.props).map(e=>C(e,this.props[e])).join(";"):C(i,this))+"}";for(const C of Object.keys(this.at).sort((e,t)=>"supports"===t?-1:1))this.text="@"+C+" "+this.at[C]+"{"+this.text+"}";void 0===this.order&&(this.order=0)}}static match(e){if(this.matches&&this.matches.test(e))return{origin:be};if(this.semantics)for(const t in this.semantics)if(e===t||e.startsWith(t)&&Re.includes(e[t.length]))return{origin:"semantics",value:t};return this.colorStarts&&(e.match("^"+this.colorStarts+"(#|(rgb|hsl)\\(.*\\))((?!\\|).)*$")||this.colorNames.length&&e.match("^"+this.colorStarts+"("+this.colorNames.join("|")+")")&&-1===e.indexOf("|"))?{origin:be}:this.symbol&&e.startsWith(this.symbol)?{origin:"symbol"}:this.key&&e.startsWith(this.key+":")?{origin:be}:void 0}static extend(t,...e){if(e.length){const s=Object.assign({},...e),r=(e,t,r)=>{var n;for(const o in s){var i=s[o];null==i?o in e&&(null!=r&&r(o),delete e[o]):e[o]=null!=(n=null==t?void 0:t(o,i))?n:i}};switch(t){case"classes":r(this.classes,(e,t)=>{if(e in this.classes)for(const t in this.relations){const r=this.relations[t],n=r.indexOf(e);-1!==n&&(1<r.length?r.splice(n,1):delete this.relations[t])}const r=Array.isArray(t)?t:t.replace(/(?:\n(?:\s*))+/g," ").trim().split(" ");for(const t of r)t in this.relations?this.relations[t].push(e):this.relations[t]=[e];return r},e=>{for(const r of this.classes[e]){var t=this.relations[r];1<t.length?t.splice(t.indexOf(e),1):delete this.relations[r]}});break;case"colors":r(this.colors,(e,t)=>(-1===this.colorNames.indexOf(e)&&this.colorNames.push(e),ve(t)),e=>{e=this.colorNames.indexOf(e);-1!==e&&this.colorNames.splice(e,1)});break;default:let e=this[t];r(e=e||(this[t]={}))}}return this}}M.unit="rem",M.rootSize=16,M.mediaQueries={},M.sheets=Fe,M.colors={},M.classes={},M.colorNames=[],M.relations={},M.colorSchemes=["dark","light"],"undefined"!=typeof window&&(window.MasterStyle=M);const He=[",",".","#","[","!","*",">","+","~",":","@"],Ue="undefined"!=typeof document;let Ve;Ue&&((Ve=document.createElement("style")).id="master-css");e="undefined"!=typeof window;class k extends(e?window.MutationObserver:Object){constructor(s){if(super(t=>{const r={},n=[],i=[],o=[],s=(e,t)=>{t?e.classList.forEach(l):e.classList.forEach(a);var r=e.children;for(let e=0;e<r.length;e++){var n=r[e];n.classList&&(i.push(n),s(n,t))}},a=e=>{e in r?r[e]++:r[e]=1},l=e=>{e in r?r[e]--:e in this.countOfName&&(r[e]=-1)},c=(t,r)=>{for(let e=0;e<t.length;e++){var n=t[e];!n.classList||i.includes(n)||o.includes(n)||(n.isConnected!==r?(i.push(n),s(n,r)):o.push(n))}};for(let e=0;e<t.length;e++){const o=t[e],{addedNodes:s,removedNodes:a,type:l,target:u}=o;"attributes"===l?n.find(e=>e.target===u)||n.push(o):(c(s,!1),u.isConnected&&i.includes(u)||c(a,!0))}if(n.length||Object.keys(r).length){for(const{oldValue:t,target:r}of n){const n=i.includes(r),o=r.classList,s=t?t.split(" "):[];if(n){if(!r.isConnected)for(const t of s)o.contains(t)||l(t)}else if(r.isConnected){o.forEach(e=>{s.includes(e)||a(e)});for(const t of s)o.contains(t)||l(t)}}for(const t in r){const n=r[t],i=(this.countOfName[t]||0)+n;0===i?(delete this.countOfName[t],this.delete(t)):(t in this.countOfName||this.findAndInsert(t),this.countOfName[t]=i)}}}),this.container=s,this.styles=[],this.styleOfName={},this.countOfName={},Ue){if(s){var e=s.querySelector('[id="master-css"]');if(e){this.element=e;const s=(r,n)=>{if(r.selectorText){const s=r.selectorText.split(", ")[0].split(" ");for(let e=0;e<s.length;e++){var i=s[e];if("."===i[0]){const s=i.slice(1);let t="";for(let e=0;e<s.length;e++){const n=s[e],o=s[e+1];if("\\"===n){if(e++,"\\"!==o){t+=o;continue}}else if(He.includes(n))break;t+=n}if(!(t in this.styleOfName||t in M.classes)){const s=k.findAndNew(t);s&&(s.cssRule=null!=n?n:r,this.styles.push(s),this.styleOfName[s.name]=s)}}}}else if(r.cssRules)for(let e=0;e<r.cssRules.length;e++)s(r.cssRules[e],null!=n?n:r.cssRules[e])};s(e.sheet,void 0)}else this.element=Ve.cloneNode(),null!=s&&s.prepend(this.element)}Fe.push(this)}}observe(e,t={subtree:!0,childList:!0}){const r=e=>{e.forEach(e=>{e in this.countOfName?this.countOfName[e]++:(this.countOfName[e]=1,this.findAndInsert(e))})};return r(e.classList),t.subtree&&e.querySelectorAll("[class]").forEach(e=>r(e.classList)),super.observe(e,Object.assign(Object.assign({},t),{attributes:!0,attributeOldValue:!0,attributeFilter:["class"]})),this}disconnect(){super.disconnect(),this.styleOfName={},this.countOfName={},this.styles.length=0;var t=this.element.sheet;if(t)for(let e=t.cssRules.length-1;0<=e;e--)t.deleteRule(e)}static findAndNew(e){var t=e=>{for(const r of this.Styles){var t=r.match(e);if(t)return new r(e,t)}};return e in M.classes?M.classes[e].map(t).filter(e=>e):t(e)}static find(e){var t=e=>{for(const t of this.Styles)if(t.match(e))return t};return e in M.classes?M.classes[e].map(t).filter(e=>e):t(e)}static refresh(){for(const e of Fe)e.refresh()}refresh(){if(this.element){const e=Ve.cloneNode();this.element.replaceWith(e),this.element=e,this.styles.length=0,this.styleOfName={};for(const e in this.countOfName)this.findAndInsert(e)}}destroy(){this.disconnect(),Fe.splice(Fe.indexOf(this),1),this.element.remove()}insert(n){if(!this.styleOfName[n.name]){const a=n.text;let r;const l=this.styles.length-1,c=n.media,u=n.order,d=n.prioritySelectorIndex,h=n.hasWhere,e=(e,t,r,n)=>{let i,o,s=0;t&&(s=e.findIndex(t)),r&&(o=e.findIndex(r)),-1===s&&(s=e.length),void 0!==o&&-1!==o||(o=e.length),i=e.slice(s,o);for(let e=0;e<i.length;e++){const t=i[e];if(!(-1===t.prioritySelectorIndex||n&&n(t))&&(t.prioritySelectorIndex<d||t.prioritySelectorIndex===d&&(h&&!t.hasWhere||t.order>=u)))return s+e}return s+i.length};if(c){const n=this.styles.findIndex(e=>e.media);if(-1!==n){const a=c.features["max-width"],p=c.features["min-width"];if(a&&p){const c=a.value-p.value;for(let t=l;t>=n;t--){r=t;const l=this.styles[t],u=l.media,f=u.features["max-width"],g=u.features["min-width"];if(!f||!g){r++;break}var i=f.value-g.value;if(i==c){if(h!==l.hasWhere)continue;if(-1!==d){const l=[this.styles[t]];for(let e=t-1;e>=n;e--){const n=this.styles[e];if(n.hasWhere!==h)break;const a=n.media,c=a.features["max-width"],u=a.features["min-width"];if(!c||!u||c.value-u.value!=i)break;l.unshift(this.styles[e])}r=e(this.styles,e=>e.media&&-1!==e.prioritySelectorIndex&&e.media.features["min-width"]&&e.media.features["max-width"])}break}if(i>c)break}}else if(p)for(let t=n;t<=l;t++){r=t;const n=this.styles[t],c=n.media,m=c.features["max-width"],y=c.features["min-width"];if(m){if(y)break}else{var o=null==y?void 0:y.value;if(o===p.value){if(!h&&n.hasWhere){r++;continue}if(-1!==d)r=e(this.styles,e=>e.media,e=>e.media&&-1!==e.prioritySelectorIndex&&e.media.features["min-width"]&&e.media.features["max-width"],e=>!e.media.features["min-width"]&&!e.media.features["max-width"]);else for(let e=t;e<=l;e++){const a=this.styles[e],l=a.media,c=l.features["min-width"];if(!l.features["max-width"]){if(a.hasWhere!==h||c.value!==o||a.order>=u)break;r=e+1}}break}if(o>p.value)break;r++}}else if(a)for(let t=l;t>=n;t--){r=t;const l=this.styles[t],v=l.media,b=v.features["max-width"];if(!v.features["min-width"]){var s=null==b?void 0:b.value;if(!s||s>a.value){r++;break}if(s===a.value&&(!h||l.hasWhere)){if(-1!==d)r=e(this.styles,e=>e.media,e=>e.media&&-1!==e.prioritySelectorIndex&&e.media.features["min-width"]&&e.media.features["max-width"],e=>!e.media.features["min-width"]&&!e.media.features["max-width"]);else{const a=[this.styles[t]];for(let e=t-1;e>=n;e--){const n=this.styles[e],l=n.media,c=l.features["min-width"],u=l.features["max-width"];if(!(c||u&&u.value===s&&n.hasWhere===h))break;a.unshift(n)}for(let e=0;e<a.length;e++){const l=a[e];if(!l.media.features["min-width"]){if(l.order>=u)break;r=t-a.length+2+e}}}break}}}}if(void 0===r)if(-1===n)r=l+1;else if(-1!==d)r=n+e(this.styles.slice(n),void 0,e=>e.media.features["max-width"]||e.media.features["min-width"]);else if(h){let e=n;for(;e<this.styles.length;e++){const n=this.styles[e];if(-1!==n.prioritySelectorIndex||!n.hasWhere||n.order>=u){r=e;break}}void 0===r&&(r=e)}else for(let e=n;e<=l;e++){r=e;const n=this.styles[e],l=n.media;if(-1!==n.prioritySelectorIndex||l.features["max-width"]||l.features["min-width"])break;if(n.hasWhere)r++;else if(n.order>=u)break}}else if(-1===d)if(h)-1===(r=this.styles.findIndex(e=>!e.hasWhere||e.media||-1!==e.prioritySelectorIndex||e.order>=u))&&(r=l+1);else{let e=0;for(;e<this.styles.length;e++){const a=this.styles[e];if(a.media||!a.hasWhere&&(a.order>=u||-1!==a.prioritySelectorIndex)){r=e;break}}void 0===r&&(r=e)}else r=e(this.styles,void 0,e=>e.media);try{if(this.element){const l=this.element.sheet;l.insertRule(a,r),n.cssRule=l.cssRules[r]}this.styles.splice(r,0,n),this.styleOfName[n.name]=n}catch(n){}}}delete(e){const r=this.element.sheet,t=e=>{var t=this.styleOfName[e];if(null!=t&&t.cssRule&&!(e in M.relations&&M.relations[e].some(e=>e in this.countOfName)))for(let e=0;e<r.cssRules.length;e++)r.cssRules[e]===t.cssRule&&(r.deleteRule(e),this.styles.splice(e,1),delete this.styleOfName[t.name])};if(e in M.classes)for(const r of M.classes[e])r in this.countOfName||t(r);else t(e)}findAndInsert(e){var t=k.findAndNew(e);if(Array.isArray(t))for(const e of t)this.insert(e);else t&&this.insert(t)}}k.Styles=[],e&&(window.MasterStyleSheet=k);class We extends M{}We.matches=/^f(ont)?:(thin|extralight|light|regular|medium|semibold|bold|bolder|extrabold|heavy)(?!\|)/,We.key=o(r,"weight"),We.unit="",We.values={thin:100,extralight:200,light:300,regular:400,medium:500,semibold:600,bold:700,extrabold:800,heavy:900};e="var(--font-";class $e extends M{}$e.matches=/^f(ont)?:(mono|sans|serif)(?!\|)/,$e.key=o(r,"family"),$e.values={mono:e+"mono)",sans:e+"sans)",serif:e+"serif)"};class Be extends M{}Be.matches=/^f(ont)?:([0-9]|(max|min|calc|clamp)\(.*\))((?!\|).)*$/,Be.key=o(r,"size");const je="top",ze="bottom",Ye="left",Ge="right";class qe extends M{get props(){var e="m"===this.prefix[0]?s:c,t=o(e,Ye),r=o(e,Ge),n=o(e,je),i=o(e,ze);switch(this.prefix[1]){case"x":return{[t]:this,[r]:this};case"y":return{[n]:this,[i]:this};case"l":return{[t]:this};case"r":return{[r]:this};case"t":return{[n]:this};case"b":return{[i]:this};default:return{[e]:this}}}get order(){return"p:"===this.prefix||"m:"===this.prefix?-1:0}}qe.id="spacing",qe.matches=/^[pm][xytblr]?:./;class Ke extends M{}Ke.matches=/^w:./,Ke.key=v,Ke.values=I;class Xe extends M{}Xe.matches=/^h:./,Xe.key=Y,Xe.values=I;class Je extends M{}Je.matches=/^min-w:./,Je.key=ue,Je.values=I;class Ze extends M{}Ze.matches=/^min-h:./,Ze.key=he,Ze.values=I;class Qe extends M{}Qe.matches=/^ls:./,Qe.key=le,Qe.unit="em";const et=o("subpixel",se),tt=o("-webkit-font","smoothing"),rt=o("-moz-osxfont","smoothing");class nt extends M{get props(){var e={};switch(this.value){case et:e[tt]=e[rt]=Object.assign(Object.assign({},this),{value:A});break;case se:e[tt]=Object.assign(Object.assign({},this),{value:se}),e[rt]=Object.assign(Object.assign({},this),{value:"grayscale"})}return e}}nt.id="fontSmoothing",nt.matches=/^f(ont)?:(antialiased|subpixel-antialiased)(?!\|)/,nt.unit="";class it extends M{}it.matches=/^f(ont)?:(normal|italic|oblique)(?!\|)/,it.key=o(r,N),it.unit="deg",it.semantics={italic:"italic",oblique:"oblique"};class ot extends M{}ot.matches=/^f(ont)?:(ordinal|slashed-zero|lining-nums|oldstyle-nums|proportional-nums|tabular-nums|diagonal-fractions|stacked-fractions)(?!\|)/,ot.key=o(r,"variant","numeric");class st extends M{}st.matches=/^lh:./,st.key=o("line",Y),st.unit="";class at extends M{}at.matches=/^(object|obj):(contain|cover|fill|scale-down)/,at.key=o("object","fit");class lt extends M{}lt.matches=/^(object|obj):(top|bottom|right|left|center)/,lt.key=o("object",ie);class ct extends M{}ct.matches=/^t(ext)?:(justify|center|left|right|start|end)(?!\|)/,ct.key=o(x,ee);class ut extends M{constructor(){super(...arguments),this.order=-1}}ut.matches=/^t(ext)?:(underline|line-through|overline)/,ut.key=o(x,ne),ut.colorful=!0;class dt extends M{}dt.matches=/^t(ext)?:(uppercase|lowercase|capitalize)(?!\|)/,dt.key=o(x,te),dt.semantics={uppercase:"uppercase",lowercase:"lowercase",capitalize:"capitalize"};class ht extends M{}ht.matches=/^(?:v|vertical):./,ht.key=o("vertical",ee);class pt extends M{get props(){return{overflow:Object.assign(Object.assign({},this),{value:Z}),display:Object.assign(Object.assign({},this),{value:"-webkit-box"}),"overflow-wrap":Object.assign(Object.assign({},this),{value:o(R,re)}),"text-overflow":Object.assign(Object.assign({},this),{value:"ellipsis"}),"-webkit-box-orient":Object.assign(Object.assign({},this),{value:"vertical"}),"-webkit-line-clamp":this}}}pt.id="lines",pt.matches=/^lines:./,pt.unit="";class ft extends M{}ft.matches=/^transform:((top|bottom|right|left|center)|\d)/,ft.key=o(te,"origin"),ft.unit="px";class gt extends M{}gt.matches=/^transform:(flat|preserve-3d)(?!\|)/,gt.key=o(te,N);class mt extends M{}mt.matches=/^transform:(content|border|fill|stroke|view)(?!\|)/,mt.key=o(te,_),mt.values={content:o(h,_),border:o(a,_),fill:o(Q,_),stroke:o($,_),view:o("view",_)};class yt extends M{get parseValue(){return this.value.replace(/(translate|scale|skew|rotate|perspective|matrix)(3d|[XYZ])?\((.*?)\)/g,(e,t,r,n)=>{let i,o;switch(t){case"translate":i=oe;break;case"skew":i="deg";break;case K:"3d"===r&&(o=!0),i="deg";break;default:return e}const s=n.split(",");return e.replace(n,s.map((e,t)=>o&&s.length-1!==t||Number.isNaN(+e)?e:e/(i===oe?16:1)+i).join(","))})}}yt.matches=/^(translate|scale|skew|rotate|perspective|matrix)(3d|[XYZ])?\(/,yt.key=te,yt.unit="";class vt extends M{constructor(){super(...arguments),this.order=-1}}vt.symbol="~",vt.key=q;class bt extends M{}bt.matches=/^~delay:./,bt.key=o(q,"delay"),bt.unit="ms";class wt extends M{}wt.matches=/^~duration:./,wt.key=o(q,"duration"),wt.unit="ms";class Ct extends M{}Ct.matches=/^~property:./,Ct.key=o(q,"property");class Et extends M{}Et.matches=/^~easing:./,Et.key=o(q,X);class Tt extends M{}Tt.matches=/^max-h:./,Tt.key=de,Tt.values=I;class St extends M{}St.matches=/^max-w:./,St.key=ce,St.values=I;class _t extends M{}_t.matches=/^d:./,_t.key=J,_t.semantics={hidden:"none",hide:"none",block:"block",table:O,flex:T,grid:S,contents:"contents",inline:G,"inline-block":o(G,"block"),"inline-flex":o(G,T),"inline-grid":o(G,S),"inline-table":o(G,O),"table-cell":o(O,"cell"),"table-caption":o(O,"caption"),"flow-root":o("flow","root"),"list-item":o(fe,"item"),"table-row":o(O,d),"table-column":o(O,u),"table-row-group":o(O,d,pe),"table-column-group":o(O,u,pe),"table-header-group":o(O,"header",pe),"table-footer-group":o(O,"footer",pe)};class xt extends M{}xt.matches=/^box:(content|border)(?!\|)/,xt.key=o(_,"sizing"),xt.values={content:o(h,_),border:o(a,_)};class Rt extends M{}Rt.key="opacity",Rt.unit="";class At extends M{}At.key="visibility",At.semantics={visible:"visible",invisible:Z};class Nt extends M{}Nt.key="clear";class Ot extends M{}Ot.key="float";class It extends M{}It.key="isolation",It.semantics={isolate:"isolate"};class Mt extends M{get props(){if(this.prefix)switch(this.prefix.slice(-2,-1)){case"x":return{"overflow-x":this};case"y":return{"overflow-y":this}}return{overflow:this}}get order(){if(this.prefix)switch(this.prefix.slice(-2,-1)){case"x":case"y":return 0}return-1}}Mt.id="overflow",Mt.matches=/^overflow(-x|-y)?:(?:visible|overlay|hidden|scroll|auto|clip|inherit|initial|revert|revert-layer|unset|\$|var)/,Mt.semantics={overflow:"visible"};class kt extends M{get props(){switch(this.prefix.slice(-2,-1)){case"x":return{[o(z,"x")]:this};case"y":return{[o(z,"y")]:this};default:return{[z]:this}}}}kt.id="overscrollBehavior",kt.matches=/^overscroll-behavior(?:-[xy])?:/;class Dt extends M{}Dt.matches=/^z:./,Dt.key="z-index",Dt.unit="";class Pt extends M{}Pt.matches=/^\@delay:./,Pt.key=o(y,"delay"),Pt.unit="ms";class Lt extends M{}Lt.matches=/^\@direction:./,Lt.key=o(y,B);class Ft extends M{}Ft.matches=/^\@fill-mode:./,Ft.key=o(y,Q,j);class Ht extends M{}Ht.matches=/^\@iteration-count:./,Ht.key=o(y,"iteration","count"),Ht.unit="";class Ut extends M{}Ut.matches=/^\@name:./,Ut.key=o(y,"name");class Vt extends M{}Vt.matches=/^\@play-state:./,Vt.key=o(y,"play-state");class Wt extends M{}Wt.matches=/^\@easing:./,Wt.key=o(y,X);class $t extends M{constructor(){super(...arguments),this.order=-1}}function Bt(e,t,r=""){var n="border-left"+(r=r&&"-"+r),i="border-right"+r,o="border-top"+r,s="border-bottom"+r;switch(/^b(order)?-?(.)?/.exec(e)[2]){case"x":return{[n]:t,[i]:t};case"y":return{[o]:t,[s]:t};case"l":return{[n]:t};case"r":return{[i]:t};case"t":return{[o]:t};case"b":return{[s]:t};default:return{[a+r]:t}}}$t.symbol="@",$t.key=y,$t.unit="";class jt extends M{get props(){return Bt(this.prefix,this,g)}get order(){return this.prefix===o(a,g)+":"||"b:"===this.prefix||"border:"===this.prefix?-1:0}}jt.id="borderColor",jt.matches=/^border(-(left|right|top|bottom))?-color:./,jt.colorStarts="b([xytblr]|(order(-(left|right|top|bottom))?))?:",jt.colorful=!0,jt.values={current:n};const zt=o(a,je,Ye,t),Yt=o(a,je,Ge,t),Gt=o(a,ze,Ye,t),qt=o(a,ze,Ge,t),Kt=o(a,t),Xt=[zt,Yt,Gt,qt];class Jt extends M{get props(){var e;if(this.prefix){let t="";const r=this.prefix.split("-");if(1<r.length)for(let e=1;e<r.length-1;e++)t+=r[e][0];else t=this.prefix.slice(1,-1);switch(t){case"t":return{[zt]:this,[Yt]:this};case"tl":case"lt":return{[zt]:this};case"rt":case"tr":return{[Yt]:this};case"b":return{[Gt]:this,[qt]:this};case"bl":case"lb":return{[Gt]:this};case"br":case"rb":return{[qt]:this};case"l":return{[zt]:this,[Gt]:this};case"r":return{[Yt]:this,[qt]:this};default:return{[Kt]:this}}}const r=null==(e=this.prefix)?void 0:e.slice(0,-1);return{[Xt.includes(r)?r:Kt]:this}}get order(){return this.prefix===o(a,t)+":"||"r:"===this.prefix?-1:0}}Jt.id="borderRadius",Jt.matches=/^((r[tblr]?[tblr]?|border(-(top|bottom)-(left|right))?-radius):.)/,Jt.semantics={rounded:"1e9em",round:"50%"};class Zt extends M{get props(){return Bt(this.prefix,this,N)}get order(){return this.prefix===o(a,N)+":"||"b:"===this.prefix||"border:"===this.prefix?-1:0}}Zt.id="borderStyle",Zt.matches=/^(border(-(left|right|top|bottom))?-style:.|b([xytblr]|order(-(left|right|top|bottom))?)?:(none|hidden|dotted|dashed|solid|double|groove|ridge|inset|outset)(?!\|))/;class Qt extends M{get props(){return Bt(this.prefix,this,v)}get order(){return this.prefix===o(a,v)+":"||"b:"===this.prefix||"border:"===this.prefix?-1:0}}Qt.id="borderWidth",Qt.matches=/^(border(-(left|right|top|bottom))?-width:.|b([xytblr]|order(-(left|right|top|bottom))?)?:(([0-9]|(max|min|calc|clamp)\(.*\))|(max|min|calc|clamp)\(.*\))((?!\|).)*$)/;class er extends M{get props(){return Bt(this.prefix,this)}get order(){return"border:"===this.prefix||"b:"===this.prefix?-2:-1}}er.id="border",er.matches=/^b([xytblr]?|order(-(left|right|top|bottom))?):./,er.colorful=!0;class tr extends M{}tr.matches=/^(bg|background):(fixed|local|scroll)(?!\|)/,tr.key=o(f,"attachment");class rr extends M{}rr.key=o(f,"blend",j);class nr extends M{get props(){return{"-webkit-background-clip":this,"background-clip":this}}}nr.matches=/^(bg|background):text(?!\|)/,nr.key=o(f,"clip"),nr.values={content:o(h,_),border:o(a,_),padding:o(c,_)};class D extends M{}D.matches=/^(bg|background):transparent(?!\|)/,D.colorStarts="(bg|background):",D.key=o(f,g),D.unit="",D.colorful=!0,D.values={current:n};class ir extends M{}ir.matches=/^(bg|background):(content|border|padding)(?!\|)/,ir.key=o(f,"origin"),ir.values={content:o(h,_),border:o(a,_),padding:o(c,_)};class or extends M{}or.matches=/^(bg|background):(top|bottom|right|left|center)(?!\|)/,or.key=o(f,ie),or.unit="px";class sr extends M{}sr.matches=/^(bg|background):(space|round|repeat|no-repeat|repeat-x|repeat-y)(?![;a-zA-Z])/,sr.key=o(f,"repeat");class ar extends M{}ar.matches=/^(bg|background):((auto|cover|contain)(?!\|)|\.?\d((?!\|).)*$)/,ar.key=o(f,"size");class lr extends M{}lr.matches=/^(bg|background):(url|linear-gradient|radial-gradient|repeating-linear-gradient|repeating-radial-gradient|conic-gradient)\(.*\)((?!\|).)*$/,lr.key=o(f,p),lr.colorful=!0;class cr extends M{constructor(){super(...arguments),this.order=-1}}cr.matches=/^bg:./,cr.key=f,cr.colorful=!0;class ur extends M{}ur.matches=/^blend:./,ur.key=o("mix","blend",j);class dr extends M{}dr.key=ie,dr.values={abs:"absolute",rel:"relative"},dr.semantics={static:"static",fixed:"fixed",abs:"absolute",rel:"relative",sticky:"sticky"};class hr extends M{get props(){var e=this.prefix.slice(0,-1);switch(e){case je:case Ye:case Ge:case ze:return{[e]:this};case"center":return{left:this,right:this,"margin-left":Object.assign(Object.assign({},this),{unit:""}),"margin-right":Object.assign(Object.assign({},this),{unit:""})};case"middle":return{top:this,bottom:this,"margin-top":Object.assign(Object.assign({},this),{unit:""}),"margin-bottom":Object.assign(Object.assign({},this),{unit:""})}}}}function pr(s,a){let l="",c=0;return function e(t,r){let n="";const i=r?a(r):"",o=()=>{n&&(l+=!i||Number.isNaN(+n)?n:+n/(i===oe?16:1)+i,n="")};for(;c<s.length;c++){const a=s[c];if(a===t&&("'"!==t||")"===s[c+1])){o(),l+=a;break}","===a||" "===a?(o(),l+=a):n||"'"!==a?n&&"("===a?(l+=n+a,c++,e(")",n),n=""):n+=a:(l+=a,c++,e(a),n="")}o()}(),l}hr.matches=/^(top|left|right|bottom|center|middle):./;class fr extends M{get props(){return{"backdrop-filter":this,"-webkit-backdrop-filter":this}}get parseValue(){return pr(this.value,e=>{switch(e){case"blur":case o("drop",W):return oe;case o("hue",K):return"deg"}return""})}}fr.matches=/^bd:./,fr.key=o("backdrop","filter"),fr.colorful=!0;class gr extends M{}gr.key=Q,gr.colorStarts="fill:",gr.colorful=!0,gr.values={current:n};class mr extends M{}mr.key=$,mr.colorful=!0;class yr extends M{}yr.matches=/^stroke:([0-9]|(max|min|calc|clamp)\(.*\))((?!\|).)*$/,yr.key=o($,v);class vr extends M{get parseValue(){return pr(this.value,e=>{switch(e){case"blur":case o("drop",W):return oe;case o("hue",K):return"deg"}return""})}}vr.matches=/^(blur|brightness|contrast|drop-shadow|grayscale|hue-rotate|invert|opacity|saturate|sepia)\(/,vr.key="filter",vr.colorful=!0;class br extends M{}br.key="cursor";class wr extends M{}wr.key=o("pointer","events"),wr.semantics={untouchable:"none"};class Cr extends M{}Cr.key="resize";class Er extends M{}Er.key=o("touch","action");class Tr extends M{get props(){return{"user-drag":this,"-webkit-user-drag":this}}}Tr.key=o("user","drag");class Sr extends M{get props(){return{"user-select":this,"-webkit-user-select":this}}}Sr.key=o("user","select");class _r extends M{}_r.matches=/^s(?:hadow)?:./,_r.key=o(_,W),_r.colorful=!0;class xr extends M{}xr.key=o(x,W),xr.colorful=!0;class Rr extends M{get props(){return{"font-size":this,"line-height":Object.assign(Object.assign({},this),{value:this.unit===oe?this.value+.375+this.unit:"calc("+this.value+this.unit+" + .375rem)",unit:""})}}}Rr.id="textSize",Rr.matches=/^t(ext)?:([0-9]|(max|min|calc|clamp)\(.*\))((?!\|).)*$/;class Ar extends M{}Ar.key=o(re,R),Ar.unit="";class Nr extends M{get props(){return{display:Object.assign(Object.assign({},this),{value:S}),[o(S,i,U)]:Object.assign(Object.assign({},this),{value:"repeat("+this.value+","+w+"max(0,1fr))"})}}}Nr.matches=/^grid-cols:./,Nr.key=o(S,U),Nr.unit="";class Or extends M{get props(){return{display:Object.assign(Object.assign({},this),{value:S}),[o(S,A,"flow")]:Object.assign(Object.assign({},this),{value:u}),[o(S,i,V)]:Object.assign(Object.assign({},this),{value:"repeat("+this.value+","+w+"max(0,1fr))"})}}}Or.key=o(S,V),Or.unit="";class Ir extends M{constructor(){super(...arguments),this.order=-1}get props(){switch(this.prefix[4]){case"x":return{[o(u,"gap")]:this};case"y":return{[o(d,"gap")]:this};default:return{gap:this}}}}Ir.id="gap",Ir.matches=/^gap(-x|-y)?:./;class Mr extends M{}Mr.key=o(re,ae);class kr extends M{get props(){return{["--"+this.prefix.slice(1,-1)]:this}}}kr.id="variable",kr.matches=/^\$.+:./,kr.unit="";class Dr extends M{}Dr.matches=/^aspect:./,Dr.key=o("aspect","ratio"),Dr.unit="",Dr.semantics={square:"1/1",video:"16/9"};class Pr extends M{get props(){return{"box-decoration-break":this,"-webkit-box-decoration-break":this}}}Pr.matches=/^box:(slice|clone)(?!\|)/,Pr.key=o(_,ne,R);class Lr extends M{}Lr.key=o(R,"after");class Fr extends M{}Fr.key=o(R,"before");class Hr extends M{}Hr.key=o(R,"inside");class Ur extends M{}Ur.key=o(T,"shrink"),Ur.unit="";class Vr extends M{}Vr.matches=/^flex:((row|col|column)(-reverse)?)(?!\|)/,Vr.key=o(T,B),Vr.values={col:u,"col-reverse":o(u,"reverse")};class Wr extends M{}Wr.key=o(T,"grow"),Wr.unit="";class $r extends M{}$r.matches=/^flex:(wrap(-reverse)?|nowrap)(?!\|)/,$r.key=o(T,"wrap");class Br extends M{}Br.key=o(T,"basis"),Br.values=I;class jr extends M{constructor(){super(...arguments),this.order=-1}}jr.key=T,jr.unit="";class zr extends M{}zr.matches=/^o:./,zr.key="order",zr.values={first:"-999999",last:"999999"},zr.unit="";class Yr extends M{constructor(){super(...arguments),this.order=-1}get parseValue(){return"span"===this.prefix.slice(-5,-1)&&"auto"!==this.value?"span "+this.value+"/span "+this.value:this.value}}Yr.matches=/^grid-col(?:umn)?(?:-span)?:./,Yr.key=o(S,u),Yr.unit="";class Gr extends M{}Gr.matches=/^col-span:./,Gr.key=o(u,"span");class qr extends M{constructor(){super(...arguments),this.order=-1}get parseValue(){return"span"===this.prefix.slice(-5,-1)&&"auto"!==this.value?"span "+this.value+"/span "+this.value:this.value}}qr.matches=/^grid-row-span:./,qr.key=o(S,d),qr.unit="";class P extends M{}P.matches=/^(font-color:.|font:current)/,P.colorStarts="(?:f(ont)?|color):",P.colorful=!0,P.key=g,P.unit="",P.values={current:n};class Kr extends M{}Kr.matches=/^ac:./,Kr.key=o(ee,h);class Xr extends M{}Xr.matches=/^ai:./,Xr.key=o(ee,"items");class Jr extends M{}Jr.matches=/^as:./,Jr.key=o(ee,"self");class Zr extends M{}Zr.matches=/^grid-auto-cols:./,Zr.key=o(S,A,U),Zr.values={min:o(w,h),max:o(b,h)};class Qr extends M{}Qr.matches=/^grid-flow:./,Qr.key=o(S,A,"flow");class en extends M{}en.key=o(S,A,V),en.values={min:o(w,h),max:o(b,h)};class tn extends M{}tn.matches=/^jc:./,tn.key=o(ge,h);class rn extends M{}rn.matches=/^ji:./,rn.key=o(ge,"items");class nn extends M{}nn.matches=/^js:./,nn.key=o(ge,"self");class on extends M{constructor(){super(...arguments),this.order=-1}}on.key=o("place",h);class sn extends M{constructor(){super(...arguments),this.order=-1}}sn.key=o("place","items");class an extends M{constructor(){super(...arguments),this.order=-1}}an.key=o("place","self");class ln extends M{get props(){return{[this.prefix.slice(0,-1)]:this}}get order(){return"padding:"===this.prefix?-1:0}}ln.id="padding",ln.matches=/^padding(?:-(?:left|right|top|bottom))?:./;class cn extends M{get props(){return{[this.prefix.slice(0,-1)]:this}}get order(){return"margin:"===this.prefix?-1:0}}cn.id="margin",cn.matches=/^margin(-(left|right|top|bottom))?:./;class un extends M{}un.matches=/^(text-(overflow|ovf):.|t(ext)?:(ellipsis|clip)(?!\|))/,un.key=o(x,"overflow");class dn extends M{}dn.matches=/^list-style:(inside|outside)(?!\|)/,dn.key=o(fe,N,ie);class hn extends M{}hn.matches=/^list-style:(disc|decimal)(?!\|)/,hn.key=o(fe,N,"type");class pn extends M{constructor(){super(...arguments),this.order=-1}}pn.key=o(fe,N);class fn extends M{}fn.key=o(x,ne,g),fn.colorStarts="text-decoration:",fn.colorful=!0,fn.values={current:n};class gn extends M{}gn.matches=/^t(ext)?:(solid|double|dotted|dashed|wavy)(?!\|)/,gn.key=o(x,ne,N);class mn extends M{}mn.matches=/^text-decoration:(from-font(?!\|)|([0-9]|(max|min|calc|clamp)\(.*\))((?!\|).)*$)/,mn.key=o(x,ne,"thickness"),mn.unit="em";class yn extends M{}yn.key=o(x,"indent");class vn extends M{}vn.key=h;class bn extends M{}bn.key=o(ye,g),bn.colorStarts="outline:",bn.colorful=!0,bn.values={current:n};class wn extends M{}wn.key=o(ye,me);class Cn extends M{}Cn.matches=/^outline:(none|dotted|dashed|solid|double|groove|ridge|inset|outset)(?!\|)/,Cn.key=o(ye,N);class En extends M{}En.matches=/^outline:(medium|thick|thin|[0-9]|(max|min|calc|clamp)\(.*\))((?!\|).)*$/,En.key=o(ye,v);class Tn extends M{constructor(){super(...arguments),this.order=-1}}Tn.key=ye,Tn.colorful=!0;class Sn extends M{}Sn.matches=/^b(order)?:(collapse|separate)(?!\|)/,Sn.key=o(a,"collapse");class _n extends M{}_n.key=o(a,ae);class xn extends M{}xn.key=o(O,"layout");class Rn extends M{}Rn.key=o("accent",g),Rn.colorStarts="accent:",Rn.colorful=!0;class An extends M{}An.key="appearance";class Nn extends M{}Nn.key=o("caret",g),Nn.matches=/^caret:transparent(?!\|)/,Nn.colorStarts="caret:",Nn.colorful=!0,Nn.values={current:n};class On extends M{}On.key=o(m,"behavior");class In extends M{get props(){if("m"!==this.prefix.slice(-3,-2))return{[this.prefix.replace(/-m(?!argin)/,"-margin").slice(0,-1)]:this};var e=o(m,s)+"-",t=e+Ye,r=e+Ge,n=e+je,i=e+ze;switch(this.prefix.slice(-2,-1)){case"x":return{[t]:this,[r]:this};case"y":return{[n]:this,[i]:this};case"l":return{[t]:this};case"r":return{[r]:this};case"t":return{[n]:this};case"b":return{[i]:this}}}get order(){return this.prefix===o(m,s)+":"||this.prefix===o(m,"m:")?-1:0}}In.id="scrollMargin",In.matches=/^scroll-m([xytblr]|argin(-(top|bottom|left|right))?)?:./;class Mn extends M{get props(){if("p"!==this.prefix.slice(-3,-2))return{[this.prefix.replace(/-p(?!adding)/,"-padding").slice(0,-1)]:this};var e=o(m,c)+"-",t=e+Ye,r=e+Ge,n=e+je,i=e+ze;switch(this.prefix.slice(-2,-1)){case"x":return{[t]:this,[r]:this};case"y":return{[n]:this,[i]:this};case"l":return{[t]:this};case"r":return{[r]:this};case"t":return{[n]:this};case"b":return{[i]:this}}}get order(){return this.prefix===o(m,c)+":"||this.prefix===o(m,"p:")?-1:0}}Mn.id="scrollPadding",Mn.matches=/^scroll-p([xytblr]|adding(-(top|bottom|left|right))?)?:./;class kn extends M{}kn.matches=/^scroll-snap:(start|end|center)/,kn.key=o(m,"snap",ee);class Dn extends M{}Dn.matches=/^scroll-snap:(normal|always)(?!\|)/,Dn.key=o(m,"snap","stop");class Pn extends M{}Pn.matches=/^scroll-snap:(([xy]|block|inline|both)(\|(proximity|mandatory))?)(?!\|)/,Pn.key=o(m,"snap","type");class Ln extends M{}Ln.key="will-change";class Fn extends M{}Fn.key=o(x,"underline",me);class Hn extends M{get props(){return{[this.prefix.slice(0,-1)]:this}}}Hn.matches=/^(?:top|bottom|left|right):./,Hn.key="inset";class Un extends M{constructor(){super(...arguments),this.order=-1}}Un.matches=/^(columns|cols):./,Un.key=U,Un.unit="";class Vn extends M{}Vn.key=o("white","space"),Vn.unit="";class Wn extends M{}Wn.matches=/^t(ext)?:(mixed|upright|sideways-right|sideways|use-glyph-orientation)(?!\|)/,Wn.key=o(x,"orientation");class $n extends M{}$n.matches=/^writing:./,$n.key=o("writing",j);class Bn extends M{}Bn.key="contain";class jn extends M{}jn.matches=/^\@duration:./,jn.key=o(y,"duration"),jn.unit="ms";class zn extends M{}zn.matches=/^t(ext)?:(optimizeSpeed|optimizeLegibility|geometricPrecision)(?!\|)/,zn.key=o(x,"rendering");class Yn extends M{}Yn.key=B;class Gn extends M{}Gn.matches=/^t(ext)?:(none|underline|overline|line-through)(?!\|)/,Gn.key=o(x,ne,"line");class qn extends M{}qn.matches=/^grid-col-start:./,qn.key=o(S,u,"start"),qn.unit="";class Kn extends M{}Kn.matches=/^list-style:(url|linear-gradient|radial-gradient|repeating-linear-gradient|repeating-radial-gradient|conic-gradient)\(.*\)((?!\|).)*$/,Kn.key=o(fe,N,p);class Xn extends M{}Xn.matches=/^shape:((margin|content|border|padding)(?!\|)|(inset|circle|ellipse|polygon|url|linear-gradient)\(.*\)((?!\|).)*$)/,Xn.key=o("shape","outside"),Xn.values={content:o(h,_),border:o(a,_),padding:o(c,_),margin:o(s,_)};class Jn extends M{}Jn.matches=/^shape:([0-9]|(max|min|calc|clamp)\(.*\))((?!\|).)*$/,Jn.key=o("shape",s);class Zn extends M{}Zn.key=o("shape",p,"threshold"),Zn.unit="";class Qn extends M{}Qn.matches=/^clip:./,Qn.key=o("clip","path"),Qn.values={content:o(h,_),border:o(a,_),padding:o(c,_),margin:o(s,_),fill:o(Q,_),stroke:o($,_),view:o("view",_)};class ei extends M{constructor(){super(...arguments),this.order=-1}}ei.key=S;class ti extends M{constructor(){super(...arguments),this.order=-1}}ti.matches=/^f:./,ti.key=r,ti.unit="",ti.colorful=!0;class ri extends M{}ri.key="quotes";class ni extends M{constructor(){super(...arguments),this.order=-1}}ni.key=o(S,i);class ii extends M{}ii.key=o(S,d,"start"),ii.unit="";class oi extends M{}oi.key=o(S,i,"area")+"s";class si extends M{}si.matches=/^grid-template-cols:./,si.key=o(S,i,U),si.values={min:o(w,h),max:o(b,h)};class ai extends M{}ai.key=o(S,i,V),ai.values={min:o(w,h),max:o(b,h)};class li extends M{constructor(){super(...arguments),this.order=-1}}li.key=o(S,"area"),li.unit="";class ci extends M{}ci.matches=/^grid-col-end:./,ci.key=o(S,u,"end"),ci.unit="";class ui extends M{}ui.key=o(S,d,"end"),ui.unit="";class di extends M{get props(){return{"mask-image":this,"-webkit-mask-image":this}}}di.key=o("mask",p);class hi extends M{get props(){return{"-webkit-text-fill-color":this}}}hi.id="textFillColor",hi.matches=/^text-fill-color:./,hi.colorStarts="text-fill:",hi.colorful=!0,hi.values={current:n};class pi extends M{get props(){return{"-webkit-text-stroke":this}}}pi.id="textStroke",pi.matches=/^text-stroke:./;class fi extends M{get props(){return{"-webkit-text-stroke-width":this}}}fi.id="textStrokeWidth",fi.matches=/^text-stroke(:((thin|medium|thick)(?!\|)|\.?\d((?!\|).)*$)|-width:.)/;class gi extends M{get props(){return{"-webkit-text-stroke-color":this}}}gi.id="textStrokeColor",gi.matches=/^text-stroke-color:./,gi.colorStarts="text-stroke:",gi.colorful=!0,gi.values={current:n};class mi extends M{}mi.key=o($,"dasharray");class yi extends M{}yi.key=o($,"dash")+me;class vi extends M{}vi.key="x",vi.unit="";class bi extends M{}bi.key="y",bi.unit="";class wi extends M{}wi.key="cx",wi.unit="";class Ci extends M{}Ci.key="cy",Ci.unit="";class Ei extends M{}Ei.key="rx",Ei.unit="";class Ti extends M{}Ti.key="ry",Ti.unit="";class Si extends M{}Si.key=o(a,p,"outset");class _i extends M{}_i.matches=/^border-image:(?:stretch|repeat|round|space)(?:(?!\|).)*$/,_i.key=o(a,p,"repeat");class xi extends M{}xi.key=o(a,p,"slice"),xi.unit="";class Ri extends M{}Ri.matches=/^border-image:(?:url|linear-gradient|radial-gradient|repeating-linear-gradient|repeating-radial-gradient|conic-gradient)\(.*\)(?:(?!\|).)*$/,Ri.key=o(a,p,"source");class Ai extends M{}Ai.matches=/^border-image:(?:\.?[0-9]|(max|min|calc|clamp)\(.*\))(?:(?!\|).)*$/,Ai.key=o(a,p,v);class Ni extends M{}Ni.key=o(a,p),Ni.unit="";const Oi=/\{(.*)\}/;class Ii extends M{get props(){const n={},r=e=>{var t,r=e.indexOf(":");-1===r||(t=e.slice(0,r))in n||(n[t]={value:e.slice(r+1)})},e=e=>{var t=e.text.slice(CSS.escape(e.name).length).match(Oi)[1].split(";");for(const e of t)r(e)},t=[];let i="";const o=()=>{i&&(t.push(i),i="")};let s=1;const a=e=>{for(;s<this.value.length;s++){var t=this.value[s];if(!e){if(";"===t){o();continue}if("}"===t)break}if(i+=t,e===t){if("'"===e){let t=0;for(let e=i.length-2;"\\"===i[e];e--)t++;if(t%2)continue}break}t in F&&"'"!==e&&(s++,a(F[t]))}};a(void 0),o();for(const n of t){const t=k.findAndNew(n);if(Array.isArray(t))for(const n of t)e(n);else t?e(t):r(n)}return n}}Ii.id=pe,Ii.matches=/^(?:.+?[*_>~+])?\{.+?\}/,Ii.unit="";class Mi extends M{}Mi.key="counter-increment",Mi.unit="";e=Vi(580),e=Vi.n(e);class ki extends M{}ki.semantics={"center-content":{"justify-content":"center","align-items":"center"},"sr-only":{position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0,0,0,0)","white-space":"nowrap","border-width":"0"},full:{width:"100%",height:"100%"},center:{left:0,right:0,"margin-left":A,"margin-right":A},middle:{top:0,bottom:0,"margin-top":A,"margin-bottom":A},"break-spaces":{"white-space":o(R,"space")+"s"},"break-word":{"overflow-wrap":o(R,re),overflow:Z}};const Di="undefined"!=typeof window,Pi=[ki,Ii,kr,We,$e,P,qe,cn,ln,Be,Br,$r,Wr,Ur,Vr,jr,_t,Ke,Xe,Je,Ze,Bn,vn,Mi,Qe,nt,it,ot,ti,st,at,lt,ct,fn,gn,mn,Gn,ut,Fn,un,Wn,dt,zn,yn,ht,Un,Vn,Hn,pt,Tt,St,xt,Rt,At,Nt,Ot,It,Mt,kt,Dt,dr,hr,br,wr,Cr,Er,Ar,Mr,Tr,Sr,xr,Rr,hi,fi,gi,pi,_r,xn,mt,gt,ft,yt,Ct,Et,wt,bt,vt,Pt,Lt,jn,Ft,Ht,Ut,Vt,Wt,$t,jt,Jt,Zt,Qt,Sn,_n,er,Si,_i,xi,Ri,Ai,Ni,tr,rr,nr,D,ir,or,sr,ar,lr,cr,ur,fr,vr,gr,mi,yi,yr,mr,vi,bi,wi,Ci,Ei,Ti,qn,ci,Yr,Nr,ii,ui,qr,Or,Zr,Qr,en,oi,si,ai,ni,li,ei,Ir,zr,Hr,Fr,Lr,Pr,Dr,Gr,Kr,Xr,Jr,tn,rn,nn,on,sn,an,dn,hn,Kn,pn,bn,wn,Cn,En,Tn,Rn,An,Nn,On,In,Mn,kn,Dn,Pn,Ln,$n,Yn,Xn,Jn,Zn,Qn,ri,di],Li=Pi.get=r=>Pi.find(e=>{var t;return r===e.id||r===(null==(t=e.key)?void 0:t.replace(/-./g,e=>e[1].toUpperCase()))||r===e.key});function Fi(){var e;Di&&(e=new k(document.head),(k.root=e).observe(document.documentElement))}Pi.extend=function(e,...t){var r=Object.assign({},...t);for(const t in r){var n,i=Li(t);i&&(n=r[t],i.extend(e,n))}return this},M.extend("colors",e()).extend("breakpoints",H()),k.Styles.push(...Pi),Di&&(window.initMasterCSS=Fi,window.MasterStyles=Pi,window.MasterCSSManual||Fi());const Hi=Vi(580),Ui=Vi(642)})(),Wi;function Vi(e){var t=n[e];return void 0!==t||(t=n[e]={exports:{}},r[e](t,t.exports,Vi)),t.exports}var r,n,Wi});const getGlobal=()=>{if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;if(void 0!==this)return this;throw new Error("전역 객체를 찾을 수 없습니다")},globalRoot=getGlobal();globalRoot.devicePlatform="browser","AndroidScript"in globalRoot?globalRoot.devicePlatform="android":"webkit"in globalRoot?globalRoot.devicePlatform="ios":"process"in globalRoot&&"object"==typeof module&&(globalRoot.devicePlatform="node");class Module{constructor(e){e&&this.extend(e)}concreate(){}extend(n,t){if(1<arguments.length){const r=this[n];if(r&&"function"==typeof t&&(!r.valueOf||r.valueOf()!==t.valueOf())&&/\bbase\b/.test(t)){const i=t.valueOf();(t=(...e)=>{var t=this.base||Module.prototype.base,e=(this.base=r,i.apply(this,e));return this.base=t,e}).valueOf=e=>"object"===e?t:i,t.toString=Module.toString}"config"===n?this[n]=(e=>{var t={};for(const r of e)for(const n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n]);return t})([this[n],t]):this[n]=t}else if(n){let r=Module.prototype.extend;Module.prototyping||"function"==typeof this||(r=this.extend||r);const o={toSource:null};["constructor","toString","valueOf","concreate"].forEach((e,t)=>{!Module.prototyping&&0===t||n[e]===o[e]||r.call(this,e,n[e])});for(const s in n)!o[s]&&Object.prototype.hasOwnProperty.call(n,s)&&r.call(this,s,n[s]);var e=n.concreate;e&&e.call(this,n)}return this}base(){}static extend(e,t){Module.prototyping=!0;const r=new this,n=(r.extend(e),r.base=()=>{},delete Module.prototyping,r.constructor),i=r.constructor=function(...e){if(!Module.prototyping)if(this.constructing||this.constructor===i)this.constructing=!0,n.apply(this,e),delete this.constructing;else if(null!=e[0])return(e[0].extend||Module.prototype.extend).call(e[0],r)};return i.ancestor=this,i.extend=this.extend,i.each=this.each,i.implement=this.implement,i.prototype=r,i.toString=this.toString,i.valueOf=e=>"object"===e?i:n.valueOf(),i.extend(t),"function"==typeof i.init&&i.init(),i}static each(e,t,r){if("function"==typeof t&&0!==t.length)for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&"object"==typeof e[n]&&null!==e[n]&&t.apply(e[n],r)}static implement(...e){return e.forEach(e=>{"function"==typeof e?e(this.prototype):this.prototype.extend(e)}),this}static toString(){return String(this.valueOf())}}Module.ancestor=Object,Module.version="v2025.7.3";const syn={Module:Module,Config:{SystemID:"HANDSTACK",ApplicationID:"HDS",ProjectID:"SYS",SystemVersion:"1.0.0",TransactionTimeout:18e4,HostName:"WebClient",UIEventLogLevel:"Verbose",IsLocaleTranslations:!1,LocaleAssetUrl:"/assets/shared/language/",AssetsCachingID:"cache-id",IsClientCaching:!0,IsDebugMode:!1,IsBundleLoad:!1,ContractRequestPath:"view",TenantAppRequestPath:"app",SharedAssetUrl:"/assets/shared/",IsApiFindServer:!1,DiscoveryApiServerUrl:"",ReportServer:"",FileManagerServer:"http://localhost:8421",FindClientIPServer:"/checkip",FindGlobalIDServer:"",FileServerType:"L",FileBusinessIDSource:"None",CookiePrefixName:"HandStack",Environment:"Development",DomainAPIServer:{ServerID:"SERVERD01",ServerType:"D",Protocol:"http",IP:"localhost",Port:"8421",Path:"/transact/api/transaction/execute",ClientIP:"localhost"},Program:{ProgramName:"ack",ProgramVersion:"1.0.0",LanguageID:"ko",LocaleID:"ko-KR",BranchCode:""},Transaction:{ProtocolVersion:"001",SimulationType:"P",DataFormat:"J",MachineTypeID:"WEB",EncryptionType:"P",EncryptionKey:"G",CompressionYN:"N"},EnvironmentSetting:{Application:{LoaderPath:"/js/syn.domain.js"}}}};syn.module=Module,globalRoot.syn=syn,"undefined"!=typeof module&&module.exports&&(module.exports=syn),!function(e){"use strict";var t=e.$browser||new syn.module;const s=e.document,r=e.navigator;var n=e.screen;t.extend({appName:r.appName,appCodeName:r.appCodeName,appVersion:r.appVersion,cookieEnabled:r.cookieEnabled,pdfViewerEnabled:r.pdfViewerEnabled,platform:r.platform,devicePlatform:e.devicePlatform,userAgent:r.userAgent,devicePixelRatio:e.devicePixelRatio,isExtended:n?.isExtended??!1,screenWidth:n?.width??0,screenHeight:n?.height??0,language:r.language||r.browserLanguage||r.userLanguage||"en",isWebkit:/AppleWebKit\//.test(r.userAgent),isMac:/Mac|Macintosh/.test(r.appVersion)||/Macintosh/.test(r.userAgent),isLinux:/Linux|X11/.test(r.appVersion),isWindow:/Win|Windows/.test(r.appVersion)||/Windows/.test(r.userAgent),isOpera:"Opera"===r.appName||/OPR\//.test(r.userAgent),isIE:!!s?.documentMode||/Trident|MSIE/i.test(r.userAgent),isChrome:!!e.chrome&&!/Edg\//.test(r.userAgent),isEdge:!!e.chrome&&/Edg\//.test(r.userAgent),isFF:void 0!==e.InstallTrigger||/Firefox/i.test(r.userAgent),isSafari:/constructor/i.test(e.HTMLElement)||"[object SafariRemoteNotification]"===(!e.safari||"undefined"!=typeof safari&&e.safari.pushNotification).toString(),isMobile:()=>r.userAgentData?.mobile??/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(r.userAgent),getSystemFonts(e=[]){var e=0<e.length?e:["Georgia","Times New Roman","Palatino Linotype","Book Antiqua","Garamond","Constantia","Cambria","Didot","Hoefler Text","Arial","Helvetica","Verdana","Tahoma","Geneva","Lucida Grande","Segoe UI","Roboto","Open Sans","Lato","Calibri","Optima","Candara","Trebuchet MS","Courier New","Lucida Console","Monaco","Consolas","Menlo","Inconsolata","Malgun Gothic","맑은 고딕","Dotum","돋움","Gulim","굴림","Batang","바탕","Gungsuh","궁서","Noto Sans KR","Pretendard","Nanum Gothic","나눔 고딕","Nanum Myeongjo","나눔 명조","Nanum Brush Script","나눔 손글씨 붓"],t=[],r=["serif","sans-serif","monospace"];const n={},i=document.createElement("span");i.style.position="absolute",i.style.visibility="hidden",i.style.top="-9999px",i.style.left="-9999px",i.style.fontSize="72px",i.textContent="abcdefghijklmnopqrstuvwxyz0123456789",document.body.appendChild(i),r.forEach(e=>{i.style.fontFamily=e,n[e]=i.offsetWidth});for(const o of e){let e=!1;for(const s of r)if(i.style.fontFamily=`"${o}", `+s,i.offsetWidth!==n[s]){e=!0;break}e&&t.push(o)}document.body.removeChild(i);e=[...new Set(t)];return e.sort(),e},getCanvas2dRender(){if(!s)return null;var e=s.createElement("canvas"),t=(e.width=200,e.height=50,e.getContext("2d"));if(!t)return null;t.font="21.5px Arial",t.fillText("😉",0,20),t.font="15.7px serif",t.fillText("abcdefghijklmnopqrtsuvwxyz",0,40),t.font="20.5px Arial";var r=t.createLinearGradient(0,0,e.width,e.height);return r.addColorStop(0,"red"),r.addColorStop(.5,"green"),r.addColorStop(1,"blue"),t.fillStyle=r,t.fillText("Lorem ipsum!",30,20),t.beginPath(),t.moveTo(170,5),t.lineTo(160,25),t.lineTo(185,20),t.fill(),e.toDataURL()},getWebglRender(){var e,t,r,n,i,o;return s&&((e=s.createElement("canvas")).width=50,e.height=50,t=e.getContext("webgl")||e.getContext("experimental-webgl"))?(r=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,r),t.bufferData(t.ARRAY_BUFFER,new Float32Array([-.1,.8,0,-.8,-.8,0,.8,-.7,0]),t.STATIC_DRAW),r=[0,1,2],o=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,o),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(r),t.STATIC_DRAW),o=t.createShader(t.VERTEX_SHADER),t.shaderSource(o,"attribute vec3 coordinates;void main(void) {gl_Position = vec4(coordinates, 1.0);}"),t.compileShader(o),n=t.createShader(t.FRAGMENT_SHADER),t.shaderSource(n,"void main(void) {gl_FragColor = vec4(0.0, 0.0, 0.0, 0.5);}"),t.compileShader(n),i=t.createProgram(),t.attachShader(i,o),t.attachShader(i,n),t.linkProgram(i),t.useProgram(i),o=t.getAttribLocation(i,"coordinates"),t.vertexAttribPointer(o,3,t.FLOAT,!1,0,0),t.enableVertexAttribArray(o),t.clearColor(1,1,1,1),t.enable(t.DEPTH_TEST),t.clear(t.COLOR_BUFFER_BIT),t.viewport(0,0,e.width,e.height),t.drawElements(t.TRIANGLES,r.length,t.UNSIGNED_SHORT,0),e.toDataURL()):null},getPlugins(){return r?.plugins?Array.from(r.plugins).map(e=>e.name+": "+e.filename):""},async fingerPrint(){var e={appName:this.appName,appCodeName:this.appCodeName,cookieEnabled:this.cookieEnabled,pdfViewerEnabled:this.pdfViewerEnabled,devicePixelRatio:this.devicePixelRatio,isExtended:this.isExtended,screenWidth:this.screenWidth,screenHeight:this.screenHeight,userAgent:this.userAgent,platform:this.platform,plugins:this.getPlugins(),dateFormat:new Date(0).toString(),fonts:this.getSystemFonts(),canvas2dRender:this.getCanvas2dRender(),webglRender:this.getWebglRender(),ipAddress:await this.getIpAddress()};return syn.$c.sha256(JSON.stringify(e))},windowWidth(){return e.innerWidth||s?.documentElement?.clientWidth||s?.body?.offsetWidth||0},windowHeight(){return e.innerHeight||s?.documentElement?.clientHeight||s?.body?.clientHeight||0},async getIpAddress(){let e="127.0.0.1";for(const r of[{url:"https://api.ipify.org"},{url:syn.Config.FindClientIPServer||"/checkip"}])try{var t=await fetch(r.url);if(t.ok){e=await t.text();break}}catch(e){console.warn(`'${r.url}' 에서 IP 를 가져오지 못했습니다:`,e)}return e}}),e.$browser=syn.$b=t}(globalRoot),!function(r){"use strict";var e=r.$manipulation||new syn.module;const i=r.document;e.extend({body(){return i},documentElement(){return i?.documentElement},childNodes(e){return(e=syn.$l.getElement(e))?e.childNodes:null},children(e){return(e=syn.$l.getElement(e))?e.children:null},firstChild(e){return(e=syn.$l.getElement(e))?e.firstChild:null},firstElementChild(e){return(e=syn.$l.getElement(e))?e.firstElementChild:null},lastChild(e){return(e=syn.$l.getElement(e))?e.lastChild:null},lastElementChild(e){return(e=syn.$l.getElement(e))?e.lastElementChild:null},nextSibling(e){return(e=syn.$l.getElement(e))?e.nextSibling:null},nextElementSibling(e){return(e=syn.$l.getElement(e))?e.nextElementSibling:null},previousSibling(e){return(e=syn.$l.getElement(e))?e.previousSibling:null},previousElementSibling(e){return(e=syn.$l.getElement(e))?e.previousElementSibling:null},siblings(t){return(t=syn.$l.getElement(t))?.parentElement?.children?Array.from(t.parentElement.children).filter(e=>e!==t):null},parentNode(e){return(e=syn.$l.getElement(e))?e.parentNode:null},parentElement(e){return(e=syn.$l.getElement(e))?e.parentElement:null},value(e,t){return(e=syn.$l.getElement(e))?(void 0!==t&&(e.value=$string.toValue(t)),e.value):null},textContent(e,t){return(e=syn.$l.getElement(e))?(void 0!==t&&(e.textContent=$string.toValue(t)),e.textContent):null},innerText(e,t){return(e=syn.$l.getElement(e))?(void 0!==t&&(e.innerText=$string.toValue(t)),e.innerText):null},innerHTML(e,t){return(e=syn.$l.getElement(e))?(void 0!==t&&(e.innerHTML=$string.toValue(t)),e.innerHTML):null},outerHTML(e){return(e=syn.$l.getElement(e))?e.outerHTML:null},className(e){return(e=syn.$l.getElement(e))?e.className:null},removeAttribute(e,t){return(e=syn.$l.getElement(e))&&t&&e.removeAttribute(t),this},getAttribute(e,t){return(e=syn.$l.getElement(e))&&t?e.getAttribute(t):null},setAttribute(e,t,r){return(e=syn.$l.getElement(e))&&t&&e.setAttribute(t,r),this},appendChild(e,t){return(e=syn.$l.getElement(e))&&t&&e.appendChild(t),this},setStyle(e,t,r){return(e=syn.$l.getElement(e))?.style&&t&&(e.style[t]=r),this},addCssText(e,t){return(e=syn.$l.getElement(e))?.style&&(e.style.cssText+=";"+t),this},addStyle(r,e){return(r=syn.$l.getElement(r))?.style&&$object.isObject(e)&&Object.entries(e).forEach(([e,t])=>{r.style[e]=t}),this},getStyle(e,t){return(e=syn.$l.getElement(e))?.style?.[t]??null},hasHidden(e){return!(e=syn.$l.getElement(e))||null===e.offsetParent||"none"===r.getComputedStyle(e).display},getComputedStyle(e,t){if(!(e=syn.$l.getElement(e))||!t)return null;try{return r.getComputedStyle(e)[t]}catch{return null}},addClass(t,e){return(t=syn.$l.getElement(t))&&e&&e.split(" ").forEach(e=>{e&&t.classList.add(e)}),this},hasClass(e,t){return!(!(e=syn.$l.getElement(e))||!t)&&e.classList.contains(t)},toggleClass(e,t){return(e=syn.$l.getElement(e))&&t&&e.classList.toggle(t),this},removeClass(t,e){return(t=syn.$l.getElement(t))&&(void 0===e?t.className="":e&&e.split(" ").forEach(e=>{e&&t.classList.remove(e)})),this},append(e,t,r,n={}){e=syn.$l.getElement(e);return e&&t&&i?(t=i.createElement(t),r&&(t.id=r),n.type&&(t.type=n.type),n.styles&&this.addStyle(t,n.styles),n.classNames&&this.addClass(t,n.classNames),void 0!==n.value&&this.value(t,n.value),void 0!==n.text&&this.innerText(t,n.text),void 0!==n.content&&this.textContent(t,n.content),void 0!==n.html&&this.innerHTML(t,n.html),e.appendChild(t),t):null},prepend(e,t){e=syn.$l.getElement(e);t=syn.$l.getElement(t);return e&&t?.firstChild?t.insertBefore(e,t.firstChild):e&&t&&t.appendChild(e),this},copy(e){return(e=syn.$l.getElement(e))?e.cloneNode(!0):null},remove(e){return(e=syn.$l.getElement(e))&&($webform?.purge&&$webform.purge(e),e.remove()),this},hasChild(e){return!!(e=syn.$l.getElement(e))&&e.hasChildNodes()},insertAfter(e,t){e=syn.$l.getElement(e);t=syn.$l.getElement(t);return e&&t?.parentNode&&t.parentNode.insertBefore(e,t.nextSibling),this},display(e,t){return(e=syn.$l.getElement(e))?.style&&(e.style.display=$string.toBoolean(t)?"block":"none"),this},toggleDisplay(e){var t;return(e=syn.$l.getElement(e))?.style?(t=r.getComputedStyle(e).display,this.display(e,"none"===t),e.style.display||r.getComputedStyle(e).display):"none"},parent(t,r){t=syn.$l.getElement(t);if(t){let e=t.parentElement;if(!r)return e;for(;e&&"HTML"!==e.tagName;){if(e.id===r)return e;e=e.parentElement}}return null},create(e={}){if(!i)return null;const r=i.createElement(e.tag||"div");return e.id&&(r.id=e.id),e.styles&&this.addStyle(r,e.styles),e.className&&(r.className=e.className),e.classNames&&this.addClass(r,e.classNames),e.attributes&&Object.entries(e.attributes).forEach(([e,t])=>r.setAttribute(e,t)),e.data&&(r.dataset.data=JSON.stringify(e.data)),void 0!==e.value&&this.value(r,e.value),void 0!==e.text&&this.innerText(r,e.text),void 0!==e.content&&this.textContent(r,e.content),void 0!==e.html&&this.innerHTML(r,e.html),r},each(e,t){$object.isArray(e)&&$object.isFunction(t)&&e.forEach(t)},setActive(e,t){return(e=syn.$l.getElement(e))?.classList&&e.classList.toggle("active",$string.toBoolean(t)),this},setSelected(e,t,r=!1){return(e=syn.$l.getElement(e))&&(t=$string.toBoolean(t),$string.toBoolean(r)||this.siblings(e)?.forEach(e=>{e.selected=!1,e.removeAttribute("selected")}),(e.selected=t)?e.setAttribute("selected","selected"):e.removeAttribute("selected")),this},setChecked(t,e,r=!1){return(t=syn.$l.getElement(t))&&(e=$string.toBoolean(e),$string.toBoolean(r)||this.siblings(t)?.forEach(e=>{e.tagName===t.tagName&&e.type===t.type&&e.name===t.name&&(e.checked=!1,e.removeAttribute("checked"))}),(t.checked=e)?t.setAttribute("checked","checked"):t.removeAttribute("checked")),this},getClassRegEx(e){e=e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");return new RegExp(`(^|\\s)${e} (\\s | $)`)}}),r.$manipulation=syn.$m=e}(globalRoot),!function(c){"use strict";var e=c.$dimension||new syn.module;const i=c.document;e.extend({getDocumentSize(e=!1){e=$string.toBoolean(e)?top.document:i;return e?.body&&e?.documentElement?{width:Math.max(e.body.scrollWidth,e.documentElement.scrollWidth,e.body.offsetWidth,e.documentElement.offsetWidth,e.body.clientWidth,e.documentElement.clientWidth),height:Math.max(e.body.scrollHeight,e.documentElement.scrollHeight,e.body.offsetHeight,e.documentElement.offsetHeight,e.body.clientHeight,e.documentElement.clientHeight),frameWidth:e.documentElement.clientWidth||e.body.clientWidth||0,frameHeight:e.documentElement.clientHeight||e.body.clientHeight||0}:{width:0,height:0,frameWidth:0,frameHeight:0}},getWindowSize(e=!1){e=$string.toBoolean(e)?top.window:c;return{width:e?.innerWidth??0,height:e?.innerHeight??0}},getScrollPosition(e){return(e=syn.$l.getElement(e))?{left:e.pageXOffset??e.scrollLeft??0,top:e.pageYOffset??e.scrollTop??0}:i?{left:i.documentElement?.scrollLeft??i.body?.scrollLeft??0,top:i.documentElement?.scrollTop??i.body?.scrollTop??0}:{left:0,top:0}},getMousePosition(e){var t,e=e||c.event||top?.event;return e?(t=this.getScrollPosition(),{x:e.pageX??e.clientX+t.left??0,y:e.pageY??e.clientY+t.top??0,relativeX:e.layerX??e.offsetX??0,relativeY:e.layerY??e.offsetY??0}):{x:0,y:0,relativeX:0,relativeY:0}},offset(e){var t,r;return(e=syn.$l.getElement(e))?.getBoundingClientRect?(e=e.getBoundingClientRect(),t=c.pageXOffset||i?.documentElement?.scrollLeft||0,r=c.pageYOffset||i?.documentElement?.scrollTop||0,{top:e.top+r,left:e.left+t}):null},offsetLeft(e){e=syn.$l.getElement(e);let t=0;for(;e&&e.offsetParent;)t+=e.offsetLeft,e=e.offsetParent;return t},parentOffsetLeft(e){return(e=syn.$l.getElement(e)||i?.documentElement||i?.body)?.parentElement?e.parentElement===e.offsetParent?e.offsetLeft:this.offsetLeft(e)-this.offsetLeft(e.parentElement):0},offsetTop(e){e=syn.$l.getElement(e);let t=0;for(;e&&e.offsetParent;)t+=e.offsetTop,e=e.offsetParent;return t},parentOffsetTop(e){return(e=syn.$l.getElement(e)||i?.documentElement||i?.body)?.parentElement?e.parentElement===e.offsetParent?e.offsetTop:this.offsetTop(e)-this.offsetTop(e.parentElement):0},getSize(e){var t,r,n,i,o,s,a,l;return(e=syn.$l.getElement(e))&&c.getComputedStyle?(l=c.getComputedStyle(e),t=parseFloat(l.paddingLeft)||0,r=parseFloat(l.paddingRight)||0,n=parseFloat(l.paddingTop)||0,i=parseFloat(l.paddingBottom)||0,o=parseFloat(l.marginLeft)||0,s=parseFloat(l.marginRight)||0,a=parseFloat(l.marginTop)||0,l=parseFloat(l.marginBottom)||0,{width:e.clientWidth-t-r,height:e.clientHeight-n-i,clientWidth:e.clientWidth,clientHeight:e.clientHeight,offsetWidth:e.offsetWidth,offsetHeight:e.offsetHeight,marginWidth:e.offsetWidth+o+s,marginHeight:e.offsetHeight+a+l}):null},measureWidth(e,t){var r;return i?.body?(r=i.createElement("div"),Object.assign(r.style,{position:"absolute",visibility:"hidden",whiteSpace:"nowrap",left:"-9999px",fontSize:t||"inherit"}),r.textContent=e,i.body.appendChild(r),t=c.getComputedStyle(r).width,i.body.removeChild(r),t):"0px"},measureHeight(e,t,r){var n;return i?.body?(n=i.createElement("div"),Object.assign(n.style,{position:"absolute",visibility:"hidden",width:t||"auto",left:"-9999px",fontSize:r||"inherit",wordWrap:"break-word"}),n.textContent=e,i.body.appendChild(n),t=c.getComputedStyle(n).height,i.body.removeChild(n),t):"0px"},measureSize(e,t,r="800px"){if(null==e)return null;let n=r,i=($object.isNumber(r)&&(n=r+" px"),this.measureWidth(e,t)),o=0,s=1/0;i.endsWith("px")&&(o=$string.toNumber(i.slice(0,-2))),s=n.endsWith("px")?$string.toNumber(n.slice(0,-2)):$string.toNumber(n),!isNaN(s)&&o>s&&(i=s+" px");r=this.measureHeight(e,i,t);return{width:i,height:r}}}),c.$dimension=syn.$d=e}(globalRoot),!function(e){"use strict";const s=e.$cryptography||new syn.module,o=new TextEncoder,a=new TextDecoder;s.extend({base64Encode(e){if("node"===globalRoot.devicePlatform)return Buffer.from(e,"utf8").toString("base64");try{var t=o.encode(String(e));return btoa(String.fromCharCode(...t))}catch(e){return syn.$l.eventLog("$c.base64Encode","Base64 인코딩 실패: "+e,"Error"),null}},base64Decode(e){if("node"===globalRoot.devicePlatform)return Buffer.from(e,"base64").toString("utf8");try{var t=atob(String(e)),r=new Uint8Array([...t].map(e=>e.charCodeAt(0)));return a.decode(r)}catch(e){return syn.$l.eventLog("$c.base64Encode","Base64 디코딩 실패: "+e,"Error"),null}},utf8Encode(e){if("string"!=typeof e)throw new TypeError("매개변수가 문자열이 아닙니다.");try{return o.encode(e)}catch(e){syn.$l.eventLog("$c.base64Encode","UTF-8 인코딩 실패: "+e,"Error")}return null},utf8Decode(e){if("string"!=typeof e)throw new TypeError("매개변수가 UTF-8 문자열이 아닙니다.");try{return a.decode(this.convertToBuffer(e.split(",").map(Number)))}catch(e){syn.$l.eventLog("$c.base64Encode","UTF-8 디코딩 실패: "+e,"Error")}return null},convertToBuffer(t){var e=new ArrayBuffer(t.length),r=new Uint8Array(e);for(let e=0;e<t.length;e++)r[e]=t[e];return e},isWebCryptoSupported(){return!!e.crypto?.subtle},padKey(e,t){return"string"!=typeof e?null:(e=o.encode(e)).length>=t?e.slice(0,t):((t=new Uint8Array(t)).set(e),t)},async generateHMAC(e,t){e=o.encode(e),t=o.encode(t),e=await crypto.subtle.importKey("raw",e,{name:"HMAC",hash:"SHA-256"},!1,["sign"]),e=await crypto.subtle.sign("HMAC",e,t);return Array.from(new Uint8Array(e)).map(e=>e.toString(16).padStart(2,"0")).join("")},async verifyHMAC(e,t,r){return await s.generateHMAC(e,t)===r},async generateRSAKey(){return await window.crypto.subtle.generateKey({name:"RSA-OAEP",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:"SHA-256"},!0,["encrypt","decrypt"])},async exportCryptoKey(e,t){let r="";var n=1==(t=$string.toBoolean(t))?"PUBLIC":"PRIVATE",t=await window.crypto.subtle.exportKey(1==t?"spki":"pkcs8",e),e=String.fromCharCode.apply(null,new Uint8Array(t)),t=window.btoa(e),e=(r=`-----BEGIN ${n} KEY-----
${t}
-----END ${n} KEY-----`).split("\n");return(r=e.map(e=>e.match(/.{1,64}/g).join("\n"))).join("\n")},async importCryptoKey(e,t){var r=1==(t=$string.toBoolean(t))?"PUBLIC":"PRIVATE",e=e.substring(`-----BEGIN ${r} KEY-----`.length,e.length-`-----END ${r} KEY-----`.length).replaceAll("\n",""),r=window.atob(e),e=syn.$l.stringToArrayBuffer(r);return await crypto.subtle.importKey(1==t?"spki":"pkcs8",e,{name:"RSA-OAEP",hash:"SHA-256"},!0,1==t?["encrypt"]:["decrypt"])},async rsaEncode(e,t){e=o.encode(e),t=await crypto.subtle.encrypt({name:"RSA-OAEP"},t,e);return s.base64Encode(new Uint8Array(t))},async rsaDecode(e,t){e=new Uint8Array(s.base64Decode(e).split(",").map(Number)),t=await crypto.subtle.decrypt({name:"RSA-OAEP"},t,e);return a.decode(t)},generateIV(e,t){let r;return t=t||16,r=e&&"$RANDOM$"==e.toUpperCase()?window.crypto.getRandomValues(new Uint8Array(t)):(e=e||"",s.padKey(e,t))},async aesEncode(e,t,r,n){t=t||"",n=n||256;var i="AES-GCM"===(r=r||"AES-CBC")?12:16,i=s.generateIV(t,i),e=o.encode(e),t=await window.crypto.subtle.importKey("raw",s.padKey(t,n/8),{name:r},!1,["encrypt"]),n=await window.crypto.subtle.encrypt({name:r,iv:i},t,e);return{iv:s.base64Encode(i),encrypted:s.base64Encode(new Uint8Array(n))}},async aesDecode(e,t,r,n){let i=null;var o;return t=t||"",r=r||"AES-CBC",n=n||256,e&&e.iv&&e.encrypted&&(o=new Uint8Array(s.base64Decode(e.iv).split(",").map(Number)),e=new Uint8Array(s.base64Decode(e.encrypted).split(",").map(Number)),t=await window.crypto.subtle.importKey("raw",s.padKey(t,n/8),{name:r},!1,["decrypt"]),n=await window.crypto.subtle.decrypt({name:r,iv:o},t,e),i=a.decode(n)),i},async sha(e,t){t=t||"SHA-1";e=o.encode(e),t=await crypto.subtle.digest(t,e);return Array.from(new Uint8Array(t)).map(e=>e.toString(16).padStart(2,"0")).join("")},sha256(e){const w=(e,t)=>{var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r},C=(e,t)=>e>>>t|e<<32-t,E=(e,t)=>e>>>t;{var r=((r,e)=>{var n,i,o,s,a=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],l=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],c=new Array(64);let u,d,h,p,f,g,m,y,v,b;r[e>>5]|=128<<24-e%32,r[15+(e+64>>9<<4)]=e;for(let t=0;t<r.length;t+=16){u=l[0],d=l[1],h=l[2],p=l[3],f=l[4],g=l[5],m=l[6],y=l[7];for(let e=0;e<64;e++)e<16?c[e]=r[e+t]:c[e]=w(w(w((s=c[e-2],C(s,17)^C(s,19)^E(s,10)),c[e-7]),(s=c[e-15],C(s,7)^C(s,18)^E(s,3))),c[e-16]),v=w(w(w(w(y,(s=f,C(s,6)^C(s,11)^C(s,25))),(n=f,i=g,o=m,n&i^~n&o)),a[e]),c[e]),b=w((i=u,C(i,2)^C(i,13)^C(i,22)),(n=u,o=d,i=h,n&o^n&i^o&i)),y=m,m=g,g=f,f=w(p,v),p=h,h=d,d=u,u=w(v,b);l[0]=w(u,l[0]),l[1]=w(d,l[1]),l[2]=w(h,l[2]),l[3]=w(p,l[3]),l[4]=w(f,l[4]),l[5]=w(g,l[5]),l[6]=w(m,l[6]),l[7]=w(y,l[7])}return l})((t=>{var r=[];for(let e=0;e<8*t.length;e+=8)r[e>>5]|=(255&t.charCodeAt(e/8))<<24-e%32;return r})(e),8*e.length),n="0123456789abcdef";let t="";for(let e=0;e<4*r.length;e++)t+=n.charAt(r[e>>2]>>8*(3-e%4)+4&15)+n.charAt(r[e>>2]>>8*(3-e%4)&15);return t}},encrypt(e,t){var r;return null==e?null:(r=t?t.length:6,t=this.sha256(t||"").substring(0,r),r=((t,r)=>{var n=[],i=r.length;for(let e=0;e<t.length;e++){var o=e%i,o=t.charCodeAt(e)+r.charCodeAt(o);n.push(o)}return JSON.stringify(n)})(String(e),t),encodeURIComponent(this.base64Encode(r+"."+t)))},decrypt(e,r){if(null==e)return null;try{var t=this.base64Decode(decodeURIComponent(e));if(t&&-1!==t.indexOf(".")){var[n,i]=t.split(".");{var o=n,s=i,a=r?r.length:6;if(s!==this.sha256(r||"").substring(0,a))return"";var l=JSON.parse(o),c=s.length;let t="";for(let e=0;e<l.length;e++){var u=e%c,u=l[e]-s.charCodeAt(u);t+=String.fromCharCode(u)}return t}}return null}catch(e){return syn.$l.eventLog("$c.decrypt",e,"Error"),null}},LZString:function(){const m=String.fromCharCode,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",i={};function o(t,e){if(!i[t]){i[t]={};for(let e=0;e<t.length;e++)i[t][t.charAt(e)]=e}return i[t][e]}const s={compressToBase64(e){if(null==e)return"";var t=s._compress(e,6,e=>r.charAt(e));switch(t.length%4){case 0:return t;case 1:return t+"===";case 2:return t+"==";case 3:return t+"="}},decompressFromBase64(t){return null==t?"":""==t?null:s._decompress(t.length,32,e=>o(r,t.charAt(e)))},compressToUTF16(e){return null==e?"":s._compress(e,15,e=>m(e+32))+" "},decompressFromUTF16(t){return null==t?"":""==t?null:s._decompress(t.length,16384,e=>t.charCodeAt(e)-32)},compressToUint8Array(e){var r=s.compress(e),n=new Uint8Array(2*r.length);for(let e=0,t=r.length;e<t;e++){var i=r.charCodeAt(e);n[2*e]=i>>>8,n[2*e+1]=i%256}return n},decompressFromUint8Array(r){if(null==r)return s.decompress(null);if(!r?.length)return s.decompress("");var n=new Array(r.length/2);for(let e=0,t=n.length;e<t;e++)n[e]=256*r[2*e]+r[2*e+1];var e=n.map(e=>m(e));return s.decompress(e.join(""))},compressToEncodedURIComponent(e){return null==e?"":s._compress(e,6,e=>n.charAt(e))},decompressFromEncodedURIComponent(t){return null==t?"":""==t?null:(t=t.replace(/ /g,"+"),s._decompress(t.length,32,e=>o(n,t.charAt(e))))},compress(e){return s._compress(e,16,e=>m(e))},_compress(e,t,r){if(null==e)return"";let n,i,o={},s={},a,l,c="",u=2,d=3,h=2,p=[],f=0,g=0,m;for(m=0;m<e.length;m+=1)if(a=e.charAt(m),Object.prototype.hasOwnProperty.call(o,a)||(o[a]=d++,s[a]=!0),l=c+a,Object.prototype.hasOwnProperty.call(o,l))c=l;else{if(Object.prototype.hasOwnProperty.call(s,c)){if(c.charCodeAt(0)<256){for(n=0;n<h;n++)f<<=1,g==t-1?(g=0,p.push(r(f)),f=0):g++;for(i=c.charCodeAt(0),n=0;n<8;n++)f=f<<1|1&i,g==t-1?(g=0,p.push(r(f)),f=0):g++,i>>=1}else{for(i=1,n=0;n<h;n++)f=f<<1|i,g==t-1?(g=0,p.push(r(f)),f=0):g++,i=0;for(i=c.charCodeAt(0),n=0;n<16;n++)f=f<<1|1&i,g==t-1?(g=0,p.push(r(f)),f=0):g++,i>>=1}0==--u&&(u=Math.pow(2,h),h++),delete s[c]}else for(i=o[c],n=0;n<h;n++)f=f<<1|1&i,g==t-1?(g=0,p.push(r(f)),f=0):g++,i>>=1;0==--u&&(u=Math.pow(2,h),h++),o[l]=d++,c=String(a)}if(""!==c){if(Object.prototype.hasOwnProperty.call(s,c)){if(c.charCodeAt(0)<256){for(n=0;n<h;n++)f<<=1,g==t-1?(g=0,p.push(r(f)),f=0):g++;for(i=c.charCodeAt(0),n=0;n<8;n++)f=f<<1|1&i,g==t-1?(g=0,p.push(r(f)),f=0):g++,i>>=1}else{for(i=1,n=0;n<h;n++)f=f<<1|i,g==t-1?(g=0,p.push(r(f)),f=0):g++,i=0;for(i=c.charCodeAt(0),n=0;n<16;n++)f=f<<1|1&i,g==t-1?(g=0,p.push(r(f)),f=0):g++,i>>=1}0==--u&&(u=Math.pow(2,h),h++),delete s[c]}else for(i=o[c],n=0;n<h;n++)f=f<<1|1&i,g==t-1?(g=0,p.push(r(f)),f=0):g++,i>>=1;0==--u&&(u=Math.pow(2,h),h++)}for(i=2,n=0;n<h;n++)f=f<<1|1&i,g==t-1?(g=0,p.push(r(f)),f=0):g++,i>>=1;for(;;){if(f<<=1,g==t-1){p.push(r(f));break}g++}return p.join("")},_decompress(e,t,r){var n=[];let i=4,o=4,s=3,a="",l=[],c,u,d,h,p,f;var g={val:r(0),position:t,index:1};for(let e=0;e<3;e+=1)n[e]=e;for(u=0,h=Math.pow(2,2),p=1;p!=h;)d=g.val&g.position,g.position>>=1,0==g.position&&(g.position=t,g.val=r(g.index++)),u|=(0<d?1:0)*p,p<<=1;switch(u){case 0:for(u=0,h=Math.pow(2,8),p=1;p!=h;)d=g.val&g.position,g.position>>=1,0==g.position&&(g.position=t,g.val=r(g.index++)),u|=(0<d?1:0)*p,p<<=1;f=m(u);break;case 1:for(u=0,h=Math.pow(2,16),p=1;p!=h;)d=g.val&g.position,g.position>>=1,0==g.position&&(g.position=t,g.val=r(g.index++)),u|=(0<d?1:0)*p,p<<=1;f=m(u);break;case 2:return""}for(n[3]=f,c=f,l.push(f);;){if(e<g.index)return"";for(u=0,h=Math.pow(2,s),p=1;p!=h;)d=g.val&g.position,g.position>>=1,0==g.position&&(g.position=t,g.val=r(g.index++)),u|=(0<d?1:0)*p,p<<=1;switch(f=u){case 0:for(u=0,h=Math.pow(2,8),p=1;p!=h;)d=g.val&g.position,g.position>>=1,0==g.position&&(g.position=t,g.val=r(g.index++)),u|=(0<d?1:0)*p,p<<=1;n[o++]=m(u),f=o-1,i--;break;case 1:for(u=0,h=Math.pow(2,16),p=1;p!=h;)d=g.val&g.position,g.position>>=1,0==g.position&&(g.position=t,g.val=r(g.index++)),u|=(0<d?1:0)*p,p<<=1;n[o++]=m(u),f=o-1,i--;break;case 2:return l.join("")}if(0==i&&(i=Math.pow(2,s),s++),n[f])a=n[f];else{if(f!==o)return null;a=c+c.charAt(0)}l.push(a),n[o++]=c+a.charAt(0),i--,c=a,0==i&&(i=Math.pow(2,s),s++)}}};return s}()}),e.$cryptography=syn.$c=s}(globalRoot),!function(i){"use strict";var e=i.$keyboard||new syn.module;i.$object;const o=i.$library;e.extend({keyCodes:Object.freeze({backspace:8,tab:9,enter:13,shift:16,control:17,alt:18,capslock:20,escape:27,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,delete:46,semicolon:186,colon:186,equal:187,plus:187,comma:188,less:188,minus:189,underscore:189,period:190,greater:190,slash:191,questionmark:191,backtick:192,tilde:192,openingsquarebracket:219,openingcurlybracket:219,backslash:220,pipe:220,closingsquarebracket:221,closingcurlybracket:221,singlequote:222,doublequote:222,clear:12,meta:91,contextmenu:93,numpad0:96,numpad1:97,numpad2:98,numpad3:99,numpad4:100,numpad5:101,numpad6:102,numpad7:103,numpad8:104,numpad9:105,multiply:106,add:107,subtract:109,decimal:110,divide:111,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123}),targetEL:null,elements:{},setElement(e){if(e=syn.$l.getElement(e)){var t=e.id||e.nodeName||"el_"+o.random();if(e.eventID=t,!this.elements[t]){const n={keydown:{},keyup:{}};var r=e=>{var t=e.type,r=e.keyCode||e.key,t=n[t]?.[r];if("function"==typeof t&&(i.keyboardEvent=e,!1===t(i.documentEvent=e)))return e.preventDefault(),e.stopPropagation(),!1};syn.$l.addEvent(e,"keydown",r),syn.$l.addEvent(e,"keyup",r),this.elements[t]=n}this.targetEL=e}return this},addKeyCode(e,t,r){return this.targetEL?.eventID&&this.elements[this.targetEL.eventID]?.[e]&&"function"==typeof r&&(this.elements[this.targetEL.eventID][e][t]=r),this},removeKeyCode(e,t){return this.targetEL?.eventID&&this.elements[this.targetEL.eventID]?.[e]?.[t]&&delete this.elements[this.targetEL.eventID][e][t],this}}),i.$keyboard=syn.$k=e}(globalRoot),!function(g){"use strict";var e=g.$validation||new syn.module;g.$object,g.$string,g.$library;const m=g.$this;e.extend({isContinue:!0,messages:[],targetEL:null,elements:{},roles:Object.freeze({Root:0,Administrator:100,Master:200,Architect:300,Manager:400,BusinessOwner:500,Operator:600,Developer:700,Designer:800,User:900}),initializeValidObject(e){return this.elements[e.id]||(this.elements[e.id]={pattern:{},range:{},custom:{}}),this.elements[e.id]},setElement(e){return(e=syn.$l.getElement(e))?.id?(this.initializeValidObject(e),this.targetEL=e):this.targetEL=null,this},required(e,t=!0,r){return $string.isNullOrEmpty(r)?syn.$l.eventLog("$v.required","message 확인 필요","Information"):(e=syn.$l.getElement(e))&&(this.setElement(e),e.required=$string.toBoolean(t),e.message=r),this},pattern(e,t,r={}){return!r.expr||$string.isNullOrEmpty(r.message)?syn.$l.eventLog("$v.pattern","options.expr, options.message 확인 필요","Information"):(this.setElement(e),this.targetEL?.id&&t&&(this.elements[this.targetEL.id].pattern[t]=r)),this},range(e,t,r={}){return!$string.isNumber(r.min)||!$string.isNumber(r.max)||$string.isNullOrEmpty(r.minOperator)||$string.isNullOrEmpty(r.maxOperator)||$string.isNullOrEmpty(r.message)?syn.$l.eventLog("$v.range","options.min, options.minOperator, options.max, options.maxOperator, options.message 확인 필요","Information"):(this.setElement(e),this.targetEL?.id&&t&&(this.elements[this.targetEL.id].range[t]=r)),this},custom(e,t,r={}){return!r.functionName||$string.isNullOrEmpty(r.message)?syn.$l.eventLog("$v.custom","options.functionName, options.message 확인 필요","Information"):(this.setElement(e),this.targetEL?.id&&t&&(this.elements[this.targetEL.id].custom[t]=r)),this},removeValidate(t,r){if(this.targetEL?.id&&this.elements[this.targetEL.id]?.[t]?.[r])try{delete this.elements[this.targetEL.id][t][r]}catch(e){syn.$l.eventLog("$v.removeValidate",`Failed to delete validation: ${t}.`+r,"Warning")}return this},remove(e){return this.targetEL?.id&&this.elements[this.targetEL.id]&&(delete this.elements[this.targetEL.id].pattern?.[e],delete this.elements[this.targetEL.id].range?.[e],delete this.elements[this.targetEL.id].custom?.[e]),this},clear(){return this.isContinue=!0,this.messages=[],this.targetEL=null,this.elements={},this},validateControl(r){if(!(r=syn.$l.getElement(r))?.id)return!0;this.setElement(r);let e=!0;var n=r.value?.trim()??"";if($string.toBoolean(r.required)&&0===n.length&&(e=!1,this.messages.push(r.message),!this.isContinue))return!1;if(!e&&!this.isContinue)return!1;if(!$string.toBoolean(r.required)&&0===n.length)return!0;var t=this.elements[r.id];if(t){for(var[i,o]of Object.entries(t.pattern))if(!o.expr.test(n)&&(e=!1,this.messages.push(o.message),!this.isContinue))return!1;if(!e&&!this.isContinue)return!1;for(var[s,a]of Object.entries(t.range)){let t=!1;if($string.isNumber(n))try{var l=$string.toNumber(n),c=$string.toNumber(a.min),u=$string.toNumber(a.max);t=((e,t,r)=>{switch(e){case">":return t<r;case">=":return t<=r;case"<":return r<t;case"<=":return r<=t;case"==":return r==t;case"!=":return r!=t;default:return!1}})(a.minOperator,l,c)&&((e,t,r)=>{switch(e){case"<":return r<t;case"<=":return r<=t;case">":return t<r;case">=":return t<=r;case"==":return r==t;case"!=":return r!=t;default:return!1}})(a.maxOperator,l,u)}catch(e){syn.$l.eventLog("$v.validateControl",`elID: "${r.id}" 유효성 range 검사 오류 `+e.message,"Warning"),t=!1}else t=!1;if(!t&&(e=!1,this.messages.push(a.message),!this.isContinue))return!1}if(!e&&!this.isContinue)return!1;for(var[d,h]of Object.entries(t.custom)){let t=!1;var p=h.functionName,f={...h};delete f.functionName,delete f.message;try{let e=null;if(m?.method&&"function"==typeof m.method[p])e=m.method[p],t=e.call(m,f);else{if("function"!=typeof g[p])throw new Error(`Custom validation function "${p}" not found.`);e=g[p],t=e.call(g,f)}}catch(e){syn.$l.eventLog("$v.validateControl",`elID: "${r.id}" 유효성 custom 검사 오류 `+e.message,"Warning"),t=!1}if(!t&&(e=!1,this.messages.push(h.message),!this.isContinue))return!1}}return e},validateControls(e){let t=!0;for(const n of Array.isArray(e)?e:e&&e.type?[e]:[]){var r=this.validateControl(n);if(!r&&(t=!1,!this.isContinue))break}return t},validateForm(){let e=!0;for(const r in this.elements)if(Object.prototype.hasOwnProperty.call(this.elements,r)){var t=this.validateControl(r);if(!t&&(e=!1,!this.isContinue))break}return e},toMessages(){var e=this.messages.join("\n");return this.messages=[],e},getRoleValue(e,t=!0){e=(Array.isArray(e)?e:[e]).map(e=>this.roles[e]).filter(e=>void 0!==e);return 0===e.length?-1:t?Math.min(...e):Math.max(...e)},getRoleName(e,t=!0){e=(Array.isArray(e)?e:[e]).map(e=>parseInt(e,10)).filter(e=>!isNaN(e)&&Object.values(this.roles).includes(e));if(0===e.length)return null;const r=t?Math.min(...e):Math.max(...e);return Object.keys(this.roles).find(e=>this.roles[e]===r)||null},valueType:Object.freeze({valid:0,valueMissing:1,typeMismatch:2,patternMismatch:3,tooLong:4,rangeUnderflow:5,rangeOverflow:6,stepMismatch:7}),validType:Object.freeze({required:0,pattern:1,range:2,custom:3}),regexs:Object.freeze({alphabet:/^[a-zA-Z0-9]*$/,juminNo:/^\d{2}(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])[-]?([1-4]|9)\d{6}$/,numeric:/^-?(\d+|\d{1,3}(,\d{3})*)(\.\d+)?$/,email:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/i,url:/^(https?:\/\/)?([\da-z.-]+)\.([a-z.]{2,6})([/\w .-]*)*\/?$/i,ipAddress:/^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)$|^localhost$/i,date:/^\d{4}-\d{2}-\d{2}$/,mobilePhone:/^01[016789]\d{7,8}$/,seoulPhone:/^02\d{7,8}$/,areaPhone:/^0(3[1-3]|4[1-4]|5[1-5]|6[1-4])\d{7,8}$/,onesPhone:/^050([245678])\d{7,8}$/,float:/^\s*-?(\d*\.?\d+|\d+\.?\d*)([eE][-+]?\d+)?\s*$/i,isoDate:/\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d(\.\d+)?([+-][0-2]\d(:[0-5]\d)?|Z)/i})}),g.$validation=syn.$v=e}(globalRoot),!function(e){"use strict";const s=e.$date||new syn.module;var t=e.$array||new syn.module;const o=e.$string||new syn.module;var r=e.$number||new syn.module;const C=e.$object||new syn.module;Function.prototype.clone||(Function.prototype.clone=function(){function e(){return r.apply(this,arguments)}var t,r=this;for(t in this)e[t]=this[t];return e}),Object.assign||(Object.assign=function(e){if(null===e||"object"!=typeof e)return e;var t,r=e.constructor();for(t in e)e.hasOwnProperty(t)&&(r[t]=e[t]);return r}),Object.entries||(Object.entries=function(e){for(var t=Object.keys(e),r=t.length,n=new Array(r);r--;)n[r]=[t[r],e[t[r]]];return n}),String.prototype.trim||(String.prototype.trim=function(){for(var e=this.replace(/^\s+/,""),t=e.length-1;0<t;t--)if(/\S/.test(e.charAt(t))){e=e.substring(0,t+1);break}return e}),String.prototype.includes||(String.prototype.includes=function(e){return-1!==this.indexOf(e)}),String.prototype.format||(String.prototype.format=function(){for(var e=this,t=0,r=arguments.length;t<r;t++)var n=new RegExp("{"+t.toString()+"+?}","g"),e=e.replace(n,arguments[t]);return e}),"node"===globalRoot.devicePlatform||(Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest)||(Element.prototype.closest=function(e){var t=this;do{if(t.matches(e))return t}while(null!==(t=t.parentElement||t.parentNode)&&1===t.nodeType);return null}),s.extend({interval:Object.freeze({year:31536e6,week:6048e5,day:864e5,hour:36e5,minute:6e4,second:1e3}),now(){return new Date},clone(e){if(e instanceof Date)return new Date(e.getTime());if(C.isString(e))try{return new Date(e)}catch{}return null},isBetween(e,t,r){return e instanceof Date&&t instanceof Date&&r instanceof Date&&(e=e.getTime())>=t.getTime()&&e<=r.getTime()},equals(e,t){return e instanceof Date&&t instanceof Date&&e.getTime()===t.getTime()},equalDay(e,t){return e instanceof Date&&t instanceof Date&&e.toDateString()===t.toDateString()},isToday(e){return e instanceof Date&&this.equalDay(e,new Date)},toString(e,t,r={}){let n=e;if(C.isString(e)&&this.isDate(e)&&(n=new Date(e)),!C.isDate(n)||isNaN(n))return"";var i=n.getFullYear(),o=n.getMonth()+1,s=n.getDate(),a=n.getHours(),l=n.getMinutes(),c=n.getSeconds(),u=n.getMilliseconds(),d=["일","월","화","수","목","금","토"][n.getDay()],h=(e,t=2)=>String(e).padStart(t,"0");switch(t){case"d":return`${i}-${h(o)}-`+h(s);case"t":return`${h(a)}:${h(l)}:`+h(c);case"a":return`${i}-${h(o)}-${h(s)} ${h(a)}:${h(l)}:`+h(c);case"i":return`${i}-${h(o)}-${h(s)}T${h(a)}:${h(l)}:${h(c)}.${h(u,3)} Z`;case"f":return""+i+h(o)+h(s)+h(a)+h(l)+h(c)+h(u,3);case"s":return""+h(a)+h(l)+h(c)+h(u,3);case"n":return`${i}년 ${h(o)}월 ${h(s)}일 (${d})`;case"nt":return`${i}년 ${h(o)}월 ${h(s)}일 (${d}), ${h(a)}:${h(l)}:`+h(c);case"mdn":return`${h(o)}월 ${h(s)}일`;case"w":var p={weekStartSunday:!0,...r},f=n.getFullYear(),g=n.getMonth()+1,m=this.weekOfMonth(f,g,p.weekStartSunday),y=parseInt(""+f+h(g)+h(s),10);for(let e=0;e<m.length;e++){var v=m[e],b=parseInt(v.weekStartDate.replace(/-/g,""),10),v=parseInt(v.weekEndDate.replace(/-/g,""),10);if(b<=y&&y<=v)return e+1}return 1;case"wn":return d;case"m":return h(o);case"y":return String(i);case"ym":return i+"-"+h(o);default:const w={yyyy:e.getFullYear(),MM:("0"+(e.getMonth()+1)).slice(-2),dd:("0"+e.getDate()).slice(-2),HH:("0"+e.getHours()).slice(-2),mm:("0"+e.getMinutes()).slice(-2),ss:("0"+e.getSeconds()).slice(-2)};return t.replace(/yyyy|MM|dd|HH|mm|ss/gi,e=>w[e]||"")}},addSecond(e,t){return e instanceof Date&&!isNaN(t)?new Date(e.getTime()+t*this.interval.second):null},addMinute(e,t){return e instanceof Date&&!isNaN(t)?new Date(e.getTime()+t*this.interval.minute):null},addHour(e,t){return e instanceof Date&&!isNaN(t)?new Date(e.getTime()+t*this.interval.hour):null},addDay(e,t){var r;return e instanceof Date&&!isNaN(t)?((r=new Date(e.getTime())).setDate(e.getDate()+t),r):null},addWeek(e,t){return this.addDay(e,7*t)},addMonth(e,t){var r;return e instanceof Date&&!isNaN(t)?(r=new Date(e.getTime()),e=e.getMonth()+t,r.setMonth(e),r.getMonth()!==(e%12+12)%12&&r.setDate(0),r):null},addYear(e,t){var r;return e instanceof Date&&!isNaN(t)?((r=new Date(e.getTime())).setFullYear(e.getFullYear()+t),1===e.getMonth()&&29===e.getDate()&&29!==r.getDate()&&r.setDate(0),r):null},getFirstDate(e){return e instanceof Date?new Date(e.getFullYear(),e.getMonth(),1):null},getLastDate(e){return e instanceof Date?new Date(e.getFullYear(),e.getMonth()+1,0):null},diff(e,t,r="day"){return e instanceof Date&&t instanceof Date?"month"===r?12*(t.getFullYear()-e.getFullYear())+(t.getMonth()-e.getMonth()):this.interval[r]?(t=t.getTime()-e.getTime(),Math.floor(t/this.interval[r])):0:0},toTicks(e){return e instanceof Date?1e4*e.getTime()+621355968e9:0},isDate(e){if(e instanceof Date&&!isNaN(e))return!0;if(C.isString(e)){var t=new Date(e);if(!isNaN(t))return!0;if(/^\d{4}-\d{2}-\d{2}$/.test(e)){t=e.split("-");if(1<=t[1]&&t[1]<=12&&1<=t[2]&&t[2]<=31)return e=new Date(t[0],t[1]-1,t[2]),!isNaN(e)}}return!1},isISOString(e){return C.isString(e)&&$validation.regexs.isoDate.test(e)},weekOfMonth(e,t,r=!0){var n=[],i="boolean"==typeof r?r:"true"===r,r=t||(new Date).getMonth()+1,o=i?7:8,t=new Date(e,r-1),s=new Date(t.getFullYear(),t.getMonth(),1),a=new Date(t.getFullYear(),t.getMonth()+1,0),l=(e,t)=>String(e).padStart(t,"0");let c=!0;var u=s.getDay();for(let e=1;e<=6&&a.getMonth()===s.getMonth();e++){var d={};s.getDay()<=1&&(0!==s.getDay()||i||s.setDate(s.getDate()+1),d.weekStartDate=`${s.getFullYear()}-${l(s.getMonth()+1,2)}-`+l(s.getDate(),2)),u<o?c?((o-s.getDay()==1||1<o-s.getDay())&&s.setDate(s.getDate()+(o-s.getDay())-1),c=!1):s.setDate(s.getDate()+6):s.setDate(s.getDate()+(6-s.getDay())+o),d.weekStartDate&&(d.weekEndDate=`${s.getFullYear()}-${l(s.getMonth()+1,2)}-`+l(s.getDate(),2),n.push(d)),s.setDate(s.getDate()+1)}return n},timeAgo(e){let t;if(C.isString(e)&&this.isDate(e))t=new Date(e);else{if(!(e instanceof Date))return"";t=e}var r=Math.floor((new Date-t)/1e3);if(r<0)return"in the future";for(const i of[{label:"년",seconds:31536e3},{label:"달",seconds:2592e3},{label:"주",seconds:604800},{label:"일",seconds:86400},{label:"시간",seconds:3600},{label:"분",seconds:60},{label:"초",seconds:1}]){var n=Math.floor(r/i.seconds);if(1<=n)return""+n+i.label+" 전"}return"방금 전"}}),e.$date=s,o.extend({toValue(e,t=""){return null==e?String(t):String(e)},br(e){return String(e).replace(/(\r\n|\r|\n)/g,"<br />")},interpolate(t,e,r={}){if(null==e||"string"!=typeof t)return t;const{defaultValue:n=null,separator:i="\n"}=r,o=(e,r)=>e.replace(/#\{([^{}]*)\}/g,(e,t)=>{t=r[t];return null!=t?Array.isArray(t)?t.join(", "):t instanceof Date?s.toString(t,"a"):String(t):null!==n?n:e});return Array.isArray(e)?e.map(e=>o(t,e)).join(i):"object"==typeof e?o(t,e):t},isNullOrEmpty(e){return null==e||""===String(e).trim()},sanitizeHTML(e,t=!1){if("string"!=typeof e)return"";let r=e.replace(/<[^>]*>/g,"").replace(/&nbsp;|&#160;/gi," ");return(r=t?r.replace(/[.,;:'"!?%#$*_+=\-\\/()[\]{}<>~`“”’]/g,""):r).trim()},cleanHTML(e){if("string"!=typeof e||"node"===globalRoot.devicePlatform)return e;try{var t=document.createElement("div");return t.innerHTML=e.replace(/<br\s*\/?>/gi,"\n"),(t.textContent||t.innerText||"").replace(/\s{2,}/g," ")}catch{return e}},toHtmlChar(e,t="&'<>!\"#%()*+,./;=@[]^`{|}~"){if("string"!=typeof e)return"";const r={"&":"&amp;","'":"&#39;","<":"&lt;",">":"&gt;",'"':"&quot;","!":"&#33;","#":"&#35;","%":"&#37;","(":"&#40;",")":"&#41;","*":"&#42;","+":"&#43;",",":"&#44;",".":"&#46;","/":"&#47;",";":"&#59;","=":"&#61;","@":"&#64;","[":"&#91;","\\":"&#92;","]":"&#93;","^":"&#94;","`":"&#96;","{":"&#123;","|":"&#124;","}":"&#125;","~":"&#126;"};t=t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),t=new RegExp(`[${t}]`,"g");return e.replace(t,e=>r[e]||e)},toCharHtml(e,t="&(amp|#39|lt|gt|quot|#33|#35|#37|#40|#41|#42|#43|#44|#46|#47|#59|#61|#64|#91|#92|#93|#94|#96|#123|#124|#125|#126);"){if("string"!=typeof e)return"";const r={"&amp;":"&","&#39;":"'","&lt;":"<","&gt;":">","&quot;":'"',"&#33;":"!","&#35;":"#","&#37;":"%","&#40;":"(","&#41;":")","&#42;":"*","&#43;":"+","&#44;":",","&#46;":".","&#47;":"/","&#59;":";","&#61;":"=","&#64;":"@","&#91;":"[","&#92;":"\\","&#93;":"]","&#94;":"^","&#96;":"`","&#123;":"{","&#124;":"|","&#125;":"}","&#126;":"~"};t=new RegExp(t,"g");return e.replace(t,e=>r[e]||e)},length(t){if("string"!=typeof t)return 0;let r=0;for(let e=0;e<t.length;e++){var n=t.charCodeAt(e);r+=n<=127?1:n<=2047?2:n<=65535?3:4}return r},split(e,t=","){return"string"==typeof e?e.split(t).filter(e=>""!==e.trim()):[]},isNumber(e){return null!=e&&""!==String(e).trim()&&(e=String(e).trim(),!!/^-?(\d+|\d{1,3}(,\d{3})*)(\.\d+)?$/.test(e))&&(e=e.replace(/,/g,""),!isNaN(parseFloat(e)))},toNumber(e){var t=0;try{t=parseFloat(0===(1==C.isNullOrUndefined(e)?0:e)||""===e?"0":e.toString().replace(/,/g,""))}catch(e){syn.$l.eventLog("$string.toNumber",e,"Warning")}return t},capitalize(e){return"string"==typeof e?e.replace(/\b([a-z])/g,e=>e.toUpperCase()):""},toJson(e,t={}){if("string"!=typeof e)return[];var{delimiter:r=",",newline:t="\n",meta:n={}}=t,i=e.split(t);if(i.length<1)return[];var o=i[0].split(r).map(e=>e.trim().replace(/^"|"$/g,"")),s=o.length,a=[];for(let e=1;e<i.length;e++){var l=i[e];if(l.trim()){var c=l.split(r),u={};for(let e=0;e<s;e++){var d=o[e],h=c[e]?.trim()??"";u[d]=n[d]?this.toParseType(h,n[d]):this.toDynamic(h)}a.push(u)}}return a},toParameterObject(e){return(e.match(/([^?:;]+)(:([^;]*))/g)||[]).reduce(function(e,t){return e[t.slice(0,t.indexOf(":")).replace("@","")]=t.slice(t.indexOf(":")+1),e},{})},toUrlObject(e){return((e=e||"").match(/([^?=&]+)(=([^&]*))/g)||[]).reduce(function(e,t){return e[t.slice(0,t.indexOf("="))]=t.slice(t.indexOf("=")+1),e},{})},toBoolean(e){return 1!=C.isNullOrUndefined(e)&&(e=e.toString().toLowerCase(),["true","y","1","ok","yes","on"].includes(e))},toDynamic(e,t=!1){var r=String(e).trim();if(t&&""===r)return null;if(""===r)return"";if(/^(true|y|1)$/i.test(r))return!0;if(/^(false|n|0)$/i.test(r))return!1;t=r.replace(/,/g,"");if($validation.regexs.float.test(t)){t=parseFloat(t);if(!isNaN(t))return t}if($validation.regexs.isoDate.test(r)){t=new Date(r);if(!isNaN(t))return t}return e},toParseType(e,t="string",r=!1){var n=String(e).trim();if(r&&""===n)return null;switch(String(t).toLowerCase()){case"string":return n;case"bool":case"boolean":return this.toBoolean(n);case"number":case"numeric":case"int":var i=n.replace(/,/g,"");return $validation.regexs.float.test(i)?(i=parseFloat(i),isNaN(i)?r?null:0:i):r?null:0;case"date":case"datetime":return $validation.regexs.isoDate.test(n)?(i=new Date(n),isNaN(i)?null:i):!s.isDate(n)||(i=new Date(n),isNaN(i))?null:i;default:return n}},toNumberString(e){return"string"==typeof e?e.trim().replace(/[^\d.-]/g,""):""},toCurrency(e,t,r={}){e=this.toNumber(e);if(isNaN(e))return null;if(t&&"undefined"!=typeof Intl&&Intl.NumberFormat){r={style:"currency",currency:"KRW",...r};try{return new Intl.NumberFormat(t,r).format(e)}catch(e){syn.$l.eventLog("$string.toCurrency",`Intl formatting error for locale ${t}: `+e,"Warning")}}var[r,t]=String(e).split("."),e=r.replace(/\B(?=(\d{3})+(?!\d))/g,",");return t?e+"."+t:e},pad(e,t,r="0",n=!0){e=String(e),t=Math.max(0,t-e.length),r=String(r).repeat(t);return o.toBoolean(n)?r+e:e+r}}),e.$string=o,t.extend({distinct(e){return Array.isArray(e)?[...new Set(e)]:[]},sort(e,r=!0){return Array.isArray(e)?[...e].sort((e,t)=>e<t?r?-1:1:t<e?r?1:-1:0):[]},objectSort(e,r,n=!0){return Array.isArray(e)&&r?[...e].sort((e,t)=>{e=e[r],t=t[r];return e<t?n?-1:1:t<e?n?1:-1:0}):[]},groupBy(e,t){if(!Array.isArray(e))return{};const n="function"==typeof t?t:e=>e[t];return e.reduce((e,t)=>{var r=n(t);return(e[r]=e[r]||[]).push(t),e},{})},shuffle(e){if(!Array.isArray(e))return[];var t=[...e];for(let e=t.length-1;0<e;e--){var r=Math.floor(Math.random()*(e+1));[t[e],t[r]]=[t[r],t[e]]}return t},addAt(e,t,r){return Array.isArray(e)?(e=[...e],t=Math.max(0,Math.min(t,e.length)),e.splice(t,0,r),e):[]},removeAt(e,t){return Array.isArray(e)?(e=[...e],0<=t&&t<e.length&&e.splice(t,1),e):[]},contains(e,t){return Array.isArray(e)&&e.includes(t)},merge(e,t,r=(e,t)=>e===t){if(!Array.isArray(e)||!Array.isArray(t))return e||[];const n=[...e];return t.forEach(t=>{n.some(e=>r(t,e))||n.push(t)}),n},union(e,t){return Array.isArray(e)&&Array.isArray(t)?[...new Set([...e,...t])]:[]},difference(e,t){if(!Array.isArray(e)||!Array.isArray(t))return[];const r=new Set(t);return e.filter(e=>!r.has(e))},intersect(e,t){if(!Array.isArray(e)||!Array.isArray(t))return[];const r=new Set(t);return e.filter(e=>r.has(e))},symmetryDifference(e,t){if(!Array.isArray(e)||!Array.isArray(t))return[];const r=new Set(e),n=new Set(t);e=e.filter(e=>!n.has(e)),t=t.filter(e=>!r.has(e));return[...e,...t]},getValue(e,t,r,n,i){var o,s=null;return s=null==(s=e&&0<e.length&&(o=null,o=n?e.find(function(e){return e[n]==t}):e.find(function(e){return e.ParameterName==t||e.parameterName==t}))?i?o[i]:o.Value||o.value:s)?void 0===r?"":r:s},ranks(e,r=!1){if(!Array.isArray(e))return[];var t=e.map((e,t)=>({value:o.toNumber(e),index:t})),n=(t.sort((e,t)=>r?e.value-t.value:t.value-e.value),new Array(e.length));let i=1;for(let e=0;e<t.length;e++)0<e&&t[e].value!==t[e-1].value&&(i=e+1),n[t[e].index]=i;return n},split(e,t=","){return"string"!=typeof e?[]:e.split(t).map(e=>e.trim()).filter(e=>0<e.length)}}),e.$array=t,r.extend({duration(e){var t,r,n,i;return"number"!=typeof e||isNaN(e)?{}:(e=Math.abs(e),t=Math.floor(e/1e3),r=Math.floor(t/60),n=Math.floor(r/60),i=Math.floor(n/24),{year:Math.floor(i/365),week:Math.floor(i%365/7),day:i,hour:n%24,minute:r%60,second:t%60,millisecond:e%1e3})},toByteString(e,t=3,r=!0){var n,i,o;return"number"!=typeof e||isNaN(e)?`0${r?" ":""}B`:(n=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],(o=Math.abs(e))<1?e+(r?" ":"")+n[0]:(i=Math.min(Math.floor(Math.log(o)/Math.log(1024)),n.length-1),o=o/Math.pow(1024,i),(e<0?"-":"")+Number(o.toPrecision(t))+(r?" ":"")+n[i]))},random(e=0,t=10){var r=Math.ceil(Math.min(e,t)),e=Math.floor(Math.max(e,t));return Math.floor(Math.random()*(e-r+1))+r},isRange(e,t,r){return"number"==typeof e&&t<=e&&e<=r},limit(e,t,r){return"number"==typeof e?Math.max(t,Math.min(e,r)):t},percent(e,t,r=0){return"number"!=typeof e||"number"!=typeof t||0===t?0:(r=Math.pow(10,r),Math.round(100*e/t*r)/r)}}),e.$number=r,C.extend({isNullOrUndefined(e){return null==e},toCSV(e,t={}){if("object"!=typeof e||null===e)return null;const{scopechar:s="/",delimiter:n=",",newline:i="\n"}=t;t=Array.isArray(e)?e:[e];if(0===t.length)return"";const a=[],l=new Set,o=(t.forEach(e=>{var t,r={};const n=[[e,""]];for(;0<n.length;){const[i,o]=n.pop();null===i||"object"!=typeof i||Array.isArray(i)||i instanceof Date?(t=o||"value",l.add(t),r[t]=Array.isArray(i)||i instanceof Date?JSON.stringify(i):i??""):Object.entries(i).forEach(([e,t])=>{n.push([t,o?""+o+s+e:e])})}a.push(r)}),Array.from(l).sort());return[o.join(n),...a.map(r=>o.map(e=>{let t=String(r[e]??"");return t=t.includes(n)||t.includes(i)||t.includes('"')?`"${t.replace(/"/g,'""')}"`:t}).join(n))].join(i)},toParameterString(e){return e&&"object"==typeof e?Object.entries(e).map(([e,t])=>`@${e}:`+o.toValue(o.toDynamic(t),"")).join(";"):""},getType(e){var t=typeof e;return"object"==t?null===e?"null":Array.isArray(e)?"array":e instanceof Date?"date":"node"!==globalRoot.devicePlatform&&e instanceof HTMLElement?"element":"object":t},defaultValue(e){switch(String(e).toLowerCase()){case"boolean":return!1;case"function":return()=>{};case"null":return null;case"number":case"numeric":case"int":return 0;case"object":return{};case"date":case"datetime":return new Date;case"string":return"";case"symbol":return Symbol();case"undefined":return;case"array":return[];default:return""}},isDefined(e){return void 0!==e},isNull(e){return null===e},isArray(e){return Array.isArray(e)},isDate(e){return e instanceof Date&&!isNaN(e.getTime())},isString(e){return"string"==typeof e},isNumber(e){return"number"==typeof e&&!isNaN(e)},isFunction(e){return"function"==typeof e},isObject(e){return"object"==typeof e&&null!==e},isObjectEmpty(e){return"object"==typeof e&&null!==e&&0===Object.keys(e).length&&e.constructor===Object},isBoolean(e){return"boolean"==typeof e||null!=e&&(e=String(e).toUpperCase(),["TRUE","FALSE","Y","N","1","0"].includes(e))},isEmpty(e){return null==e||!("number"!=typeof e||!isNaN(e))||"string"==typeof e&&""===e.trim()||!(!Array.isArray(e)||0!==e.length)||!("object"!=typeof e||e instanceof Date||0!==Object.keys(e).length||e.constructor!==Object)},clone(t,e=!0){if("object"!=typeof t||null===t)return t;if(t instanceof Date)return new Date(t.getTime());if(Array.isArray(t))return e?t.map(e=>this.clone(e,!0)):[...t];if(t instanceof HTMLElement&&"function"==typeof t.cloneNode)return t.cloneNode(e);if("object"!=typeof t)return t;{const r=Object.create(Object.getPrototypeOf(t));return e?Object.keys(t).forEach(e=>{r[e]=this.clone(t[e],!0)}):Object.assign(r,t),r}},extend(i,e,o=!0){return e&&"object"==typeof e&&Object.entries(e).forEach(([e,t])=>{var r=i[e],n=Object.prototype.hasOwnProperty.call(i,e);!this.isObject(t)||null===t||this.isDate(t)||Array.isArray(t)||t instanceof HTMLElement?!o&&n||(i[e]=this.clone(t,!1)):(n&&this.isObject(r)||(i[e]={}),this.extend(i[e],t,o))}),i},excludeKeys(e,t){return Object.fromEntries(Object.entries(e).filter(([e])=>!t.includes(e)))}}),e.$object=C}(globalRoot),!function(l){"use strict";const t=l.$library||new syn.module;let c=null;"node"!==globalRoot.devicePlatform&&(c=l.document,"function"!=typeof l.CustomEvent)&&((e=function(e,t={}){var r=c.createEvent("CustomEvent"),{bubbles:t=!1,cancelable:n=!1,detail:i=void 0}=t;return r.initCustomEvent(e,t,n,i),r}).prototype=l.Event.prototype,l.CustomEvent=e);var e=(()=>{const o=[];return Object.freeze({add(t,r,n,e={}){return!(!t||!r||"function"!=typeof n||o.some(e=>e.el===t&&e.type===r&&e.handler===n)||(o.push({el:t,type:r,handler:n,options:e}),0))},remove(t,r,n){var e=o.length;for(let e=o.length-1;0<=e;e--){var i=o[e];i.el===t&&i.type===r&&i.handler===n&&o.splice(e,1)}return o.length<e},removeAllForElement(t){for(let e=o.length-1;0<=e;e--)o[e].el===t&&o.splice(e,1)},findByArgs(t,r,n){return o.filter(e=>e.el===t&&e.type===r&&e.handler===n)},findAllByArgs(t,r){return o.filter(e=>e.el===t&&e.type===r)},getAll(){return[...o]},flush(){this.getAll().forEach(({el:e,type:t,handler:r,options:n={}})=>{e.removeEventListener&&e.removeEventListener(t,r,n)}),o.length=0}})})();t.extend({prefixs:Object.freeze(["webkit","moz","ms","o",""]),eventMap:Object.freeze({mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"}),events:e,concreate(){"node"!==globalRoot.devicePlatform&&c.addEventListener("DOMContentLoaded",()=>{this.addEvent(l,"unload",()=>this.events.flush())},{once:!0})},guid(){var e;return l.crypto?.randomUUID?l.crypto.randomUUID():"undefined"!=typeof crypto&&crypto.getRandomValues?(e=new Uint8Array(16),crypto.getRandomValues(e),e[6]=15&e[6]|64,e[8]=63&e[8]|128,`${(e=Array.from(e,e=>e.toString(16).padStart(2,"0"))).slice(0,4).join("")}-${e.slice(4,6).join("")}-${e.slice(6,8).join("")}-${e.slice(8,10).join("")}-`+e.slice(10,16).join("")):"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},getElement(e){let t=null;var r;return 1==$object.isString(e)?(r=this.get(e),t=r||this.querySelector(e)):e&&(e instanceof HTMLElement||e instanceof Element||e&&1===e.nodeType||e===window||e&&e.constructor&&"Window"===e.constructor.name||e===document||e instanceof Document||e instanceof DocumentFragment||e instanceof EventTarget||"function"==typeof e.addEventListener)&&(t=e),t},stringToArrayBuffer(e){return encoder.encode(e).buffer},arrayBufferToString(e){if(!(e instanceof ArrayBuffer))return"";try{return decoder.decode(e)}catch(e){return syn.$l.eventLog("$c.base64Encode","ArrayBuffer 에서 문자열 변환 실패: "+e,"Error"),""}},random(t=8,e=!1){let r="";var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";if(l.crypto?.getRandomValues){var i=new Uint32Array(t);l.crypto.getRandomValues(i);for(let e=0;e<t;e++)r+=n[i[e]%n.length]}else for(let e=0;e<t;e++)r+=n.charAt(Math.floor(Math.random()*n.length));return e?r.toLowerCase():r.toUpperCase()},execPrefixFunc(t,r){if(t&&r)for(const n of this.prefixs){let e=r;if(void 0!==t[e=n?n+r.charAt(0).toUpperCase()+r.slice(1):r.charAt(0).toLowerCase()+r.slice(1)])return"function"==typeof t[e]?t[e]():t[e]}},dispatchClick(e,t={}){if((e=this.getElement(e))&&"node"!==globalRoot.devicePlatform&&c?.createEvent)try{var r={bubbles:!0,cancelable:!0,view:l,detail:1,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:null,...t},n=new MouseEvent("click",r);e.dispatchEvent(n)}catch(e){syn.$l.eventLog("$l.dispatchClick","클릭 디스패치 오류: "+e,"Warning")}},addEvent(e,t,r,n={}){return(e=this.getElement(e))&&"function"==typeof r&&(n={capture:!1,once:!1,passive:!1,...n},this.events.add(e,t,r,n)&&e.addEventListener(t,r,n),$object.isString(t))&&"resize"===t.toLowerCase()&&r(),this},addEvents(e,r,n,i={}){if("function"==typeof n){let t=[];$object.isString(e)?t=this.querySelectorAll(e):Array.isArray(e)?(e.forEach(e=>{$object.isString(e)?t=t.concat(this.querySelectorAll(e)):$object.isObject(e)&&t.push(e)}),t=[...new Set(t)]):$object.isObject(e)&&(t=[e]),t.forEach(e=>this.addEvent(e,r,n,i))}return this},addLive(r,e,n,t={}){return"node"!==globalRoot.devicePlatform&&this.addEvent(c,e,e=>{var t=e.target.closest(r);t&&(n.call(t,e),e.preventDefault(),e.stopPropagation())},t),this},removeEvent(e,t,r,n={}){return(e=this.getElement(e))&&"function"==typeof r&&(n={capture:!1,once:!1,passive:!1,...n},this.events.remove(e,t,r))&&e.removeEventListener(t,r,n),this},hasEvent(e,t,r){return!!(e=this.getElement(e))&&("function"==typeof r?0<this.events.findByArgs(e,t,r).length:0<this.events.findAllByArgs(e,t).length)},trigger(t,r,n){if(!(t=this.getElement(t)))return!1;let i=!1;return this.events.findAllByArgs(t,r).forEach(({handler:e})=>{try{e.call(t,n),i=!0}catch(e){syn.$l.eventLog("$l.trigger",`"${r}" 이벤트 핸들러 실행 오류: `+e,"Warning")}}),i},triggerEvent(t,r,n){if((t=this.getElement(t))&&"node"!==globalRoot.devicePlatform)try{let e;"function"==typeof l.CustomEvent?e=new CustomEvent(r,{detail:n,bubbles:!0,cancelable:!0}):c.createEvent&&(e=c.createEvent("HTMLEvents")).initEvent(r,!0,!0),e&&t.dispatchEvent(e)}catch(e){syn.$l.eventLog("$l.triggerEvent",`"${r}" 이벤트 디스패치 오류: `+e,"Warning")}return this},getValue(t,e=""){if($this?.context?.synControls){var r=$this.context.synControls.find(e=>e.id===t||e.id===t+"_hidden");if(r?.module){var n=$webform.getControlModule(r.module);if(n?.getValue)try{return n.getValue(r.id.replace("_hidden",""),r)??e}catch(e){syn.$l.eventLog("$l.getValue",`"${t}" 값 가져오기 오류: `+e,"Warning")}}else if(c){n=this.get(t);if(n)return n.value??e}}return e},get(...e){var t;return"node"!==globalRoot.devicePlatform&&c?(t=e.map(e=>$object.isString(e)?c.getElementById(e):null).filter(e=>null!==e),1===e.length?t[0]||null:t):1===e.length?null:[]},querySelector(...e){if("node"===globalRoot.devicePlatform||!c)return 1===e.length?null:[];const n=[];return e.forEach(t=>{if($object.isString(t))try{if(t.startsWith("//")||t.startsWith(".//")){var r=c.evaluate(t,c,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);for(let e=0;e<r.snapshotLength;e++)n.push(r.snapshotItem(e))}else{var e=c.querySelector(t);e&&n.push(e)}}catch(e){syn.$l.eventLog("$l.querySelector",`잘못된 셀렉터 "${t}": `+e,"Warning")}}),1===e.length?n[0]||null:n},getTagName(...e){if("node"===globalRoot.devicePlatform||!c)return[];let t=[];return e.forEach(e=>{$object.isString(e)&&(t=t.concat(Array.from(c.getElementsByTagName(e))))}),t},querySelectorAll(...e){if("node"===globalRoot.devicePlatform||!c)return[];let n=[];return e.forEach(t=>{if($object.isString(t))try{if(t.startsWith("//")||t.startsWith(".//")){var r=c.evaluate(t,c,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);for(let e=0;e<r.snapshotLength;e++)n.push(r.snapshotItem(e))}else n=n.concat(Array.from(c.querySelectorAll(t)))}catch(e){syn.$l.eventLog("$l.querySelectorAll",`잘못된 셀렉터 "${t}": `+e,"Warning")}}),n},toEnumValue(e,t){return $object.isObject(e)&&(e=Object.entries(e).find(([e])=>e===t))?e[1]:null},toEnumText(e,t){return $object.isObject(e)&&(e=Object.entries(e).find(([,e])=>e===t))?e[0]:null},prettyTSD(t,r=!1){if("string"!=typeof t)return t;try{var n=t.split("＾");let e;var i={delimiter:"｜",newline:"↵"};return e=1<n.length?(i.meta=$string.toParameterObject(n[0]),$string.toJson(n[1],i)):$string.toJson(n[0],i),$string.toBoolean(r)?JSON.stringify(e,null,2):e}catch(e){return syn.$l.eventLog("$l.prettyTSD","TSD 파싱 오류: "+e,"Error"),"TSD 파싱 오류: "+e.message}},text2Json(e,t=",",r="\n"){if("string"!=typeof e)return[];e=e.trim().split(r);if(e.length<2)return[];const i=e[0].split(t).map(e=>e.trim());return e.slice(1).map(e=>{const n=e.split(t);return i.reduce((e,t,r)=>(e[t]=n[r]?.trim()??"",e),{})}).filter(e=>0<Object.keys(e).length)},json2Text(e,t,n=",",i="\n"){return Array.isArray(e)&&Array.isArray(t)?[t.join(n),...e.map(r=>t.map(e=>{let t=r[e]??"";return t=(t=String(t)).includes(n)||t.includes(i)||t.includes('"')?`"${t.replace(/"/g,'""')}"`:t}).join(n))].join(i):""},nested2Flat(e,t,r,n="items"){var i,o=[];return e?(1==$object.isNullOrUndefined(n)&&(n="items"),delete(i=$object.clone(e,!1))[n],i[r]=null,o.push(i),syn.$l.parseNested2Flat(e,o,t,r,n)):syn.$l.eventLog("$l.nested2Flat","필수 데이터 확인 필요","Warning"),o},parseNested2Flat(e,t,r,n,i="items"){var o=e[i=1==$object.isNullOrUndefined(i)?"items":i];if(e&&o)for(var s=0;s<o.length;s++){var a=o[s],l=$object.clone(a,!1);delete l[i],l[n]=e[r],t.push(l),a[i]&&0<a[i].length&&syn.$l.parseNested2Flat(a,t,r,n,i)}return null},flat2Nested(e,t,r,n="items"){var i,o=null;return e&&t&&r?(i=e.find(function(e){return null==e[r]}),e=syn.$l.parseFlat2Nested(e,i,[],t,r,n),i[n]=e[n],o=i):syn.$l.eventLog("$l.flat2Nested","필수 데이터 확인 필요","Warning"),o},parseFlat2Nested(e,t,r,n,i,o="items"){var s=e.filter(function(e){return e[i]==t[n]});if(0<s.length){r[o]||(r[o]=[]);for(var a=0;a<s.length;a++)r[o].push($object.clone(s[a])),syn.$l.parseFlat2Nested(e,s[a],r[o][a],n,i,o)}return r},findNestedByID(e,t,r,n="items"){if(e&&r)for(const o of Array.isArray(e)?e:[e]){if(o[r]==t)return o;if(Array.isArray(o[n])){var i=this.findNestedByID(o[n],t,r,n);if(i)return i}}return null},deepFreeze(t){return!t||"object"!=typeof t||Object.isFrozen(t)?t:(Object.getOwnPropertyNames(t).forEach(e=>{e=t[e];"object"==typeof e&&null!==e&&this.deepFreeze(e)}),Object.freeze(t))},createBlob(e,t){try{return new Blob([e],{type:t})}catch{try{var r,n=l.BlobBuilder||l.WebKitBlobBuilder||l.MozBlobBuilder||l.MSBlobBuilder;if(n)return(r=new n).append(e.buffer||e),r.getBlob(t);throw new Error("BlobBuilder가 지원되지 않습니다.")}catch(e){return syn.$l.eventLog("$l.createBlob","Blob 생성 실패: "+e,"Error"),null}}},dataUriToBlob(e){if(!e||"string"!=typeof e||!e.startsWith("data:"))return null;try{var t=e.split(","),r=t[0].split(":")[1].split(";"),n=r[0],i=(r.includes("base64")?atob:decodeURIComponent)(t[1]),o=new Array(i.length);for(let e=0;e<i.length;e++)o[e]=i.charCodeAt(e);var s=new Uint8Array(o);return new Blob([s],{type:n})}catch(e){return syn.$l.eventLog("$l.dataUriToBlob","Data URI -> Blob 변환 오류: "+e,"Warning"),null}},dataUriToText(e){if(!e||"string"!=typeof e||!e.startsWith("data:"))return null;try{var t=e.split(","),r=t[0].split(":")[1].split(";"),n=r[0];return{value:r.includes("base64")?$cryptography.base64Decode(t[1]):decodeURIComponent(t[1]),mime:n}}catch(e){return syn.$l.eventLog("$l.dataUriToText","Data URI -> Text 변환 오류: "+e,"Warning"),null}},blobToDataUri(e,t){if(e instanceof Blob&&"function"==typeof t){const r=new FileReader;r.onloadend=()=>{r.error?syn.$l.eventLog("$l.blobToDataUri","FileReader 오류: "+r.error,"Error"):t(r.result)},r.onerror=()=>{var e=r.error||new Error("알 수 없는 FileReader 오류");syn.$l.eventLog("$l.blobToDataUri","FileReader 오류: "+e,"Error")},r.readAsDataURL(e)}else syn.$l.eventLog("$l.blobToDataUri","잘못된 Blob 또는 콜백 함수가 제공되었습니다.","Warning"),t&&t(new Error("잘못된 입력값"),null)},blobToDownload(e,r){if("node"!==globalRoot.devicePlatform)if(e instanceof Blob&&r)if(l.navigator&&l.navigator.msSaveOrOpenBlob)try{l.navigator.msSaveOrOpenBlob(e,r)}catch(e){syn.$l.eventLog("$l.blobToDownload","msSaveOrOpenBlob 실패: "+e,"Error")}else{let t=null;try{t=URL.createObjectURL(e);var n=c.createElement("a");n.href=t,n.download=r,c.body.appendChild(n),n.click(),c.body.removeChild(n),setTimeout(()=>URL.revokeObjectURL(t),100)}catch(e){syn.$l.eventLog("$l.blobToDownload","다운로드 실패: "+e,"Error"),t&&URL.revokeObjectURL(t)}}else syn.$l.eventLog("$l.blobToDownload","잘못된 Blob 또는 파일 이름이 제공되었습니다.","Warning")},blobUrlToBlob(t,r){"function"!=typeof r?syn.$l.eventLog("$l.blobUrlToBlob","콜백 함수 확인 필요","Warning"):t&&"string"==typeof t?fetch(t).then(e=>{if(e.ok)return e.blob();throw new Error(`HTTP 오류! 상태: ${e.status} `+e.statusText)}).then(e=>r(e)).catch(e=>{syn.$l.eventLog("$l.blobUrlToBlob",`url: ${t}, 오류: `+e,"Warning")}):syn.$l.eventLog("$l.blobUrlToBlob","URL 확인 필요","Warning")},blobUrlToDataUri(e,t){"function"!=typeof t?syn.$l.eventLog("$l.blobUrlToDataUri","콜백 함수 확인 필요","Warning"):e&&"string"==typeof e?this.blobUrlToBlob(e,e=>{e?this.blobToDataUri(e,t):syn.$l.eventLog("$l.blobUrlToDataUri","URL에서 Blob 가져오기 실패","Warning")}):syn.$l.eventLog("$l.blobUrlToDataUri","URL 확인 필요","Warning")},async blobToBase64(e,o=!1){if(!(e instanceof Blob))return null;if("node"!==globalRoot.devicePlatform||"undefined"==typeof Buffer)return"undefined"!=typeof FileReader?new Promise((r,n)=>{const i=new FileReader;i.onloadend=()=>{var e,t;i.error?n(i.error):(e=i.result,o?(t=e.split(";base64,")[1]||null,r(t)):r(e))},i.onerror=e=>n(e),i.readAsDataURL(e)}):null;try{var t=await e.arrayBuffer(),r=Buffer.from(t).toString("base64");return o?r:`data:${e.type||"application/octet-stream"};base64,`+r}catch(e){return syn.$l.eventLog("$l.blobToBase64 (Node)","Blob -> Base64 변환 오류(Node): "+e,"Error"),null}},base64ToBlob(e,t="",r=512){if(!e||"string"!=typeof e)return null;try{var n=atob(e),i=[];for(let e=0;e<n.length;e+=r){var o=n.slice(e,e+r),s=new Array(o.length);for(let e=0;e<o.length;e++)s[e]=o.charCodeAt(e);i.push(new Uint8Array(s))}return new Blob(i,{type:t})}catch(e){return syn.$l.eventLog("$l.base64ToBlob","Base64 디코딩 또는 Blob 생성 실패: "+e,"Error"),null}},async blobToFile(e,t,r){return e instanceof Blob?(r=r||e.type||"application/octet-stream",new File([e],t||"blob-"+$date.toString(new Date,"f"),{type:r})):null},async fileToBase64(n){if("node"!==globalRoot.devicePlatform)return n instanceof File&&"undefined"!=typeof FileReader?new Promise((e,t)=>{const r=new FileReader;r.onloadend=()=>e(r.result),r.onerror=e=>t(e),r.readAsDataURL(n)}):(syn.$l.eventLog("$l.fileToBase64","잘못된 입력 또는 환경입니다.","Warning"),null);var r=require("fs").promises,i=require("path"),o=require("node-fetch");try{let e,t="application/octet-stream";if("string"==typeof n&&(n.startsWith("http:")||n.startsWith("https:"))){var s=await o(n);if(!s.ok)throw new Error("HTTP 오류! 상태: "+s.status);t=s.headers.get("content-type")||t,e=Buffer.from(await s.arrayBuffer())}else{if("string"!=typeof n)throw new Error("Node.js에서 fileToBase64에 잘못된 입력 유형입니다.");var a=n,l=(e=await r.readFile(a),i.extname(a).toLowerCase()),c={".jpg":"image/jpeg",".jpeg":"image/jpeg",".png":"image/png",".gif":"image/gif",".pdf":"application/pdf",".txt":"text/plain",".html":"text/html",".json":"application/json"};t=c[l]||t}var u=e.toString("base64");return`data:${t};base64,`+u}catch(e){return syn.$l.eventLog("$l.fileToBase64 (Node)","파일 -> Base64 변환 오류(Node): "+e,"Error"),null}},async fileToBlob(e){var t,e=await this.fileToBase64(e);return(e=e&&e.match(/^data:(.+?);base64,(.+)$/))?(t=e[1],e=e[2],this.base64ToBlob(e,t)):null},async urlToBase64(e){e=await syn.$r.httpFetch(e).send();return e&&e.error?null:await syn.$l.blobToBase64(e,!0)},async resizeImage(t,e){var r;if(!("node"!==globalRoot.devicePlatform&&t instanceof Blob&&t.type.startsWith("image/")))return r="node"===globalRoot.devicePlatform?"Node.js 환경에서는 이미지 크기 조정을 지원하지 않습니다.":"잘못된 입력: 이미지 Blob이 아닙니다.",syn.$l.eventLog("$l.resizeImage",r,"Warning"),Promise.reject(new Error(r));const l="number"==typeof e&&0<e?e:80;return new Promise((n,i)=>{var e=new FileReader;const o=new Image,s=document.createElement("canvas"),a=s.getContext("2d");o.onload=()=>{let{width:t,height:r}=o;t>r?t>l&&(r=Math.round(r*(l/t)),t=l):r>l&&(t=Math.round(t*(l/r)),r=l),s.width=t,s.height=r,a.drawImage(o,0,0,t,r),s.toBlob(e=>{e?n({blob:e,width:t,height:r}):i(new Error("캔버스 -> Blob 변환 실패."))},"image/jpeg",.9)},o.onerror=()=>i(new Error("이미지 로드 실패")),e.onload=e=>o.src=e.target.result,e.onerror=()=>i(new Error("Blob 읽기 실패")),e.readAsDataURL(t)})},logLevel:Object.freeze({Verbose:0,Debug:1,Information:2,Warning:3,Error:4,Fatal:5}),start:Date.now(),eventLogTimer:null,eventLogCount:0,eventLog(e,t,r="Verbose"){var n=t instanceof Error?t.message:String(t),t=t instanceof Error?t.stack:void 0;let i;i="string"==typeof r&&this.logLevel.hasOwnProperty(r)?this.logLevel[r]:"number"==typeof r?r:this.logLevel.Verbose;r=syn.Config?.UIEventLogLevel||"Verbose",r=this.logLevel[r]??this.logLevel.Verbose;if(!(i<r)){var r=this.toEnumText(this.logLevel,i)||"Unknown",o=((Date.now()-this.start)/1e3).toFixed(3),s=this.eventLogCount+`@${o} [${r}] [${e}]`+" "+(t?n+`
`+t:n);if("node"===globalRoot.devicePlatform&&globalRoot.$logger){o=r.toLowerCase();"function"==typeof globalRoot.$logger[o]?globalRoot.$logger[o](s):globalRoot.$logger.trace(s),l.console&&console.log(s)}else if(l.console){switch(i){case this.logLevel.Error:case this.logLevel.Fatal:console.error(s);break;case this.logLevel.Warning:console.warn(s);break;case this.logLevel.Information:console.info(s);break;case this.logLevel.Debug:console.debug(s);break;default:console.log(s)}if(!0===syn.Config?.IsDebugMode&&"Development"===syn.Config?.Environment&&(i,this.logLevel.Warning),c&&!l.console){e=c.createElement("div");e.textContent=s;const a=c.getElementById("eventlogs");a?(a.appendChild(e),clearTimeout(this.eventLogTimer),this.eventLogTimer=setTimeout(()=>{a.scrollTop=a.scrollHeight},10)):c.body?.appendChild(e)}if(l.bound?.browserEvent)try{l.bound.browserEvent("browser",{ID:"EventLog",Data:s},(e,t)=>{e&&console.log("browserEvent EventLog 콜백 오류: "+e)})}catch(e){console.log("bound.browserEvent 호출 오류: "+e)}}this.eventLogCount++}},getBasePath(e,t){if("node"!==globalRoot.devicePlatform)return e||t||"";var r=require("path"),n=process.cwd();let i="";return i=e?r.isAbsolute(e)?e:r.resolve(n,e):t?r.resolve(n,t):n},moduleEventLog(t,r,n,i="Verbose"){if("node"===globalRoot.devicePlatform&&t){var o="object"==typeof n?n.message:n,n="object"==typeof n?n.stack||JSON.stringify(n):n;let e=0;if(i&&!0===$object.isString(i)&&(e=syn.$l.logLevel[i]),!(syn.Config&&syn.Config.UIEventLogLevel&&syn.$l.logLevel[syn.Config.UIEventLogLevel]>e)){var i=syn.$l.toEnumText(syn.$l.logLevel,e),s=(new Date).getTime()-syn.$l.start,a=syn.$l.eventLogCount.toString()+"@"+(s/1e3).toString().format("0.000")+" ["+r+"] "+(o===n?o:n),s=syn.getModuleLibrary(t);if(s){var l=s.logger;switch(i){case"Debug":l.debug(a);break;case"Information":l.info(a);break;case"Warning":l.warn(a);break;case"Error":l.error(a);break;case"Fatal":l.fatal(a);break;default:l.trace(a)}globalRoot.console&&console.log(i+": "+a)}else console.log("ModuleID 확인 필요 - {0}".format(t));syn.$l.eventLogCount++}}}}),"node"===globalRoot.devicePlatform?["addEvent","addEvents","addLive","removeEvent","hasEvent","trigger","triggerEvent","getValue","get","querySelector","getTagName","querySelectorAll","dispatchClick"].forEach(e=>{delete t[e]}):["getBasePath","moduleEventLog"].forEach(e=>{delete t[e]}),l.$library=syn.$l=t}(globalRoot),!function(e){"use strict";const s=e.$request||new syn.module;let a=null;"node"!==globalRoot.devicePlatform&&(a=e.document),s.extend({params:{},path:"node"===globalRoot.devicePlatform?"":location.pathname,query(e,i){return i=i||location.href,function(){var e=i.split("?"),t=(1==e.length?e[0]:e[1]).split("&");for(let e=0;e<t.length;e++){var r=t[e].indexOf("="),n=t[e].substring(0,r),r=t[e].substring(r+1);syn.$r.params[n]=1==/%[0-9A-Fa-f]{2}/.test(r)?decodeURIComponent(r):r}return syn.$r.params}()[e]},url(){var e=syn.$r.path.split("?");let t="";t=syn.$r.path+(0<syn.$r.path.length&&1<e.length?"&":"?");for(const r in s.params)"string"==typeof syn.$r.params[r]&&(t+=r+"="+syn.$r.params[r]+"&");return syn.Config&&0==$string.toBoolean(syn.Config.IsClientCaching)&&(t+="&noCache="+(new Date).getTime()),encodeURI(t.substring(0,t.length-1))},toQueryString(e,t){let r=e?Object.entries(e).reduce((e,t,r)=>{var n=t[0],t=t[1];return e+=`&${n}=`+$string.toValue(t,"")},""):"";return r=0==$string.isNullOrEmpty(r)&&1==$string.toBoolean(t)?"?"+r.substring(1):r},toUrlObject(e){return((e=e||location.href).match(/([^?=&]+)(=([^&]*))/g)||[]).reduce(function(e,t){return e[t.slice(0,t.indexOf("="))]=t.slice(t.indexOf("=")+1),e},{})},async isCorsEnabled(e){let t=!1;try{var r=await fetch(e,{method:"HEAD",timeout:200});0==(t=200<=r.status&&r.status<=299)&&syn.$l.eventLog("$w.isCorsEnabled","{0}, {1}:{2}".format(e,r.status,r.statusText),"Warning")}catch(e){syn.$l.eventLog("$w.isCorsEnabled",e.message,"Error")}return t},httpFetch(h){return new Proxy({},{get(e,d){return async function(e,t){if(-1==["send"].indexOf(d))return Promise.resolve({error:d+" 메서드 확인 필요"});t=syn.$w.argumentsExtend({method:"GET"},t);let r=null,n=null;if(0==$object.isNullOrUndefined(e)&&0==$object.isString(e)){if(t.method=t.method||"POST",1==$object.isNullOrUndefined(t.headers)&&(t.headers=new Headers,e instanceof FormData||t.headers.append("Content-Type",t.contentType||"application/json")),syn.Environment){var i=syn.Environment;if(i.Header)for(const a in i.Header)0==t.headers.has(a)&&t.headers.append(a,i.Header[a])}0==t.headers.has("OffsetMinutes")&&t.headers.append("OffsetMinutes",syn.$w.timezoneOffsetMinutes);e={method:t.method,headers:t.headers,body:e instanceof FormData?e:JSON.stringify(e),redirect:"follow"};if(0==$object.isNullOrUndefined(t.timeout)){const l=new AbortController;n=setTimeout(()=>l.abort(),t.timeout),e.signal=l.signal}r=await fetch(h,e)}else{if(1==$object.isNullOrUndefined(t.headers)&&(t.headers=new Headers,t.headers.append("Content-Type",t.contentType||"application/json")),syn.Environment){var o=syn.Environment;if(o.Header)for(const c in o.Header)0==t.headers.has(c)&&t.headers.append(c,o.Header[c])}0==t.headers.has("OffsetMinutes")&&t.headers.append("OffsetMinutes",syn.$w.timezoneOffsetMinutes);e={method:t.method,headers:t.headers,redirect:"follow"};if(0==$object.isNullOrUndefined(t.timeout)){const u=new AbortController;n=setTimeout(()=>u.abort(),t.timeout),e.signal=u.signal}r=await fetch(h,e)}n&&clearTimeout(n);let s={error:"요청 정보 확인 필요"};return 1==r.ok?(e=r.headers.get("Content-Type")||"",s=1==e.includes("application/json")?await r.json():1==e.includes("text/")?await r.text():await r.blob()):(s={error:`status: ${r.status}, text: `+await r.text()},syn.$l.eventLog("$r.httpFetch",""+s.error,"Error")),Promise.resolve(s)}}})},httpRequest(e,t,r,n,i){i=syn.$w.argumentsExtend({timeout:0,responseType:"text"},i),1==$object.isNullOrUndefined(r)&&(r={});const o=syn.$w.xmlHttp();o.open(e,t,!0),o.timeout=i.timeout,o.responseType=i.responseType,o.setRequestHeader("OffsetMinutes",syn.$w.timezoneOffsetMinutes);let s=null;if(0==$object.isNullOrUndefined(r.body)){var a=r.body;if("GET"==e.toUpperCase()){let e=t+(1<t.split("?").length?"&":"?");for(const l in a)e+=l+"="+a[l].toString()+"&";t=encodeURI(e.substring(0,e.length-1))}else{s=new FormData;for(const c in a)s.append(c,a[c].toString())}}else o.setRequestHeader("Content-Type",i.contentType||"application/json");if(!syn.$w.setServiceClientHeader||0!=syn.$w.setServiceClientHeader(o))if(n)o.onreadystatechange=function(){4===o.readyState&&(200!==o.status?0==o.status?syn.$l.eventLog("$r.httpRequest","X-Requested transport error","Fatal"):syn.$l.eventLog("$r.httpRequest","response status - {0}".format(o.statusText)+o.response,"Error"):n&&n({status:o.status,response:o.response}))},null==s?r!={}?o.send(JSON.stringify(r)):o.send():o.send(s);else{if(globalRoot.Promise)return new Promise(function(e){o.onload=function(){return e({status:o.status,response:o.response})},o.onerror=function(){return e({status:o.status,response:o.response})},null==s?r!={}?o.send(JSON.stringify(r)):o.send():o.send(s)});syn.$l.eventLog("$w.httpRequest","지원하지 않는 기능. 매개변수 확인 필요","Error")}},httpSubmit(e,t,r){if(0==a.forms.length)return!1;0<a.forms.length&&1==$object.isNullOrUndefined(t)&&(t=a.forms[0].id);t=a.forms[t];if(!t)return!1;t.method=r||"POST",t.action=e,t.submit()},httpDataSubmit(t,e,r,n){n=syn.$w.argumentsExtend({timeout:0,responseType:"text"},n);const i=syn.$w.xmlHttp();if(i.open("POST",e,!0),i.timeout=n.timeout,i.responseType=n.responseType,i.setRequestHeader("OffsetMinutes",syn.$w.timezoneOffsetMinutes),!syn.$w.setServiceClientHeader||0!=syn.$w.setServiceClientHeader(i))if(r)i.onreadystatechange=function(){4===i.readyState&&(200!==i.status?0==i.status?syn.$l.eventLog("$r.httpDataSubmit","X-Requested transfort error","Fatal"):syn.$l.eventLog("$r.httpDataSubmit","response status - {0}".format(i.statusText)+i.response,"Error"):r&&r({status:i.status,response:i.response}))},i.send(t);else{if(globalThis.Promise)return new Promise(function(e){i.onload=function(){return e({status:i.status,response:i.response})},i.onerror=function(){return e({status:i.status,response:i.response})},i.send(t)});syn.$l.eventLog("$r.httpDataSubmit","지원하지 않는 기능. 매개변수 확인 필요","Error")}},createBlobUrl:globalRoot.URL&&"function"==typeof globalRoot.URL.createObjectURL&&globalRoot.URL.createObjectURL.bind(globalRoot.URL)||void 0!==globalRoot.webkitURL&&"function"==typeof globalRoot.webkitURL.createObjectURL&&globalRoot.webkitURL.createObjectURL.bind(globalRoot.webkitURL)||globalRoot.createObjectURL,revokeBlobUrl:globalRoot.URL&&"function"==typeof globalRoot.URL.revokeObjectURL&&globalRoot.URL.revokeObjectURL.bind(globalRoot.URL)||void 0!==globalRoot.webkitURL&&"function"==typeof globalRoot.webkitURL.revokeObjectURL&&globalRoot.webkitURL.revokeObjectURL.bind(globalRoot.webkitURL)||globalRoot.revokeObjectURL,getCookie(e){e=a.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return e?decodeURIComponent(e[1]):void 0},setCookie(e,t,r,n,i,o){return 1==$object.isNullOrUndefined(r)&&(r=new Date((new Date).getTime()+864e5)),1==$object.isNullOrUndefined(n)&&(n="/"),a.cookie=e+"="+encodeURI(t)+(r?";expires="+r.toUTCString():"")+(n?";path="+n:"")+(i?";domain="+i:"")+(o?";secure":""),s},deleteCookie(e,t,r){return syn.$r.getCookie(e)&&(a.cookie=e+"="+(t?";path="+t:"")+(r?";domain="+r:"")+";expires=Thu, 01-Jan-1970 00:00:01 GMT"),s}}),e.$request=syn.$r=s}(globalRoot),!function(E){"use strict";const T=E.$network||new syn.module;T.extend({myChannelID:null,connections:[],concreate(e){e.myChannelID=syn.$r.query("channelID")||syn.$r.query("ChannelID")||syn.$r.query("CHANNELID")||syn.$r.query("channelid")||""},rooms:function(){let b=Math.floor(1000001*Math.random());const w={},C={};var e=e=>{let r;try{if(!e.data||location.origin!=e.origin)return;if("object"!=typeof(r=JSON.parse(e.data))||null===r)return void syn.$l.eventLog("$network.onPostMessage","postMessage data 확인 필요 (non-object)","Verbose")}catch(e){return void syn.$l.eventLog("$network.onPostMessage","JSON parse error: "+e.message,"Verbose")}const n=e.source,i=e.origin;let o=null,s=null;e=r.id;if("string"==typeof r.method&&(2===(t=r.method.split("::")).length?[o,s]=t:s=r.method),s){let e=!1;var t=e=>{e=w[e]?.[o];if(e)for(const t of e)if(t.channelWindow===n)return t.handler(i,s,r),!0;return!1};(e=t(i)?!0:e)||t("*")}else void 0!==e&&(t=C[e])&&t(i,s,r)},e=(E.addEventListener?E.addEventListener("message",e,!1):E.attachEvent&&E.attachEvent("onmessage",e),{connect(p){if("object"!=typeof p)return void syn.$l.eventLog("$network.options","유효한 매개변수 없이 호출된 채널 빌드","Error");if(!p.window||!p.window.postMessage)return void syn.$l.eventLog("$network.context","필수 매개변수 없이 호출된 채널 빌드 (window)","Error");if(E===p.window)return void syn.$l.eventLog("$network.context","동일한 화면에서 거래되는 채널 생성은 허용되지 않음","Error");p.origin=p.origin||"*";let e=!1;if("string"==typeof p.origin&&("*"===p.origin?e=!0:(r=p.origin.match(/^https?:\/\/(?:[-a-zA-Z0-9_\.])+(?::\d+)?/))&&(p.origin=r[0].toLowerCase(),e=!0)),!e)return void syn.$l.eventLog("$network.origin","유효한 origin 없이 호출된 채널 빌드","Error");let i=p.scope||syn.$l.random();if(void 0!==p.scope){if("string"!=typeof p.scope)return void syn.$l.eventLog("$network.scope","scope는 문자열이어야 함","Error");if(p.scope.includes("::"))return void syn.$l.eventLog("$network.scope",'scope에는 이중 콜론 ("::")이 포함될 수 없음',"Error")}else p.scope="";if(T.findChannel(i)&&""!==i)return void syn.$l.eventLog("$network.connect",`channelID: ${i} 중복 확인 필요`,"Warning");const f=e=>{if(p.debugOutput)try{var t="string"!=typeof e?JSON.stringify(e):e;syn.$l.eventLog("$network.debug",`channelID: ${i}, message: `+t,"Information")}catch(e){syn.$l.eventLog("$network.debug",`channelID: ${i}, message stringify error: `+e.message,"Error")}},g={},m={},y={};let o=!1;const s=[],u=(e,t,r)=>{if("function"==typeof p.gotMessageObserver)try{p.gotMessageObserver(e,r)}catch(e){f("gotMessageObserver() 오류: "+e.toString())}var{id:n,callback:i,params:o,error:s,message:a,result:l}=r;if(void 0!==n&&t){var c=g[t];if(c){const d=((r,e,n)=>{let t=!1,i=!1;return{origin:e,invoke:(e,t)=>{y[r]?n.includes(e)?v({id:r,callback:e,params:t}):f("존재하지 않는 콜백 호출 시도: "+e):f("존재하지 않는 거래의 콜백 호출 시도: "+r)},error:(e,t)=>{i||(i=!0,y[r]?(delete y[r],v({id:r,error:e,message:t})):f("존재하지 않는 메시지의 에러 호출 시도: "+r))},complete:e=>{i||(i=!0,y[r]?(delete y[r],v({id:r,result:e})):f("존재하지 않는 메시지의 완료 호출 시도: "+r))},delayReturn:e=>t="boolean"==typeof e?e:t,completed:()=>i}})(n,e,r.callbacks||[]);y[n]={};try{const h=o;Array.isArray(r.callbacks)&&r.callbacks.forEach(t=>{var r=t.split("/");let n=h;for(let e=0;e<r.length-1;e++){var i=r[e];"object"==typeof n[i]&&null!==n[i]||(n[i]={}),n=n[i]}var e=r[r.length-1];n[e]=e=>d.invoke(t,e)});var u=c(d,h);d.delayReturn()||d.completed()||d.complete(u)}catch(e){var r=e.name||"runtime_error",c=e.stack||e.message||String(e);syn.$l.eventLog("$network.onMessage",`Request handler error: name: ${r}, message: `+c,"Error"),d.error(r,c)}}}else void 0!==n&&i?(u=m[n])?.callbacks?.[i]?u.callbacks[i](o):f(`유효하지 않는 콜백, id: ${n} (${i})`):void 0!==n?(r=m[n])?(clearTimeout(r.timeoutId),s?r.error(s,a):r.success(l),delete m[n],delete C[n]):f("유효하지 않는 응답: "+n):t&&(c=g[t])&&c({origin:e},o)};{var t=p.window,r=p.origin,n=p.scope,a=u,l=e=>e.some(e=>e.channelWindow===t);let e=!1;if("*"===r){for(const h in w)if(w.hasOwnProperty(h)&&"*"!==h&&"object"==typeof w[h][n]&&(e=l(w[h][n])))break}else!(e=w["*"]?.[n]?l(w["*"][n]):e)&&w[r]?.[n]&&(e=l(w[r][n]));e?syn.$l.eventLog("$network.addChannel",`origin: ${r}, scope: ${n}에 해당하는 채널이 이미 있습니다`,"Warning"):("object"!=typeof w[r]&&(w[r]={}),"object"!=typeof w[r][n]&&(w[r][n]=[]),w[r][n].push({channelWindow:t,handler:a}))}const d=e=>p.scope?p.scope+"::"+e:e,v=(e,t=!1)=>{if(e){var r=o?"post ":"queue ";if(f(r+` message (type: ${e.method||e.id||"response"})`),t||o){if("function"==typeof p.postMessageObserver)try{p.postMessageObserver(p.origin,e)}catch(e){f("postMessageObserver() 확인 필요: "+e.toString())}try{p.window.postMessage(JSON.stringify(e),p.origin)}catch(e){f("postMessage failed: "+e.message),syn.$l.eventLog("$network.postMessage","postMessage failed: "+e.message,"Error")}}else s.push(e)}else syn.$l.eventLog("$network.postMessage","null 메시지로 postMessage 호출 시도","Error")};const c={unbind(e){return!!g[e]&&(delete g[e],!0)},bind(e,t){return e&&"string"==typeof e?t&&"function"==typeof t?g[e]?syn.$l.eventLog("$network.bind",e+" method 중복 확인 필요","Warning"):g[e]=t:syn.$l.eventLog("$network.bind","callback 매개변수 확인 필요 (유효하지 않음)","Warning"):syn.$l.eventLog("$network.bind","method 매개변수 확인 필요 (유효하지 않음)","Warning"),this},call(e){if(e&&e.method&&"string"==typeof e.method&&e.success&&"function"==typeof e.success){const s={},a=[],l=new Set,c=(e,t)=>{if(null!==t&&"object"==typeof t)if(l.has(t))f("순환 참조 감지됨, 함수 제거 건너뛰기: "+e);else{l.add(t);for(const i in t){var r,n;t.hasOwnProperty(i)&&(r=t[i],n=e?e+"/"+i:i,"function"==typeof r?(s[n]=r,a.push(n),delete t[i]):null!==r&&"object"==typeof r&&c(n,r))}}};var t,r,n,i=e.params?JSON.parse(JSON.stringify(e.params)):{},i=(c("",i),{id:b,method:d(e.method),params:i}),o=(0<a.length&&(i.callbacks=a),e.error||((e,t)=>f(`Default error handler: ${e}- `+t))),o={callbacks:s,error:o,success:e.success,timeoutId:null};e.timeout&&(o.timeoutId=(t=b,r=e.timeout,n=d(e.method),setTimeout(()=>{var e=m[t];e&&(e.error("timeout_error",`"${n}" 타임아웃 (${r}ms) `),delete m[t],delete C[t])},r))),m[b]=o,C[b]=u,b++,v(i)}else syn.$l.eventLog("$network.call","필수 매개변수 확인 필요 (method, success)","Warning")},emit(e){e&&e.method&&"string"==typeof e.method?v({method:d(e.method),params:e.params}):syn.$l.eventLog("$network.emit","필수 매개변수 확인 필요 (method)","Warning")},destroy(){t=p.window,r=p.origin,n=p.scope,(e=w[r]?.[n])&&(w[r][n]=e.filter(e=>e.channelWindow!==t),0===w[r][n].length&&(delete w[r][n],0===Object.keys(w[r]).length)&&delete w[r],-1<(e=T.connections.findIndex(e=>e.options.origin===r&&e.options.scope===n)))&&T.connections.splice(e,1),o=!1,Object.keys(g).forEach(e=>delete g[e]),Object.keys(y).forEach(e=>delete y[e]),Object.keys(m).forEach(e=>{clearTimeout(m[e].timeoutId),delete m[e],delete C[e]}),p.origin=null,s.length=0,i="",f("채널 삭제됨");var t,r,n,e=T.connections.indexOf(c);-1<e&&T.connections.splice(e,1)}};return c.bind("__ready",(e,t)=>{if(f("ready message received"),o)syn.$l.eventLog("$network.onReady","중복 ready 메시지 수신","Warning");else{for(i="T"===t?i+"-R":i+"-L",c.unbind("__ready"),o=!0,f("ready message accepted"),"T"===t&&c.emit({method:"__ready",params:"A"});0<s.length;)v(s.shift());if("function"==typeof p.onReady)try{p.onReady(c)}catch(e){f("onReady handler failed: "+e.message)}}}),setTimeout(()=>{v({method:d("__ready"),params:"T"},!0)},0),c.options=p,T.connections.push(c),c}});return e}(),findChannel(t){if(t)return T.connections.find(e=>e.options.scope===t)},call(e,r,t){const n=this.findChannel(e);n?n.call({method:r,params:t,success:e=>{n.options.debugOutput&&syn.$l.eventLog("$network.call.success",`"${r}" call success, channelID: `+n.options.scope,"Information")},error:(e,t)=>{n.options.debugOutput&&syn.$l.eventLog("$network.call.error",`"${r}" call error: ${e}, message: ${t||""}, channelID: `+n.options.scope,"Information")}}):syn.$l.eventLog("$network.call","Channel not found: "+e,"Warning")},broadCast(n,e){this.connections.forEach(r=>{r.call({method:n,params:e,success:e=>{r.options.debugOutput&&syn.$l.eventLog("$network.broadcast.success",`"${n}" broadcast success, channelID: `+r.options.scope,"Information")},error:(e,t)=>{r.options.debugOutput&&syn.$l.eventLog("$network.broadcast.error",`"${n}" broadcast error: ${e}, message: ${t||""}, channelID: `+r.options.scope,"Information")}})})},emit(e,t){var r;this.myChannelID?(r=this.findChannel(this.myChannelID))?(t={method:e,params:t},r.options.debugOutput&&syn.$l.eventLog("$network.emit",`Emitting "${e}", channelID: `+r.options.scope,"Information"),r.emit(t)):syn.$l.eventLog("$network.emit","Emit failed: Own channel not found or ready: "+this.myChannelID,"Warning"):syn.$l.eventLog("$network.emit","Cannot emit: myChannelID is not set.","Warning")}}),T.myChannelID=syn.$r.query("channelID")||syn.$r.query("ChannelID")||syn.$r.query("CHANNELID")||syn.$r.query("channelid")||"",E.$network=syn.$n=T}(globalRoot),!function(context){"use strict";const $webform=context.$webform||new syn.module;let doc=null;if("node"!==globalRoot.devicePlatform&&($webform.context=context,$webform.document=context.document,doc=context.document),$webform.extend({localeID:"ko-KR",cookiePrefixName:"HandStack",timezoneOffsetMinutes:-(new Date).getTimezoneOffset(),method:"POST",isPageLoad:!1,transactionLoaderID:null,pageReadyTimeout:6e4,eventAddReady:"node"===globalRoot.devicePlatform?null:new CustomEvent("addready"),eventRemoveReady:"node"===globalRoot.devicePlatform?null:new CustomEvent("removeready"),mappingModule:!0,moduleReadyIntervalID:null,remainingReadyIntervalID:null,remainingReadyCount:0,defaultControlOptions:{value:"",dataType:"string",belongID:null,controlText:null,validators:["require","unique","numeric","ipaddress","email","date","url"],transactConfig:null,triggerConfig:null,getter:!1,setter:!1,bindingID:"",resourceKey:"",localeID:"ko-KR",required:!1,tooltip:""},setStorage(e,t,r=!1,n){var i,o=JSON.stringify(t);return"node"===globalRoot.devicePlatform?r?localStorage.setItem(e,o):(n=n??12e5,i=Date.now(),localStorage.setItem(e,JSON.stringify({value:t,expiry:i+n,ttl:n}))):(r?localStorage:sessionStorage).setItem(e,o),this},getStorage(t,e=!1){if("node"===globalRoot.devicePlatform){if(e)return(r=localStorage.getItem(t))?JSON.parse(r):null;var r=localStorage.getItem(t);if(!r)return null;try{var n,i=JSON.parse(r),o=Date.now();return o>i.expiry?(localStorage.removeItem(t),null):(n={...i,expiry:o+i.ttl},localStorage.setItem(t,JSON.stringify(n)),i.value)}catch(e){return syn.$l.eventLog("$w.getStorage (Node)",`키 "${t}"에 대한 스토리지 항목 파싱 오류: `+e,"Error"),localStorage.removeItem(t),null}}else{r=e?localStorage:sessionStorage,o=r.getItem(t);try{return o?JSON.parse(o):null}catch(e){return syn.$l.eventLog("$w.getStorage (Browser)",`키 "${t}"에 대한 스토리지 항목 파싱 오류: `+e,"Error"),r.removeItem(t),null}}},removeStorage(e,t=!1){return("node"===globalRoot.devicePlatform||t?localStorage:sessionStorage).removeItem(e),this},activeControl(e){e=e||context.event||null;let t=null;return e?t=e.target||e.srcElement||e||null:doc&&(t=doc.activeElement||null),(t=!t&&globalRoot.$this?.context?$this.context.focusControl||null:t)&&globalRoot.$this?.context&&($this.context.focusControl=t),t},async contentLoaded(){if(syn.$l.addEvent(document,"addready",function(){syn.$w.remainingReadyCount++}),syn.$l.addEvent(document,"removeready",function(){syn.$w.remainingReadyCount--}),syn.$l.get("moduleScript"))syn.$w.extend({pageScript:syn.$l.get("moduleScript").value});else{var pathname=location.pathname,filename,input=(0<pathname.split("/").length&&(filename=pathname.split("/")[pathname.split("/").length-1],$webform.extend({pageProject:pathname.split("/")[pathname.split("/").length-2],pageScript:"$"+(-1<filename.indexOf(".")?filename.substring(0,filename.indexOf(".")):filename)})),document.createElement("input"));if(input.id="moduleScript",input.type="hidden",input.value=syn.$w.pageScript,document.body.appendChild(input),document.forms)for(var i=0;i<document.forms.length;i++)syn.$l.addEvent(document.forms[i],"submit",function(e){var t=!1,r=e.target||e.srcElement;if($this&&$this.hook&&$this.hook.frameEvent&&(t=$this.hook.frameEvent("beforeSubmit",{el:r,evt:e}),1!=$object.isNullOrUndefined(t)&&0!=$string.toBoolean(t)||(t=!1)),0==t)return e.returnValue=!1,e.cancel=!0,e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),!1})}var pageLoad=function(){context.domainPageLoad&&context.domainPageLoad();var e,r=context[syn.$w.pageScript];if(r&&r.hook.pageLoad&&r.hook.pageLoad(),r&&r.hook.pageMatch&&(e=function(e){var t="xs";switch(e.media){case"(min-width: 576px)":t="sm";break;case"(min-width: 768px)":t="md";break;case"(min-width: 992px)":t="lg";break;case"(min-width: 1200px)":t="xl";break;case"(min-width: 1400px)":t="xxl"}document.dispatchEvent(new CustomEvent("mediaquery",{detail:t})),r.hook.pageMatch(t),context.domainPageMediaQuery&&context.domainPageMediaQuery(t)},syn.$l.addEvent(matchMedia("(min-width: 0px)"),"change",e),syn.$l.addEvent(matchMedia("(min-width: 576px)"),"change",e),syn.$l.addEvent(matchMedia("(min-width: 768px)"),"change",e),syn.$l.addEvent(matchMedia("(min-width: 992px)"),"change",e),syn.$l.addEvent(matchMedia("(min-width: 1200px)"),"change",e),syn.$l.addEvent(matchMedia("(min-width: 1400px)"),"change",e)),1==$object.isNullOrUndefined(syn.$w.User)&&(e={TokenID:"",UserNo:0,UserID:"",UserName:"",BusinessPhoneNo:"",BusinessEmail:"",DepartmentID:"",DepartmentName:"",PositionID:"",PositionName:"",CompanyNo:"",CompanyName:"",Roles:[],Claims:[]},syn.$w.getSSOInfo?syn.$w.User=syn.$w.getSSOInfo()||e:syn.$w.User=e),0==$object.isNullOrUndefined(syn.$w.User)&&syn.$l.deepFreeze(syn.$w.User),0==$object.isNullOrUndefined(syn.$w.Variable)&&syn.$l.deepFreeze(syn.$w.Variable),r&&r.context.synControls&&(1==$object.isNullOrUndefined(r.context.tabOrderControls)||0==r.context.tabOrderControls.length)){var t=[],n=document.body.outerHTML.match(/<(syn_).+?>/gi);if(n)for(var i=n.length,o=0;o<i;o++){var s=n[o],a=s.substring(1,s.indexOf(" ")).toUpperCase();t.push(a)}for(var t=$array.distinct(t),l=document.querySelectorAll("input,select,textarea,button"+(0<t.length?","+t.join(","):"")),c=[],u=l.length,d=0;d<u;d++)(h=l[d])&&h.style&&"none"==h.style.display||"hidden"==h.type?h.id&&"SELECT"==h.tagName.toUpperCase()&&0==$string.isNullOrEmpty(h.getAttribute("syn-datafield"))&&c.push(h):(h.id&&0==h.id.includes("btn_syneditor_")&&0==h.id.includes("chk_syngrid_")&&0==h.id.includes("_hidden")||h.id&&"SELECT"==h.tagName.toUpperCase()&&0==$string.isNullOrEmpty(h.getAttribute("syn-datafield"))||h.id&&1==h.tagName.includes("SYN_"))&&c.push(h);for(var h,p,f,g,m,y=[],o=0,u=c.length,d=0;d<u;d++)(h=c[d]).id&&0==h.id.includes("btn_syneditor_")&&0==h.id.includes("chk_syngrid_")&&0==h.id.includes("_hidden")?(f=h.id,g=syn.$d.offset(h),(m=h.getAttribute("baseID"))&&(f=m),(m=r.context.synControls.find(function(e){return e.id==f}))&&("datepicker"==m.type?g=syn.$d.offset(h.parentElement):"colorpicker"==m.type&&(g=syn.$d.offset(h.parentElement.parentElement)),y.push({elID:h.id,tagName:h.tagName,formID:m.formDataFieldID,type:m.type,top:g.top,left:g.left}))):h.id&&"SELECT"==h.tagName.toUpperCase()&&0==$string.isNullOrEmpty(h.getAttribute("syn-datafield"))?(g=null,!1===h.getAttribute("multiple")?(p=syn.uicontrols.$select.getControl(h.id))&&(g=syn.$d.offset(p.picker.select)):(p=syn.uicontrols.$multiselect.getControl(h.id))&&(g=syn.$d.offset(p.picker.select)),g&&(m=r.context.synControls.find(function(e){return e.id==h.id}))&&y.push({elID:h.id,tagName:h.tagName,formID:m.formDataFieldID,type:m.type,top:g.top,left:g.left})):h.id&&1==h.tagName.includes("SYN_")&&(f=h.id.replace("_hidden",""),"SYN_DATEPICKER"!=h.tagName&&h.tagName,g=null)&&(m=r.context.synControls.find(function(e){return e.id==f}))&&y.push({elID:f,tagName:h.tagName,formID:m.formDataFieldID,type:m.type,top:g.top,left:g.left}),o+=1;r.context.focusControl=null,r.context.tabOrderFocusID=null,r.context.tabOrderControls=y,r&&r.hook.frameEvent&&r.hook.frameEvent("tabOrderControls",r.context.tabOrderControls),0<r.context.tabOrderControls.length&&(r.config?(1==$string.isNullOrEmpty(r.context.tapOrderFlow)&&(r.context.tapOrderFlow="html"),"tdlr"==r.context.tapOrderFlow?r.context.tabOrderControls.sort(function(e,t){return e.top===t.top?e.left-t.left:e.top>t.top?1:-1}):"lrtd"==r.context.tapOrderFlow&&r.context.tabOrderControls.sort(function(e,t){return e.left===t.left?e.top-t.top:e.left>t.left?1:-1})):r.context.tabOrderControls.sort(function(e,t){return e.top===t.top?e.left-t.left:e.top>t.top?1:-1}));var v=syn.$l.querySelector("[autofocus]");v&&v.id&&v.tagName&&(a=v.tagName.toUpperCase(),-1<"input,select,textarea,button".toUpperCase().split(",").indexOf(a))&&(r.context.focusControl=v,r.context.tabOrderFocusID=v.id,setTimeout(function(){v.focus()}))}r&&r.hook.pageComplete&&r.hook.pageComplete(),context.domainPageComplete&&context.domainPageComplete()},pageFormInit=async()=>{var mod=context[syn.$w.pageScript];if(mod.config&&0==$string.isNullOrEmpty(mod.config.layoutPage)){var masterLayout=await syn.$w.fetchText(mod.config.layoutPage);if(masterLayout){var parser=new DOMParser,masterPage=parser.parseFromString(masterLayout,"text/html");if(masterPage){document.body.style.visibility="hidden";for(var heads=syn.$l.querySelectorAll("syn-head"),i=0,length=heads.length;i<length;i++){var head=heads[i];document.head.insertAdjacentHTML("afterbegin",head.innerHTML)}for(var sections=syn.$l.querySelectorAll("syn-section"),i=0,length=sections.length;i<length;i++){var section=sections[i],componentSection=masterPage.querySelector(section.getAttribute("selector"));componentSection&&(componentSection.innerHTML=section.innerHTML)}for(var bodys=syn.$l.querySelectorAll("syn-body"),i=0,length=bodys.length;i<length;i++){var body=bodys[i],position=body.getAttribute("position");0==$string.isNullOrEmpty(position)&&-1<["beforebegin","afterbegin","beforeend","afterend"].indexOf(position)&&masterPage.body.insertAdjacentHTML(position,body.innerHTML)}document.body.innerHTML=masterPage.body.innerHTML}}}if(mod&&mod.hook.pageFormInit&&await mod.hook.pageFormInit(),context.domainLibraryLoad){var isContinue=await domainLibraryLoad();if(0==$object.isNullOrUndefined(isContinue)&&!1===isContinue)return!1}for(var getTagModule=e=>{var t=null;if(syn.uicontrols){var r="";if(-1<e.indexOf("SYN_"))var n=e.substring(4).toLowerCase(),t=syn.uicontrols["$"+n],r=n;else switch(e){case"BUTTON":t=syn.uicontrols.$button,r="button";break;case"INPUT":switch(r=(synControl.getAttribute("type")||"text").toLowerCase()){case"hidden":case"text":case"password":case"color":case"email":case"number":case"search":case"tel":case"url":t=syn.uicontrols.$textbox;break;case"submit":case"reset":case"button":t=syn.uicontrols.$button;break;case"radio":t=syn.uicontrols.$radio;break;case"checkbox":t=syn.uicontrols.$checkbox}break;case"TEXTAREA":t=syn.uicontrols.$textarea,r="textarea";break;case"SELECT":r=null==synControl.getAttribute("multiple")?(t=syn.uicontrols.$select,"select"):(t=syn.uicontrols.$multiselect,"multiselect");break;default:t=syn.uicontrols.$element,r="element"}}return{module:t,type:r}},synControlList=[],synControls=document.querySelectorAll('[tag^="syn_"],[syn-datafield],[syn-options],[syn-events]'),i=0;i<synControls.length;i++){var synControl=synControls[i];if(synControl.tagName){var tagName=synControl.tagName.toUpperCase(),dataField=synControl.getAttribute("syn-datafield"),elementID=synControl.getAttribute("id"),formDataField=synControl.closest("form")?synControl.closest("form").getAttribute("syn-datafield"):"",controlOptions=synControl.getAttribute("syn-options")||null;if(null!=controlOptions)try{controlOptions=eval("("+controlOptions+")")}catch(error){syn.$l.eventLog("$w.contentLoaded",'elID: "{0}" syn-options 확인 필요: '.format(elementID)+error.message,"Warning")}else controlOptions={};var tagModule=getTagModule(tagName);tagModule.module?tagModule.module.controlLoad(elementID,controlOptions):$this.hook.controlLoad&&$this.hook.controlLoad(elementID,controlOptions)}}for(var synControls=document.querySelectorAll('[tag^="syn_"],[syn-datafield],[syn-options],[syn-events]'),i=0;i<synControls.length;i++){var synControl=synControls[i];if(synControl.tagName){var tagName=synControl.tagName.toUpperCase(),dataField=synControl.getAttribute("syn-datafield"),elementID=synControl.getAttribute("id"),formDataField=synControl.closest("form")?synControl.closest("form").getAttribute("syn-datafield"):"",controlOptions=synControl.getAttribute("syn-options")||null;if(null!=controlOptions)try{controlOptions=eval("("+controlOptions+")")}catch(error){syn.$l.eventLog("$w.contentLoaded",'elID: "{0}" syn-options 확인 필요: '.format(elementID)+error.message,"Warning")}else controlOptions={};syn.$l.addEvent(synControl.id,"focus",function(e){$this.context.focusControl=e.target||e.currentTarget||e.srcElement,$this.context.focusControl?$this.context.tabOrderFocusID=$this.context.focusControl.id:$this.context.tabOrderFocusID=null});var tagModule=getTagModule(tagName);tagModule.module?tagModule.module.addModuleList&&tagModule.module.addModuleList(synControl,synControlList,controlOptions,tagModule.type):elementID&&dataField&&synControlList.push({id:elementID,formDataFieldID:formDataField,field:dataField,module:null,type:tagModule.type||synControl.tagName.toLowerCase()})}}for(var synEventControls=document.querySelectorAll("[syn-events]"),i=0;i<synEventControls.length;i++){var synControl=synEventControls[i],elEvents=null;try{elEvents=eval("("+synControl.getAttribute("syn-events")+")")}catch(error){syn.$l.eventLog("$w.contentLoaded",'elID: "{0}" syn-events 확인 필요: '.format(synControl.id)+error.message,"Warning")}if(elEvents&&$this.event)for(var length=elEvents.length,j=0;j<length;j++){var elEvent=elEvents[j],func=$this.event[synControl.id+"_"+elEvent];func&&syn.$l.addEvent(synControl.id,elEvent,func)}}for(var synOptionControls=document.querySelectorAll("[syn-options]"),i=0;i<synOptionControls.length;i++){var synControl=synOptionControls[i],elID=synControl.id.replace("_hidden",""),options=null;try{var el=syn.$l.get(synControl.id+"_hidden")||syn.$l.get(synControl.id),synOptions=el.getAttribute("syn-options")||null;null!=synOptions&&(options=eval("("+synOptions+")"))}catch(error){syn.$l.eventLog("$w.contentLoaded",'elID: "{0}" syn-options 확인 필요: '.format(synControl.id)+error.message,"Warning")}if(options&&options.transactConfig&&options.transactConfig.triggerEvent)if(1==$object.isString(options.transactConfig.triggerEvent))syn.$l.addEvent(elID,options.transactConfig.triggerEvent,function(evt){var el=syn.$w.activeControl(evt),synOptions=el.getAttribute("syn-options")||null,transactConfig=(null!=synOptions&&(options=eval("("+synOptions+")")),null);options&&options.transactConfig&&(transactConfig=options.transactConfig),transactConfig&&syn.$w.transactionAction(transactConfig,transactConfig.options)});else if(1==$object.isArray(options.transactConfig.triggerEvent)){var triggerFunction=function(evt){var el=syn.$w.activeControl(evt),synOptions=el.getAttribute("syn-options")||null,transactConfig=(null!=synOptions&&(options=eval("("+synOptions+")")),null);options&&options.transactConfig&&(transactConfig=options.transactConfig),transactConfig&&syn.$w.transactionAction(transactConfig,transactConfig.options)},key;for(key in options.transactConfig.triggerEvent){var eventName=options.transactConfig.triggerEvent[key];syn.$l.addEvent(elID,eventName,triggerFunction)}}if(options&&options.triggerConfig&&options.triggerConfig.triggerEvent)if(1==$object.isString(options.triggerConfig.triggerEvent))syn.$l.addEvent(elID,options.triggerConfig.triggerEvent,function(evt){var triggerConfig=null,el=syn.$w.activeControl(evt),synOptions=el.getAttribute("syn-options")||null;(null!=synOptions||(synOptions=el.parentElement.getAttribute("syn-options")||null,null!=synOptions))&&(options=eval("("+synOptions+")")),options&&options.triggerConfig&&(triggerConfig=options.triggerConfig),triggerConfig&&syn.$w.triggerAction(triggerConfig)});else if(1==$object.isArray(options.triggerConfig.triggerEvent)){var triggerFunction=function(evt){var triggerConfig=null,el=syn.$w.activeControl(evt),synOptions=el.getAttribute("syn-options")||null;(null!=synOptions||(synOptions=el.parentElement.getAttribute("syn-options")||null,null!=synOptions))&&(options=eval("("+synOptions+")")),options&&options.triggerConfig&&(triggerConfig=options.triggerConfig),triggerConfig&&syn.$w.triggerAction(triggerConfig)},key;for(key in options.triggerConfig.triggerEvent){var eventName=options.triggerConfig.triggerEvent[key];syn.$l.addEvent(elID,eventName,triggerFunction)}}}var elem=document.createElement("input");elem.type="hidden",elem.id="synControlList",elem.textContent=JSON.stringify(synControlList),document.body.appendChild(elem),mod?mod.context.synControls=synControlList:context.synControls=synControlList,syn.$w.remainingReadyIntervalID=setInterval(function(){0==$object.isNullOrUndefined(syn.$w.remainingReadyIntervalID)&&0==syn.$w.remainingReadyCount&&(clearInterval(syn.$w.remainingReadyIntervalID),syn.$w.remainingReadyIntervalID=null,pageLoad(),syn.$w.isPageLoad=!0)},25),setTimeout(function(){0==$object.isNullOrUndefined(syn.$w.remainingReadyIntervalID)&&(clearInterval(syn.$w.remainingReadyIntervalID),syn.$w.remainingReadyIntervalID=null,syn.$l.eventLog("pageLoad","화면 초기화 오류, remainingReadyCount: {0} 확인 필요".format(syn.$w.remainingReadyCount),"Fatal"))},syn.$w.pageReadyTimeout)},module,mod;1==syn.$w.mappingModule?(module={},syn.$l.get("moduleScript")&&syn.$w.extend({pageScript:syn.$l.get("moduleScript").value}),0==$string.toBoolean(window.noPageScript)&&(module=await syn.$w.fetchScript(syn.$w.pageScript.replace("$",""))),mod=context[syn.$w.pageScript]||new syn.module,mod.config={programID:syn.Config.ApplicationID,moduleID:("browser"==globalRoot.devicePlatform?location.pathname.split("/").filter(Boolean)[0]:void 0)||syn.Config.ModuleID,businessID:syn.$w.pageProject||syn.Config.ProjectID,systemID:syn.Config.SystemID,transactionID:syn.$w.pageScript.replace("$",""),transactions:[],dataSource:{},actionButtons:[]},mod.prop={},mod.model={},mod.hook={},mod.event={},mod.translate={},mod.transaction={},mod.method={},mod.store={},mod.context={},mod.extend(module),context[syn.$w.pageScript]=mod,context.$this=mod,window.synLoader?(syn.$l.addEvent(document,"pageReady",pageFormInit),context.pageFormReady=!0,setTimeout(function(){syn.$l.removeEvent(document,"pageReady",pageFormInit),null!=syn.$w.remainingReadyIntervalID&&syn.$l.eventLog("pageReady","화면 초기화 오류, loader 또는 dispatchEvent 확인 필요","Fatal")},syn.$w.pageReadyTimeout)):setTimeout(async()=>{await pageFormInit()},25)):(pageLoad(),syn.$w.isPageLoad=!0)},addReadyCount(){syn.$w.eventAddReady&&0==syn.$w.isPageLoad&&doc.dispatchEvent(syn.$w.eventAddReady)},removeReadyCount(){syn.$w.eventRemoveReady&&0==syn.$w.isPageLoad&&doc.dispatchEvent(syn.$w.eventRemoveReady)},createSelection(t,e,r){var n,t=syn.$l.getElement(t);if(t)try{t.setSelectionRange&&"email"!==t.type?t.setSelectionRange(e,r):t.createTextRange&&((n=t.createTextRange()).collapse(!0),n.moveStart("character",e),n.moveEnd("character",r-e),n.select()),t.focus()}catch(e){syn.$l.eventLog("$w.createSelection",t.id+"의 선택 영역 설정 오류: "+e,"Warning")}},argumentsExtend(...e){return Object.assign({},...e)},loadJson(t,r,n,i,e=!0,o=!1){const s=new XMLHttpRequest;if(s.open("GET",t,e),syn.$w.setServiceClientHeader&&!this.setServiceClientHeader(s))syn.$l.eventLog("$w.loadJson",`URL ${t}에 대한 setServiceClientHeader 실패`,"Error"),i&&o&&i();else{const a=()=>{if(200===s.status)try{var e=JSON.parse(s.responseText);n&&n(r,e)}catch(e){syn.$l.eventLog("$w.loadJson",`URL: ${t}, 상태: ${s.status}, 오류: ${e}에 대한 JSON 파싱 오류`,"Error")}finally{i&&i()}else syn.$l.eventLog("$w.loadJson",`URL: ${t}, 상태: ${s.status}, 응답 텍스트: ${s.responseText} HTTP 오류`,"Error"),i&&o&&i()};if(e)s.onreadystatechange=()=>{s.readyState===XMLHttpRequest.DONE&&a()},s.onerror=()=>{syn.$l.eventLog("$w.loadJson",`URL ${t} 네트워크 오류`,"Error"),i&&o&&i()},s.send();else try{s.send(),a()}catch(e){syn.$l.eventLog("$w.loadJson",`URL: ${t}, 오류: ${e}에 대한 동기 요청 중 오류 발생`,"Error"),i&&o&&i()}}},getTriggerOptions(t){var t=syn.$l.getElement(t),e=t?.getAttribute("triggerOptions");if(!e)return null;try{return JSON.parse(e)}catch(e){return syn.$l.eventLog("$w.getTriggerOptions",`엘리먼트 ${t?.id}의 triggerOptions 파싱 실패: `+e,"Warning"),null}},triggerAction(r){if($this){let e=!0;var n=syn.$w.argumentsExtend({arguments:[],options:{}},r.params);if((e=$this.hook?.beforeTrigger?$this.hook.beforeTrigger(r.triggerID,r.action,n):e)??!0){var i=syn.$l.get(r.triggerID);let e=null,t=null;try{if(r.action?.startsWith("syn.uicontrols.$")?t=r.action.split(".").slice(1).reduce((e,t)=>e?.[t],syn):r.triggerID&&r.action&&$this.event?t=$this.event[r.triggerID+"_"+r.action]:r.method&&(t=new Function(`return (${r.method})`)()),"function"!=typeof t)throw new Error(`액션: ${r.action||r.method}에 대한 트리거 함수를 찾을 수 없거나 유효하지 않습니다.`);if(i&&r.action?.startsWith("syn.uicontrols.$"))i.setAttribute("triggerOptions",JSON.stringify(n.options||{})),n.arguments.unshift(r.triggerID),e=t.apply(i,n.arguments);else if(i&&r.triggerID&&r.action&&$this.event)e=t.apply(i,n.arguments);else{if(!r.method)throw new Error("트리거 컨텍스트 불일치 또는 잘못된 설정입니다.");e=t.apply($this,n.arguments)}$this.hook?.afterTrigger&&$this.hook.afterTrigger(null,r.action,{elID:r.triggerID,result:e})}catch(e){i="트리거 실행 실패: "+e.message;syn.$l.eventLog("$w.triggerAction",i,"Error"),$this.hook?.afterTrigger&&$this.hook.afterTrigger(i,r.action,null)}}else $this.hook?.afterTrigger&&$this.hook.afterTrigger("hook.beforeTrigger가 false를 반환했습니다",r.action,null)}},getControlModule(t){if(!t)return null;try{return t.split(".").reduce((e,t)=>e?.[t],context)}catch(e){return syn.$l.eventLog("$w.getControlModule",`모듈 경로 "${t}" 접근 오류: `+e,"Warning"),null}},tryAddFunction(transactConfig){if(transactConfig&&$this&&$this.config){1==$object.isNullOrUndefined(transactConfig.noProgress)&&(transactConfig.noProgress=!1);try{1==$object.isNullOrUndefined($this.config.transactions)&&($this.config.transactions=[]);const transactions=$this.config.transactions;for(let i=0;i<transactions.length;i++)if(transactConfig.functionID==transactions[i].functionID){transactions.splice(i,1);break}const synControlList=$this.context.synControls,transactionObject={};if(transactionObject.functionID=transactConfig.functionID,transactionObject.transactionResult=1==$object.isNullOrUndefined(transactConfig.transactionResult)||!0===transactConfig.transactionResult,transactionObject.inputs=[],transactionObject.outputs=[],transactConfig.inputs){const inputs=transactConfig.inputs,inputsLength=inputs.length;for(let i=0;i<inputsLength;i++){const inputConfig=inputs[i],input={requestType:inputConfig.type,dataFieldID:inputConfig.dataFieldID||(0<document.forms.length?document.forms[0].getAttribute("syn-datafield"):""),items:{}};let synControlConfigs=null;if("Row"==inputConfig.type)if(synControlConfigs=synControlList.filter(function(e){return e.formDataFieldID==input.dataFieldID&&0==(-1<e.type.indexOf("grid")||-1<e.type.indexOf("chart")||-1<e.type.indexOf("data"))}),synControlConfigs&&0<synControlConfigs.length)for(let k=0;k<synControlConfigs.length;k++){const synControlConfig=synControlConfigs[k],el=syn.$l.get(synControlConfig.id+"_hidden")||syn.$l.get(synControlConfig.id),options=el&&el.getAttribute("syn-options");if(null!=options){let synOptions=null;try{synOptions=JSON.parse(options)}catch(e){synOptions=eval("("+options+")")}if(null!=synOptions&&1!=$string.isNullOrEmpty(synControlConfig.field)){let isBelong=!1;synOptions.belongID&&(1==$object.isString(synOptions.belongID)?isBelong=transactConfig.functionID==synOptions.belongID:1==$object.isArray(synOptions.belongID)&&(isBelong=-1<synOptions.belongID.indexOf(transactConfig.functionID))),1==isBelong&&(input.items[synControlConfig.field]={fieldID:synControlConfig.field,dataType:synOptions.dataType||"string"})}}}else{const synControlConfig=synControlList.find(function(e){return e.field==input.dataFieldID&&1==(-1<e.type.indexOf("grid")||-1<e.type.indexOf("chart"))}),controlModule=1==$object.isNullOrUndefined(synControlConfig)?null:syn.$w.getControlModule(synControlConfig.module);if(0==$object.isNullOrUndefined(controlModule)&&controlModule.setTransactionBelongID)controlModule.setTransactionBelongID(synControlConfig.id,input,transactConfig);else if(syn.uicontrols.$data&&0<syn.uicontrols.$data.storeList.length)for(let k=0;k<syn.uicontrols.$data.storeList.length;k++){const store=syn.uicontrols.$data.storeList[k];if("Form"==store.storeType&&store.dataSourceID==input.dataFieldID){for(let l=0;l<store.columns.length;l++){const column=store.columns[l];let isBelong=!1;1==$object.isString(column.belongID)?isBelong=transactConfig.functionID==column.belongID:1==$object.isArray(column.belongID)&&(isBelong=-1<column.belongID.indexOf(transactConfig.functionID)),1==isBelong&&(input.items[column.data]={fieldID:column.data,dataType:column.dataType||"string"})}break}}}else if("List"==inputConfig.type){const synControlConfig=synControlList.find(function(e){return e.field==input.dataFieldID&&1==(-1<e.type.indexOf("grid")||-1<e.type.indexOf("chart"))}),controlModule=1==$object.isNullOrUndefined(synControlConfig)?null:syn.$w.getControlModule(synControlConfig.module);if(0==$object.isNullOrUndefined(controlModule)&&controlModule.setTransactionBelongID)controlModule.setTransactionBelongID(synControlConfig.id,input,transactConfig);else if(syn.uicontrols.$data&&0<syn.uicontrols.$data.storeList.length)for(let k=0;k<syn.uicontrols.$data.storeList.length;k++){const store=syn.uicontrols.$data.storeList[k];if("Grid"==store.storeType&&store.dataSourceID==input.dataFieldID){for(let l=0;l<store.columns.length;l++){const column=store.columns[l];let isBelong=!1;1==$object.isString(column.belongID)?isBelong=transactConfig.functionID==column.belongID:1==$object.isArray(column.belongID)&&(isBelong=-1<column.belongID.indexOf(transactConfig.functionID)),1==isBelong&&(input.items[column.data]={fieldID:column.data,dataType:column.dataType||"string"})}break}}}transactionObject.inputs.push(input)}}if(transactConfig.outputs){const outputs=transactConfig.outputs,outputsLength=outputs.length,synControls=$this.context.synControls;for(let i=0;i<outputsLength;i++){const outputConfig=outputs[i],output={responseType:outputConfig.type,dataFieldID:outputConfig.dataFieldID||"",items:{}};let synControlConfigs=null;if("Form"==outputConfig.type){if(synControlConfigs=synControlList.filter(function(e){return e.formDataFieldID==output.dataFieldID&&0==(-1<e.type.indexOf("grid")||-1<e.type.indexOf("chart")||-1<e.type.indexOf("data"))}),synControlConfigs&&0<synControlConfigs.length)for(let k=0;k<synControlConfigs.length;k++){const synControlConfig=synControlConfigs[k],el=syn.$l.get(synControlConfig.id+"_hidden")||syn.$l.get(synControlConfig.id),options=el&&el.getAttribute("syn-options");if(null!=options){let synOptions=null;try{synOptions=JSON.parse(options)}catch(e){synOptions=eval("("+options+")")}if(null!=synOptions&&1!=$string.isNullOrEmpty(synControlConfig.field)&&(output.items[synControlConfig.field]={fieldID:synControlConfig.field,dataType:synOptions.dataType},1==outputConfig.clear)&&synControls&&0<synControls.length){const controlInfo=synControls.find(function(e){return e.field==outputConfig.dataFieldID});if(1!=$string.isNullOrEmpty(controlInfo.module)){const controlModule=syn.$w.getControlModule(controlInfo.module);0==$object.isNullOrUndefined(controlModule)&&controlModule.clear&&controlModule.clear(controlInfo.id)}}}}else if(syn.uicontrols.$data&&0<syn.uicontrols.$data.storeList.length)for(let k=0;k<syn.uicontrols.$data.storeList.length;k++){const store=syn.uicontrols.$data.storeList[k];if("Form"==store.storeType&&store.dataSourceID==output.dataFieldID){for(let l=0;l<store.columns.length;l++){const column=store.columns[l];output.items[column.data]={fieldID:column.data,dataType:column.dataType||"string"}}if(1==outputConfig.clear){const dataStore=$this.store[store.dataSourceID];dataStore&&(dataStore.length=0)}break}}}else if("Grid"==outputConfig.type){const synControlConfig=synControlList.find(function(e){return e.field==output.dataFieldID&&1==(-1<e.type.indexOf("grid")||-1<e.type.indexOf("chart"))}),controlModule=1==$object.isNullOrUndefined(synControlConfig)?null:syn.$w.getControlModule(synControlConfig.module);if(0==$object.isNullOrUndefined(controlModule)&&controlModule.setTransactionBelongID){if(controlModule.setTransactionBelongID(synControlConfig.id,output),1==outputConfig.clear&&synControls&&0<synControls.length){const controlInfo=synControls.find(function(e){return e.field==output.dataFieldID}),controlModule=syn.$w.getControlModule(controlInfo.module);0==$object.isNullOrUndefined(controlModule)&&controlModule.clear&&controlModule.clear(controlInfo.id)}}else if(synControlConfigs=synControlList.filter(function(e){return e.field==output.dataFieldID&&-1<["chart","chartjs"].indexOf(e.type)}),synControlConfigs&&1==synControlConfigs.length){const synControlConfig=synControlConfigs[0],el=syn.$l.get(synControlConfig.id+"_hidden")||syn.$l.get(synControlConfig.id),synOptions=JSON.parse(el.getAttribute("syn-options"));if(null==synOptions)continue;for(let k=0;k<synOptions.series.length;k++){const column=synOptions.series[k];output.items[column.columnID]={fieldID:column.columnID,dataType:column.dataType||"string"}}if(1==outputConfig.clear&&synControls&&0<synControls.length){const controlInfo=synControls.find(function(e){return e.field==outputConfig.dataFieldID});if(1==$string.isNullOrEmpty(controlInfo.module))continue;const controlModule=syn.$w.getControlModule(controlInfo.module);0==$object.isNullOrUndefined(controlModule)&&controlModule.clear&&controlModule.clear(controlInfo.id)}}else if(syn.uicontrols.$data&&0<syn.uicontrols.$data.storeList.length)for(let k=0;k<syn.uicontrols.$data.storeList.length;k++){const store=syn.uicontrols.$data.storeList[k];if("Grid"==store.storeType&&store.dataSourceID==output.dataFieldID){for(let l=0;l<store.columns.length;l++){const column=store.columns[l];output.items[column.data]={fieldID:column.data,dataType:column.dataType||"string"}}if(1==outputConfig.clear){const dataStore=$this.store[store.dataSourceID];dataStore&&(dataStore.length=0)}break}}}transactionObject.outputs.push(output)}}$this.config.transactions.push(transactionObject)}catch(error){syn.$l.eventLog("$w.tryAddFunction",error,"Error")}}else syn.$l.eventLog("$w.tryAddFunction","{0} 거래 ID 또는 설정 확인 필요".format(transactConfig),"Warning")},transactionAction(e,t){let o=e;if("string"==typeof e){if(!(o=$this?.transaction?.[e]))return void syn.$l.eventLog("$w.transactionAction",`functionID "${e}"에 대한 거래 설정을 찾을 수 없습니다.`,"Warning");o.functionID=o.functionID||e}if(o&&$this?.config)try{let e=!0;var r;(e=$this.hook?.beforeTransaction?$this.hook.beforeTransaction(o):e)??!0?(r=syn.$w.argumentsExtend({message:"",dynamic:"Y",authorize:"N",commandType:"D",returnType:"Json",transactionScope:"N",transactionLog:"Y"},t),o.noProgress=o.noProgress??!1,syn.$w.progressMessage&&!o.noProgress&&syn.$w.progressMessage(r.message),syn.$w.tryAddFunction(o),syn.$w.transaction(o.functionID,(t,r,n)=>{let i=null;if(0<t?.errorText?.length)i=t.errorText[0],syn.$l.eventLog("$w.transactionAction.callback","거래 오류: "+i,"Error");else{let e=null;if("function"==typeof o.callback)try{e=o.callback(i,t,r,n)}catch(e){syn.$l.eventLog("$w.transactionAction.callbackExec","콜백 실행 오류: "+e,"Error")}else Array.isArray(o.callback)&&2===o.callback.length&&setTimeout(()=>{syn.$l.trigger(o.callback[0],o.callback[1],{error:i,result:t,additionalData:r,correlationID:n})},0);null===e||!0===e||Array.isArray(o.callback)?$this.hook?.afterTransaction&&$this.hook.afterTransaction(null,o.functionID,t,r,n):!1===e&&$this.hook?.afterTransaction&&$this.hook.afterTransaction("callbackResult가 false를 반환했습니다",o.functionID,null,null,n)}},r)):(syn.$w.closeProgressMessage&&syn.$w.closeProgressMessage(),$this.hook?.afterTransaction&&$this.hook.afterTransaction("beforeTransaction이 false를 반환했습니다",o.functionID,null,null))}catch(e){syn.$l.eventLog("$w.transactionAction","거래 액션 실행 중 오류 발생: "+e,"Error"),syn.$w.closeProgressMessage&&syn.$w.closeProgressMessage()}else syn.$l.eventLog("$w.transactionAction","거래 설정이 유효하지 않거나 $this 컨텍스트가 없습니다.","Warning")},transactionDirect(r,o,s){return r?new Promise((n,i)=>{syn.$w.progressMessage&&!0!==r.noProgress&&syn.$w.progressMessage();var e=syn.$w.transactionObject(r.functionID,"Json"),t=(e.programID=r.programID||syn.Config.ApplicationID,e.moduleID=r.moduleID||("browser"===globalRoot.devicePlatform?location.pathname.split("/").filter(Boolean)[0]:void 0)||syn.Config.ModuleID,e.businessID=r.businessID||syn.Config.ProjectID,e.systemID=r.systemID||globalRoot.$this?.config?.systemID||syn.Config.SystemID,e.transactionID=r.transactionID,e.dataMapInterface=r.dataMapInterface||"Row|Form",e.transactionResult=r.transactionResult??!0,e.screenID="node"===globalRoot.devicePlatform?r.screenID||r.transactionID:syn.$w.pageScript?.replace("$","")??"",e.startTraceID=r.startTraceID||s?.startTraceID||"",e.inputObjects=r.inputObjects||[],syn.$w.argumentsExtend({message:"",dynamic:"Y",authorize:"N",commandType:"D",returnType:"Json",transactionScope:"N",transactionLog:"Y"},s));e.options=t,0<r.inputLists?.length?(e.inputs.push(...r.inputLists),e.inputsItemCount.push(r.inputLists.length)):r.inputObjects&&(e.inputs.push(r.inputObjects),e.inputsItemCount.push(1)),syn.$w.executeTransaction(r,e,(e,t)=>{if(o)try{o(e,t)}catch(e){var r=new Error("콜백 오류: "+e);return syn.$l.eventLog("$w.transactionDirect.callback",r.message,"Error"),void i(r)}e&&e.errorText?i(new Error(e.errorText)):n({responseData:e,additionalData:t})})}):(syn.$l.eventLog("$w.transactionDirect","directObject 파라미터가 필요합니다.","Error"),Promise.reject(new Error("directObject 파라미터가 필요합니다.")))},transaction(S,_,e){let x="";try{syn.$w.domainTransactionLoaderStart&&syn.$w.domainTransactionLoaderStart(),(e=syn.$w.argumentsExtend({message:"",dynamic:"Y",authorize:"N",commandType:"D",returnType:"Json",transactionScope:"N",transactionLog:"Y"},e))&&syn.$w.progressMessage&&syn.$w.progressMessage(e.message);const R={errorText:[],outputStat:[]};if($this&&$this.config&&$this.config.transactions){var t=$this.config.transactions.filter(function(e){return e.functionID==S});if(1==t.length){const A=t[0];var r=syn.$w.transactionObject(A.functionID,"Json"),o=(r.programID=$this.config.programID,r.businessID=$this.config.businessID,r.systemID=$this.config.systemID,r.transactionID=$this.config.transactionID,r.screenID=syn.$w.pageScript.replace("$",""),r.startTraceID=e.startTraceID||"",r.options=e,$this.context.synControls),i=A.inputs.length;for(let e=0;e<i;e++){const T=A.inputs[e];let i=[];if("Row"==T.requestType){let n=o.filter(function(e){return e.field==T.dataFieldID});if(1==n.length){var s=n[0];if(-1<s.type.indexOf("grid")||-1<s.type.indexOf("chart")){const N=T.dataFieldID;if(o&&0<o.length)if(1==(n=o.filter(function(e){return e.field==N})).length){var a=n[0],l=syn.$w.getControlModule(a.module),F=syn.$l.get(a.id+"_hidden")||syn.$l.get(a.id),c=JSON.parse(F.getAttribute("syn-options"));for(let e=0;e<c.columns.length;e++){var u=c.columns[e];if(u.validators&&$validation.transactionValidate)if(u.controlText=c.controlText||"",0==$validation.transactionValidate(l,a,u,T.requestType))return $this.hook.afterTransaction&&$this.hook.afterTransaction("validators continue false",S,u,null),syn.$w.domainTransactionLoaderEnd&&syn.$w.domainTransactionLoaderEnd(),!1}0==$object.isNullOrUndefined(l)&&l.getValue&&(i=l.getValue(a.id.replace("_hidden",""),"Row",T.items)[0])}else syn.$l.eventLog("$w.transaction",'"{0}" Row List Input Mapping 확인 필요'.format(N),"Warning")}else for(const O in T.items){var d=T.items[O];const I=O;var H=d.fieldID,h=d.dataType,p={prop:H,val:""};let e="";if(0<o.length){if(1!=(n=o.filter(function(e){return e.field==I&&e.formDataFieldID==T.dataFieldID})).length){syn.$l.eventLog("$w.transaction",'"{0}" Row Control Input Mapping 확인 필요'.format(I),"Warning");continue}var f=n[0];if(1==$object.isNullOrUndefined(f.module))e=syn.$l.get(f.id).value;else{var g=syn.$w.getControlModule(f.module),U=syn.$l.get(f.id+"_hidden")||syn.$l.get(f.id),m=JSON.parse(U.getAttribute("syn-options"));if(m.validators&&$validation.transactionValidate)if(0==$validation.transactionValidate(g,f,m,T.requestType))return $this.hook.afterTransaction&&$this.hook.afterTransaction("validators continue false",S,m,null),syn.$w.domainTransactionLoaderEnd&&syn.$w.domainTransactionLoaderEnd(),!1;0==$object.isNullOrUndefined(g)&&g.getValue&&(e=g.getValue(f.id.replace("_hidden",""),d)),1!=$object.isNullOrUndefined(e)||"number"!=h&&"numeric"!=h||(e=0)}}p.val=e,i.push(p)}}else if(syn.uicontrols.$data&&0<syn.uicontrols.$data.storeList.length)for(const M in T.items){let t=!1;var y=T.items[M];const k=M;var V=y.fieldID,v=y.dataType,W={prop:V,val:""};let r="";for(let e=0;e<syn.uicontrols.$data.storeList.length;e++){var $,b=syn.uicontrols.$data.storeList[e];if("Form"==b.storeType&&b.dataSourceID==T.dataFieldID){t=!0,1==(n=b.columns.filter(function(e){return e.data==k})).length?($=n[0],r=$this.store[b.dataSourceID][$.data],1!=$object.isNullOrUndefined(r)||"number"!=v&&"numeric"!=v||(r=0),1==$object.isNullOrUndefined(r)&&(r="")):syn.$l.eventLog("$w.transaction",'"{0}" Row Input Mapping 확인 필요'.format(k),"Warning");break}}1==t?(W.val=r,i.push(W)):syn.$l.eventLog("$w.transaction","{0} Row 컨트롤 ID 중복 또는 존재여부 확인 필요".format(T.dataFieldID),"Warning")}r.inputs.push(i),r.inputsItemCount.push(1)}else if("List"==T.requestType){const D=T.dataFieldID;if(o&&0<o.length){var B=o.filter(function(e){return e.field==D});if(1==B.length){var n=B[0],w=syn.$w.getControlModule(n.module),j=syn.$l.get(n.id+"_hidden")||syn.$l.get(n.id),C=JSON.parse(j.getAttribute("syn-options"));for(let e=0;e<C.columns.length;e++){var E=C.columns[e];if(E.controlText=C.controlText||"",E.validators&&$validation.transactionValidate)if(0==$validation.transactionValidate(w,n,E,T.requestType))return $this.hook.afterTransaction&&$this.hook.afterTransaction("validators continue false",S,E,null),syn.$w.domainTransactionLoaderEnd&&syn.$w.domainTransactionLoaderEnd(),!1}0==$object.isNullOrUndefined(w)&&w.getValue&&(i=w.getValue(n.id.replace("_hidden",""),"List",T.items))}else{let t=!1;if(syn.uicontrols.$data&&0<syn.uicontrols.$data.storeList.length)for(let e=0;e<syn.uicontrols.$data.storeList.length;e++){const P=syn.uicontrols.$data.storeList[e];if("Grid"==P.storeType&&P.dataSourceID==D){t=!0;var z=syn.uicontrols.$data.bindingList.find(function(e){return e.dataSourceID==P.dataSourceID&&"grid"==e.controlType});if(z)i=$this.store[P.dataSourceID][z.dataFieldID];else{var Y=[],G=$this.store[P.dataSourceID],q=G.length;for(let e=0;e<q;e++){var K=G[e],X=[];for(const L in K){var J={prop:L,val:K[L]};X.push(J)}Y.push(X)}i=Y}break}}0==t&&syn.$l.eventLog("$w.transaction",'"{0}" List Input Mapping 확인 필요'.format(D),"Warning")}}for(const Z in i)r.inputs.push(i[Z]);r.inputsItemCount.push(i.length)}}syn.$w.executeTransaction($this.config,r,function(t,e,r){let n=!1;for(let e=0;e<A.outputs.length;e++)if("Dynamic"==A.outputs[e].responseType){n=!0;break}if(1==n)R.outputStat.push({fieldID:"Dynamic",count:1,dynamicData:t});else if(t.length==A.outputs.length){var i=$this.context.synControls,o=A.outputs.length;for(let e=0;e<o;e++){const v=A.outputs[e];var s=t[e],a=s.id,l=s.value;if($this.hook.outputDataBinding&&$this.hook.outputDataBinding(S,a,l),"Form"==v.responseType)if(1==$object.isNullOrUndefined(l)||1==$object.isObjectEmpty(l))R.outputStat.push({fieldID:a,Count:0});else{R.outputStat.push({fieldID:a,Count:1});for(const b in v.items){var c=v.items[b];const w=b;var u=l[c.fieldID];if(null!=u&&i&&0<i.length){let r=i.filter(function(e){return e.field==w&&e.formDataFieldID==v.dataFieldID});if(1==r.length){var d=r[0],h=syn.$w.getControlModule(d.module);0==$object.isNullOrUndefined(h)&&h.setValue&&h.setValue(d.id.replace("_hidden",""),u,c)}else{let t=!1;if(syn.uicontrols.$data&&0<syn.uicontrols.$data.storeList.length)for(let e=0;e<syn.uicontrols.$data.storeList.length;e++){var p=syn.uicontrols.$data.storeList[e];if(1==$object.isNullOrUndefined($this.store[p.dataSourceID])&&($this.store[p.dataSourceID]={}),"Form"==p.storeType&&p.dataSourceID==v.dataFieldID){t=!0,1==(r=p.columns.filter(function(e){return e.data==w})).length&&($this.store[p.dataSourceID][w]=u);break}}0==t&&(x='"{0}" Form Output Mapping 확인 필요'.format(w),R.errorText.push(x),syn.$l.eventLog("$w.transaction",x,"Error"))}}}}else if("Grid"==v.responseType){R.outputStat.push({fieldID:a,Count:l.length});const C=v.dataFieldID;if(i&&0<i.length){var s=i.filter(function(e){return e.field==C});if(1==s.length){var s=s[0],f=syn.$w.getControlModule(s.module);0==$object.isNullOrUndefined(f)&&f.setValue&&f.setValue(s.id.replace("_hidden",""),l,v.items)}else{let t=!1;if(syn.uicontrols.$data&&0<syn.uicontrols.$data.storeList.length)for(let e=0;e<syn.uicontrols.$data.storeList.length;e++){const E=syn.uicontrols.$data.storeList[e];if(1==$object.isNullOrUndefined($this.store[E.dataSourceID])&&($this.store[E.dataSourceID]=[]),"Grid"==E.storeType&&E.dataSourceID==v.dataFieldID){t=!0;var g=syn.uicontrols.$data.bindingList.filter(function(e){return e.dataSourceID==E.dataSourceID&&"grid"==e.controlType}),m=l.length;for(let e=0;e<m;e++)l[e].Flag="R";if(0<g.length)for(let e=0;e<g.length;e++){var y=g[e];$this.store[E.dataSourceID][y.dataFieldID]=l}else $this.store[E.dataSourceID]=l;break}}0==t&&(x='"{0}" Grid Output Mapping 확인 필요'.format(C),R.errorText.push(x),syn.$l.eventLog("$w.transaction",x,"Error"))}}}else if("Chart"==v.responseType){R.outputStat.push({fieldID:a,Count:l.length});const T=v.dataFieldID;i&&0<i.length&&(1==(f=i.filter(function(e){return e.field==T})).length?(s=f[0],a=syn.$w.getControlModule(s.module),0==$object.isNullOrUndefined(a)&&a.setValue&&a.setValue(s.id.replace("_hidden",""),l,v.items)):(x='"{0}" Chart Output Mapping 확인 필요'.format(T),R.errorText.push(x),syn.$l.eventLog("$w.transaction",x,"Error")))}}}else x='"{0}" 기능의 거래 응답 정의와 데이터 갯수가 다릅니다'.format(A.functionID),R.errorText.push(x),syn.$l.eventLog("$w.transaction",x,"Error");_&&_(R,e,r),syn.$w.domainTransactionLoaderEnd&&syn.$w.domainTransactionLoaderEnd()})}else x='"{0}" 거래 중복 또는 존재여부 확인 필요'.format(S),R.errorText.push(x),syn.$l.eventLog("$w.transaction",x,"Error"),_&&_(R),syn.$w.domainTransactionLoaderEnd&&syn.$w.domainTransactionLoaderEnd()}else x="화면 매핑 정의 데이터가 없습니다",R.errorText.push(x),syn.$l.eventLog("$w.transaction",x,"Error"),_&&_(R),syn.$w.domainTransactionLoaderEnd&&syn.$w.domainTransactionLoaderEnd()}catch(e){syn.$l.eventLog("$w.transaction",e,"Error"),syn.$w.domainTransactionLoaderEnd&&syn.$w.domainTransactionLoaderEnd()}},getterValue(t){try{var r=$this.transaction[t];if(1!=$object.isNullOrUndefined(r)){1==$string.isNullOrEmpty(r.functionID)&&(r.functionID=t),syn.$w.tryAddFunction(r);let e="";const result={errors:[],inputs:[]};if($this&&$this.config&&$this.config.transactions){var n=$this.config.transactions.filter(function(e){return e.functionID==t});if(1==n.length){var o=n[0],s=context[syn.$w.pageScript].context.synControls,i=o.inputs.length;for(let e=0;e<i;e++){const N=o.inputs[e];let i=[];if("Row"==N.requestType){let n=s.filter(function(e){return e.field==N.dataFieldID});if(1==n.length){var a=n[0];if(-1<a.type.indexOf("grid")||-1<a.type.indexOf("chart")){const O=N.dataFieldID;var l,c;s&&0<s.length&&(1==(n=s.filter(function(e){return e.field==O})).length?(l=n[0],c=syn.$w.getControlModule(l.module),0==$object.isNullOrUndefined(c)&&c.getValue&&(i=c.getValue(l.id.replace("_hidden",""),"Row",N.items)[0])):syn.$l.eventLog("$w.getterValue",'"{0}" Row List Input Mapping 확인 필요'.format(O),"Warning"))}else for(const I in N.items){var u=N.items[I];const M=I;var H=u.fieldID,d=u.dataType,h={prop:H,val:""};let e="";if(0<s.length){if(1!=(n=s.filter(function(e){return e.field==M&&e.formDataFieldID==N.dataFieldID})).length){syn.$l.eventLog("$w.getterValue",'"{0}" Row Control Input Mapping 확인 필요'.format(M),"Warning");continue}var p=n[0],f=syn.$w.getControlModule(p.module);0==$object.isNullOrUndefined(f)&&f.getValue&&(e=f.getValue(p.id.replace("_hidden",""),u)),1!=$object.isNullOrUndefined(e)||"number"!=d&&"numeric"!=d||(e=0)}h.val=e,i.push(h)}}else if(syn.uicontrols.$data&&0<syn.uicontrols.$data.storeList.length)for(const k in N.items){let t=!1;var g=N.items[k];const D=k;var U=g.fieldID,m=g.dataType,y={prop:U,val:""};let r="";for(let e=0;e<syn.uicontrols.$data.storeList.length;e++){var v,b=syn.uicontrols.$data.storeList[e];if("Form"==b.storeType&&b.dataSourceID==N.dataFieldID){t=!0,1==(n=b.columns.filter(function(e){return e.data==D})).length?(v=n[0],r=$this.store[b.dataSourceID][v.data],1!=$object.isNullOrUndefined(r)||"number"!=m&&"numeric"!=m||(r=0),1==$object.isNullOrUndefined(r)&&(r="")):syn.$l.eventLog("$w.getterValue",'"{0}" Row Input Mapping 확인 필요'.format(D),"Warning");break}}1==t?(y.val=r,i.push(y)):syn.$l.eventLog("$w.getterValue","{0} Row 컨트롤 ID 중복 또는 존재여부 확인 필요".format(N.dataFieldID),"Warning")}var w={};for(let e=0;e<i.length;e++){var C=i[e];w[C.prop]=C.val}result.inputs.push(w)}else if("List"==N.requestType){const P=N.dataFieldID;if(s&&0<s.length){var E=s.filter(function(e){return e.field==P});if(1==E.length){var T=E[0],S=syn.$w.getControlModule(T.module);0==$object.isNullOrUndefined(S)&&S.getValue&&(i=S.getValue(T.id.replace("_hidden",""),"List",N.items))}else{let t=!1;if(syn.uicontrols.$data&&0<syn.uicontrols.$data.storeList.length)for(let e=0;e<syn.uicontrols.$data.storeList.length;e++){const L=syn.uicontrols.$data.storeList[e];if("Grid"==L.storeType&&L.dataSourceID==P){t=!0;var _=syn.uicontrols.$data.bindingList.find(function(e){return e.dataSourceID==L.dataSourceID&&"grid"==e.controlType});if(_)i=$this.store[L.dataSourceID][_.dataFieldID];else{var x=[],R=$this.store[L.dataSourceID],V=R.length;for(let e=0;e<V;e++){var A=R[e],W=[];for(const F in A){var $={prop:F,val:A[F]};W.push($)}x.push(W)}i=x}break}}0==t&&syn.$l.eventLog("$w.getterValue",'"{0}" List Input Mapping 확인 필요'.format(P),"Warning")}}for(const Y in i){var B={},j=i[Y];for(let e=0;e<j.length;e++){var z=j[e];B[z.prop]=z.val}result.inputs.push(B)}}}}else e='"{0}" 거래 중복 또는 존재여부 확인 필요'.format(t),result.errors.push(e),syn.$l.eventLog("$w.getterValue",e,"Error")}else e="화면 매핑 정의 데이터가 없습니다",result.errors.push(e),syn.$l.eventLog("$w.getterValue",e,"Error");return result}syn.$l.eventLog("$w.getterValue",'functionID "{0}" 확인 필요'.format(t),"Warning")}catch(e){return syn.$l.eventLog("$w.getterValue",e,"Error"),result.errors.push(e.message),result}},setterValue(t,r){try{var e=$this.transaction[t];if(1!=$object.isNullOrUndefined(e)){1==$string.isNullOrEmpty(e.functionID)&&(e.functionID=t),syn.$w.tryAddFunction(e);let n="";const result={errors:[],outputs:[]};if($this&&$this.config&&$this.config.transactions){var i=$this.config.transactions.filter(function(e){return e.functionID==t});if(1==i.length){var o=i[0],s=context[syn.$w.pageScript].context.synControls,a=o.outputs.length;for(let e=0;e<a;e++){const S=o.outputs[e];var l,c,u,d=S.responseType+"Data"+e.toString(),h=r[e];if("Form"==S.responseType)if(1==$object.isNullOrUndefined(h)||1==$object.isObjectEmpty(h))result.outputs.push({fieldID:d,Count:0});else{result.outputs.push({fieldID:d,Count:1});for(const _ in S.items){var p=S.items[_];const x=_;var f=h[p.fieldID];if(null!=f&&s&&0<s.length){let r=s.filter(function(e){return e.field==x&&e.formDataFieldID==S.dataFieldID});if(1==r.length){var g=r[0],m=syn.$w.getControlModule(g.module);0==$object.isNullOrUndefined(m)&&m.setValue&&m.setValue(g.id.replace("_hidden",""),f,p)}else{let t=!1;if(syn.uicontrols.$data&&0<syn.uicontrols.$data.storeList.length)for(let e=0;e<syn.uicontrols.$data.storeList.length;e++){var y=syn.uicontrols.$data.storeList[e];if(1==$object.isNullOrUndefined($this.store[y.dataSourceID])&&($this.store[y.dataSourceID]={}),"Form"==y.storeType&&y.dataSourceID==S.dataFieldID){t=!0,1==(r=y.columns.filter(function(e){return e.data==x})).length&&($this.store[y.dataSourceID][x]=f);break}}0==t&&(n='"{0}" Form Output Mapping 확인 필요'.format(x),result.errors.push(n),syn.$l.eventLog("$w.setterValue",n,"Error"))}}}}else if("Grid"==S.responseType)if(h.length&&0<h.length){result.outputs.push({fieldID:d,Count:h.length});const R=S.dataFieldID;if(s&&0<s.length){var v=s.filter(function(e){return e.field==R});if(1==v.length){var b=v[0],w=syn.$w.getControlModule(b.module);0==$object.isNullOrUndefined(w)&&w.setValue&&w.setValue(b.id.replace("_hidden",""),h,S.items)}else{let t=!1;if(syn.uicontrols.$data&&0<syn.uicontrols.$data.storeList.length)for(let e=0;e<syn.uicontrols.$data.storeList.length;e++){const A=syn.uicontrols.$data.storeList[e];if(1==$object.isNullOrUndefined($this.store[A.dataSourceID])&&($this.store[A.dataSourceID]=[]),"Grid"==A.storeType&&A.dataSourceID==S.dataFieldID){t=!0;var C=syn.uicontrols.$data.bindingList.filter(function(e){return e.dataSourceID==A.dataSourceID&&"grid"==e.controlType}),E=h.length;for(let e=0;e<E;e++)h[e].Flag="R";if(0<C.length)for(let e=0;e<C.length;e++){var T=C[e];$this.store[A.dataSourceID][T.dataFieldID]=h}else $this.store[A.dataSourceID]=h;break}}0==t&&(n='"{0}" Grid Output Mapping 확인 필요'.format(R),result.errors.push(n),syn.$l.eventLog("$w.setterValue",n,"Error"))}}}else result.outputs.push({fieldID:d,Count:0});else if("Chart"==S.responseType)if(h.length&&0<h.length){result.outputs.push({fieldID:d,Count:h.length});const N=S.dataFieldID;s&&0<s.length&&(1==(l=s.filter(function(e){return e.field==N})).length?(c=l[0],u=syn.$w.getControlModule(c.module),0==$object.isNullOrUndefined(u)&&u.setValue&&u.setValue(c.id.replace("_hidden",""),h,S.items)):(n='"{0}" Chart Output Mapping 확인 필요'.format(N),result.errors.push(n),syn.$l.eventLog("$w.setterValue",n,"Error")))}else result.outputs.push({fieldID:d,Count:0})}}else n='"{0}" 거래 중복 또는 존재여부 확인 필요'.format(t),result.errors.push(n),syn.$l.eventLog("$w.setterValue",n,"Error")}else n="화면 매핑 정의 데이터가 없습니다",result.errors.push(n),syn.$l.eventLog("$w.setterValue",n,"Error");return result}syn.$l.eventLog("$w.setterValue",'functionID "{0}" 확인 필요'.format(t),"Warning")}catch(e){return syn.$l.eventLog("$w.setterValue",e,"Error"),result.errors.push(e.message),result}},scrollToTop(){if(doc?.documentElement&&context.requestAnimationFrame&&context.scrollTo){const t=()=>{var e=doc.documentElement.scrollTop||doc.body.scrollTop;0<e&&(context.requestAnimationFrame(t),context.scrollTo(0,e-e/8))};context.requestAnimationFrame(t)}},setFavicon(t){if(doc){let e=doc.querySelector('link[rel="icon"]');e?e.href=t:((e=doc.createElement("link")).rel="icon",e.href=t,doc.head?.appendChild(e))}},fileDownload(t,e){if(doc&&t){e=e||t.substring(t.lastIndexOf("/")+1).split(".")[0]||"download";const r=doc.createElement("a");r.href=t,r.download=e,r.style.display="none",doc.body.appendChild(r);try{r.click()}catch(e){syn.$l.eventLog("$w.fileDownload",t+" 다운로드 실행 오류: "+e,"Error")}finally{setTimeout(()=>doc.body.removeChild(r),100)}}},sleep(t,e){if("function"==typeof e)return setTimeout(e,t);if("undefined"!=typeof Promise)return new Promise(e=>setTimeout(e,t));syn.$l.eventLog("$w.sleep","콜백 또는 Promise 지원이 필요합니다.","Debug");for(var r=Date.now();Date.now()<r+t;);},purge(t){if(t){var r=t.attributes;if(r)for(let e=r.length-1;0<=e;e--){var n=r[e].name;if(n.startsWith("on")&&"function"==typeof t[n])try{t[n]=null}catch(e){}}let e=t.firstChild;for(;e;)syn.$w.purge(e),e=e.nextSibling;syn.$l?.events?.removeAllForElement&&syn.$l.events.removeAllForElement(t)}},setServiceObject(e){return syn.$w.serviceObject="string"==typeof e?e:JSON.stringify(e),this},setServiceClientHeader(e){return e.setRequestHeader("CertificationKey","SGFuZFN0YWNr"),!0},xmlParser(e){if("undefined"==typeof DOMParser)return syn.$l.eventLog("$w.xmlParser","이 환경에서는 DOMParser가 지원되지 않습니다.","Error"),null;try{return(new DOMParser).parseFromString(e,"text/xml")}catch(e){return syn.$l.eventLog("$w.xmlParser","XML 파싱 오류: "+e,"Error"),null}},apiHttp(c){return new Proxy({},{get(e,l){return async function(e,t){if(-1==["send"].indexOf(l))return Promise.resolve({error:l+" 메서드 확인 필요"});t=syn.$w.argumentsExtend({method:"GET"},t);var r,n=null;if(0==$object.isNullOrUndefined(e)&&0==$object.isString(e)){if("GET"==t.method||"HEAD"==t.method?t.method="POST":t.method=t.method||"POST",1==$object.isNullOrUndefined(t.headers)&&(t.headers=new Headers,e instanceof FormData||t.headers.append("Content-Type",t.contentType||"application/json")),syn.Environment&&(r=syn.Environment).Header)for(var i in r.Header)0==t.headers.has(i)&&t.headers.append(i,r.Header[i]);0==t.headers.has("OffsetMinutes")&&t.headers.append("OffsetMinutes",syn.$w.timezoneOffsetMinutes);var o={method:t.method,headers:t.headers,body:e instanceof FormData?e:JSON.stringify(e),redirect:"follow"},s=(0==$object.isNullOrUndefined(t.timeout)&&(a=new AbortController,n=setTimeout(()=>a.abort(),t.timeout),o.signal=a.signal),await fetch(c,o))}else{if(1==$object.isNullOrUndefined(t.headers)&&(t.headers=new Headers,t.headers.append("Content-Type",t.contentType||"application/json")),syn.Environment&&(r=syn.Environment).Header)for(var i in r.Header)0==t.headers.has(i)&&t.headers.append(i,r.Header[i]);0==t.headers.has("OffsetMinutes")&&t.headers.append("OffsetMinutes",syn.$w.timezoneOffsetMinutes);var a,o={method:t.method,headers:t.headers,redirect:"follow"},s=(0==$object.isNullOrUndefined(t.timeout)&&(a=new AbortController,n=setTimeout(()=>a.abort(),t.timeout),o.signal=a.signal),await fetch(c,o))}n&&clearTimeout(n);e={error:"요청 정보 확인 필요"};return 1==s.ok?e=1==(o=s.headers.get("Content-Type")||"").includes("application/json")?await s.json():1==o.includes("text/")?await s.text():await s.blob():(e={error:`상태: ${s.status}, 텍스트: `+await s.text()},syn.$l.eventLog("$w.apiHttp","API HTTP 오류: "+e.error,"Error")),Promise.resolve(e)}}})},xmlHttp(){return new globalRoot.XMLHttpRequest},loadScript(e,t,r){document.getElementsByTagName("head")||document.documentElement.insertBefore(document.createElement("head"),document.documentElement.firstChild);var n,i=document.getElementsByTagName("head")[0],t=t||"id_"+syn.$l.random();return document.getElementById(t)?r():((n=document.createElement("script")).setAttribute("type","text/javascript"),n.setAttribute("id",t),syn.Config&&1==$string.toBoolean(syn.Config.IsClientCaching)?n.setAttribute("src",e):n.setAttribute("src",e+(-1<e.indexOf("?")?"&":"?")+"noCache="+(new Date).getTime()),r&&"function"==typeof r&&(n.onload=function(){r()}),i.insertBefore(n,i.firstChild)),$webform},loadStyle(e,t,r){document.getElementsByTagName("head")||document.documentElement.insertBefore(document.createElement("head"),document.documentElement.firstChild);var n,i=document.getElementsByTagName("head")[0],t=t||"id_"+syn.$l.random();return document.getElementById("scriptID")||((n=document.createElement("link")).setAttribute("rel","stylesheet"),n.setAttribute("type","text/css"),n.setAttribute("id",t),syn.Config&&1==$string.toBoolean(syn.Config.IsClientCaching)?n.setAttribute("href",e):n.setAttribute("href",e+(-1<e.indexOf("?")?"&":"?")+"noCache="+(new Date).getTime()),i.appendChild(n)),r&&"function"==typeof r&&r(),$webform},async fetchScript(moduleUrl){var result=null,moduleName,moduleScript,moduleName=1<moduleUrl.split("/").length?(moduleName=moduleUrl.split("/")[location.pathname.split("/").length-1],2==moduleName.split(".").length?-1<moduleName.indexOf(".")?moduleName.substring(0,moduleName.indexOf(".")):moduleName:""):moduleUrl,module;if(moduleName=moduleName.replaceAll("-","_"),0==$string.isNullOrEmpty(moduleName))try{if("object"==eval("typeof $"+moduleName))var $module=new syn.module,module=$module.extend(eval("$"+moduleName));else{var moduleScript=syn.Config&&1==syn.Config.IsClientCaching?await syn.$w.fetchText(moduleUrl+".js"):await syn.$w.fetchText(moduleUrl+".js?tick="+(new Date).getTime()),isBase64=function(e){var t=!1;return t=e&&32<e.length&&1==/^[A-Za-z0-9+/]+={0,2}$/.test(e.substring(0,32))?!0:t},moduleFunction;if(1==isBase64(moduleScript)){var decodeError=null,decodeScript;try{decodeScript=syn.$c.LZString.decompressFromBase64(moduleScript),null==decodeScript&&(decodeError="LZString decompress 오류")}catch{decodeError="LZString decompress 오류"}if(decodeError)try{decodeScript=syn.$c.base64Decode(moduleScript),decodeError=null}catch{decodeError="base64Decode 오류"}decodeError?syn.$l.eventLog("$w.fetchScript",decodeError+` 오류, <script src="${moduleUrl}.js"></script> 문법 확인이 필요합니다`,"Error"):moduleScript=decodeScript}module=moduleScript?(moduleFunction="return (function(){var module={};(function(window,module){'use strict';"+moduleScript+";var $module=new syn.module();$module.extend($"+moduleName+");module.exports=$module;})(typeof window!=='undefined'?window:{},typeof module!=='undefined'?module:{});return module.exports;})();",new Function(moduleFunction).call(globalRoot)):new syn.module}if(module.extends&&1==$object.isArray(module.extends))for(var i=0;i<module.extends.length;i++){var name=module.extends[i],result=await syn.$w.fetchText(name+".js"),moduleText=result.substring(result.indexOf("{"),result.lastIndexOf("}")+1),base=eval("("+moduleText+")"),$base=new syn.module;$base.extend(base),module=syn.$w.argumentsExtend($base,module),module.config=syn.$w.argumentsExtend($base.config,module.config),module.prop=syn.$w.argumentsExtend($base.prop,module.prop),module.hook=syn.$w.argumentsExtend($base.hook,module.hook),module.event=syn.$w.argumentsExtend($base.event,module.event),module.model=syn.$w.argumentsExtend($base.model,module.model),module.transaction=syn.$w.argumentsExtend($base.transaction,module.transaction),module.method=syn.$w.argumentsExtend($base.method,module.method),module.message=syn.$w.argumentsExtend($base.message,module.message),$base.hook&&$base.hook.extendLoad&&base.hook.extendLoad(module)}result=module}catch(error){syn.$l.eventLog("$w.fetchScript","스크립트 로드 오류: "+error,"Warning"),moduleScript&&syn.$l.eventLog("$w.fetchScript",'<script src="{0}.js"><\/script> 문법 확인이 필요합니다'.format(moduleUrl),"Error")}return result},async fetchText(t){var e,r={method:"GET",mode:"cors",cache:"default",credentials:"same-origin",headers:{"Content-Type":"text/plain"},redirect:"follow",referrerPolicy:"no-referrer-when-downgrade"},r=syn.$w.getFetchClientOptions?syn.$w.getFetchClientOptions(r):r,n=!1===syn.Config?.IsClientCaching?`${t.includes("?")?"&":"?"} tick = `+Date.now():"",t=t+n;try{const i=await fetch(t,r);return i.ok?await i.text():(e=await i.text().catch(()=>`HTTP ${i.status} `+i.statusText),syn.$l.eventLog("$w.fetchText",t+` Fetch 실패: 상태 ${i.status}, 텍스트: `+e,"Warning"),null)}catch(e){throw syn.$l.eventLog("$w.fetchText",t+" Fetch 오류: "+e,"Error"),e}},async fetchJson(t){var e,r,n={method:"GET",mode:"cors",cache:"default",credentials:"same-origin",headers:{"Content-Type":"application/json",Accept:"application/json"},redirect:"follow",referrerPolicy:"no-referrer-when-downgrade"},n=syn.$w.getFetchClientOptions?syn.$w.getFetchClientOptions(n):n,i=!1===syn.Config?.IsClientCaching?`${t.includes("?")?"&":"?"} tick = `+Date.now():"",t=t+i;try{const o=await fetch(t,n);return o.ok?((r=o.headers.get("Content-Type")||"").includes("application/json")||syn.$l.eventLog("$w.fetchJson",t+`에서 JSON을 예상했지만 Content - Type: ${r}을 받았습니다.`,"Warning"),await o.json()):(e=await o.text().catch(()=>`HTTP ${o.status} `+o.statusText),syn.$l.eventLog("$w.fetchJson",t+` Fetch 실패: 상태 ${o.status}, 텍스트: `+e,"Warning"),null)}catch(e){return e instanceof SyntaxError?syn.$l.eventLog("$w.fetchJson",t+" JSON 파싱 오류: "+e,"Error"):syn.$l.eventLog("$w.fetchJson",t+" Fetch 오류: "+e,"Error"),null}},transactionObject(e,t="Json"){e={programID:"",businessID:"",systemID:"",transactionID:"",dataMapInterface:null,transactionResult:!0,functionID:e,screenID:"",startTraceID:"",requestID:null,returnType:t,resultAlias:[],inputsItemCount:[],inputs:[]};return syn.$w.setServiceObject&&syn.$w.setServiceObject(e),e},dynamicType:Object.freeze({DataSet:"0",Json:"1",Scalar:"2",NonQuery:"3",SQLText:"4",SchemeOnly:"5",CodeHelp:"6",Xml:"7",DynamicJson:"8"}),async executeTransaction(m,y,v,o,s){const b=y?.fallback||function(){};if(1==$object.isNullOrUndefined(m)||1==$object.isNullOrUndefined(y))"browser"===globalRoot.devicePlatform&&alert("서비스 호출에 필요한 거래 정보가 구성되지 않았습니다"),syn.$l.eventLog("$w.executeTransaction","서비스 호출에 필요한 거래 정보 확인 필요","Error"),b(m,y);else{var a=syn.Config.SystemID+syn.Config.Environment.substring(0,1)+(1==$string.isNullOrEmpty(syn.Config.LoadModuleID)?"":syn.Config.LoadModuleID);let n=null,i=syn.$w.getStorage("apiServices",!1);if("node"===globalRoot.devicePlatform?i&&(n=i[a])?1==$object.isNullOrUndefined(i.BearerToken)&&globalRoot.bearerToken&&(i.BearerToken=globalRoot.bearerToken,syn.$w.setStorage("apiServices",i,!1)):null!=syn.Config.DomainAPIServer?(n=syn.Config.DomainAPIServer,i=i||{},(s||globalRoot.bearerToken)&&(i.BearerToken=s||globalRoot.bearerToken),i[a]=n,syn.$w.setStorage("apiServices",i,!1)):(syn.$l.eventLog("$w.executeTransaction","서비스 호출에 필요한 DomainAPIServer 정보 확인 필요","Error"),b(m,y)):i&&(n=i[a])?null!=i.BearerToken&&null!=i.BearerToken||!window.bearerToken||(i.BearerToken=window.bearerToken,syn.$w.setStorage("apiServices",i,!1)):null!=syn.Config.DomainAPIServer?(n=syn.Config.DomainAPIServer,i=i||{},window.bearerToken&&(i.BearerToken=window.bearerToken),i[a]=n,syn.$w.setStorage("apiServices",i,!1)):(syn.$l.eventLog("$w.executeTransaction","서비스 호출에 필요한 DomainAPIServer 정보 확인 필요","Error"),b(m,y)),i=syn.$w.getStorage("apiServices",!1),null==(n=i?i[a]:n))syn.$l.eventLog("$w.executeTransaction","apiService 확인 필요","Fatal"),b(m,y);else if(n.exceptionText)syn.$l.eventLog("$w.executeTransaction","apiService 확인 필요 SystemID: {0}, ServerType: {1}, Message: {2}".format(m.systemID,syn.Config.Environment.substring(0,1),n.exceptionText),"Fatal"),b(m,y);else{let e=syn.$w.getStorage("ipAddress",!1),t=(1==$object.isNullOrUndefined(e)&&0==$string.isNullOrEmpty(syn.Config.FindClientIPServer)&&(e=await syn.$r.httpFetch(syn.Config.FindClientIPServer||"/checkip").send(null,{method:"GET",redirect:"follow",timeout:3e3})),1==$object.isNullOrUndefined(e)&&(e="localhost"),syn.$w.setStorage("ipAddress",e,!1),"");t=n.Port&&""!=n.Port?"{0}://{1}:{2}{3}".format(n.Protocol,n.IP,n.Port,n.Path):"{0}://{1}{2}".format(n.Protocol,n.IP,n.Path);var a=syn.$w.Variable&&syn.$w.Variable.InstallType?syn.$w.Variable.InstallType:"L",l=syn.Config&&syn.Config.Environment?syn.Config.Environment.substring(0,1):"D",c=syn.Config&&syn.Config.Transaction?syn.Config.Transaction.MachineTypeID.substring(0,1):"W",u=(syn.$w.Variable&&syn.$w.Variable.ProgramID?syn.$w.Variable.ProgramID:m.programID).padStart(8,"0"),d=m.businessID.padStart(3,"0").substring(0,3),h=y.transactionID.padStart(6,"0").substring(0,6),p=y.functionID.padStart(4,"0").substring(0,4),f=(syn.$w.User&&syn.$w.User.TokenID?syn.$w.User.TokenID:syn.$l.random(6)).padStart(6,"0").substring(0,6),a=(""+a+l+u+d+h+p+c+f+$date.toString(new Date,"s").substring(0,6)).toUpperCase();let r="";0==$string.isNullOrEmpty(syn.Config.FindGlobalIDServer)&&(n.GlobalID=await syn.$r.httpFetch(syn.Config.FindGlobalIDServer).send({applicationID:u,projectID:d,transactionID:h,serviceID:p,screenID:y.screenID,tokenID:f},{method:"POST",redirect:"follow",timeout:3e3})),r=0==$string.isNullOrEmpty(n.GlobalID)?n.GlobalID:a;const _={accessToken:s||globalRoot.bearerToken||i.BearerToken,action:"SYN",kind:"BIZ",clientTag:syn.Config.SystemID.concat("|",syn.Config.HostName,"|",syn.Config.Program.ProgramName,"|",syn.Config.Environment.substring(0,1)),loadOptions:{encryptionType:syn.Config.Transaction.EncryptionType,encryptionKey:syn.Config.Transaction.EncryptionKey,platform:"browser"==globalRoot.devicePlatform?syn.$b.platform:globalRoot.devicePlatform},requestID:a,version:syn.Config.Transaction.ProtocolVersion,environment:syn.Config.Environment.substring(0,1),system:{programID:m.programID,moduleID:y.moduleID||("browser"==globalRoot.devicePlatform?globalRoot[syn.$w.pageScript].config.moduleID:void 0)||("browser"==globalRoot.devicePlatform?location.pathname.split("/").filter(Boolean)[0]:void 0)||syn.Config.ModuleID,version:syn.Config.SystemVersion,routes:[{systemID:m.systemID,requestTick:(new Date).getTime()}],localeID:syn.Config.Program.LocaleID,hostName:"browser"==globalRoot.devicePlatform?location.host:syn.Config.HostName,pathName:"browser"==globalRoot.devicePlatform?location.pathname:""},interface:{devicePlatform:globalRoot.devicePlatform,interfaceID:syn.Config.Transaction.MachineTypeID,sourceIP:e,sourcePort:0,sourceMAC:"",connectionType:"node"==globalRoot.devicePlatform?"unknown":navigator.connection?.effectiveType,timeout:syn.Config.TransactionTimeout},transaction:{globalID:r,businessID:m.businessID,transactionID:y.transactionID,functionID:y.functionID,commandType:y.options&&y.options.commandType||"D",simulationType:syn.Config.Transaction.SimulationType,terminalGroupID:"browser"==globalRoot.devicePlatform?syn.$w.User?"{0}|{1}".format(syn.$w.User.CompanyID,syn.$w.User.DepartmentID):"":syn.Config.Program.BranchCode,operatorID:"browser"==globalRoot.devicePlatform?syn.$w.User?syn.$w.User.UserID:"":syn.Config.Program.ProgramName,screenID:y.screenID,startTraceID:y.startTraceID,dataFormat:syn.Config.Transaction.DataFormat,compressionYN:syn.Config.Transaction.CompressionYN},payLoad:{property:{},dataMapInterface:"",dataMapCount:[],dataMapSet:[]}};if(syn.$w.transactionLoadOptions&&syn.$w.transactionLoadOptions(_.loadOptions),0==$object.isNullOrUndefined(y.options)){for(const x in y.options){var g=y.options[x];if("encryptionType"==x||"encryptionKey"==x||"platform"==x)throw b(m,y),new Error("{0} 옵션 사용 불가".format(x));_.loadOptions[x]=g}l=_.loadOptions.dynamic,c=(0==$string.isNullOrEmpty(l)&&0==$string.toBoolean(l)&&(delete _.loadOptions.dynamic,delete _.loadOptions.authorize,delete _.loadOptions.commandType,delete _.loadOptions.returnType,delete _.loadOptions.transactionScope,delete _.loadOptions.transactionLog),_.loadOptions.action),u=(0==$string.isNullOrEmpty(c)&&(_.action=c,delete _.loadOptions.action),_.loadOptions.kind);0==$string.isNullOrEmpty(u)&&(_.kind=u,delete _.loadOptions.kind),delete _.loadOptions.message}d=context[syn.$w.pageScript];if(d&&d.hook.payLoadProperty){let e={};e=d.hook.payLoadProperty(y.transactionID,y.functionID),1==$object.isNullOrUndefined(e)&&(e={}),_.payLoad.property=e}if(m.transactions?1==(h=m.transactions.filter(function(e){return e.functionID==y.functionID})).length&&(f=(p=h[0]).inputs.map(function(e){return e.requestType}).join(","),s=p.outputs.map(function(e){return e.responseType}).join(","),_.payLoad.dataMapInterface="{0}|{1}".format(f,s)):y.dataMapInterface&&(_.payLoad.dataMapInterface=y.dataMapInterface),"J"!=_.transaction.dataFormat&&"T"!=_.transaction.dataFormat)throw b(m,y),new Error("transaction.dataFormat 확인 필요: {0}".format(_.transaction.dataFormat));_.payLoad.dataMapCount=y.inputsItemCount,_.payLoad.dataMapSet=[],_.payLoad.dataMapSetRaw=[];var w=y.inputs.length;for(let e=0;e<w;e++){var C=y.inputs[e],E=[];for(let e=0;e<C.length;e++){var T=C[e];E.push({id:T.prop,value:T.val})}"Y"==syn.Config.Transaction.CompressionYN?"J"==_.transaction.dataFormat?_.payLoad.dataMapSetRaw.push(syn.$c.LZString.compressToBase64(JSON.stringify(E))):_.payLoad.dataMapSetRaw.push(syn.$c.LZString.compressToBase64($object.toCSV(E,{delimeter:"｜",newline:"↵"}))):"J"==_.transaction.dataFormat?_.payLoad.dataMapSet.push(E):_.payLoad.dataMapSetRaw.push($object.toCSV(E,{delimeter:"｜",newline:"↵"}))}if("node"!=globalThis.devicePlatform&&"PSH"==_.action){a=new Blob([JSON.stringify(_)],{type:"application/json; charset=UTF-8"});navigator.sendBeacon(t,a),syn.$w.domainTransactionLoaderEnd&&syn.$w.domainTransactionLoaderEnd(),syn.$w.closeProgressMessage&&syn.$w.closeProgressMessage()}else{const R=syn.$w.xmlHttp();if(R.open(syn.$w.method,t,!0),R.setRequestHeader("Accept-Language",syn.$w.localeID),R.setRequestHeader("Server-SystemID",m.systemID||syn.Config.SystemID),R.setRequestHeader("Server-BusinessID",m.businessID),syn.Environment){var S=syn.Environment;if(S.Header)for(const A in S.Header)R.setRequestHeader(A,S.Header[A])}if(syn.$w.setServiceClientHeader&&0==syn.$w.setServiceClientHeader(R))syn.$l.eventLog("$w.executeTransaction","setServiceClientHeader 전송 안함","Warning"),b(m,y);else{if(void 0!==o&&1==R.async&&(R.async=o,0==R.async))return R.setRequestHeader("X-Requested-With","HandStack ServiceClient"),R.setRequestHeader("Content-Type","application/json"),R.send(_),R;R.onreadystatechange=function(){if(4===R.readyState)if(200!==R.status)0==R.status?syn.$l.eventLog("$w.executeTransaction","X-Requested 전송 오류","Fatal"):syn.$l.eventLog("$w.executeTransaction","응답 상태 - {0}: ".format(R.statusText)+R.responseText,"Error"),syn.$w.domainTransactionLoaderEnd&&syn.$w.domainTransactionLoaderEnd(),b(m,y);else if(syn.$w.clientTag&&syn.$w.serviceClientInterceptor&&!1===syn.$w.serviceClientInterceptor(syn.$w.clientTag,R))syn.$l.eventLog("$w.executeTransaction","serviceClientInterceptor 전송 안함","Warning"),b(m,y);else{try{var r=JSON.parse(R.responseText);if(1==y.transactionResult)if(1==r.acknowledge){var n=[],t=r.message;if(null!=r.result.dataSet&&0<r.result.dataSet.length){var e=r.result.dataSet,i=e.length;for(let t=0;t<i;t++){var o=e[t];if(r.transaction.simulationType==syn.$w.dynamicType.CodeHelp)n.push({id:o.id,value:o.value});else if("J"==r.transaction.dataFormat)"Y"==r.transaction.compressionYN?n.push({id:o.id,value:JSON.parse(syn.$c.LZString.decompressFromBase64(o.value))}):n.push({id:o.id,value:o.value});else if(m.transactions){var s,a=m.transactions.find(function(e){return e.functionID==y.functionID});if(a){let e=null;0==$object.isEmpty(o.value)&&(e=("Y"==r.transaction.compressionYN?syn.$c.LZString.decompressFromBase64(o.value):o.value).split("＾"),s=$string.toParameterObject(e[0]),e=$string.toJson(e[1],{delimeter:"｜",newline:"↵",meta:s}),"Form"==a.outputs[t].responseType?(e=e[0],1==$object.isNullOrUndefined(e)&&(e={})):1==$object.isNullOrUndefined(e)&&(e=[])),n.push({id:o.id,value:e})}}else{let e=("Y"==r.transaction.compressionYN?syn.$c.LZString.decompressFromBase64(o.value):o.value).split("＾");var l=$string.toParameterObject(e[0]);e=$string.toJson(e[1],{delimeter:"｜",newline:"↵",meta:l}),1==o.id.startsWith("Form")&&(e=e[0],1==$object.isNullOrUndefined(e)?e={}:1==$object.isNullOrUndefined(e)&&(e=[])),n.push({id:o.id,value:e})}}}if(v){var c={};if(t.additions&&0<t.additions.length)for(let e=0;e<t.additions.length;e++){var u=t.additions[e];"F"==u.code&&1==$object.isNullOrUndefined(c[u.code])?c[u.code]=u.text:"P"!=u.code&&u.code}try{v(n,c,r.correlationID)}catch(e){syn.$l.eventLog("$w.executeTransaction callback","executeTransaction 콜백 오류: "+e,"Error"),b(m,y)}}}else{var d=r.exceptionText,h="거래: {0}, 기능: {1} 수행중 오류가 발생하였습니다\nGlobalID: {2}".format(_.transaction.transactionID,_.transaction.functionID,_.transaction.globalID);if(syn.$w.serviceClientException&&syn.$w.serviceClientException("요청오류",h,d),syn.$l.eventLog("$w.executeTransaction","거래 실행 오류: "+d,"Warning"),b(m,y),"browser"===globalRoot.devicePlatform)$this&&$this.hook&&$this.hook.frameEvent&&$this.hook.frameEvent("transactionException",{transactionID:_.transaction.transactionID,functionID:_.transaction.functionID,errorText:d,errorMessage:h});else if(v)try{v([],null,r.correlationID)}catch(e){syn.$l.eventLog("$w.executeTransaction callback","executeTransaction 콜백 오류: "+e,"Error")}}else if(v){if(r&&r.acknowledge&&1==r.acknowledge)try{if(null!=r.result.dataSet&&0<r.result.dataSet.length){var p=r.result.dataSet,f=p.length;for(let e=0;e<f;e++){var g=p[e];"J"==r.transaction.dataFormat?"Y"==r.transaction.compressionYN&&(g.value=JSON.parse(syn.$c.LZString.decompressFromBase64(g.value))):g.value="Y"==r.transaction.compressionYN?syn.$c.LZString.decompressFromBase64(g.value):g.value}}}catch(e){syn.$l.eventLog("$w.executeTransaction","executeTransaction 오류: "+e,"Error"),b(m,y)}try{v(r,null,r.correlationID)}catch(e){syn.$l.eventLog("$w.executeTransaction callback","executeTransaction 콜백 오류: "+e,"Error"),b(m,y)}}}catch(e){d="거래: {0}, 기능: {1} 수행중 오류가 발생하였습니다\nGlobalID: {2}".format(_.transaction.transactionID,_.transaction.functionID,_.transaction.globalID);if(syn.$w.serviceClientException&&syn.$w.serviceClientException("요청오류",d,e.stack),syn.$l.eventLog("$w.executeTransaction","executeTransaction 오류: "+e,"Error"),b(m,y),"browser"===globalRoot.devicePlatform)$this&&$this.hook&&$this.hook.frameEvent&&$this.hook.frameEvent("transactionError",{transactionID:_.transaction.transactionID,functionID:_.transaction.functionID,errorText:e.message,errorMessage:d});else if(v)try{v([],null)}catch(e){syn.$l.eventLog("$w.executeTransaction callback","executeTransaction 콜백 오류: "+e,"Error"),b(m,y)}}syn.$w.domainTransactionLoaderEnd&&syn.$w.domainTransactionLoaderEnd()}},syn.$l.eventLog("$w.executeTransaction","거래 GlobalID: "+_.transaction.globalID,"Verbose"),R.setRequestHeader("X-Requested-With","HandStack ServiceClient"),R.setRequestHeader("Content-Type","application/json"),R.timeout=syn.Config.TransactionTimeout,R.send(JSON.stringify(_))}}}}},pseudoStyle(e,t,r){var n,i=document.head||(0==document.getElementsByTagName("head").length?null:document.getElementsByTagName("head")[0]);i&&(""==(n=document.getElementById(e)||document.createElement("style")).id&&(n.id=e),n.innerHTML=t+"{"+r+"}",i.appendChild(n))},pseudoStyles(e,t){var r=document.head||(0==document.getElementsByTagName("head").length?null:document.getElementsByTagName("head")[0]);if(r&&1==$object.isArray(t)&&0<t.length){for(var n=document.getElementById(e)||document.createElement("style"),i=(""==n.id&&(n.id=e),[]),o=0,s=t.length;o<s;o++){var a=t[o];i.push(a.selector+"{"+a.cssText+"}")}n.innerHTML=i.join("\n"),r.appendChild(n)}}}),syn&&!syn.Config&&(syn.Config={}),context.$webform=syn.$w=$webform,"node"===globalRoot.devicePlatform){var fs=require("fs"),path=require("path"),filePath,data;process.env.SYN_CONFIG?syn.Config=JSON.parse(process.env.SYN_CONFIG):(filePath=path.join(process.cwd(),"node.config.json"),1==fs.existsSync(filePath)?(data=fs.readFileSync(filePath,"utf8"),syn.Config=JSON.parse(data),process.env.SYN_LogMinimumLevel=syn.Config.LogMinimumLevel||"trace",process.env.SYN_FileLogBasePath=syn.Config.FileLogBasePath||path.join(process.cwd(),"..","log","function","javascript"),process.env.SYN_LocalStoragePath=syn.Config.LocalStoragePath||path.join(process.cwd(),"..","cache","function")):console.error("Node.js 환경설정 파일이 존재하지 않습니다. 파일 경로: {0}".format(filePath))),syn.Config&&1==$string.isNullOrEmpty(syn.Config.DataSourceFilePath)&&(syn.Config.DataSourceFilePath=path.join(process.cwd(),"..","modules","dbclient","module.json"));const browserOnlyMethods=["activeControl","contentLoaded","addReadyCount","removeReadyCount","createSelection","getTriggerOptions","scrollToTop","setFavicon","fileDownload","pseudoStyle","pseudoStyles","isPageLoad","pageReadyTimeout","eventAddReady","eventRemoveReady","moduleReadyIntervalID","remainingReadyIntervalID","remainingReadyCount","defaultControlOptions","mappingModule"];browserOnlyMethods.forEach(e=>{delete $webform[e]})}else{const pathname=location.pathname,pathSegments=pathname.split("/").filter(Boolean);if(0<pathSegments.length){const filename=pathSegments[pathSegments.length-1],pageProject=pathSegments[pathSegments.length-2]||"",pageScript="$"+(filename.includes(".")?filename.substring(0,filename.indexOf(".")):filename);$webform.extend({pageProject:pageProject,pageScript:pageScript})}syn.$l.addEvent(context,"load",()=>{context[$webform.pageScript]?.hook?.windowLoad?.()});var urlArgs="true"==syn.$r.getCookie("syn.iscache")?"":"?tick="+(new Date).getTime(),isAsyncLoad=0==syn.$b.isIE;if(globalRoot.isLoadConfig=!1,context.synConfig?(syn.Config=syn.$w.argumentsExtend(syn.Config,synConfig),context.synConfig=void 0,globalRoot.isLoadConfig=!0,setTimeout(async function(){await $webform.contentLoaded()})):$webform.loadJson("/"+(context.synConfigName||"syn.config.json")+urlArgs,null,function(e,t){syn.Config=syn.$w.argumentsExtend(syn.Config,t),globalRoot.isLoadConfig=!0,setTimeout(async function(){await $webform.contentLoaded()})},null,isAsyncLoad),context.Configuration&&(syn.Environment=context.Configuration,syn.$l.deepFreeze(syn.Environment),delete context.Configuration),syn.Environment){var environment=syn.Environment;if(environment.Cookie)for(var item in environment.Cookie){var value=syn.$r.getCookie(item);1==$object.isNullOrUndefined(value)&&syn.$r.setCookie(item,environment.Cookie[item])}}"browser"===globalRoot.devicePlatform&&(syn.$b.appName=syn.Config.HostName,syn.$b.appCodeName=syn.Config.ApplicationID)}}(globalRoot),!function(e){"use strict";var a=e.$print||new syn.module;a.extend({base64ExcelFile:null,reportName:`report-${$date.toString(new Date,"d")}.pdf`,datetimeFormat:"yyyy-MM-dd",boolTrue:"○",boolFalse:"×",workItems:[],workActions:[],workData:null,reportifyServer:"",reportifyPath:"/reportify/api/brief",reportifyTemplateUrl:"/reportify/api/index/download-template?reportFileID=",pageExportScheme:"export-scheme",pageExcelToPdf:"excel-to-pdf",concreate(){"browser"==globalRoot.devicePlatform?(1!=$string.toBoolean(syn.Config.IsReportifyModule)||window.PDFObject||syn.$w.loadScript("/lib/pdfobject/pdfobject.min.js"),1!=$string.toBoolean(syn.Config.IsReportifyModule)||window.printJS||syn.$w.loadScript("/lib/print-js/print.min.js")):"node"==globalRoot.devicePlatform&&(a.reportifyServer="http://localhost:8421")},getReportifyUrl(e){return""+a.reportifyServer+a.reportifyPath+"/"+e},getDocumentTemplateUrl(e){return""+a.reportifyServer+a.reportifyTemplateUrl+e},async generate(e,t){var r={templateID:e,reportName:a.reportName,datetimeFormat:a.datetimeFormat,boolTrue:a.boolTrue,boolFalse:a.boolFalse,workItems:a.workItems,workActions:a.workActions};0==$string.isNullOrEmpty(t)&&(0==(1==t.startsWith("http:")||1==t.startsWith("https:"))&&(t=""+a.reportifyServer+t),a.base64ExcelFile=await syn.$l.urlToBase64(t)),0==$string.isNullOrEmpty(a.base64ExcelFile)&&(r.base64ExcelFile=a.base64ExcelFile);for(var n=0,i=r.workItems.length;n<i;n++){var o=r.workItems[n];o.options&&1==$object.isObject(o.options)&&(o.options=JSON.stringify(o.options))}for(n=0,i=r.workActions.length;n<i;n++){var s=r.workActions[n];s.options&&1==$object.isObject(s.options)&&(s.options=JSON.stringify(s.options))}return r},addWorkItem(e,t,r,n,i,o,s,a,l,c,u){var d;1==$object.isNumber(t)?t||r||i||o||s?syn.$l.eventLog("addWorkItem","document, worksheet, datafield, bind, row, col 필수 항목 필요","Warning"):(d={document:t,worksheet:r,datafield:n,bind:i,row:o,col:s,type:a,data:l,step:u},c&&(d.overtake=c),e.push(d)):1==$object.isObject(t)&&(t.document&&t.worksheet&&t.bind&&t.row&&t.col?(d={document:t.document,worksheet:t.worksheet,datafield:t.datafield,bind:t.bind,row:t.row,col:t.col,type:t.type,data:t.data,step:t.step},t.overtake&&(d.overtake=t.overtake),e.push(d)):syn.$l.eventLog("addWorkItem","document, worksheet, datafield, bind, row, col 필수 항목 필요","Warning"))},addAtWorkItem(e,t,r,n,i,o){var s,a;o=o||!0,-1===e.findIndex(e=>e.document===t&&e.worksheet===r&&e.datafield===n)?syn.$l.eventLog("addAtWorkItem",`document: ${t}, worksheet: ${r}, datafield: ${n} 항목 확인 필요`,"Warning"):-1===(a=e.findIndex(e=>e.document===i.document&&e.worksheet===i.worksheet&&0==$string.isNullOrEmpty(i.datafield)&&e.datafield===i.datafield))?syn.$l.eventLog("addAtWorkItem",`datafield: ${i.datafield} 중복 항목 확인 필요`,"Warning"):(s={document:i.document,worksheet:i.worksheet,datafield:i.datafield,bind:i.bind,row:i.row,col:i.col,type:i.type,data:i.data},i.overtake&&(s.overtake=i.overtake),1==$string.toBoolean(o)?e.splice(a+1,0,s):e.splice(a,0,s))},removeWorkItem(e,t,r,n){var i=e.findIndex(e=>e.document===t&&e.worksheet===r&&e.datafield===n);-1<i?e.splice(i,1):syn.$l.eventLog("removeWorkItem",`document: ${t}, worksheet: ${r}, datafield: ${n} 항목 확인 필요`,"Warning")},updateWorkItem(e,t,r,n,i){e=e.find(e=>e.document===t&&e.worksheet===r&&e.datafield===n);e?Object.assign(e,i):syn.$l.eventLog("updateWorkItem",`document: ${t}, worksheet: ${r}, datafield: ${n} 항목 확인 필요`,"Warning")},bindingWorkItems(e,t,r){var n,i=JSON.parse(JSON.stringify(e));for(n in t){var o=t[n];if(o)for(var s=0,a=i.length;s<a;s++){var l,c=i[s];r&&1==$object.isNumber(r)&&0<r&&-1<c.document&&(c.document=c.document+r),1==$object.isNullOrUndefined(c.bind)&&(c.bind="cell"),1==["cell"].includes(c.bind)&&1==o.hasOwnProperty(c.datafield)&&0==Array.isArray(o)?(1==(l=c.bind.split(":")).length||1<l.length&&l[1]==n)&&(c.data=o[c.datafield]||""):1==["item","list"].includes(c.bind.split(":")[0])&&1==Array.isArray(o)&&(1==(l=c.bind.split(":")).length||1<l.length&&l[1]==n)&&(c.data=o.map(t=>c.datafield.map(e=>t[e]||""))),c.bind=c.bind.split(":")[0]}}return i},transformWorkData(e,r){return e.map(t=>r.map(e=>t[e]))},splitDataChunks(e,t,r){var n=[];0<t&&t<=e.length&&n.push(e.slice(0,t));for(var i=t,o=e.length;i<o;i+=r)n.push(e.slice(i,i+r));return n},async renderViewer(e,t,r){(t=syn.$l.getElement(t))&&(parent.syn&&parent.syn.$w.progressMessage&&parent.syn.$w.progressMessage(),r=syn.$w.argumentsExtend({width:"100%",height:"100%",forcePDFJS:!0,PDFJS_URL:"/reportify/lib/pdfjs/web/viewer.html",pdfOpenParams:{navpanes:0,toolbar:0,statusbar:0,view:"FitH"},fallbackLink:'<p>이 브라우저는 인라인 PDF를 지원하지 않습니다. 내용을 확인하려면 PDF를 다운로드하세요. <a href="[url]"> PDF 다운로드 </a> </ p>',excelUrl:"",workData:null},r),e=await a.generate(e,r.excelUrl),null!=r.workItems&&(e.workItems=r.workItems),null!=r.workActions&&(e.workActions=r.workActions),null!=r.workData&&(e.workData=r.workData),(e=await syn.$r.httpRequest("POST",a.getReportifyUrl(a.pageExcelToPdf),e,null,{responseType:"blob"}))&&200==e.status&&(e=syn.$r.createBlobUrl(e.response),PDFObject.embed(e,t,r)),parent.syn)&&parent.syn.$w.progressMessage&&parent.syn.$w.closeProgress()},async renderPrint(e,t){parent.syn&&parent.syn.$w.progressMessage&&parent.syn.$w.progressMessage(),t=syn.$w.argumentsExtend({excelUrl:"",workData:null},t);var e=await a.generate(e,t.excelUrl),t=(null!=t.workItems&&(e.workItems=t.workItems),null!=t.workActions&&(e.workActions=t.workActions),null!=t.workData&&(e.workData=t.workData),await syn.$r.httpRequest("POST",a.getReportifyUrl(a.pageExcelToPdf),e,null,{responseType:"blob"}));t&&200==t.status&&(e=syn.$r.createBlobUrl(t.response),printJS(e)),parent.syn&&parent.syn.$w.progressMessage&&parent.syn.$w.closeProgress()},async getSchemeText(e,t,r){var n,i,o,s="",e=await syn.$l.urlToBase64(e);return e&&(n=a.getReportifyUrl(a.pageExportScheme),e={body:{base64ExcelFile:e,indent:$string.toBoolean(r),formatted:$string.toBoolean(t)}},(r=await syn.$r.httpRequest("POST",n,e))&&200==r.status?(s=r.response,window.ClipboardJS&&(""==(i=syn.$l.get("btn-clipboard-text")||document.createElement("button")).id&&(i.id="btn-clipboard-text",i.style.display="none"),i.setAttribute("data-clipboard-text",s),document.body.appendChild(i),(o=new ClipboardJS(i)).on("success",e=>{o.destroy(),document.body.removeChild(i)}),i.click())):syn.$l.eventLog("getSchemeText","작업 항목 요청 오류: "+n,"Error")),s}}),e.$print=syn.$p=a,"node"===globalRoot.devicePlatform&&(delete syn.$p.renderViewer,delete syn.$p.renderPrint,delete syn.$p.getSchemeText)}(globalRoot),!function(context){"use strict";var $resource=context.$resource||new syn.module,document=context.document;$resource.extend({localeID:"ko-KR",fullyQualifiedLocale:{ko:"ko-KR",en:"en-US",ja:"ja-JP",zh:"zh-CN"},translations:{},translateControls:[],concreate(){$resource.remainingReadyIntervalID=setInterval(function(){if(1==syn.$w.isPageLoad){clearInterval($resource.remainingReadyIntervalID),$resource.remainingReadyIntervalID=null;for(var els=document.querySelectorAll("[syn-i18n]"),i=0;i<els.length;i++){var el=els[i],tagName=el.tagName.toUpperCase(),elID=el.getAttribute("id"),i18nOption=el.getAttribute("syn-i18n");if(null!=i18nOption&&""!==i18nOption){var options=null;if(1==i18nOption.startsWith("{"))try{options=eval("("+i18nOption+")"),void 0===options.options.bindSource||null===options.options.bindSource?options.bindSource="content":options.bindSource=options.options.bindSource}catch(error){console.log('$resource.concreate, tagName: "'+tagName+'", elID: "'+elID+'" syn-i18n 확인 필요, error: '+error.message)}else options={key:i18nOption,bindSource:"content"};if(options&&0==(void 0===options.key||null===options.key||""===options.key)){el.setAttribute("i18n-key",options.key);var controlType="",moduleName=null;if(-1<tagName.indexOf("SYN_"))moduleName=tagName.substring(4).toLowerCase(),controlType=moduleName;else switch(tagName){case"BUTTON":moduleName="button",controlType="button";break;case"INPUT":switch(controlType=(el.getAttribute("type")||"text").toLowerCase(),controlType){case"hidden":case"text":case"password":case"color":case"email":case"number":case"search":case"tel":case"url":moduleName="textbox";break;case"submit":case"reset":case"button":moduleName="button";break;case"radio":moduleName="radio";break;case"checkbox":moduleName="checkbox"}break;case"TEXTAREA":moduleName="textarea",controlType="textarea";break;case"SELECT":controlType=null==el.getAttribute("multiple")?(moduleName="select","select"):(moduleName="multiselect","multiselect");break;default:moduleName="element"}var key=options.key,bindSource=options.bindSource;delete options.key,delete options.bindSource,$resource.translateControls.push({elID:elID,key:key,bindSource:bindSource,tag:tagName,module:moduleName,type:controlType,options:options})}else console.log('$resource.concreate, tagName: "'+tagName+'", elID: "'+elID+'" key 확인 필요')}}var mod=window[syn.$w.pageScript];mod&&mod.hook.pageResource&&mod.hook.pageResource($resource.localeID),syn.Config&&1==$string.toBoolean(syn.Config.IsLocaleTranslations)&&syn.$w.pageResource&&syn.$w.pageResource($resource.localeID),syn.Config&&1==$string.toBoolean(syn.Config.IsLocaleTranslations)&&mod.config&&(1==$string.isNullOrEmpty(mod.config.isLocaleTranslations)||1==$string.toBoolean(mod.config.isLocaleTranslations))&&$resource.setLocale($resource.localeID)}},25)},add(e,t){$resource.translations[e]=t},remove(e){delete $resource.translations[e]},interpolate(e,r){return Object.keys(r).reduce(function(e,t){return e.replace(new RegExp("#{s*"+t+"s*}","g"),r[t])},e)},getControl(e){var t,r,n,i=null;return 1==$object.isString(e)&&(e=syn.$l.get(e)),0==$object.isNullOrUndefined(e)&&(t=e.id,r=e.tagName,n=e.getAttribute("i18n-key"),i=1==$string.isNullOrEmpty(t)?$resource.translateControls.find(function(e){return e.tag==r&&e.key==n}):$resource.translateControls.find(function(e){return e.elID==t&&e.tag==r&&e.key==n})),i},translatePage(){$resource.translateControls.forEach(function(e){$resource.translateControl(e)})},translateElement(e,t){e=$resource.getControl(e);0==$object.isNullOrUndefined(e)&&$resource.translateControl(e,t)},translateControl(e,t){var r,n;0==$object.isNullOrUndefined(e)&&(n=null,n=0==$string.isNullOrEmpty(e.elID)?syn.$l.get(e.elID):syn.$l.querySelector('{0}[i18n-key="{1}"]'.format(e.tag,e.key)),1==$object.isNullOrUndefined(e.module)?(r=$resource.getBindSource(e),0==$string.isNullOrEmpty(r)&&(n[r]=$resource.translateText(e,t))):syn.uicontrols&&(n=syn.uicontrols["$"+e.module])&&n.setLocale&&n.setLocale(e.elID,$resource.translations,e,t))},translateText(e,t){var r,n="";return e&&(e=e.key,e=$resource.translations[e],r=null,1==$object.isString(e)?r=e:1==$object.isArray(e)?r=e[0]:1==$object.isObject(e)&&(r=e.Text),n=1==/#{s*\w+s*}/g.test(r)&&((e=syn.$w.getSSOInfo())?t&&(e=syn.$w.argumentsExtend(e,t)):e=t,e)?$resource.interpolate(r,e):r),n},getBindSource(e){var t=null;switch(e.bindSource){case"text":t="innerText";break;case"content":t="textContent";break;case"html":t="innerHTML";break;case"url":t="src";break;case"placeholder":t="placeholder";break;case"control":t="controlText";break;case"value":t="value"}return t},async setLocale(e){var t="/assets/shared/language/",t=""+(t=syn&&syn.Config?syn.Config.LocaleAssetUrl||syn.Config.SharedAssetUrl+"language/":t)+($resource.localeID=e)+".json";if(1==await syn.$r.isCorsEnabled(t))try{var r=await syn.$w.fetchJson(t);$resource.translations=syn.$w.argumentsExtend($resource.translations,r)}catch(e){syn.$l.eventLog("$resource.setLocale",e.message,"Warning")}document.documentElement.lang=e.substring(0,2),$resource.translatePage()}}),context.$resource=syn.$res=$resource}(globalRoot),!function(){if(!$resource)throw new Error("$res 리소스 객체가 없습니다.");$resource.add("localeID","ko-KR"),$resource.add("progress","진행 중입니다."),$resource.add("appendTo","신규 입력 상태입니다."),$resource.add("appendPre","화면 구성 중..."),$resource.add("retrieve","정상적으로 조회되었습니다."),$resource.add("retrieveException","데이터를 조회하는 과정에서 문제가 발생하였습니다."),$resource.add("retrievePre","데이터 조회 중..."),$resource.add("save","정상적으로 저장되었습니다."),$resource.add("saveException","데이터를 저장하는 과정에서 문제가 발생하였습니다."),$resource.add("savePre","저장 중..."),$resource.add("update","정상적으로 수정되었습니다."),$resource.add("updateException","데이터를 수정하는 과정에서 문제가 발생하였습니다."),$resource.add("updatePre","수정 중..."),$resource.add("remove","정상적으로 삭제되었습니다."),$resource.add("removeException","데이터를 삭제하는 과정에서 문제가 발생하였습니다."),$resource.add("removePre","삭제 중..."),$resource.add("copyAppend","기존 데이터를 복사하여 입력 상태로 전환했습니다."),$resource.add("userInfoNothing","사용자 정보에 문제가 발생했습니다."),$resource.add("isLogOut","정말로 로그아웃 하시겠습니까?"),$resource.add("waiting","잠시만 기다려주세요..."),$resource.add("notElemnet","컨트롤이 발견되지 않았습니다. 쿼리나 HTML 디자인을 살펴보세요"),$resource.add("dualElemnet",'"{0}"의 아이디는 현재 페이지에서 중복된 이름 또는 아이디의 컨트롤로 발견되었습니다.'),$resource.add("requiredKeyData","필수 입력 항목 오류"),$resource.add("requiredInsertData","아래 항목은 필수 입력 항목입니다."),$resource.add("errorMessage","에러가 발생했습니다."),$resource.add("serverErrorMessage","서버에서 에러가 발생했습니다."),$resource.add("initialComplete","화면 구성 완료"),$resource.add("initialException","화면 구성 실패"),$resource.add("isDateTimeInsert",'"{0}" 포맷의 날짜와 시간을 입력해야 합니다.'),$resource.add("isDateInsert",'"{0}" 포맷의 날짜를 입력해야 합니다.'),$resource.add("isTimeInsert",'"{0}" 포맷의 시간을 입력해야 합니다.'),$resource.add("isNumericInsert","숫자를 입력해야 합니다."),$resource.add("forceSave","편집중인 데이터를 저장하시겠습니까?"),$resource.add("textMaxLength",'입력 가능한 "{0}"자리수를 넘었습니다'),$resource.add("create","입력"),$resource.add("read","조회"),$resource.add("find","검색"),$resource.add("edit","수정"),$resource.add("delele","삭제"),$resource.add("removeStatusNo","삭제 가능한 상태가 아닙니다. 데이터를 조회한 후 삭제 해야 합니다."),$resource.add("removeConfirm","정말로 삭제 하시겠습니까?"),$resource.add("notData","데이터가 없습니다."),$resource.add("notCondData","입력하신 조건에 맞는 데이터가 없습니다."),$resource.add("notRetrieveCond","조회에 필요한 항목이 입력되지 않았습니다."),$resource.add("notDateBetween","기간이 올바르게 설정되지 않았습니다."),$resource.add("notDate","정확한 날짜를 입력 하거나 선택해야 합니다."),$resource.add("notFindCond","검색에 필요한 문장을 입력해야 합니다. 정확한 검색을 위해 두글자 이상 입력해야 합니다."),$resource.add("selectData","데이터를 선택해야 합니다."),$resource.add("selectAll","전체"),$resource.add("saveExcel","엑셀 다운로드 중입니다."),$resource.add("saveExcelComplete","엑셀 파일을 다운로드 했습니다."),$resource.add("saveExcelFail","엑셀 파일 다운로드를 실패 했습니다"),$resource.add("notSupportContent","지원 하지 않는 컨텐츠 타입입니다.")}(globalRoot),!function(i){syn.uicontrols=syn.uicontrols||new syn.module;var c=syn.uicontrols.$chart||new syn.module;c.extend({name:"syn.uicontrols.$chart",version:"v2025.3.1",chartControls:[],randomSeed:Date.now(),defaultSetting:{chart:{type:"column"},title:{text:""},xAxis:{categories:["A","B","C"]},yAxis:{title:{text:"Values"}},series:[{name:"Series 1",data:[1,0,4]},{name:"Series 2",data:[5,7,3]}],dataType:"string",belongID:null,controlText:null,validators:null,transactConfig:null,triggerConfig:null},addModuleList(e,t,r,n){var i=e.getAttribute("id"),o=e.getAttribute("syn-datafield"),e=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:e,field:o,module:this.name,type:n})},controlLoad:function(e,t){var r=syn.$l.get(e),n=(t=syn.$w.argumentsExtend(c.defaultSetting,t),i[syn.$w.pageScript]),n=(n&&n.hook.controlInit&&(n=n.hook.controlInit(e,t),t=syn.$w.argumentsExtend(t,n)),t.width=r.style.width||320,t.height=r.style.height||240,r.setAttribute("id",r.id+"_hidden"),r.setAttribute("syn-options",JSON.stringify(t)),r.style.display="none",r.parentNode),r=document.createElement("div");r.style.width=t.width,r.style.height=t.height,r.id=e,n.appendChild(r),syn.$l.addEvent(syn.$l.get(e),"click",function(e){e.target||e.srcElement}),c.chartControls.push({id:e,chart:Highcharts.chart(e,t),setting:$object.clone(t)}),t.bindingID&&syn.uicontrols.$data&&syn.uicontrols.$data.bindingSource(e,t.bindingID)},getValue:function(e,t){var r=null,n=c.getChartControl(e);if(n)for(var r=[],i=n.series.length,o=0;o<i;o++){var s=n.series[o];r.push({name:s.name,data:s.yData})}return r},setValue:function(e,t,r){var n=c.getChartControl(e);if(n)for(var i=n.series.length-1;-1<i;i--)n.series[i].remove();for(var o=t.length,i=0;i<o;i++){var s=t[i];n.addSeries(s)}var a,l=[];for(a in s)control.config.labelID!=a&&l.push(a)},randomScalingFactor:function(e,t){return e=void 0===e?0:e,t=void 0===t?100:t,Math.round(c.rand(e,t))},rand:function(e,t){var r=c.randomSeed;return e=void 0===e?0:e,t=void 0===t?1:t,c.randomSeed=(9301*r+49297)%233280,e+c.randomSeed/233280*(t-e)},toImage:function(e,t){var r=c.getChartControl(e);r&&(t="{0}.png".format(t||e),e=r.chart.toBase64Image(),download?download(e,t,"image/png"):((r=document.createElement("a")).href=e,r.download=t,r.click()))},getChartControl:function(e){for(var t=null,r=c.chartControls.length,n=0;n<r;n++){var i=c.chartControls[n];if(i.id==e){t=i.chart;break}}return t},clear:function(e,t){for(var r=c.getChartControl(e);0<r.series.length;)r.series[0].remove(!0)},setLocale:function(e,t,r,n){}}),syn.uicontrols.$chart=c}(window),!function(window){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var $checkbox=syn.uicontrols.$checkbox||new syn.module;$checkbox.extend({name:"syn.uicontrols.$checkbox",version:"v2025.3.24",defaultSetting:{contents:"",toSynControl:!1,disabled:!1,checkedValue:"1",uncheckedValue:"0",dataType:"string",belongID:null,controlText:null,textContent:"",validators:null,transactConfig:null,triggerConfig:null},addModuleList(e,t,r,n){var i=e.getAttribute("id"),o=e.getAttribute("syn-datafield"),e=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:e,field:o,module:this.name,type:n})},controlLoad(elID,setting){var el=syn.$l.get(elID),mod=(setting=syn.$w.argumentsExtend($checkbox.defaultSetting,setting),window[syn.$w.pageScript]),moduleSettings,dataFieldID,events,value,checked,disabled,html,html,parent,wrapper;mod&&mod.hook.controlInit&&(moduleSettings=mod.hook.controlInit(elID,setting),setting=syn.$w.argumentsExtend(setting,moduleSettings)),(1==setting.toSynControl?(el.setAttribute("id",el.id+"_hidden"),el.setAttribute("syn-options",JSON.stringify(setting)),el.style.display="none",dataFieldID=el.getAttribute("syn-datafield"),events=el.getAttribute("syn-events"),value=el.value,checked=el.checked,disabled=setting.disabled||el.disabled,html="",html=events?'<input class="ui_checkbox" id="{0}" name="{1}" type="checkbox" syn-datafield="{2}" value="{3}" {4} {5} syn-events={6}>'.format(elID,name,dataFieldID,value,1==checked?'checked="checked"':"",1==disabled?'disabled="disabled"':"","['"+eval(events).join("','")+"']"):'<input class="ui_checkbox" id="{0}" name="{1}" type="checkbox" syn-datafield="{2}" value="{3}" {4} {5}>'.format(elID,name,dataFieldID,value,1==checked?'checked="checked"':"",1==disabled?'disabled="disabled"':""),1==$object.isString(setting.textContent)&&(html+='<label class="ml-1" for="{0}">{1}</label>'.format(elID,setting.textContent)),parent=el.parentNode,wrapper=syn.$m.create({tag:"span",className:"formControl"}),wrapper.innerHTML=html,parent.appendChild(wrapper),syn.$l.get(elID)):el).setAttribute("syn-options",JSON.stringify(setting)),setting.bindingID&&syn.uicontrols.$data&&syn.uicontrols.$data.bindingSource(elID,setting.bindingID)},getValue(e,t){var r,n="0",e=syn.$l.get(e);return n=0==$object.isNullOrUndefined(e)?(r=e.getAttribute("syn-options"))?(r=JSON.parse(r),1==e.checked?1==$object.isNullOrUndefined(r.checkedValue)?"1":r.checkedValue:1==$object.isNullOrUndefined(r.uncheckedValue)?"0":r.uncheckedValue):1==e.checked?"1":"0":n},setValue(e,t,r){var n,e=syn.$l.get(e);0==$object.isNullOrUndefined(e)&&(t?(t=t.toString().toUpperCase(),(n=e.getAttribute("syn-options"))&&(n=JSON.parse(n),0==$object.isNullOrUndefined(n.checkedValue))&&(t=t==n.checkedValue),e.checked=1==t||"TRUE"==t||"Y"==t||"1"==t):e.checked=!1)},toggleValue(e){e=syn.$l.get(e);0==e.checked?e.checked=!0:1==e.checked&&(e.checked=!1)},clear(e,t){syn.$l.get(e).checked=!1},getGroupNames(){for(var e=[],t=syn.$l.querySelectorAll("input[type='checkbox']"),r=0;r<t.length;r++)e.push(t[r].name);return $array.distinct(e)},setLocale(e,t,r,n){}}),syn.uicontrols.$checkbox=$checkbox}(window),!function(window){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var $codepicker=$codepicker||new syn.module;$codepicker.extend({name:"syn.uicontrols.$codepicker",version:"v2025.3.25",defaultSetting:{dataSourceID:null,storeSourceID:null,local:!0,parameters:"",label:"",labelWidth:"",codeElementID:"",codeElementWidth:"",codeElementClass:"",textElementID:"",textElementWidth:"",textElementClass:"",required:!1,readonly:!1,disabled:!1,textBelongID:null,textDataFieldID:null,searchValue:"",searchText:"",isMultiSelect:!1,isAutoSearch:!0,isOnlineData:!1,viewType:"",dataType:"string",belongID:null,getter:!1,setter:!1,controlText:null,validators:null,transactConfig:null,triggerConfig:null},addModuleList(e,t,r,n){var i=e.getAttribute("id"),e=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:e,field:null,module:this.name,type:n})},controlLoad(elID,setting){var el=syn.$l.get(elID),mod=(setting=syn.$w.argumentsExtend($codepicker.defaultSetting,setting),window[syn.$w.pageScript]),moduleSettings,dataField=(mod&&mod.hook.controlInit&&(moduleSettings=mod.hook.controlInit(elID,setting),setting=syn.$w.argumentsExtend(setting,moduleSettings)),el.setAttribute("id",el.id+"_hidden"),el.setAttribute("syn-options",JSON.stringify(setting)),el.style.display="none",el.getAttribute("syn-datafield")),events=el.getAttribute("syn-events"),textboxCode=syn.$m.create({id:elID+"_Code",tag:"input",className:"form-control mr-1 pr-1"}),buttonOpen=(textboxCode.type="text",textboxCode.setAttribute("syn-events","['keydown', 'blur']"),textboxCode.setAttribute("baseID",elID),0==$string.isNullOrEmpty(dataField)&&textboxCode.setAttribute("syn-datafield",dataField),0==$string.isNullOrEmpty(setting.codeElementWidth)&&(textboxCode.style.width=codeElementWidth),0==$string.isNullOrEmpty(setting.codeElementClass)&&syn.$m.addClass(textboxCode,codeElementClass),1==$string.toBoolean(setting.readonly)&&textboxCode.setAttribute("readonly","readonly"),1==$string.toBoolean(setting.disabled)&&textboxCode.setAttribute("disabled","disabled"),1==$string.toBoolean(setting.required)&&textboxCode.setAttribute("required","required"),1==$string.isNullOrEmpty(setting.belongID)?textboxCode.setAttribute("syn-options","{editType: 'text', dataType: 'string'}"):1==$object.isArray(setting.belongID)?textboxCode.setAttribute("syn-options",`{editType: 'text', dataType: 'string', belongID: ${JSON.stringify(setting.belongID)}}`):textboxCode.setAttribute("syn-options",`{editType: 'text', dataType: 'string', belongID: '${setting.belongID}'}`),0==$object.isNullOrUndefined(events)&&textboxCode.setAttribute("syn-events",events),syn.$m.insertAfter(textboxCode,el),syn.$m.create({id:elID+"_Button",tag:"button",className:"btn btn-icon f:18! bg-muted-lt"})),textboxText=(buttonOpen.innerHTML='<i class="ti ti-search"></i>',syn.$m.insertAfter(buttonOpen,textboxCode),syn.$m.create({id:elID+"_Text",tag:"input",className:"form-control"})),codeEL=(textboxText.type="text",textboxText.setAttribute("syn-events","['keydown', 'blur']"),textboxText.setAttribute("baseID",elID),0==$string.isNullOrEmpty(setting.textDataFieldID)&&textboxText.setAttribute("syn-datafield",setting.textDataFieldID),0==$string.isNullOrEmpty(setting.textElementWidth)&&(textboxText.style.width=textElementWidth),0==$string.isNullOrEmpty(setting.textElementClass)&&syn.$m.addClass(textboxText,textElementClass),1==$string.toBoolean(setting.readonly)&&textboxText.setAttribute("readonly","readonly"),1==$string.toBoolean(setting.disabled)&&textboxText.setAttribute("disabled","disabled"),1==$string.toBoolean(setting.required)&&textboxText.setAttribute("required","required"),1==$string.isNullOrEmpty(setting.textBelongID)?textboxText.setAttribute("syn-options","{editType: 'text', dataType: 'string'}"):1==$object.isArray(setting.textBelongID)?textboxText.setAttribute("syn-options",`{editType: 'text', dataType: 'string', belongID: ${JSON.stringify(setting.textBelongID)}}`):textboxText.setAttribute("syn-options",`{editType: 'text', dataType: 'string', belongID: '${setting.textBelongID}'}`),0==$object.isNullOrUndefined(events)&&textboxText.setAttribute("syn-events",events),syn.$m.insertAfter(textboxText,buttonOpen),syn.$l.get(elID+"_Code")),fnCodeChange=(syn.$l.addEvent(codeEL,"focus",function(e){var e=e.srcElement||e.target,t=window[syn.$w.pageScript];t&&(t.prop.focusControl=e)}),function(e){var t=e.currentTarget.id.replace("_Code","");syn.$l.get(t+"_Text").value="",(13==e.keyCode||e instanceof FocusEvent)&&syn.$l.trigger(syn.$l.get(t+"_Button"),"click",e)}),synOptions=(syn.$l.addEvent(codeEL,"keydown",fnCodeChange),syn.$l.addEvent(codeEL,"blur",fnCodeChange),codeEL.getAttribute("syn-options")),textEL=(0==$string.isNullOrEmpty(synOptions)?syn.uicontrols.$textbox.controlLoad(codeEL.id,eval("("+synOptions+")")):syn.uicontrols.$textbox.controlLoad(codeEL.id,{}),syn.$l.get(elID+"_Text")),fnTextChange=(syn.$l.addEvent(textEL,"focus",function(e){var e=e.srcElement||e.target,t=window[syn.$w.pageScript];t&&(t.prop.focusControl=e)}),function(e){var t=e.currentTarget.id.replace("_Text","");syn.$l.get(t+"_Code").value="",(13==e.keyCode||e instanceof FocusEvent)&&syn.$l.trigger(syn.$l.get(t+"_Button"),"click",e)}),buttonEL=(syn.$l.addEvent(textEL,"keydown",fnTextChange),syn.$l.addEvent(textEL,"blur",fnTextChange),synOptions=textEL.getAttribute("syn-options"),0==$string.isNullOrEmpty(synOptions)?syn.uicontrols.$textbox.controlLoad(textEL.id,eval("("+synOptions+")")):syn.uicontrols.$textbox.controlLoad(textEL.id,{}),syn.$l.get(elID+"_Button"));syn.$l.addEvent(buttonEL,"focus",function(e){var e=e.srcElement||e.target,t=window[syn.$w.pageScript];t&&(t.prop.focusControl=e)}),syn.$l.addEvent(buttonEL,"click",function(e){var r=(this&&-1<this.id.indexOf("_Button")?this:e.currentTarget).id.replace("_Button","").replace("_Code","").replace("_Text",""),e=JSON.parse(syn.$l.get(r+"_hidden").getAttribute("syn-options")),n=(e.elID=r,e.viewType="form",e.codeElementID=r+"_Code",e.textElementID=r+"_Text",e.searchValue=syn.$l.get(e.codeElementID).value,e.searchText=syn.$l.get(e.textElementID).value,syn.$l.get(e.codeElementID).value),i=syn.$l.get(e.textElementID).value;syn.uicontrols.$codepicker.find(e,function(e){e&&0<e.length&&(t=mod.event[r+"_change"])&&t(n,i,e);var t=mod.hook.frameEvent;t&&t.call(this,"codeReturn",{elID:r,result:e})})}),setting.bindingID&&syn.uicontrols.$data&&syn.uicontrols.$data.bindingSource(elID,setting.bindingID)},find(c,u){var e,t,r;1==$object.isNullOrUndefined(c.dataSourceID)?syn.$l.eventLog("$codepicker.find","dataSourceID 설정 없음","Debug"):(c.storeSourceID=c.storeSourceID||c.dataSourceID,e=c.elID+c.viewType+c.dataSourceID,(r=window[syn.$w.pageScript])&&(r.hook.frameEvent&&(t=r.hook.frameEvent("codeInit",c),c=syn.$w.argumentsExtend(c,t)),0==/(\@ApplicationID)\s*:/.test(c.parameters)&&(c.parameters="@ApplicationID:{0};".format(syn.Config.ApplicationID)+c.parameters),syn.$w.User&&syn.$w.User.WorkCompanyNo&&0==/(\@CompanyNo)\s*:/.test(c.parameters)&&(c.parameters="@CompanyNo:{0};".format(syn.$w.User.WorkCompanyNo)+c.parameters),0==/(\@LocaleID)\s*:/.test(c.parameters)&&(c.parameters="@LocaleID:{0};".format(syn.Config.Program.LocaleID)+c.parameters),r.codePickerArguments=r.codePickerArguments||{},r.codePickerArguments[e]=c),(t=$object.clone(syn.$w.dialogOptions)).minWidth=640,t.minHeight=480,t.close=!0,t.caption=(c.controlText||c.columnText||c.headerText||c.dataSourceID)+" 코드도움",r=0==$string.isNullOrEmpty(c.url)?c.url:syn.Config.SharedAssetUrl+"codehelp/index.html",syn.$w.showUIDialog(r+"?parameterID={0}".format(e),t,function(e){if(e&&0<e.length){var t,r="",n="";if(0==c.isMultiSelect)r=(l=e[0]).value,n=l.text;else{for(var i=[],o=[],s=e.length,a=0;a<s;a++){var l=e[a];i.push(l.value),o.push(l.text)}r=i.join(),n=o.join()}"form"==c.viewType?(syn.$l.get(c.codeElementID).value=r,c.textElementID&&(syn.$l.get(c.textElementID).value=n)):"grid"==c.viewType&&syn.uicontrols.$grid?(t=syn.uicontrols.$grid.getActiveRowIndex(c.elID),syn.uicontrols.$grid.setDataAtCell(c.elID,t,c.codeColumnID,r),c.textColumnID&&syn.uicontrols.$grid.setDataAtCell(c.elID,t,c.textColumnID,n)):"auigrid"==c.viewType&&syn.uicontrols.$auigrid&&(t=syn.uicontrols.$auigrid.getActiveRowIndex(c.elID),syn.uicontrols.$auigrid.setDataAtCell(c.elID,t,c.codeColumnID,r),c.textColumnID)&&syn.uicontrols.$auigrid.setDataAtCell(c.elID,t,c.textColumnID,n)}u&&u(e)}))},toParameterString(e){return e?Object.entries(e).reduce(function(e,t,r){var n=t[0],t=t[1];return-1==n.indexOf("@")&&(e+="string"==typeof t?"@"+n+":"+t+";":""),e},""):""},toParameterObject(e){return(e.match(/([^?:;]+)(:([^;]*))/g)||[]).reduce(function(e,t){return e[t.slice(0,t.indexOf(":")).replace("@","")]=t.slice(t.indexOf(":")+1),e},{})},getValue(e,t){return syn.$l.get(e+"_Code").value},setValue(e,t,r){syn.$l.get(e+"_Code").value=t},setText(e,t,r){syn.$l.get(e+"_Text").value=t},clear(e,t){syn.$l.get(e+"_Code").value="",syn.$l.get(e+"_Text").value=""},open(e){syn.$l.trigger(e+"_Button","click")},setLocale(e,t,r,n){}}),syn.uicontrols.$codepicker=$codepicker}(window),!function(h){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var p=syn.uicontrols.$colorpicker||new syn.module;p.extend({name:"syn.uicontrols.$colorpicker",version:"v2025.3.1",colorControls:[],defaultSetting:{elID:"",defaultColor:null,defineColors:["FF0000","FF4000","FF8000","FFBF00","FFFF00","BFFF00","80FF00","40FF00","00FF00","00FFFF","00BFFF","0080FF","0040FF","8000FF","BF00FF","FF00FF","FF0080","FF0080","848484","000000"],dataType:"string",belongID:null,getter:!1,setter:!1,controlText:null,validators:null,transactConfig:null,triggerConfig:null},addModuleList(e,t,r,n){var i=e.getAttribute("id"),o=e.getAttribute("syn-datafield"),e=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:e,field:o,module:this.name,type:n})},controlLoad(e,t){for(var r=syn.$l.get(e),n=(t=syn.$w.argumentsExtend(p.defaultSetting,t),h[syn.$w.pageScript]),n=(n&&n.hook.controlInit&&(n=n.hook.controlInit(e,t),t=syn.$w.argumentsExtend(t,n)),t.elID=e,r.setAttribute("id",r.id+"_hidden"),r.setAttribute("syn-options",JSON.stringify(t)),r.style.display="none",r.getAttribute("syn-datafield")),n='<div class="control">'+'<input type="text" class="form-control" id="{0}" syn-datafield="{1}" syn-options="{editType: \'text\', maskPattern: \'#SSSSSS\', dataType: \'string\', belongID: \'{2}\'}" />'.format(e,n,t.belongID)+'<button type="button" id="{0}_Button" type="button" class="btn btn-default btn-code-search"></button>'.format(e)+"</div>",r=r.parentNode,i=syn.$m.create({tag:"div",id:e+"_box",className:"control-set"}),o=(i.innerHTML=n,r.appendChild(i),syn.uicontrols.$textbox.controlLoad(e),t.field=syn.$l.get(e),t.trigger=syn.$l.get(e+"_Button"),syn.$l.addEvent(t.trigger,"click",function(e){o[o.visible?"exit":"enter"]()}),new CP(t.field)),s=(1==$object.isString(t.defaultColor)&&o.set(t.defaultColor),document.createElement("span")),a=(s.className="color-pickers",o.self.appendChild(s),null),l=0,c=t.defineColors.length;l<c;++l)(a=document.createElement("span")).title="#"+t.defineColors[l],a.style.backgroundColor="#"+t.defineColors[l],syn.$l.addEvent(a,"click",function(e){o.set(this.title),o.fire("change",[this.title.slice(1)],"main-change"),e.stopPropagation()}),s.appendChild(a);var u=document.createElement("input");function d(){this.value.length&&(o.set(this.value),o.fire("change",[this.value.slice(1)]))}o.source.onclick=function(e){e.preventDefault()},u.className="color-picker-code",u.pattern="^#[A-Fa-f0-9]{6}$",u.type="text",o.on("enter",function(){u.value="#"+CP._HSV2HEX(this.get())}),o.on("change",function(e){this.source.value="#"+e,u.value="#"+e,u.style.backgroundColor="#"+e}),o.self.appendChild(u),u.oncut=d,u.onpaste=d,u.onkeyup=d,u.oninput=d,p.colorControls.push({id:e,picker:o,setting:$object.clone(t)}),t.bindingID&&syn.uicontrols.$data&&syn.uicontrols.$data.bindingSource(e,t.bindingID)},getValue(e,t){var r=null,e=p.getControl(e);return r=e?e.picker.field.value:r},setValue(e,t,r){e=p.getControl(e);e&&(e.picker.field.value=t)},colorConvert(e,t){return CP[e](t)},clear(e,t){e=p.getControl(e);e&&e.picker.clear()},getControl(e){for(var t=null,r=p.colorControls.length,n=0;n<r;n++){var i=p.colorControls[n];if(i.id==e){t=i;break}}return t},setLocale(e,t,r,n){}}),syn.uicontrols.$colorpicker=p}(window),!function(window){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var $contextmenu=syn.uicontrols.$contextmenu||new syn.module;$contextmenu.extend({name:"syn.uicontrols.$contextmenu",version:"v2025.3.1",menuControls:[],eventHooks:["close","create","beforeOpen","open","select"],defaultSetting:{target:"targetCSSSelector",delegate:"delegateCSSSelector",autoFocus:!0,closeOnWindowBlur:!0,hide:!1,show:!1,menu:[{title:"Cut",cmd:"cut"},{title:"Copy",cmd:"copy",uiIcon:"ui-icon-copy"},{title:"---"},{title:"More",children:[{title:"Sub 1",cmd:"sub1"},{title:"Sub 2",cmd:"sub1"}]}],dataType:"string",belongID:null,getter:!1,setter:!1,controlText:null,validators:null,transactConfig:null,triggerConfig:null},controlLoad(elID,setting){var el=syn.$l.get(elID),mod=(setting=syn.$w.argumentsExtend($contextmenu.defaultSetting,setting),window[syn.$w.pageScript]),moduleSettings,hookEvents=(mod&&mod.hook.controlInit&&(moduleSettings=mod.hook.controlInit(elID,setting),setting=syn.$w.argumentsExtend(setting,moduleSettings)),el.setAttribute("syn-options",JSON.stringify(setting)),el.style.display="none",el.getAttribute("syn-events"));try{hookEvents=hookEvents&&eval(hookEvents)}catch(error){syn.$l.eventLog("ContextMenu_controlLoad",error.toString(),"Debug")}for(var i=0;i<hookEvents.length;i++){var hookEvent=hookEvents[i];-1<$contextmenu.eventHooks.indexOf(hookEvent)&&1==$object.isNullOrUndefined(setting[hookEvent])&&(setting[hookEvent]=function(t,e){var r=$contextmenu.eventHooks.find(function(e){return e.toLowerCase()==t.type.replace("contextmenu","")}),n=window[syn.$w.pageScript];n&&(n=n.event?n.event["{0}_{1}".format(elID,r)]:null)&&n.apply(syn.$l.get(elID),[t,e])})}$contextmenu.menuControls.push({id:elID,context:$(setting.target).contextmenu(setting),config:setting})},getValue(e,t){return null},setValue(e,t,r){},clear(e,t){},getControl(e){for(var t=null,r=$contextmenu.menuControls.length,n=0;n<r;n++){var i=$contextmenu.menuControls[n];if(i.id==e){t=i;break}}return t},close(e){e=$contextmenu.getControl(e).context;e&&e.contextmenu("close")},enableEntry(e,t,r){e=$contextmenu.getControl(e).context;e&&e.contextmenu("enableEntry",t,r)},getEntry(e,t){var r=null,e=$contextmenu.getControl(e).context;return r=e?e.contextmenu("getEntry",t):r},setEntry(e,t,r){var n=null,e=$contextmenu.getControl(e).context;return n=e?e.contextmenu("setEntry",t,r):n},updateEntry(e,t,r){var n=null,e=$contextmenu.getControl(e).context;return n=e?e.contextmenu("updateEntry",t,r):n},showEntry(e,t,r){var n=null,e=$contextmenu.getControl(e).context;return n=e?e.contextmenu("showEntry",t,r):n},getEntryWrapper(e,t){var r=null,e=$contextmenu.getControl(e).context;return r=e?e.contextmenu("getEntryWrapper",t):r},getMenu(e){var t=null,e=$contextmenu.getControl(e).context;return t=e?e.contextmenu("getMenu"):t},isOpen(e){var t=null,e=$contextmenu.getControl(e).context;return t=e?e.contextmenu("isOpen"):t},open(e,t,r){e=$contextmenu.getControl(e).context;e&&e.contextmenu("open",t,r)},setIcon(e,t,r){var n=null,e=$contextmenu.getControl(e).context;return n=e?e.contextmenu("setIcon",t,r):n},setTitle(e,t,r){var n=null,e=$contextmenu.getControl(e).context;return n=e?e.contextmenu("setTitle",t,r):n},setLocale(e,t,r,n){}}),syn.uicontrols.$contextmenu=$contextmenu}(window),!function(i){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var d=syn.uicontrols.$data||new syn.module;d.extend({name:"syn.uicontrols.$data",version:"v2025.7.17",bindingList:[],storeList:[],propertyEvent:!0,defaultSetting:{dataSourceID:"",storeType:"Form",dataItems:[],dataType:"string",belongID:null,getter:!1,setter:!1,controlText:null,validators:null,transactConfig:null,triggerConfig:null},controlLoad(e,t){var r=syn.$l.get(e),n=(t=syn.$w.argumentsExtend(d.defaultSetting,t),i[syn.$w.pageScript]);n&&n.hook.controlInit&&(n=n.hook.controlInit(e,t),t=syn.$w.argumentsExtend(t,n)),r.setAttribute("syn-options",JSON.stringify(t)),r.style.display="none",$this.store[t.dataSourceID]="Form"==t.storeType?{}:[],d.storeList.push({id:e,dataSourceID:t.dataSourceID,storeType:t.storeType,columns:t.columns})},getValue(e,t){var r=null,e=(d.propertyEvent=!1,d.getMetaStore(e));return e&&(r=$this.store[e.dataSourceID]),d.propertyEvent=!0,r},setValue(e,t,r){},clear(e,t){d.propertyEvent=!1;e=d.getMetaStore(e);if(e){let n=$this.store[e.dataSourceID];"Form"==e.storeType&&e.columns?e.columns.forEach(e=>{var t=e.data;let r;switch(e.dataType){case"string":r="";break;case"number":case"numeric":case"int":r=0;break;case"bool":case"boolean":r=!1;break;default:r=null}n[t]=r}):n.length&&0<n.length&&(n.length=0)}d.propertyEvent=!0},getMetaStore(e){for(var t=null,r=d.storeList.length,n=0;n<r;n++){var i=d.storeList[n];if(i.id==e){t=i;break}}return t},reactionGetValue(t,r,n){var e=null,i=d.bindingList.find(function(e){return e.elID==t&&e.dataSourceID==r&&e.dataFieldID==n});if(i){var o=d.storeList.find(function(e){return e.dataSourceID==i.dataSourceID});if(-1<i.controlType.indexOf("grid")||"list"==i.controlType||"chart"==i.controlType){for(var s={},a=o.columns.length,l=0;l<a;l++){var c=o.columns[l];s[c.data]={fieldID:c.data,dataType:c.dataType}}var u="Form"==o.storeType?"Row":"List",e=i.controlModule.getValue(t,u,s)}else e=i.controlModule.getValue(t)}return e},reactionSetValue(t,r,n,e){var i=d.bindingList.find(function(e){return e.elID==t&&e.dataSourceID==r&&e.dataFieldID==n});if(i){var o=d.storeList.find(function(e){return e.dataSourceID==i.dataSourceID});if(-1<i.controlType.indexOf("grid")||"list"==i.controlType||"chart"==i.controlType){for(var s={},a=o.columns.length,l=0;l<a;l++){var c=o.columns[l];s[c.data]={fieldID:c.data,dataType:c.dataType}}i.controlModule.setValue(t,e,s)}else i.controlModule.setValue(t,e)}},bindingSource(t,r){var e=$this.store[r],n=syn.$l.get(t+"_hidden")||syn.$l.get(t);if(0==$object.isNullOrUndefined(n)){var i=n.tagName.toUpperCase(),o=null,s=null;if(-1<i.indexOf("SYN_"))var a=i.substring(4).toLowerCase(),o=syn.uicontrols["$"+a],s=a;else switch(i){case"BUTTON":o=syn.uicontrols.$button,s="button";break;case"INPUT":switch(s=(n.getAttribute("type")||"text").toLowerCase()){case"hidden":case"text":case"password":case"color":case"email":case"number":case"search":case"tel":case"url":o=syn.uicontrols.$textbox;break;case"submit":case"reset":case"button":o=syn.uicontrols.$button;break;case"radio":o=syn.uicontrols.$radio;break;case"checkbox":o=syn.uicontrols.$checkbox}break;case"TEXTAREA":o=syn.uicontrols.$textarea,s="textarea";break;case"SELECT":s=null==n.getAttribute("multiple")?(o=syn.uicontrols.$select,"select"):(o=syn.uicontrols.$multiselect,"multiselect")}var l=n.getAttribute("syn-datafield");l?null==("grid"==s||"list"==s||"chart"==s?d.bindingList.find(function(e){return e.dataSourceID==r}):d.bindingList.find(function(e){return e.elID==t&&e.dataSourceID==r&&e.dataFieldID==l}))?(d.bindingList.push({elID:t,dataSourceID:r,dataFieldID:l,controlModule:o,controlType:s}),Object.defineProperty(e,l,{get(){if(1==d.propertyEvent)return d.reactionGetValue(t,r,l)},set(e){1==d.propertyEvent&&d.reactionSetValue(t,r,l,e)},configurable:!0,enumerable:!0})):syn.$l.eventLog("$data.bindingSource","binding 정보 확인 필요 - elID: {0}, dataSourceID: {1}, dataFieldID: {2}, controlType: {3}, ".format(t,r,l,s),"Warning"):syn.$l.eventLog("$data.bindingSource","dataFieldID 확인 필요","Warning")}else syn.$l.eventLog("$data.bindingSource",'"{0}" elID 확인 필요'.format(t),"Warning")},setLocale(e,t,r,n){}}),syn.uicontrols.$data=d}(window),!function(window){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var $datepicker=syn.uicontrols.$datepicker||new syn.module;$datepicker.extend({name:"syn.uicontrols.$datepicker",version:"v2025.3.1",dateControls:[],defaultSetting:{elID:"",width:"100%",value:"",defaultDate:null,setDefaultDate:!1,minDate:null,maxDate:null,bound:!0,format:"YYYY-MM-DD",ariaLabel:"날짜를 선택 하세요",i18n:{previousMonth:"이전 달",nextMonth:"다음 달",months:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],weekdays:["일요일","월요일","화요일","수요일","목요일","금요일","토요일"],weekdaysShort:["일","월","화","수","목","금","토"]},showWeekNumber:!1,showMonthAfterYear:!0,showDaysInNextAndPreviousMonths:!0,enableSelectionDaysInNextAndPreviousMonths:!0,yearSuffix:"년",firstDay:0,useRangeSelect:!1,rangeStartControlID:null,rangeEndControlID:null,numberOfMonths:1,dataType:"string",belongID:null,getter:!1,setter:!1,controlText:null,validators:null,transactConfig:null,triggerConfig:null},addModuleList(e,t,r,n){var i=e.getAttribute("id"),o=e.getAttribute("syn-datafield"),e=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:e,field:o,module:this.name,type:n})},controlLoad(elID,setting){var el=syn.$l.get(elID),mod=(setting=syn.$w.argumentsExtend($datepicker.defaultSetting,setting),window[syn.$w.pageScript]),moduleSettings,dataField=(mod&&mod.hook.controlInit&&(moduleSettings=mod.hook.controlInit(elID,setting),setting=syn.$w.argumentsExtend(setting,moduleSettings)),!0===setting.useRangeSelect&&(1==$object.isNullOrUndefined(setting.rangeStartControlID)&&(setting.rangeStartControlID=elID),1==$object.isNullOrUndefined(setting.rangeEndControlID))&&(setting.rangeEndControlID=elID),el.getAttribute("syn-datafield")),events=el.getAttribute("syn-events"),textbox=syn.$m.create({id:elID,tag:"input",className:"form-control"}),button=(textbox.type="text",0==$string.isNullOrEmpty(dataField)&&textbox.setAttribute("syn-datafield",dataField),setting.elID=elID,el.setAttribute("id",el.id+"_hidden"),el.setAttribute("syn-options",JSON.stringify(setting)),el.removeAttribute("syn-datafield"),el.style.display="none",1==$string.isNullOrEmpty(setting.belongID)?textbox.setAttribute("syn-options","{editType: 'date', maskPattern: '9999-99-99', dataType: 'string'}"):1==$object.isArray(setting.belongID)?textbox.setAttribute("syn-options",`{editType: 'date', maskPattern: '9999-99-99', dataType: 'string', belongID: ${JSON.stringify(setting.belongID)}}`):textbox.setAttribute("syn-options",`{editType: 'date', maskPattern: '9999-99-99', dataType: 'string', belongID: '${setting.belongID}'}`),0==$object.isNullOrUndefined(events)&&textbox.setAttribute("syn-events",events),syn.$m.insertAfter(textbox,el),syn.$m.create({id:elID+"_Button",tag:"button",className:"btn btn-icon f:20! bg-muted-lt"})),picker=(button.innerHTML='<i class="ti ti-calendar"></i>',syn.$m.insertAfter(button,textbox),syn.uicontrols.$textbox.controlLoad(elID,eval("("+syn.$l.get(elID).getAttribute("syn-options")+")")),setting.field=syn.$l.get(elID),setting=syn.$w.argumentsExtend({onOpen(){var e=this._o.elID,t=this.getDate(),r=($datepicker.updateRangeDate(e,t),window[syn.$w.pageScript]),n="{0}_onselect".format(e);r&&r.event[n]&&r.event[n](e,t)},onClose(){var e=this._o.elID,t=this.getDate(),r=($datepicker.updateRangeDate(e,t),window[syn.$w.pageScript]),n="{0}_onselect".format(e);r&&r.event[n]&&r.event[n](e,t)},onSelect(e){var t,r,n;e&&(t=this._o.elID,$datepicker.updateRangeDate(t,e),r=window[syn.$w.pageScript],n="{0}_onselect".format(t),r)&&r.event[n]&&r.event[n](t,e)}},setting),moment&&"ko"!=moment.locale()&&moment.locale("ko",{months:"1월_2월_3월_4월_5월_6월_7월_8월_9월_10월_11월_12월".split("_"),monthsShort:"1월_2월_3월_4월_5월_6월_7월_8월_9월_10월_11월_12월".split("_"),weekdays:"일요일_월요일_화요일_수요일_목요일_금요일_토요일".split("_"),weekdaysShort:"일_월_화_수_목_금_토".split("_"),weekdaysMin:"일_월_화_수_목_금_토".split("_"),longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"YYYY.MM.DD.",LL:"YYYY년 MMMM D일",LLL:"YYYY년 MMMM D일 A h:mm",LLLL:"YYYY년 MMMM D일 dddd A h:mm",l:"YYYY.MM.DD.",ll:"YYYY년 MMMM D일",lll:"YYYY년 MMMM D일 A h:mm",llll:"YYYY년 MMMM D일 dddd A h:mm"},calendar:{sameDay:"오늘 LT",nextDay:"내일 LT",nextWeek:"dddd LT",lastDay:"어제 LT",lastWeek:"지난주 dddd LT",sameElse:"L"},relativeTime:{future:"%s 후",past:"%s 전",s:"몇 초",ss:"%d초",m:"1분",mm:"%d분",h:"한 시간",hh:"%d시간",d:"하루",dd:"%d일",M:"한 달",MM:"%d달",y:"일 년",yy:"%d년"},dayOfMonthOrdinalParse:/\d{1,2}(일|월|주)/,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"일";case"M":return e+"월";case"w":case"W":return e+"주";default:return e}},meridiemParse:/오전|오후/,isPM:function(e){return"오후"===e},meridiem:function(e,t,r){return e<12?"오전":"오후"}}),new Pikaday(setting)),value,date;0==$string.isNullOrEmpty(setting.value)&&(value=setting.value,date=null,"now"==value?date=new Date:1==value.startsWith("day:")?date=$date.addDay(new Date,$string.toNumber(value.split(":")[1])):1==value.startsWith("week:")?date=$date.addWeek(new Date,$string.toNumber(value.split(":")[1])):1==value.startsWith("month:")?date=$date.addMonth(new Date,$string.toNumber(value.split(":")[1])):1==value.startsWith("year:")&&(date=$date.addYear(new Date,$string.toNumber(value.split(":")[1]))),date)&&picker.setDate($date.toString(date,"d")),syn.$l.addEvent(syn.$l.get(elID+"_Button"),"click",function(e){picker[picker.isVisible()?"hide":"show"]()}),$datepicker.dateControls.push({id:elID,picker:picker,setting:$object.clone(setting)}),setting.bindingID&&syn.uicontrols.$data&&syn.uicontrols.$data.bindingSource(elID,setting.bindingID)},getValue(e,t){var r=null,e=$datepicker.getControl(e);return r=e?e.picker._o.field.value:r},setValue(e,t,r){e=$datepicker.getControl(e);e&&e.picker.setDate(t)},clear(e,t){e=$datepicker.getControl(e);e&&e.picker.clear()},getControl(e){for(var t=null,r=$datepicker.dateControls.length,n=0;n<r;n++){var i=$datepicker.dateControls[n];if(i.id==e){t=i;break}}return t},updateRangeDate(e,t){var r,n,i,o=syn.$l.get(e);0==$object.isNullOrUndefined(o)&&(o=$datepicker.getControl(e))&&!0===o.setting.useRangeSelect&&(o.setting.rangeStartControlID==e?(r=o.picker,n=null,(i=$datepicker.getControl(o.setting.rangeEndControlID))&&(n=i.picker),r&&n&&$datepicker.updateStartDate(r,n,t)):o.setting.rangeEndControlID==e&&(r=null,n=o.picker,r=(i=$datepicker.getControl(o.setting.rangeStartControlID))?i.picker:r)&&n&&$datepicker.updateEndDate(r,n,t))},updateStartDate(e,t,r){e.setStartRange(r),t.setStartRange(r),t.setMinDate(r)},updateEndDate(e,t,r){e.setEndRange(r),e.setMaxDate(r),t.setEndRange(r)},setLocale(e,t,r,n){}}),syn.uicontrols.$datepicker=$datepicker}(window),!function(window){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var $dateperiodpicker=syn.uicontrols.$dateperiodpicker||new syn.module;$dateperiodpicker.extend({name:"syn.uicontrols.$dateperiodpicker",version:"v2025.5.12",dateControls:[],selectedYear:null,pkaStartDate:null,pkaEndDate:null,periodPickerHtml:'<div class=card-body><div class="row g-1"><div class="col pl-0"><button class="btn w-100 border-color:#ccc!"id=_DatePeriodPicker_btnThisYear>올해</button></div><div class=col><button class="btn w-100 border-color:#ccc!"id=_DatePeriodPicker_btnUntilToday>오늘까지</button></div><div class=col><button class="btn w-100 border-color:#ccc!"id=_DatePeriodPicker_btnToday>오늘</button></div><div class=col><button class="btn w-100 border-color:#ccc!"id=_DatePeriodPicker_btnPreviousDay>전일</button></div><div class=col><button class="btn w-100 border-color:#ccc!"id=_DatePeriodPicker_btnWeekly>주간</button></div><div class=col><button class="btn w-100 border-color:#ccc!"id=_DatePeriodPicker_btnPreviousWeek>전주</button></div><div class=col><button class="btn w-100 border-color:#ccc!"id=_DatePeriodPicker_btnThisMonth>당월</button></div><div class=col><button class="btn w-100 border-color:#ccc!"id=_DatePeriodPicker_btnPreviousMonth>이전달</button></div></div><div class="row g-1 mt-1"><div class="col pl-0"><button class="btn w-100 border-color:#ccc!"id=_DatePeriodPicker_btnPreviousYear>전년도</button></div><div class=col><button class="btn w-100 border-color:#ccc!"id=_DatePeriodPicker_btnTwoYearAgo>전전년도</button></div><div class=col><button class="btn w-100 border-color:#ccc!"id=_DatePeriodPicker_btnQuarter1>1분기</button></div><div class=col><button class="btn w-100 border-color:#ccc!"id=_DatePeriodPicker_btnQuarter2>2분기</button></div><div class=col><button class="btn w-100 border-color:#ccc!"id=_DatePeriodPicker_btnQuarter3>3분기</button></div><div class=col><button class="btn w-100 border-color:#ccc!"id=_DatePeriodPicker_btnQuarter4>4분기</button></div><div class=col><button class="btn w-100 border-color:#ccc!"id=_DatePeriodPicker_btnFirstHalf>상반기</button></div><div class=col><button class="btn w-100 border-color:#ccc!"id=_DatePeriodPicker_btnSecondHalf>하반기</button></div></div><div class="row g-1 mt-1"><div class="col pl-0"><div class="w-100 btn-group"role=group><input id=_DatePeriodPicker_chkPeriodMonth1 type=checkbox class=btn-check value=01> <label class="btn p-2"for=_DatePeriodPicker_chkPeriodMonth1>1월</label> <input id=_DatePeriodPicker_chkPeriodMonth2 type=checkbox class=btn-check value=02> <label class="btn p-2"for=_DatePeriodPicker_chkPeriodMonth2>2월</label> <input id=_DatePeriodPicker_chkPeriodMonth3 type=checkbox class=btn-check value=03> <label class="btn p-2"for=_DatePeriodPicker_chkPeriodMonth3>3월</label> <input id=_DatePeriodPicker_chkPeriodMonth4 type=checkbox class=btn-check value=04> <label class="btn p-2"for=_DatePeriodPicker_chkPeriodMonth4>4월</label> <input id=_DatePeriodPicker_chkPeriodMonth5 type=checkbox class=btn-check value=05> <label class="btn p-2"for=_DatePeriodPicker_chkPeriodMonth5>5월</label> <input id=_DatePeriodPicker_chkPeriodMonth6 type=checkbox class=btn-check value=06> <label class="btn p-2"for=_DatePeriodPicker_chkPeriodMonth6>6월</label> <input id=_DatePeriodPicker_chkPeriodMonth7 type=checkbox class=btn-check value=07> <label class="btn p-2"for=_DatePeriodPicker_chkPeriodMonth7>7월</label> <input id=_DatePeriodPicker_chkPeriodMonth8 type=checkbox class=btn-check value=08> <label class="btn p-2"for=_DatePeriodPicker_chkPeriodMonth8>8월</label> <input id=_DatePeriodPicker_chkPeriodMonth9 type=checkbox class=btn-check value=09> <label class="btn p-2"for=_DatePeriodPicker_chkPeriodMonth9>9월</label> <input id=_DatePeriodPicker_chkPeriodMonth10 type=checkbox class=btn-check value=10> <label class="btn p-2"for=_DatePeriodPicker_chkPeriodMonth10>10월</label> <input id=_DatePeriodPicker_chkPeriodMonth11 type=checkbox class=btn-check value=11> <label class="btn p-2"for=_DatePeriodPicker_chkPeriodMonth11>11월</label> <input id=_DatePeriodPicker_chkPeriodMonth12 type=checkbox class=btn-check value=12> <label class="btn p-2"for=_DatePeriodPicker_chkPeriodMonth12>12월</label></div></div></div><div class="row mt-2"><div class="col pl-0"><div class=h:227 id=calStartDate></div><input id=_DatePeriodPicker_txtStartDate type=hidden></div><div class="col pl-0"><div class=h:227 id=calEndDate></div><input id=_DatePeriodPicker_txtEndDate type=hidden></div></div></div><div class="p-2 card-footer"><div class="row align-items-center"><div class=col>선택기간: <span id=spnPeriodDate>0일</span></div><div class=col-auto><div class="btn-list flex-nowrap"><button class="btn w-100 btn-primary"id=_DatePeriodPicker_btnConfirm>확인</button></div></div></div></div>',defaultSetting:{elID:"",width:"100%",value:"",defaultDate:null,setDefaultDate:!1,minDate:null,maxDate:null,bound:!1,format:"YYYY-MM-DD",ariaLabel:"날짜를 선택 하세요",i18n:{previousMonth:"이전 달",nextMonth:"다음 달",months:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],weekdays:["일요일","월요일","화요일","수요일","목요일","금요일","토요일"],weekdaysShort:["일","월","화","수","목","금","토"]},showWeekNumber:!1,showMonthAfterYear:!0,showDaysInNextAndPreviousMonths:!0,enableSelectionDaysInNextAndPreviousMonths:!0,yearSuffix:"년",firstDay:0,numberOfMonths:1,startDataFieldID:"",endDataFieldID:"",dataType:"string",belongID:null,getter:!1,setter:!1,controlText:null,validators:null,transactConfig:null,triggerConfig:null},addModuleList(e,t,r,n){var i=e.getAttribute("id"),o=e.getAttribute("syn-datafield"),e=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:e,field:o,module:this.name,type:n})},controlLoad(elID,setting){var el=syn.$l.get(elID),mod=(setting=syn.$w.argumentsExtend($dateperiodpicker.defaultSetting,setting),window[syn.$w.pageScript]),moduleSettings,events=(mod&&mod.hook.controlInit&&(moduleSettings=mod.hook.controlInit(elID,setting),setting=syn.$w.argumentsExtend(setting,moduleSettings)),setting.elID=elID,el.setAttribute("id",el.id+"_hidden"),el.setAttribute("syn-options",JSON.stringify(setting)),el.style.display="none",el.getAttribute("syn-events")),textbox1ID=elID+"_StartedAt",dataField1ID=setting.startDataFieldID||elID+"_StartedAt",textbox1=syn.$m.create({id:textbox1ID,tag:"input",className:"form-control"}),span=(textbox1.type="text",textbox1.setAttribute("syn-datafield",dataField1ID),1==$string.isNullOrEmpty(setting.belongID)?textbox1.setAttribute("syn-options","{editType: 'date', maskPattern: '9999-99-99', dataType: 'string'}"):1==$object.isArray(setting.belongID)?textbox1.setAttribute("syn-options",`{editType: 'date', maskPattern: '9999-99-99', dataType: 'string', belongID: ${JSON.stringify(setting.belongID)}}`):textbox1.setAttribute("syn-options",`{editType: 'date', maskPattern: '9999-99-99', dataType: 'string', belongID: '${setting.belongID}'}`),0==$object.isNullOrUndefined(events)&&textbox1.setAttribute("syn-events",events),syn.$m.insertAfter(textbox1,el),syn.$l.addEvent(textbox1,"blur",e=>{var e=e.currentTarget.id.replace("_StartedAt",""),t=e+"_StartedAt",e=e+"_EndedAt",r=syn.$l.get(t).value.trim(),e=syn.$l.get(e).value.trim();e<r&&(syn.$l.get(t).value=e||$date.toString(new Date,"d"))}),syn.$m.create({id:elID+"_Span",tag:"span",className:"input-group-text p-1 border-0 bg:#fff!"})),textbox2ID=(span.innerHTML="~",syn.$m.insertAfter(span,textbox1),elID+"_EndedAt"),dataField1ID=setting.endDataFieldID||elID+"_EndedAt",textbox2=syn.$m.create({id:textbox2ID,tag:"input",className:"form-control"}),button=(textbox2.type="text",textbox2.setAttribute("syn-datafield",dataField1ID),1==$string.isNullOrEmpty(setting.belongID)?textbox2.setAttribute("syn-options","{editType: 'date', maskPattern: '9999-99-99', dataType: 'string'}"):1==$object.isArray(setting.belongID)?textbox2.setAttribute("syn-options",`{editType: 'date', maskPattern: '9999-99-99', dataType: 'string', belongID: ${JSON.stringify(setting.belongID)}}`):textbox2.setAttribute("syn-options",`{editType: 'date', maskPattern: '9999-99-99', dataType: 'string', belongID: '${setting.belongID}'}`),0==$object.isNullOrUndefined(events)&&textbox2.setAttribute("syn-events",events),syn.$m.insertAfter(textbox2,span),syn.$l.addEvent(textbox2,"blur",e=>{var e=e.currentTarget.id.replace("_EndedAt",""),t=e+"_StartedAt",e=e+"_EndedAt",t=syn.$l.get(t).value.trim();syn.$l.get(e).value.trim()<t&&(syn.$l.get(e).value=t||$date.toString(new Date,"d"))}),syn.$m.create({id:elID+"_Button",tag:"button",className:"btn btn-icon f:20! bg-muted-lt"})),divPeriodPicker,pkaStartSetting,pkaEndSetting,value,number,date,textbox1,textbox2,textbox1,textbox2;button.innerHTML='<i class="ti ti-calendar"></i>',syn.$m.insertAfter(button,textbox2),syn.uicontrols.$textbox.controlLoad(textbox1ID,eval("("+syn.$l.get(textbox1ID).getAttribute("syn-options")+")")),syn.uicontrols.$textbox.controlLoad(textbox2ID,eval("("+syn.$l.get(textbox2ID).getAttribute("syn-options")+")")),setting.field=el,null==syn.$l.get("divPeriodPicker")&&(divPeriodPicker=syn.$m.create({id:"divPeriodPicker",tag:"div",className:"card absolute w:568 z-index:100 border-radius:0! border:1px|solid|#ccc! hidden"}),divPeriodPicker.innerHTML=$dateperiodpicker.periodPickerHtml,divPeriodPicker.style.cssText="box-shadow: 0 5px 15px -5px rgba(0, 0, 0, 0.5);",document.body.appendChild(divPeriodPicker),syn.$l.addEvent("_DatePeriodPicker_btnThisYear","click",$dateperiodpicker._DatePeriodPicker_btnThisYear_click),syn.$l.addEvent("_DatePeriodPicker_btnUntilToday","click",$dateperiodpicker._DatePeriodPicker_btnUntilToday_click),syn.$l.addEvent("_DatePeriodPicker_btnToday","click",$dateperiodpicker._DatePeriodPicker_btnToday_click),syn.$l.addEvent("_DatePeriodPicker_btnPreviousDay","click",$dateperiodpicker._DatePeriodPicker_btnPreviousDay_click),syn.$l.addEvent("_DatePeriodPicker_btnTomorrow","click",$dateperiodpicker._DatePeriodPicker_btnTomorrow_click),syn.$l.addEvent("_DatePeriodPicker_btnWeekly","click",$dateperiodpicker._DatePeriodPicker_btnWeekly_click),syn.$l.addEvent("_DatePeriodPicker_btnPreviousWeek","click",$dateperiodpicker._DatePeriodPicker_btnPreviousWeek_click),syn.$l.addEvent("_DatePeriodPicker_btnThisMonth","click",$dateperiodpicker._DatePeriodPicker_btnThisMonth_click),syn.$l.addEvent("_DatePeriodPicker_btnPreviousMonth","click",$dateperiodpicker._DatePeriodPicker_btnPreviousMonth_click),syn.$l.addEvent("_DatePeriodPicker_btnPreviousYear","click",$dateperiodpicker._DatePeriodPicker_btnPreviousYear_click),syn.$l.addEvent("_DatePeriodPicker_btnTwoYearAgo","click",$dateperiodpicker._DatePeriodPicker_btnTwoYearAgo_click),syn.$l.addEvent("_DatePeriodPicker_btnQuarter1","click",$dateperiodpicker._DatePeriodPicker_btnQuarter1_click),syn.$l.addEvent("_DatePeriodPicker_btnQuarter2","click",$dateperiodpicker._DatePeriodPicker_btnQuarter2_click),syn.$l.addEvent("_DatePeriodPicker_btnQuarter3","click",$dateperiodpicker._DatePeriodPicker_btnQuarter3_click),syn.$l.addEvent("_DatePeriodPicker_btnQuarter4","click",$dateperiodpicker._DatePeriodPicker_btnQuarter4_click),syn.$l.addEvent("_DatePeriodPicker_btnFirstHalf","click",$dateperiodpicker._DatePeriodPicker_btnFirstHalf_click),syn.$l.addEvent("_DatePeriodPicker_btnSecondHalf","click",$dateperiodpicker._DatePeriodPicker_btnSecondHalf_click),syn.$l.addEvent("_DatePeriodPicker_btnConfirm","click",$dateperiodpicker._DatePeriodPicker_btnConfirm_click),syn.$l.addEvent(syn.$l.querySelector('[for="_DatePeriodPicker_chkPeriodMonth1"]'),"click",$dateperiodpicker._DatePeriodPicker_chkPeriodMonth_click),syn.$l.addEvent(syn.$l.querySelector('[for="_DatePeriodPicker_chkPeriodMonth2"]'),"click",$dateperiodpicker._DatePeriodPicker_chkPeriodMonth_click),syn.$l.addEvent(syn.$l.querySelector('[for="_DatePeriodPicker_chkPeriodMonth3"]'),"click",$dateperiodpicker._DatePeriodPicker_chkPeriodMonth_click),syn.$l.addEvent(syn.$l.querySelector('[for="_DatePeriodPicker_chkPeriodMonth4"]'),"click",$dateperiodpicker._DatePeriodPicker_chkPeriodMonth_click),syn.$l.addEvent(syn.$l.querySelector('[for="_DatePeriodPicker_chkPeriodMonth5"]'),"click",$dateperiodpicker._DatePeriodPicker_chkPeriodMonth_click),syn.$l.addEvent(syn.$l.querySelector('[for="_DatePeriodPicker_chkPeriodMonth6"]'),"click",$dateperiodpicker._DatePeriodPicker_chkPeriodMonth_click),syn.$l.addEvent(syn.$l.querySelector('[for="_DatePeriodPicker_chkPeriodMonth7"]'),"click",$dateperiodpicker._DatePeriodPicker_chkPeriodMonth_click),syn.$l.addEvent(syn.$l.querySelector('[for="_DatePeriodPicker_chkPeriodMonth8"]'),"click",$dateperiodpicker._DatePeriodPicker_chkPeriodMonth_click),syn.$l.addEvent(syn.$l.querySelector('[for="_DatePeriodPicker_chkPeriodMonth9"]'),"click",$dateperiodpicker._DatePeriodPicker_chkPeriodMonth_click),syn.$l.addEvent(syn.$l.querySelector('[for="_DatePeriodPicker_chkPeriodMonth10"]'),"click",$dateperiodpicker._DatePeriodPicker_chkPeriodMonth_click),syn.$l.addEvent(syn.$l.querySelector('[for="_DatePeriodPicker_chkPeriodMonth11"]'),"click",$dateperiodpicker._DatePeriodPicker_chkPeriodMonth_click),syn.$l.addEvent(syn.$l.querySelector('[for="_DatePeriodPicker_chkPeriodMonth12"]'),"click",$dateperiodpicker._DatePeriodPicker_chkPeriodMonth_click),$dateperiodpicker.selectedYear=$date.toString(new Date,"y"),pkaStartSetting=$object.clone(setting),pkaStartSetting.field=syn.$l.get("_DatePeriodPicker_txtStartDate"),pkaStartSetting.container=syn.$l.get("calStartDate"),pkaStartSetting.onSelect=date=>{var elID,target,startedAt,endedAt,popup,control,textbox1,mod,events,selectFunction;1==$object.isNullOrUndefined(date)||(elID=arguments[0],target=window.event&&window.event.currentTarget,target&&target.id==elID+"_Button")||(startedAt=$dateperiodpicker.pkaStartDate.getDate(),endedAt=$dateperiodpicker.pkaEndDate.getDate(),syn.$l.get("spnPeriodDate").innerText=$date.diff(startedAt,endedAt)+1+"일",$dateperiodpicker.pkaEndDate.setMinDate(startedAt),$dateperiodpicker.checkPeriodMonth(),popup=syn.$l.get("divPeriodPicker"),0==syn.$m.hasClass(popup,"hidden")&&(control=$dateperiodpicker.getControl(elID),control)&&(textbox1=syn.$l.get(control.textbox1ID),mod=window[syn.$w.pageScript],events=eval(textbox1.getAttribute("syn-events")),selectFunction="{0}_onselect".format(elID),events)&&events.includes("onselect")&&mod&&mod.event[selectFunction]&&mod.event[selectFunction](elID,"startedAt",date))},$dateperiodpicker.pkaStartDate=new Pikaday(pkaStartSetting),pkaEndSetting=$object.clone(setting),pkaEndSetting.field=syn.$l.get("_DatePeriodPicker_txtEndDate"),pkaEndSetting.container=syn.$l.get("calEndDate"),pkaEndSetting.onSelect=date=>{var elID,target,startedAt,endedAt,popup,control,textbox2,mod,events,selectFunction;1==$object.isNullOrUndefined(date)||(elID=arguments[0],target=window.event&&window.event.currentTarget,target&&target.id==elID+"_Button")||(startedAt=$dateperiodpicker.pkaStartDate.getDate(),endedAt=$dateperiodpicker.pkaEndDate.getDate(),syn.$l.get("spnPeriodDate").innerText=$date.diff(startedAt,endedAt)+1+"일",$dateperiodpicker.pkaStartDate.setMaxDate(endedAt),$dateperiodpicker.checkPeriodMonth(),popup=syn.$l.get("divPeriodPicker"),0==syn.$m.hasClass(popup,"hidden")&&(control=$dateperiodpicker.getControl(elID),control)&&(textbox2=syn.$l.get(control.textbox2ID),mod=window[syn.$w.pageScript],events=eval(textbox2.getAttribute("syn-events")),selectFunction="{0}_onselect".format(elID),events)&&events.includes("onselect")&&mod&&mod.event[selectFunction]&&mod.event[selectFunction](elID,"endedAt",date))},$dateperiodpicker.pkaEndDate=new Pikaday(pkaEndSetting),syn.$l.addEvent(document.body,"click",e=>{var t,r=syn.$l.get("divPeriodPicker");if(r&&0==syn.$m.hasClass(r,"hidden"))return t=r.getAttribute("elID"),0==r.contains(e.target)&&(r=e.target.closest("button"),1!=$string.isNullOrEmpty(e.target.data)||1!=$object.isNullOrUndefined(r)&&0!=r.id.startsWith(t)||$dateperiodpicker.hidePopup()),e.returnValue=!1,e.cancel=!0,e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),!1})),moment&&"ko"!=moment.locale()&&moment.locale("ko",{months:"1월_2월_3월_4월_5월_6월_7월_8월_9월_10월_11월_12월".split("_"),monthsShort:"1월_2월_3월_4월_5월_6월_7월_8월_9월_10월_11월_12월".split("_"),weekdays:"일요일_월요일_화요일_수요일_목요일_금요일_토요일".split("_"),weekdaysShort:"일_월_화_수_목_금_토".split("_"),weekdaysMin:"일_월_화_수_목_금_토".split("_"),longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"YYYY.MM.DD.",LL:"YYYY년 MMMM D일",LLL:"YYYY년 MMMM D일 A h:mm",LLLL:"YYYY년 MMMM D일 dddd A h:mm",l:"YYYY.MM.DD.",ll:"YYYY년 MMMM D일",lll:"YYYY년 MMMM D일 A h:mm",llll:"YYYY년 MMMM D일 dddd A h:mm"},calendar:{sameDay:"오늘 LT",nextDay:"내일 LT",nextWeek:"dddd LT",lastDay:"어제 LT",lastWeek:"지난주 dddd LT",sameElse:"L"},relativeTime:{future:"%s 후",past:"%s 전",s:"몇 초",ss:"%d초",m:"1분",mm:"%d분",h:"한 시간",hh:"%d시간",d:"하루",dd:"%d일",M:"한 달",MM:"%d달",y:"일 년",yy:"%d년"},dayOfMonthOrdinalParse:/\d{1,2}(일|월|주)/,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"일";case"M":return e+"월";case"w":case"W":return e+"주";default:return e}},meridiemParse:/오전|오후/,isPM:function(e){return"오후"===e},meridiem:function(e,t,r){return e<12?"오전":"오후"}}),0==$string.isNullOrEmpty(setting.value)&&(value=setting.value,number=$string.toNumber(value.split(":")[1]),date=null,"now"==value?date=new Date:1==value.startsWith("day:")?date=$date.addDay(new Date,number):1==value.startsWith("week:")?date=$date.addWeek(new Date,number):1==value.startsWith("month:")?date=$date.addMonth(new Date,number):1==value.startsWith("year:")&&(date=$date.addYear(new Date,number)),number<0?date&&(textbox1=syn.$l.get(textbox1ID),textbox1.value=$date.toString(date,"d"),textbox2=syn.$l.get(textbox2ID),textbox2.value=$date.toString(new Date,"d")):date&&(textbox1=syn.$l.get(textbox1ID),textbox1.value=$date.toString(new Date,"d"),textbox2=syn.$l.get(textbox2ID),textbox2.value=$date.toString(date,"d"))),syn.$l.addEvent(syn.$l.get(elID+"_Button"),"click",function(e){var t,e=e.currentTarget.id.replace("_Button",""),r=$date.toString(new Date,"d"),n=$dateperiodpicker.getControl(e);n?(t=syn.$l.get(n.textbox1ID),t=$date.toString(new Date(t.value||r),"d"),n=syn.$l.get(n.textbox2ID),n=$date.toString(new Date(n.value||r),"d"),$dateperiodpicker.pkaStartDate.setDate(t),$dateperiodpicker.pkaEndDate.setDate(n),$dateperiodpicker.setDateRange(t,n)):($dateperiodpicker.pkaStartDate.setDate(r),$dateperiodpicker.pkaEndDate.setDate(r),$dateperiodpicker.setDateRange(r,r)),$dateperiodpicker.checkPeriodMonth(),$dateperiodpicker.showPopup(e)}),$dateperiodpicker.dateControls.push({id:elID,textbox1ID:textbox1ID,textbox2ID:textbox2ID,setting:$object.clone(setting)}),setting.bindingID&&syn.uicontrols.$data&&syn.uicontrols.$data.bindingSource(elID,setting.bindingID)},showPopup(e){var t=$dateperiodpicker.getControl(e);if(t){for(var t=syn.$l.get(t.textbox1ID),r=syn.$l.get("divPeriodPicker"),e=(r.setAttribute("elID",e),t.getBoundingClientRect()),n=(syn.$m.removeClass(r,"hidden"),[{top:e.bottom+window.scrollY,left:e.left+window.scrollX},{top:e.top+window.scrollY-r.offsetHeight,left:e.left+window.scrollX}]),i=n[0],o=window.innerWidth,s=window.innerHeight,a=0;a<n.length;a++){var l=n[a];if(0<=l.left&&l.left+r.offsetWidth<=o&&0<=l.top&&l.top+r.offsetHeight<=s){i=l;break}}r.style.top=i.top+"px",r.style.left=i.left+"px"}},hidePopup(){var e=syn.$l.get("divPeriodPicker");syn.$m.addClass(e,"hidden")},getValue(e,t){var r,n,i=null,e=$dateperiodpicker.getControl(e);return e&&(n=r="",i=(r=e.textbox1ID&&syn.$l.get(e.textbox1ID)?syn.$l.get(e.textbox1ID).value:r)+" ~ "+(n=e.textbox1ID&&syn.$l.get(e.textbox2ID)?syn.$l.get(e.textbox2ID).value:n)),i},setValue(e,t,r){var n,i,e=$dateperiodpicker.getControl(e);e&&(i=n="",1<(t=$string.split(t,",")).length?(n=t[0],i=t[1]):0<t.length&&(n=t[0],i=t[0]),e.textbox1ID&&syn.$l.get(e.textbox1ID)&&(syn.$l.get(e.textbox1ID).value=n),e.textbox1ID)&&syn.$l.get(e.textbox2ID)&&(syn.$l.get(e.textbox2ID).value=i)},clear(e,t){e=$dateperiodpicker.getControl(e);e&&(e.textbox1ID&&syn.$l.get(e.textbox1ID)&&(syn.$l.get(e.textbox1ID).value=""),e.textbox1ID)&&syn.$l.get(e.textbox2ID)&&(syn.$l.get(e.textbox2ID).value="")},getControl(e){for(var t=null,r=$dateperiodpicker.dateControls.length,n=0;n<r;n++){var i=$dateperiodpicker.dateControls[n];if(i.id==e){t=i;break}}return t},updateStartDate(e,t,r){e.setStartRange(r),t.setStartRange(r),t.setMinDate(r)},updateEndDate(e,t,r){e.setEndRange(r),e.setMaxDate(r),t.setEndRange(r)},setDateRange(e,t){e=e||$date.toString(new Date,"d"),t=t||$date.toString(new Date,"d"),$dateperiodpicker.selectedYear=e.substring(0,4);var r=new Date(e),n=new Date(t);$dateperiodpicker.pkaStartDate.setDate(e),$dateperiodpicker.pkaStartDate.setStartRange($date.addDay(r,-1)),$dateperiodpicker.pkaStartDate.setEndRange(n),$dateperiodpicker.pkaStartDate.draw(),$dateperiodpicker.pkaEndDate.setDate(t),$dateperiodpicker.pkaEndDate.setStartRange($date.addDay(r,-1)),$dateperiodpicker.pkaEndDate.setEndRange(n),$dateperiodpicker.pkaEndDate.draw(),syn.$l.get("spnPeriodDate").innerText=$date.diff(r,n)+1+"일"},checkSelectedMonth(e){var t=new Date($dateperiodpicker.selectedYear+`-${e}-01`),t=$date.toString(t,"d"),r=$date.getLastDate(new Date(t));$dateperiodpicker.setDateRange(t,r),$dateperiodpicker.checkPeriodMonth([$string.toNumber(e)])},checkPeriodMonth(e){for(var t=1;t<=12;t++)syn.$l.get("_DatePeriodPicker_chkPeriodMonth"+t.toString()).checked=1==$object.isArray(e)&&1==e.includes(t)},setLocale(e,t,r,n){},_DatePeriodPicker_btnThisYear_click(){var e=new Date,e=$date.toString(e,"y");$dateperiodpicker.setDateRange(e+"-01-01",e+"-12-31"),$dateperiodpicker.checkPeriodMonth([1,2,3,4,5,6,7,8,9,10,11,12])},_DatePeriodPicker_btnUntilToday_click(){var e=new Date,t=$date.toString(e,"d"),r=t.substring(0,4)+"-01-01",r=($dateperiodpicker.setDateRange(r,t),parseInt($date.toString(e,"m")));$dateperiodpicker.checkPeriodMonth(Array(r).fill().map((e,t)=>t+1))},_DatePeriodPicker_btnToday_click(){var e=new Date,t=$date.toString(e,"d"),t=($dateperiodpicker.setDateRange(t,t),parseInt($date.toString(e,"m")));$dateperiodpicker.checkPeriodMonth([t])},_DatePeriodPicker_btnPreviousDay_click(){var e=new Date,t=$date.toString($date.addDay(e,-1),"d"),t=($dateperiodpicker.setDateRange(t,t),parseInt($date.toString(e,"m")));$dateperiodpicker.checkPeriodMonth([t])},_DatePeriodPicker_btnWeekly_click(){var e=new Date,t=$date.toString(e,"d"),r=$date.toString(e,"w")-1,t=$date.weekOfMonth(t.substring(0,4),t.substring(5,7))[r],r=t.weekStartDate,t=t.weekEndDate,r=($dateperiodpicker.setDateRange(r,t),parseInt($date.toString(e,"m")));$dateperiodpicker.checkPeriodMonth([r])},_DatePeriodPicker_btnPreviousWeek_click(){var e=new Date,t=($date.addWeek(e,-1).getMonth()<e.getMonth()&&(e=$date.getLastDate($date.addMonth(new Date,-1))),$date.toString(e,"d")),r=$date.toString(e,"w")-1-($date.addWeek(e,-1).getMonth()==e.getMonth()?1:0),r=(t=$date.weekOfMonth(t.substring(0,4),t.substring(5,7))[r]).weekStartDate,t=t.weekEndDate,r=($dateperiodpicker.setDateRange(r,t),parseInt($date.toString(e,"m")));$dateperiodpicker.checkPeriodMonth([r])},_DatePeriodPicker_btnThisMonth_click(){var e=new Date,t=$date.toString(e,"ym")+"-01",r=$date.getLastDate(e),t=($dateperiodpicker.setDateRange(t,r),parseInt($date.toString(e,"m")));$dateperiodpicker.checkPeriodMonth([t])},_DatePeriodPicker_btnPreviousMonth_click(){var e=$date.addMonth(new Date,-1),t=$date.toString(e,"ym")+"-01",r=$date.getLastDate(e),t=($dateperiodpicker.selectedYear=t.substring(0,4),$dateperiodpicker.setDateRange(t,r),parseInt($date.toString(e,"m")));$dateperiodpicker.checkPeriodMonth([t])},_DatePeriodPicker_btnPreviousYear_click(){var e=$date.addYear(new Date,-1),e=$date.toString(e,"y");$dateperiodpicker.setDateRange(e+"-01-01",e+"-12-31"),$dateperiodpicker.checkPeriodMonth([1,2,3,4,5,6,7,8,9,10,11,12])},_DatePeriodPicker_btnTwoYearAgo_click(){var e=$date.addYear(new Date,-2),e=$date.toString(e,"y");$dateperiodpicker.setDateRange(e+"-01-01",e+"-12-31"),$dateperiodpicker.checkPeriodMonth([1,2,3,4,5,6,7,8,9,10,11,12])},_DatePeriodPicker_btnQuarter1_click(){var e=new Date($dateperiodpicker.selectedYear+"-01-01"),e=$date.toString(e,"y"),t=e+"-01-01",e=$date.getLastDate(new Date(e+"-03-31"));$dateperiodpicker.setDateRange(t,e),$dateperiodpicker.checkPeriodMonth([1,2,3])},_DatePeriodPicker_btnQuarter2_click(){var e=new Date($dateperiodpicker.selectedYear+"-01-01"),e=$date.toString(e,"y"),t=e+"-04-01",e=$date.getLastDate(new Date(e+"-06-30"));$dateperiodpicker.setDateRange(t,e),$dateperiodpicker.checkPeriodMonth([4,5,6])},_DatePeriodPicker_btnQuarter3_click(){var e=new Date($dateperiodpicker.selectedYear+"-01-01"),e=$date.toString(e,"y"),t=e+"-07-01",e=$date.getLastDate(new Date(e+"-09-30"));$dateperiodpicker.setDateRange(t,e),$dateperiodpicker.checkPeriodMonth([7,8,9])},_DatePeriodPicker_btnQuarter4_click(){var e=new Date($dateperiodpicker.selectedYear+"-01-01"),e=$date.toString(e,"y"),t=e+"-10-01",e=$date.getLastDate(new Date(e+"-12-31"));$dateperiodpicker.setDateRange(t,e),$dateperiodpicker.checkPeriodMonth([10,11,12])},_DatePeriodPicker_btnFirstHalf_click(){var e=new Date($dateperiodpicker.selectedYear+"-01-01"),e=$date.toString(e,"y"),t=e+"-01-01",e=$date.getLastDate(new Date(e+"-06-30"));$dateperiodpicker.setDateRange(t,e),$dateperiodpicker.checkPeriodMonth([1,2,3,4,5,6])},_DatePeriodPicker_btnSecondHalf_click(){var e=new Date($dateperiodpicker.selectedYear+"-01-01"),e=$date.toString(e,"y"),t=e+"-07-01",e=$date.getLastDate(new Date(e+"-12-31"));$dateperiodpicker.setDateRange(t,e),$dateperiodpicker.checkPeriodMonth([7,8,9,10,11,12])},_DatePeriodPicker_btnConfirm_click(){var popup,elID,control,startedAt,endedAt,textbox1,textbox2,mod,events,confirmFunction;1==syn.$l.get("spnPeriodDate").innerText.startsWith("-")?syn.$w.alert("시작일자가 종료일자 보다 클 수 없습니다."):(popup=syn.$l.get("divPeriodPicker"),0==syn.$m.hasClass(popup,"hidden")&&(elID=popup.getAttribute("elID"),control=$dateperiodpicker.getControl(elID),control&&(startedAt=$dateperiodpicker.pkaStartDate.getDate(),endedAt=$dateperiodpicker.pkaEndDate.getDate(),textbox1=syn.$l.get(control.textbox1ID),textbox1.value=$date.toString(startedAt,"d"),textbox2=syn.$l.get(control.textbox2ID),textbox2.value=$date.toString(endedAt,"d"),mod=window[syn.$w.pageScript],events=eval(textbox1.getAttribute("syn-events")),confirmFunction="{0}_onconfirm".format(elID),events)&&events.includes("onconfirm")&&mod&&mod.event[confirmFunction]&&mod.event[confirmFunction](elID,textbox1.value,textbox2.value),$dateperiodpicker.hidePopup()))},_DatePeriodPicker_chkPeriodMonth_click(e){e=syn.$l.get(e.target.getAttribute("for"));e&&$dateperiodpicker.checkSelectedMonth(e.value)}}),syn.uicontrols.$dateperiodpicker=$dateperiodpicker}(window),!function(i){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var u=syn.uicontrols.$multiselect||new syn.module;u.extend({name:"syn.uicontrols.$multiselect",version:"v2025.3.1",selectControls:[],defaultSetting:{elID:"",required:!1,placeholder:"전체",animate:!1,local:!0,search:!1,multiSelectAll:!0,width:"100%",classNames:null,dataSourceID:null,storeSourceID:null,parameters:null,selectedValue:null,toSynControl:!1,dataType:"string",belongID:null,getter:!1,setter:!1,controlText:null,validators:null,transactConfig:null,triggerConfig:null},addModuleList(e,t,r,n){var i=e.getAttribute("id"),o=e.getAttribute("syn-datafield"),e=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:e,field:o,module:this.name,type:n})},controlLoad(e,t){t=syn.$w.argumentsExtend(u.defaultSetting,t);var r=i[syn.$w.pageScript],n=(r&&r.hook.controlInit&&(n=r.hook.controlInit(e,t),t=syn.$w.argumentsExtend(t,n)),t.elID=e,t.storeSourceID=t.storeSourceID||t.dataSourceID,syn.$l.get(e));n.setAttribute("syn-options",JSON.stringify(t)),u.addControlSetting(n,t),t.storeSourceID&&(syn.$w.addReadyCount(),n=null,(n=r.config&&r.config.dataSource&&r.config.dataSource[t.storeSourceID]&&1==t.local?r.config.dataSource[t.storeSourceID]:n)?(u.loadData(t.elID,n,t.required),t.selectedValue&&u.setValue(t.elID,t.selectedValue),syn.$w.removeReadyCount()):1==t.local?syn.$w.loadJson(syn.Config.SharedAssetUrl+"code/{0}.json".format(t.storeSourceID),t,function(e,t){t&&(r.config.dataSource[e.storeSourceID]=t,u.loadData(e.elID,t,e.required),e.selectedValue)&&u.setValue(e.elID,e.selectedValue),syn.$w.removeReadyCount()},!1):syn.$w.getDataSource(t.dataSourceID,t.parameters,function(e){e&&(r.config.dataSource[t.storeSourceID]=e,u.loadData(t.elID,e,t.required),t.selectedValue)&&u.setValue(t.elID,t.selectedValue),syn.$w.removeReadyCount()})),t.bindingID&&syn.uicontrols.$data&&syn.uicontrols.$data.bindingSource(e,t.bindingID)},dataRefresh(e,t,r){var n;(t=t||{}).elID=e,t.storeSourceID=t.storeSourceID||t.dataSourceID,t=syn.$w.argumentsExtend(JSON.parse(syn.$l.get(e).getAttribute("syn-options")),t),syn.$l.get(e).setAttribute("syn-options",JSON.stringify(t)),t.dataSourceID&&((n=i[syn.$w.pageScript]).config&&n.config.dataSource&&n.config.dataSource[t.storeSourceID]&&delete n.config.dataSource[t.storeSourceID],n&&n.hook.controlInit&&(e=n.hook.controlInit(e,t),t=syn.$w.argumentsExtend(t,e)),e=null,(e=n.config&&n.config.dataSource&&n.config.dataSource[t.storeSourceID]?n.config.dataSource[t.storeSourceID]:e)?(u.loadData(t.elID,e,t.required),t.selectedValue&&u.setValue(t.elID,t.selectedValue),r&&r()):1==t.local?syn.$w.loadJson(syn.Config.SharedAssetUrl+"code/{0}.json".format(t.storeSourceID),t,function(e,t){n.config.dataSource[e.storeSourceID]=t,u.loadData(e.elID,t,e.required),e.selectedValue&&u.setValue(e.elID,e.selectedValue),r&&r()},!1):syn.$w.getDataSource(t.dataSourceID,t.parameters,function(e){n.config.dataSource[t.storeSourceID]=e,u.loadData(t.elID,e,t.required),t.selectedValue&&u.setValue(t.elID,t.selectedValue),r&&r()}))},addControlSetting(e,t){var r=null;1==t.toSynControl&&(r=tail.select(e,t),syn.$m.addClass(r.select,e.className),r.on("open",function(){var e=u.getControl(this.e.id).picker,t=(1==$string.toBoolean(e.selectedDisabled)?(e.selectValues=e.value(),e.label.style.backgroundColor="#f2f2f2",e.label.style.color="#999"):(e.label.style.backgroundColor="",e.label.style.color=""),this.e.options),r=t.length,n=0,i=0;if(0<r){for(var o=0;o<r;o++){var s=t[o].textContent.length;n<s&&(n=s,i=o)}var e=syn.$d.measureSize(t[i].textContent);e&&(600<(e=parseInt(e.width.replace("px",""))+50)&&(e=600),syn.$d.getSize(this.dropdown).width<e)&&(this.dropdown.style.width=e.toString()+"px")}}),r.on("close",function(){var e=u.getControl(this.e.id).picker;1==$string.toBoolean(e.selectedDisabled)?(u.setValue(this.e.id,e.selectValues),e.label.style.backgroundColor="#f2f2f2",e.label.style.color="#999"):(e.label.style.backgroundColor="",e.label.style.color="")}),setTimeout(function(){r.select.picker=r,syn.$l.addEvent(r.select,"focus",function(e){$this.tabOrderFocusID=this.picker.e.id,$this.focusControl=this.picker.e})})),u.selectControls.push({id:e.id,picker:r,setting:$object.clone(t)})},getValue(e,t){var r=[],n=syn.$l.get(e);if(0==$object.isNullOrUndefined(n))for(var i=n.options.length,o=0;o<i;o++){var s=n.options[o];1==s.selected&&r.push(s.value)}return r.join(",")},setValue(e,t,r){var n=syn.$l.get(e);if(0==$object.isNullOrUndefined(n)){0==$object.isBoolean(r)&&(r=!0);for(var i=n.options.length,o=0;o<i;o++)n.options[o].selected;if(0==$object.isNullOrUndefined(t))for(var s=(t=0==$object.isArray(t)?t.split(","):t).length,o=0;o<s;o++)for(var a=t[o],l=0;l<i;l++){var c=n.options[l];if(c.value==a){c.selected=r;break}}u.controlReload(e)}},clear(e,t){var r=syn.$l.get(e);if(0==$object.isNullOrUndefined(r)){for(var n=r.options.length,i=0;i<n;i++)r.options[i].selected=!1;u.controlReload(e)}},loadData(e,t,r){for(var n=syn.$l.get(e),i=(1==$object.isNullOrUndefined(r)&&(r=!1),syn.uicontrols.$multiselect.getControl(e).setting.placeholder),o=(tail.select.strings.en.placeholderMulti=i,[]),s=((n.options.length=0)==r&&o.push(`<option value="">${i}</option>`),t.DataSource.length),a=0;a<s;a++){var l=t.DataSource[a];o.push('<option value="'.concat(l[t.CodeColumnID],'">',l[t.ValueColumnID],"</option>"))}n.innerHTML=o.join(""),u.setSelectedDisabled(e,!1),u.controlReload(e)},controlReload(e){var t=syn.$l.get(e);0==$object.isNullOrUndefined(t)&&(t=u.getControl(e))&&t.picker&&t.picker.reload()},getSelectedIndex(e){var r=[],e=syn.$l.get(e);return 0==$object.isNullOrUndefined(e)&&Array.from(e.options).forEach((e,t)=>{1==e.selected&&r.push(t)}),r},setSelectedIndex(e,t){var r=syn.$l.get(e);if(0==$object.isNullOrUndefined(r)){for(var n=r.options.length,i=0;i<n;i++)1==$object.isNumber(t)?i==t&&(item.selected=!0):1==$object.isArray(t)&&-1<t.includes(i)&&(item.selected=!0);u.controlReload(e)}},getSelectedValue(e){var t=[],e=syn.$l.get(e);return t=0==$object.isNullOrUndefined(e)?Array.from(e.selectedOptions).map(e=>e.value):t},getSelectedText(e){var t=[],e=syn.$l.get(e);return t=0==$object.isNullOrUndefined(e)?Array.from(e.selectedOptions).map(e=>e.text):t},setSelectedValue(e,t){var r=syn.$l.get(e);if(0==$object.isNullOrUndefined(r)){for(var n=r.options.length,i=0;i<n;i++){var o=r.options[i];1==$object.isString(t)?o.selected=o.value==t:1==$object.isArray(t)&&(o.selected=1==t.includes(o.value))}u.controlReload(e)}},setSelectedText(e,t){var r=syn.$l.get(e);if(0==$object.isNullOrUndefined(r)){for(var n=r.options.length,i=0;i<n;i++){var o=r.options[i];1==$object.isString(t)?o.selected=o.text==t:1==$object.isArray(t)&&(o.selected=1==t.includes(o.text))}u.controlReload(e)}},disabled(e,t){1==$object.isNullOrUndefined(t)&&(t=!1),t=$string.toBoolean(t);var r=syn.uicontrols.$multiselect.getControl(e);r&&(1==r.setting.toSynControl?r.picker.config("disabled",t):(r=syn.$l.get(e),1==t?r.setAttribute("disabled","disabled"):r.removeAttribute("disabled")))},setSelectedDisabled(e,t){var r=syn.$l.get(e);if(0==$object.isNullOrUndefined(r)){var n=u.getValue(e).split(","),i=r.options.length,t=$string.toBoolean(t);if(1==t)for(var o=0;o<i;o++){var s=r.options[o];-1<n.indexOf(s.value)?s.disabled=!1:s.disabled=!0}else for(o=0;o<i;o++)(s=r.options[o]).disabled=!1;u.controlReload(e);e=u.getControl(e).picker;e&&(1==(e.selectedDisabled=t)?(e.label.style.backgroundColor="#f2f2f2",e.label.style.color="#999"):(e.label.style.backgroundColor="",e.label.style.color=""))}},getControl(e){for(var t=null,r=u.selectControls.length,n=0;n<r;n++){var i=u.selectControls[n];if(i.id==e){t=i;break}}return t},setLocale(e,t,r,n){}}),syn.uicontrols.$multiselect=u}(window),!function(i){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var c=syn.uicontrols.$select||new syn.module;c.extend({name:"syn.uicontrols.$select",version:"v2025.3.1",selectControls:[],defaultSetting:{elID:"",placeholder:"전체",required:!1,animate:!1,local:!0,search:!1,multiSelectAll:!1,width:"100%",classNames:null,dataSourceID:null,storeSourceID:null,parameters:null,selectedValue:null,toSynControl:!0,dataType:"string",belongID:null,getter:!1,setter:!1,controlText:null,validators:null,transactConfig:null,triggerConfig:null},addModuleList(e,t,r,n){var i=e.getAttribute("id"),o=e.getAttribute("syn-datafield"),e=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:e,field:o,module:this.name,type:n})},controlLoad(e,t){t=syn.$w.argumentsExtend(c.defaultSetting,t);var r=i[syn.$w.pageScript],n=(r&&r.hook.controlInit&&(n=r.hook.controlInit(e,t),t=syn.$w.argumentsExtend(t,n)),t.elID=e,t.storeSourceID=t.storeSourceID||t.dataSourceID,syn.$l.get(e));n.setAttribute("syn-options",JSON.stringify(t)),c.addControlSetting(n,t),t.storeSourceID&&(syn.$w.addReadyCount(),n=null,(n=r.config&&r.config.dataSource&&r.config.dataSource[t.storeSourceID]&&1==t.local?r.config.dataSource[t.storeSourceID]:n)?(c.loadData(t.elID,n,t.required),t.selectedValue&&c.setValue(t.elID,t.selectedValue),syn.$w.removeReadyCount()):1==t.local?syn.$w.loadJson(syn.Config.SharedAssetUrl+"code/{0}.json".format(t.storeSourceID),t,function(e,t){t&&(r.config.dataSource[e.storeSourceID]=t,c.loadData(e.elID,t,e.required),e.selectedValue)&&c.setValue(e.elID,e.selectedValue),syn.$w.removeReadyCount()},!1):syn.$w.getDataSource(t.dataSourceID,t.parameters,function(e){e&&(r.config.dataSource[t.storeSourceID]=e,c.loadData(t.elID,e,t.required),t.selectedValue)&&c.setValue(t.elID,t.selectedValue),syn.$w.removeReadyCount()})),t.bindingID&&syn.uicontrols.$data&&syn.uicontrols.$data.bindingSource(e,t.bindingID)},dataRefresh(e,t,r){var n;(t=t||{}).elID=e,t.storeSourceID=t.storeSourceID||t.dataSourceID,t=syn.$w.argumentsExtend(JSON.parse(syn.$l.get(e).getAttribute("syn-options")),t),syn.$l.get(e).setAttribute("syn-options",JSON.stringify(t)),t.dataSourceID&&((n=i[syn.$w.pageScript]).config&&n.config.dataSource&&n.config.dataSource[t.storeSourceID]&&delete n.config.dataSource[t.storeSourceID],n&&n.hook.controlInit&&(e=n.hook.controlInit(e,t),t=syn.$w.argumentsExtend(t,e)),e=null,(e=n.config&&n.config.dataSource&&n.config.dataSource[t.storeSourceID]?n.config.dataSource[t.storeSourceID]:e)?(c.loadData(t.elID,e,t.required),t.selectedValue&&c.setValue(t.elID,t.selectedValue),r&&r()):1==t.local?syn.$w.loadJson(syn.Config.SharedAssetUrl+"code/{0}.json".format(t.storeSourceID),t,function(e,t){n.config.dataSource[e.storeSourceID]=t,c.loadData(e.elID,t,e.required),e.selectedValue&&c.setValue(e.elID,e.selectedValue),r&&r()},!1):syn.$w.getDataSource(t.dataSourceID,t.parameters,function(e){n.config.dataSource[t.storeSourceID]=e,c.loadData(t.elID,e,t.required),t.selectedValue&&c.setValue(t.elID,t.selectedValue),r&&r()}))},addControlSetting(e,t){var r=null;1==t.toSynControl&&(r=tail.select(e,t),syn.$m.addClass(r.select,e.className),r.on("open",function(){var e=c.getControl(this.e.id).picker,t=(1==$string.toBoolean(e.selectedDisabled)?(e.selectValue=e.value(),e.label.style.backgroundColor="#f2f2f2",e.label.style.color="#999"):(e.label.style.backgroundColor="",e.label.style.color=""),this.e.options),r=t.length,n=0,i=0;if(0<r){for(var o=0;o<r;o++){var s=t[o].textContent.length;n<s&&(n=s,i=o)}var e=syn.$d.measureSize(t[i].textContent);e&&(600<(e=parseInt(e.width.replace("px",""))+50)&&(e=600),syn.$d.getSize(this.dropdown).width<e)&&(this.dropdown.style.width=e.toString()+"px")}}),r.on("close",function(){var e=c.getControl(this.e.id).picker;1==$string.toBoolean(e.selectedDisabled)?(c.setValue(this.e.id,e.selectValue),e.label.style.backgroundColor="#f2f2f2",e.label.style.color="#999"):(e.label.style.backgroundColor="",e.label.style.color="")}),setTimeout(function(){r.select.picker=r,syn.$l.addEvent(r.select,"focus",function(e){$this.tabOrderFocusID=this.picker.e.id,$this.focusControl=this.picker.e})})),c.selectControls.push({id:e.id,picker:r,setting:$object.clone(t)})},getValue(e,t){var r="",e=syn.$l.get(e);return r=0==$object.isNullOrUndefined(e)?e.value:r},setValue(e,t,r){var n=syn.$l.get(e);0==$object.isNullOrUndefined(n)&&(n.value=t,c.controlReload(e))},clear(e,t){var r=syn.$l.get(e);0==$object.isNullOrUndefined(r)&&(r.value="",c.controlReload(e))},loadData(e,t,r){for(var n=syn.$l.get(e),i=(1==$object.isNullOrUndefined(r)&&(r=!1),syn.uicontrols.$select.getControl(e).setting.placeholder),o=(tail.select.strings.en.placeholder=i,[]),s=((n.options.length=0)==r&&o.push(`<option value="">${i}</option>`),t.DataSource.length),a=0;a<s;a++){var l=t.DataSource[a];o.push('<option value="'.concat(l[t.CodeColumnID],'">',l[t.ValueColumnID],"</option>"))}n.innerHTML=o.join(""),c.setSelectedDisabled(e,!1),c.controlReload(e)},controlReload(e){var t=syn.$l.get(e);0==$object.isNullOrUndefined(t)&&(t=c.getControl(e))&&t.picker&&t.picker.reload()},getSelectedIndex(e){var t="",e=syn.$l.get(e);return t=0==$object.isNullOrUndefined(e)?e.options.selectedIndex:t},setSelectedIndex(e,t){var r=syn.$l.get(e);0==$object.isNullOrUndefined(r)&&r.options.length>t&&(r.selectedIndex=t,c.controlReload(e))},setSelectedValue(e,t){var r=syn.$l.get(e);if(0==$object.isNullOrUndefined(r))for(var n=r.options.length,i=0;i<n;i++)if(r.options[i].value==t){r.selectedIndex=i,c.controlReload(e);break}},setSelectedText(e,t){var r=syn.$l.get(e);if(0==$object.isNullOrUndefined(r))for(var n=r.options.length,i=0;i<n;i++)if(r.options[i].text==t){r.selectedIndex=i,c.controlReload(e);break}},getSelectedValue(e){var t="",e=syn.$l.get(e);return t=0==$object.isNullOrUndefined(e)&&-1<e.options.selectedIndex?e.options[e.options.selectedIndex].value:t},getSelectedText(e){var t="",e=syn.$l.get(e);return t=0==$object.isNullOrUndefined(e)&&-1<e.options.selectedIndex?e.options[e.options.selectedIndex].text:t},disabled(e,t){1==$object.isNullOrUndefined(t)&&(t=!1),t=$string.toBoolean(t);var r=syn.uicontrols.$select.getControl(e);r&&(1==r.setting.toSynControl?r.picker.config("disabled",t):(r=syn.$l.get(e),1==t?r.setAttribute("disabled","disabled"):r.removeAttribute("disabled")))},setSelectedDisabled(e,t){var r=syn.$l.get(e);if(0==$object.isNullOrUndefined(r)){var n=c.getSelectedValue(e),i=r.options.length,t=$string.toBoolean(t);if(1==t)for(var o=0;o<i;o++)(s=r.options[o]).value==n?s.disabled=!1:s.disabled=!0;else for(var s,o=0;o<i;o++)(s=r.options[o]).disabled=!1;c.controlReload(e);e=c.getControl(e).picker;e&&(1==(e.selectedDisabled=t)?(e.label.style.backgroundColor="#f2f2f2",e.label.style.color="#999"):(e.label.style.backgroundColor="",e.label.style.color=""))}},getControl(e){for(var t=null,r=c.selectControls.length,n=0;n<r;n++){var i=c.selectControls[n];if(i.id==e){t=i;break}}return t},setLocale(e,t,r,n){}}),syn.uicontrols.$select=c}(window),!function(window){"use strict";window.fileUploadOptions=null,syn.uicontrols=syn.uicontrols||new syn.module;var $fileclient=$fileclient||new syn.module;$fileclient.extend({name:"syn.uicontrols.$fileclient",version:"v2025.3.1",fileManagers:[],fileControls:[],applicationID:"",businessID:"",mimeType:{html:"text/html",htm:"text/html",css:"text/css",xml:"text/xml",txt:"text/plain",gif:"image/gif",jpeg:"image/jpeg",jpg:"image/jpeg",png:"image/png",tif:"image/tiff",ico:"image/x-icon",bmp:"image/x-ms-bmp",svg:"image/svg+xml",webp:"image/webp",js:"application/x-javascript",pdf:"application/pdf",rtf:"application/rtf",doc:"application/msword",docx:"application/msword",xls:"application/vnd.ms-excel",xlsx:"application/vnd.ms-excel",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.ms-powerpoint","7z":"application/x-7z-compressed",zip:"application/zip",bin:"application/octet-stream",exe:"application/octet-stream",dll:"application/octet-stream",iso:"application/octet-stream",msi:"application/octet-stream",mp3:"audio/mpeg",ogg:"audio/ogg",mp4:"video/mp4"},isFileAPIBrowser:!1,defaultSetting:{elementID:null,dialogTitle:"파일 업로드",tokenID:"",repositoryID:"",dependencyID:"",businessID:"",applicationID:"",fileUpdateCallback:null,accept:"*/*",uploadUrl:"",fileChangeHandler:void 0,custom1:void 0,custom2:void 0,custom3:void 0,minHeight:360,fileManagerServer:"",fileManagerPath:"/repository/api/storage",pageGetRepository:"get-repository",pageUploadFile:"upload-file",pageUploadFiles:"upload-files",pageActionHandler:"action-handler",pageRemoveItem:"remove-item",pageRemoveItems:"remove-items",pageDownloadFile:"download-file",pageHttpDownloadFile:"http-download-file",pageVirtualDownloadFile:"virtual-download-file",pageVirtualDeleteFile:"virtual-delete-file",dataType:"string",belongID:null,getter:!1,setter:!1,controlText:null,validators:null,transactConfig:null,triggerConfig:null},addModuleList(e,t,r,n){var i=e.getAttribute("id"),o=e.getAttribute("syn-datafield"),e=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:e,field:o,module:this.name,type:n})},controlLoad(elID,setting){var el=syn.$l.get(elID),mod=(setting=syn.$w.argumentsExtend($fileclient.defaultSetting,setting),setting.elementID=elID,window[syn.$w.pageScript]),moduleSettings;mod&&mod.hook.controlInit&&(moduleSettings=mod.hook.controlInit(elID,setting),setting=syn.$w.argumentsExtend(setting,moduleSettings)),setting.uploadType=null,setting.uploadUrl=null,1==$string.isNullOrEmpty(setting.fileManagerServer)&&syn.Config&&syn.Config.FileManagerServer&&(setting.fileManagerServer=syn.Config.FileManagerServer),1==$string.isNullOrEmpty(setting.fileManagerServer)?syn.$l.eventLog("$fileclient.controlLoad","파일 컨트롤 초기화 오류, 파일 서버 정보 확인 필요","Error"):(1==location.pathname.startsWith(syn.Config.TenantAppRequestPath?`/${syn.Config.TenantAppRequestPath}/`:"/app/")?1==$string.isNullOrEmpty($fileclient.applicationID)&&($fileclient.applicationID=syn.$w.ManagedApp.ApplicationID):1==$string.isNullOrEmpty($fileclient.applicationID)&&($fileclient.applicationID=syn.$w.Variable.ApplicationID||syn.$w.User.ApplicationID||syn.Config.ApplicationID),1==$string.isNullOrEmpty($fileclient.applicationID)?syn.$l.eventLog("$fileclient.controlLoad","파일 컨트롤 초기화 오류, ApplicationID 정보 확인 필요","Error"):(syn.Config.FileBusinessIDSource&&"None"!=syn.Config.FileBusinessIDSource&&("Cookie"==syn.Config.FileBusinessIDSource?$fileclient.businessID=syn.$r.getCookie("FileBusinessID"):"SessionStorage"==syn.Config.FileBusinessIDSource&&($fileclient.businessID=syn.$w.getStorage("FileBusinessID"))),1==$string.isNullOrEmpty($fileclient.businessID)&&($fileclient.businessID=syn.$w.User.WorkCompanyNo),1==$string.isNullOrEmpty($fileclient.businessID)&&($fileclient.businessID="0"),syn.$w.loadJson(setting.fileManagerServer+setting.fileManagerPath+"/"+setting.pageGetRepository+"?applicationID={0}&repositoryID={1}".format($fileclient.applicationID,setting.repositoryID),setting,function(setting,repositoryData){setting.dialogTitle=repositoryData.RepositoryName,setting.storageType=repositoryData.StorageType,setting.isMultiUpload=repositoryData.IsMultiUpload,setting.isAutoPath=repositoryData.IsAutoPath,setting.policyPathID=repositoryData.PolicyPathID,setting.uploadType=repositoryData.UploadType,setting.uploadExtensions=repositoryData.UploadExtensions,setting.accept=repositoryData.UploadExtensions,setting.uploadCount=repositoryData.UploadCount,setting.uploadSizeLimit=repositoryData.UploadSizeLimit,"Single"==setting.uploadType?setting.uploadUrl=syn.Config.SharedAssetUrl+"upload/SingleFile.html":"Profile"==setting.uploadType?setting.uploadUrl=syn.Config.SharedAssetUrl+"upload/ProfilePicture.html":"Multi"==setting.uploadType?setting.uploadUrl=syn.Config.SharedAssetUrl+"upload/MultiFiles.html":"ImageLink"==setting.uploadType&&(setting.uploadUrl=syn.Config.SharedAssetUrl+"upload/ImageLinkFiles.html"),setting.elID=elID,el.setAttribute("id",el.id+"_hidden"),el.setAttribute("syn-options",JSON.stringify(setting)),el.style.display="none";var dataFieldID=el.getAttribute("syn-datafield"),events=el.getAttribute("syn-events"),value=el.value||"",name=el.name||"",html="",html=events?'<input type="hidden" id="{0}" name="{1}" syn-datafield="{2}" value="{3}" syn-events={4}>'.format(elID,name,dataFieldID,value,"['"+eval(events).join("','")+"']"):'<input type="hidden" id="{0}" name="{1}" syn-datafield="{2}" value="{3}">'.format(elID,name,dataFieldID,value),parent=el.parentNode,wrapper=document.createElement("div");wrapper.innerHTML=html,parent.appendChild(wrapper),syn.$l.get(elID).setAttribute("syn-options",JSON.stringify(setting)),$fileclient.fileControls.push({id:elID,setting:$object.clone(setting)})},function(){1==$string.isNullOrEmpty(setting.uploadUrl)&&syn.$w.alert("{0}에 대한 파일 서버 저장 정보 확인 필요".format(setting.repositoryID))},!0,!0),setting.bindingID&&syn.uicontrols.$data&&syn.uicontrols.$data.bindingSource(elID,setting.bindingID)))},moduleInit(){syn.$l.addEvent(window,"message",function(e){var repositoryData=e.data,setting=$fileclient.getFileSetting(repositoryData.elementID);if(setting&&-1<$fileclient.getRepositoryUrl().indexOf(e.origin)&&repositoryData&&"upload-files"==repositoryData.action){if(repositoryData.callback){var mod=window[syn.$w.pageScript];if(mod){var clientCallback=null,clientCallback=mod.event[repositoryData.callback];if(1==$object.isNullOrUndefined(clientCallback))try{clientCallback=eval("$this.event."+repositoryData.callback)}catch(error){syn.$l.eventLog("clientCallback",error,"Warning")}if(clientCallback){for(var result={elID:repositoryData.elementID,repositoryID:repositoryData.repositoryID,items:repositoryData.repositoryItems},items=[],i=0;i<repositoryData.repositoryItems.length;i++){var item=repositoryData.repositoryItems[i];items.push(item.ItemID)}repositoryData.elementID&&(syn.$l.get(repositoryData.elementID).value=items.join(",")),clientCallback("upload",result)}}}$.modal&&$.modal.close()}return e.stopPropagation(),!1})},getFileSetting(e){for(var t=null,r=$fileclient.fileControls.length,n=0;n<r;n++){var i=$fileclient.fileControls[n];if(i.id==e){t=i.setting;break}}return t},getFileManagerSetting(){var e=null;return e=0<$fileclient.fileControls.length?$fileclient.fileControls[0].setting:e},setPageSetting(e){e=e||{pageGetRepository:"get-repository",pageUploadFile:"upload-file",pageUploadFiles:"upload-files",pageActionHandler:"action-handler",pageRemoveItem:"remove-item",pageRemoveItems:"remove-items",pageDownloadFile:"download-file",pageHttpDownloadFile:"http-download-file",pageVirtualDownloadFile:"virtual-download-file",pageVirtualDeleteFile:"virtual-delete-file"};for(var t=$fileclient.fileControls.length,r=0;r<t;r++){var n=$fileclient.fileControls[r];n.setting=syn.$w.argumentsExtend(n.setting,e)}},getValue(e,t){return syn.$l.get(e).value},setValue(e,t,r){syn.$l.get(e).value=t||""},clear(e,t){syn.$l.get(e).value=""},init(e,t,r,n){var i=$fileclient.getTemporaryDependencyID(e);$fileclient.fileManagers.push({elID:e,container:t,datas:r,dependencyID:i,filechange:n}),window.File&&window.FileList&&($fileclient.isFileAPIBrowser=!0),null!=t&&0<document.forms.length&&(e=document.forms[0],null==syn.$l.get("syn-repository")&&(syn.$m.append(e,"iframe","syn-repository",{styles:{display:"none"}}).name="syn-repository"),e.enctype="multipart/form-data",e.target="syn-repository",e.method="post",e.action=$fileclient.getRepositoryUrl())},getRepositoryUrl(){var e=$fileclient.getFileManagerSetting();return e.fileManagerServer+e.fileManagerPath},getFileManager(e){for(var t,r=null,n=0;n<$fileclient.fileManagers.length;n++)if((t=$fileclient.fileManagers[n]).elID==e){r=t;break}return r},getFileMaxIndex(e){for(var t=1,r=[],n=syn.$l.querySelectorAll('[id*="'+e+'_filesName"]'),i=1;i<=n.length;i++)r.push(i);return null==(t=r[r.length-1])&&(t=0),++t},addFileUI(e,t){var r,n,i,o,s=$fileclient.getFileManager(e);s?(s=s.container,r=document.createElement("div"),syn.$m.addClass(r,"mt-2"),o=document.createElement("div"),syn.$m.addClass(o,"input-group"),n=document.createElement("input"),syn.$m.addClass(n,"form-control"),i=document.createElement("button"),syn.$m.addClass(i,"btn btn-icon bg-muted-lt"),i.innerHTML='<i class="f:18 ti ti-trash"></i>',o.appendChild(n),o.appendChild(i),r.appendChild(o),s.appendChild(r),o=$fileclient.getFileMaxIndex(e).toString(),n.id=e+"_filesName_"+o,n.name="files",n.type="file",n.multiple=!1,t&&(n.accept=t),syn.$l.addEvent(n,"change",function(e){var e=e.target,t=null,r=null,n=e.id.split("_"),i=$fileclient.getFileManager(n[0]);i&&i.filechange&&(r=n[n.length-1],t=1==$fileclient.isFileAPIBrowser?{name:(n=e.files[0]).name,size:n.size,type:n.type,index:r}:((n=new Image).src=e.value,{name:n.nameProp,size:void 0,type:$fileclient.getFileMimeType(n.nameProp),index:r}),i.filechange(e,t))}),i.id=e+"_filesRemove_"+o,i.name=e+"_filesRemove_"+o,i.type="button",i.index=o,syn.$l.addEvent(i,"click",function(e){e=e.srcElement||e.target;"I"==e.tagName&&(e=e.parentElement),syn.$l.get(e.id.replace("_filesRemove_","_filesName_")).value=""})):syn.$w.alert(e+" 파일 관리자가 지정되지 않았습니다.")},getFileMimeType(e){var t="application/octet-stream",e=e.substring(e.lastIndexOf(".")+1);return e&&($resource&&$resource.mimeType?1==$resource.mimeType.hasOwnProperty(e)&&(t=$resource.mimeType[e]):1==$fileclient.mimeType.hasOwnProperty(e)&&(t=$fileclient.mimeType[e])),t},prependChild(e,t){var e=$fileclient.getFileManager(e).container,r=e.childNodes,n=r.length-1;t&&e.insertBefore(r[n],t)},getRepositoryID(e){var t="",e=$fileclient.getFileManager(e);return t=e?e.datas.repositoryID:t},getDependencyID(e){var t="",e=$fileclient.getFileManager(e);return t=e?e.dependencyID:t},setDependencyID(e,t){e=$fileclient.getFileManager(e);e&&(e.dependencyID=t)},doUpload(e,t){var r=$fileclient.getFileManager(e),n=null;if(r){var i,o,s=!1;if(-1==r.datas.uploadExtensions.indexOf("*/*"))for(var a=r.datas.uploadExtensions.split(";"),l=syn.$l.querySelectorAll("[id*='_filesName_']"),c=0;c<r.datas.uploadCount&&null!=(n=l[c]);c++){for(var u=0;u<a.length;u++){if(""==n.value){s=!0;break}if(n.value.substring(n.value.lastIndexOf(".")+1,n.value.length).toLowerCase()===a[u].toLowerCase()){s=!0;break}}if(0==s)break}else if(0<(l=syn.$l.querySelectorAll("[id*='_filesName_']")).length){for(c=0;c<l.length;c++)n=l[c],0==$string.isNullOrEmpty(n.value)&&(s=!0);if(0==s)return void syn.$w.alert("업로드할 파일을 선택 해야 합니다")}1==s&&0<document.forms.length?null!=syn.$l.get("syn-repository")?(syn.$r.params=[],i=$fileclient.getRepositoryID(e),o=$fileclient.getFileManagerSetting(),syn.$r.path=$fileclient.getRepositoryUrl()+"/"+o.pageUploadFiles,syn.$r.params.elementID=t.elementID,syn.$r.params.repositoryID=i,syn.$r.params.dependencyID=$fileclient.getDependencyID(e),syn.$r.params.custompath1=t.custom1,syn.$r.params.custompath2=t.custom2,syn.$r.params.custompath3=t.custom3,0==$string.isNullOrEmpty(t.profileFileName)&&(syn.$r.params.fileName=t.profileFileName),r.datas.fileUpdateCallback&&(syn.$r.params.callback=r.datas.fileUpdateCallback),0==$string.isNullOrEmpty($fileclient.businessID)&&(syn.$r.params.businessID=$fileclient.businessID),syn.$r.params.applicationID=$fileclient.applicationID,(o=document.forms[0]).action=syn.$r.url(),o.submit(),window.$progressBar&&$progressBar.show("파일 업로드 중입니다...")):syn.$w.alert("doUpload 메서드를 지원하지 않는 화면입니다."):1==$object.isNullOrUndefined(n)?syn.$w.alert("업로드할 파일을 선택 해야 합니다"):syn.$w.alert(r.datas.uploadExtensions+"확장자를 가진 파일을 업로드 해야 합니다")}else syn.$w.alert(e+" 파일 관리자가 지정되지 않았습니다.")},getUploadUrl(e,t,r,n){1==$object.isNullOrUndefined(r)&&(r=!0);var i=$fileclient.getFileManagerSetting();return syn.$r.path=$fileclient.getRepositoryUrl()+"/"+(1==r?i.pageUploadFile:i.pageUploadFiles),syn.$r.params.repositoryID=e,syn.$r.params.dependencyID=t,syn.$r.params.businessID=$fileclient.businessID,syn.$r.params.applicationID=$fileclient.applicationID,syn.$r.params.responseType="json",1==r&&0==$string.isNullOrEmpty(n)&&(syn.$r.params.fileName=n),syn.$r.url()},getFileAction(e,t){if(1==$string.isNullOrEmpty(e.repositoryID)||1==$object.isNullOrUndefined(e.action))syn.$l.eventLog("getFileAction","요청 정보 확인 필요","Warning");else{var r=$fileclient.getFileManagerSetting();if(1==$object.isNullOrUndefined(r))syn.$l.eventLog("getFileAction",e.repositoryID+" 정보 확인 필요","Warning");else{syn.$r.path=$fileclient.getRepositoryUrl()+"/"+r.pageActionHandler;var n=e.action;switch(syn.$r.params.action=n){case"GetItem":syn.$r.params.repositoryID=e.repositoryID,syn.$r.params.itemID=e.itemID;break;case"GetItems":syn.$r.params.repositoryID=e.repositoryID,syn.$r.params.dependencyID=e.dependencyID;break;case"UpdateDependencyID":syn.$r.params.repositoryID=e.repositoryID,syn.$r.params.sourceDependencyID=e.sourceDependencyID,syn.$r.params.targetDependencyID=e.targetDependencyID;break;case"UpdateFileName":syn.$r.params.repositoryID=e.repositoryID,syn.$r.params.itemID=e.itemID,syn.$r.params.fileName=e.fileName;break;case"DeleteItem":syn.$r.path=$fileclient.getRepositoryUrl()+"/"+r.pageRemoveItem,syn.$r.params.repositoryID=e.repositoryID,syn.$r.params.itemID=e.itemID;break;case"DeleteItems":syn.$r.path=$fileclient.getRepositoryUrl()+"/"+r.pageRemoveItems,syn.$r.params.repositoryID=e.repositoryID,syn.$r.params.dependencyID=e.dependencyID;break;default:return void syn.$l.eventLog("getFileAction","action 확인 필요","Warning")}syn.$r.params.applicationID=$fileclient.applicationID,syn.$r.params.businessID=$fileclient.businessID,$fileclient.executeProxy(syn.$r.url(),t)}}},getItem(e,t,r){var n,i=$fileclient.getFileSetting(e);(i=null==i&&(n=$fileclient.getFileManager(e))?n.datas:i)?(syn.$r.path=$fileclient.getRepositoryUrl()+"/"+i.pageActionHandler,syn.$r.params.action="GetItem",syn.$r.params.repositoryID=i.repositoryID):(n=$fileclient.getRepositoryID(e),syn.$r.path=$fileclient.getRepositoryUrl()+"/"+i.pageActionHandler,syn.$r.params.action="GetItem",syn.$r.params.repositoryID=n),syn.$r.params.itemID=t,syn.$r.params.applicationID=$fileclient.applicationID,syn.$r.params.businessID=$fileclient.businessID,$fileclient.executeProxy(syn.$r.url(),r)},getItems(e,t,r){var n,i=$fileclient.getFileSetting(e);(i=null==i&&(n=$fileclient.getFileManager(e))?n.datas:i)?(syn.$r.path=$fileclient.getRepositoryUrl()+"/"+i.pageActionHandler,syn.$r.params.action="GetItems",syn.$r.params.repositoryID=i.repositoryID):(n=$fileclient.getRepositoryID(e),syn.$r.path=$fileclient.getRepositoryUrl()+"/"+i.pageActionHandler,syn.$r.params.action="GetItems",syn.$r.params.repositoryID=n),syn.$r.params.dependencyID=t,syn.$r.params.applicationID=$fileclient.applicationID,syn.$r.params.businessID=$fileclient.businessID,$fileclient.executeProxy(syn.$r.url(),r)},updateDependencyID(e,t,r,n){e=$fileclient.getFileSetting(e);syn.$r.path=$fileclient.getRepositoryUrl()+"/"+e.pageActionHandler,syn.$r.params.action="UpdateDependencyID",syn.$r.params.repositoryID=e.repositoryID,syn.$r.params.sourceDependencyID=t,syn.$r.params.targetDependencyID=r,syn.$r.params.applicationID=$fileclient.applicationID,syn.$r.params.businessID=$fileclient.businessID,$fileclient.executeProxy(syn.$r.url(),n)},updateFileName(e,t,r,n){e=$fileclient.getFileSetting(e);syn.$r.path=$fileclient.getRepositoryUrl()+"/"+e.pageActionHandler,syn.$r.params.action="UpdateFileName",syn.$r.params.repositoryID=e.repositoryID,syn.$r.params.itemID=t,syn.$r.params.fileName=r,syn.$r.params.applicationID=$fileclient.applicationID,syn.$r.params.businessID=$fileclient.businessID,$fileclient.executeProxy(syn.$r.url(),n)},fileUpload(e,t,r,n,i){e=1==$object.isString(e)?syn.$l.get(e):e;var o=$fileclient.getFileSetting(e.id);if(1==$object.isNullOrUndefined(e)||1==$object.isNullOrUndefined(o))syn.$l.eventLog("fileUpload","요청 정보 확인 필요","Warning");else{var s="";if(-1==(s=1==$object.isNullOrUndefined(i)?$fileclient.getRepositoryUrl()+"/"+o.pageUploadFiles+"?repositoryID={0}&dependencyID={1}&responseType=json&callback=none".format(t,r):i).indexOf("?")?s+=`?applicationID=${syn.uicontrols.$fileclient.applicationID}&businessID=`+syn.uicontrols.$fileclient.businessID:s+=`&applicationID=${syn.uicontrols.$fileclient.applicationID}&businessID=`+syn.uicontrols.$fileclient.businessID,e&&"FILE"==e.type.toUpperCase()){for(var a=new FormData,l=0;l<e.files.length;l++)a.append("files",e.files[l]);var c=syn.$w.xmlHttp();c.open("POST",s,!0),c.onload=function(){n&&n({status:c.status,response:c.responseText})},c.onerror=function(){n&&n({status:c.status,response:c.responseText})},c.send(a)}}},fileDownload(r){var e=null;if(1==$object.isString(r)){var t=r,n=$fileclient.getFileSetting(t),i=syn.$l.get(t)?syn.$l.get(t).value:null;if(!n||!i)return void syn.$l.eventLog("fileDownload",'"{0}"에 대한 요청 정보 확인 필요'.format(t),"Debug");e=JSON.stringify({RepositoryID:n.repositoryID,ItemID:i,FileMD5:"",TokenID:n.tokenID,ApplicationID:$fileclient.applicationID,BusinessID:$fileclient.businessID})}else{if(!r.repositoryID||!r.itemID)return void syn.$l.eventLog("fileDownload",'"{0}"에 대한 요청 정보 확인 필요'.format(t),"Debug");e=JSON.stringify({RepositoryID:r.repositoryID,ItemID:r.itemID,FileMD5:r.fileMD5,TokenID:r.tokenID,ApplicationID:$fileclient.applicationID,BusinessID:$fileclient.businessID})}var o,n=$fileclient.getFileManagerSetting();1==$object.isNullOrUndefined(n)?syn.$l.eventLog("fileDownload","FileManagerSetting 정보 확인 필요","Warning"):(syn.$r.path=$fileclient.getRepositoryUrl()+"/"+n.pageDownloadFile,(o=syn.$w.xmlHttp()).open("POST",syn.$r.url(),!0),o.setRequestHeader("Content-type","application/json"),o.responseType="blob",o.onload=function(e){var t;200==o.status?"DownloadResult"==o.getResponseHeader("FileModelType")?(t=syn.$c.base64Decode(o.getResponseHeader("FileResult")),1==(t=JSON.parse(t)).Result?syn.$l.blobToDownload(o.response,t.FileName):syn.$l.eventLog("fileDownload",'파일 다운로드 실패: "{0}"'.format(t.Message),"Debug")):syn.$l.eventLog("fileDownload",'itemID: "{0}" 파일 다운로드 응답 오류'.format(JSON.stringify(r)),"Debug"):syn.$l.eventLog("fileDownload",'파일 다운로드 오류, status: "{0}"'.format(o.statusText),"Debug")},o.send(e))},httpDownloadFile(e,t,r,n){0<document.forms.length&&null==syn.$l.get("repositoryDownload")&&(i=document.forms[0],(i=syn.$m.append(i,"iframe","repositoryDownload",{styles:{display:"none"}})).name="repositoryDownload",i.width="100%");var i=$fileclient.getFileManagerSetting();syn.$r.path=$fileclient.getRepositoryUrl()+"/"+i.pageHttpDownloadFile,syn.$r.params.repositoryID=e,syn.$r.params.itemID=t,syn.$r.params.fileMD5=r,syn.$r.params.tokenID=n,syn.$r.params.applicationID=$fileclient.applicationID,syn.$r.params.businessID=$fileclient.businessID,syn.$l.get("repositoryDownload").src=syn.$r.url()},virtualDownloadFile(e,t,r){0<document.forms.length&&null==syn.$l.get("repositoryDownload")&&(n=document.forms[0],syn.$m.append(n,"iframe","repositoryDownload",{styles:{display:"none"}}).name="repositoryDownload");var n=$fileclient.getFileManagerSetting();syn.$r.path=$fileclient.getRepositoryUrl()+"/"+n.pageVirtualDownloadFile,syn.$r.params.repositoryID=e,syn.$r.params.fileName=t,syn.$r.params.subDirectory=r,syn.$r.params.applicationID=$fileclient.applicationID,syn.$r.params.businessID=$fileclient.businessID,syn.$l.get("repositoryDownload").src=syn.$r.url()},virtualDeleteFile(e,t,r){var n=$fileclient.getFileManagerSetting();syn.$r.path=$fileclient.getRepositoryUrl()+"/"+n.pageVirtualDeleteFile,syn.$r.params.repositoryID=e,syn.$r.params.fileName=t,syn.$r.params.subDirectory=r,syn.$r.params.applicationID=$fileclient.applicationID,syn.$r.params.businessID=$fileclient.businessID,$fileclient.executeProxy(syn.$r.url(),function(e){0==e.Result&&syn.$l.eventLog("virtualDeleteFile",e.Message)})},deleteItem(s,a,l){var e,c=$fileclient.getFileSetting(s);null==c&&(e=$fileclient.getFileManager(s))&&(c=e.datas),syn.$r.path=$fileclient.getRepositoryUrl()+"/"+c.pageRemoveItem,syn.$r.params.repositoryID=c.repositoryID,syn.$r.params.itemID=a,syn.$r.params.applicationID=$fileclient.applicationID,syn.$r.params.businessID=$fileclient.businessID,$fileclient.executeProxy(syn.$r.url(),function(e){if("Single"==c.uploadType||"Profile"==c.uploadType)e&&1==e.Result&&(t=syn.$l.get(s),0==$object.isNullOrUndefined(t))&&(t.value="");else if(e&&1==e.Result){var t=syn.$l.get(s);if(0==$object.isNullOrUndefined(t)){for(var r=[],n=t.value.split(","),i=0;i<n.length;i++){var o=n[i];o!=a&&r.push(o)}t.value=r.join(",")}}l&&l(e)})},deleteItems(r,e,n){var t,i=$fileclient.getFileSetting(r);null==i&&(t=$fileclient.getFileManager(r))&&(i=t.datas),syn.$r.path=$fileclient.getRepositoryUrl()+"/"+i.pageRemoveItems,syn.$r.params.repositoryID=i.repositoryID,syn.$r.params.dependencyID=e,syn.$r.params.applicationID=$fileclient.applicationID,syn.$r.params.businessID=$fileclient.businessID,$fileclient.executeProxy(syn.$r.url(),function(e){var t;e&&1==e.Result&&(t=syn.$l.get(r),0==$object.isNullOrUndefined(t))&&(t.value=""),n&&n(e)})},uploadBlob(e,t){e=syn.$w.argumentsExtend({repositoryID:null,dependencyID:null,blobInfo:null,mimeType:"application/octet-stream",fileName:null},e);var r,n,i=$fileclient.getFileManagerSetting();0==$string.isNullOrEmpty(e.repositoryID)&&0==$string.isNullOrEmpty(e.dependencyID)&&e.blobInfo?(syn.$r.path=$fileclient.getRepositoryUrl()+"/"+i.pageUploadFile,syn.$r.params.repositoryID=e.repositoryID,syn.$r.params.dependencyID=e.dependencyID,syn.$r.params.applicationID=$fileclient.applicationID,syn.$r.params.businessID=$fileclient.businessID,(r=syn.$w.xmlHttp()).open("POST",syn.$r.url()),r.onload=function(){if(200!=r.status)syn.$l.eventLog("$fileclient.uploadBlob","HTTP Error code: {0}, text: {1}".format(r.status,r.statusText),"Warning");else try{var e=r.responseText;0==$string.isNullOrEmpty(e)?t&&t(JSON.parse(e)):syn.$w.alert("Blob 파일 업로드 정보 확인 필요")}catch(e){syn.$w.alert("Blob 파일 업로드 오류: {0}".format(e.message)),syn.$l.eventLog("$fileclient.uploadBlob",e,"Warning")}},r.onerror=function(){syn.$l.eventLog("$fileclient.uploadBlob","HTTP Error code: {0}, text: {1}".format(r.status,r.statusText),"Warning")},i=new FormData,n=e.fileName||"blob-"+syn.$l.random(24),i.append("file",e.blobInfo,n),r.send(i)):(e="Blob 파일 업로드 필수 항목 확인 필요",syn.$w.alert(e),syn.$l.eventLog("$fileclient.uploadBlob",e,"Warning"))},uploadDataUri(e,t){e=syn.$w.argumentsExtend({repositoryID:null,dependencyID:null,dataUri:null,mimeType:null,fileName:null},e),0==$string.isNullOrEmpty(e.repositoryID)&&0==$string.isNullOrEmpty(e.dependencyID)&&0==$string.isNullOrEmpty(e.dataUri)?(e.blobInfo=syn.$l.dataUriToBlob(e.dataUri),e.mimeType=e.blobInfo.type,$fileclient.uploadBlob(e,t)):(e="DataUri 파일 업로드 필수 항목 확인 필요",syn.$w.alert(e),syn.$l.eventLog("$fileclient.uploadDataUri",e,"Warning"))},uploadBlobUri(t,r){var e;t=syn.$w.argumentsExtend({repositoryID:null,dependencyID:null,blobUri:null,mimeType:null,fileName:null},t),0==$string.isNullOrEmpty(t.repositoryID)&&0==$string.isNullOrEmpty(t.dependencyID)&&0==$string.isNullOrEmpty(t.blobUri)?syn.$l.blobUrlToBlob(t.blobUri,function(e){t.blobInfo=e,t.mimeType=t.blobInfo.type,$fileclient.uploadBlob(t,r)}):(e="BlobUri 파일 업로드 필수 항목 확인 필요",syn.$w.alert(e),syn.$l.eventLog("$fileclient.uploadBlobUri",e,"Warning"))},uploadUI(e){var t=$object.clone(syn.$w.dialogOptions);t.minWidth=420,t.minHeight=320,e=syn.$w.argumentsExtend(t,e),t.minWidth=e.minWidth,t.minHeight=e.minHeight,t.caption=e.dialogTitle,""==e.repositoryID||""==e.uploadUrl?syn.$w.alert("uploadOptions에 repositoryID 또는 uploadUrl이 입력되지 않았습니다."):(-1<e.uploadUrl.indexOf("?")?e.uploadUrl+="&repositoryID="+e.repositoryID:e.uploadUrl+="?repositoryID="+e.repositoryID,e.uploadUrl+="&companyNo="+syn.$w.User.WorkCompanyNo,fileUploadOptions=e,syn.$w.showUIDialog(e.uploadUrl,t))},toFileLengthString(e){var t="0 KB";return(e=e<0?0:e)<1048576&&(t=(e/1024).toString()+" KB"),t=e<1073741824?(e/1024/1024).toString()+" MB":t},executeProxy(t,r){var n=syn.$w.xmlHttp();n.onreadystatechange=function(){var e;n.readyState===XMLHttpRequest.DONE&&(200===n.status?(e=n.responseText,0==$string.isNullOrEmpty(e)?r&&r(JSON.parse(e)):syn.$w.alert("파일 응답 정보 확인 필요")):syn.$l.eventLog("$fileclient.executeProxy","async url: "+t+", status: "+n.status.toString()+", responseText: "+n.responseText,"Error"))},n.open("GET",t,!0),n.send()},getTemporaryDependencyID(e){return 1==$string.isNullOrEmpty(e)?syn.$l.guid().replaceAll("-",""):e+syn.$l.random(24)},setLocale(e,t,r,n){}}),$fileclient.moduleInit(),syn.uicontrols.$fileclient=$fileclient}(window),!function(window){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var $list=syn.uicontrols.$list||new syn.module;$list.extend({name:"syn.uicontrols.$list",version:"v2025.3.1",listControls:[],defaultSetting:{width:"100%",height:"300px",paging:!0,ordering:!0,info:!0,searching:!0,select:!0,lengthChange:!1,autoWidth:!0,pageLength:50,orderCellsTop:!0,fixedHeader:!0,responsive:!0,checkbox:!1,order:[],sScrollY:"0px",footerCallback:function(){},fnDrawCallback:function(){var i=this.dataTable(),o=this.closest(".dataTables_wrapper");setTimeout(function(){"undefined"!=typeof TableTools&&null!=(e=TableTools.fnGetInstance(table))&&e.fnResizeRequired()&&e.fnResizeButtons();var e=o.parent().height(),t=o.find(".dataTables_paginate").height(),r=0,n=(o.find(".fg-toolbar").each(function(e,t){r+=$(t).height()}),0),e=(o.find(".dataTables_scrollHead").each(function(e,t){n+=$(t).height()}),e-r-n-t),t=o.find(".dataTables_scrollBody");t.height(e),t.css({maxHeight:e.toString()+"px"}),i._fnScrollDraw()},150)},language:{emptyTable:"데이터가 없습니다",info:"_START_ - _END_ / _TOTAL_",infoEmpty:"0 - 0 / 0",infoFiltered:"(총 _MAX_ 개)",infoThousands:",",lengthMenu:"페이지당 줄수 _MENU_",loadingRecords:"읽는중...",processing:"처리중...",search:"검색:",zeroRecords:"검색 결과가 없습니다",paginate:{first:"처음",last:"마지막",next:"다음",previous:"이전"}},dataType:"string",belongID:null,getter:!1,setter:!1,controlText:null,validators:null,transactConfig:null,triggerConfig:null},addModuleList:function(e,t,r,n){var i=e.getAttribute("id"),o=e.getAttribute("syn-datafield"),e=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:e,field:o,module:this.name,type:n})},controlLoad:function(elID,setting){var el=syn.$l.get(elID),mod=(setting=syn.$w.argumentsExtend($list.defaultSetting,setting),window[syn.$w.pageScript]),moduleSettings,parent=(mod&&mod.hook.controlInit&&(moduleSettings=mod.hook.controlInit(elID,setting),setting=syn.$w.argumentsExtend(setting,moduleSettings)),setting.width=el.style.width||setting.width,setting.height=el.style.height||setting.height,el.setAttribute("id",elID+"_hidden"),el.setAttribute("syn-options",JSON.stringify(setting)),el.style.display="none",el.parentNode),wrapper=document.createElement("div"),headers=(wrapper.style.width=setting.width,wrapper.style.height=setting.height,wrapper.style.position="relative",wrapper.className="list-container",[]);headers.push("<thead><tr>"),!0===setting.checkbox&&(setting.columnDefs=[{targets:0,checkboxes:{selectRow:!0}}],setting.select={style:"multi"},delete setting.sScrollY,delete setting.fnDrawCallback);for(var i=0;i<setting.columns.length;i++){var column=setting.columns[i];headers.push("<th>{0}</th>".format(column.title)),delete column.title}headers.push("</tr></thead>"),wrapper.innerHTML='<table id="'+elID+'" class="display" style="width:100%">'+headers.join("")+"</table>",parent.appendChild(wrapper),!0===setting.searching&&($("#{0} thead tr".format(elID)).clone(!0).appendTo("#{0} thead".format(elID)),$("#{0} thead tr:eq(1) th".format(elID)).each(function(t){$(this).text();$(this).html('<input type="text" class="dataTables_searchtext" />'),$("input",this).on("keyup change",function(){var e=this.closest(".dataTables_wrapper").id.split("_")[0],e=$list.getControl(e).table;e.column(t).search()!==this.value&&e.column(t).search(this.value).draw()})}),!0===setting.checkbox)&&$("#lstDataTable thead tr:eq(1) th:first-child input").hide();var elDataTable=$("#"+elID),table=elDataTable.DataTable(setting),gridHookEvents=syn.$l.get(elID+"_hidden").getAttribute("syn-events");try{gridHookEvents=gridHookEvents&&eval(gridHookEvents)}catch(error){syn.$l.eventLog("GridList_controlLoad",error.toString(),"Debug")}if(gridHookEvents)for(var i=0;i<gridHookEvents.length;i++){var hook=gridHookEvents[i],mod=window[syn.$w.pageScript];if(mod){var eventHandler=mod.event["{0}_{1}".format(elID,hook)];if(eventHandler)switch(hook){case"select":table.on("select",function(e,t,r,n){var i;table[r](n).nodes().to$().addClass("custom-selected"),"row"===r&&(i=table.rows(n).data(),mod.event["{0}_{1}".format(elID,hook)].apply(syn.$l.get(elID),[i,e,t,r,n]))});break;case"deselect":table.on("deselect",function(e,t,r,n){mod.event["{0}_{1}".format(elID,hook)].apply(syn.$l.get(elID),[e,t,r,n])});break;case"dblclick":$("#{0}_wrapper table tbody".format(elID)).on("dblclick","tr",function(){var e=table.row(this).data();mod.event["{0}_{1}".format(elID,hook)].apply(syn.$l.get(elID),[this,e])})}}}$list.listControls.push({id:elID,table:table,list:elDataTable.dataTable(),config:setting,value:null}),setting.bindingID&&syn.uicontrols.$data&&syn.uicontrols.$data.bindingSource(elID,setting.bindingID)},getValue:function(e,t){var r=null,e=$("#"+e).DataTable();return r=e.context?e.data().toArray():r},setValue:function(e,t,r){e=$list.getControl(e);e&&(e.list.fnClearTable(),e.list.fnAddData(t))},clear:function(e,t){var r=$list.getControl(e);if(r){r.list.fnClearTable(),r.table.columns().search("").draw();for(var n=document.getElementById(e+"_wrapper").querySelectorAll(".dataTables_searchtext"),i=0;i<n.length;i++)n[i].value=""}},getControl:function(e){for(var t=null,r=$list.listControls.length,n=0;n<r;n++){var i=$list.listControls[n];if(i.id==e){t=i;break}}return t},setCellData:function(e,t,r,n){var i=$list.getControl(e);i&&(1==$object.isString(r)&&(r=$list.propToCol(e,r)),0<i.table.cell(t,r).length)&&i.table.cell(t,r).data(n).draw()},propToCol:function(e,t){var r=-1,e=$list.getControl(e);if(e)for(var n=e.table.settings().toArray()[0].aoColumns,i=0;i<n.length;i++)if(n[i].data==t){r=i;break}return r},setLocale:function(e,t,r,n){}}),syn.uicontrols.$list=$list}(window),!function(window){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var $guide=syn.uicontrols.$guide||new syn.module;$guide.extend({name:"syn.uicontrols.$guide",version:"v2025.3.1",guideControls:[],itemTemplate:{helpType:"",selector:"",subject:"",sentence:"",options:"",sortingNo:0},defaultSetting:{items:[],introOptions:{prevLabel:'<svg xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-chevron-left"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M15 6l-6 6l6 6" /></svg>',nextLabel:'<svg xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-chevron-right"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 6l6 6l-6 6" /></svg>',doneLabel:"완료",skipLabel:'<svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-x"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18 6l-12 12" /><path d="M6 6l12 12" /></svg>',dontShowAgainLabel:"다시 안보기",exitOnEsc:!0,showStepNumbers:!0,showBullets:!1,tooltipPosition:"auto",overlayOpacity:.2,steps:[]},tooltipOptions:{placement:"top-start",allowHTML:!0,animateFill:!0,maxWidth:"640px"},placeholderOptions:{letterDelay:25,sentenceDelay:1e3,startOnFocus:!0,loop:!1,shuffle:!1,showCursor:!0,cursor:"|"}},addModuleList(e,t,r,n){var i=e.getAttribute("id"),o=e.getAttribute("syn-datafield"),e=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:e,field:o,module:this.name,type:n})},controlLoad(elID,setting){var el=syn.$l.get(elID),mod=(setting=syn.$w.argumentsExtend($guide.defaultSetting,setting),window[syn.$w.pageScript]),moduleSettings,tooltips=(mod&&mod.hook.controlInit&&(moduleSettings=mod.hook.controlInit(elID,setting),setting=syn.$w.argumentsExtend(setting,moduleSettings)),el.setAttribute("syn-options",JSON.stringify(setting)),el.style.display="none",[]),intros=null,placeholders=[];if(setting.items&&0<setting.items.length){var helpIntros=setting.items.filter(function(e){return"I"==e.helpType});if(window.introJs&&0<helpIntros.length){for(var introOptions=setting.introOptions,steps=[],helpIntros=$array.objectSort(helpIntros,"sortingNo",!0),i=0;i<helpIntros.length;i++){var helpIntro=helpIntros[i],introEL=syn.$l.querySelector(helpIntro.selector);null!=introEL&&(0==$string.isNullOrEmpty(helpIntro.options)&&(introOptions=syn.$w.argumentsExtend(introOptions,eval("("+helpIntro.options+")"))),steps.push({title:helpIntro.subject,element:introEL,intro:helpIntro.sentence,position:helpIntro.position||"auto"}))}if(0<steps.length&&(introOptions=syn.$w.argumentsExtend(introOptions,{steps:steps}),intros=introJs().setOptions(introOptions),mod)){var hookEvents=el.getAttribute("syn-events")||[];if(hookEvents)for(var hookEvents=eval(hookEvents),i=0,length=hookEvents.length;i<length;i++){var hook=hookEvents[i],eventHandler=mod.event?mod.event["{0}_{1}".format(elID,hook)]:null;if(eventHandler)switch(hook){case"complete":intros.oncomplete(eventHandler);break;case"exit":intros.onexit(eventHandler);break;case"beforeexit":intros.onbeforeexit(eventHandler);break;case"change":intros.onchange(eventHandler);break;case"beforechange":intros.onbeforechange(eventHandler);break;case"afterchange":intros.onafterchange(eventHandler)}}}}var helpTooltips=setting.items.filter(function(e){return"T"==e.helpType});if(window.tippy&&0<helpTooltips.length)for(var tooltipOptions=setting.tooltipOptions,i=0;i<helpTooltips.length;i++){var helpTooltip=helpTooltips[i],applyDelay=$string.toNumber(helpTooltip.applyDelay),tooltipEL=syn.$l.querySelector(helpTooltip.selector);null==tooltipEL&&0==applyDelay||(0==$string.isNullOrEmpty(helpTooltip.options)&&(tooltipOptions=syn.$w.argumentsExtend(tooltipOptions,eval("("+helpTooltip.options+")"))),tooltipOptions.content=(1==$string.isNullOrEmpty(helpTooltip.subject)?"":"<strong>{0}</strong> ".format(helpTooltip.subject))+helpTooltip.sentence,0<applyDelay?setTimeout((e,t)=>{tooltips.push(tippy(e,t)[0])},applyDelay,helpTooltip.selector,$object.clone(tooltipOptions,!0)):tooltips.push(tippy(helpTooltip.selector,tooltipOptions)[0]))}var helpPlaceHolders=setting.items.filter(function(e){return"P"==e.helpType});if(window.superplaceholder&&0<helpPlaceHolders.length)for(var i=0;i<helpPlaceHolders.length;i++){var helpPlaceHolder=helpPlaceHolders[i],placeholderOptions={};if(placeholderOptions.el=syn.$l.querySelector(helpPlaceHolder.selector),null!=placeholderOptions.el){if(placeholderOptions.options=setting.placeholderOptions,0==$string.isNullOrEmpty(helpPlaceHolder.options)&&(placeholderOptions.options=syn.$w.argumentsExtend(placeholderOptions.options,eval("("+helpPlaceHolder.options+")"))),1==$object.isString(helpPlaceHolder.sentence))placeholderOptions.sentences=[(1==$string.isNullOrEmpty(helpPlaceHolder.subject)?"":"[{0}] ".format(helpPlaceHolder.subject))+helpPlaceHolder.sentence];else if(1==$object.isArray(helpPlaceHolder.sentence)){if(0==$string.isNullOrEmpty(helpPlaceHolder.subject))for(var i=0,length=helpPlaceHolder.sentence.length;i<length;i++)helpPlaceHolder.sentence[i]=`[${helpPlaceHolder.subject}] `+helpPlaceHolder.sentence[i];placeholderOptions.sentences=helpPlaceHolder.sentence}0==$object.isNullOrUndefined(placeholderOptions.sentences)&&placeholders.push(superplaceholder(placeholderOptions))}}}else setting.items=[];$guide.guideControls.push({id:elID,items:setting.items,tooltip:tooltips,intro:intros,placeholder:placeholders})},getGuideControl(e){for(var t=null,r=$guide.guideControls.length,n=0;n<r;n++){var i=$guide.guideControls[n];if(i.id==e){t=i;break}}return t},introStart(e){var e=$guide.getGuideControl(e);e&&(e=e.intro)&&e.start()},openUIHelp(e){var t=$guide.getGuideControl(e);t&&(syn.$l.get(e),e=t.items.find(function(e){return"U"==e.helpType}),0==$object.isNullOrUndefined(e))&&((t=e.options&&JSON.parse($string.toCharHtml(e.options)))&&"link"==t.contentType?0==$string.isNullOrEmpty(e.sentence)?window.open(e.sentence,"help"):syn.$l.eventLog("callProgramHelp","화면 도움말 링크 확인 필요","Warning"):(t=window.open("","help"),1==$object.isNullOrUndefined(t)?syn.$w.alert('"{0}" 내용을 확인하기 위해 팝업을 허용해야 합니다'.format(e.subject)):(e=`
                            <html style="margin: 0;">
                                <head>
                                    <link type="text/css" rel="stylesheet" href="/js/tinymce/skins/ui/oxide/content.min.css">
                                    <link type="text/css" rel="stylesheet" href="/js/tinymce/skins/content/default/content.min.css">
                                </head>
                                <body style="margin: 0; width: 100%; padding:8px;" class="mce-content-body">
                                    <h1>${e.subject}</h1>${e.sentence}
                                </body>
                            </html>
                            `,t.document.open(),t.document.write(e),t.document.close())))},dataRefresh(elID,items){var setting=JSON.parse(syn.$l.get(elID).getAttribute("syn-options")),guide=$guide.getGuideControl(elID);if(guide&&items){$guide.clear(elID),guide.items=[],guide.tooltip=[],guide.intro=null,guide.placeholder=[];var tooltips=[],intros=null,placeholders=[];if(items&&0<items.length){var helpIntros=items.filter(function(e){return"I"==e.helpType});if(window.introJs&&0<helpIntros.length){for(var introOptions=setting.introOptions,steps=[],helpIntros=$array.objectSort(helpIntros,"sortingNo",!0),i=0;i<helpIntros.length;i++){var helpIntro=helpIntros[i];0==$string.isNullOrEmpty(helpIntro.options)&&(introOptions=syn.$w.argumentsExtend(introOptions,eval("("+helpIntro.options+")"))),steps.push({title:helpIntro.subject,element:syn.$l.querySelector(helpIntro.selector),intro:helpIntro.sentence})}0<steps.length&&(introOptions=syn.$w.argumentsExtend(introOptions,{steps:steps}),intros=introJs().setOptions(introOptions))}var helpTooltips=items.filter(function(e){return"T"==e.helpType});if(window.tippy&&0<helpTooltips.length)for(var tooltipOptions=setting.tooltipOptions,i=0;i<helpTooltips.length;i++){var helpTooltip=helpTooltips[i],applyDelay=(0==$string.isNullOrEmpty(helpTooltip.options)&&(tooltipOptions=syn.$w.argumentsExtend(tooltipOptions,eval("("+helpTooltip.options+")"))),tooltipOptions.content=(1==$string.isNullOrEmpty(helpTooltip.subject)?"":"<strong>{0}</strong> ".format(helpTooltip.subject))+helpTooltip.sentence,$string.toNumber(helpTooltip.applyDelay));0<applyDelay?setTimeout((e,t)=>{tooltips.push(tippy(e,t)[0])},applyDelay,helpTooltip.selector,$object.clone(tooltipOptions,!0)):tooltips.push(tippy(helpTooltip.selector,tooltipOptions)[0])}var helpPlaceHolders=items.filter(function(e){return"P"==e.helpType});if(window.superplaceholder&&0<helpPlaceHolders.length)for(var i=0;i<helpPlaceHolders.length;i++){var placeholderOptions={},helpPlaceHolder=(placeholderOptions.options=setting.placeholderOptions,helpPlaceHolders[i]);if(0==$string.isNullOrEmpty(helpPlaceHolder.options)&&(placeholderOptions.options=syn.$w.argumentsExtend(placeholderOptions.options,eval("("+helpPlaceHolder.options+")"))),placeholderOptions.el=syn.$l.querySelector(helpPlaceHolder.selector),1==$object.isString(helpPlaceHolder.sentence))placeholderOptions.sentences=[(1==$string.isNullOrEmpty(helpPlaceHolder.subject)?"":"[{0}] ".format(helpPlaceHolder.subject))+helpPlaceHolder.sentence];else if(1==$object.isArray(helpPlaceHolder.sentence)){if(0==$string.isNullOrEmpty(helpPlaceHolder.subject))for(var i=0,length=helpPlaceHolder.sentence.length;i<length;i++)helpPlaceHolder.sentence[i]=`[${helpPlaceHolder.subject}] `+helpPlaceHolder.sentence[i];placeholderOptions.sentences=helpPlaceHolder.sentence}0==$object.isNullOrUndefined(placeholderOptions.sentences)&&placeholders.push(superplaceholder(placeholderOptions))}}else items=[];$guide.clear(elID),guide.items=items,guide.tooltip=tooltips,guide.intro=intros,guide.placeholder=placeholders}},getValue(e){return syn.$l.get(e).value},setValue(e,t){syn.$l.get(e).value=t||""},clear(e){syn.$l.get(e).value="";var t=$guide.getGuideControl(e);if(t){if(0==$object.isNullOrUndefined(t.tooltip))for(var r=0,n=t.tooltip.length;r<n;r++)t.tooltip[r].destroy();if(0==$object.isNullOrUndefined(t.intro)&&t.intro.exit(),0==$object.isNullOrUndefined(t.placeholder))for(r=0,n=t.placeholder.length;r<n;r++)t.placeholder[r].destroy()}},setLocale(e,t,r,n){}}),syn.uicontrols.$guide=$guide}(window),!function(window){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var $radio=$radio||new syn.module;$radio.extend({name:"syn.uicontrols.$radio",version:"v2025.3.26",defaultSetting:{contents:"",toSynControl:!1,dataType:"string",belongID:null,getter:!1,setter:!1,controlText:null,validators:null,transactConfig:null,triggerConfig:null},addModuleList(e,t,r,n){var i=e.getAttribute("id"),o=e.getAttribute("syn-datafield"),e=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:e,field:o,module:this.name,type:n})},controlLoad(elID,setting){var el=syn.$l.get(elID),mod=(setting=syn.$w.argumentsExtend($radio.defaultSetting,setting),window[syn.$w.pageScript]),moduleSettings,dataFieldID,events,value,checked,name,html,html,parent,wrapper;mod&&mod.hook.controlInit&&(moduleSettings=mod.hook.controlInit(elID,setting),setting=syn.$w.argumentsExtend(setting,moduleSettings)),(1==setting.toSynControl?(el.setAttribute("id",el.id+"_hidden"),el.setAttribute("syn-options",JSON.stringify(setting)),el.style.display="none",dataFieldID=el.getAttribute("syn-datafield"),events=el.getAttribute("syn-events"),value=el.value,checked=el.checked,name=el.name,html="",html=events?'<input class="ui_radio" id="{0}" name="{1}" type="radio" syn-datafield="{2}" value="{3}" {4} syn-events={5}>'.format(elID,name,dataFieldID,value,1==checked?'checked="checked"':"","['"+eval(events).join("','")+"']"):'<input class="ui_radio" id="{0}" name="{1}" type="radio" syn-datafield="{2}" value="{3}" {4}>'.format(elID,name,dataFieldID,value,1==checked?'checked="checked"':""),1==$object.isString(setting.textContent)&&(html+='<label for="{0}">{1}</label>'.format(elID,setting.textContent)),parent=el.parentNode,wrapper=syn.$m.create({tag:"span",className:"formControl"}),wrapper.innerHTML=html,parent.appendChild(wrapper),syn.$l.get(elID)):el).setAttribute("syn-options",JSON.stringify(setting)),setting.bindingID&&syn.uicontrols.$data&&syn.uicontrols.$data.bindingSource(elID,setting.bindingID)},getValue(e,t){return syn.$l.get(e).checked},setValue(e,t,r){syn.$l.get(e).checked=t},clear(e,t){syn.$l.get(e).checked=!1},getGroupNames(){for(var e=[],t=syn.$l.querySelectorAll("input[type='radio']"),r=0;r<t.length;r++)e.push(t[r].name);return $array.distinct(e)},getSelectedByValue(e){for(var t=null,r=syn.$l.querySelectorAll('input[type="radio"][name="{0}"]'.format(e)),n=0;n<r.length;n++){var i=r[n];if(-1==i.id.indexOf("_hidden")&&1==i.checked){t=i.value;break}}return t},getSelectedByText(e){for(var t=null,r=syn.$l.querySelectorAll('input[type="radio"][name="{0}"]'.format(e)),n=0;n<r.length;n++){var i=r[n];if(-1==i.id.indexOf("_hidden")&&1==i.checked){t=i.nextElementSibling.textContent.trim();break}}return t},getSelectedByID(e){for(var t=null,r=syn.$l.querySelectorAll('input[type="radio"][name="{0}"]'.format(e)),n=0;n<r.length;n++){var i=r[n];if(-1==i.id.indexOf("_hidden")&&1==i.checked){t=i.id;break}}return t},selectedValue(e,t){for(var r=syn.$l.querySelectorAll('input[type="radio"][name="{0}"]'.format(e)),n=0;n<r.length;n++){r[n];if(-1==r[n].id.indexOf("_hidden")&&r[n].value===t){r[n].checked=!0;break}}},setLocale(e,t,r,n){}}),syn.uicontrols.$radio=$radio}(window),!function(window){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var $textarea=syn.uicontrols.$textarea||new syn.module;$textarea.extend({name:"syn.uicontrols.$textarea",version:"v2025.3.14",textControls:[],defaultSetting:{width:"100%",height:"240px",indentUnit:4,lineNumbers:!0,toSynControl:!0,resize:!1,dataType:"string",belongID:null,getter:!1,setter:!1,controlText:null,validators:null,transactConfig:null,triggerConfig:null},addModuleList(e,t,r,n){var i=e.getAttribute("id"),o=e.getAttribute("syn-datafield"),e=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:e,field:o,module:this.name,type:n})},controlLoad(elID,setting){var el=syn.$l.get(elID),mod=(setting=syn.$w.argumentsExtend($textarea.defaultSetting,setting),window[syn.$w.pageScript]),moduleSettings,events=(mod&&mod.hook.controlInit&&(moduleSettings=mod.hook.controlInit(elID,setting),setting=syn.$w.argumentsExtend(setting,moduleSettings)),setting.elementID=elID,setting.width=el.style.width||setting.width,setting.height=el.style.height||setting.height,el.style.width=setting.width,el.style.height=setting.height,el.setAttribute("syn-options",JSON.stringify(setting)),el.spellcheck=1==$string.toBoolean(setting.spellcheck)?"true":"false",el.getAttribute("syn-events")),editor=null;if(0==setting.resize&&(el.style.resize="none"),1==setting.toSynControl){if((el.getAttribute("maxlength")||el.getAttribute("maxlengthB"))&&(el.getAttribute("maxlengthB")&&el.setAttribute("maxlength",el.getAttribute("maxlengthB")),setting.maxLength=el.getAttribute("maxlength")),editor=CodeMirror.fromTextArea(el,setting),0==$object.isNullOrUndefined(setting.maxLength)&&editor.on("blur",function(e,t){var r=syn.$l.get(editor.options.elementID).getAttribute("maxlengthB"),r=0==$string.isNullOrEmpty(r)?parseInt(r):e.getOption("maxLength");return r<$string.length(e.getValue())&&(e=$object.clone(syn.$w.alertOptions),syn.$w.alert($resource.translations.textMaxLength.format($string.toCurrency(r)),"정보",e,function(e){editor.focus()})),!0}),events)for(var events=eval(events),i=0;i<events.length;i++){var editorEvent=events[i],eventHandler=mod.event[el.id+"_"+editorEvent];eventHandler&&editor.on(editorEvent,eventHandler)}editor.setSize(setting.width,setting.height),setTimeout(function(){editor.refresh()},30)}else(el.getAttribute("maxlength")||el.getAttribute("maxlengthB"))&&(el.getAttribute("maxlengthB")&&el.setAttribute("maxlength",el.getAttribute("maxlengthB")),syn.$l.addEvent(el,"blur",$textarea.event_blur));$textarea.textControls.push({id:elID,editor:editor,setting:$object.clone(setting)}),setting.bindingID&&syn.uicontrols.$data&&syn.uicontrols.$data.bindingSource(elID,setting.bindingID)},countLines(e){return($textarea.getValue(e)||"").split("\n").length},getValue(e){var t=null,r=$textarea.getControl(e);return r&&r.editor?t=r.editor.getValue():(r=syn.$l.get(e),0==$object.isNullOrUndefined(r)&&(t=r.value)),t},setValue(e,t){var r=$textarea.getControl(e);r&&r.editor?r.editor.setValue(t):(r=syn.$l.get(e),0==$object.isNullOrUndefined(r)&&(r.value=t))},clear(e,t){var r=$textarea.getControl(e);r&&r.editor?r.editor.setValue(""):(r=syn.$l.get(e),0==$object.isNullOrUndefined(r)&&(r.value=""))},getControl(e){for(var t=null,r=$textarea.textControls.length,n=0;n<r;n++){var i=$textarea.textControls[n];if(i.id==e){t=i;break}}return t},event_blur(e){var t,r,e=e.target||e.srcElement||e,n=e.getAttribute("maxlengthB");0==$string.isNullOrEmpty(n)?(t=parseInt(n))<$string.length(e.value)&&(r=$object.clone(syn.$w.alertOptions),syn.$w.alert($resource.translations.textMaxLength.format($string.toCurrency(t)),"정보",r),e.focus()):(n=e.getAttribute("maxlength"),0==$string.isNullOrEmpty(n)&&(t=parseInt(n))<e.value.length&&(r=$object.clone(syn.$w.alertOptions),syn.$w.alert($resource.translations.textMaxLength.format($string.toCurrency(t)),"정보",r),e.focus()))},setLocale(e,t,r,n){}}),syn.uicontrols.$textarea=$textarea}(window),!function(s){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var i=new syn.module;i.extend({name:"syn.uicontrols.$textbox",version:"v2025.3.25",defaultSetting:{editType:"text",inValidateClear:!0,formatNumber:!0,maskPattern:null,maxCount:null,minCount:0,allowChars:[],placeText:[],defaultSetValue:"0",dataType:"string",belongID:null,getter:!1,setter:!1,controlText:null,validators:null,transactConfig:null,triggerConfig:null},addModuleList(e,t,r,n){var i=e.getAttribute("id"),o=e.getAttribute("syn-datafield"),e=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:e,field:o,module:this.name,type:n})},controlLoad(e,t){var r=syn.$l.get(e),n=(t=syn.$w.argumentsExtend(i.defaultSetting,t),s[syn.$w.pageScript]);switch(n&&n.hook.controlInit&&(n=n.hook.controlInit(e,t),t=syn.$w.argumentsExtend(t,n)),r.setAttribute("syn-options",JSON.stringify(t)),r.spellcheck=1==$string.toBoolean(t.spellcheck)?"true":"false",0==$object.isEmpty(t.placeText)&&superplaceholder({el:r,sentences:1==$object.isString(t.placeText)?[t.placeText]:t.placeText}),t.editType){case"text":syn.$l.addEvent(r,"focus",i.event_focus);break;case"english":syn.$l.addEvent(r,"focus",i.event_focus),syn.$l.addEvent(r,"blur",i.event_english_blur),syn.$l.addEvent(r,"input",i.event_english_input),syn.$m.setStyle(r,"ime-mode","disabled");break;case"uppercase":syn.$l.addEvent(r,"focus",i.event_focus),syn.$l.addEvent(r,"blur",i.event_uppercase_blur),syn.$l.addEvent(r,"input",i.event_uppercase_input),syn.$m.setStyle(r,"ime-mode","disabled");break;case"lowercase":syn.$l.addEvent(r,"focus",i.event_focus),syn.$l.addEvent(r,"blur",i.event_lowercase_blur),syn.$l.addEvent(r,"input",i.event_lowercase_input),syn.$m.setStyle(r,"ime-mode","disabled");break;case"number":syn.$l.addEvent(r,"focus",i.event_numeric_focus),syn.$l.addEvent(r,"blur",i.event_number_blur),syn.$l.addEvent(r,"input",i.event_numeric_input),syn.$m.setStyle(r,"ime-mode","disabled"),VMasker(r).maskNumber();break;case"numeric":syn.$l.addEvent(r,"focus",i.event_numeric_focus),syn.$l.addEvent(r,"blur",i.event_numeric_blur),syn.$l.addEvent(r,"input",i.event_numeric_input),syn.$m.setStyle(r,"ime-mode","disabled"),VMasker(r).maskNumber();break;case"spinner":syn.$l.addEvent(r,"focus",i.event_numeric_focus),syn.$l.addEvent(r,"blur",i.event_numeric_blur),syn.$l.addEvent(r,"input",i.event_numeric_input),syn.$m.setStyle(r,"ime-mode","disabled"),r.offsetWidth,new ISpin(r,{wrapperClass:"ispin-wrapper",buttonsClass:"ispin-button",step:1,pageStep:10,disabled:!1,repeatInterval:100,wrapOverflow:!1,parse:Number,format:String}),VMasker(r).maskNumber();break;case"year":syn.$l.addEvent(r,"focus",i.event_focus),syn.$l.addEvent(r,"blur",i.event_year_blur),syn.$l.addEvent(r,"input",i.event_numeric_input);break;case"date":syn.$l.addEvent(r,"focus",i.event_focus),syn.$l.addEvent(r,"blur",i.event_date_blur),syn.$l.addEvent(r,"input",i.event_numeric_input);break;case"hour":syn.$l.addEvent(r,"focus",i.event_focus),syn.$l.addEvent(r,"blur",i.event_hour_blur),syn.$l.addEvent(r,"input",i.event_numeric_input),syn.$m.setStyle(r,"ime-mode","disabled");break;case"minute":syn.$l.addEvent(r,"focus",i.event_focus),syn.$l.addEvent(r,"blur",i.event_minute_blur),syn.$l.addEvent(r,"input",i.event_numeric_input),syn.$m.setStyle(r,"ime-mode","disabled");break;case"yearmonth":syn.$l.addEvent(r,"focus",i.event_focus),syn.$l.addEvent(r,"blur",i.event_yearmonth_blur),syn.$l.addEvent(r,"input",i.event_numeric_input);break;case"homephone":syn.$l.addEvent(r,"focus",i.event_phone_focus),syn.$l.addEvent(r,"blur",i.event_homephone_blur),syn.$l.addEvent(r,"input",i.event_numeric_input),syn.$m.setStyle(r,"ime-mode","disabled");break;case"mobilephone":syn.$l.addEvent(r,"focus",i.event_phone_focus),syn.$l.addEvent(r,"blur",i.event_mobilephone_blur),syn.$l.addEvent(r,"input",i.event_numeric_input),syn.$m.setStyle(r,"ime-mode","disabled");break;case"phone":syn.$l.addEvent(r,"focus",i.event_phone_focus),syn.$l.addEvent(r,"blur",i.event_phone_blur),syn.$l.addEvent(r,"input",i.event_numeric_input),syn.$m.setStyle(r,"ime-mode","disabled");break;case"email":syn.$l.addEvent(r,"focus",i.event_focus),syn.$l.addEvent(r,"blur",i.event_email_blur),syn.$m.setStyle(r,"ime-mode","inactive");break;case"juminno":syn.$l.addEvent(r,"focus",i.event_focus),syn.$l.addEvent(r,"blur",i.event_juminno_blur),syn.$l.addEvent(r,"input",i.event_numeric_input),syn.$m.setStyle(r,"ime-mode","disabled"),1==$string.isNullOrEmpty(t.maskPattern)&&VMasker(r).maskPattern("999999-9999999");break;case"businessno":syn.$l.addEvent(r,"focus",i.event_focus),syn.$l.addEvent(r,"blur",i.event_businessno_blur),syn.$l.addEvent(r,"input",i.event_numeric_input),syn.$m.setStyle(r,"ime-mode","disabled"),1==$string.isNullOrEmpty(t.maskPattern)&&VMasker(r).maskPattern("999-99-99999");break;case"corporateno":syn.$l.addEvent(r,"focus",i.event_focus),syn.$l.addEvent(r,"blur",i.event_corporateno_blur),syn.$l.addEvent(r,"input",i.event_numeric_input),syn.$m.setStyle(r,"ime-mode","disabled"),1==$string.isNullOrEmpty(t.maskPattern)&&VMasker(r).maskPattern("999999-9999999")}(r.getAttribute("maxlength")||r.getAttribute("maxlengthB"))&&(r.getAttribute("maxlengthB")&&r.setAttribute("maxlength",r.getAttribute("maxlengthB")),syn.$l.addEvent(r,"blur",i.event_blur)),0==$string.isNullOrEmpty(t.maskPattern)&&VMasker(r).maskPattern(t.maskPattern),t.contents&&i.setValue(e,t.contents),t.bindingID&&syn.uicontrols.$data&&syn.uicontrols.$data.bindingSource(e,t.bindingID)},event_english_input(e){var t=e.target||e.srcElement||e,r=e.which||e.keyCode,n=!1,n=!!/^[a-zA-Z0-9_]$/.test(String.fromCharCode(r))||(t.value=t.value.replace(/[\ㄱ-ㅎㅏ-ㅣ가-힣]/g,""),e.returnValue=!1,e.cancel=!0,e.preventDefault&&e.preventDefault(),!1),r=JSON.parse(t.getAttribute("syn-options")).textCase||"";return"upper"==r?t.value=t.value.toUpperCase():"lower"==r&&(t.value=t.value.toLowerCase()),n},event_uppercase_input(e){var t=e.target||e.srcElement||e;return t.value=t.value.replace(/[^A-Za-z]/g,"").toUpperCase(),e.returnValue=!1,e.cancel=!0,e.preventDefault&&e.preventDefault(),!1},event_lowercase_input(e){var t=e.target||e.srcElement||e;return t.value=t.value.replace(/[^A-Za-z]/g,"").toLowerCase(),e.returnValue=!1,e.cancel=!0,e.preventDefault&&e.preventDefault(),!1},event_numeric_input(e){var t=e.target||e.srcElement||e,r=e.which||e.keyCode;if(31<r&&(r<48||57<r||45==r||109==r)){if(45==r||109==r){r=t.value;if(1==r.startsWith("-")&&r.split("-").length<=2||1==r.split("-").length)return!0}e.returnValue=!1,e.cancel=!0,e.preventDefault&&e.preventDefault(),0}return!0},event_focus(e){e=e.target||e.srcElement||e;0<e.value.length&&i.rangeMoveCaret(e)},event_phone_focus(e){e=e.target||e.srcElement||e;0<e.value.length&&(e.value=e.value.replace(/-/g,""),i.rangeMoveCaret(e))},event_numeric_focus(e){e=e.target||e.srcElement||e;0<e.value.length&&(e.value=$string.toNumberString(e.value),i.rangeMoveCaret(e))},event_blur(e){var t,r,e=e.target||e.srcElement||e,n=e.getAttribute("maxlengthB");0==$string.isNullOrEmpty(n)?(t=parseInt(e.getAttribute("maxlengthB")))<$string.length(e.value)&&(r=$object.clone(syn.$w.alertOptions),syn.$w.alert($resource.translations.textMaxLength.format($string.toCurrency(t)),"정보",r),e.focus(),i.event_focus(e)):(n=e.getAttribute("maxlength"),0==$string.isNullOrEmpty(n)&&(t=parseInt(e.getAttribute("maxlength")))<e.value.length&&(r=$object.clone(syn.$w.alertOptions),syn.$w.alert($resource.translations.textMaxLength.format($string.toCurrency(t)),"정보",r),e.focus(),i.event_focus(e)))},event_hour_blur(e){e=e.target||e.srcElement||e;0<e.value.length&&(23<parseInt(e.value)&&(e.value="23"),1==e.value.length)&&(e.value=e.value.padStart(2,"0"))},event_minute_blur(e){e=e.target||e.srcElement||e;0<e.value.length&&(59<parseInt(e.value)&&(e.value="59"),1==e.value.length)&&(e.value=e.value.padStart(2,"0"))},event_english_blur(e){var e=e.target||e.srcElement||e,t=JSON.parse(e.getAttribute("syn-options")).allowChars||[];0<t.length&&-1<t.indexOf(e.value)||(e.value=e.value.replace(/[^a-z0-9]/gi,""))},event_uppercase_blur(e){e=e.target||e.srcElement||e;e.value=e.value.replace(/[^A-Z]/gi,"")},event_lowercase_blur(e){e=e.target||e.srcElement||e;e.value=e.value.replace(/[^a-z]/gi,"")},event_number_blur(e){var e=e.target||e.srcElement||e,t=JSON.parse(e.getAttribute("syn-options")),t=(0==$object.isNullOrUndefined(t.maxCount)&&$string.toNumber(e.value)>t.maxCount&&(e.value=t.maxCount),0==$object.isNullOrUndefined(t.minCount)&&$string.toNumber(e.value)<t.minCount&&(e.value=t.minCount),e.value);(1==t.startsWith("-")&&1==t.length||0==t.trim().length)&&(e.value="0")},event_numeric_blur(e){var e=e.target||e.srcElement||e,t=JSON.parse(e.getAttribute("syn-options")),t=(0==$object.isNullOrUndefined(t.maxCount)&&$string.toNumber(e.value)>t.maxCount&&(e.value=t.maxCount),0==$object.isNullOrUndefined(t.minCount)&&$string.toNumber(e.value)<t.minCount&&(e.value=t.minCount),0<e.value.length&&!0===t.formatNumber&&(e.value=$string.toCurrency(e.value)),e.value);(1==t.startsWith("-")&&1==t.length||0==t.trim().length)&&(e.value="0")},event_homephone_blur(e){var e=e.target||e.srcElement||e,t=(e.value=e.value.replace(/-/g,""),e.value);0<t.length&&(e.setAttribute("placeholder",""),12==t.length?1==syn.$v.regexs.onesPhone.test(t)?e.value=t.substr(0,4).concat("-",t.substr(4,4),"-",t.substr(8,4)):e.value="":9==t.length?1==syn.$v.regexs.seoulPhone.test(t)?e.value=t.substr(0,2).concat("-",t.substr(2,3),"-",t.substr(5,4)):e.value="":10==t.length?"02"==t.substring(0,2)?1==syn.$v.regexs.seoulPhone.test(t)?e.value=t.substr(0,2).concat("-",t.substr(2,4),"-",t.substr(6,4)):e.value="":1==syn.$v.regexs.areaPhone.test(t)?e.value=t.substr(0,3).concat("-",t.substr(3,3),"-",t.substr(6,4)):e.value="":11==t.length&&(1==syn.$v.regexs.areaPhone.test(t)||1==syn.$v.regexs.mobilePhone.test(t))?e.value=t.substr(0,3).concat("-",t.substr(3,4),"-",t.substr(7,4)):e.value="",""==e.value)&&e.setAttribute("placeholder","전화번호 확인 필요")},event_mobilephone_blur(e){var e=e.target||e.srcElement||e,t=(e.value=e.value.replace(/-/g,""),e.value);0<t.length&&(e.setAttribute("placeholder",""),1==syn.$v.regexs.mobilePhone.test(t)?10==t.length?e.value=t.substr(0,3).concat("-",t.substr(3,3),"-",t.substr(6,4)):11==t.length?e.value=t.substr(0,3).concat("-",t.substr(3,4),"-",t.substr(7,4)):e.value="":e.value="",""==e.value)&&e.setAttribute("placeholder","전화번호 확인 필요")},event_phone_blur(e){var e=e.target||e.srcElement||e,t=(e.value=e.value.replace(/-/g,""),e.value);0<t.length&&(e.setAttribute("placeholder",""),1==syn.$v.regexs.mobilePhone.test(t)?10==t.length?e.value=t.substr(0,3).concat("-",t.substr(3,3),"-",t.substr(6,4)):11==t.length?e.value=t.substr(0,3).concat("-",t.substr(3,4),"-",t.substr(7,4)):e.value="":12==t.length?1==syn.$v.regexs.onesPhone.test(t)?e.value=t.substr(0,4).concat("-",t.substr(4,4),"-",t.substr(8,4)):e.value="":9==t.length?1==syn.$v.regexs.seoulPhone.test(t)?e.value=t.substr(0,2).concat("-",t.substr(2,3),"-",t.substr(5,4)):e.value="":10==t.length?"02"==t.substring(0,2)?1==syn.$v.regexs.seoulPhone.test(t)?e.value=t.substr(0,2).concat("-",t.substr(2,4),"-",t.substr(6,4)):e.value="":1==syn.$v.regexs.areaPhone.test(t)?e.value=t.substr(0,3).concat("-",t.substr(3,3),"-",t.substr(6,4)):e.value="":11==t.length&&(1==syn.$v.regexs.areaPhone.test(t)||1==syn.$v.regexs.mobilePhone.test(t))?e.value=t.substr(0,3).concat("-",t.substr(3,4),"-",t.substr(7,4)):e.value="",""==e.value)&&e.setAttribute("placeholder","전화번호 확인 필요")},event_email_blur(e){var e=e.target||e.srcElement||e,t=e.value;0<e.value.length&&(e.setAttribute("placeholder",""),0==syn.$v.regexs.email.test(t))&&(e.setAttribute("placeholder","이메일 확인 필요"),e.value="")},event_year_blur(e){e=e.target||e.srcElement||e;0<e.value.length&&(e.setAttribute("placeholder",""),"0000"!=e.value&&0!=$date.isDate(e.value)||(e.setAttribute("placeholder","년도 확인 필요"),e.value=""))},event_yearmonth_blur(e){e=e.target||e.srcElement||e;0<e.value.length&&(e.setAttribute("placeholder",""),"0000-00"!=e.value&&0!=$date.isDate(e.value+"-01")||(e.setAttribute("placeholder","년월 확인 필요"),e.value=""))},event_date_blur(e){var t,e=e.target||e.srcElement||e;0<e.value.length&&(e.setAttribute("placeholder",""),8==(t=e.value).length&&(t=t.substring(0,4)+"-"+t.substring(4,6)+"-"+t.substring(6,8)),1==$date.isDate(t)?e.value=t:(e.setAttribute("placeholder","일자 확인 필요"),e.value=""))},event_juminno_blur(e){var e=e.target||e.srcElement||e,t=e.value;0<t.length&&(e.setAttribute("placeholder",""),0==syn.$v.regexs.juminNo.test(t)?(e.setAttribute("placeholder","주민등록번호 확인 필요"),e.value=""):(13==t.length&&(t=t.substring(0,6)+"-"+t.substring(6,13)),e.value=t))},event_businessno_blur(e){var e=e.target||e.srcElement||e,t=e.value;0<t.length&&(e.setAttribute("placeholder",""),0==i.isBusinessNo(t)?(e.setAttribute("placeholder","사업자번호 확인 필요"),e.value=""):(12!=t.length&&(t=(t=t.replace(/-/gi,"")).substring(0,3)+"-"+t.substring(3,5)+"-"+t.substring(5)),e.value=t))},event_corporateno_blur(e){var t,e=e.target||e.srcElement||e,r=e.value;0<r.length&&(e.setAttribute("placeholder",""),0==i.isCorporateNo(r)?(t=JSON.parse(e.getAttribute("syn-options")),1==$object.isNullOrUndefined(t.inValidateClear)||1==t.inValidateClear?(e.setAttribute("placeholder","법인번호 확인 필요"),e.value=""):(syn.$m.addClass(e,"font:red!"),syn.$m.addClass(e,"font:bold"))):(14!=r.length&&(r=(r=r.replace(/-/gi,"")).substring(0,6)+"-"+r.substring(6)),e.value=r,syn.$m.removeClass(e,"font:red!"),syn.$m.removeClass(e,"font:bold")))},isBusinessNo(e){var t=!1,r=e.replace(/-/gi,"").split("").map(function(e){return parseInt(e,10)});if(10===r.length)try{for(var n=[1,3,7,1,3,7,1,3,5],i=0,o=0;o<n.length;++o)i+=n[o]*r[o];i+=parseInt(n[8]*r[8]/10,10),t=Math.floor(r[9])===(10-i%10)%10}catch(e){t=!1}return t},isCorporateNo(e){var t=e.replace(/-/gi,""),r=[1,2,1,2,1,2,1,2,1,2,1,2],n=0;if(13!=(t=t.trim()).length)return!1;for(var i=0;i<12;i++)n+=r[i]*t.charAt(i);return(10-n%10)%10==t.charAt(12)},rangeMoveCaret(e){var t=e.target?e.srcElement:e,r=t.value.length,n=function(){var e;"email"!=t.type&&t.setSelectionRange?t.setSelectionRange(0,r):t.createTextRange&&((e=t.createTextRange()).collapse(!0),e.moveEnd("character",r),e.moveStart("character",0),e.select())};(syn.$b.isIE?n:()=>{setTimeout(n,0)})()},getValue(e){var t="",r=syn.$l.get(e);if(0==$object.isNullOrUndefined(r)){var n=JSON.parse(r.getAttribute("syn-options"));switch(n.editType){case"text":case"english":case"number":case"spinner":case"date":case"hour":case"minute":case"yearmonth":case"homephone":case"mobilephone":case"email":case"juminno":case"businessno":case"corporateno":var i=s[syn.$w.pageScript];(!0!==n.getter||!i.hook.frameEvent||(t=i.hook.frameEvent("controlGetter",{elID:e,value:r.value}),1==$object.isNullOrUndefined(t)))&&(t=r.value);break;case"numeric":t=r.value.replace(/,/g,"");break;default:t=""}}return t},setValue(e,t){var r=syn.$l.get(e);if(0==$object.isNullOrUndefined(r))if(null!=t){var n=JSON.parse(r.getAttribute("syn-options"));switch(n.editType){case"text":case"english":case"number":case"spinner":case"date":case"hour":case"minute":case"yearmonth":case"homephone":case"mobilephone":case"email":case"juminno":case"businessno":case"corporateno":var i=s[syn.$w.pageScript];n&&!0===n.setter&&i.hook.frameEvent?(i=i.hook.frameEvent("controlSetter",{elID:e,value:t}),1==$object.isNullOrUndefined(i)&&(r.value=i)):r.value=t;break;case"numeric":-1<t.indexOf(",")?r.value=t:r.value=1==$string.isNumber(t)?$string.toCurrency(t):t;break;default:r.value=""}}else{var o=syn.$w.getTriggerOptions(e);o&&o.value&&(r.value=o.value)}},clear(e,t){var r,e=syn.$l.get(e);0==$object.isNullOrUndefined(e)&&(r=JSON.parse(e.getAttribute("syn-options")),e.value=$object.defaultValue(r.dataType))},setLocale(e,t,r,n){var i,e=syn.$l.get(e),o=$resource.getBindSource(r,"placeholder");null!=o&&(r=$resource.translateText(r,n),e[o]=r,"placeholder"==o?(i=JSON.parse(e.getAttribute("syn-options")))&&(i.placeText=r,0==$object.isEmpty(i.placeText)&&superplaceholder({el:e,sentences:1==$object.isString(i.placeText)?[i.placeText]:i.placeText}),e.setAttribute("syn-options",JSON.stringify(i))):"controlText"==o&&(i=JSON.parse(e.getAttribute("syn-options")))&&(i.controlText=r,e.setAttribute("syn-options",JSON.stringify(i))))}}),syn.uicontrols.$textbox=i}(window),!function(o){syn.uicontrols=syn.uicontrols||new syn.module;var s=syn.uicontrols.$sourceeditor||new syn.module;s.extend({name:"syn.uicontrols.$sourceeditor",version:"v2025.3.1",editorPendings:[],editorControls:[],defaultSetting:{width:"100%",height:"360px",language:"javascript",minimap:{enabled:!1},roundedSelection:!1,scrollBeyondLastLine:!1,readOnly:!1,lineNumbers:"on",theme:"vs-dark",dataType:"string",basePath:"/lib/monaco-editor/min/vs",belongID:null,controlText:null,validators:null,transactConfig:null,triggerConfig:null},controlLoad(e,t){o.monaco?s.lazyControlLoad(e,t):(syn.$w.loadScript(s.defaultSetting.basePath+"/loader.js","monacosourceeditor",()=>{o.require&&(require.config({paths:{vs:syn.uicontrols.$sourceeditor.defaultSetting.basePath},"vs/nls":{availableLanguages:{"*":"ko"}}}),o.MonacoEnvironment={getWorkerUrl:function(e,t){return"data:text/javascript,"}},require(["vs/editor/editor.main","vs/nls.messages.ko"],function(){if(o.monaco){for(var e=s.editorPendings.length,t=0;t<e;t++){var r=s.editorPendings[t];s.lazyControlLoad(r.elID,r.setting)}s.editorPendings.length=0}}))}),s.editorPendings.push({elID:e,setting:t}))},lazyControlLoad(e,t){var r=syn.$l.get(e),n=(t=syn.$w.argumentsExtend(s.defaultSetting,t),o[syn.$w.pageScript]),n=(n&&n.hook.controlInit&&(n=n.hook.controlInit(e,t),t=syn.$w.argumentsExtend(t,n)),r.setAttribute("id",r.id+"_hidden"),r.setAttribute("syn-options",JSON.stringify(t)),r.style.display="none",r.parentNode),i=document.createElement("div"),r=(i.id=e,i.setAttribute("syn-datafield",r.getAttribute("syn-datafield")),i.setAttribute("syn-options",r.getAttribute("syn-options")),syn.$m.setStyle(i,"width",t.width),syn.$m.setStyle(i,"height",t.height),n.appendChild(i),monaco.editor.create(i,t));r.onKeyDown(function(e){"Space"===e.code&&!0===e.ctrlKey&&e.preventDefault()}),syn.$l.addEvent(o,"resize",s.window_onresize),s.editorControls.push({id:e,editor:r,setting:$object.clone(t)})},window_onresize(){for(var e=s.editorControls.length,t=0;t<e;t++){var r=s.editorControls[t],r=s.getControl(r.id);r&&r.editor&&(result=r.editor.layout())}},getValue(e,t){var r="",n=syn.$l.get(e);return r=0==$object.isNullOrUndefined(n)&&(n=s.getControl(e))&&n.editor?n.editor.getValue():r},setValue(e,t,r){var n=syn.$l.get(e);0==$object.isNullOrUndefined(n)&&(n=s.getControl(e))&&n.editor&&n.editor.setValue(t)},clear(e,t){var r=syn.$l.get(e);0==$object.isNullOrUndefined(r)&&(r=s.getControl(e))&&r.editor&&r.editor.setValue("")},applyEdits(e,t){var r;e&&(r=syn.$l.get(elID),0==$object.isNullOrUndefined(r))&&(r=s.getControl(elID))&&r.editor&&(null==t&&(t=r.editor.getPosition()),r.editor.getModel().applyEdits([{range:monaco.Range.fromPositions(t),text:e}]))},getValueInRange(e){var t=null,r=syn.$l.get(elID);return 0==$object.isNullOrUndefined(r)&&(r=s.getControl(elID))&&r.editor&&(null==e&&(e=r.editor.getPosition()),t=r.editor.getModel().getValueInRange(e)),t},getContentLine(e){if(e){var t=0,r=syn.$l.get(elID);if(0==$object.isNullOrUndefined(r)){r=s.getControl(elID);if(r&&r.editor)for(var n=r.editor.getValue().split("\n"),i=n.length,o=0;o<i;o++)if(-1<n[o].indexOf(e)){t=o+1;break}}return t}},setSelection(e){var t;e&&(t=syn.$l.get(elID),0==$object.isNullOrUndefined(t))&&(t=s.getControl(elID))&&t.editor&&t.editor.setSelection(e)},revealLine(e){var t,r=syn.$l.get(elID);0==$object.isNullOrUndefined(r)&&(r=s.getControl(elID))&&r.editor&&(e&&(e=(t=r.editor.getModel().getLineCount())<e?t:e),r.editor.revealLine(e))},findSelection(e){var t;e&&(t=syn.$l.get(elID),0==$object.isNullOrUndefined(t))&&(t=s.getControl(elID))&&t.editor&&(t.editor.trigger(e,"actions.find"),t.editor.trigger(e,"actions.findWithSelection"),t.editor.trigger(e,"editor.action.nextMatchFindAction"),t.editor.trigger("keyboard","closeFindWidget"))},layoutResize(e){var t=syn.$l.get(e);0==$object.isNullOrUndefined(t)&&(t=s.getControl(e))&&t.editor&&t.editor.layout()},getActions(e){var t=null,r=syn.$l.get(e);return t=0==$object.isNullOrUndefined(r)&&(r=s.getControl(e))&&r.editor?r.editor.getActions():t},getControl(e){for(var t=null,r=s.editorControls.length,n=0;n<r;n++){var i=s.editorControls[n];if(i.id==e){t=i;break}}return t},setLocale(e,t,r,n){}}),syn.uicontrols.$sourceeditor=s}(window),!function(){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var d=syn.uicontrols.$htmleditor||new syn.module;d.extend({name:"syn.uicontrols.$htmleditor",version:"v2025.3.24",userWorkID:"",applicationID:"",editorPendings:[],editorControls:[],defaultSetting:{businessID:"",applicationID:"",selector:"",fileManagerServer:"",fileManagerPath:"/repository/api/storage",pageUploadFile:"upload-file",pageActionHandler:"action-handler",repositoryID:null,dependencyID:null,relative_urls:!1,remove_script_host:!1,convert_urls:!1,isNumberTempDependency:!0,height:300,imageFileSizeLimit:6291456,viewerHtml:'<html><head><base href="/"><style type="text/css">body { font-family: \'Noto Sans KR\', \'Pretendard\', \'Nanum Gothic\', \'Malgun Gothic\', Gulim, 굴림, sans-serif !important; font-size: 14px; }</style><link type="text/css" rel="stylesheet" href="/lib/tinymce/skins/ui/oxide/content.min.css"><link type="text/css" rel="stylesheet" href="/lib/tinymce/skins/content/default/content.min.css"></head><body id="tinymce" class="mce-content-body">{0}<script>document.onselectstart = function () { return false; }; document.oncontextmenu = function () { return false; }; document.addEventListener && document.addEventListener("click", function(e) {for (var elm = e.target; elm; elm = elm.parentNode) {if (elm.nodeName === "A" && !(e.ctrlKey && !e.altKey)) {e.preventDefault();}}}, false);<\/script></body></html>',language:"ko_KR",plugins:["autolink link image lists print hr anchor pagebreak searchreplace visualblocks visualchars code insertdatetime media nonbreaking table paste help"],toolbar:"styleselect | bold italic forecolor backcolor table | alignleft aligncenter alignright | link image | code help",menubar:!1,content_style:"body { font-family: 'Noto Sans KR', 'Pretendard', 'Nanum Gothic', 'Malgun Gothic', Gulim, 굴림, sans-serif !important; font-size: 14px; }",powerpaste_word_import:"merge",powerpaste_googledocs_import:"merge",defaultHtmlContent:null,table_default_attributes:{border:"1",width:"100%"},table_default_styles:{"border-collapse":"collapse",width:"100%"},table_responsive_width:!1,limitTableWidth:null,verify_html:!1,table_sizing_mode:"fixed",images_file_types:"jpeg,jpg,png,gif,bmp,webp,JPEG,JPG,PNG,GIF,BMP,WEBP",paste_data_images:!0,resize:!1,allowExternalLink:!1,prefixHtml:"",suffixHtml:"",limitGuideLineWidth:"",dataType:"string",belongID:null,getter:!1,setter:!1,controlText:null,validators:null,transactConfig:null,triggerConfig:null},addModuleList(e,t,r,n){var i=e.getAttribute("id"),o=e.getAttribute("syn-datafield"),e=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:e,field:o,module:this.name,type:n})},concreate(){window.tinymce||syn.$w.loadScript("/lib/tinymce/tinymce.min.js")},controlLoad(e,t){var r;window.tinymce?d.lazyControlLoad(e,t):(r=setInterval(function(){if(window.tinymce){for(var e=d.editorPendings.length,t=0;t<e;t++){var r=d.editorPendings[t];clearInterval(r.intervalID),d.lazyControlLoad(r.elID,r.setting)}d.editorPendings.length=0}},25),d.editorPendings.push({elID:e,setting:$object.clone(t),intervalID:r}))},getEditorSetting(e){for(var t=null,r=d.editorPendings.length,n=0;n<r;n++){var i=d.editorPendings[n];if(i.id==e){t=i.setting;break}}return t},lazyControlLoad(c,u){var a=syn.$l.get(c),e=(u=syn.$w.argumentsExtend(d.defaultSetting,u),window[syn.$w.pageScript]),e=(e&&e.hook.controlInit&&(e=e.hook.controlInit(c,u),u=syn.$w.argumentsExtend(u,e)),0==$string.isNullOrEmpty(u.repositoryID)?(1==location.pathname.startsWith(syn.Config.TenantAppRequestPath?`/${syn.Config.TenantAppRequestPath}/`:"/app/")?1==$string.isNullOrEmpty(d.applicationID)&&(d.applicationID=syn.$w.ManagedApp.ApplicationID):1==$string.isNullOrEmpty(d.applicationID)&&(d.applicationID=syn.$w.Variable.ApplicationID||syn.$w.User.ApplicationID||syn.Config.ApplicationID),1==$string.isNullOrEmpty(d.applicationID)&&syn.$l.eventLog("$htmleditor.controlLoad","파일 컨트롤 초기화 오류, ApplicationID 정보 확인 필요","Error"),syn.Config.FileBusinessIDSource&&"None"!=syn.Config.FileBusinessIDSource&&("Cookie"==syn.Config.FileBusinessIDSource?syn.uicontrols.$fileclient.businessID=syn.$r.getCookie("FileBusinessID"):"SessionStorage"==syn.Config.FileBusinessIDSource&&(syn.uicontrols.$fileclient.businessID=syn.$w.getStorage("FileBusinessID"))),1==$string.isNullOrEmpty(syn.uicontrols.$fileclient.businessID)&&(syn.uicontrols.$fileclient.businessID=syn.$w.User.WorkCompanyNo),1==$string.isNullOrEmpty(syn.uicontrols.$fileclient.businessID)&&(syn.uicontrols.$fileclient.businessID="0"),1==$string.isNullOrEmpty(u.fileManagerServer)&&syn.Config&&syn.Config.FileManagerServer&&(u.fileManagerServer=syn.Config.FileManagerServer),1==$string.isNullOrEmpty(u.fileManagerServer)&&syn.$l.eventLog("$htmleditor.fileManagerServer","HTML 편집기 업로드 초기화 오류, 파일 서버 정보 확인 필요","Error"),1==$string.isNullOrEmpty(u.dependencyID)&&(1==u.isNumberTempDependency?u.dependencyID=$date.toTicks(new Date).toString():u.dependencyID=syn.uicontrols.$fileclient.getTemporaryDependencyID(c)),u.images_upload_handler=function(t,r,n){function i(i,r,o){var s=syn.$w.xmlHttp(),e=(s.withCredentials=!1,u.fileManagerServer+u.fileManagerPath+"/"+u.pageUploadFile+"?RepositoryID={0}&DependencyID={1}".format(u.repositoryID,u.dependencyID));0==$string.isNullOrEmpty(d.userWorkID)&&(e=e+"&userWorkID="+d.userWorkID),0==$string.isNullOrEmpty(d.applicationID)&&(e=e+"&applicationID="+d.applicationID),s.open("POST",e),s.onload=function(){if(200!=s.status)e="HTTP Error code: {0}, text: {1}".format(s.status,s.statusText),syn.$l.eventLog("$htmleditor.images_upload_handler",e,"Warning"),o(e);else try{var t,e,n=JSON.parse(s.responseText);n&&1==n.Result?(syn.$r.path=u.fileManagerServer+u.fileManagerPath+"/"+u.pageActionHandler,syn.$r.params.action="GetItem",syn.$r.params.repositoryID=u.repositoryID,syn.$r.params.itemID=n.ItemID,0==$string.isNullOrEmpty(d.userWorkID)&&(syn.$r.params.userWorkID=d.userWorkID),0==$string.isNullOrEmpty(d.applicationID)&&(syn.$r.params.applicationID=d.applicationID),(t=syn.$w.xmlHttp()).onreadystatechange=function(){var e;t.readyState===XMLHttpRequest.DONE&&(200===t.status?(e=JSON.parse(t.responseText),n.location=e.AbsolutePath,r(n.location),setTimeout(function(){var e,t,r=tinymce.activeEditor.$('img[src$="'+n.location+'"]');0<r.length&&(e=i.width,t=i.height,tinymce.activeEditor.dom.setStyle(r,"width",e),tinymce.activeEditor.dom.setStyle(r,"height",t),r.attr("width",e),r.attr("height",t),r.after("&nbsp;"))},100)):syn.$l.eventLog("$htmleditor.images_upload_handler","async url: "+url+", status: "+t.status.toString()+", responseText: "+t.responseText,"Error"))},t.open("GET",syn.$r.url(),!0),t.send()):(e=n.Message,syn.$w.alert("이미지 업로드 실패: {0}".format(e)),syn.$l.eventLog("$htmleditor.images_upload_handler",e,"Warning"),o(e))}catch(e){syn.$w.alert("이미지 업로드 오류: {0}".format(e.message)),syn.$l.eventLog("$htmleditor.images_upload_handler",e,"Warning"),o(e)}},s.onerror=function(){var e="HTTP Error code: {0}, text: {1}".format(s.status,s.statusText);syn.$l.eventLog("$htmleditor.images_upload_handler",e,"Warning"),o(e)},(e=new FormData).append("file",i.blob,i.fileName),s.send(e)}var e=t.blob().size;if(u.imageFileSizeLimit<e){var e="에디터에 표시 가능한 이미지 파일크기는 {0} 미만입니다".format($number.toByteString(u.imageFileSizeLimit)),o=(syn.$w.alert(e),t.blobUri()),e=(syn.$r.revokeBlobUrl(o),n(e),tinymce.activeEditor.$('img[src$="'+o+'"]'));0<e.length&&e.remove()}else try{var s=window[syn.$w.pageScript].event["{0}_beforeUploadImageResize".format(c)];s?s.apply(a,[c,t,e=>{i({blob:e.blob,width:e.width,height:e.height,fileName:t.filename()},r,n)}]):d.resizeImage(t,0).then(e=>{i({blob:e.blob,width:e.width,height:e.height,fileName:t.filename()},r,n),syn.uicontrols.$htmleditor.getHtmlEditor(c).execCommand("mceRepaint")})}catch(e){syn.$l.eventLog("$htmleditor.images_upload_handler",e.toString(),"Error")}}):syn.$l.eventLog("$htmleditor.fileManagerServer",c+": HTML 편집기내 이미지 파일 업로드 사용 안함","Debug"),u.paste_preprocess=function(e,t){},u.paste_postprocess=function(e,t){if(t.node.firstElementChild&&"TABLE"==t.node.firstElementChild.tagName&&0==(t.mode&&"merge"==t.mode)){var t=t.node.firstElementChild,r=(t.border="1",t.cellspacing="0",t.cellpadding="0",syn.$m.setStyle(t,"border-collapse","collapse"),t.querySelectorAll("thead tr:first-child td")),n=r.length;if(0<n)for(var i=0;i<n;i++){var o=r[i];syn.$m.setStyle(o,"background-color","#ecf0f1")}else if(0<(n=(r=t.querySelectorAll("tr:first-child td")).length))for(i=0;i<n;i++){o=r[i];syn.$m.setStyle(o,"background-color","#ecf0f1")}}},u.width=a.style.width||320,u.height=a.style.height||240,a.setAttribute("id",a.id+"_hidden"),a.setAttribute("syn-options",JSON.stringify(u)),a.style.display="none",a.parentNode),t=document.createElement("div");t.style.width=u.width,t.style.height=u.height,t.id=c,t.innerHTML=1==$string.isNullOrEmpty(a.innerHTML)?"<div></div>":a.innerHTML,e.appendChild(t),u.selector="#"+c,u.init_instance_callback=function(a){for(var e=d.editorControls.length,t=0;t<e;t++){var r=d.editorControls[t];if(r.id==c){r.editor=a;break}}var l=syn.$l.get(c),n=l.getAttribute("setInitValue");0==$string.isNullOrEmpty(n)&&d.setValue(c,n),a.on("keydown",function(e){9==(e.keyCode||e.which)&&(a.execCommand("mceInsertContent",!1,"&nbsp;&nbsp;&nbsp;&nbsp;"),tinymce.dom.Event.cancel(e),e.preventDefault())}),a.on("ObjectResized",function(e){if("TABLE"==e.target.nodeName)for(var t=e.target,r=(0==$string.isNullOrEmpty(u.limitTableWidth)&&u.limitTableWidth<t.style.width&&(t.style.width=u.limitTableWidth),0==$string.isNullOrEmpty(t.style.width)&&t.setAttribute("width",t.style.width),0==$string.isNullOrEmpty(t.style.height)&&t.setAttribute("height",t.style.height),e.target.querySelectorAll("td")),n=r.length,i=0;i<n;i++){var o=r[i];0==$string.isNullOrEmpty(o.style.width)&&o.setAttribute("width",o.style.width),0==$string.isNullOrEmpty(o.style.height)&&o.setAttribute("height",o.style.height)}var s;"IMG"==e.target.nodeName&&(t=tinymce.activeEditor.selection.getNode(),s=window[syn.$w.pageScript].event["{0}_imageResized".format(c)])&&s.apply(l,[c,e,a,t])}),0==$string.isNullOrEmpty(u.defaultHtmlContent)&&a.setContent(u.defaultHtmlContent),1==u.readonly&&Array.from(a.getDoc().querySelectorAll("a")).map(function(e){e.target="_blank"}),1==u.readonly&&1==u.allowExternalLink&&Array.from(a.getDoc().querySelectorAll(".mce-object-iframe")).map(function(e){e.setAttribute("data-mce-selected","2")});n=window[syn.$w.pageScript].event["{0}_documentReady".format(c)];n&&n.apply(l,[c,a])},tinymce.addI18n("ko_KR",{Redo:"다시 실행",Undo:"실행 취소",Cut:"잘라내기",Copy:"복사",Paste:"붙여넣기","Select all":"전체선택","New document":"새 문서",Ok:"확인",Cancel:"취소","Visual aids":"시각교재",Bold:"굵게",Italic:"기울임꼴",Underline:"밑줄",Strikethrough:"취소선",Superscript:"위 첨자",Subscript:"아래 첨자","Clear formatting":"서식 지우기","Align left":"왼쪽 맞춤","Align center":"가운데 맞춤","Align right":"오른쪽 맞춤",Justify:"양쪽 맞춤","Bullet list":"글머리 기호 목록","Numbered list":"번호 매기기 목록","Decrease indent":"내어쓰기","Increase indent":"들여쓰기","Alternative description":"대체 설명문구",Close:"닫기",Formats:"서식","Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead.":"브라우저가 클립보드 접근을 지원하지 않습니다. Ctrl+X/C/V 단축키를 이용하십시오.",Headers:"머리글","Header 1":"머리글 1","Header 2":"머리글 2","Header 3":"머리글 3","Header 4":"머리글 4","Header 5":"머리글 5","Header 6":"머리글 6",Headings:"제목","Heading 1":"제목 1","Heading 2":"제목 2","Heading 3":"제목 3","Heading 4":"제목 4","Heading 5":"제목 5","Heading 6":"제목 6",Preformatted:"서식 미설정",Div:"Div",Pre:"Pre",Code:"코드",Paragraph:"단락",Blockquote:"인용문",Inline:"인라인",Blocks:"블록","Paste is now in plain text mode. Contents will now be pasted as plain text until you toggle this option off.":"스타일복사 끄기. 이 옵션을 끄기 전에는 복사 시, 스타일이 복사되지 않습니다.",Fonts:"글꼴","Font Sizes":"글꼴 크기",Class:"클래스","Browse for an image":"이미지 찾기",OR:"또는","Drop an image here":"여기로 이미지 끌어오기",Upload:"업로드",Block:"블록",Align:"정렬",Default:"기본",Circle:"원",Disc:"원반",Square:"사각","Lower Alpha":"알파벳 소문자","Lower Greek":"그리스어 소문자","Lower Roman":"로마자 소문자","Upper Alpha":"알파벳 소문자","Upper Roman":"로마자 대문자","Anchor...":"앵커...",Name:"이름",Id:"아이디","Id should start with a letter, followed only by letters, numbers, dashes, dots, colons or underscores.":"아이디는 문자, 숫자, 대시, 점, 콜론 또는 밑줄로 시작해야 합니다.","You have unsaved changes are you sure you want to navigate away?":"저장하지 않은 정보가 있습니다. 이 페이지를 벗어나시겠습니까?","Restore last draft":"마지막 초안 복원","Special character...":"특수 문자...","Source code":"소스코드","Insert/Edit code sample":"코드샘플 삽입/편집",Language:"언어","Code sample...":"코드 샘플...","Color Picker":"색 선택기",R:"R",G:"G",B:"B","Left to right":"왼쪽에서 오른쪽","Right to left":"오른쪽에서 왼쪽","Emoticons...":"이모티콘...","Metadata and Document Properties":"메타데이터와 문서 속성",Title:"제목",Keywords:"키워드",Description:"설명",Robots:"로봇",Author:"저자",Encoding:"인코딩",Fullscreen:"전체화면",Action:"동작",Shortcut:"단축키",Help:"도움말",Address:"주소","Focus to menubar":"메뉴에 포커스","Focus to toolbar":"툴바에 포커스","Focus to element path":"element path에 포커스","Focus to contextual toolbar":"켄텍스트 툴바에 포커스","Insert link (if link plugin activated)":"링크 삽입 (link 플러그인이 활성화된 상태에서)","Save (if save plugin activated)":"저장 (save 플러그인이 활성화된 상태에서)","Find (if searchreplace plugin activated)":"찾기(searchreplace 플러그인이 활성화된 상태에서)","Plugins installed ({0}):":"설치된 플러그인 ({0}):","Premium plugins:":"고급 플러그인","Learn more...":"좀 더 살펴보기","You are using {0}":"{0}를 사용중",Plugins:"플러그인","Handy Shortcuts":"단축키","Horizontal line":"가로","Insert/edit image":"이미지 삽입/수정","Image description":"이미지 설명",Source:"소스",Dimensions:"크기","Constrain proportions":"작업 제한",General:"일반",Advanced:"고급",Style:"스타일","Vertical space":"수직 공백","Horizontal space":"수평 공백",Border:"테두리","Insert image":"이미지 삽입","Image...":"이미지...","Image list":"이미지 목록","Rotate counterclockwise":"시계반대방향으로 회전","Rotate clockwise":"시계방향으로 회전","Flip vertically":"수직 뒤집기","Flip horizontally":"수평 뒤집기","Edit image":"이미지 편집","Image options":"이미지 옵션","Zoom in":"확대","Zoom out":"축소",Crop:"자르기",Resize:"크기 조절",Orientation:"방향",Brightness:"밝기",Sharpen:"선명하게",Contrast:"대비","Color levels":"색상레벨",Gamma:"감마",Invert:"반전",Apply:"적용",Back:"뒤로","Insert date/time":"날짜/시간삽입","Date/time":"날짜/시간","Insert/Edit Link":"링크 삽입/편집","Insert/edit link":"링크 삽입/수정","Text to display":"본문",Url:"주소","Open link in...":"...에서 링크 열기","Current window":"현재 창",None:"없음","New window":"새창","Remove link":"링크삭제",Anchors:"책갈피","Link...":"링크...","Paste or type a link":"링크를 붙여넣거나 입력하세요","The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?":"현재 E-mail주소를 입력하셨습니다. E-mail 주소에 링크를 걸까요?","The URL you entered seems to be an external link. Do you want to add the required http:// prefix?":"현재 웹사이트 주소를 입력하셨습니다. 해당 주소에 링크를 걸까요?","Link list":"링크 리스트","Insert video":"비디오 삽입","Insert/edit video":"비디오 삽입/수정","Insert/edit media":"미디어 삽입/수정","Alternative source":"대체 소스","Alternative source URL":"대체 원본 URL","Media poster (Image URL)":"대표 이미지(이미지 URL)","Paste your embed code below:":"아래에 코드를 붙여넣으세요:",Embed:"삽입","Media...":"미디어...","Nonbreaking space":"띄어쓰기","Page break":"페이지 구분자","Paste as text":"텍스트로 붙여넣기",Preview:"미리보기","Print...":"인쇄...",Save:"저장",Find:"찾기","Replace with":"교체",Replace:"교체","Replace all":"전체 교체",Previous:"이전",Next:"다음","Find and replace...":"찾기 및 바꾸기...","Could not find the specified string.":"문자를 찾을 수 없습니다.","Match case":"대소문자 일치","Find whole words only":"모두 일치하는 문자 찾기","Spell check":"맞춤법 검사",Ignore:"무시","Ignore all":"전체무시",Finish:"완료","Add to Dictionary":"사전에 추가","Insert table":"테이블 삽입","Table properties":"테이블 속성","Delete table":"테이블 삭제",Cell:"셀",Row:"열",Column:"행","Cell properties":"셀 속성","Merge cells":"셀 합치기","Split cell":"셀 나누기","Insert row before":"이전에 행 삽입","Insert row after":"다음에 행 삽입","Delete row":"행 지우기","Row properties":"행 속성","Cut row":"행 잘라내기","Copy row":"행 복사","Paste row before":"이전에 행 붙여넣기","Paste row after":"다음에 행 붙여넣기","Insert column before":"이전에 행 삽입","Insert column after":"다음에 열 삽입","Delete column":"열 지우기",Cols:"열",Rows:"행",Width:"넓이",Height:"높이","Cell spacing":"셀 간격","Cell padding":"셀 안쪽 여백","Show caption":"캡션 표시",Left:"왼쪽",Center:"가운데",Right:"오른쪽","Cell type":"셀 타입",Scope:"범위",Alignment:"정렬","H Align":"가로 정렬","V Align":"세로 정렬",Top:"상단",Middle:"중간",Bottom:"하단","Header cell":"헤더 셀","Row group":"행 그룹","Column group":"열 그룹","Row type":"행 타입",Header:"헤더",Body:"바디",Footer:"푸터","Border color":"테두리 색","Insert template...":"템플릿 삽입...",Templates:"템플릿",Template:"템플릿","Text color":"문자 색깔","Background color":"배경색","Custom...":"직접 색깔 지정하기","Custom color":"직접 지정한 색깔","No color":"색상 없음","Remove color":"색 제거","Table of Contents":"목차","Show blocks":"블럭 보여주기","Show invisible characters":"안보이는 문자 보이기","Word count":"단어 수",Count:"개수",Document:"문서",Selection:"선택",Words:"단어","Words: {0}":"단어: {0}","{0} words":"{0} 단어",File:"파일",Edit:"수정",Insert:"삽입",View:"보기",Format:"포맷",Table:"테이블",Tools:"도구","Powered by {0}":"Powered by {0}","Rich Text Area. Press ALT-F9 for menu. Press ALT-F10 for toolbar. Press ALT-0 for help":"서식 있는 텍스트 편집기 입니다. ALT-F9를 누르면 메뉴, ALT-F10를 누르면 툴바, ALT-0을 누르면 도움말을 볼 수 있습니다.","Image title":"이미지 제목","Border width":"테두리 두께","Border style":"테두리 스타일",Error:"오류",Warn:"경고",Valid:"유효함","To open the popup, press Shift+Enter":"팝업을 열려면 Shift+Enter를 누르십시오.","Rich Text Area. Press ALT-0 for help.":"서식 있는 텍스트 영역. ALT-0을 누르면 도움말을 볼 수 있습니다.","System Font":"시스템 글꼴","Failed to upload image: {0}":"이미지 업로드 실패: {0}","Failed to load plugin: {0} from url {1}":"플러그인 로드 실패:  URL: {1}에서의 {0}","Failed to load plugin url: {0}":"플러그인 URL 로드 실패: {0}","Failed to initialize plugin: {0}":"플러그인 초기화 실패: {0}",example:"예제",Search:"검색",All:"모두",Currency:"통화",Text:"텍스트",Quotations:"인용문",Mathematical:"수학","Extended Latin":"확장 라틴어",Symbols:"기호",Arrows:"화살표","User Defined":"사용자 정의","dollar sign":"달러 기호","currency sign":"통화 기호","euro-currency sign":"유로화 기호","colon sign":"콜론 기호","cruzeiro sign":"크루제이루 기호","french franc sign":"프랑스 프랑 기호","lira sign":"리라 기호","mill sign":"밀 기호","naira sign":"나이라 기호","peseta sign":"페세타 기호","rupee sign":"루피 기호","won sign":"원 기호","new sheqel sign":"뉴 세켈 기호","dong sign":"동 기호","kip sign":"킵 기호","tugrik sign":"투그리크 기호","drachma sign":"드라크마 기호","german penny symbol":"독일 페니 기호","peso sign":"페소 기호","guarani sign":"과라니 기호","austral sign":"아우스트랄 기호","hryvnia sign":"그리브나 기호","cedi sign":"세디 기호","livre tournois sign":"리브르 트르누아 기호","spesmilo sign":"스페스밀로 기호","tenge sign":"텡게 기호","indian rupee sign":"인도 루피 기호","turkish lira sign":"터키 리라 기호","nordic mark sign":"노르딕 마르크 기호","manat sign":"마나트 기호","ruble sign":"루블 기호","yen character":"엔 기호","yuan character":"위안 기호","yuan character, in hong kong and taiwan":"대만 위안 기호","yen/yuan character variant one":"엔/위안 문자 변형","Loading emoticons...":"이모티콘 불러오는 중...","Could not load emoticons":"이모티콘을 불러올 수 없음",People:"사람","Animals and Nature":"동물과 자연","Food and Drink":"음식과 음료",Activity:"활동","Travel and Places":"여행과 장소",Objects:"물건",Flags:"깃발",Characters:"문자","Characters (no spaces)":"문자(공백 없음)","{0} characters":"{0} 문자","Error: Form submit field collision.":"오류: 양식 제출 필드 불일치","Error: No form element found.":"오류: 양식 항목 없음",Update:"업데이트","Color swatch":"색상 견본",Turquoise:"청록색",Green:"초록색",Blue:"파란색",Purple:"보라색","Navy Blue":"남색","Dark Turquoise":"진한 청록색","Dark Green":"진한 초록색","Medium Blue":"중간 파란색","Medium Purple":"중간 보라색","Midnight Blue":"진한 파란색",Yellow:"노란색",Orange:"주황색",Red:"빨간색","Light Gray":"밝은 회색",Gray:"회색","Dark Yellow":"진한 노란색","Dark Orange":"진한 주황색","Dark Red":"진한 빨간색","Medium Gray":"중간 회색","Dark Gray":"진한 회색","Light Green":"밝은 녹색","Light Yellow":"밝은 노란색","Light Red":"밝은 빨간색","Light Purple":"밝은 보라색","Light Blue":"밝은 파란색","Dark Purple":"진한 보라색","Dark Blue":"진한 파란색",Black:"검은색",White:"흰색","Switch to or from fullscreen mode":"전체 화면으로/에서 전환","Open help dialog":"도움말 대화창 열기",history:"기록",styles:"스타일",formatting:"포맷팅",alignment:"정렬",indentation:"들여쓰기","permanent pen":"유성펜",comments:"주석","Format Painter":"서식 복사","Insert/edit iframe":"아이프레임 삽입/편집",Capitalization:"대문자화",lowercase:"소문자",UPPERCASE:"대문자","Title Case":"제목을 대문자화","Permanent Pen Properties":"영구 펜 특성","Permanent pen properties...":"영구 펜 특성...",Font:"글꼴",Size:"크기","More...":"더 보기...","Spellcheck Language":"맞춤법 검사 언어","Select...":"선택...",Preferences:"환경설정",Yes:"네",No:"아니오","Keyboard Navigation":"키 선택",Version:"버전",Anchor:"앵커","Special character":"특수문자","Code sample":"코드샘플",Color:"색상",Emoticons:"이모티콘","Document properties":"문서 속성",Image:"이미지","Insert link":"링크 삽입 ",Target:"대상",Link:"링크",Poster:"포스터",Media:"미디어",Print:"출력",Prev:"이전","Find and replace":"찾아서 교체","Whole words":"전체 단어",Spellcheck:"문법체크",Caption:"캡션","Insert template":"템플릿 삽입"}),d.editorControls.push({id:c,editor:null,setting:$object.clone(u)}),tinymce.init(u),0==$string.isNullOrEmpty(u.limitGuideLineWidth)&&syn.$l.get(c).controlPseudoStyle(" + div .tox-edit-area:after",'{content: "";width: 2px;height: 100%;background: #EF4444 repeat-y;top: 0px;left: {0};position: absolute;display: inline-block;}'.format(u.limitGuideLineWidth)),u.bindingID&&syn.uicontrols.$data&&syn.uicontrols.$data.bindingSource(c,u.bindingID)},resizeImage(n,r){function i(){var e=s.width,t=s.height;return t<e?r<=0?(r=600)<e&&(t*=r/e,e=r):r<e&&(t*=r/e,e=r):r<=0?(r=600)<t&&(e*=r/t,t=r):r<t&&(e*=r/t,t=r),a.width=e,a.height=t,a.getContext("2d").drawImage(s,0,0,e,t),{blob:function(e){for(var t=(0<=e.split(",")[0].indexOf("base64")?atob:decodeURIComponent)(e.split(",")[1]),e=e.split(",")[0].split(":")[1].split(";")[0],r=t.length,n=new Uint8Array(r),i=0;i<r;i++)n[i]=t.charCodeAt(i);return new Blob([n],{type:e||"image/jpeg"})}(a.toDataURL("image/jpeg")),width:e,height:t}}var o=new FileReader,s=new Image,a=document.createElement("canvas");return new Promise(function(t,e){var r=n.blob();r.type.match(/image.*/)?(o.onload=function(e){s.onload=function(){return t(i())},s.src=e.target.result},o.readAsDataURL(r)):e(new Error("이미지 파일 확인 필요"))})},getHtmlEditor(e){for(var t=null,r=d.editorControls.length,n=0;n<r;n++){var i=d.editorControls[n];if(i.id==e){t=i.editor;break}}return t},getHtmlSetting(e){for(var t=null,r=d.editorControls.length,n=0;n<r;n++){var i=d.editorControls[n];if(i.id==e){t=i.setting;break}}return t},setMode(e,t){e=d.getHtmlEditor(e);e&&e.setMode(t)},insertContent(e,t){e=d.getHtmlEditor(e);e&&e.insertContent(t)},execCommand(e,t,r,n,i){var o=!1,e=d.getHtmlEditor(e);return e&&(1==$object.isNullOrUndefined(r)&&(r=!1),o=e.execCommand(t,r,n,i)),o},isDirty(e){var t=!1,e=d.getHtmlEditor(e);return t=e?e.isDirty():t},updateDependencyID(e,t,r){e=d.getHtmlSetting(e);syn.$r.path=e.fileManagerServer+e.fileManagerPath+"/"+e.pageActionHandler,syn.$r.params.action="UpdateDependencyID",syn.$r.params.repositoryID=e.repositoryID,syn.$r.params.sourceDependencyID=e.dependencyID,syn.$r.params.targetDependencyID=t,syn.uicontrols.$fileclient.executeProxy(syn.$r.url(),r)},getDependencyID(e){var t="",e=d.getHtmlSetting(e);return t=e?e.dependencyID:t},setDependencyID(e,t){e=d.getHtmlSetting(e);e&&(e.dependencyID=t)},getValue(e,t){var r="",n=d.getHtmlEditor(e);if(n){var r=n.getContent(),i=d.getHtmlSetting(e);if(0==$string.isNullOrEmpty(i.limitTableWidth)){var o=r.match(/<table[^>]*>(.*?)/gim);if(0==$string.isNullOrEmpty(o))for(var s=0;s<o.length;s++){var a=o[s];-1==a.indexOf("width=")&&(r=r.replace(a,a.substring(0,a.length-1)+' width="{0}">'.format(i.limitTableWidth)))}}0==$string.isNullOrEmpty(i.prefixHtml)&&(r=i.prefixHtml+r),0==$string.isNullOrEmpty(i.suffixHtml)&&(r+=i.suffixHtml)}return r=(r=(r=(r=(r=r.replace(/&amp;/gm,"&")).replace(/\<p\>\<\/p\>/gm,"<p>&nbsp;</p>")).replace(/\<p style="text-align: left;"\>\<\/p\>/gm,'<p style="text-align: left;">&nbsp;</p>')).replace(/\<p style="text-align: center;"\>\<\/p\>/gm,'<p style="text-align: center;">&nbsp;</p>')).replace(/\<p style="text-align: right;"\>\<\/p\>/gm,'<p style="text-align: right;">&nbsp;</p>')},setValue(e,t,r){var n,i=d.getHtmlEditor(e);i?(n=syn.$l.get("{0}_hidden".format(e)).getAttribute("syn-options"),0==$object.isNullOrUndefined(n)&&(n=JSON.parse(n),0==$string.isNullOrEmpty(n.prefixHtml)&&0==$string.isNullOrEmpty(n.prefixHtml)&&1==t.startsWith(n.prefixHtml)&&(t=t.replace(n.prefixHtml,"")),0==$string.isNullOrEmpty(n.suffixHtml))&&0==$string.isNullOrEmpty(n.suffixHtml)&&1==t.endsWith(n.suffixHtml)&&(t=t.replace(n.suffixHtml,"")),i.setContent(t)):syn.$l.get(e).setAttribute("setInitValue",t)},clear(e,t){e=d.getHtmlEditor(e);e&&e.setContent("")},setLocale(e,t,r,n){}}),syn.uicontrols.$htmleditor=d}(globalRoot),!function(window){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var $organization=syn.uicontrols.$organization||new syn.module;$organization.extend({name:"syn.uicontrols.$organization",version:"v2025.3.1",organizationControls:[],eventHooks:["nodedrop","select","click"],defaultSetting:{width:"100%",height:"300px",itemID:"id",parentItemID:"parentID",childrenID:"children",reduceMap:{key:"id",title:"title",parentID:"parentID"},nodeTitle:"name",nodeContent:"title",direction:"t2b",pan:!1,zoom:!1,zoominLimit:2,zoomoutLimit:.8,draggable:!1,className:"top-level",verticalLevel:4,nodeTemplate:null,createNode:null,dataType:"string",belongID:null,getter:!1,setter:!1,controlText:null,validators:null,transactConfig:null,triggerConfig:null},addModuleList:function(e,t,r,n){var i=e.getAttribute("id"),o=e.getAttribute("syn-datafield"),e=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:e,field:o,module:this.name,type:n})},controlLoad:function(elID,setting){var el=syn.$l.get(elID),mod=(setting=syn.$w.argumentsExtend($organization.defaultSetting,setting),window[syn.$w.pageScript]),moduleSettings,hookEvents=(mod&&mod.hook.controlInit&&(moduleSettings=mod.hook.controlInit(elID,setting),setting=syn.$w.argumentsExtend(setting,moduleSettings)),setting.width=el.style.width||setting.width,setting.height=el.style.height||setting.height,el.setAttribute("id",elID+"_hidden"),el.setAttribute("syn-options",JSON.stringify(setting)),el.style.display="none",null!=setting.nodeTemplate&&1==$object.isString(setting.nodeTemplate)&&(setting.nodeTemplate=eval(setting.nodeTemplate)),null!=setting.createNode&&1==$object.isString(setting.createNode)&&(setting.createNode=eval(setting.createNode)),el.getAttribute("syn-events"));try{hookEvents=hookEvents&&eval(hookEvents)}catch(error){syn.$l.eventLog("OrganizationView_controlLoad",error.toString(),"Debug")}for(var parent=el.parentNode,wrapper=document.createElement("div"),orgchart=(wrapper.style.width=setting.width,wrapper.style.height=setting.height,wrapper.className="organization-container",wrapper.innerHTML='<div id="'+elID+'"></div>',parent.appendChild(wrapper),setting.data={},$("#"+elID).orgchart(setting)),i=0;i<hookEvents.length;i++){var hookEvent=hookEvents[i];if(-1<$organization.eventHooks.indexOf(hookEvent)&&1==$object.isNullOrUndefined(setting[hookEvent]))switch(hookEvent){case"nodedrop":setting[hookEvent]=function(e,t){var r=window[syn.$w.pageScript];r&&(r=r.event["{0}_{1}".format(elID,"nodedrop")])&&r.apply(syn.$l.get(elID),[e,t])},orgchart.$chart.on("nodedrop.orgchart",setting[hookEvent]);break;case"select":setting[hookEvent]=function(e){var t,r=window[syn.$w.pageScript];r&&(t=$(this),r=r.event["{0}_{1}".format(elID,"select")])&&r.apply(syn.$l.get(elID),[e,t])},orgchart.$chartContainer.on("click",".node",setting[hookEvent]);break;case"click":setting[hookEvent]=function(e){var t=window[syn.$w.pageScript];t&&(t=t.event["{0}_{1}".format(elID,"click")])&&t.apply(syn.$l.get(elID),[e,$(e.target).closest(".node").length])},orgchart.$chartContainer.on("click",".orgchart",setting[hookEvent])}}$organization.organizationControls.push({id:elID,orgchart:orgchart,config:setting}),setting.bindingID&&syn.uicontrols.$data&&syn.uicontrols.$data.bindingSource(elID,setting.bindingID)},getValue:function(e,t){var r=null,n=$organization.getControl(e).orgchart;if(n){for(var e=$organization.getControl(e).config,i=e.reduceMap,n=n.getHierarchy(),o=syn.$l.nested2Flat(n,e.itemID,e.parentItemID,e.childrenID),s=[],a=o.length,l=0;l<a;l++){var c=o[l],u=c.data;u&&(u[i.key]=c.key,u[i.title]=c.title,u[i.parentID]=c.parentID,s.push(u))}r=s}return r},setValue:function(e,t,r){var n=$organization.getControl(e).orgchart;if(n){for(var e=$organization.getControl(e).config,i=e.reduceMap,o=[],s=t.length,a=0;a<s;a++){var l=t[a];o.push({id:l[i.key],key:l[i.key],title:l[i.title],parentID:l[i.parentID],data:$object.clone(l,!1)})}var c=syn.$l.flat2Nested(o,e.itemID,e.parentItemID,e.childrenID),c=(n.init({data:c}),e.nodedrop);c&&n.$chart.on("nodedrop.orgchart",c)}},clear:function(e,t){e=$organization.getControl(e).orgchart;e&&e.init({data:null})},getControl:function(e){for(var t=null,r=$organization.organizationControls.length,n=0;n<r;n++){var i=$organization.organizationControls[n];if(i.id==e){t=i;break}}return t},init:function(e,t){e=$organization.getControl(e).orgchart;e&&e.init(t)},addParent:function(e,t){var r=$organization.getControl(e).orgchart;r&&r.addParent($("#"+e).find(".node:first"),t)},addSiblings:function(e,t,r){e=$organization.getControl(e).orgchart;e&&t&&e.addSiblings(t,r)},addChildren:function(e,t,r){e=$organization.getControl(e).orgchart;e&&t&&e.addChildren(t,r)},removeNodes:function(e,t){e=$organization.getControl(e).orgchart;e&&t&&e.removeNodes(t)},getHierarchy:function(e,t){var r=null,e=$organization.getControl(e).orgchart;return e&&(1==$object.isNullOrUndefined(t)&&(t=!1),r=e.getHierarchy(t)),r},hideParent:function(e,t){e=$organization.getControl(e).orgchart;e&&t&&e.hideParent(t)},showParent:function(e,t){e=$organization.getControl(e).orgchart;e&&t&&e.showParent(t)},showChildren:function(e,t){e=$organization.getControl(e).orgchart;e&&t&&e.showChildren(t)},hideSiblings:function(e,t,r){e=$organization.getControl(e).orgchart;e&&t&&e.hideSiblings(t,r)},showSiblings:function(e,t,r){e=$organization.getControl(e).orgchart;e&&t&&e.showSiblings(t,r)},getNodeState:function(e,t,r){var n=null,e=$organization.getControl(e).orgchart;return e&&t&&(1==$object.isNullOrUndefined(r)&&(r="children"),n=e.getNodeState(t,r)),n},getRelatedNodes:function(e,t,r){var n=null,e=$organization.getControl(e).orgchart;return e&&t&&(1==$object.isNullOrUndefined(r)&&(r="children"),n=e.getRelatedNodes(t,r)),n},setChartScale:function(e,t,r){e=$organization.getControl(e).orgchart;e&&t&&e.setChartScale(t,r)},export:function(e,t,r){e=$organization.getControl(e).orgchart;e&&(1==$object.isNullOrUndefined(t)&&(t=syn.$l.random()),e.export(t,r))},setLocale:function(e,t,r,n){}}),syn.uicontrols.$organization=$organization}(window),!function(window){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var $tree=syn.uicontrols.$tree||new syn.module;$tree.extend({name:"syn.uicontrols.$tree",version:"v2025.3.1",treeControls:[],eventHooks:["blurTree","focusTree","activate","beforeActivate","beforeExpand","beforeSelect","blur","click","collapse","createNode","dblclick","expand","focus","keydown","keypress"],defaultSetting:{width:"100%",height:"300px",itemID:"id",parentItemID:"parentID",childrenID:"children",reduceMap:{key:"key",title:"title",parentID:"parentID",folder:"folder",icon:!1},toggleEffect:!1,checkbox:!1,extensions:["persist","filter"],persist:{expandLazy:!1,expandOpts:{noAnimation:!1,noEvents:!1},overrideSource:!0,store:"session",types:"active expanded focus selected"},multi:{mode:"sameParent"},filter:{counter:!1,mode:"hide"},source:[],dataType:"string",belongID:null,getter:!1,setter:!1,controlText:null,validators:null,transactConfig:null,triggerConfig:null},addModuleList(e,t,r,n){var i=e.getAttribute("id"),o=e.getAttribute("syn-datafield"),e=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:e,field:o,module:this.name,type:n})},controlLoad(elID,setting){var el=syn.$l.get(elID),mod=($tree.defaultSetting.persist=!1,$tree.defaultSetting.multi=!1,setting=syn.$w.argumentsExtend($tree.defaultSetting,setting),window[syn.$w.pageScript]),moduleSettings,hookEvents=(mod&&mod.hook.controlInit&&(moduleSettings=mod.hook.controlInit(elID,setting),setting=syn.$w.argumentsExtend(setting,moduleSettings)),setting.width=el.style.width||setting.width,setting.height=el.style.height||setting.height,el.setAttribute("id",elID+"_hidden"),el.setAttribute("syn-options",JSON.stringify(setting)),el.style.display="none",el.getAttribute("syn-events"));try{hookEvents=hookEvents&&eval(hookEvents)}catch(error){syn.$l.eventLog("TreeView_controlLoad",error.toString(),"Debug")}for(var i=0;i<hookEvents.length;i++){var hookEvent=hookEvents[i];-1<$tree.eventHooks.indexOf(hookEvent)&&1==$object.isNullOrUndefined(setting[hookEvent])&&(setting[hookEvent]=function(t,e){var r=$tree.eventHooks.find(function(e){return e.toLowerCase()==t.type.replace("fancytree","")}),n=window[syn.$w.pageScript];n&&(n=n.event?n.event["{0}_{1}".format(elID,r)]:null)&&n.apply(syn.$l.get(elID),[t,e])})}var parent=el.parentNode,wrapper=document.createElement("div");wrapper.style.width=setting.width,wrapper.style.height=setting.height,wrapper.className="tree-container border overflow-auto",wrapper.innerHTML='<div id="'+elID+'"></div>',parent.appendChild(wrapper),$tree.treeControls.push({id:elID,element:$("#"+elID).fancytree(setting),tree:$.ui.fancytree.getTree("#"+elID),config:setting}),setting.bindingID&&syn.uicontrols.$data&&syn.uicontrols.$data.bindingSource(elID,setting.bindingID)},getValue(e,t){var r=null,n=$tree.getControl(e).tree;if(n){for(var e=$tree.getControl(e).config,i=e.reduceMap,n=n.toDict(!0),o=syn.$l.nested2Flat(n,e.itemID,e.parentItemID,e.childrenID),s=[],a=o.length,l=0;l<a;l++){var c=o[l],u=c.data;u&&(u[i.key]=c.key,u[i.title]=c.title,u[i.parentID]=c.parentID,u[i.folder]=c.folder,s.push(u))}r=s}return r},setValue(e,t,r){var n=$tree.getControl(e).tree;if(n){for(var e=$tree.getControl(e).config,i=e.reduceMap,o=[],s=t.length,a=0;a<s;a++){var l=t[a];o.push({key:l[i.key],title:l[i.title],parentID:l[i.parentID],folder:$string.toBoolean(l[i.folder]),icon:!1,data:$object.clone(l,!1)})}n.reduceSource=o;e=syn.$l.flat2Nested(o,e.itemID,e.parentItemID,e.childrenID);n.reload([e])}},clear(e,t){e=$tree.getControl(e).tree;e&&e.reload([])},getControl(e){for(var t=null,r=$tree.treeControls.length,n=0;n<r;n++){var i=$tree.treeControls[n];if(i.id==e){t=i;break}}return t},getActiveNode(e){var t=null,e=$tree.getControl(e).tree;return t=e?e.getActiveNode():t},toogleEnabled(e){var t=!1,e=$tree.getControl(e).tree;return e&&(t=!e.options.disabled,e.enable(!t)),t},getRootNodeID(e){var t=null,e=$tree.getControl(e).tree;return t=e?e.rootNode.key.replace("root_",""):t},activateKey(e,t){1!=$object.isNullOrUndefined(t)&&(e=$tree.getControl(e).tree)&&e.activateKey(t)},expendLevel(e,t){1==$object.isNullOrUndefined(t)&&(t=1);e=$tree.getControl(e).tree;e&&e.visit(function(e){e.getLevel()<t&&e.setExpanded(!0)})},collapseLevel(e,t){1==$object.isNullOrUndefined(t)&&(t=1);e=$tree.getControl(e).tree;e&&e.visit(function(e){e.getLevel()<t&&e.setExpanded(!1)})},expandAll(e){e=$tree.getControl(e).tree;e&&e.expandAll()},collapseAll(e){e=$tree.getControl(e).tree;e&&e.expandAll(!1)},getSelectedNodes(e){var t=[],e=$tree.getControl(e).tree;return t=e?e.getSelectedNodes():t},filterNodes(e,t){e=$tree.getControl(e).tree;return e&&e.filterNodes(t,{autoExpand:!0}),[]},filterBranches(e,t){e=$tree.getControl(e).tree;return e&&e.filterBranches(t,{autoExpand:!0,leavesOnly:!0}),[]},clearFilter(e){var t=[],e=$tree.getControl(e).tree;return t=e?e.clearFilter():t},setNodeSelectedAll(e,t){var r;return $tree.getControl(e).tree&&(r=t.isSelected(),t.visit(function(e){e.setSelected(r)})),[]},selectedAll(e,t){e=$tree.getControl(e).tree;return e&&e.visit(function(e){e.setSelected(t)}),[]},setLocale(e,t,r,n){}}),syn.uicontrols.$tree=$tree}(window),!function(window){"use strict";var textEditor,$grid=(window.Handsontable&&(textEditor=Handsontable.editors.TextEditor.prototype.extend(),Handsontable.validators.registerValidator("require",function(e,t){var r=!1,r=1!=$string.isNullOrEmpty(e);return t&&t(r),r}),Handsontable.cellTypes.registerCellType("codehelp",{editor:textEditor,renderer(e,t,r,n,i,o,s){var a,l;if(Handsontable.renderers.TextRenderer.apply(this,arguments),(l=document.createElement("SPAN")).textContent=o,a=document.createElement("BUTTON"),syn.$m.addCssText(a,"height: 21px;;"),syn.$m.addClass(a,"btn w:21px mt:1px float:right"),a.tag=[e,t,r,n,i,o,s],a.innerHTML='<i class="ti ti-search"></i>',Handsontable.dom.addEvent(a,"click",function(e){e.preventDefault();var e=e.currentTarget,t=e.tag[0],r=e.tag[2],n=e.tag[3],i=e.tag[4],e=t.getSettings().columns.filter(function(e){return e.data==i})[0],o=t.rootElement.id,t=syn.$w.argumentsExtend(syn.uicontrols.$codepicker.defaultSetting,e);t.elID=o,t.viewType="grid",syn.uicontrols.$codepicker.find(t,function(e){var t=window[syn.$w.pageScript].hook.frameEvent;t&&t.call(this,"codeReturn",{elID:o,row:r,col:n,columnName:i,result:e})})}),Handsontable.dom.empty(t),t.appendChild(a),t.appendChild(l),s&&s.className)for(var c=s.className.split(" "),u=0;u<c.length;u++){var d=c[u];""!=d&&syn.$m.addClass(t,d)}return t},validator(e,t){t(!0)},allowInvalid:!0}),Handsontable.cellTypes.registerCellType("button",{renderer(r,e,n,i,o,s,t){if(Handsontable.renderers.TextRenderer.apply(this,arguments),0==$string.isNullOrEmpty(s)){var a=r.getSettings().columns[i].columnOptions,l=document.createElement("BUTTON");if(l.classList.add("celltype"),a&&(1==a.clearBorder&&(l.style.border="0px",l.style.backgroundColor="transparent",l.style.textDecoration="underline"),a.color&&(l.style.color=a.color),1==a.bold)&&(l.style.fontWeight="900"),s.indexOf&&-1<s.indexOf("|")){var c=s.split("|"),u=c[0];if(1<u.split(" ").length){var d,h=u.split(" ");for(d in h)l.classList.add(h[d])}else l.classList.add(u);s=c[1]}if(l.tag=[r,e,n,i,o,s,t],l.setAttribute("data",s),l.textContent=a&&1==$string.toBoolean(a.toCurrency)?$string.toCurrency(s):s,syn.$l.addEvent(l,"click",function(e){e.preventDefault();var e=event.target||event.srcElement,t=window[syn.$w.pageScript].event["{0}_cellButtonClick".format(r.rootElement.id)];t&&t.apply(e,[r.rootElement.id,n,i,o,s])}),Handsontable.dom.empty(e),e.appendChild(l),t&&t.className)for(var p=t.className.split(" "),f=0;f<p.length;f++){var g=p[f];""!=g&&syn.$m.addClass(e,g)}}return e},validator(e,t){t(!0)},allowInvalid:!0}),Handsontable.cellTypes.registerCellType("safehtml",{editor:textEditor,renderer(e,t,r,n,i,o,s){var a,l,o=Handsontable.helper.stringify(o);if(a=o,l=((((l="<em><p><br><b><u><strong><a><big><img>")||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join(""),o=a.replace(/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi,"").replace(/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,function(e,t){return-1<l.indexOf("<"+t.toLowerCase()+">")?e:""}),t.innerHTML=o,s&&s.className)for(var c=s.className.split(" "),u=0;u<c.length;u++){var d=c[u];""!=d&&syn.$m.addClass(t,d)}return t},validator(e,t){t(!0)},allowInvalid:!0}),Handsontable.cellTypes.registerCellType("image",{editor:textEditor,renderer(e,t,r,n,i,o,s){var a;if(Handsontable.renderers.TextRenderer.apply(this,arguments),0===Handsontable.helper.stringify(o).indexOf("http")?((a=document.createElement("IMG")).src=o,Handsontable.dom.addEvent(a,"click",function(e){e.preventDefault()}),Handsontable.dom.empty(t),t.appendChild(a)):Handsontable.renderers.TextRenderer.apply(this,arguments),s&&s.className)for(var l=s.className.split(" "),c=0;c<l.length;c++){var u=l[c];""!=u&&syn.$m.addClass(t,u)}return t},validator(e,t){t(!0)},allowInvalid:!0}),Handsontable.cellTypes.registerCellType("radio",{renderer(c,e,u,d,h,t,r){Handsontable.renderers.TextRenderer.apply(this,arguments);var n="rdo_{0}_{1}_{2}".format(c.rootElement.id,u,d),i=document.createElement("INPUT");if(i.id=n,i.type="radio",syn.$m.addClass(i,"form-check-input"),t&&(!0===$string.toBoolean(t)?i.checked=!0:i.checked=!1),Handsontable.dom.addEvent(i,"click",function(e){e.preventDefault();var e=e.target||e.srcElement,t=window[syn.$w.pageScript],r=c.getSettings(),n=r.columns[d].readOnly,i=c.getCellMeta(u,d);if(!1===n&&0==i.readOnly){if(r.data&&0<r.data.length)for(var o,s=r.data,a=s.length,l=0;l<a;l++)1==$string.toBoolean(s[l][h])&&("R"==s[l].Flag&&(s[l].Flag="U"),s[l][h]=0,o=syn.$l.get("rdo_{0}_{1}_{2}".format(c.rootElement.id,l,d)))&&(o.checked=!1);c.setDataAtCell(u,d,!0===e.checked?"1":"0");n=t.event["{0}_cellRadioClick".format(c.rootElement.id)];n&&n.apply(e,[c.rootElement.id,u,d,h,!0===e.checked?"1":"0"]),c.render()}}),Handsontable.dom.empty(e),e.appendChild(i),r&&r.className)for(var o=r.className.split(" "),s=0;s<o.length;s++){var a=o[s];""!=a&&syn.$m.addClass(e,a)}return e},validator(e,t){t(!0)},allowInvalid:!0}),Handsontable.cellTypes.registerCellType("checkbox2",{renderer(i,e,o,s,a,t,r){Handsontable.renderers.TextRenderer.apply(this,arguments);var n="chk_syngrid_{0}_{1}_{2}".format(i.rootElement.id,o,s),l=document.createElement("INPUT");if(l.id=n,l.type="checkbox",syn.$m.addClass(l,"form-check-input"),t&&(!0===$string.toBoolean(t)?l.checked=!0:l.checked=!1),Handsontable.dom.addEvent(l,"click",function(e){e.preventDefault();var e=e.target||e.srcElement,t=window[syn.$w.pageScript],r=i.getSettings().columns[s].readOnly,n=i.getCellMeta(o,s);(0==r||0==n.readOnly)&&(i.setDataAtCell(o,s,!0===e.checked?"1":"0"),r=t.event["{0}_cellCheckboxClick".format(i.rootElement.id)])&&r.apply(e,[i.rootElement.id,o,s,a,!0===e.checked?"1":"0"])}),Handsontable.dom.empty(e),e.appendChild(l),r&&r.className)for(var c=r.className.split(" "),u=0;u<c.length;u++){var d=c[u];""!=d&&syn.$m.addClass(e,d)}return e},validator(e,t){t(!0)},allowInvalid:!0})),syn.uicontrols=syn.uicontrols||new syn.module,syn.uicontrols.$grid||new syn.module);$grid.extend({name:"syn.uicontrols.$grid",version:"v2025.3.25",defaultHotSettings:{licenseKey:"non-commercial-and-evaluation",language:"ko-KR",locale:"ko-KR",imeFastEdit:!0,data:[],colWidths:120,rowHeights:31,rowHeaders:!0,copyPaste:!0,beforePaste(e,t){return!1},autoColumnSize:!1,stretchH:"none",undo:!1,observeChanges:!1,observeDOMVisibility:!0,currentRowClassName:"currentRow",manualColumnResize:!0,manualRowResize:!1,manualColumnMove:!1,manualRowMove:!1,manualColumnFreeze:!1,autoInsertRow:!1,isRemoveRowHidden:!0,autoWrapRow:!0,outsideClickDeselects:!0,selectionMode:"range",sortIndicator:!1,columnSorting:!0,wordWrap:!1,dropdownMenu:!1,filters:!0,isContainFilterHeader:!1,firstShowColIndex:null,lastShowColIndex:null,fillHandle:!1,contextMenu:{items:{copy:{name:"내용복사"},hidden_columns_hide:{name:"컬럼 숨김",callback(e,t,r){if(t&&0<t.length){for(var t=t[0],n=t.start.col,i=t.end.col,o=[];n<=i;n++)o.push(n);$grid.visibleColumns(this.rootElement.id,o,!1);t=window[syn.$w.pageScript];t&&(t=t.event?t.event["{0}_{1}".format(this.rootElement.id,"afterHiddenColumns")]:null)&&t.apply(syn.$l.get(this.rootElement.id),[o])}}},hidden_columns_show:{name:"컬럼 표시",callback(e,t,r){if(t&&0<t.length){for(var t=t[0],n=t.start.col,i=t.end.col,o=[];n<=i;n++)o.push(n);$grid.visibleColumns(this.rootElement.id,o,!0);t=window[syn.$w.pageScript];t&&(t=t.event?t.event["{0}_{1}".format(this.rootElement.id,"afterUnHiddenColumns")]:null)&&t.apply(syn.$l.get(this.rootElement.id),o)}}},columns_chooser:{name:"컬럼 표시 선택",callback(e,t,r){for(var s=this.rootElement.id,n=$object.clone(syn.$w.dialogOptions),i=(n.minWidth=240,n.minHeight=240,syn.$l.get("columnChooserHtml")),o=(i||((a=syn.$m.create({tag:"div",id:"columnChooserHtml"})).style.display="none",a.innerHTML='<h3 class="mt-0 mb-0">컬럼 표시 선택</h3><div class="btn-area"><input type="button" id="btnColumnApply" class="btn btn-primary" value="컬럼 표시 적용"></div><ul class="row" id="lstChooseColumns" style = "overflow: auto; height: 150px; width:360px; padding-top:10px; padding-left:10px;" > <li><input type="checkbox" id="a"><label for="a">컬럼명</label></li></ul>',document.body.appendChild(a),i=syn.$l.get("columnChooserHtml")),Handsontable.dom.addEvent(i.querySelector("#btnColumnApply"),"click",function(){for(var e=[],t=syn.$l.get("lstChooseColumns").children,r=0;r<t.length;r++){var n=t[r],i=n.children[0].id.split("_")[2],n=!n.children[0].checked;e.push({col:r,colID:i,isHidden:n})}syn.$w.closeDialog(e)}),i.querySelector("ul")),a=(o.innerHTML="",this.getSettings()),l=this.getSettings().colHeaders,c=a.columns,u=1;u<c.length;u++){var d=l[u],h=c[u],p=(document.createElement("li"),syn.$m.create({tag:"li",className:"col-12"})),f=(syn.$m.setStyle(p,"padding-top","10px"),"{0}_checkbox_{1}".format(s,h.data)),g=$grid.isColumnHidden(s,u),m=syn.$m.create({tag:"input",id:f,attributes:{type:"checkbox"}}),g=(m.checked=!g,syn.$m.create({tag:"label",id:"{0}_label_{1}".format(s,h.data),attributes:{for:f}}));syn.$m.setStyle(g,"padding-left","10px"),g.textContent=d,syn.$m.appendChild(p,m),syn.$m.appendChild(p,g),syn.$m.appendChild(o,p)}syn.$w.showDialog(syn.$l.get("columnChooserHtml"),n,function(e){if(e){for(var t=[],r=[],n=1;n<c.length;n++){var i=e[n-1];i&&(0==i.isHidden?t:r).push(n)}$grid.visibleColumns(s,t,!0),$grid.visibleColumns(s,r,!1);var o=window[syn.$w.pageScript];o&&(o=o.event?o.event["{0}_{1}".format(s,"afterVisibleColumns")]:null)&&o.apply(syn.$l.get(s),t,r)}})}}}},hiddenColumns:{columns:[0],indicators:!1},deleteKeyColumns:[],keyLockedColumns:[],summarys:[],exportColumns:[],transactConfig:null,triggerConfig:null},gridControls:[],handsontableHooks:null,gridHooks:[],gridCodeDatas:[],addModuleList(e,t,r,n){var i=e.getAttribute("id"),o=e.getAttribute("syn-datafield"),e=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:e,field:o,module:this.name,type:n})},controlLoad(elID,setting){for(var el=syn.$l.get(elID),moduleHotSettings,mod=(setting=syn.$w.argumentsExtend($grid.defaultHotSettings,setting),setting.columns&&(moduleHotSettings=$grid.getInitializeColumns(setting,elID),setting=syn.$w.argumentsExtend(setting,moduleHotSettings)),window[syn.$w.pageScript]),moduleHotSettings,isFlagColumn=(mod&&mod.hook.controlInit&&(moduleHotSettings=mod.hook.controlInit(elID,setting),setting=syn.$w.argumentsExtend(setting,moduleHotSettings)),setting.elementID=elID,setting.colHeaders=setting.colHeaders||["Flag","A","B","C"],-1==setting.colHeaders.indexOf("Flag")&&(setting.colHeaders.unshift("Flag"),setting.colWidths.unshift(10)),setting.columns=setting.columns||[{data:0},{data:1},{data:2},{data:3}],!1),columnCount=setting.columns.length,i=0;i<columnCount;i++){var column=setting.columns[i];if("Flag"==column.data){isFlagColumn=!0;break}}0==isFlagColumn&&setting.columns.unshift({data:"Flag",type:"text",readOnly:!0}),!0===setting.dropdownMenu?setting.dropdownMenu=["filter_by_condition","filter_operators","filter_by_condition2","filter_action_bar"]:setting.dropdownMenu=!1;var debounceFn=Handsontable.helper.debounce(function(e,t){var r=t.target||t.srcElement;e=$grid.getActiveColIndex(r.gridID);r=$grid.getGridControl(r.gridID).getPlugin("filters");0==r.isEnabled()&&r.enablePlugin(),r.clearConditions(e),0<t.target.value.length&&r.addCondition(e,"contains",[t.target.value]),r.filter()},100),isSummary=!1,parent=(setting.summarys&&0<setting.summarys.length?(isSummary=!0,setting.fixedRowsBottom=1,setting.cells=function(e,t,r){var n=this.instance;if(1==$grid.getGridValue(n.elID).applyCells){var i=n.getSettings();if(i.summarys&&0<i.summarys.length)if(e===i.data.length-1)return o={type:"text",readOnly:!0,className:"summaryRow"},(i=i.columns.find(function(e){return e.data==r}))&&i.className&&-1==i.className.indexOf(o.className)&&(o.className+=" "+i.className),o}i=window[syn.$w.pageScript];if(i){var o,i=i.event["{0}_applyCells".format(n.elID)];if(i)if(o=i.apply(n,[n.elID,e,t,r]))return o}}):setting.cells=function(e,t,r){var n=window[syn.$w.pageScript];if(n){var i=this.instance,n=n.event["{0}_applyCells".format(i.elID)];if(n){n=n.apply(i,[i.elID,e,t,r]);if(n)return n}}},setting.beforeColumnSort=function(e,t){var r,n=this.getSettings();n.summarys&&0<n.summarys.length&&($grid.getGridValue(this.elID).applyCells=!1,r=(n=this.getSettings()).data.find(function(e){return"S"==e.Flag}))&&-1<(r=n.data.indexOf(r))&&n.data.splice(r,1)},setting.afterColumnSort=function(e,t){var r=this.getSettings();r.summarys&&0<r.summarys.length&&$grid.renderSummary(this)},setting.afterGetColHeader=function(u,e){if("number"!=typeof u)return u;0<=u&&1==setting.isContainFilterHeader&&e.childElementCount<2&&(t=document.createElement("div"),d=document.createElement("input"),t.className="filterHeader",d.gridID=elID,Handsontable.dom.addEvent(d,"contextmenu",function(e){return Handsontable.dom.stopImmediatePropagation(e),e.preventDefault&&e.preventDefault(),!1}),Handsontable.dom.addEvent(d,"keydown",function(e){debounceFn(u,e)}),Handsontable.dom.addEvent(d,"focus",function(e){var t=window[syn.$w.pageScript];t&&(t.prop.focusControl=syn.$l.get(d.gridID))}),t.appendChild(d),e.appendChild(t));var d,t=1==$object.isArray(setting.dropdownMenu)?3:2,h=setting.columns[u];h&&!0===h.isSelectAll&&(t+=2),0<=u&&h&&("checkbox"==h.type||"checkbox2"==h.type)&&!0===h.isSelectAll&&e.firstElementChild.childElementCount<t?3!=e.firstElementChild.childElementCount&&0==syn.$m.hasClass(e,"hiddenHeader")&&(t="chk_syngrid_All_{0}_{1}".format(elID,u),null!=syn.$l.get(t)&&(syn.$m.remove(syn.$l.get(t)),syn.$m.remove(syn.$l.querySelector('label[for="'+t+'"]'))),(d=document.createElement("input")).id=t,d.type="checkbox",d.setAttribute("columnSelectAll","1"),d.gridID=elID,d.checked=1==h.toogleChecked,syn.$m.addClass(d,"form-check-input"),Handsontable.dom.addEvent(d,"click",function(e){var t=e.target||e.srcElement,r=t.checked?"1":"0";h.toogleChecked=r;var n=window[syn.$w.pageScript].event["{0}_selectAllCheck".format(d.gridID)];if(n)n.apply(t,[d.gridID,u,$string.toBoolean(h.toogleChecked.toString())]),(i=$grid.getGridControl(t.gridID)).render();else{var i=$grid.getGridControl(t.gridID),n=$grid.getSettings(t.gridID);if(n.data&&0<n.data.length)for(var o=n.data,s=o.length,a=i.colToProp(u),l=0;l<s;l++){var c=o[l].Flag;"R"==c&&(o[l].Flag="U"),"S"!=c&&(o[l][a]=r)}i.render()}e.stopImmediatePropagation()}),syn.$m.prepend(d,e.firstElementChild)):(t=e.querySelector('input[type="checkbox"]'),0<=u&&h&&("checkbox"==h.type||"checkbox2"==h.type)&&null!=t&&(e.firstElementChild.removeChild(t),t=e.querySelector("label[for]"),e.firstElementChild.removeChild(t)))},1==setting.isContainFilterHeader&&(setting.className="contain-filter-header"),setting.width=setting.width||"100%",setting.height=setting.height||240,el.setAttribute("id",el.id+"_hidden"),el.setAttribute("syn-options",JSON.stringify(setting)),el.style.display="none",el.parentNode),wrapper=document.createElement("div"),fileEL=(1==isSummary&&syn.$m.addClass(wrapper,"summaryRow"),wrapper.id=elID,parent.appendChild(wrapper),document.createElement("input")),gridHookEvents=(fileEL.id="{0}_ImportFile".format(elID),fileEL.type="file",fileEL.style.display="none",fileEL.accept=".csv, .xls, .xlsx",Handsontable.dom.addEvent(fileEL,"change",$grid.importFileLoad),parent.appendChild(fileEL),el=syn.$l.get(elID),$grid.handsontableHooks||($grid.handsontableHooks=Handsontable.hooks.getRegistered()),$grid.gridHooks=["afterChange","afterCreateRow","afterRemoveRow","beforeOnCellMouseDown","afterSelectionEnd","beforeKeyDown"],syn.$l.get(el.id+"_hidden").getAttribute("syn-events"));try{gridHookEvents=gridHookEvents&&eval(gridHookEvents)}catch(error){syn.$l.eventLog("WebGrid_controlLoad",error.toString(),"Debug")}if(gridHookEvents)for(var i=0;i<gridHookEvents.length;i++){var hook=gridHookEvents[i];-1==$grid.gridHooks.indexOf(hook)&&$grid.gridHooks.push(hook)}$grid.gridHooks.forEach(function(hook){setting[hook]=function(){var elID=this.rootElement.id,$grid=syn.uicontrols.$grid,mod=window[syn.$w.pageScript],hot=$grid.getGridControl(elID);if(null!=hot){var defaultGridHooks=["afterChange","afterCreateRow","afterRemoveRow","beforeOnCellMouseDown","afterSelectionEnd","beforeKeyDown"],gridValue=$grid.getGridValue(elID),eventHandler,rowIndex,method_index,method_amount,method_rows,event,coords,td,gridValue,now,gridValue;if(-1==defaultGridHooks.indexOf(hook))1!=gridValue.passSelectCellEvent&&mod&&(eventHandler=mod.event?mod.event["{0}_{1}".format(elID,hook)]:null,eventHandler)&&eventHandler.apply(syn.$l.get(elID),arguments);else if(!gridValue||"afterChange"!=hook||"insertRow"!=gridValue.eventName&&"removeRow"!=gridValue.eventName){if("beforeKeyDown"==hook){var evt=arguments[0],selected,currentRow,currentCol,firstCol,lastCol,lastRow,selected,currentRow,currentCol,firstCol,lastCol,lastRow;1==evt.altKey&&13==evt.keyCode?Handsontable.dom.stopImmediatePropagation(evt):1==evt.shiftKey&&9==evt.keyCode?(selected=hot.getSelected()[0],currentRow=selected[0],currentCol=selected[1],firstCol=$grid.getFirstShowColIndex(elID),lastCol=$grid.getLastShowColIndex(elID),0<currentRow&&currentCol==firstCol?(Handsontable.dom.stopImmediatePropagation(evt),evt.preventDefault&&evt.preventDefault(),hot.selectCell(currentRow-1,lastCol)):0==currentRow&&currentCol==firstCol&&(Handsontable.dom.stopImmediatePropagation(evt),evt.preventDefault&&evt.preventDefault(),lastRow=hot.countRows()-1,-1<lastRow)&&hot.selectCell(lastRow,lastCol)):9==evt.keyCode&&(selected=hot.getSelected()[0],currentRow=selected[0],currentCol=selected[1],firstCol=$grid.getFirstShowColIndex(elID),lastCol=$grid.getLastShowColIndex(elID),lastRow=hot.countRows()-1,currentRow<lastRow&&currentCol==lastCol?(Handsontable.dom.stopImmediatePropagation(evt),evt.preventDefault&&evt.preventDefault(),hot.selectCell(currentRow+1,firstCol)):currentRow==lastRow&&currentCol==lastCol&&(Handsontable.dom.stopImmediatePropagation(evt),evt.preventDefault&&evt.preventDefault(),1==setting.autoInsertRow?($grid.insertRow(elID,{amount:1},function(e){hot.selectCell(e,firstCol)}),Handsontable.dom.stopImmediatePropagation(evt),evt.preventDefault&&evt.preventDefault()):hot.selectCell(0,firstCol)))}else if("afterChange"==hook||"afterCreateRow"==hook||"afterRemoveRow"==hook||"hiddenRow"==hook){if("afterChange"==hook&&"loadData"==arguments[1])return;if("afterChange"==hook&&"edit"==arguments[1]&&"Flag"==arguments[0][0][1])return;if("afterCreateRow"==hook)var method_index=arguments[0],method_amount=arguments[1],method_source=arguments[2],rowIndex=method_index;else if("afterChange"==hook){var method_changes=arguments[0],method_source=arguments[1];if(1==$object.isNullOrUndefined(method_changes))return;rowIndex=method_changes[0][0];var columnName=method_changes[0][1],changeValue=method_changes[0][3],columnInfos=hot.getSettings().columns,columnInfo=columnInfos.filter(function(e){return e.data==columnName})[0],oldValue;if("dropdown"==columnInfo.type){var dataSource=columnInfo.dataSource;if(dataSource)if(0==columnInfo.required&&""==changeValue)method_changes[0][4]="",hot.setDataAtCell(rowIndex,hot.propToCol(columnInfo.codeColumnID),"");else for(var j=0;j<dataSource.DataSource.length;j++){var item=dataSource.DataSource[j];if(item[dataSource.ValueColumnID]==changeValue){var code=item[dataSource.CodeColumnID];method_changes[0][4]=code,hot.setDataAtCell(rowIndex,hot.propToCol(columnInfo.codeColumnID),code);break}}}else{"codehelp"==columnInfo.type&&(oldValue=method_changes[0][2],""==changeValue?(method_changes[0][4]="",hot.setDataAtCell(rowIndex,hot.propToCol(columnInfo.codeColumnID),"")):oldValue!=changeValue&&hot.setDataAtCell(rowIndex,hot.propToCol(columnInfo.codeColumnID),""))}}else{"afterRemoveRow"==hook?(method_index=arguments[0],method_amount=arguments[1],rowIndex=method_index):"hiddenRow"==hook&&(method_rows=arguments[0],rowIndex=method_rows[0])}if(!rowIndex&&0!=rowIndex)return;var physicalRowIndex=hot.toPhysicalRow(rowIndex),rowData=hot.getSourceDataAtRow(physicalRowIndex),rowFlag=rowData&&rowData.Flag?rowData.Flag:"C",cellRowFlag;"afterCreateRow"==hook?rowFlag="C":"afterChange"==hook?"R"==rowFlag&&method_changes[0][2]!=method_changes[0][3]&&(rowFlag="U"):"hiddenRow"!=hook||"R"!=rowFlag&&"U"!=rowFlag||(rowFlag="D"),"afterRemoveRow"!=hook&&(cellRowFlag=hot.getDataAtCell(rowIndex,0),cellRowFlag!=rowFlag)&&hot.setDataAtCell(rowIndex,0,rowFlag)}else{"beforeOnCellMouseDown"==hook&&(event=arguments[0],coords=arguments[1],td=arguments[2],-1===coords.row&&"INPUT"===event.target.nodeName&&(event.stopImmediatePropagation(),this.deselectCell()),-1==coords.row&&(gridValue=$grid.getGridValue(elID),gridValue.colHeaderClick=!0,gridValue.previousRow=coords.row,gridValue.previousCol=coords.col),now=(new Date).getTime(),td.lastClick&&now-td.lastClick<200?hook="afterOnCellDoubleClick":td.lastClick=now)}if(mod){var el=syn.$l.get(elID),elHidden=syn.$l.get(elID+"_hidden"),gridHookEvents=elHidden.getAttribute("syn-events"),eventHandler;try{gridHookEvents=gridHookEvents&&eval(gridHookEvents)}catch(error){syn.$l.eventLog("WebGrid_gridHookEvents",error.toString(),"Debug")}gridHookEvents&&-1<gridHookEvents.indexOf(hook)&&1!=gridValue.passSelectCellEvent&&mod&&(eventHandler=mod.event?mod.event["{0}_{1}".format(elID,hook)]:null,eventHandler)&&eventHandler.apply(el,arguments)}"afterOnCellDoubleClick"==hook&&(hook="beforeOnCellMouseDown"),"afterSelectionEnd"==hook&&(gridValue=$grid.getGridValue(elID),gridValue.colHeaderClick=!1,gridValue.previousRow=arguments[0],gridValue.previousCol=arguments[1],mod)&&(mod.prop.focusControl=syn.$l.get(elID))}else gridValue.eventName}}});var controlSetting=$object.clone(setting),wtHolder=($grid.gridControls.push({id:elID,hot:new Handsontable(el,controlSetting),setting:controlSetting,value:{eventName:"",colHeaderClick:!1,applyCells:!1,previousRow:-1,previousCol:-1}}),syn.$l.get(elID).querySelector(".wtHolder"));if(wtHolder.gridID=elID,Handsontable.dom.addEvent(wtHolder,"click",function(e){var t=window[syn.$w.pageScript];t&&(t.prop.focusControl=syn.$l.get(wtHolder.gridID))}),0<$grid.gridCodeDatas.length)for(var length=$grid.gridCodeDatas.length,i=0;i<length;i++){syn.$w.addReadyCount();var codeData=$grid.gridCodeDatas[i];$grid.dataRefresh(codeData.elID,codeData.type)}setting.bindingID&&syn.uicontrols.$data&&syn.uicontrols.$data.bindingSource(elID,setting.bindingID),1==$object.isNullOrUndefined($grid.remainingReadyIntervalID)&&($grid.remainingReadyIntervalID=setInterval(function(){if(1==syn.$w.isPageLoad){clearInterval($grid.remainingReadyIntervalID),$grid.remainingReadyIntervalID=null;for(var e=0,t=$grid.gridControls.length;e<t;e++)$grid.gridControls[e].hot.render()}},25))},dataRefresh(d,t,r){var n,e,h,p,i,f,o,s;(t=t||{}).elID=d,t.storeSourceID=t.storeSourceID||t.dataSourceID,(t=syn.$w.argumentsExtend({columnName:null,codeColumnID:null,required:!0,local:!0,dataSourceID:null,storeSourceID:null,dataSource:null,parameters:null,selectedValue:null},t)).columnName&&t.storeSourceID&&((n=window[syn.$w.pageScript]).config&&n.config.dataSource&&n.config.dataSource[t.storeSourceID]&&delete n.config.dataSource[t.storeSourceID],n&&n.hook.controlInit&&(e=n.hook.controlInit(d,t),t=syn.$w.argumentsExtend(t,e)),e=null,n.config&&n.config.dataSource&&n.config.dataSource[t.dataSourceID]&&(e=n.config.dataSource[t.dataSourceID]),h=$grid.getGridControl(d),i=(p=h.getSettings()).columns,f=h.propToCol(t.columnName),"dropdown"==(o=i[f]).type)&&(s=function(e,t,r){e.dataSource=t,e.storeSourceID=r.storeSourceID,e.local=r.local,e.required=r.required,e.codeColumnID=r.codeColumnID||e.codeColumnID;var n=[];0==e.required&&n.push("");for(var i=0;i<t.DataSource.length;i++){var o=t.DataSource[i];n.push(o[t.ValueColumnID])}if(e.source=n,e.visibleRows=10,e.trimDropdown=!0,e.trimWhitespace=!0,e.wordWrap=!1,e.allowInvalid=!1,$grid.updateSettings(r.elID,p),r.selectedValue){var s=$grid.getActiveRowIndex(d);if(-1<s){for(var a=h.propToCol(e.codeColumnID),l="",c=e.dataSource.DataSource.length,u=0;u<c;u++)if((o=e.dataSource.DataSource[u]).CodeID==r.selectedValue){l=o.CodeValue;break}a=[[s,a,r.selectedValue],[s,f,l]];h.setDataAtCell(a)}}},e?(s(o,e,t),r&&r(),syn.$w.removeReadyCount()):1==t.local?syn.$w.loadJson(syn.Config.SharedAssetUrl+"code/{0}.json".format(t.storeSourceID),t,function(e,t){t&&(n.config.dataSource[e.storeSourceID]=t,s(o,t,e),r)&&r(),syn.$w.removeReadyCount()},!1):syn.$w.getDataSource(t.dataSourceID,t.parameters,function(e){e&&(n.config.dataSource[t.storeSourceID]=e,s(o,e,t),r)&&r(),syn.$w.removeReadyCount()}))},getInitializeColumns(e,t){for(var r=e.columns,n={colHeaders:[],columns:[],colWidths:[],hiddenColumns:{columns:[0],indicators:!1}},i=r.length,o=0;o<i;o++){var s=r[o],a=s[0],l=s[1],c=s[2],u=s[3],d=s[4],h=s[5],p=s[6],f=s[7],g=s[8],m=s[9],y={data:a,type:"text",filter:!0,isHidden:u,readOnly:1==$string.toBoolean(e.readOnly)||$string.toBoolean(h),className:1==$object.isNullOrUndefined(p)?"":"ht"+$string.capitalize(p),belongID:1==$object.isNullOrUndefined(f)?"":f,validators:null},v=(8<s.length&&g&&(y.validators=g,-1<y.validators.indexOf("require"))&&(y.className=y.className+" required"),9<s.length&&m&&(u=m,0==$string.isNullOrEmpty(u.placeholder)&&(y.placeholder=u.placeholder),1!=u.sorting&&(y.columnSorting={indicator:!1,headerAction:!1,compareFunctionFactorycompareFunctionFactory(){return function(){return 0}}}),"checkbox"!=y.type&&"checkbox2"!=y.type||1!=u.isRadioTheme||(y.className=y.className+" required"),y.columnOptions=u),10!=s.length&&0==e.columnSorting&&(y.columnSorting={indicator:!1,headerAction:!1,compareFunctionFactorycompareFunctionFactory(){return function(){return 0}}}),null),h=d;if(1==$object.isString(h)?(y.type=h,"dropdown"==y.type||"codehelp"==y.type?syn.$l.eventLog("getInitializeColumns",'"{0}" 컬럼 타입은 객체로 선언 필요'.format(h),"Warning"):"checkbox"==y.type||"checkbox2"==y.type?(y.isSelectAll=!1,y.checkedTemplate="1",y.uncheckedTemplate="0",y.allowInvalid=!1):"numeric"!=y.type&&"date"!=y.type&&"time"!=y.type&&"autocomplete"!=y.type||(y.allowInvalid=!1,"numeric"==y.type?h.numericFormat?y.numericFormat=h.numericFormat:0!=h.numericFormat&&(y.numericFormat={pattern:"0,00",culture:"ko-KR"}):"date"==y.type?(y.dateFormat=h.timeFormat,y.correctFormat=h.correctFormat,y.defaultDate=h.defaultDate,y.datePickerConfig=h.datePickerConfig):"time"==y.type&&(y.timeFormat=h.timeFormat,y.correctFormat=h.correctFormat))):(y.type=h.columnType,"dropdown"==y.type||"codehelp"==y.type?(p=h.storeSourceID||h.dataSourceID)&&(g=window[syn.$w.pageScript]).config&&g.config.dataSource&&g.config.dataSource[p]&&(v=g.config.dataSource[p]):"checkbox"==y.type||"checkbox2"==y.type?(y.isSelectAll=0==$object.isNullOrUndefined(h.isSelectAll)&&!0===h.isSelectAll,y.checkedTemplate=0==$object.isNullOrUndefined(h.checkedTemplate)?h.checkedTemplate:"1",y.uncheckedTemplate=0==$object.isNullOrUndefined(h.uncheckedTemplate)?h.uncheckedTemplate:"1",y.allowInvalid=0==$object.isNullOrUndefined(h.allowInvalid)&&!0===h.allowInvalid):"numeric"!=y.type&&"date"!=y.type&&"time"!=y.type&&"autocomplete"!=y.type||(y.allowInvalid=!1,"numeric"==y.type?h.numericFormat?y.numericFormat=h.numericFormat:0!=h.numericFormat&&(y.numericFormat={pattern:"0,00",culture:"ko-KR"}):"date"==y.type?(y.dateFormat=h.timeFormat,y.correctFormat=h.correctFormat,y.defaultDate=h.defaultDate,y.datePickerConfig=h.datePickerConfig):"time"==y.type&&(y.timeFormat=h.timeFormat,y.correctFormat=h.correctFormat))),"dropdown"==y.type){var b=[];if(v)for(var w=0;w<v.DataSource.length;w++){var C=v.DataSource[w];b.push(C[v.ValueColumnID])}else t&&(h.columnName=a,!0===h.local?$grid.dataRefresh(t,h):$grid.gridCodeDatas.push({elID:t,type:h}));y.dataSource=v,y.dataSourceID=h.dataSourceID,y.storeSourceID=h.storeSourceID||h.dataSourceID,y.local=!0===h.local,y.codeBelongID=h.codeBelongID,y.codeColumnID=h.codeColumnID,y.codeColumnType=h.codeColumnType||"text",y.codeColumnHidden=null==h.codeColumnHidden||h.codeColumnHidden,y.source=b,y.strict=!0,y.visibleRows=1==$object.isNullOrUndefined(b)?0:b.length+1,y.trimDropdown=!0,y.trimWhitespace=!0,y.wordWrap=!1,y.allowInvalid=!1}else"codehelp"==y.type?(y.dataSource=v,y.dataSourceID=h.dataSourceID,y.storeSourceID=h.storeSourceID||h.dataSourceID,y.local=h.local,y.controlText=h.controlText,y.codeColumnID=h.codeColumnID||a,y.textColumnID=h.textColumnID||a,y.parameters=h.parameters||""):"date"==y.type&&(y.dateFormat=h.dateFormat||"YYYY-MM-DD",y.correctFormat=!0,y.datePickerConfig={format:y.dateFormat,ariaLabel:"날짜를 선택 하세요",i18n:{previousMonth:"이전 달",nextMonth:"다음 달",months:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],weekdays:["일요일","월요일","화요일","수요일","목요일","금요일","토요일"],weekdaysShort:["일","월","화","수","목","금","토"]},showWeekNumber:!1,showMonthAfterYear:!0,yearSuffix:"년",firstDay:0,numberOfMonths:1});"dropdown"==y.type&&(m={data:y.codeColumnID,type:y.codeColumnType,filter:!0,readOnly:!0,className:"htLeft",belongID:y.codeBelongID||$object.clone(f)},1==y.codeColumnHidden?(n.colHeaders.push(l+"_$HIDDEN"),y.columnText=l+"_$HIDDEN"):(n.colHeaders.push(l+"_코드"),y.columnText=l+"_코드"),n.columns.push(m),n.colWidths.push(c)),n.colHeaders.push(l),y.columnText=l,n.columns.push(y),n.colWidths.push(c)}for(var E=n.colHeaders.length,o=0;o<E;o++)-1<n.colHeaders[o].indexOf("_$HIDDEN")&&n.hiddenColumns.columns.push(o+1);for(o=0;o<E;o++)1==(y=n.columns[o]).isHidden&&n.hiddenColumns.columns.push(o+1);return n},merge(e,t,r,n,i){var e=$grid.getGridControl(e);e&&(0==(e=e.getPlugin("mergeCells")).isEnabled()&&e.enablePlugin(),e.merge(t,r,n,i))},unmerge(e,t,r,n,i){var e=$grid.getGridControl(e);e&&(0==(e=e.getPlugin("mergeCells")).isEnabled()&&e.enablePlugin(),e.unmerge(t,r,n,i))},addCondition(e,t,r,n){var i,e=$grid.getGridControl(e);e&&(0==(i=e.getPlugin("filters")).isEnabled()&&i.enablePlugin(),1==$object.isString(t)&&(t=e.propToCol(t)),1==$object.isString(n)&&(n=[n]),i.addCondition(t,r,n),i.filter())},removeCondition(e,t){var r,e=$grid.getGridControl(e);e&&(0==(r=e.getPlugin("filters")).isEnabled()&&r.enablePlugin(),1==$object.isString(t)&&(t=e.propToCol(t)),r.removeConditions(t),r.filter())},clearConditions(e){var e=$grid.getGridControl(e);e&&(0==(e=e.getPlugin("filters")).isEnabled()&&e.enablePlugin(),e.clearConditions(),e.filter())},countRows(e,t){var r,n=0,e=$grid.getGridControl(e);return e&&(!(r=0)===t&&(0==(t=e.getPlugin("hiddenRows")).isEnabled()&&t.enablePlugin(),r=t?t.getHiddenRows().length:0),n=e.countSourceRows()-r),n},countRenderedRows(e){var t=-1,e=$grid.getGridControl(e);return t=e?e.countRenderedRows():t},countRenderedCols(e){var t=-1,e=$grid.getGridControl(e);return t=e?e.countRenderedCols():t},render(e){e=$grid.getGridControl(e);e&&e.render()},insertRow(e,t,r){var n=$grid.getGridControl(e),i=(t=syn.$w.argumentsExtend({index:n.countRows(),amount:1},t),n.alter("insert_row_below",t.index,t.amount),n.render(),n.suspendRender(),$grid.getGridValue(e)),o=(i.eventName="insertRow",t&&t.index?t.index:0),s=t&&t.amount?t.amount:1,a=n.getSettings();if(a){for(var l=[],c=a.columns,u=c.length,d=0;d<u;d++){var h=c[d];if(0<=d&&("checkbox"==h.type||"checkbox2"==h.type)){var p=!1;if(null==h.uncheckedTemplate&&null==h.uncheckedTemplate||(p=h.uncheckedTemplate),1==s)l.push([o,d,p]);else if(1<s)for(var f=0;f<s;f++){var g=o+f;l.push([g,d,p])}}}0<l.length&&n.setDataAtCell(l)}var m=syn.$w.getTriggerOptions(e);if(m){if(m.focusColumnID&&(t.focusColumnID=m.focusColumnID),m.sourceValueID&&m.targetColumnID){a=window[syn.$w.pageScript];if(a){var y=a.context.synControls;if(y&&0<y.length)if(1==$object.isString(m.sourceValueID)&&1==$object.isString(m.targetColumnID)){var v=(R=m.sourceValueID.split("@"))[0],b=R[1],w=y.filter(function(e){return e.field==v});if(1==w.length)if("grid"==(A=w[0]).type){var C=n.propToCol(m.targetColumnID),E=A.id,T=$grid.getActiveRowIndex(E),S=$grid.propToCol(E,b),_=$grid.getDataAtCell(E,T,S);if(1==s)n.setDataAtCell(o,C,_);else if(1<s)for(f=0;f<s;f++){g=o+f;n.setDataAtCell(g,C,_)}}else{var d=n.propToCol(m.targetColumnID),x=syn.$l.querySelector('[syn-datafield="{0}"] #{1}'.format(v,b));if(0==$object.isNullOrUndefined(x))if(1==s)n.setDataAtCell(o,d,x.value);else if(1<s)for(f=0;f<s;f++){g=o+f;n.setDataAtCell(g,d,x.value)}}else syn.$l.eventLog("insertRow","{0} 컬럼 ID 중복 또는 존재여부 확인 필요".format(v),"Debug")}else if(1==$object.isArray(m.sourceValueID)&&1==$object.isArray(m.targetColumnID))for(u=m.sourceValueID.length,f=0;f<u;f++){var R,A,v=(R=m.sourceValueID[f].split("@"))[0],b=R[1],w=y.filter(function(e){return e.field==v});if(1==w.length)if("grid"==(A=w[0]).type){C=n.propToCol(m.targetColumnID[f]),E=A.id,T=$grid.getActiveRowIndex(E),S=$grid.propToCol(E,b),_=$grid.getDataAtCell(E,T,S);if(1==s)n.setDataAtCell(o,C,_);else if(1<s)for(f=0;f<s;f++){g=o+f;n.setDataAtCell(g,C,_)}}else{d=n.propToCol(m.targetColumnID[f]),x=syn.$l.querySelector('[syn-datafield="{0}"] #{1}'.format(v,b));if(0==$object.isNullOrUndefined(x))if(1==s)n.setDataAtCell(o,d,x.value);else if(1<s)for(f=0;f<s;f++){g=o+f;n.setDataAtCell(g,d,x.value)}}else syn.$l.eventLog("insertRow","{0} 컬럼 ID 중복 또는 존재여부 확인 필요".format(v),"Debug")}}}}else{var N=[];if(1==s)for(var O in t.values){d=$grid.propToCol(e,O);1==$object.isNumber(d)&&N.push([o,d,t.values[O]])}else if(1<s)for(f=0;f<s;f++){g=o+f;for(O in t.values){d=$grid.propToCol(e,O);1==$object.isNumber(d)&&N.push([g,d,t.values[O]])}}$grid.setDataAtRow(e,N)}n.resumeRender(),r&&r(o,s),t.focusColumnID&&(d=n.propToCol(t.focusColumnID),n.selectCell(o+(s-1),d)),i.eventName=""},removeRow(e,t,r,n){var i=$grid.getGridControl(e);if(i&&(i.suspendRender(),1==$object.isNullOrUndefined(r)&&((s=i.getSelected())?r=s[0][0]:(r=$grid.getActiveRowIndex(e))&&-1<r&&((o=$grid.getGridValue(e)).colHeaderClick=!1,o.previousRow=-1,o.previousCol=-1)),1==$object.isNullOrUndefined(r)&&(r=$grid.countRows(e,!0)-1),1!=$grid.isRowHidden(e,r))){if(-1<r){(o=$grid.getGridValue(e)).eventName="removeRow";var o,s=i.toPhysicalRow(r),s=i.getSourceDataAtRow(s),s=s&&s.Flag?s.Flag:"C";if("D"==s){i.setDataAtCell(r,0,s="U");for(var a=0;a<i.countCols();a++){var l=(l=i.getCellMeta(r,a).className).replace(" removeRow","");i.setCellMeta(r,a,"className",l)}}else if("C"!=(s="R"!=s&&"U"!=s?s:"D")&&"S"!=s&&i.setDataAtCell(r,0,s),"C"==s){i.alter("remove_row",r);var c=i.countSourceRows(),u=syn.$w.getTriggerOptions(e);u&&u.focusColumnID&&(u=i.propToCol(u.focusColumnID),0<r&&c<=r?i.selectCell(r=c-1,u):i.selectCell(r-1,u))}else if("S"!=s)if(!0===i.getSettings().isRemoveRowHidden)$grid.visibleRows(e,r,!1);else for(a=0;a<i.countCols();a++)i.setCellMeta(r,a,"className",i.getCellMeta(r,a).className+" removeRow");n?n(r):0<(t=1==$string.isNullOrEmpty(t)&&0<(c=$grid.getFirstShowColIndex(e))?c:t)&&0<=r-1&&$grid.selectCell(e,r-1,t),o.eventName=""}i.resumeRender()}},loadData(e,t,r){var n=$grid.getGridControl(e);if(n){for(var i=$grid.getGridValue(e),o=(i.applyCells=!1,n.deselectCell(),$grid.clearConditions(e),$grid.unHiddenRows(e),syn.$l.querySelectorAll("div.handsontable > div table input[type=checkbox][columnSelectAll]")),s=0;s<o.length;s++)o[s].checked=!1;for(var a=t.length,s=0;s<a;s++)t[s].Flag="R";n.loadData(t);for(var l=n.getSettings(),s=0;s<l.columns.length;s++){var c=l.columns[s];c.toogleChecked&&(c.toogleChecked=0)}i.colHeaderClick=!1,i.previousRow=-1,i.previousCol=-1,0!=l.columnSorting&&(0==(e=n.getPlugin("columnSorting")).isEnabled()&&e.enablePlugin(),1==e.isSorted())&&e.sort(e.sortColumn,e.sortOrder),i.applyCells=!0}r&&r()},getFirstShowColIndex(e){var t=0,e=$grid.getGridControl(e);if(e){var r=e.getSettings();if(r.firstShowColIndex)t=r.firstShowColIndex;else{for(var n=e.countCols()-1,i=[],o=0;o<=n;o++)i.push(o);if(r.hiddenColumns&&r.hiddenColumns.columns&&0<r.hiddenColumns.columns.length){for(var s=r.hiddenColumns.columns.length,o=0;o<s;o++)for(var a=r.hiddenColumns.columns[o],l=i.length-1;-1<l;l--)if(a==i[l]){$array.removeAt(i,l);break}t=i[0]}}}return t},getLastShowColIndex(e){var t=0,e=$grid.getGridControl(e);if(e){var r=e.getSettings();if(r.lastShowColIndex)t=r.lastShowColIndex;else{for(var t=e.countCols()-1,n=[],i=0;i<=t;i++)n.push(i);if(r.hiddenColumns&&r.hiddenColumns.columns&&0<r.hiddenColumns.columns.length){for(var o=r.hiddenColumns.columns.length,i=0;i<o;i++)for(var s=r.hiddenColumns.columns[i],a=n.length-1;-1<a;a--)if(s==n[a]){$array.removeAt(n,i);break}t=n[n.length-1]}}}return t},updateSettings(e,t,r){var n=$grid.getGridControl(e);n&&(r&&1==r&&$grid.clear(e),n.updateSettings(t),n.render())},getSettings(e){var t=null,e=$grid.getGridControl(e);return t=e?e.getSettings():t},isUpdateData(e){var t=!1,r=$grid.getSettings(e);if(r&&r.data&&0<r.data.length)for(var n=r.data.length,i=0;i<n;i++){var o=r.data[i].Flag;if(1!=$string.isNullOrEmpty(o)&&"R"!=o&&"S"!=o){t=!0;break}}return t},getFlag(e,t){e=$grid.getGridControl(e);if(e)return e.getDataAtCell(t,"Flag")},setFlag(e,t,r){var n,e=$grid.getGridControl(e);e&&(n=e.propToCol("Flag"),"S"!=e.getDataAtCell(t,n))&&e.setDataAtCell(t,n,r)},getDataAtCell(e,t,r){e=$grid.getGridControl(e);if(e)return e.getDataAtCell(t,r)},scrollViewportTo(e,t,r,n,i){var o=null,e=$grid.getGridControl(e);return o=e?e.scrollViewportTo(t,r,n,i):o},isEmptyRow(e,t){var r=null,e=$grid.getGridControl(e);return r=e?e.isEmptyRow(t):r},isEmptyCol(e,t){var r=null,e=$grid.getGridControl(e);return e&&(1==$object.isString(t)&&(t=e.propToCol(t)),r=e.isEmptyCol(t)),r},getDataAtRow(e,t){var r=null,e=$grid.getGridControl(e);return r=e?e.getDataAtRow(t):r},getSourceDataAtRow(e,t){var r=null,e=$grid.getGridControl(e);return r=e?e.getSourceDataAtRow(t):r},getDataAtCol(e,t){var r=null,e=$grid.getGridControl(e);return e&&(1==$object.isString(t)&&(t=e.propToCol(t)),r=e.getDataAtCol(t)),r},getSourceDataAtCol(e,t){var r=null,e=$grid.getGridControl(e);return e&&(1==$object.isString(t)&&(t=e.propToCol(t)),r=e.getSourceDataAtCol(t)),r},getRowHeader(e,t){var r=null,e=$grid.getGridControl(e);return r=e?e.getRowHeader(t):r},setDataAtCell(e,t,r,n,i){e=$grid.getGridControl(e);e&&(1==$object.isString(r)&&(r=e.propToCol(r)),e.setDataAtCell(t,r,n,i))},setDataAtRow(e,t){e=$grid.getGridControl(e);e&&e.setDataAtCell(t)},isCellClassName(e,t,r,n){var i=!1,e=$grid.getGridControl(e);return e&&(1==$object.isString(r)&&(r=e.propToCol(r)),i=null!=(e=e.getCellMeta(t,r).className)&&-1<e.indexOf(n)),i},setCellClassName(e,t,r,n,i){if(1==$object.isNullOrUndefined(n))syn.$l.eventLog("$grid.setCellClassName","className 확인 필요","Warning");else{var o=$grid.getGridControl(e);if(o){1==$object.isString(r)&&(r=o.propToCol(r)),1==$object.isNullOrUndefined(i)&&(i=!1);var s=function(e,t,r,n){var i=o.getCellMeta(e,t).className;i?!0===n?-1==i.indexOf(r)&&o.setCellMeta(e,t,"className",o.getCellMeta(e,t).className+" "+r):-1<i.indexOf(r)&&(i=i.replace(" "+r,""),o.setCellMeta(e,t,"className",i)):o.setCellMeta(e,t,"className",r)};if(-1==t&&-1==r)for(var a=o.countRows(),l=o.countCols(),c=0;c<a;c++)for(var u=0;u<l;u++)s(c,u,n,i);else if(-1==t&&-1<r)for(a=o.countRows(),c=0;c<a;c++)s(c,r,n,i);else if(-1<t&&-1==r)for(l=o.countCols(),c=0;c<l;c++)s(t,c,n,i);else s(t,r,n,i);o.render()}}},setCellMeta(e,t,r,n,i){e=$grid.getGridControl(e);e&&(1==$object.isString(r)&&(r=e.propToCol(r)),e.setCellMeta(t,r,n,i))},setDataAtRowProp(e,t,r,n,i){e=$grid.getGridControl(e);e&&(1==$object.isString(r)&&(r=e.propToCol(r)),e.setDataAtRowProp(t,r,n,i))},getCellMeta(e,t,r){var n=null,e=$grid.getGridControl(e);return e&&(1==$object.isString(r)&&(r=e.propToCol(r)),n=e.getCellMeta(t,r)),n},getCellMetaAtRow(e,t){var r=null,e=$grid.getGridControl(e);return r=e?e.getCellMetaAtRow(t):r},getUpdateData(e,t,r){var n=[],i=$grid.getGridControl(e);if(r){if("Row"==t){if(null!=(u=i.toPhysicalRow($grid.getActiveRowIndex(e)))&&-1<u){var o=(d=i.getSourceDataAtRow(u)).Flag||"C";i.getCellMetaAtRow(u);if(o&&"S"!=o){for(p in d=$object.clone(d),(h={}).Flag=o,r){var s=r[p],a=d[p];h[s.fieldID]=a,h[s.fieldID]=void 0===a?"number"==s.dataType?null:$object.defaultValue(s.dataType):a}n.push(h)}}}else if("List"==t){for(var l=i.countSourceRows(),c=0;c<l;c++){var u=i.toPhysicalRow(c);if(null!=u){var d,h,p,o=(d=i.getSourceDataAtRow(u)).Flag||"C";i.getCellMetaAtRow(u);if(o&&"S"!=o&&"R"!=o){for(p in d=$object.clone(d),(h={}).Flag=o,r){s=r[p],a=d[p];h[s.fieldID]=a,h[s.fieldID]=void 0===a?"number"==s.dataType?null:$object.defaultValue(s.dataType):a}n.push(h)}}}var f=["D","U","C"],n=n.sort(function(e,t){e=f.indexOf(e.Flag),t=f.indexOf(t.Flag);return-1===e?1:-1===t?-1:e-t})}}else syn.$l.eventLog("getUpdateData","Input Mapping 설정 없음","Debug");return n},validateColumns(e,t,r){var n=!1,e=$grid.getGridControl(e);return n=e?e.validateColumns(t,r):n},validateRows(e,t,r){var n=!1,e=$grid.getGridControl(e);return n=e?e.validateRows(t,r):n},getPhysicalRowIndex(e,t){var r=null,e=$grid.getGridControl(e);return r=e?e.toPhysicalRow(t):r},getPhysicalColIndex(e,t){var r=null,e=$grid.getGridControl(e);return r=e?e.toPhysicalColumn(t):r},getPhysicalColText(e,t){var r=-1,e=syn.$l.querySelector(`#${e} .handsontable thead tr`);if(e)for(var n=e.childNodes,i=0;i<n.length;i++)if(-1<n[i].innerHTML.indexOf(`>${t}<`)){r=i;break}return r},getLogicalRowIndex(e,t){var r=null,e=$grid.getGridControl(e);return r=e?e.toVisualRow(t):r},getLogicalColIndex(e,t){var r=null,e=$grid.getGridControl(e);return r=e?e.toVisualColumn(t):r},unHiddenColumns(e){var t=$grid.getGridControl(e);if(t){for(var r=t.getPlugin("hiddenColumns"),n=(0==r.isEnabled()&&r.enablePlugin(),t.countCols()),i=[],o=0;o<n;o++)"Flag"!=t.colToProp(o)&&1==r.isHidden(o)&&i.push(o);$grid.visibleColumns(e,i,!0)}},isColumnHidden(e,t,r){var n=!1,e=$grid.getGridControl(e);return e&&(0==(e=e.getPlugin("hiddenColumns")).isEnabled()&&e.enablePlugin(),n=e.isHidden(t,r)),n},visibleColumns(e,t,r){e=$grid.getGridControl(e);if(e){var n=e.getPlugin("hiddenColumns");0==n.isEnabled()&&n.enablePlugin();var i=e.getSettings().columns;if(1==r)if(1==$object.isNumber(t))i[t].isHidden=!1,n.showColumn(t);else{for(var o=0;o<t.length;o++)i[t[o]].isHidden=!1;n.showColumns(t)}else if(1==$object.isNumber(t))i[t].isHidden=!0,n.hideColumn(t);else{for(o=0;o<t.length;o++)i[t[o]].isHidden=!0;n.hideColumns(t)}e.render()}},unHiddenRows(e){var t=$grid.getGridControl(e);if(t){for(var r=t.getPlugin("hiddenRows"),n=(0==r.isEnabled()&&r.enablePlugin(),t.countRows()),i=[],o=0;o<n;o++)1==r.isHidden(o)&&i.push(o);$grid.visibleRows(e,i,!0)}},isRowHidden(e,t,r){var n=!1,e=$grid.getGridControl(e);return e&&(0==(e=e.getPlugin("hiddenRows")).isEnabled()&&e.enablePlugin(),n=e.isHidden(t,r)),n},visibleRows(e,t,r){var n,e=$grid.getGridControl(e);e&&(0==(n=e.getPlugin("hiddenRows")).isEnabled()&&n.enablePlugin(),1==r?1==$object.isNumber(t)?n.showRow(t):n.showRows(t):1==$object.isNumber(t)?n.hideRow(t):n.hideRows(t),e.render())},propToCol(e,t){var r=-1,e=$grid.getGridControl(e);return r=e?e.propToCol(t):r},getColHeader(e,t){var r=null,e=$grid.getGridControl(e);return r=e?e.getColHeader(t):r},colToProp(e,t){var r=null,e=$grid.getGridControl(e);return r=e?e.colToProp(t):r},countCols(e){var t=null,e=$grid.getGridControl(e);return t=e?e.countCols():t},getSelected(e){var t=null,e=$grid.getGridControl(e);return t=e?e.getSelected():t},getActiveRowIndex(e){var t,r=-1,n=$grid.getGridControl(e);return r=n?(t=n.getSelected())&&0<t.length?n.getSelected()[0][0]:$grid.getGridValue(e).previousRow:r},getActiveColIndex(e){var t,r=-1,n=$grid.getGridControl(e);return r=n?(t=n.getSelected())&&0<t.length?n.getSelected()[0][1]:$grid.getGridValue(e).previousCol:r},selectCell(e,t,r,n,i,o,s){var a,l,e=$grid.getGridControl(e);e&&(-1===t&&((a=0)==(l=e.getPlugin("hiddenRows")).isEnabled()&&l.enablePlugin(),a=l?l.hiddenRows.length:0,t=e.countSourceRows()-a-1),e.selectCell(t,r,n,i,o,s))},getExportPlugin(e,t){var r=null,e=$grid.getGridControl(e);return e&&0==(r=e.getPlugin("exportFile")).isEnabled()&&r.enablePlugin(),r},exportAsString(e,t){var r=null,n=$grid.getExportPlugin(e,t);if(n){1==$object.isNullOrUndefined(t)&&(t={});for(var i=$grid.getGridControl(e),o=((t=syn.$w.argumentsExtend({exportHiddenRows:!1,exportHiddenColumns:!1,rowHeaders:!1,bom:!1,columnDelimiter:",",range:t.range||[0,1,i.countRows(),i.countCols()-1],filename:"{0}_{1}_{2}".format(syn.$w.pageScript,e,$date.toTicks(new Date))},t)).columnHeaders=!1,i.getSettings().columns),s=[],e=t.range?t.range[1]:1,a=t.range?t.range[3]:i.countCols()-1,l=e;l<=a;l++)s.push(o[l]);i=s.filter(function(e){return 1==t.exportHiddenColumns||0==e.isHidden}).map(function(e){return e.columnText}),e=n.exportAsString("csv",t),r=i.join(",")+"\r\n"+e}return r},exportFile(e,t){var r=$grid.getExportPlugin(e,t);if(r)if(1==$object.isNullOrUndefined(t)&&(t={}),"excel"==(t=syn.$w.argumentsExtend({fileType:"excel",exportHiddenRows:!1,exportHiddenColumns:!1,columnHeaders:!0,rowHeaders:!1,bom:!1,columnDelimiter:","},t)).fileType){for(var n,i=(n=$grid.getGridControl(e)).getSettings(),o=i.columns,s=[],a=t.range?t.range[1]:1,l=t.range?t.range[3]:n.countCols()-1,c=a;c<=l;c++)s.push(o[c]);for(var u=s.filter(function(e){return 1==t.exportHiddenColumns||0==e.isHidden}).map(function(e,t){return{index:n.propToCol(e.data),type:e.type}}),a=i.exportColumns.map(function(e,t){return{index:n.propToCol(e.columnID),type:e.type}}),d=(u=$object.extend(u,a)).length,h=i.colWidths,p=[],c=0;c<d;c++){var f=u[c].index;p.push({wpx:h[f]})}for(var a=$grid.exportAsString(e,t),g=Papa.parse(a).data,m=g.length,y=document.createElement("DIV"),c=0;c<d;c++)if("numeric"==u[c].type)for(var v=1;v<m;v++)g[v][c]=$string.toParseType(g[v][c],"number");else if(-1<u[c].type.indexOf("html"))for(v=1;v<m;v++)y.innerHTML=g[v][c],g[v][c]=y.textContent||y.innerText||"";y=null,i=XLSX.utils.book_new(),a=XLSX.utils.aoa_to_sheet(g),a=(a["!cols"]=p,XLSX.utils.book_append_sheet(i,a,"Sheet1"),XLSX.write(i,{bookType:"xlsx",type:"binary"}));syn.$l.blobToDownload(new Blob([syn.$l.stringToArrayBuffer(a)],{type:"application/octet-stream"}),t.filename+".xlsx")}else"csv"==t.fileType&&(n=$grid.getGridControl(e),t=syn.$w.argumentsExtend({range:t.range||[0,1,n.countRows(),n.countCols()],filename:"{0}_{1}_{2}".format(syn.$w.pageScript,e,$date.toTicks(new Date))},t),r.downloadFile("csv",t))},importFile(e,t){$grid.getGridControl(e)&&((e=syn.$l.get("{0}_ImportFile".format(e))).callback=t,e.click())},importFileLoad(e){var O=e.srcElement||e.target,I=O.id.split("_")[0],M=$grid.getSettings(I),e=[".csv",".xls",".xlsx"],k=O.files[0].name,D=k.substring(-1==k.lastIndexOf(".")?k.length:k.lastIndexOf("."));if(D&&e.indexOf(D)<0)return syn.$w.alert("{0} 확장자를 가진 파일만 가능합니다".format(e.toString())),!1;e=new FileReader;e.onload=function(e){O.value="";var e=e.target.result,t=$grid.getGridControl(I);if(".csv"==D){var r=e.split(/\r\n|\n/);if(0==r.length)$grid.clear(I);else if(0<r.length){for(var n=[],i=r[0].split(","),o=[],s=M.columns.map(function(e){return e.data}),a=M.columns.map(function(e){return e.type}),l=0;l<i.length;l++){if(m=(m=(m=i[l]).replace(/^["]/,"")).replace(/["]$/,""),i[l]=m,-1==(C=M.colHeaders.indexOf(m)))return syn.$w.alert("올바른 형식의 파일이 아닙니다.\n파일을 확인해주세요."),!1;var c=t.propToCol(s[C]);o.push({headerIndex:l,columnID:s[C],columnIndex:c,columnType:a[C]})}for(var u=r[1],d=u.split(","),l=0;l<o.length;l++){var h=o[l],p=(m=(m=(m=d[l]).replace(/^["]/,"")).replace(/["]$/,""),!0);switch(h.columnType){case"checkbox":case"checkbox2":p=$string.toBoolean(m);break;case"numeric":null==m&&(m=0),p=1==$object.isNumber(m)||$string.isNumber(m);break;case"date":p=null==m||$object.isDate(m);break;default:null==m&&(m=""),p=$object.isString(m)}if(0==p)return syn.$w.alert("올바른 형식의 파일이 아닙니다.\n파일을 확인해주세요."),!1}for(l=1;l<r.length;l++)if(u=r[l],0==$string.isNullOrEmpty(u)){for(var f={},d=r[l].split(","),g=0;g<o.length;g++){var h=o[g],m=d[g];m=1==$object.isNullOrUndefined(m)?"":(m=m.replace(/^["]/,"")).replace(/["]$/,""),"numeric"==h.columnType&&null!=m&&(m=1==$object.isNumber(m)?m:Number(m)),f[h.columnID]=m}n.push(f)}}}else{for(var s=M.columns.map(function(e){return e.data}),e=XLSX.read(e,{type:"binary"}),y=e.Sheets[e.SheetNames[0]],v=XLSX.utils.decode_range(y["!ref"]),b=v.s.c;b<=v.e.c;++b){var w=y[XLSX.utils.encode_cell({c:b,r:0})];if(null==w)break;var C,E=w.v;if(-1==(C=M.colHeaders.indexOf(E)))return syn.$w.alert("올바른 형식의 파일이 아닙니다.\n파일을 확인해주세요."),!1;E=s[C];w.v=E,w.h=E,w.w=E}n=XLSX.utils.sheet_to_json(y)}for(var T={},S=0;S<M.columns.length;S++){var _=M.columns[S],x="string";switch(_.type){case"radio":case"checkbox":case"checkbox2":x="bool";break;case"numeric":x="numeric";break;case"date":x="string"}T[_.data]={fieldID:_.data,dataType:x}}$grid.clear(I),$grid.setValue(I,n,T);for(var R=t.propToCol("Flag"),A=t.countRows(I),N=[],l=0;l<A;l++)N.push([l,R,"C"]);t.setDataAtCell(N),O.callback&&O.callback(k)},".csv"==D?e.readAsText(O.files[0]):e.readAsBinaryString(O.files[0])},getGridControl(e){for(var t=null,r=$grid.gridControls.length,n=0;n<r;n++){var i=$grid.gridControls[n];if(i.id==e){t=i.hot;break}}return t},getGridValue(e){for(var t=null,r=$grid.gridControls.length,n=0;n<r;n++){var i=$grid.gridControls[n];if(i.id==e){t=i.value;break}}return t},getGridSetting(e){for(var t=null,r=$grid.gridControls.length,n=0;n<r;n++){var i=$grid.gridControls[n];if(i.id==e){t=i.setting;break}}return t},getColumnWidths(e){var t=[],r=$grid.getGridControl(e);if(r)for(var n=r.countCols(),i=0;i<n;i++)t.push(r.getColWidth(i));return t},setColumnWidth(e,t,r){var n,e=$grid.getGridControl(e);e&&(0==(n=e.getPlugin("manualColumnResize")).isEnabled()&&n.enablePlugin(),1==$object.isString(t)&&(t=e.propToCol(t)),1==$object.isNumber(r))&&n.setManualSize(t,r)},setControlSize(e,t){var r=syn.$l.get(e);r&&t&&(t.width&&(r.style.width=t.width),t.height&&(r.style.height=t.height),$grid.getGridControl(e).render())},getValue(e,t,r){for(var n=[],i=$grid.getUpdateData(e,t,r),o=i.length,s=0;s<o;s++){var a,l=i[s],c=[];for(a in l){var u={prop:a,val:l[a]};c.push(u)}n.push(c)}return n},setValue(e,t,r){var n=$grid.getGridControl(e);if(n){var i,o=n.getSettings();if(o&&t&&0<t.length){if(0==$object.isNullOrUndefined(r)){for(i in f=t[0]){var s=!1,a=r[i];if(a){switch(a.dataType.toLowerCase()){case"string":s=1==$string.isNullOrEmpty(f[i])||$object.isString(f[i])||$string.isNumber(f[i]);break;case"bool":s=1==$string.isNullOrEmpty(f[i])||$object.isBoolean(f[i]);break;case"number":case"numeric":s=1==$string.isNullOrEmpty(f[i])||$string.isNumber(f[i])||$object.isNumber(f[i]);break;case"date":s=1==$string.isNullOrEmpty(f[i])||$object.isDate(f[i]);break;default:s=!1}if(0==s)return void syn.$l.eventLog("syn.uicontrols.$grid",'바인딩 데이터 타입과 매핑 정의가 다름, 바인딩 ID - "{0}", 타입 - "{1}"'.format(i,a.dataType),"Warning")}}for(var l=o.columns,c=[],u=0;u<l.length;u++)"dropdown"==(d=l[u]).type&&c.push(d);if(0<c.length)for(u=0;u<c.length;u++){var d,h=(d=c[u]).dataSource;if(h)for(var p=0;p<t.length;p++)for(var f,g=t[p][d.codeColumnID],m=0;m<h.DataSource.length;m++)if((f=h.DataSource[m])[h.CodeColumnID]==g){t[p][d.data]=f[h.ValueColumnID];break}}}$grid.loadData(e,t)}else $grid.loadData(e,[]);$grid.renderSummary(n)}},renderSummary(e){var t=e.getSettings();t.summarys&&0<t.summarys.length&&(t={index:e.countRows(),amount:1},e.alter("insert_row_below",t.index,t.amount),e.render(),$grid.getGridValue(e.elID).applyCells=!0,$grid.refreshSummary(e.elID))},refreshSummary(e){var t=$grid.getGridControl(e),r=t.getSettings();if(r.summarys&&0<r.summarys.length){for(var n=r.data.length-1,i=[],o=r.summarys.length,s=function(e){return 1==$string.isNullOrEmpty(e)||0==$string.isNumber(e)?0:parseFloat($object.isNumber(e)?e:$string.toNumber(e))},a=0;a<o;a++){var l=0,c=r.summarys[a],u=t.propToCol(c.columnID),d=r.data.map(function(e){return e.Flag&&"S"!=e.Flag&&e[c.columnID]});if(0<d.length){var h=JSON.parse(JSON.stringify(d));switch(c.type){case"min":$array.sort(h,!0);l=s(h[0]);break;case"max":$array.sort(h,!1),l=s(h[0]);break;case"avg":for(var p=0;p<h.length;p++)l+=s(h[p]);l/=h.length;break;case"sum":for(p=0;p<h.length;p++)l+=s(h[p]);break;case"count":l=h.length-1;break;case"custom":var f=window[syn.$w.pageScript];f&&(f=f.event["{0}_customSummary".format(t.elID)])&&(l=f.apply(t,[t.elID,c.columnID,u,h]))}"custom"!=c.type&&(l=1==$object.isNullOrUndefined(c.fixed)?l.toFixed("avg"==c.type?"1":"0"):l.toFixed(c.fixed),l=1==$object.isNullOrUndefined(c.format)||!0===c.format?$string.toCurrency(l):l.toString()),i.push([n,u,l])}}i.push([n,0,"S"]),t.setDataAtCell(i)}},clear(e,t){$grid.loadData(e,[])},setTransactionBelongID(e,t,r){var e=syn.$l.get(e+"_hidden")||syn.$l.get(e),n=JSON.parse(e.getAttribute("syn-options"));if(null!=n)for(var i=0;i<n.columns.length;i++){var o,s=n.columns[i],a="string";switch(s.columnType){case"checkbox":a="bool";break;case"numeric":a="numeric";break;case"number":a="number";break;case"date":a="date"}1!=$object.isNullOrUndefined(r)&&(o=!1,"Flag"==s.data?o=!0:s.belongID&&(1==$object.isString(s.belongID)?o=r.functionID==s.belongID:1==$object.isArray(s.belongID)&&(o=-1<s.belongID.indexOf(r.functionID))),1!=o)||(t.items[s.data]={fieldID:s.data,dataType:a})}},checkEditValue(e){return 0<$grid.getDataAtCol(e,"Flag").filter(e=>0==$string.isNullOrEmpty(e)&&"R"!=e).length},checkUniqueValueCol(e,t){var r=$grid.getSourceDataAtCol(e,t);return 0<!r.filter(function(e,t){return r.indexOf(e)!==t}).length},checkValueCountCol(e,t,r){return $grid.getDataAtCol(e,t).filter(e=>e===r).length},checkEmptyValueCol(e,t,r){return 1==$object.isNullOrUndefined(r)?0!=$grid.countRows(e)&&0<$grid.getDataAtCol(e,t).filter(e=>1==$string.isNullOrEmpty(e)).length:0<$grid.getDataAtCol(e,t).filter(e=>e===r).length},checkEmptyValueCols(e,t,r){for(var n=$grid.getSettings(e).data,i=0,o=n.length;i<o;i++){for(var s=n[i],a=!1,l=0;l<t.length;l++){var c=t[l];if(1==$object.isNullOrUndefined(r)){if(1!=$string.isNullOrEmpty(s[c])){a=!1;break}}else if(1!=$string.isNullOrEmpty(s[c])&&s[c]!==r){a=!1;break}a=!0}if(1==a)return a}return!1},setLocale(e,t,r,n){syn.$l.get(e),$resource.getBindSource(r)}}),syn.uicontrols.$grid=$grid}(window),!function(i){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var o=syn.uicontrols.$element||new syn.module;o.extend({name:"syn.uicontrols.$element",version:"v2025.3.1",defaultSetting:{disabled:!1,dataType:"string",belongID:null,getter:!1,setter:!1,controlText:null,content:"value",validators:null,transactConfig:null,triggerConfig:null},addModuleList(e,t,r,n){var i=e.getAttribute("id"),o=e.getAttribute("syn-datafield"),e=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:e,field:o,module:this.name,type:n})},controlLoad(e,t){var r,n=syn.$l.get(e);n&&(t=syn.$w.argumentsExtend(o.defaultSetting,t),(r=i[syn.$w.pageScript])&&r.hook.controlInit&&(r=r.hook.controlInit(e,t),t=syn.$w.argumentsExtend(t,r)),n.setAttribute("syn-options",JSON.stringify(t)),t.bindingID)&&syn.uicontrols.$data&&syn.uicontrols.$data.bindingSource(e,t.bindingID)},getValue(e,t){var r=null,n=syn.$l.get(e);if(0==$object.isNullOrUndefined(n)){e=n.getAttribute("syn-options");if(e)switch(JSON.parse(e).content){case"value":r=n.value;break;case"text":r=n.innerText;break;case"html":r=n.innerHTML;break;default:r=n.value}else r=n.value}else r="";return r},setValue(e,t,r){var n=syn.$l.get(e);if(t&&0==$object.isNullOrUndefined(n)){e=n.getAttribute("syn-options");if(e)switch(JSON.parse(e).content){case"value":n.value=t;break;case"text":"innerText"in n&&(n.innerText=t);break;case"html":"innerHTML"in n&&(n.innerHTML=t);break;default:n.value=t}else n.value=t}},clear(e,t){var r=syn.$l.get(e);if(0==$object.isNullOrUndefined(r)){e=r.getAttribute("syn-options");if(e)switch(JSON.parse(e).content){case"value":r.value="";break;case"text":"innerText"in r&&(r.innerText="");break;case"html":"innerHTML"in r&&(r.innerHTML="");break;default:r.value=""}else r.value=""}},setLocale(e,t,r,n){var i,o;0==$object.isNullOrUndefined(r)&&(i=null,i=0==$string.isNullOrEmpty(r.elID)?syn.$l.get(r.elID):syn.$l.querySelector('{0}[i18n-key="{1}"]'.format(r.tag,r.key)),o=$resource.getBindSource(r),0==$string.isNullOrEmpty(o))&&(i[o]=$resource.translateText(r,n))}}),syn.uicontrols.$element=o}(window);